<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#382C2A">
    <meta name="viewport" content="height=device-height, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
    <title>JackSmith</title>
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <link rel="manifest" href="/manifest.json">
    <script type="text/javascript" src="./js/loader.js"></script>
    <script type="text/javascript">
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js').then((registration) => {
                    console.log('ServiceWorker registered with scope:', registration.scope);
                }, (error) => {
                    console.log('ServiceWorker registration failed:', error);
                });
            });
        }
    </script>
    <style>
        * {
            cursor: default;
            user-select: none;
            -o-user-select: none;
            -ms-user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
        }

        body {
            background-color: black;
        }

        * {
            margin: 0;
            padding: 0;
        }

        canvas {
            outline: none;
        }

        html,
        body,
        #container {
            margin: 0;
            overflow: hidden;
            width: 100%;
            height: 100%;
            background-color: rgb(0, 0, 0);
        }

        #splash {
            position: absolute;
            visibility: hidden;
            z-index: 10;
        }

        #splash__image {
            position: absolute;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            visibility: visible;
            z-index: 10;
        }

        #progress__root {
            position: absolute;
        }

        #progress__line {
            width: 0;
            height: 100%;
            transition: all 0.5s;
        }

        #loading__image {
            position: absolute;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* CSS để xoay canvas khi ở chế độ portrait (dọc) */
        .rotate-game {
            transform: rotate(90deg);
            transform-origin: center;
            width: 100vh; /* Đảo ngược chiều rộng và chiều cao khi xoay */
            height: 100vw;
            position: absolute;
            top: 50%;
            left: 50%;
            margin: -50vw 0 0 -50vh; /* Giữ canvas ở giữa sau khi xoay */
        }
    </style>
</head>

<body>
    <div id="splash__image">
        <div id="progress__root">
            <div id="progress__line"></div>
        </div>
        <div id="loading__image"></div>
    </div>

    <div id="container">
        <!-- Canvas cho game -->
        <canvas id="gameCanvas"></canvas>
    </div>

    <script>
        function checkOrientation() {
            const gameCanvas = document.getElementById("gameCanvas");
            if (window.innerWidth < window.innerHeight) {
                // Xoay canvas nếu màn hình ở chế độ portrait
                gameCanvas.classList.add("rotate-game");
            } else {
                // Bỏ xoay nếu màn hình ở chế độ landscape
                gameCanvas.classList.remove("rotate-game");
            }
        }

        // Kiểm tra khi tải trang
        window.addEventListener("load", () => {
            checkOrientation();

            const config = {
                "title": "Bacon_Ipsem",
                "filename": "Bacon_Ipsem",
                "stageScaleMode": "showAll",
                "showFPS": false,
                "debug": true,
                "splash": "assets/den.png",
                "start": null,
                "width": 1024,
                "height": 768,
                "x": 0,
                "y": 0,
                "w": "100%",
                "h": "100%",
                "stageAlign": null,
                "progressParserWeigth": 1,
                "progress": {
                    "direction": "lr",
                    "back": "#130d02",
                    "line": "#f29f01",
                    "rect": [0.25, 0.77, 0.5, 0.01]
                },
                "box2dVersion": "none",
                "binary": [
                    {
                        "name": "fonts.swf",
                        "path": "assets/fonts.swf",
                        "size": 30506
                    },
                    {
                        "name": "JackSmith",
                        "path": "assets/luoiho.swf",
                        "size": 19888,
                        "resourceType": "GAME"
                    }
                ],
                "runtime": "js/Main.js"
            };

            Loader.init(config);
            Loader.runPlayer((fill) => { }, (instance) => { });
        });

        // Kiểm tra khi thay đổi kích thước
        window.addEventListener("resize", checkOrientation);
    </script>
</body>
</html>
