{"mappings":"spBAsBA,IAAuBA,EACDC,mJArBtB,IAAIC,EAAU,GAoBdF,WAlBkBG,GAGhB,IAFA,IAAIC,EAAOC,OAAOD,KAAKD,GAEdG,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC/BJ,EAAQE,EAAKE,IAAMH,EAAMC,EAAKE,KAelCL,WAXiBO,GACf,IAAIC,EAAWP,EAAQM,GAEvB,GAAgB,MAAZC,EACF,MAAM,IAAIC,MAAM,oCAAsCF,GAGxD,OAAOC,wCC2BT,IAAoBE,+EA5CpB,IAAIC,EAAY,YA6BPC,EAAWC,GAClB,OAAQ,GAAKA,GAAKC,QAAO,wCAA0C,MAAQ,IAc7EJ,WA1C4BH,GAC1B,IAAIQ,EAAQJ,EAAUJ,GAOtB,OALKQ,IACHA,aAQF,IACE,MAAM,IAAIN,MACV,MAAOO,GACP,IAAIC,GAAW,GAAKD,EAAIE,OAAOC,MAAK,kCAEpC,GAAIF,EAGF,OAAOL,EAAWK,EAAQ,IAI9B,MAAO,IApBGG,GACRT,EAAUJ,GAAMQ,GAGXA,wCCZTM,EAAAC,QAAkBC,EAAA,QAAA,CAA6CA,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,UAAWC,MAAI,IAAOH,EAAc,iECIxMF,EAAAC,QAAiBK,GAAY,SAAUC,GACrC,OAAO,IAAIC,SAAQ,SAAUJ,EAASK,GAEpC,IAAIC,EAAa,IAAIC,QAAQ,GAAKC,KAAKC,UAAUC,MAAM,IAEvDC,EAAOL,GAAc,SAAUM,GAC7BZ,EAAQY,GACRC,KAIF,IAAIA,EAAU,kBACLF,EAAOL,GACdQ,EAAOC,QAAU,KACjBD,EAAOE,UAILF,EAASG,SAASC,cAAc,UACpCJ,EAAOK,OAAQ,EACfL,EAAOM,KAAO,SACdN,EAAOO,QAAU,QACjBP,EAAOQ,YAAc,uBAAuBf,OAAOJ,EAAQ,OAAOI,OAAOD,EAAY,QAErFQ,EAAOC,QAAU,SAAUQ,GACzBlB,EAAOkB,GACPV,KAGFI,SAASO,KAAKC,YAAYX,8CC/B9B,IAAIY,EAAgB,GAChBC,EAAiB,GACjBC,EAAmB,YAEdC,EAAST,GAChB,OAAQA,GACN,IAAK,UACH,OAAOO,EAET,IAAK,WACH,OAAOC,UAGP,OAAOF,GAIb9B,EAAAC,QAAiB,SAAUiC,EAAQV,GACjC,OAAO,SAAUjB,GACf,IAAI4B,EAAQF,EAAST,GAErB,OAAIW,EAAM5B,GACD4B,EAAM5B,GAGR4B,EAAM5B,GAAU2B,EAAOE,MAAM,KAAMC,WAAWC,OAAM,SAAUX,GAEnE,aADOQ,EAAM5B,GACPoB,4CC7BZ3B,EAAAC,QAAkBC,EAAA,QAAA,CAA6CA,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,UAAWC,MAAI,IAAOH,EAAc,gDCAxMF,EAAAC,QAAkBC,EAAA,QAAA,CAA6CA,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,UAAWC,MAAI,IAAOH,EAAc,gDCAxMF,EAAAC,QAAkBC,EAAA,QAAA,CAA6CA,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,UAAWC,MAAI,IAAOH,EAAc,gDCAxMF,EAAAC,QAAkBC,EAAA,QAAA,CAA6CA,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,UAAWC,MAAI,IAAOH,EAAc,cCAxMA,EAAA,SAAAqC,SAA8CC,KAAKC,MAAM,2nHCchDC,OCdLC,EAAQ,SAAUC,GACpB,OAAOA,GAAMA,EAAGhC,MAAQA,MAAQgC,GAIlCC,EAEEF,EAA2B,iBAAdG,YAA0BA,aACvCH,EAAuB,iBAAVI,QAAsBA,SAEnCJ,EAAqB,iBAARK,MAAoBA,OACjCL,EAAuB,iBAAV5B,GAAsBA,eAEpB,OAAOkC,SAAcC,SAAS,cAATA,WCVtCC,ICHAC,EAAiB,SAAUC,GACzB,IACE,QAASA,IACT,MAAOC,GACP,OAAO,MDDa,WAEtB,OAA8E,GAAvEvE,OAAOwE,eAAe,GAAI,EAAG,CAAEC,IAAK,WAAc,OAAO,KAAQ,iBEH1EC,GAAkBL,GAAM,WACtB,IAAIM,EAAI,aAAiCC,OAEzC,MAAsB,mBAARD,GAAsBA,EAAKE,eAAe,gBCH1D,ICQSC,EDRLC,EAAOZ,SAASa,UAAUC,KAE9BC,EAAiBR,EAAcK,EAAKH,KAAKG,GAAQ,WAC/C,OAAOA,EAAK1B,MAAM0B,EAAMzB,YCJ1B,IAAI6B,EAAwB,GAAGC,qBAE3BC,EAA2BrF,OAAOsF,yBAGlCC,EAAcF,IAA6BF,EAAsBF,KAAK,CAAE,EAAG,GAAK,GAIpFH,EAAYS,EAAc,SAA8BC,GACtD,IAAIC,EAAaJ,EAAyBnB,KAAMsB,GAChD,QAASC,GAAcA,EAAWC,YAChCP,QCbJQ,EAAiB,SAAUC,EAAQjF,GACjC,MAAO,CACL+E,aAAuB,EAATE,GACdC,eAAyB,EAATD,GAChBE,WAAqB,EAATF,GACZjF,MAAOA,sBCHPoF,EAAoB5B,SAASa,UAC7BgB,EAAOD,EAAkBnB,KACzBqB,EAAOF,EAAkBd,KACzBiB,EAAcxB,GAAesB,EAAKpB,KAAKqB,EAAMA,GCH7CE,GDKJC,EAAiB1B,EAAc,SAAU2B,GACvC,OAAOA,GAAMH,EAAYG,IACvB,SAAUA,GACZ,OAAOA,GAAM,WACX,OAAOJ,EAAK5C,MAAMgD,EAAI/C,cCTC,GAAGgD,UAC1BC,EAAcH,EAAY,GAAGrE,OAEjCyE,EAAiB,SAAU3C,GACzB,OAAO0C,EAAYJ,EAAStC,GAAK,GAAG,ICDtC,IAAI4C,EAAS3C,EAAA9D,OACT0G,EAAQN,EAAY,GAAGO,OAG3BC,EAAiBvC,GAAM,WAGrB,OAAQoC,EAAO,KAAKrB,qBAAqB,MACtC,SAAUvB,GACb,MAAsB,UAAf2C,EAAQ3C,GAAkB6C,EAAM7C,EAAI,IAAM4C,EAAO5C,IACtD4C,QCbAI,EAAY/C,EAAAgD,UAIhBC,EAAiB,SAAUlD,GACzB,GAAUmD,MAANnD,EAAiB,MAAMgD,EAAU,wBAA0BhD,GAC/D,OAAOA,GCJToD,EAAiB,SAAUpD,GACzB,OAAO+C,EAAcG,EAAuBlD,iBCH9CqD,EAAiB,SAAUC,GACzB,MAA0B,mBAAZA,GCDhBC,EAAiB,SAAUvD,GACzB,MAAoB,iBAANA,EAAwB,OAAPA,EAAcqD,EAAWrD,eCAtDwD,EAAY,SAAUF,GACxB,OAAOD,EAAWC,GAAYA,OAAWH,GAG3CM,EAAiB,SAAUC,EAAWC,GACpC,OAAOlE,UAAUpD,OAAS,EAAImH,EAAUvD,EAAOyD,IAAczD,EAAOyD,IAAczD,EAAOyD,GAAWC,aCNtGC,EAAiBrB,EAAY,GAAGsB,8BCAhCC,EAAiBL,EAAW,YAAa,cAAgB,GCCzD,IAIIM,EAAOC,EAJPC,EAAUhE,EAAAiE,QACVC,EAAOlE,EAAAmE,KACPC,EAAWJ,GAAWA,EAAQK,UAAYH,GAAQA,EAAKI,QACvDC,EAAKH,GAAYA,EAASI,GAG1BD,IAIFR,GAHAD,EAAQS,EAAG1B,MAAM,MAGD,GAAK,GAAKiB,EAAM,GAAK,EAAI,IAAMA,EAAM,GAAKA,EAAM,MAK7DC,GAAWF,MACdC,EAAQD,EAAU5G,MAAK,iBACT6G,EAAM,IAAM,MACxBA,EAAQD,EAAU5G,MAAK,oBACZ8G,GAAWD,EAAM,IAIhCW,EAAiBV,ECrBjBW,IAAmBxI,OAAOyI,wBAA0BpE,GAAM,WACxD,IAAIqE,EAASC,SAGb,OAAQC,OAAOF,MAAa1I,OAAO0I,aAAmBC,UAEnDA,OAAOE,MAAQN,GAAcA,EAAa,MCR/CO,EAAiBN,IACXG,OAAOE,MACkB,iBAAnBF,OAAOI,SCCnB,IAAIC,EAASlF,EAAA9D,OAEbiJ,EAAiBH,EAAoB,SAAUjF,GAC7C,MAAoB,iBAANA,GACZ,SAAUA,GACZ,IAAIqF,EAAU5B,EAAW,UACzB,OAAOJ,EAAWgC,IAAYzB,EAAcyB,EAAQlE,UAAWgE,EAAOnF,iBCVpEsF,GAASrF,EAAA8E,OAEbQ,GAAiB,SAAUjC,GACzB,IACE,OAAOgC,GAAOhC,GACd,MAAO5C,GACP,MAAO,WCJX,IAAI8E,GAAYvF,EAAAgD,UAGhBwC,GAAiB,SAAUnC,GACzB,GAAID,EAAWC,GAAW,OAAOA,EACjC,MAAMkC,GAAUD,GAAYjC,GAAY,uBCL1CoC,EAAiB,SAAU/D,EAAGgE,GAC5B,IAAIC,EAAOjE,EAAEgE,GACb,OAAe,MAARC,OAAezC,EAAYsC,GAAUG,WCD1CC,GAAY5F,EAAAgD,UAIhB6C,GAAiB,SAAUC,EAAOC,GAChC,IAAIxD,EAAIyD,EACR,GAAa,WAATD,GAAqB3C,EAAWb,EAAKuD,EAAMtD,YAAcc,EAAS0C,EAAM5E,EAAKmB,EAAIuD,IAAS,OAAOE,EACrG,GAAI5C,EAAWb,EAAKuD,EAAMG,WAAa3C,EAAS0C,EAAM5E,EAAKmB,EAAIuD,IAAS,OAAOE,EAC/E,GAAa,WAATD,GAAqB3C,EAAWb,EAAKuD,EAAMtD,YAAcc,EAAS0C,EAAM5E,EAAKmB,EAAIuD,IAAS,OAAOE,EACrG,MAAMJ,GAAU,mECXdM,GAAiBhK,OAAOwE,eAE5ByF,GAAiB,SAAUC,EAAKvJ,GAC9B,IACEqJ,GAAelG,EAAQoG,EAAK,CAAEvJ,MAAOA,EAAOkF,cAAc,EAAMC,UAAU,IAC1E,MAAOvB,GACPT,EAAOoG,GAAOvJ,EACd,OAAOA,GCPX,IACIwJ,GAAQrG,EADC,uBACiBmG,GADjB,qBACmC,IAEhDG,GAAiBD,ICHhBE,GAAiB,SAAUH,EAAKvJ,GAC/B,OAAOyJ,GAAMF,KAASE,GAAMF,QAAiBlD,IAAVrG,EAAsBA,EAAQ,MAChE,WAAY,IAAI2J,KAAK,CACtBlC,QAAS,SACTmC,KAAyB,SACzBC,UAAW,4CACXC,QAAS,2DACTC,OAAQ,qDCPNC,GAAS7G,EAAA9D,OAIb4K,GAAiB,SAAUzD,GACzB,OAAOwD,GAAO5D,EAAuBI,KCLvC,IAAI0D,GAAiBzE,EAAY,GAAGvB,gBAIpCiG,GAAiB9K,OAAO+K,QAAU,SAAgBlH,EAAIqG,GACpD,OAAOW,GAAeD,GAAS/G,GAAKqG,WCNlCc,GAAK,EACLC,GAAUpJ,KAAKC,SACfoJ,GAAW9E,EAAY,GAAIE,UAE/B6E,GAAiB,SAAUjB,GACzB,MAAO,gBAAqBlD,IAARkD,EAAoB,GAAKA,GAAO,KAAOgB,KAAWF,GAAKC,GAAS,KCAtF,IAAIG,GAAwBf,GAAO,OAC/BgB,GAASvH,EAAA6E,OACT2C,GAAYD,IAAUA,GAAY,IAClCE,GAAwBzC,EAAoBuC,GAASA,IAAUA,GAAOG,eAAiBL,GAE3FM,GAAiB,SAAUC,GACzB,IAAKZ,GAAOM,GAAuBM,KAAWlD,GAAuD,iBAA/B4C,GAAsBM,GAAoB,CAC9G,IAAIC,EAAc,UAAYD,EAC1BlD,GAAiBsC,GAAOO,GAAQK,GAClCN,GAAsBM,GAAQL,GAAOK,GAErCN,GAAsBM,GADb5C,GAAqBwC,GACAA,GAAUK,GAEVJ,GAAsBI,GAEtD,OAAOP,GAAsBM,ICdjC,IAAIE,GAAY9H,EAAAgD,UACZ+E,GAAeJ,GAAgB,eAInCK,EAAiB,SAAUlC,EAAOC,GAChC,IAAKzC,EAASwC,IAAUX,EAASW,GAAQ,OAAOA,EAChD,IACImC,EADAC,EAAezC,EAAUK,EAAOiC,IAEpC,GAAIG,EAAc,CAGhB,QAFahF,IAAT6C,IAAoBA,EAAO,WAC/BkC,EAAS7G,EAAK8G,EAAcpC,EAAOC,IAC9BzC,EAAS2E,IAAW9C,EAAS8C,GAAS,OAAOA,EAClD,MAAMH,GAAU,2CAGlB,YADa5E,IAAT6C,IAAoBA,EAAO,UACxBF,GAAoBC,EAAOC,ICnBpCoC,EAAiB,SAAU9E,GACzB,IAAI+C,EAAM4B,EAAY3E,EAAU,UAChC,OAAO8B,EAASiB,GAAOA,EAAMA,EAAM,cCJjCgC,GAAWpI,EAAAxB,SAEX6J,GAAS/E,EAAS8E,KAAa9E,EAAS8E,GAAS3J,eAErD6J,GAAiB,SAAUvI,GACzB,OAAOsI,GAASD,GAAS3J,cAAcsB,GAAM,ICH/CwI,IAAkBjI,IAAgBC,GAAM,WAEtC,OAEQ,GAFDrE,OAAOwE,eAAe4H,GAAc,OAAQ,IAAK,CACtD3H,IAAK,WAAc,OAAO,KACzB6H,KpCCL,IqCQSC,MrCRLC,GAA4BxM,OAAOsF,4BAIvC3B,EAAYS,EAAcoI,GAA4B,SAAkCC,EAAGjD,GAGzF,GAFAiD,EAAIxF,EAAgBwF,GACpBjD,EAAIyC,EAAczC,GACd6C,GAAgB,IAClB,OAAOG,GAA0BC,EAAGjD,GACpC,MAAOjF,IACT,GAAIuG,GAAO2B,EAAGjD,GAAI,OAAO7D,GAA0BT,EAAKJ,EAA8B2H,EAAGjD,GAAIiD,EAAEjD,WsCfjGkD,GAAiBtI,GAAeC,GAAM,WAEpC,OAGgB,IAHTrE,OAAOwE,gBAAe,cAA6B,YAAa,CACrE7D,MAAO,GACPmF,UAAU,IACTd,oBCPD2H,GAAS7I,EAAA8E,OACTgE,GAAY9I,EAAAgD,UAGhB+F,GAAiB,SAAU1F,GACzB,GAAIC,EAASD,GAAW,OAAOA,EAC/B,MAAMyF,GAAUD,GAAOxF,GAAY,sBFFrC,IAAI2F,GAAYhJ,EAAAgD,UAEZiG,GAAkB/M,OAAOwE,eAEzBwI,GAA4BhN,OAAOsF,yBAOvCiH,GAAYnI,EAAcsI,GAA0B,SAAwBD,EAAGjD,EAAGyD,GAIhF,GAHAJ,GAASJ,GACTjD,EAAIyC,EAAczC,GAClBqD,GAASI,GACQ,mBAANR,GAA0B,cAANjD,GAAqB,UAAWyD,GARlD,aAQ4EA,IAAeA,EAAmB,SAAG,CAC5H,IAAIC,EAAUF,GAA0BP,EAAGjD,GACvC0D,GAAWA,EAAgB,WAC7BT,EAAEjD,GAAKyD,EAAWtM,MAClBsM,EAAa,CACXpH,aAdW,iBAcmBoH,EAAaA,EAAuB,aAAIC,EAAoB,aAC1FxH,WAhBS,eAgBiBuH,EAAaA,EAAqB,WAAIC,EAAkB,WAClFpH,UAAU,IAGd,OAAOiH,GAAgBN,EAAGjD,EAAGyD,IAC7BF,GAAkB,SAAwBN,EAAGjD,EAAGyD,GAIlD,GAHAJ,GAASJ,GACTjD,EAAIyC,EAAczC,GAClBqD,GAASI,GACLZ,GAAgB,IAClB,OAAOU,GAAgBN,EAAGjD,EAAGyD,GAC7B,MAAO1I,IACT,GAAI,QAAS0I,GAAc,QAASA,EAAY,MAAMH,GAAU,2BAEhE,MADI,UAAWG,IAAYR,EAAEjD,GAAKyD,EAAWtM,OACtC8L,GGtCTU,GAAiB/I,EAAc,SAAUgJ,EAAQlD,EAAKvJ,GACpD,OAAO4L,GAAuBa,EAAQlD,EAAKvE,EAAyB,EAAGhF,KACrE,SAAUyM,EAAQlD,EAAKvJ,GAEzB,OADAyM,EAAOlD,GAAOvJ,EACPyM,gBCJLC,GAAmBjH,EAAYjC,SAASmC,UAGvCY,EAAWkD,GAAAkD,iBACdlD,GAAAkD,cAAsB,SAAUzJ,GAC9B,OAAOwJ,GAAiBxJ,KAI5B0J,GAAiBnD,GAAAkD,wBCTbE,GAAU1J,EAAA2J,QAEdC,GAAiBxG,EAAWsG,KAAO,cAAmB7I,KAAK4I,GAAcC,YCHrEG,GAAOtD,GAAO,QAElBuD,GAAiB,SAAU1D,GACzB,OAAOyD,GAAKzD,KAASyD,GAAKzD,GAAOiB,GAAIjB,eCNvC2D,GAAiB,GCUjB,IAGIC,GAAKC,GAAKC,GAFVC,GAAYnK,EAAAgD,UACZoH,GAAUpK,EAAA2J,QAgBd,GAAIC,IAAmBtD,GAAA+D,MAAc,CACnC,IAAIC,GAAQhE,GAAA+D,QAAiB/D,GAAA+D,MAAe,IAAID,IAC5CG,GAAQjI,EAAYgI,GAAM3J,KAC1B6J,GAAQlI,EAAYgI,GAAMG,KAC1BC,GAAQpI,EAAYgI,GAAMK,KAC9BX,GAAM,SAAUjK,EAAI6K,GAClB,GAAIJ,GAAMF,GAAOvK,GAAK,MAAM,IAAIoK,GAxBH,8BA2B7B,OAFAS,EAASC,OAAS9K,EAClB2K,GAAMJ,GAAOvK,EAAI6K,GACVA,GAETX,GAAM,SAAUlK,GACd,OAAOwK,GAAMD,GAAOvK,IAAO,IAE7BmK,GAAM,SAAUnK,GACd,OAAOyK,GAAMF,GAAOvK,QAEjB,CACL,IAAI+K,GAAQhB,GAAU,SACtBC,GAAWe,KAAS,EACpBd,GAAM,SAAUjK,EAAI6K,GAClB,GAAI5D,GAAOjH,EAAI+K,IAAQ,MAAM,IAAIX,GAvCJ,8BA0C7B,OAFAS,EAASC,OAAS9K,EAClBsJ,GAA4BtJ,EAAI+K,GAAOF,GAChCA,GAETX,GAAM,SAAUlK,GACd,OAAOiH,GAAOjH,EAAI+K,IAAS/K,EAAG+K,IAAS,IAEzCZ,GAAM,SAAUnK,GACd,OAAOiH,GAAOjH,EAAI+K,KAItBC,GAAiB,CACfJ,IAAKX,GACLrJ,IAAKsJ,GACLQ,IAAKP,GACLc,QAnDY,SAAUjL,GACtB,OAAOmK,GAAInK,GAAMkK,GAAIlK,GAAMiK,GAAIjK,EAAI,KAmDnCkL,UAhDc,SAAUC,GACxB,OAAO,SAAUnL,GACf,IAAIsK,EACJ,IAAK/G,EAASvD,KAAQsK,EAAQJ,GAAIlK,IAAKpB,OAASuM,EAC9C,MAAMf,GAAU,0BAA4Be,EAAO,aACnD,OAAOb,YCrBTc,GAAoB9K,SAASa,UAE7BkK,GAAgB9K,GAAepE,OAAOsF,yBAEtC6J,GAASrE,GAAOmE,GAAmB,YAKvCG,GAAiB,CACfC,OAAQF,GACRG,OALWH,IAA0D,cAApD,aAA2CzD,KAM5D6D,aALiBJ,MAAY/K,GAAgBA,GAAe8K,GAAcD,GAAmB,QAAQpJ,gBCHnG0J,aAEAC,GAAmBX,GAAApK,IACnBgL,GAAuBZ,GAAAC,QACvBY,GAAW9G,OAAOA,QAAQjC,MAAM,WAEnCgJ,GAAiB,SAAUlD,EAAGvC,EAAKvJ,EAAOiP,GACzC,IAIIzB,EAJA0B,IAASD,KAAYA,EAAQC,OAC7BC,IAASF,KAAYA,EAAQlK,WAC7BqK,IAAcH,KAAYA,EAAQG,YAClCrE,EAAOkE,QAA4B5I,IAAjB4I,EAAQlE,KAAqBkE,EAAQlE,KAAOxB,EAE9DhD,EAAWvG,KACoB,YAA7BiI,OAAO8C,GAAM3J,MAAM,EAAG,KACxB2J,EAAO,IAAM9C,OAAO8C,GAAMhL,QAAO,qBAAuB,MAAQ,OAE7DoK,GAAOnK,EAAO,SAAMqP,IAAoCrP,EAAM+K,OAASA,IAC1EyB,GAA4BxM,EAAO,OAAQ+K,IAE7CyC,EAAQsB,GAAqB9O,IAClB+J,SACTyD,EAAMzD,OAASgF,GAASO,KAAoB,iBAARvE,EAAmBA,EAAO,MAG9De,IAAM3I,GAIE+L,GAEAE,GAAetD,EAAEvC,KAC3B4F,GAAS,UAFFrD,EAAEvC,GAIP4F,EAAQrD,EAAEvC,GAAOvJ,EAChBwM,GAA4BV,EAAGvC,EAAKvJ,IATnCmP,EAAQrD,EAAEvC,GAAOvJ,EAChBsJ,GAAUC,EAAKvJ,KAUrBwD,SAASa,UAAW,YAAY,WACjC,OAAOkC,EAAWhD,OAASsL,GAAiBtL,MAAMwG,QAAU6C,GAAcrJ,gBCpCnEgM,kBCRLC,GAAOtO,KAAKuO,KACZC,GAAQxO,KAAKyO,MAIjBC,GAAiB,SAAUpJ,GACzB,IAAIqJ,GAAUrJ,EAEd,OAAOqJ,GAAWA,GAAqB,IAAXA,EAAe,GAAKA,EAAS,EAAIH,GAAQF,IAAMK,ICN7E,IAAIC,GAAM5O,KAAK6O,IACXC,GAAM9O,KAAK+O,IAKfC,GAAiB,SAAUC,EAAO5Q,GAChC,IAAI6Q,EAAUR,GAAoBO,GAClC,OAAOC,EAAU,EAAIN,GAAIM,EAAU7Q,EAAQ,GAAKyQ,GAAII,EAAS7Q,cCR3D8Q,GAAMnP,KAAK+O,IAIfK,GAAiB,SAAU9J,GACzB,OAAOA,EAAW,EAAI6J,GAAIT,GAAoBpJ,GAAW,kBAAoB,GCH/E+J,GAAiB,SAAUC,GACzB,OAAOF,GAASE,EAAIjR,SCAtB,IAAIkR,GAAe,SAAUC,GAC3B,OAAO,SAAUC,EAAOC,EAAIC,GAC1B,IAGI7Q,EAHA8L,EAAIxF,EAAgBqK,GACpBpR,EAASgR,GAAkBzE,GAC3BqE,EAAQD,GAAgBW,EAAWtR,GAIvC,GAAImR,GAAeE,GAAMA,GAAE,KAASrR,EAAS4Q,GAG3C,IAFAnQ,EAAQ8L,EAAEqE,OAEGnQ,EAAO,OAAO,OAEtB,KAAMT,EAAS4Q,EAAOA,IAC3B,IAAKO,GAAeP,KAASrE,IAAMA,EAAEqE,KAAWS,EAAI,OAAOF,GAAeP,GAAS,EACnF,OAAQO,IAAe,OAIZ,CAGfI,SAAUL,IAAa,GAGvBM,QAASN,IAAa,IC3BpBM,QAGAC,GAAOvL,EAAY,GAAGkE,MAE1BsH,GAAiB,SAAUxE,EAAQyE,GACjC,IAGI3H,EAHAuC,EAAIxF,EAAgBmG,GACpBnN,EAAI,EACJ8L,EAAS,GAEb,IAAK7B,KAAOuC,GAAI3B,GAAO+C,GAAY3D,IAAQY,GAAO2B,EAAGvC,IAAQyH,GAAK5F,EAAQ7B,QAEnE2H,EAAM3R,OAASD,GAAO6K,GAAO2B,EAAGvC,EAAM2H,EAAM5R,SAAC6R,GACzC/F,EAAQ7B,IAAQyH,GAAK5F,EAAQ7B,IAExC,OAAO6B,OCjBAgG,SPELC,IQFJC,GAAiB,CACf,cACA,iBACA,gBACA,uBACA,iBACA,WACA,YRLerQ,OAAmB,SAAU,aAK9CsO,GAAYlQ,OAAOkS,qBAAuB,SAA6BzF,GACrE,OAAOmF,GAAmBnF,EAAGuF,KOR/BD,GAAY/R,OAAOyI,sBEKnB,IAAI0J,GAAS/L,EAAY,GAAGxE,QAG5BwQ,GAAiB9K,EAAW,UAAW,YAAc,SAAiBzD,GACpE,IAAI9D,EAAOmQ,GAA4BrD,GAAShJ,IAEhD,OAD4BkO,GACGI,GAAOpS,EADVgS,GACsClO,IAAO9D,GCP3EsS,GAAiB,SAAUC,EAAQ5H,EAAQ6H,GAIzC,IAHA,IAAIxS,EAAOqS,GAAQ1H,GACflG,EAAiB+H,GACjBjH,EAA2B3B,EACtB1D,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAAK,CACpC,IAAIiK,EAAMnK,EAAKE,GACV6K,GAAOwH,EAAQpI,IAAUqI,GAAczH,GAAOyH,EAAYrI,IAC7D1F,EAAe8N,EAAQpI,EAAK5E,EAAyBoF,EAAQR,gBCT/DsI,GAAW,kBAEXC,GAAW,SAAUC,EAASC,GAChC,IAAIhS,EAAQiS,GAAKC,GAAUH,IAC3B,OAAO/R,GAASmS,IACZnS,GAASoS,KACT7L,EAAWyL,GAAatO,EAAMsO,KAC5BA,IAGJE,GAAYJ,GAASO,UAAY,SAAUC,GAC7C,OAAOrK,OAAOqK,GAAQvS,QAAQ8R,GAAa,KAAKU,eAG9CN,GAAOH,GAASU,KAAO,GACvBJ,GAASN,GAASW,OAAS,IAC3BN,GAAWL,GAASY,SAAW,IAEnCC,GAAiBb,GCEjBc,EAAiB,SAAU3D,EAASlF,GAClC,IAGY4H,EAAQpI,EAAKsJ,EAAgBC,EAAgBhO,EAHrDiO,EAAS9D,EAAQ0C,OACjBqB,EAAS/D,EAAQgE,OACjBC,EAASjE,EAAQkE,KASrB,GANExB,EADEqB,EACO7P,EACA+P,EACA/P,EAAO4P,IAAWzJ,GAAUyJ,EAAQ,KAEnC5P,EAAO4P,IAAW,IAAI1O,UAEtB,IAAKkF,KAAOQ,EAAQ,CAQ9B,GAPA+I,EAAiB/I,EAAOR,GAGtBsJ,EAFE5D,EAAQG,aACVtK,EAAUsO,GAA4BzB,EAAQpI,KACfzE,EAAW9E,MACpB2R,EAAOpI,IACtBoJ,GAASK,EAASzJ,EAAMwJ,GAAUG,EAAS,IAAM,KAAO3J,EAAK0F,EAAQoE,cAE5ChN,IAAnBwM,EAA8B,CAC3C,UAAWC,UAAyBD,EAAgB,SACpDnB,GAA0BoB,EAAgBD,IAGxC5D,EAAQ/G,MAAS2K,GAAkBA,EAAe3K,OACpDsE,GAA4BsG,EAAgB,QAAQ,GAGtD9D,GAAS2C,EAAQpI,EAAKuJ,EAAgB7D,qBCjDtCqE,GAAO,GAEXA,GAHoBxI,GAAgB,gBAGd,IAEtByI,GAAkC,eAAjBtL,OAAOqL,ICDxB,IAAIE,GAAgB1I,GAAgB,eAChC2I,GAAStQ,EAAA9D,OAGTqU,GAAuE,aAAnD7N,EAAW,WAAc,OAAOlD,UAArB,IAUnCgR,GAAiBJ,GAAwB1N,EAAa,SAAU3C,GAC9D,IAAI4I,EAAG8H,EAAKxI,EACZ,YAAc/E,IAAPnD,EAAmB,YAAqB,OAAPA,EAAc,OAEM,iBAAhD0Q,EAXD,SAAU1Q,EAAIqG,GACzB,IACE,OAAOrG,EAAGqG,GACV,MAAO3F,KAQSiQ,CAAO/H,EAAI2H,GAAOvQ,GAAKsQ,KAA8BI,EAEnEF,GAAoB7N,EAAWiG,GAEH,WAA3BV,EAASvF,EAAWiG,KAAmBvF,EAAWuF,EAAEgI,QAAU,YAAc1I,GCzBnF,IAAI2I,GAAS5Q,EAAA8E,OAEb+L,GAAiB,SAAUxN,GACzB,GAA0B,WAAtBmN,GAAQnN,GAAwB,MAAML,UAAU,6CACpD,OAAO4N,GAAOvN,WCIZoF,GAGAqI,GAAe9Q,EAAA6E,OACfkM,GAAkBD,IAAgBA,GAAa5P,UAEnD,GAAIZ,GAAe8C,EAAW0N,QAAoB,gBAAiBC,UAElC7N,IAA/B4N,KAAejJ,aACd,CACD,IAAImJ,GAA8B,GAE9BC,GAAgB,WAClB,IAAIpJ,EAAcrI,UAAUpD,OAAS,QAAsB8G,IAAjB1D,UAAU,QAAmB0D,EAAY2N,GAASrR,UAAU,IAClGyI,EAAStE,EAAcoN,GAAiB3Q,MACxC,IAAI0Q,GAAajJ,QAED3E,IAAhB2E,EAA4BiJ,KAAiBA,GAAajJ,GAE9D,MADoB,KAAhBA,IAAoBmJ,GAA4B/I,IAAU,GACvDA,GAGTsG,GAA0B0C,GAAeH,IACzCG,GAAc/P,UAAY6P,GAC1BA,GAAgBG,YAAcD,GAE9B,IAAIE,GAAgD,gBAAhCrM,OAAOgM,GAAa,SACpCM,GAAiB9O,EAAYyO,GAAgBvO,UAC7C6O,GAAgB/O,EAAYyO,GAAgB9K,SAC5CqL,GAAM,wBACNC,GAAUjP,EAAY,GAAG1F,SACzB4U,GAAclP,EAAY,GAAGrE,UAElB8S,GAAiB,cAAe,CAC7ChP,cAAc,EACdpB,IAAK,WACH,IAAIiE,EAASyM,GAAcjR,MACvB+O,EAASiC,GAAexM,GAC5B,GAAIoC,GAAOgK,GAA6BpM,GAAS,MAAO,GACxD,IAAI6M,EAAON,GAAgBK,GAAYrC,EAAQ,GAAG,GAAMoC,GAAQpC,EAAQmC,GAAQ,MAChF,MAAgB,KAATG,OAAcvO,EAAYuO,KAIrChC,EAAE,CAAEK,QAAQ,EAAMI,QAAQ,GAAQ,CAChCrL,OAAQoM,YCtDHS,SCATC,GAAiB3R,EDAjB0R,GAAY/J,UECRc,IAEJmJ,GAAiB,SAAUC,GACzB,IAAIhN,EAAS8M,GAAA9M,SAAgB8M,GAAA9M,OAAc,IACtCmC,GAAOnC,EAAQgN,IAAIC,GAAkBjN,EAAQgN,EAAM,CACtDhV,MAAO6U,GAA+BG,OCJpB,iCCCtBE,GAAiBC,MAAMC,SAAW,SAAiB5O,GACjD,MAA4B,SAArBX,EAAQW,WCFb6O,GAAO5P,EAAYA,EAAYxB,MAGnCqR,GAAiB,SAAU5P,EAAI6P,GAE7B,OADA5M,GAAUjD,QACMW,IAATkP,EAAqB7P,EAAK3B,EAAcsR,GAAK3P,EAAI6P,GAAQ,WAC9D,OAAO7P,EAAGhD,MAAM6S,EAAM5S,aCJ1B,IAAI6S,GAAYrS,EAAAgD,UAIZsP,GAAmB,SAAU9D,EAAQ+D,EAAU3L,EAAQ4L,EAAWC,EAAOC,EAAOC,EAAQC,OAC1F,IAGIC,EAASC,EAHTC,EAAcN,EACdO,EAAc,EACdC,IAAQN,GAASR,GAAKQ,EAAQC,GAG3BI,EAAcR,GAAW,CAC9B,GAAIQ,KAAepM,EAAQ,CAGzB,GAFAiM,EAAUI,EAAQA,EAAMrM,EAAOoM,GAAcA,EAAaT,GAAY3L,EAAOoM,GAEzEN,EAAQ,GAAKX,GAAQc,GACvBC,EAAa1F,GAAkByF,GAC/BE,EAAcT,GAAiB9D,EAAQ+D,EAAUM,EAASC,EAAYC,EAAaL,EAAQ,GAAK,MAC3F,CACL,GAAIK,GAAe,iBAAkB,MAAMV,GAAU,sCACrD7D,EAAOuE,GAAeF,EAGxBE,IAEFC,IAEF,OAAOD,GAGTG,GAAiBZ,mBC5Bba,GAAO,aACPC,GAAQ,GACRC,GAAY7P,EAAW,UAAW,aAClC8P,GAAiB,2BACjBC,GAAOjR,EAAYgR,GAAkB9S,MACrCgT,IAAuBF,GAAkB9S,KAAK2S,IAE9CM,GAAsB,SAAuBpQ,GAC/C,IAAKD,EAAWC,GAAW,OAAO,EAClC,IAEE,OADAgQ,GAAUF,GAAMC,GAAO/P,IAChB,EACP,MAAO5C,GACP,OAAO,IAIPiT,GAAsB,SAAuBrQ,GAC/C,IAAKD,EAAWC,GAAW,OAAO,EAClC,OAAQmN,GAAQnN,IACd,IAAK,gBACL,IAAK,oBACL,IAAK,yBAA0B,OAAO,EAExC,IAIE,OAAOmQ,MAAyBD,GAAKD,GAAmB7J,GAAcpG,IACtE,MAAO5C,GACP,OAAO,IAIXiT,GAAoB3O,MAAO,EAI3B4O,IAAkBN,IAAa9S,GAAM,WACnC,IAAIqT,EACJ,OAAOH,GAAoBA,GAAoBtS,QACzCsS,GAAoBvX,UACpBuX,IAAoB,WAAcG,GAAS,MAC5CA,KACFF,GAAsBD,GC7C3B,IAAII,GAAUlM,GAAgB,WAC1BmM,GAAQ9T,EAAAgS,MAIZ+B,GAAiB,SAAUC,GACzB,IAAIC,EASF,OARElC,GAAQiC,KACVC,EAAID,EAAc9C,aAEdyC,GAAcM,KAAOA,IAAMH,IAAS/B,GAAQkC,EAAE/S,aACzCoC,EAAS2Q,IAEN,QADVA,EAAIA,EAAEJ,QAFuDI,OAAI/Q,SAKtDA,IAAN+Q,EAAkBH,GAAQG,GCjBrCC,GAAiB,SAAUF,EAAe5X,GACxC,OAAO,IAAK2X,GAAwBC,GAA7B,CAAwD,IAAX5X,EAAe,EAAIA,ICKzEqT,EAAE,CAAEjB,OAAQ,QAAS2F,OAAO,GAAQ,CAClCC,KAAM,WACJ,IAAIC,EAAW7U,UAAUpD,OAASoD,UAAU,QAAK0D,EAC7CyF,EAAI7B,GAAS1G,MACboS,EAAYpF,GAAkBzE,GAC9B2L,EAAIJ,GAAmBvL,EAAG,GAE9B,OADA2L,EAAElY,OAAS8W,GAAiBoB,EAAG3L,EAAGA,EAAG6J,EAAW,OAAgBtP,IAAbmR,EAAyB,EAAI5H,GAAoB4H,IAC7FC,KCPX7E,EAAE,CAAEjB,OAAQ,QAAS2F,OAAO,GAAQ,CAClCI,QAAS,SAAiBC,GACxB,IAEIF,EAFA3L,EAAI7B,GAAS1G,MACboS,EAAYpF,GAAkBzE,GAKlC,OAHAnD,GAAUgP,IACVF,EAAIJ,GAAmBvL,EAAG,IACxBvM,OAAS8W,GAAiBoB,EAAG3L,EAAGA,EAAG6J,EAAW,EAAG,EAAGgC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GACjGoR,eCRFG,eCJTC,GAAiBxY,OAAOD,MAAQ,SAAc0M,GAC5C,OAAOmF,GAAmBnF,EAAGwF,KDG/BsG,GAAYnU,IAAgBsI,GAA0B1M,OAAOyY,iBAAmB,SAA0BhM,EAAGiM,GAC3G7L,GAASJ,OACT,IAIIvC,EAJAyO,EAAQ1R,EAAgByR,GACxB3Y,EAAOyY,GAAWE,GAClBxY,EAASH,EAAKG,OACd4Q,EAAQ,EAEL5Q,EAAS4Q,GAAOvE,GAAuBE,EAAGvC,EAAMnK,EAAK+Q,KAAU6H,EAAMzO,IAC5E,OAAOuC,aEhBTmM,GAAiBtR,EAAW,WAAY,mBCOxC,IA2CIuR,GAvCAC,GAAWlL,GAAU,YAErBmL,GAAmB,aAEnBC,GAAY,SAAUC,GACxB,MAAOC,WAAmBD,EAAnBC,cAILC,GAA4B,SAAUC,GACxCA,EAAgBC,MAAML,GAAU,KAChCI,EAAgBE,QAChB,IAAIC,EAAOH,EAAgBI,aAAaxZ,OAExC,OADAoZ,EAAkB,KACXG,GA0BLE,GAAkB,WACpB,IACEZ,GAAkB,IAAIa,cAAc,YACpC,MAAOnV,IAzBoB,IAIzBoV,EAFAC,EAwBJH,GAAqC,oBAAZnX,SACrBA,SAASuX,QAAUhB,GACjBM,GAA0BN,MA1B5Be,EAASxN,GAAsB,WAG5B0N,MAAMC,QAAU,OACvBnB,GAAA9V,YAAiB8W,GAEjBA,EAAOI,IAAMpR,OALJ,gBAMT+Q,EAAiBC,EAAOK,cAAc3X,UACvB4X,OACfP,EAAeN,MAAML,GAAU,sBAC/BW,EAAeL,QACRK,EAAeQ,GAiBlBhB,GAA0BN,QAC9B,IAAI3Y,EAAS+R,GAAA/R,OACNA,YAAiBuZ,GAAyB,UAAExH,GAAY/R,IAC/D,OAAOuZ,MAGT5L,GAAWiL,KAAY,EAIvBsB,GAAiBpa,OAAOqa,QAAU,SAAgB5N,EAAGiM,GACnD,IAAI3M,EAQJ,OAPU,OAANU,GACFsM,GAA0B,UAAIlM,GAASJ,GACvCV,EAAS,IAAIgN,GACbA,GAA0B,UAAI,KAE9BhN,EAAO+M,IAAYrM,GACdV,EAAS0N,UACMzS,IAAf0R,EAA2B3M,EAASwM,GAAyBxM,EAAQ2M,IC5E9E,IAAI4B,GAAc7O,GAAgB,eAC9B8O,GAAiBzE,MAAM9Q,UAIQgC,MAA/BuT,GAAeD,KACjB/N,GAAuBgO,GAAgBD,GAAa,CAClDzU,cAAc,EACdlF,MAAOyZ,GAAO,QAKlBI,GAAiB,SAAUtQ,GACzBqQ,GAAeD,IAAapQ,IAAO,aClBrCuQ,GAAiB,sBCKblO,SCHJmO,IAAkBrW,GAAM,oBACb8V,KAGT,OAFAA,EAAEnV,UAAUgQ,YAAc,KAEnBhV,OAAO2a,eAAe,IAAIR,KAASA,EAAEnV,aCC9C,IAAI4V,GAAWhN,GAAU,YACrBiN,GAAS/W,EAAA9D,OACT8a,GAAkBD,GAAO7V,UAI7B+V,GAAiBL,GAA2BG,GAAOF,eAAiB,SAAUlO,GAC5E,IAAIW,EAASxC,GAAS6B,GACtB,GAAI3B,GAAOsC,EAAQwN,IAAW,OAAOxN,EAAOwN,IAC5C,IAAI5F,EAAc5H,EAAO4H,YACzB,OAAI9N,EAAW8N,IAAgB5H,aAAkB4H,EACxCA,EAAYhQ,UACZoI,aAAkByN,GAASC,GAAkB,MCVxD,IAKIE,GAAmBC,GAAmCC,GALtDC,GAAW1P,GAAgB,YAC3B2P,IAAyB,EAOzB,GAAGrb,OAGC,SAFNmb,GAAgB,GAAGnb,SAIjBkb,GAAoCF,GAAeA,GAAeG,QACxBlb,OAAOgF,YAAWgW,GAAoBC,IAHlDG,IAAyB,IAOTpU,MAArBgU,IAAkC3W,GAAM,WACnE,IAAIM,EAAO,GAEX,OAAOqW,GAAkBG,IAAUlW,KAAKN,KAAUA,QAGxBqW,GAAoB,IAK3C9T,EAAW8T,GAAkBG,MAChCxL,GAASqL,GAAmBG,IAAU,WACpC,OAAOjX,mBAIXmX,GAAiB,CACfC,kBAAmBN,GACnBO,uBAAwBH,KC7CtBE,qBCDA/O,GAIAiP,GAAgB/P,GAAgB,eAEpCgQ,GAAiB,SAAUnJ,EAAQoJ,EAAK7H,GAClCvB,IAAWuB,IAAQvB,EAASA,EAAOtN,WACnCsN,IAAWxH,GAAOwH,EAAQkJ,KAAaG,GAC1BrJ,EAAQkJ,GAAe,CAAE3V,cAAc,EAAMlF,MAAO+a,KDFvE,IAAIE,GAAa,WAAc,OAAO1X,MAEtC2X,GAAiB,SAAUC,EAAqBnG,EAAMoG,EAAMC,GAC1D,IAAIC,EAAgBtG,EAAO,YAI3B,OAHAmG,EAAoB9W,UAAYoV,GAAM8B,GAAoB,CAAEH,KAAMpW,IAA2BqW,EAAiBD,KAC9GN,GAAeK,EAAqBG,GAAe,GACnDxB,GAAUwB,GAAiBL,GACpBE,gBEXLK,GAASrY,EAAA8E,OACTwT,GAAYtY,EAAAgD,UAEhBuV,GAAiB,SAAUlV,GACzB,GAAuB,iBAAZA,GAAwBD,EAAWC,GAAW,OAAOA,EAChE,MAAMiV,GAAU,aAAeD,GAAOhV,GAAY,oBCCpDmV,GAAiBtc,OAAOuc,iBAAmB,aAAe,GAAE,WAC1D,IAEIC,EAFAC,GAAiB,EACjB9X,EAAO,GAEX,KAEE6X,EAASpW,EAAYpG,OAAOsF,yBAAyBtF,OAAOgF,UAAW,aAAayJ,MAC7E9J,EAAM,IACb8X,EAAiB9X,aAAgBmR,MACjC,MAAOvR,IACT,OAAO,SAAwBkI,EAAGwL,GAKhC,OAJApL,GAASJ,GACT4P,GAAmBpE,GACfwE,EAAgBD,EAAO/P,EAAGwL,GACzBxL,EAAEiQ,UAAYzE,EACZxL,GAfiD,QAiBtDzF,GCVN,IAAI2V,GAAuBvN,GAAAE,OACvBsN,GAA6BxN,GAAAG,aAC7BsN,GAAoBxB,GAAAC,kBACpBwB,GAAyBzB,GAAAE,uBACzBwB,GAAWtR,GAAgB,YAK3BuR,GAAa,WAAc,OAAO9Y,MAEtC+Y,GAAiB,SAAUC,EAAUvH,EAAMmG,EAAqBC,EAAMoB,EAASC,EAAQC,GACrFxB,GAA0BC,EAAqBnG,EAAMoG,GAErD,IAkBIuB,EAA0BC,EAASC,EAlBnCC,EAAqB,SAAUC,GACjC,GAAIA,IAASP,GAAWQ,EAAiB,OAAOA,EAChD,IAAKb,IAA0BY,KAAQE,EAAmB,OAAOA,EAAkBF,GACnF,OAAQA,GACN,IAbK,OAcL,IAbO,SAcP,IAbQ,UAaM,OAAO,WAAqB,OAAO,IAAI5B,EAAoB5X,KAAMwZ,IAC/E,OAAO,WAAc,OAAO,IAAI5B,EAAoB5X,QAGpD+X,EAAgBtG,EAAO,YACvBkI,GAAwB,EACxBD,EAAoBV,EAASlY,UAC7B8Y,EAAiBF,EAAkBb,KAClCa,EAAkB,eAClBT,GAAWS,EAAkBT,GAC9BQ,GAAmBb,IAA0BgB,GAAkBL,EAAmBN,GAClFY,EAA4B,SAARpI,GAAkBiI,EAAkBI,SAA4BF,EA+BxF,GA3BIC,IACFT,EAA2BvC,GAAegD,EAAkB9Y,KAAK,IAAIiY,OACpCld,OAAOgF,WAAasY,EAAyBvB,OAC5DhB,GAAeuC,KAA8BT,KACvDP,GACFA,GAAegB,EAA0BT,IAC/B3V,EAAWoW,EAAyBP,MAC9CpN,GAAS2N,EAA0BP,GAAUC,KAIjDvB,GAAe6B,EAA0BrB,GAAe,IAMxDU,IA9CO,UA8CiBQ,GAAqBW,GA9CtC,WA8CwDA,EAAepS,OAChEkR,GACdzP,GAA4ByQ,EAAmB,OAhDxC,WAkDPC,GAAwB,EACxBF,EAAkB,WAAoB,OAAOzY,EAAK4Y,EAAgB5Z,SAKlEiZ,EAMF,GALAI,EAAU,CACRU,OAAQR,EA1DD,UA2DP1d,KAAMqd,EAASO,EAAkBF,EA5D5B,QA6DLO,QAASP,EA3DD,YA6DNJ,EAAQ,IAAKG,KAAOD,GAClBT,IAA0Be,KAA2BL,KAAOI,KAC9DjO,GAASiO,EAAmBJ,EAAKD,EAAQC,SAEtCjK,EAAE,CAAEjB,OAAQqD,EAAMsC,OAAO,EAAMjE,OAAQ8I,IAA0Be,GAAyBN,GASnG,OAL4BK,EAAkBb,MAAcY,GAC1DhO,GAASiO,EAAmBb,GAAUY,EAAiB,CAAEjS,KAAMyR,IAEjE1C,GAAU9E,GAAQgI,EAEXJ,GRvFT,IACIW,GAAmBrP,GAAAJ,IACnB0P,GAAmBtP,GAAAE,UAFF,kBAcrBqP,GAAiBnB,GAAenH,MAAO,SAAS,SAAUuI,EAAUC,GAClEJ,GAAiBha,KAAM,CACrBzB,KAhBiB,iBAiBjB6P,OAAQrL,EAAgBoX,GACxBvN,MAAO,EACPwN,KAAMA,OAIP,WACD,IAAInQ,EAAQgQ,GAAiBja,MACzBoO,EAASnE,EAAMmE,OACfgM,EAAOnQ,EAAMmQ,KACbxN,EAAQ3C,EAAM2C,QAClB,OAAKwB,GAAUxB,GAASwB,EAAOpS,QAC7BiO,EAAMmE,YAAStL,EACR,CAAErG,WAAOqG,EAAWuX,MAAM,IAEvB,QAARD,EAAuB,CAAE3d,MAAOmQ,EAAOyN,MAAM,GACrC,UAARD,EAAyB,CAAE3d,MAAO2R,EAAOxB,GAAQyN,MAAM,GACpD,CAAE5d,MAAO,CAACmQ,EAAOwB,EAAOxB,IAASyN,MAAM,KAC7C,UAKH,IAAIC,GAAS/D,GAAAgE,UAAsBhE,GAAA3E,MAQnC,GALA0E,GAAiB,QACjBA,GAAiB,UACjBA,GAAiB,WAGDpW,GAA+B,WAAhBoa,GAAO9S,KAAmB,OACxC8S,GAAQ,OAAQ,CAAE7d,MAAO,WACxC,MAAO4D,cStDLma,GAAY5a,EAAAgD,UAGZ6X,GAAe,SAAUC,GAC3B,OAAO,SAAU1I,EAAMoC,EAAYuG,EAAiBC,GAClDxV,GAAUgP,GACV,IAAI7L,EAAI7B,GAASsL,GACbjS,EAAO2C,EAAc6F,GACrBvM,EAASgR,GAAkBzE,GAC3BqE,EAAQ8N,EAAW1e,EAAS,EAAI,EAChCD,EAAI2e,GAAW,EAAK,EACxB,GAAIC,EAAkB,EAAC,OAAe,CACpC,GAAI/N,KAAS7M,EAAM,CACjB6a,EAAO7a,EAAK6M,GACZA,GAAS7Q,EACT,MAGF,GADA6Q,GAAS7Q,EACL2e,EAAW9N,EAAQ,EAAI5Q,GAAU4Q,EACnC,MAAM4N,GAAU,+CAGpB,KAAME,EAAW9N,GAAS,EAAI5Q,EAAS4Q,EAAOA,GAAS7Q,EAAO6Q,KAAS7M,IACrE6a,EAAOxG,EAAWwG,EAAM7a,EAAK6M,GAAQA,EAAOrE,IAE9C,OAAOqS,QAIXC,GAAiB,CAGfC,KAAML,IAAa,GAGnBM,MAAON,IAAa,KCvClBK,KCCJE,GAAiB,SAAUC,EAAahY,GACtC,IAAIK,EAAS,GAAG2X,GAChB,QAAS3X,GAAUnD,GAAM,WAEvBmD,EAAOvC,KAAK,KAAMkC,GAAY,WAAc,MAAM,GAAM,cCJ5DiY,GAA4C,WAA3B5Y,EAAQ1C,EAAAiE,SFIzB,IAAIsX,GAAgBH,GAAoB,UAOxC3L,EAAE,CAAEjB,OAAQ,QAAS2F,OAAO,EAAMjE,QAASqL,KAJzBD,IAAW7W,EAAiB,IAAMA,EAAiB,IAIK,CACxE+W,OAAQ,SAAgBhH,GACtB,IAAIpY,EAASoD,UAAUpD,OACvB,OAAMqf,GAASrb,KAAMoU,EAAYpY,EAAQA,EAAS,EAAIoD,UAAU,QAAK0D,aGfrE+X,GAAAE,MAKAO,GAAgBN,GAAoB,eAOxC3L,EAAE,CAAEjB,OAAQ,QAAS2F,OAAO,EAAMjE,QAASwL,KAJzBJ,IAAW7W,EAAiB,IAAMA,EAAiB,IAIK,CACxEkX,YAAa,SAAqBnH,GAChC,OAAMoH,GAAcxb,KAAMoU,EAAYhV,UAAUpD,OAAQoD,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,sBCXlG2Y,GAAiB,SAAUvS,EAAQlD,EAAKvJ,GACtC,IAAIif,EAAc3T,EAAc/B,GAC5B0V,KAAexS,EAAQb,GAAuBa,EAAQwS,EAAaja,EAAyB,EAAGhF,IAC9FyM,EAAOwS,GAAejf,GCH7B,IAAIkf,GAAQ/b,EAAAgS,MACRgK,GAAMje,KAAK6O,IAEfqP,GAAiB,SAAUtT,EAAG8J,EAAOyJ,GAKnC,IAJA,IAAI9f,EAASgR,GAAkBzE,GAC3BwT,EAAIpP,GAAgB0F,EAAOrW,GAC3BggB,EAAMrP,QAAwB7J,IAARgZ,EAAoB9f,EAAS8f,EAAK9f,GACxD6L,EAAS8T,GAAMC,GAAII,EAAMD,EAAG,IACvBE,EAAI,EAAGF,EAAIC,EAAKD,IAAKE,IAAKR,GAAe5T,EAAQoU,EAAG1T,EAAEwT,IAE/D,OADAlU,EAAO7L,OAASigB,EACTpU,GCbT,IAAIqU,GAAQve,KAAKyO,MAEb+P,GAAY,SAAUC,EAAOC,GAC/B,IAAIrgB,EAASogB,EAAMpgB,OACfsgB,EAASJ,GAAMlgB,EAAS,GAC5B,OAAOA,EAAS,EAAIugB,GAAcH,EAAOC,GAAaG,GACpDJ,EACAD,GAAUN,GAAWO,EAAO,EAAGE,GAASD,GACxCF,GAAUN,GAAWO,EAAOE,GAASD,GACrCA,IAIAE,GAAgB,SAAUH,EAAOC,OACnC,IAEI5J,EAASgK,EAFTzgB,EAASogB,EAAMpgB,OACfD,EAAI,EAGDA,EAAIC,GAAQ,KACjBygB,EAAI1gB,EACJ0W,EAAU2J,EAAMrgB,GACT0gB,GAAKJ,EAAUD,EAAMK,EAAI,GAAIhK,GAAW,GAC7C2J,EAAMK,GAAKL,IAAQK,GAEjBA,IAAM1gB,MAAKqgB,EAAMK,GAAKhK,GAC1B,OAAO2J,GAGPI,GAAQ,SAAUJ,EAAOtB,EAAMC,EAAOsB,OACxC,IAAIK,EAAU5B,EAAK9e,OACf2gB,EAAU5B,EAAM/e,OAChB4gB,EAAS,EACTC,EAAS,EAEND,EAASF,GAAWG,EAASF,GAClCP,EAAMQ,EAASC,GAAWD,EAASF,GAAWG,EAASF,EACnDN,EAAUvB,EAAK8B,GAAS7B,EAAM8B,KAAY,EAAI/B,EAAK8B,KAAY7B,EAAM8B,KACrED,EAASF,EAAU5B,EAAK8B,KAAY7B,EAAM8B,KAC9C,OAAOT,GAGXU,GAAiBX,UCzCbY,GAAUtZ,EAAA5G,MAAe,mBAE7BmgB,KAAmBD,KAAYA,GAAQ,UCFvCE,GAAc,eAAkBxc,KAAKgD,UCAjCyZ,GAASzZ,EAAA5G,MAAe,wBAE5BsgB,KAAmBD,KAAWA,GAAO,GCWrC,IAAIE,GAAO,GACPC,GAAUnb,EAAYkb,GAAKE,MAC3BC,GAAOrb,EAAYkb,GAAKhX,MAGxBoX,GAAqBrd,GAAM,WAC7Bid,GAAKE,UAAKxa,MAGR2a,GAAgBtd,GAAM,WACxBid,GAAKE,KAAK,SAGRI,GAAgB1C,GAAoB,QAEpC2C,IAAexd,GAAM,WAEvB,GAAIkE,EAAI,OAAOA,EAAK,GACpB,KAAI2Y,IAAMA,GAAK,GAAf,CACA,GAAIC,GAAY,OAAO,EACvB,GAAIE,GAAQ,OAAOA,GAAS,IAE5B,IACIS,EAAMC,EAAKphB,EAAOmQ,EADlB/E,EAAS,GAIb,IAAK+V,EAAO,GAAIA,EAAO,GAAIA,IAAQ,CAGjC,OAFAC,EAAMnZ,OAAOoZ,aAAaF,GAElBA,GACN,KAAK,GAAI,KAAK,GAAI,KAAK,GAAI,KAAK,GAAInhB,EAAQ,EAAG,MAC/C,KAAK,GAAI,KAAK,GAAIA,EAAQ,EAAG,cACpBA,EAAQ,EAGnB,IAAKmQ,EAAQ,EAAGA,EAAQ,GAAIA,IAC1BwQ,GAAKhX,KAAK,CAAE2V,EAAG8B,EAAMjR,EAAOmR,EAAGthB,IAMnC,IAFA2gB,GAAKE,MAAK,SAAUlV,EAAG4V,GAAK,OAAOA,EAAED,EAAI3V,EAAE2V,KAEtCnR,EAAQ,EAAGA,EAAQwQ,GAAKphB,OAAQ4Q,IACnCiR,EAAMT,GAAKxQ,GAAOmP,EAAEkC,OAAO,GACvBpW,EAAOoW,OAAOpW,EAAO7L,OAAS,KAAO6hB,IAAKhW,GAAUgW,GAG1D,MAAkB,gBAAXhW,MAgBTwH,EAAE,CAAEjB,OAAQ,QAAS2F,OAAO,EAAMjE,OAbrB0N,KAAuBC,KAAkBC,KAAkBC,IAapB,CAClDL,KAAM,SAAcjB,QACAvZ,IAAduZ,GAAyBjX,GAAUiX,GAEvC,IAAID,EAAQ1V,GAAS1G,MAErB,GAAI2d,GAAa,YAAqB7a,IAAduZ,EAA0BgB,GAAQjB,GAASiB,GAAQjB,EAAOC,GAElF,IAEI6B,EAAatR,EAFbuR,EAAQ,GACRC,EAAcpR,GAAkBoP,GAGpC,IAAKxP,EAAQ,EAAGA,EAAQwR,EAAaxR,IAC/BA,KAASwP,GAAOmB,GAAKY,EAAO/B,EAAMxP,QAGxCkQ,GAAaqB,EA3BI,SAAU9B,GAC7B,OAAO,SAAUgC,EAAGC,GAClB,YAAUxb,IAANwb,GAAwB,OAClBxb,IAANub,EAAwB,OACVvb,IAAduZ,GAAiCA,EAAUgC,EAAGC,IAAM,EACjD7N,GAAS4N,GAAK5N,GAAS6N,GAAK,GAAI,GAsBnBC,CAAelC,IAEnC6B,EAAcC,EAAMniB,OACpB4Q,EAAQ,EAEDA,EAAQsR,GAAa9B,EAAMxP,GAASuR,EAAMvR,UAC1CA,EAAQwR,UAAoBhC,EAAMxP,KAEzC,OAAOwP,KCjGX9F,GAAiB,QCAjBA,GAAiB,WCFjB,IAAIkI,GAAS7gB,KAAK8gB,MACdC,GAAM/gB,KAAKghB,IACXC,GAAOjhB,KAAKkhB,KAIZC,KAAUN,IAAUA,GAAOO,EAAAA,EAAUC,OAASD,EAAAA,EAIlD1P,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,EAAME,OAAQgP,IAAS,CAE/CL,MAAO,SAAeQ,EAAQC,OAC5B,IAIIC,EAAKC,EAJLC,EAAM,EACNtjB,EAAI,EACJujB,EAAOlgB,UAAUpD,OACjBujB,EAAO,EAEJxjB,EAAIujB,GAELC,GADJJ,EAAMT,GAAItf,UAAUrD,QAGlBsjB,EAAMA,GADND,EAAMG,EAAOJ,GACKC,EAAM,EACxBG,EAAOJ,GAGPE,GAFSF,EAAM,GACfC,EAAMD,EAAMI,GACCH,EACDD,EAEhB,OAAOI,IAASR,EAAAA,EAAWA,EAAAA,EAAWQ,EAAOX,GAAKS,aCzBtDG,IAA6Brf,GAAM,WAGjC,KAAIgd,IAAUA,GAAS,KAAvB,CACA,IAAInX,EAAMrI,KAAKC,SAGf6hB,iBAAiB1e,KAAK,KAAMiF,GAAK,sBAC1BpG,EAAOoG,OCLZ9F,GACFmP,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMjE,OAAQ0P,IAAU,CACnDE,iBAAkB,SAA0Bpa,EAAGqa,GAC7CtX,GAAuB3B,GAAS1G,MAAOsF,EAAG,CAAE/E,IAAK6E,GAAUua,GAASne,YAAY,EAAMG,cAAc,OCHtGzB,GACFmP,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMjE,OAAQ0P,IAAU,CACnDC,iBAAkB,SAA0Bna,EAAGgT,GAC7CjQ,GAAuB3B,GAAS1G,MAAOsF,EAAG,CAAEiF,IAAKnF,GAAUkT,GAAS9W,YAAY,EAAMG,cAAc,iBCVtGie,GAAWrY,GAAgB,YAC3BsY,GAAiBjO,MAAM9Q,UAG3Bgf,GAAiB,SAAUngB,GACzB,YAAcmD,IAAPnD,IAAqB4W,GAAA3E,QAAoBjS,GAAMkgB,GAAeD,MAAcjgB,cCHjFogB,GAAWxY,GAAgB,YAE/ByY,GAAiB,SAAUrgB,GACzB,GAAUmD,MAANnD,EAAiB,OAAO0F,EAAU1F,EAAIogB,KACrC1a,EAAU1F,EAAI,eACd4W,GAAUnG,GAAQzQ,KCHzB,IAAIsgB,GAAYrgB,EAAAgD,UAEhBsd,GAAiB,SAAUjd,EAAUkd,GACnC,IAAIC,EAAiBhhB,UAAUpD,OAAS,EAAIgkB,GAAkB/c,GAAYkd,EAC1E,GAAI/a,GAAUgb,GAAiB,OAAOzX,GAAS3H,EAAKof,EAAgBnd,IACpE,MAAMgd,GAAU/a,GAAYjC,GAAY,4BCR1Cod,GAAiB,SAAUxb,EAAUuV,EAAM3d,GACzC,IAAI6jB,EAAaC,EACjB5X,GAAS9D,GACT,IAEE,KADAyb,EAAcjb,EAAUR,EAAU,WAChB,CAChB,GAAa,UAATuV,EAAkB,MAAM3d,EAC5B,OAAOA,EAET6jB,EAActf,EAAKsf,EAAazb,GAChC,MAAOxE,GACPkgB,GAAa,EACbD,EAAcjgB,EAEhB,GAAa,UAAT+Z,EAAkB,MAAM3d,EAC5B,GAAI8jB,EAAY,MAAMD,EAEtB,OADA3X,GAAS2X,GACF7jB,GCTT,IAAI+jB,GAAY5gB,EAAAgD,UAEZ6d,GAAS,SAAUC,EAAS7Y,GAC9B7H,KAAK0gB,QAAUA,EACf1gB,KAAK6H,OAASA,GAGZ8Y,GAAkBF,GAAO3f,UAE7B8f,GAAiB,SAAUC,EAAUC,EAAiBpV,GACpD,IAKI7G,EAAUkc,EAAQnU,EAAO5Q,EAAQ6L,EAAQgQ,EAAMmJ,EAL/ChP,EAAOtG,GAAWA,EAAQsG,KAC1BiP,KAAgBvV,IAAWA,EAAQuV,YACnCC,KAAiBxV,IAAWA,EAAQwV,aACpCC,KAAiBzV,IAAWA,EAAQyV,aACpChf,EAAK4P,GAAK+O,EAAiB9O,GAG3BoP,EAAO,SAAUC,GAEnB,OADIxc,GAAUwb,GAAcxb,EAAU,SAAUwc,GACzC,IAAIZ,IAAO,EAAMY,IAGtBC,EAAS,SAAU7kB,GACrB,OAAIwkB,GACFtY,GAASlM,GACF0kB,EAAchf,EAAG1F,EAAM,GAAIA,EAAM,GAAI2kB,GAAQjf,EAAG1F,EAAM,GAAIA,EAAM,KAChE0kB,EAAchf,EAAG1F,EAAO2kB,GAAQjf,EAAG1F,IAG9C,GAAIykB,EACFrc,EAAWgc,MACN,CAEL,KADAE,EAASf,GAAkBa,IACd,MAAML,GAAUtb,GAAY2b,GAAY,oBAErD,GAAIf,GAAsBiB,GAAS,CACjC,IAAKnU,EAAQ,EAAG5Q,EAASgR,GAAkB6T,GAAW7kB,EAAS4Q,EAAOA,IAEpE,IADA/E,EAASyZ,EAAOT,EAASjU,MACXrJ,EAAcod,GAAiB9Y,GAAS,OAAOA,EAC7D,OAAO,IAAI4Y,IAAO,GAEtB5b,EAAWqb,GAAYW,EAAUE,OAGnClJ,EAAOhT,EAASgT,OACPmJ,EAAOhgB,EAAK6W,EAAMhT,IAAWwV,MAAM,CAC1C,IACExS,EAASyZ,EAAON,EAAKvkB,OACrB,MAAO4D,GACPggB,GAAcxb,EAAU,QAASxE,GAEnC,GAAqB,iBAAVwH,GAAsBA,GAAUtE,EAAcod,GAAiB9Y,GAAS,OAAOA,EAC1F,OAAO,IAAI4Y,IAAO,IC1DtBpR,EAAE,CAAEjB,OAAQ,SAAUwB,MAAM,GAAQ,CAClC2R,YAAa,SAAqBV,GAChC,IAAI5T,EAAM,GAIV,OAHA2T,GAAQC,GAAU,SAAU9E,EAAGgC,GAC7BtC,GAAexO,EAAK8O,EAAGgC,KACtB,CAAEkD,YAAY,IACVhU,YCLPxN,EAIAS,GACFmP,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMjE,OAAQ0P,IAAU,CACnDgC,iBAAkB,SAA0Blc,GAC1C,IAEI+L,EAFA9I,EAAI7B,GAAS1G,MACbgG,EAAM+B,EAAczC,MAGtB,GAAI+L,EAAIoQ,GAA4BlZ,EAAGvC,GAAM,OAAOqL,EAAK9Q,UAClDgI,EAAIsO,GAAetO,cCZ9B9I,EAIAS,GACFmP,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMjE,OAAQ0P,IAAU,CACnDkC,iBAAkB,SAA0Bpc,GAC1C,IAEI+L,EAFA9I,EAAI7B,GAAS1G,MACbgG,EAAM+B,EAAczC,MAGtB,GAAI+L,EAAIsQ,GAA4BpZ,EAAGvC,GAAM,OAAOqL,EAAK9G,UAClDhC,EAAIsO,GAAetO,iBCjBlCqZ,GAAiBhiB,EAAArC,eCAjBskB,GAAiB,SAAUzT,EAAQ0H,EAAKpK,GACtC,IAAK,IAAI1F,KAAO8P,EAAKrK,GAAS2C,EAAQpI,EAAK8P,EAAI9P,GAAM0F,GACrD,OAAO0C,UCEL0T,GAAUva,GAAgB,WAE9Bwa,GAAiB,SAAUC,GACzB,IAAIC,EAAc7e,EAAW4e,GACzB1hB,EAAiB+H,GAEjBnI,GAAe+hB,IAAgBA,EAAYH,KAC7CxhB,EAAe2hB,EAAaH,GAAS,CACnCngB,cAAc,EACdpB,IAAK,WAAc,OAAOP,gBCZ5BkiB,GAAYtiB,EAAAgD,UAEhBuf,GAAiB,SAAUxiB,EAAIyiB,GAC7B,GAAI7e,EAAc6e,EAAWziB,GAAK,OAAOA,EACzC,MAAMuiB,GAAU,gCCLdG,GAAW9a,GAAgB,YAC3B+a,IAAe,EAEnB,IACE,IAAIC,GAAS,EACTC,GAAqB,CACvB3K,KAAM,WACJ,MAAO,CAAEwC,OAAQkI,OAEnBE,OAAU,WACRH,IAAe,IAGnBE,GAAmBH,IAAY,WAC7B,OAAOriB,MAGT4R,MAAM8Q,KAAKF,IAAoB,WAAc,MAAM,KACnD,MAAOniB,IAETsiB,GAAiB,SAAUviB,EAAMwiB,GAC/B,IAAKA,IAAiBN,GAAc,OAAO,EAC3C,IAAIO,GAAoB,EACxB,IACE,IAAI3Z,EAAS,GACbA,EAAOmZ,IAAY,WACjB,MAAO,CACLxK,KAAM,WACJ,MAAO,CAAEwC,KAAMwI,GAAoB,MAIzCziB,EAAK8I,GACL,MAAO7I,IACT,OAAOwiB,aChCLC,GAAYljB,EAAAgD,UAGhBmgB,GAAiB,SAAU9f,GACzB,GAAIsQ,GAActQ,GAAW,OAAOA,EACpC,MAAM6f,GAAU5d,GAAYjC,GAAY,0BCL1C,IAAI+f,GAAUzb,GAAgB,WAI9B0b,GAAiB,SAAU1a,EAAG2a,GAC5B,IACIC,EADAtP,EAAIlL,GAASJ,GAAGuI,YAEpB,YAAahO,IAAN+Q,GAAiD/Q,OAA7BqgB,EAAIxa,GAASkL,GAAGmP,KAAyBE,EAAqBH,GAAaI,iBCTpGC,GAAoBnjB,SAASa,UAC7BuiB,GAAQD,GAAkBjkB,MAC1BmkB,GAAOF,GAAkBriB,KAG7BwiB,GAAmC,iBAAXC,SAAuBA,QAAQrkB,QAAUqB,EAAc8iB,GAAK5iB,KAAK2iB,IAAS,WAChG,OAAOC,GAAKnkB,MAAMkkB,GAAOjkB,uBCN3BqkB,GAAiBvhB,EAAY,GAAGrE,cCAhC6lB,GAAc,qCAAwCjjB,KAAKgD,GCU3D,IAUIkgB,GAAUC,GAAOC,GAASC,GAV1BC,GAAMnkB,EAAAokB,aACNC,GAAQrkB,EAAAskB,eACRC,GAAUvkB,EAAAiE,QACVugB,GAAWxkB,EAAAykB,SACXC,GAAW1kB,EAAAK,SACXskB,GAAiB3kB,EAAA4kB,eACjBC,GAAS7kB,EAAA8E,OACTggB,GAAU,EACVC,GAAQ,GAIZ,IAEEhB,GAAW/jB,EAAAglB,SACX,MAAOvkB,IAET,IAAIwkB,GAAM,SAAU5oB,GAClB,GAAI2K,GAAO+d,GAAO1oB,GAAK,CACrB,IAAIkG,EAAKwiB,GAAM1oB,UACR0oB,GAAM1oB,GACbkG,MAIA2iB,GAAS,SAAU7oB,GACrB,OAAO,WACL4oB,GAAI5oB,KAIJ8oB,GAAW,SAAUC,GACvBH,GAAIG,EAAM/V,OAGRgW,GAAO,SAAUhpB,GAEnB2D,EAAAslB,YAAmBT,GAAOxoB,GAAK0nB,GAASwB,SAAW,KAAOxB,GAASyB,OAIhErB,IAAQE,KACXF,GAAM,SAAsB5hB,GAC1B,IAAIkjB,EAAO5B,GAAWrkB,UAAW,GAKjC,OAJAulB,KAAQD,IAAW,WACjBnB,GAAMvgB,EAAWb,GAAMA,EAAKmiB,GAASniB,QAAKW,EAAWuiB,IAEvDzB,GAAMc,IACCA,IAETT,GAAQ,SAAwBhoB,UACvB0oB,GAAM1oB,IAGXif,GACF0I,GAAQ,SAAU3nB,GAChBkoB,GAAQmB,SAASR,GAAO7oB,KAGjBmoB,IAAYA,GAASmB,IAC9B3B,GAAQ,SAAU3nB,GAChBmoB,GAASmB,IAAIT,GAAO7oB,KAIbsoB,KAAmBb,IAE5BI,IADAD,GAAU,IAAIU,IACCiB,MACf3B,GAAQ4B,MAAMC,UAAYX,GAC1BnB,GAAQ7R,GAAK+R,GAAKoB,YAAapB,KAI/BlkB,EAAA+lB,kBACA3iB,EAAWpD,EAAAslB,eACVtlB,EAAAgmB,eACDjC,IAAkC,UAAtBA,GAASwB,WACpBhlB,EAAM8kB,KAEPrB,GAAQqB,GACRrlB,EAAA+lB,iBAAwB,UAAWZ,IAAU,IAG7CnB,GA1EqB,uBAyEU1b,GAAc,UACrC,SAAUjM,GAChByY,GAAA9V,YAAiBsJ,GAAc,WAA6B,mBAAI,WAC9DwM,GAAAmR,YAAiB7lB,MACjB6kB,GAAI5oB,KAKA,SAAUA,GAChB6pB,WAAWhB,GAAO7oB,GAAK,gBAK7B8pB,GAAiB,CACfxb,IAAKwZ,GACLiC,MAAO/B,KC3FL1Z,aClBA9K,KACAsmB,GAAAxb,ICAJ0b,GAAc,oBAAuBxlB,KAAKgD,SAAgCX,IAAlBlD,EAAAsmB,cCDxDC,GAAc,qBAAwB1lB,KAAKgD,GFO3C,IAQI2iB,GAAOC,GAAMC,GAAMC,GAAQC,GAAQC,GAAMC,GAASC,GARlDC,GAAmBhnB,EAAOinB,kBAAoBjnB,EAAOknB,uBACrDC,GAAWnnB,EAAOxB,SAClB4oB,GAAUpnB,EAAOiE,QACjBojB,GAAUrnB,EAAOrC,QAEjB2pB,GAAwBC,GAA4BvnB,EAAQ,kBAC5DwnB,GAAiBF,IAA4BA,GAAyBzqB,MAKrE2qB,KACHhB,GAAQ,WACN,IAAIiB,EAAQllB,MACR+Y,KAAYmM,EAASL,GAAQrR,SAAS0R,EAAOC,OAC1CjB,IAAM,CACXlkB,EAAKkkB,GAAKlkB,GACVkkB,GAAOA,GAAKxO,KACZ,IACE1V,IACA,MAAO9B,GAGP,MAFIgmB,GAAME,KACLD,QAAOxjB,EACNzC,GAERimB,QAAOxjB,EACLukB,GAAQA,EAAOE,SAKhB7D,IAAWxI,IAAYiL,KAAmBS,KAAoBG,IAQvDd,IAAiBgB,IAAWA,GAAQ9pB,UAE9CupB,GAAUO,GAAQ9pB,aAAQ2F,IAElBgO,YAAcmW,GACtBN,GAAO5U,GAAK2U,GAAQtpB,KAAMspB,IAC1BH,GAAS,WACPI,GAAKP,MAGElL,GACTqL,GAAS,WACPS,GAAQ1B,SAASc,SAUPrU,GAAIyV,GAAY5nB,GAC5B2mB,GAAS,cACGH,OA/BZI,IAAS,EACTC,GAAOM,GAASU,eAAe,IAC/B,IAAIb,GAAiBR,IAAOsB,QAAQjB,GAAM,CAAEkB,eAAe,IAC3DpB,GAAS,WACPE,GAAKxX,KAAOuX,IAAUA,MAgC5BoB,GAAiBR,IAAkB,SAAUjlB,GAC3C,IAAI0lB,EAAO,CAAE1lB,GAAIA,EAAI0V,UAAM/U,GACvBwjB,KAAMA,GAAKzO,KAAOgQ,GACjBxB,KACHA,GAAOwB,EACPtB,MACAD,GAAOuB,UGnEKC,GAbZC,GAAoB,SAAUlU,GAChC,IAAI1W,EAASK,EACbwC,KAAKgoB,QAAU,IAAInU,GAAE,SAAUoU,EAAWC,GACxC,QAAgBplB,IAAZ3F,QAAoC2F,IAAXtF,EAAsB,MAAMoF,UAAU,2BACnEzF,EAAU8qB,EACVzqB,EAAS0qB,KAEXloB,KAAK7C,QAAUiI,GAAUjI,GACzB6C,KAAKxC,OAAS4H,GAAU5H,IAK1BsqB,GAAmB,SAAUjU,GAC3B,OAAO,IAAIkU,GAAkBlU,ICb/BsU,GAAiB,SAAUtU,EAAGwK,GAE5B,GADA1V,GAASkL,GACL3Q,EAASmb,IAAMA,EAAEvN,cAAgB+C,EAAG,OAAOwK,EAC/C,IAAI+J,EAAoBN,GAAuBjU,GAG/C,OADA1W,EADcirB,EAAkBjrB,SACxBkhB,GACD+J,EAAkBJ,gBCR3BK,GAAiB,SAAUjgB,EAAG4V,GAC5B,IAAIsK,EAAU1oB,EAAA0oB,QACVA,GAAWA,EAAQjoB,QACD,GAApBjB,UAAUpD,OAAcssB,EAAQjoB,MAAM+H,GAAKkgB,EAAQjoB,MAAM+H,EAAG4V,YCLhEuK,GAAiB,SAAUnoB,GACzB,IACE,MAAO,CAAEC,OAAO,EAAO5D,MAAO2D,KAC9B,MAAOC,GACP,MAAO,CAAEA,OAAO,EAAM5D,MAAO4D,eCJ7BmoB,GAAQ,WACVxoB,KAAKrB,KAAO,KACZqB,KAAKyoB,KAAO,MAGdD,GAAM1nB,UAAY,CAChB4nB,IAAK,SAAUC,GACb,IAAIC,EAAQ,CAAED,KAAMA,EAAM9Q,KAAM,MAC5B7X,KAAKrB,KAAMqB,KAAKyoB,KAAK5Q,KAAO+Q,EAC3B5oB,KAAKrB,KAAOiqB,EACjB5oB,KAAKyoB,KAAOG,GAEdroB,IAAK,WACH,IAAIqoB,EAAQ5oB,KAAKrB,KACjB,GAAIiqB,EAGF,OAFA5oB,KAAKrB,KAAOiqB,EAAM/Q,KACd7X,KAAKyoB,OAASG,IAAO5oB,KAAKyoB,KAAO,MAC9BG,EAAMD,OAKnBE,GAAiBL,UCtBjBM,GAAkC,iBAAVhpB,OTkCxB,IA0BIipB,GAAUC,GAAsBC,GAAgBC,GA1BhDC,GAAU5hB,GAAgB,WAG1B6hB,GAAmBze,GAAAE,UAFT,WAGVwe,GAAmB1e,GAAAJ,IACnB+e,GAA0B3e,GAAAE,UAJhB,WAKV0e,GAAyB3H,IAAiBA,GAAc9gB,UACxD0oB,GAAqB5H,GACrB6H,GAAmBF,GACnBG,GAAY9pB,EAAOgD,UACnB+mB,GAAW/pB,EAAOxB,SAClBwrB,GAAUhqB,EAAOiE,QACjBgmB,GAAuB/B,GACvBgC,GAA8BD,GAE9BE,MAAoBJ,IAAYA,GAASK,aAAepqB,EAAOqqB,eAC/DC,GAAyBlnB,EAAWpD,EAAOuqB,uBAQ3CC,IAAc,EAIdC,GAASjb,GA3BC,WA2BiB,WAC7B,IAAIkb,EAA6BjhB,GAAcmgB,IAC3Ce,EAAyBD,IAA+B5lB,OAAO8kB,IAInE,IAAKe,GAAyC,KAAflmB,EAAmB,OAAO,EAMzD,GAAIA,GAAc,IAAE,cAAkB5D,KAAK6pB,GAA6B,OAAO,EAE/E,IAAItC,EAAU,IAAIwB,IAAmB,SAAUrsB,GAAWA,EAAQ,MAC9DqtB,EAAc,SAAUpqB,GAC1BA,GAAK,eAA6B,gBAKpC,OAHkB4nB,EAAQlX,YAAc,IAC5BqY,IAAWqB,IACvBJ,GAAcpC,EAAQ5qB,MAAK,yBAAwCotB,KAG3DD,GAA0BzB,KAAeoB,MAG/CO,GAAsBJ,KAAW1H,IAA4B,SAAU9B,GACzE2I,GAAmBkB,IAAI7J,GAAiB,OAAE,kBAIxC8J,GAAa,SAAUhrB,GACzB,IAAIvC,EACJ,SAAO8F,EAASvD,KAAOqD,EAAW5F,EAAOuC,EAAGvC,QAAQA,GAGlDwtB,GAAe,SAAUC,EAAU5gB,GACrC,IAMIpC,EAAQzK,EAAM0tB,EANdruB,EAAQwN,EAAMxN,MACdsuB,EA9CU,GA8CL9gB,EAAMA,MACX+gB,EAAUD,EAAKF,EAASE,GAAKF,EAASI,KACtC9tB,EAAU0tB,EAAS1tB,QACnBK,EAASqtB,EAASrtB,OAClBmY,EAASkV,EAASlV,OAEtB,IACMqV,GACGD,IAnDK,IAoDJ9gB,EAAMihB,WAAyBC,GAAkBlhB,GACrDA,EAAMihB,UAtDA,IAwDQ,IAAZF,EAAkBnjB,EAASpL,GAEzBkZ,GAAQA,EAAO4R,QACnB1f,EAASmjB,EAAQvuB,GACbkZ,IACFA,EAAO2R,OACPwD,GAAS,IAGTjjB,IAAWgjB,EAAS7C,QACtBxqB,EAAOksB,GAAU,yBACRtsB,EAAOutB,GAAW9iB,IAC3B7G,EAAK5D,EAAMyK,EAAQ1K,EAASK,GACvBL,EAAQ0K,IACVrK,EAAOf,GACd,MAAO4D,GACHsV,IAAWmV,GAAQnV,EAAO2R,OAC9B9pB,EAAO6C,KAIP+qB,GAAS,SAAUnhB,EAAOohB,GACxBphB,EAAMqhB,WACVrhB,EAAMqhB,UAAW,EACjB1D,IAAU,eACR,IACIiD,EADAU,EAAYthB,EAAMshB,UAEfV,EAAWU,EAAUhrB,OAC1BqqB,GAAaC,EAAU5gB,GAEzBA,EAAMqhB,UAAW,EACbD,IAAaphB,EAAMihB,WAAWM,GAAYvhB,QAI9CwhB,GAAgB,SAAUjkB,EAAMwgB,EAAS0D,GAC3C,IAAI1G,EAAOgG,EACPjB,KACF/E,EAAQ2E,GAASK,YAAY,UACvBhC,QAAUA,EAChBhD,EAAM0G,OAASA,EACf1G,EAAM2G,UAAUnkB,GAAM,GAAO,GAC7B5H,EAAOqqB,cAAcjF,IAChBA,EAAQ,CAAEgD,QAASA,EAAS0D,OAAQA,IACtCxB,KAA2Bc,EAAUprB,EAAO,KAAO4H,IAAQwjB,EAAQhG,GAzGhD,uBA0Gfxd,GAA8B6gB,GAAiB,8BAA+BqD,IAGrFF,GAAc,SAAUvhB,GAC1BjJ,EAAI4qB,GAAOhsB,GAAQ,WACjB,IAGIiI,EAHAmgB,EAAU/d,EAAMQ,OAChBhO,EAAQwN,EAAMxN,MAGlB,GAFmBovB,GAAY5hB,KAG7BpC,EAAS0gB,IAAQ,WACXrN,GACF0O,GAAQkC,KAAK,qBAAsBrvB,EAAOurB,GACrCyD,GAvHW,qBAuHwBzD,EAASvrB,MAGrDwN,EAAMihB,UAAYhQ,IAAW2Q,GAAY5hB,GApH/B,EADF,EAsHJpC,EAAOxH,OAAO,MAAMwH,EAAOpL,UAKjCovB,GAAc,SAAU5hB,GAC1B,OA5HY,IA4HLA,EAAMihB,YAA0BjhB,EAAMod,QAG3C8D,GAAoB,SAAUlhB,GAChCjJ,EAAI4qB,GAAOhsB,GAAQ,WACjB,IAAIooB,EAAU/d,EAAMQ,OAChByQ,GACF0O,GAAQkC,KAAK,mBAAoB9D,GAC5ByD,GAxIa,mBAwIoBzD,EAAS/d,EAAMxN,WAIvDsvB,GAAO,SAAU5pB,EAAI8H,EAAO+hB,GAC9B,OAAO,SAAUvvB,GACf0F,EAAG8H,EAAOxN,EAAOuvB,KAIjBC,GAAiB,SAAUhiB,EAAOxN,EAAOuvB,GACvC/hB,EAAMoQ,OACVpQ,EAAMoQ,MAAO,EACT2R,IAAQ/hB,EAAQ+hB,GACpB/hB,EAAMxN,MAAQA,EACdwN,EAAMA,MApJO,EAqJbmhB,GAAOnhB,GAAO,KAGZiiB,GAAkB,SAAUjiB,EAAOxN,EAAOuvB,GAC5C,IAAI/hB,EAAMoQ,KAAV,CACApQ,EAAMoQ,MAAO,EACT2R,IAAQ/hB,EAAQ+hB,GACpB,IACE,GAAI/hB,EAAMQ,SAAWhO,EAAO,MAAMitB,GAAU,oCAC5C,IAAItsB,EAAOutB,GAAWluB,GAClBW,EACFwqB,IAAU,WACR,IAAIuE,EAAU,CAAE9R,MAAM,GACtB,IACErZ,EAAK5D,EAAMX,EACTsvB,GAAKG,GAAiBC,EAASliB,GAC/B8hB,GAAKE,GAAgBE,EAASliB,IAEhC,MAAO5J,GACP4rB,GAAeE,EAAS9rB,EAAO4J,QAInCA,EAAMxN,MAAQA,EACdwN,EAAMA,MA9KI,EA+KVmhB,GAAOnhB,GAAO,IAEhB,MAAO5J,GACP4rB,GAAe,CAAE5R,MAAM,GAASha,EAAO4J,MAK3C,GAAIogB,KAaFZ,IAXAD,GAAqB,SAAiB4C,GACpCjK,GAAWniB,KAAMypB,IACjBrkB,GAAUgnB,GACVprB,EAAK+nB,GAAU/oB,MACf,IAAIiK,EAAQmf,GAAiBppB,MAC7B,IACEosB,EAASL,GAAKG,GAAiBjiB,GAAQ8hB,GAAKE,GAAgBhiB,IAC5D,MAAO5J,GACP4rB,GAAehiB,EAAO5J,MAGYS,WAEtCioB,GAAW,SAAiBqD,GAC1B/C,GAAiBrpB,KAAM,CACrBzB,KA3NQ,UA4NR8b,MAAM,EACNiR,UAAU,EACVjE,QAAQ,EACRkE,UAAW,IAAI1C,GACfqC,WAAW,EACXjhB,MA/MQ,EAgNRxN,WAAOqG,MAGFhC,UAAY+gB,GAAY4H,GAAkB,CAIjDrsB,KAAM,SAAcivB,EAAaC,GAC/B,IAAIriB,EAAQqf,GAAwBtpB,MAChC6qB,EAAWhB,GAAqB5G,GAAmBjjB,KAAMwpB,KAS7D,OARAvf,EAAMod,QAAS,EACfwD,EAASE,IAAK/nB,EAAWqpB,IAAeA,EACxCxB,EAASI,KAAOjoB,EAAWspB,IAAeA,EAC1CzB,EAASlV,OAASuF,GAAU0O,GAAQjU,YAAS7S,EA7NrC,GA8NJmH,EAAMA,MAAkBA,EAAMshB,UAAU7C,IAAImC,GAC3CjD,IAAU,WACbgD,GAAaC,EAAU5gB,MAElB4gB,EAAS7C,SAIlB3oB,MAAS,SAAUitB,GACjB,OAAOtsB,KAAK5C,UAAK0F,EAAWwpB,MAGhCtD,GAAuB,WACrB,IAAIhB,EAAU,IAAIe,GACd9e,EAAQmf,GAAiBpB,GAC7BhoB,KAAKgoB,QAAUA,EACfhoB,KAAK7C,QAAU4uB,GAAKG,GAAiBjiB,GACrCjK,KAAKxC,OAASuuB,GAAKE,GAAgBhiB,IAErC6d,GAA+B+B,GAAuB,SAAUhW,GAC9D,OAAOA,IAAM2V,IAAsB3V,IAAMoV,GACrC,IAAID,GAAqBnV,GACzBiW,GAA4BjW,IAGlB7Q,EAAW4e,KAAkB2H,KAA2BztB,OAAOgF,WAAW,CACxFooB,GAAaK,GAAuBnsB,KAE/BgtB,KAEH3e,GAAS8d,GAAwB,QAAQ,SAAc8C,EAAaC,GAClE,IAAIta,EAAOhS,KACX,OAAO,IAAIwpB,IAAmB,SAAUrsB,EAASK,GAC/CwD,EAAKkoB,GAAYlX,EAAM7U,EAASK,MAC/BJ,KAAKivB,EAAaC,KAEpB,CAAE3gB,QAAQ,IAGbF,GAAS8d,GAAwB,QAASE,GAAwB,MAAG,CAAE9d,QAAQ,KAIjF,WACS4d,GAAuBzY,YAC9B,MAAOzQ,IAGL+X,IACFA,GAAemR,GAAwBE,IAK7Cpa,EAAE,CAAEK,QAAQ,EAAM6c,MAAM,EAAMzc,OAAQua,IAAU,CAC9C9sB,QAASisB,KAGXjS,GAAeiS,GA1SD,WA0S8B,GAC5CzH,GA3Sc,WA6SdkH,GAAiB7lB,EA7SH,WAgTdiM,EAAE,CAAEjB,OAhTU,UAgTOwB,MAAM,EAAME,OAAQua,IAAU,CAGjD7sB,OAAQ,SAAgBgvB,GACtB,IAAIC,EAAa5C,GAAqB7pB,MAEtC,OADAgB,EAAKyrB,EAAWjvB,YAAQsF,EAAW0pB,GAC5BC,EAAWzE,WAItB3Y,EAAE,CAAEjB,OA1TU,UA0TOwB,MAAM,EAAME,OAAmBua,IAAU,CAG5DltB,QAAS,SAAiBkhB,GACxB,OAAO8J,GAAyEnoB,KAAMqe,MAI1FhP,EAAE,CAAEjB,OAlUU,UAkUOwB,MAAM,EAAME,OAAQ2a,IAAuB,CAG9DC,IAAK,SAAa7J,GAChB,IAAIhN,EAAI7T,KACJysB,EAAa5C,GAAqBhW,GAClC1W,EAAUsvB,EAAWtvB,QACrBK,EAASivB,EAAWjvB,OACpBqK,EAAS0gB,IAAQ,WACnB,IAAImE,EAAkBtnB,GAAUyO,EAAE1W,SAC9B4c,EAAS,GACT4S,EAAU,EACVC,EAAY,EAChBhM,GAAQC,GAAU,SAAUmH,GAC1B,IAAIpb,EAAQ+f,IACRE,GAAgB,EACpBD,IACA5rB,EAAK0rB,EAAiB7Y,EAAGmU,GAAS5qB,MAAK,SAAUX,GAC3CowB,IACJA,GAAgB,EAChB9S,EAAOnN,GAASnQ,IACdmwB,GAAazvB,EAAQ4c,MACtBvc,QAEHovB,GAAazvB,EAAQ4c,MAGzB,OADIlS,EAAOxH,OAAO7C,EAAOqK,EAAOpL,OACzBgwB,EAAWzE,SAIpB8E,KAAM,SAAcjM,GAClB,IAAIhN,EAAI7T,KACJysB,EAAa5C,GAAqBhW,GAClCrW,EAASivB,EAAWjvB,OACpBqK,EAAS0gB,IAAQ,WACnB,IAAImE,EAAkBtnB,GAAUyO,EAAE1W,SAClCyjB,GAAQC,GAAU,SAAUmH,GAC1BhnB,EAAK0rB,EAAiB7Y,EAAGmU,GAAS5qB,KAAKqvB,EAAWtvB,QAASK,SAI/D,OADIqK,EAAOxH,OAAO7C,EAAOqK,EAAOpL,OACzBgwB,EAAWzE,WUnYtB,IAAI+E,KAAgBnL,IAAiBzhB,GAAM,WAEzCyhB,GAAc9gB,UAAmB,QAAEC,KAAK,CAAE3D,KAAM,eAA+B,kBAqBjF,GAhBAiS,EAAE,CAAEjB,OAAQ,UAAW2F,OAAO,EAAMiZ,MAAM,EAAMld,OAAQid,IAAe,CACrEE,QAAW,SAAUC,GACnB,IAAIrZ,EAAIoP,GAAmBjjB,KAAMoD,EAAW,YACxC+pB,EAAanqB,EAAWkqB,GAC5B,OAAOltB,KAAK5C,KACV+vB,EAAa,SAAU9O,GACrB,OAAO8J,GAAetU,EAAGqZ,KAAa9vB,MAAK,WAAc,OAAOihB,MAC9D6O,EACJC,EAAa,SAAUzuB,GACrB,OAAOypB,GAAetU,EAAGqZ,KAAa9vB,MAAK,WAAc,MAAMsB,MAC7DwuB,MAMMlqB,EAAW4e,IAAgB,CACzC,IAAIwL,GAAShqB,EAAW,WAAWtC,UAAmB,QAClD8gB,GAAc9gB,UAAmB,UAAMssB,IACzC3hB,GAASmW,GAAc9gB,UAAW,UAAWssB,GAAQ,CAAEzhB,QAAQ,iBCjCnE0hB,GAAiB,WACf,IAAIrb,EAAOrJ,GAAS3I,MAChB6H,EAAS,GAOb,OANImK,EAAKtC,SAAQ7H,GAAU,KACvBmK,EAAKsb,aAAYzlB,GAAU,KAC3BmK,EAAKub,YAAW1lB,GAAU,KAC1BmK,EAAKwb,SAAQ3lB,GAAU,KACvBmK,EAAKyb,UAAS5lB,GAAU,KACxBmK,EAAK0b,SAAQ7lB,GAAU,KACpBA,UCVL8lB,GAAU/tB,EAAAguB,OAEVC,GAAgB1tB,GAAM,WACxB,IAAI2tB,EAAKH,GAAQ,IAAK,KAEtB,OADAG,EAAGC,UAAY,EACW,MAAnBD,EAAG1tB,KAAK,WAKb4tB,GAAgBH,IAAiB1tB,GAAM,WACzC,OAAQwtB,GAAQ,IAAK,KAAKD,UAU5BO,GAAiB,CACfC,aARiBL,IAAiB1tB,GAAM,WAExC,IAAI2tB,EAAKH,GAAQ,KAAM,MAEvB,OADAG,EAAGC,UAAY,EACU,MAAlBD,EAAG1tB,KAAK,UAKf+tB,cAAeH,GACfI,cAAeP,cClBbljB,GAAApK,ICNA8tB,GAAUzuB,EAAAguB,OAEdU,GAAiBnuB,GAAM,WACrB,IAAI2tB,EAAKO,GAAQ,IAAK,KACtB,QAASP,EAAGN,QAAUM,EAAG1tB,KAAK,OAAsB,MAAb0tB,EAAGS,iBCJxCC,GAAU5uB,EAAAguB,OAEda,GAAiBtuB,GAAM,WACrB,IAAI2tB,EAAKU,GAAQ,UAAW,KAC5B,MAAiC,MAA1BV,EAAG1tB,KAAK,KAAKsuB,OAAOtmB,GACI,OAA7B,IAAI5L,QAAQsxB,EAAI,YFKpB,IASMa,GACAC,GAVFC,GAAgB1oB,GAAO,wBAAyBzB,OAAO5D,UAAUtE,SACjEsyB,GAAalB,OAAO9sB,UAAUV,KAC9B2uB,GAAcD,GACdE,GAAS9sB,EAAY,GAAG+b,QACxBgR,GAAU/sB,EAAY,GAAGsL,SACzB0hB,GAAUhtB,EAAY,GAAG1F,SACzB2yB,GAAcjtB,EAAY,GAAGrE,OAE7BuxB,IAEER,GAAG,MACP5tB,EAAK8tB,GAFDH,GAAG,IAEe,KACtB3tB,EAAK8tB,GAAYF,GAAK,KACG,IAAlBD,GAAIZ,WAAqC,IAAlBa,GAAIb,WAGhCsB,GAAgBpB,GAAAC,aAGhBoB,QAAuCxsB,IAA1B,OAAU1C,KAAK,IAAI,IAExBgvB,IAA4BE,IAAiBD,IAAiBf,IAAuBG,MAG/FM,GAAc,SAAchgB,GAC1B,IAIIlH,EAAQ0nB,EAAQxB,EAAWlxB,EAAOd,EAAGmN,EAAQsmB,EAJ7C1B,EAAK9tB,KACLiK,EAAKwlB,GAAoB3B,GACzB4B,EAAMjf,GAAS1B,GACf4gB,EAAM1lB,EAAM0lB,IAGhB,GAAIA,EAIF,OAHAA,EAAI5B,UAAYD,EAAGC,UACnBlmB,EAAS7G,EAAK+tB,GAAaY,EAAKD,GAChC5B,EAAGC,UAAY4B,EAAI5B,UACZlmB,EAGT,IAAI6mB,EAASzkB,EAAMykB,OACfhB,EAAS2B,IAAiBvB,EAAGJ,OAC7Ba,EAAQvtB,EAAKqsB,GAAaS,GAC1BtnB,EAASsnB,EAAGtnB,OACZopB,EAAa,EACbC,EAAUH,EA+Cd,GA7CIhC,IACFa,EAAQW,GAAQX,EAAO,IAAK,KACA,IAAxBU,GAAQV,EAAO,OACjBA,GAAS,KAGXsB,EAAUV,GAAYO,EAAK5B,EAAGC,WAE1BD,EAAGC,UAAY,KAAOD,EAAGP,WAAaO,EAAGP,WAA+C,OAAlCyB,GAAOU,EAAK5B,EAAGC,UAAY,MACnFvnB,EAAS,OAASA,EAAS,IAC3BqpB,EAAU,IAAMA,EAChBD,KAIFL,EAAS,IAAI3B,OAAO,OAASpnB,EAAS,IAAK+nB,IAGzCe,KACFC,EAAS,IAAI3B,OAAO,IAAMpnB,EAAS,WAAY+nB,IAE7Ca,KAA0BrB,EAAYD,EAAGC,WAE7ClxB,EAAQmE,EAAK8tB,GAAYpB,EAAS6B,EAASzB,EAAI+B,GAE3CnC,EACE7wB,GACFA,EAAM6I,MAAQypB,GAAYtyB,EAAM6I,MAAOkqB,GACvC/yB,EAAM,GAAKsyB,GAAYtyB,EAAM,GAAI+yB,GACjC/yB,EAAM+P,MAAQkhB,EAAGC,UACjBD,EAAGC,WAAalxB,EAAM,GAAGb,QACpB8xB,EAAGC,UAAY,EACbqB,IAA4BvyB,IACrCixB,EAAGC,UAAYD,EAAGpe,OAAS7S,EAAM+P,MAAQ/P,EAAM,GAAGb,OAAS+xB,GAEzDuB,IAAiBzyB,GAASA,EAAMb,OAAS,GAG3CgF,EAAK6tB,GAAehyB,EAAM,GAAI0yB,GAAQ,WACpC,IAAKxzB,EAAI,EAAGA,EAAIqD,UAAUpD,OAAS,EAAGD,SACf+G,IAAjB1D,UAAUrD,KAAkBc,EAAMd,QAAK+G,MAK7CjG,GAAS6xB,EAEX,IADA7xB,EAAM6xB,OAASxlB,EAASgN,GAAO,MAC1Bna,EAAI,EAAGA,EAAI2yB,EAAO1yB,OAAQD,IAE7BmN,GADAsmB,EAAQd,EAAO3yB,IACF,IAAMc,EAAM2yB,EAAM,IAInC,OAAO3yB,IG1GXwS,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMjE,OAAM,IAAM1P,QH8G/C0vB,GAAiBf,KG9G+C,CAC9D3uB,KAAM0vB,KCGR,IAAIC,GAAUxoB,GAAgB,WAC1ByoB,GAAkBpC,OAAO9sB,UAE7BmvB,GAAiB,SAAU3W,EAAKlZ,EAAM+Y,EAAQ+W,GAC5C,IAAIC,EAAS5oB,GAAgB+R,GAEzB8W,GAAuBjwB,GAAM,WAE/B,IAAIoI,EAAI,GAER,OADAA,EAAE4nB,GAAU,WAAc,OAAO,GACZ,GAAd,GAAG7W,GAAK/Q,MAGb8nB,EAAoBD,IAAwBjwB,GAAM,WAEpD,IAAImwB,GAAa,EACbxC,EAAE,IAkBN,MAhBY,UAARxU,KAIFwU,EAAK,IAGFhd,YAAc,GACjBgd,EAAGhd,YAAYif,IAAW,WAAc,OAAOjC,GAC/CA,EAAGS,MAAQ,GACXT,EAAGqC,GAAM,IAAQA,IAGnBrC,EAAG1tB,KAAO,WAAiC,OAAnBkwB,GAAa,EAAa,MAElDxC,EAAGqC,GAAQ,KACHG,KAGV,IACGF,IACAC,GACDlX,EACA,CACA,IAAIoX,EAA8BruB,EAAW,IAAKiuB,IAC9C9W,EAAUjZ,EAAK+vB,EAAQ,GAAG7W,IAAM,SAAUkX,EAAcC,EAAQf,EAAKgB,EAAMC,GAC7E,IAAIC,EAAwB1uB,EAAYsuB,GACpCK,EAAQJ,EAAOrwB,KACnB,OAAIywB,IAAUf,IAAce,IAAUb,GAAgB5vB,KAChDgwB,IAAwBO,EAInB,CAAEtW,MAAM,EAAM5d,MAAO8zB,EAA4BE,EAAQf,EAAKgB,IAEhE,CAAErW,MAAM,EAAM5d,MAAOm0B,EAAsBlB,EAAKe,EAAQC,IAE1D,CAAErW,MAAM,MAGjB5O,GAAS/G,OAAO5D,UAAWwY,EAAKD,EAAQ,IACxC5N,GAASukB,GAAiBG,EAAQ9W,EAAQ,IAGxC6W,GAAMjnB,GAA4B+mB,GAAgBG,GAAS,QAAQ,cCnErEW,GAAS5uB,EAAY,GAAG+b,QACxB8S,GAAa7uB,EAAY,GAAG8uB,YAC5BC,GAAc/uB,EAAY,GAAGrE,OAE7BqzB,GAAe,SAAUC,GAC3B,OAAO,SAAU/jB,EAAOgkB,GACtB,IAGIC,EAAOC,EAHPnO,EAAI1S,GAAS5N,EAAuBuK,IACpCmkB,EAAWllB,GAAoB+kB,GAC/BI,EAAOrO,EAAEnnB,OAEb,OAAIu1B,EAAW,GAAKA,GAAYC,EAAaL,EAAoB,QAAKruB,GACtEuuB,EAAQN,GAAW5N,EAAGoO,IACP,OAAUF,EAAQ,OAAUE,EAAW,IAAMC,IACtDF,EAASP,GAAW5N,EAAGoO,EAAW,IAAM,OAAUD,EAAS,MAC3DH,EACEL,GAAO3N,EAAGoO,GACVF,EACFF,EACEF,GAAY9N,EAAGoO,EAAUA,EAAW,GACVD,EAAS,OAAlCD,EAAQ,OAAU,IAA0B,YAIzDI,GAAiB,CAGfC,OAAQR,IAAa,GAGrBjT,OAAQiT,IAAa,KCjCnBjT,OAIJ0T,GAAiB,SAAUxO,EAAGvW,EAAO6gB,GACnC,OAAO7gB,GAAS6gB,EAAOmE,GAAUzO,EAAGvW,GAAO5Q,OAAS,WCHlD61B,GAAQl0B,KAAKyO,MACb0lB,GAAS5vB,EAAY,GAAG+b,QACxB8T,GAAU7vB,EAAY,GAAG1F,SACzBw1B,GAAc9vB,EAAY,GAAGrE,OAC7Bo0B,GAAoB,8BACpBC,GAA6B,sBAIjCC,GAAiB,SAAUC,EAAS1C,EAAK6B,EAAUc,EAAUC,EAAeC,GAC1E,IAAIC,EAAUjB,EAAWa,EAAQp2B,OAC7B+B,EAAIs0B,EAASr2B,OACby2B,EAAUP,GAKd,YAJsBpvB,IAAlBwvB,IACFA,EAAgB5rB,GAAS4rB,GACzBG,EAAUR,IAELF,GAAQQ,EAAaE,GAAS,SAAU51B,EAAO61B,GACpD,IAAIC,EACJ,OAAQb,GAAOY,EAAI,IACjB,IAAK,IAAK,MAAO,IACjB,IAAK,IAAK,OAAON,EACjB,IAAK,IAAK,OAAOJ,GAAYtC,EAAK,EAAG6B,GACrC,IAAK,IAAK,OAAOS,GAAYtC,EAAK8C,GAClC,IAAK,IACHG,EAAUL,EAAcN,GAAYU,EAAI,GAAG,IAC3C,cAEA,IAAIzW,GAAKyW,EACT,GAAU,IAANzW,EAAS,OAAOpf,EACpB,GAAIof,EAAIle,EAAG,CACT,IAAI60B,EAAIf,GAAM5V,EAAI,IAClB,OAAU,IAAN2W,EAAgB/1B,EAChB+1B,GAAK70B,OAA8B+E,IAApBuvB,EAASO,EAAI,GAAmBd,GAAOY,EAAI,GAAKL,EAASO,EAAI,GAAKd,GAAOY,EAAI,GACzF71B,EAET81B,EAAUN,EAASpW,EAAI,GAE3B,YAAmBnZ,IAAZ6vB,EAAwB,GAAKA,aClCpCE,GAAYjzB,EAAAgD,UAIhBkwB,GAAiB,SAAUC,EAAG5P,GAC5B,IAAI/iB,EAAO2yB,EAAE3yB,KACb,GAAI4C,EAAW5C,GAAO,CACpB,IAAIyH,EAAS7G,EAAKZ,EAAM2yB,EAAG5P,GAE3B,OADe,OAAXtb,GAAiBc,GAASd,GACvBA,EAET,GAAmB,WAAfvF,EAAQywB,GAAiB,OAAO/xB,EAAK8uB,GAAYiD,EAAG5P,GACxD,MAAM0P,GAAU,gDCDlB,IAAIG,GAAUzrB,GAAgB,WAC1B0rB,GAAMt1B,KAAK6O,IACX0mB,GAAMv1B,KAAK+O,IACXymB,GAASjxB,EAAY,GAAGxE,QACxB01B,GAAOlxB,EAAY,GAAGkE,MACtBitB,GAAgBnxB,EAAY,GAAGsL,SAC/B8lB,GAAcpxB,EAAY,GAAGrE,OAQ7B01B,GAEgC,OAA3B,IAAI/2B,QAAO,IAAM,MAItBg3B,KACA,IAAMR,KAC6B,KAA7B,IAAKA,IAAS,IAAK,MAiB7B/C,GAA8B,WAAW,SAAUwD,EAAGC,EAAeC,GACnE,IAAIC,EAAoBJ,GAA+C,IAAM,KAE7E,MAAO,CAGL,SAAiBK,EAAaC,GAC5B,IAAIvrB,EAAI1F,EAAuB7C,MAC3B+zB,EAA0BjxB,MAAf+wB,OAA2B/wB,EAAYuC,EAAUwuB,EAAab,IAC7E,OAAOe,EACH/yB,EAAK+yB,EAAUF,EAAatrB,EAAGurB,GAC/B9yB,EAAK0yB,EAAejjB,GAASlI,GAAIsrB,EAAaC,IAIpD,SAAU/kB,EAAQ+kB,GAChB,IAAIE,EAAKrrB,GAAS3I,MACdmjB,EAAI1S,GAAS1B,GAEjB,GACyB,iBAAhB+kB,IAC4C,IAAnDT,GAAcS,EAAcF,KACU,IAAtCP,GAAcS,EAAc,MAC5B,CACA,IAAIG,EAAMN,EAAgBD,EAAeM,EAAI7Q,EAAG2Q,GAChD,GAAIG,EAAI5Z,KAAM,OAAO4Z,EAAIx3B,MAG3B,IAAIy3B,EAAoBlxB,EAAW8wB,GAC9BI,IAAmBJ,EAAerjB,GAASqjB,IAEhD,IAAIpkB,EAASskB,EAAGtkB,OAChB,GAAIA,EAAQ,CACV,IAAIykB,EAAcH,EAAGvG,QACrBuG,EAAGjG,UAAY,MAEjB,IAAIqG,EAAU,KACD,CACX,IAAIvsB,EAASirB,GAAWkB,EAAI7Q,GAC5B,GAAe,OAAXtb,EAAiB,MAGrB,GADAurB,GAAKgB,EAASvsB,IACT6H,EAAQ,MAGI,KADFe,GAAS5I,EAAO,MACVmsB,EAAGjG,UAAY4D,GAAmBxO,EAAGpW,GAASinB,EAAGjG,WAAYoG,IAKpF,IAFA,IA/EwBx0B,EA+EpB00B,EAAoB,GACpBC,EAAqB,EAChBv4B,EAAI,EAAGA,EAAIq4B,EAAQp4B,OAAQD,IAAK,CAWvC,IARA,IAAIq2B,EAAU3hB,IAFd5I,EAASusB,EAAQr4B,IAEa,IAC1Bw1B,EAAW0B,GAAIC,GAAI7mB,GAAoBxE,EAAO+E,OAAQuW,EAAEnnB,QAAS,GACjEq2B,EAAW,GAMN5V,EAAI,EAAGA,EAAI5U,EAAO7L,OAAQygB,IAAK2W,GAAKf,OA3FrCvvB,KADcnD,EA4F+CkI,EAAO4U,IA3FxD9c,EAAK+E,OAAO/E,IA4FhC,IAAI2yB,EAAgBzqB,EAAO6mB,OAC3B,GAAIwF,EAAmB,CACrB,IAAIK,EAAepB,GAAO,CAACf,GAAUC,EAAUd,EAAUpO,QACnCrgB,IAAlBwvB,GAA6Bc,GAAKmB,EAAcjC,GACpD,IAAIC,EAAc9hB,GAAS8S,GAAMuQ,OAAchxB,EAAWyxB,SAE1DhC,EAAcJ,GAAgBC,EAASjP,EAAGoO,EAAUc,EAAUC,EAAewB,GAE3EvC,GAAY+C,IACdD,GAAqBf,GAAYnQ,EAAGmR,EAAoB/C,GAAYgB,EACpE+B,EAAqB/C,EAAWa,EAAQp2B,QAG5C,OAAOq4B,EAAoBf,GAAYnQ,EAAGmR,SAvFXn0B,GAAM,WACzC,IAAI2tB,EAAE,IAON,OANAA,EAAG1tB,KAAO,WACR,IAAIyH,EAAS,GAEb,OADAA,EAAO6mB,OAAS,CAAEtmB,EAAG,KACdP,GAGyB,MAA3B,GAAGrL,QAAQsxB,EAAI,aAkFcyF,IAAoBC,WClI1D,OAAIgB,GAAUtyB,EAAY,GAAG1F,SAEzBi4B,GAAQ7G,OAAO,oGACf8G,GAAQ9G,OAAO+G,oGAGfC,GAAe,SAAU9pB,GAC3B,OAAO,SAAUsC,GACf,IAAI2B,EAAS0B,GAAS5N,EAAuBuK,IAG7C,OAFW,EAAPtC,IAAUiE,EAASylB,GAAQzlB,EAAQ0lB,GAAO,KACnC,EAAP3pB,IAAUiE,EAASylB,GAAQzlB,EAAQ2lB,GAAO,KACvC3lB,QAIX8lB,GAAiB,CAGfxiB,MAAOuiB,GAAa,GAGpB9Y,IAAK8Y,GAAa,GAGlBE,KAAMF,GAAa,KC3BjB9Y,OCFA5Q,GAAAE,ODKA2pB,ICGJC,GAAiB,SAAU/Z,GACzB,OAAO9a,GAAM,WACX,QCTa,gDDSQ8a,MANf,QAAA,MAOGA,MAAsBga,ICVlB,gDDW6Bha,GAAazT,OAASyT,ODPhC,WAEhCia,GAAUH,GAAS,WACrB,OAAMI,GAAUn1B,OAEd,GAAGo1B,QAKP/lB,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMvM,KAAM,UAAWsI,OAAQilB,IAAU,CACpEK,QAASF,GACTG,UAAWH,YGfTL,GAAAxiB,MAGAijB,GAASN,GAAuB,aAEhCO,GAAYD,GAAS,WACvB,OAAME,GAAYx1B,OAEhB,GAAGy1B,UAKPpmB,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMvM,KAAM,YAAasI,OAAQwlB,IAAU,CACtEG,UAAWF,GACXG,SAAUH,wBChBZI,GAAuC,oBAAfC,aAAiD,oBAAZC,aCgCzDC,GAAMC,GAAaC,MAtBnB3tB,GAOA4tB,GAAYr2B,EAAOs2B,UACnBC,GAAqBF,IAAaA,GAAUn1B,UAC5Cs1B,GAAoBx2B,EAAOy2B,kBAC3BC,GAA6BF,IAAqBA,GAAkBt1B,UACpEy1B,GAAaN,IAAapf,GAAeof,IACzCO,GAAsBL,IAAsBtf,GAAesf,IAC3DM,GAAkB36B,OAAOgF,UACzB41B,GAAY92B,EAAOgD,UAEnB+zB,GAAgBpvB,GAAgB,eAChCqvB,GAAkB3vB,GAAI,mBACtB4vB,GAA0B5vB,GAAI,2BAE9B6vB,GAA4BnB,MAAyBvd,IAA4C,UAA1BhI,GAAQxQ,EAAOm3B,OACtFC,IAA2B,EAG3BC,GAA6B,CAC/Bf,UAAW,EACXgB,WAAY,EACZb,kBAAmB,EACnBc,WAAY,EACZC,YAAa,EACbC,WAAY,EACZC,YAAa,EACbC,aAAc,EACdC,aAAc,GAGZC,GAA8B,CAChCC,cAAe,EACfC,eAAgB,GAWdC,GAAe,SAAUj4B,GAC3B,IAAKuD,EAASvD,GAAK,OAAO,EAC1B,IAAIk4B,EAAQznB,GAAQzQ,GACpB,OAAOiH,GAAOqwB,GAA4BY,IACrCjxB,GAAO6wB,GAA6BI,IAyD3C,IAAK/B,MAAQmB,IAEXjB,IADAD,GAAcn2B,EAAOk2B,MACMC,GAAYj1B,WACxBmI,GAA4B+sB,GAAWa,GAAyBd,IAC1Ee,IAA4B,EAGnC,IAAKhB,MAAQ2B,IAEXzB,IADAD,GAAcn2B,EAAOk2B,MACMC,GAAYj1B,YACxBmI,GAA4B+sB,GAAWa,GAAyBd,IAIjF,KAAKe,KAA8B9zB,EAAWuzB,KAAeA,KAAet2B,SAASa,aAEnFy1B,GAAa,WACX,MAAMG,GAAU,yBAEdI,IAA2B,IAAKhB,MAAQmB,GACtCr3B,EAAOk2B,KAAO1d,GAAexY,EAAOk2B,IAAOS,IAInD,KAAKO,KAA8BN,IAAuBA,KAAwBC,MAChFD,GAAsBD,GAAWz1B,UAC7Bg2B,IAA2B,IAAKhB,MAAQmB,GACtCr3B,EAAOk2B,KAAO1d,GAAexY,EAAOk2B,IAAMh1B,UAAW01B,IAS7D,GAJIM,IAA6BjgB,GAAeyf,MAAgCE,IAC9Epe,GAAeke,GAA4BE,IAGzCt2B,IAAgB0G,GAAO4vB,GAAqBG,IAK9C,IAAKb,MAJLkB,IAA2B,KACZR,GAAqBG,GAAe,CAAEp2B,IAAK,WACxD,OAAO2C,EAASlD,MAAQA,KAAK42B,SAAmB9zB,KAErCm0B,GAAgCr3B,EAAOk2B,KAClD7sB,GAA4BrJ,EAAOk2B,IAAOc,GAAiBd,YAI/DgC,GAAiB,CACfC,0BAA2BjB,GAC3BkB,wBAAyBnB,GACzBoB,gBAAiBjB,IAA4BJ,GAC7CsB,YAxGgB,SAAUv4B,GAC1B,GAAIi4B,GAAaj4B,GAAK,OAAOA,EAC7B,MAAM+2B,GAAU,gCAuGhByB,uBApG2B,SAAUtkB,GACrC,GAAI7Q,EAAW6Q,MAAQuE,IAAkB7U,EAAcgzB,GAAY1iB,IAAK,OAAOA,EAC/E,MAAM6iB,GAAUxxB,GAAY2O,GAAK,sCAmGjCukB,uBAhG2B,SAAU9e,EAAK+e,EAAUvoB,EAAQpE,GAC5D,GAAKxL,EAAL,CACA,GAAI4P,EAAQ,IAAK,IAAIwoB,KAASrB,GAA4B,CACxD,IAAIsB,EAAwB34B,EAAO04B,GACnC,GAAIC,GAAyB3xB,GAAO2xB,EAAsBz3B,UAAWwY,GAAM,WAClEif,EAAsBz3B,UAAUwY,GACvC,MAAOjZ,GAEP,IACEk4B,EAAsBz3B,UAAUwY,GAAO+e,EACvC,MAAOG,MAGRhC,GAAoBld,KAAQxJ,GAC/BrE,GAAS+qB,GAAqBld,EAAKxJ,EAASuoB,EACxCvB,IAA6BX,GAAmB7c,IAAQ+e,EAAU3sB,KAkFxE+sB,6BA9EiC,SAAUnf,EAAK+e,EAAUvoB,GAC1D,IAAIwoB,EAAOC,EACX,GAAKr4B,EAAL,CACA,GAAIkY,GAAgB,CAClB,GAAItI,EAAQ,IAAKwoB,KAASrB,GAExB,IADAsB,EAAwB34B,EAAO04B,KACF1xB,GAAO2xB,EAAuBjf,GAAM,WACxDif,EAAsBjf,GAC7B,MAAOjZ,IAEX,GAAKk2B,GAAWjd,KAAQxJ,EAKjB,OAHL,IACE,OAAOrE,GAAS8qB,GAAYjd,EAAKxJ,EAASuoB,EAAWvB,IAA6BP,GAAWjd,IAAQ+e,GACrG,MAAOh4B,KAGb,IAAKi4B,KAASrB,KACZsB,EAAwB34B,EAAO04B,KACAC,EAAsBjf,KAAQxJ,GAC3DrE,GAAS8sB,EAAuBjf,EAAK+e,KA2DzCK,OA3HW,SAAgB/4B,GAC3B,IAAKuD,EAASvD,GAAK,OAAO,EAC1B,IAAIk4B,EAAQznB,GAAQzQ,GACpB,MAAiB,aAAVk4B,GACFjxB,GAAOqwB,GAA4BY,IACnCjxB,GAAO6wB,GAA6BI,IAuHzCc,aAAcf,GACdgB,WAAYrC,GACZsC,oBAAqBrC,KC9KnBuB,0BAEAe,GAAcl5B,EAAAg2B,YACdmD,GAAYn5B,EAAAs2B,UAEhB8C,IAAcC,KAAkC94B,GAAM,WACpD44B,GAAU,QACL54B,GAAM,WACX,IAAI44B,IAAU,QACTpW,IAA4B,SAAU9B,GAC3C,IAAIkY,GACJ,IAAIA,GAAU,MACd,IAAIA,GAAU,KACd,IAAIA,GAAUlY,MACb,IAAS1gB,GAAM,WAEhB,OAAkE,IAA3D,IAAI44B,GAAU,IAAID,GAAY,GAAI,OAAGh2B,GAAW9G,oBChBrDk9B,GAAat5B,EAAAu5B,WAIjBC,GAAiB,SAAUz5B,GACzB,QAAWmD,IAAPnD,EAAkB,OAAO,EAC7B,IAAI2M,EAASD,GAAoB1M,GAC7B3D,EAAS+Q,GAAST,GACtB,GAAIA,IAAWtQ,EAAQ,MAAMk9B,GAAW,yBACxC,OAAOl9B,UCVLq9B,GAAQz5B,EAAAgS,MACR0nB,GAAM37B,KAAKghB,IACX4a,GAAM57B,KAAK67B,IACXC,GAAQ97B,KAAKyO,MACbstB,GAAM/7B,KAAKg8B,IACXC,GAAMj8B,KAAKk8B,IA4FfC,GAAiB,CACfC,KA3FS,SAAUztB,EAAQ0tB,EAAgBC,GAC3C,IAOIC,EAAUC,EAAUC,EAPpBC,EAAShB,GAAMY,GACfK,EAAyB,EAARL,EAAYD,EAAiB,EAC9CO,GAAQ,GAAKD,GAAkB,EAC/BE,EAAQD,GAAQ,EAChBE,EAAwB,KAAnBT,EAAwBT,GAAI,GAAG,IAAOA,GAAI,GAAG,IAAO,EACzDmB,EAAOpuB,EAAS,GAAgB,IAAXA,GAAgB,EAAIA,EAAS,EAAI,EAAI,EAC1DM,EAAQ,OAEZN,EAASgtB,GAAIhtB,KAECA,GAAUA,IAAWyS,EAAAA,GAEjCob,EAAW7tB,GAAUA,EAAS,EAAI,EAClC4tB,EAAWK,IAEXL,EAAWT,GAAMC,GAAIptB,GAAUstB,IAE3BttB,GADJ8tB,EAAIb,GAAI,GAAIW,IACK,IACfA,IACAE,GAAK,IAGL9tB,GADE4tB,EAAWM,GAAS,EACZC,EAAKL,EAELK,EAAKlB,GAAI,EAAG,EAAIiB,IAEfJ,GAAK,IAChBF,IACAE,GAAK,GAEHF,EAAWM,GAASD,GACtBJ,EAAW,EACXD,EAAWK,GACFL,EAAWM,GAAS,GAC7BL,GAAY7tB,EAAS8tB,EAAI,GAAKb,GAAI,EAAGS,GACrCE,GAAsBM,IAEtBL,EAAW7tB,EAASitB,GAAI,EAAGiB,EAAQ,GAAKjB,GAAI,EAAGS,GAC/CE,EAAW,IAGRF,GAAkB,GACvBK,EAAOztB,KAAsB,IAAXutB,EAClBA,GAAY,IACZH,GAAkB,MAEpBE,EAAWA,GAAYF,EAAiBG,EACxCG,GAAkBN,EACXM,EAAiB,GACtBD,EAAOztB,KAAsB,IAAXstB,EAClBA,GAAY,IACZI,GAAkB,EAGpB,OADAD,IAASztB,IAAiB,IAAP8tB,EACZL,GAqCPM,OAlCW,SAAUN,EAAQL,GAC7B,IAQIG,EARAF,EAAQI,EAAOr+B,OACfs+B,EAAyB,EAARL,EAAYD,EAAiB,EAC9CO,GAAQ,GAAKD,GAAkB,EAC/BE,EAAQD,GAAQ,EAChBK,EAAQN,EAAiB,EACzB1tB,EAAQqtB,EAAQ,EAChBS,EAAOL,EAAOztB,KACdstB,EAAkB,IAAPQ,MAEfA,IAAS,EACFE,EAAQ,GACbV,EAAsB,IAAXA,EAAiBG,EAAOztB,KACnCguB,GAAS,MAEXT,EAAWD,GAAY,IAAMU,GAAS,EACtCV,KAAcU,EACdA,GAASZ,EACFY,EAAQ,GACbT,EAAsB,IAAXA,EAAiBE,EAAOztB,KACnCguB,GAAS,EAEX,GAAiB,IAAbV,EACFA,EAAW,EAAIM,MACV,CAAA,GAAIN,IAAaK,EACtB,OAAOJ,EAAWnb,IAAM0b,GAAQ3b,EAAAA,EAAWA,EAAAA,EAE3Cob,GAAsBZ,GAAI,EAAGS,GAC7BE,GAAsBM,EACtB,OAAQE,GAAO,EAAK,GAAKP,EAAWZ,GAAI,EAAGW,EAAWF,eCjFtDhuB,MACA3D,GCVJwyB,GAAiB,SAAcp+B,OAC7B,IAAI8L,EAAI7B,GAAS1G,MACbhE,EAASgR,GAAkBzE,GAC3BoS,EAAkBvb,UAAUpD,OAC5B4Q,EAAQD,GAAgBgO,EAAkB,EAAIvb,UAAU,QAAK0D,EAAW9G,GACxE8f,EAAMnB,EAAkB,EAAIvb,UAAU,QAAK0D,EAC3Cg4B,OAAiBh4B,IAARgZ,EAAoB9f,EAAS2Q,GAAgBmP,EAAK9f,GACxD8+B,EAASluB,GAAOrE,EAAEqE,KAAWnQ,EACpC,OAAO8L,GDQT,IAAIwyB,GAAuB7vB,GAAAE,OACvB4vB,GAA6B9vB,GAAAG,aAC7B4vB,GAAmBtwB,GAAApK,IACnB26B,GAAmBvwB,GAAAJ,IAMnB4wB,GAAoBv7B,EAAmB,YACvCw7B,GAAeD,GACfE,GAAuBD,IAAgBA,GAAsB,UAC7DE,GAAY17B,EAAgB,SAC5B27B,GAAoBD,IAAaA,GAAmB,UACpDE,GAAkB1/B,OAAOgF,UACzB26B,GAAQ77B,EAAOgS,MACf8pB,GAAa97B,EAAOu5B,WACpBwC,GAAOz5B,EAAY24B,IACnBe,GAAU15B,EAAY,GAAG25B,SAEzBC,GAAchC,GAAAC,KACdgC,GAAgBjC,GAAAa,OAEhBqB,GAAW,SAAU1vB,GACvB,MAAO,CAAU,IAATA,IAGN2vB,GAAY,SAAU3vB,GACxB,MAAO,CAAU,IAATA,EAAeA,GAAU,EAAI,MAGnC4vB,GAAY,SAAU5vB,GACxB,MAAO,CAAU,IAATA,EAAeA,GAAU,EAAI,IAAMA,GAAU,GAAK,IAAMA,GAAU,GAAK,MAG7E6vB,GAAc,SAAU9B,GAC1B,OAAOA,EAAO,IAAM,GAAKA,EAAO,IAAM,GAAKA,EAAO,IAAM,EAAIA,EAAO,IAGjE+B,GAAc,SAAU9vB,GAC1B,OAAOwvB,GAAYxvB,EAAQ,GAAI,IAG7B+vB,GAAc,SAAU/vB,GAC1B,OAAOwvB,GAAYxvB,EAAQ,GAAI,IAG7BgwB,GAAY,SAAUra,EAAajc,MACtBic,EAAqB,UAAGjc,EAAK,CAAEzF,IAAK,WAAc,OAAO06B,GAAiBj7B,MAAMgG,OAG7Fu2B,GAAM,SAAUC,EAAMC,EAAO7vB,EAAO8vB,GACtC,IAAIC,EAAWvD,GAAQxsB,GACnBgwB,EAAQ3B,GAAiBuB,GAC7B,GAAIG,EAAWF,EAAQG,EAAMC,WAAY,MAAMnB,GA9C/B,eA+ChB,IAAIzB,EAAQgB,GAAiB2B,EAAMvC,QAAQJ,MACvC5nB,EAAQsqB,EAAWC,EAAME,WACzB/C,EAAOle,GAAWoe,EAAO5nB,EAAOA,EAAQoqB,GAC5C,OAAOC,EAAiB3C,EAAO6B,GAAQ7B,IAGrCgD,GAAM,SAAUP,EAAMC,EAAO7vB,EAAOowB,EAAYvgC,EAAOigC,GACzD,IAAIC,EAAWvD,GAAQxsB,GACnBgwB,EAAQ3B,GAAiBuB,GAC7B,GAAIG,EAAWF,EAAQG,EAAMC,WAAY,MAAMnB,GAxD/B,eA4DhB,IAHA,IAAIzB,EAAQgB,GAAiB2B,EAAMvC,QAAQJ,MACvC5nB,EAAQsqB,EAAWC,EAAME,WACzB/C,EAAOiD,GAAYvgC,GACdV,EAAI,EAAGA,EAAI0gC,EAAO1gC,IAAKk+B,EAAM5nB,EAAQtW,GAAKg+B,EAAK2C,EAAiB3gC,EAAI0gC,EAAQ1gC,EAAI,IAG3F,GAAK45B,GA8FE,CACL,IAAIsH,GAA8BlC,IAlKjB,gBAkKyCI,GAAkB3zB,KAE5E,GAAKrH,GAAM,WACTg7B,GAAkB,OACbh7B,GAAM,WACX,IAAIg7B,IAAkB,QAClBh7B,GAAM,WAIV,OAHA,IAAIg7B,GACJ,IAAIA,GAAkB,KACtB,IAAIA,GAAkBnc,KACfie,KAAgCjC,MAiB9BiC,IAA+BjC,IACxC/xB,GAA4BkyB,GAAmB,OA9LhC,mBA6Kb,EAEFC,GAAe,SAAqBp/B,GAElC,OADAmmB,GAAWniB,KAAMq7B,IACV,IAAIF,GAAkB/B,GAAQp9B,MAGjB,UAAIq/B,GAE1B,IAAK,IAA0D6B,GAAtDC,GAAIC,GAAuBjC,IAAoBkC,GAAI,EAAQF,GAAKnhC,OAASqhC,KACzEH,GAAMC,GAAKE,SAASjC,IACzBnyB,GAA4BmyB,GAAc8B,GAAK/B,GAAkB+B,KAIrE7B,GAAqBvqB,YAAcsqB,GAMjChjB,IAAkBvB,GAAe0kB,MAAuBC,IAC1DpjB,GAAemjB,GAAmBC,IAIpC,IAAI8B,GAAW,IAAIhC,GAAU,IAAIF,GAAa,IAC1CmC,GAAWr7B,EAAYq5B,GAAkBiC,SAC7CF,GAASE,QAAQ,EAAG,YACpBF,GAASE,QAAQ,EAAG,aAChBF,GAASG,QAAQ,IAAOH,GAASG,QAAQ,IAAI5b,GAAY0Z,GAAmB,CAC9EiC,QAAS,SAAiBV,EAAYrgC,GACpC8gC,GAASv9B,KAAM88B,EAAYrgC,GAAS,IAAM,KAE5CihC,SAAU,SAAkBZ,EAAYrgC,GACtC8gC,GAASv9B,KAAM88B,EAAYrgC,GAAS,IAAM,MAE3C,CAAEkP,QAAQ,SApIb0vB,IAVAD,GAAe,SAAqBp/B,GAClCmmB,GAAWniB,KAAMq7B,IACjB,IAAIwB,EAAazD,GAAQp9B,GACzBk/B,GAAiBl7B,KAAM,CACrBi6B,MAAO0B,GAAKF,GAAMoB,GAAa,GAC/BA,WAAYA,IAET38B,IAAaF,KAAK68B,WAAaA,KAGO,UAsB7CtB,IApBAD,GAAY,SAAkBjB,EAAQyC,EAAYD,GAChD1a,GAAWniB,KAAMu7B,IACjBpZ,GAAWkY,EAAQgB,IACnB,IAAIsC,EAAe1C,GAAiBZ,GAAQwC,WACxCe,EAASvxB,GAAoBywB,GACjC,GAAIc,EAAS,GAAKA,EAASD,EAAc,MAAMjC,GAAW,gBAE1D,GAAIkC,GADJf,OAA4B/5B,IAAf+5B,EAA2Bc,EAAeC,EAAS7wB,GAAS8vB,IAC/Cc,EAAc,MAAMjC,GApF/B,gBAqFfR,GAAiBl7B,KAAM,CACrBq6B,OAAQA,EACRwC,WAAYA,EACZC,WAAYc,IAET19B,IACHF,KAAKq6B,OAASA,EACdr6B,KAAK68B,WAAaA,EAClB78B,KAAK88B,WAAac,KAIiB,UAEnC19B,IACFo8B,GAAUlB,GAAc,cACxBkB,GAAUhB,GAAW,UACrBgB,GAAUhB,GAAW,cACrBgB,GAAUhB,GAAW,eAGvBzZ,GAAY0Z,GAAmB,CAC7BkC,QAAS,SAAiBX,GACxB,OAAOP,GAAIv8B,KAAM,EAAG88B,GAAY,IAAM,IAAM,IAE9Ce,SAAU,SAAkBf,GAC1B,OAAOP,GAAIv8B,KAAM,EAAG88B,GAAY,IAElCgB,SAAU,SAAkBhB,GAC1B,IAAI7C,EAAQsC,GAAIv8B,KAAM,EAAG88B,EAAY19B,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAQm3B,EAAM,IAAM,EAAIA,EAAM,KAAO,IAAM,IAE7C8D,UAAW,SAAmBjB,GAC5B,IAAI7C,EAAQsC,GAAIv8B,KAAM,EAAG88B,EAAY19B,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAOm3B,EAAM,IAAM,EAAIA,EAAM,IAE/B+D,SAAU,SAAkBlB,GAC1B,OAAOX,GAAYI,GAAIv8B,KAAM,EAAG88B,EAAY19B,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,KAEpFm7B,UAAW,SAAmBnB,GAC5B,OAAOX,GAAYI,GAAIv8B,KAAM,EAAG88B,EAAY19B,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,MAAgB,GAEpGo7B,WAAY,SAAoBpB,GAC9B,OAAOf,GAAcQ,GAAIv8B,KAAM,EAAG88B,EAAY19B,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAAY,KAElGq7B,WAAY,SAAoBrB,GAC9B,OAAOf,GAAcQ,GAAIv8B,KAAM,EAAG88B,EAAY19B,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAAY,KAElG06B,QAAS,SAAiBV,EAAYrgC,GACpCsgC,GAAI/8B,KAAM,EAAG88B,EAAYd,GAAUv/B,IAErCihC,SAAU,SAAkBZ,EAAYrgC,GACtCsgC,GAAI/8B,KAAM,EAAG88B,EAAYd,GAAUv/B,IAErC2hC,SAAU,SAAkBtB,EAAYrgC,GACtCsgC,GAAI/8B,KAAM,EAAG88B,EAAYb,GAAWx/B,EAAO2C,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,IAEnFu7B,UAAW,SAAmBvB,EAAYrgC,GACxCsgC,GAAI/8B,KAAM,EAAG88B,EAAYb,GAAWx/B,EAAO2C,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,IAEnFw7B,SAAU,SAAkBxB,EAAYrgC,GACtCsgC,GAAI/8B,KAAM,EAAG88B,EAAYZ,GAAWz/B,EAAO2C,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,IAEnFy7B,UAAW,SAAmBzB,EAAYrgC,GACxCsgC,GAAI/8B,KAAM,EAAG88B,EAAYZ,GAAWz/B,EAAO2C,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,IAEnF07B,WAAY,SAAoB1B,EAAYrgC,GAC1CsgC,GAAI/8B,KAAM,EAAG88B,EAAYV,GAAa3/B,EAAO2C,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,IAErF27B,WAAY,SAAoB3B,EAAYrgC,GAC1CsgC,GAAI/8B,KAAM,EAAG88B,EAAYT,GAAa5/B,EAAO2C,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,MAuDzFyU,GAAe6jB,GArNI,eAsNnB7jB,GAAe+jB,GArNC,YAuNhBoD,GAAiB,CACf9I,YAAawF,GACbvF,SAAUyF,cEnPRqD,GAAQhhC,KAAKyO,MAKjBwyB,GAAiBC,OAAOC,WAAa,SAAmBn/B,GACtD,OAAQuD,EAASvD,IAAOo/B,SAASp/B,IAAOg/B,GAAMh/B,KAAQA,aCLpDq/B,GAAap/B,EAAAu5B,WAEjB8F,GAAiB,SAAUt/B,GACzB,IAAIkI,EAASwE,GAAoB1M,GACjC,GAAIkI,EAAS,EAAG,MAAMm3B,GAAW,qCACjC,OAAOn3B,GCLT,IAAIq3B,GAAat/B,EAAAu5B,WAEjBgG,GAAiB,SAAUx/B,EAAIy/B,GAC7B,IAAIxB,EAASqB,GAAkBt/B,GAC/B,GAAIi+B,EAASwB,EAAO,MAAMF,GAAW,gBACrC,OAAOtB,aCeL5xB,MCfA8rB,GAAAK,uBAEJkH,GAAiB,SAAc74B,GAC7B,IAMIzK,EAAGC,EAAQ6L,EAAQmZ,EAAMnc,EAAUgT,EANnChE,EAAIkP,GAAa/iB,MACjBuI,EAAI7B,GAASF,GACbmU,EAAkBvb,UAAUpD,OAC5BsjC,EAAQ3kB,EAAkB,EAAIvb,UAAU,QAAK0D,EAC7Cy8B,OAAoBz8B,IAAVw8B,EACVlf,EAAiBJ,GAAkBzX,GAEvC,GAAI6X,IAAmBN,GAAsBM,OAE3CvI,GADAhT,EAAWqb,GAAY3X,EAAG6X,IACVvI,KAChBtP,EAAI,KACKyY,EAAOhgB,EAAK6W,EAAMhT,IAAWwV,MACpC9R,EAAEnC,KAAK4a,EAAKvkB,OAQhB,IALI8iC,GAAW5kB,EAAkB,IAC/B2kB,EAAQvtB,GAAKutB,EAAOlgC,UAAU,KAEhCpD,EAASgR,GAAkBzE,GAC3BV,EAAS,IAAG23B,GAAyB3rB,GAA5B,CAAgC7X,GACpCD,EAAI,EAAGC,EAASD,EAAGA,IACtB8L,EAAO9L,GAAKwjC,EAAUD,EAAM/2B,EAAExM,GAAIA,GAAKwM,EAAExM,GAE3C,OAAO8L,aC3BL43B,GAAOv9B,EAAY,GAAGkE,MAGtBs5B,GAAe,SAAU50B,GAC3B,IAAI60B,EAAiB,GAAR70B,EACT80B,EAAoB,GAAR90B,EACZ+0B,EAAkB,GAAR/0B,EACVg1B,EAAmB,GAARh1B,EACXi1B,EAAwB,GAARj1B,EAChBk1B,EAA2B,GAARl1B,EACnBm1B,EAAmB,GAARn1B,GAAai1B,EAC5B,OAAO,SAAU3yB,EAAOgH,EAAYpC,EAAMkuB,GASxC,IARA,IAOIzjC,EAAOoL,EAPPU,EAAI7B,GAAS0G,GACbrN,EAAO2C,EAAc6F,GACrB43B,EAAgBpuB,GAAKqC,EAAYpC,GACjChW,EAASgR,GAAkBjN,GAC3B6M,EAAQ,EACRuJ,EAAS+pB,GAAkBpsB,GAC3B1F,EAASuxB,EAASxpB,EAAO/I,EAAOpR,GAAU4jC,GAAaI,EAAmB7pB,EAAO/I,EAAO,QAAKtK,EAE3F9G,EAAS4Q,EAAOA,IAAS,IAAIqzB,GAAYrzB,KAAS7M,KAEtD8H,EAASs4B,EADT1jC,EAAQsD,EAAK6M,GACiBA,EAAOrE,GACjCuC,GACF,GAAI60B,EAAQvxB,EAAOxB,GAAS/E,OACvB,GAAIA,EAAQ,OAAQiD,GACvB,KAAK,EAAG,OAAO,EACf,KAAK,EAAG,OAAOrO,EACf,KAAK,EAAG,OAAOmQ,EACf,KAAK,EAAG6yB,GAAKrxB,EAAQ3R,QAChB,OAAQqO,GACb,KAAK,EAAG,OAAO,EACf,KAAK,EAAG20B,GAAKrxB,EAAQ3R,GAI3B,OAAOsjC,GAAgB,EAAKF,GAAWC,EAAWA,EAAW1xB,QAIjEgyB,GAAiB,CAGfC,QAASX,GAAa,GAGtBY,IAAKZ,GAAa,GAGlBa,OAAQb,GAAa,GAGrBc,KAAMd,GAAa,GAGnBe,MAAOf,GAAa,GAGpBgB,KAAMhB,GAAa,GAGnBiB,UAAWjB,GAAa,GAGxBkB,aAAclB,GAAa,KF9CzBW,QGpBJQ,GAAiB,SAAUzzB,EAAO0zB,EAAOC,GACvC,IAAIC,EAAWC,EAUf,OAPE7oB,IAEApV,EAAWg+B,EAAYF,EAAMhwB,cAC7BkwB,IAAcD,GACd79B,EAAS+9B,EAAqBD,EAAUlgC,YACxCmgC,IAAuBF,EAAQjgC,WAC/BsX,GAAehL,EAAO6zB,GACjB7zB,GHgBT,IAAI8zB,GAAmBv2B,GAAApK,IACnB4gC,GAAmBx2B,GAAAJ,IACnB62B,GAAuB/4B,GACvBg5B,GAAiC5hC,EACjC6hC,GAAQ3jC,KAAK4jC,MACbC,GAAa5hC,EAAOu5B,WACpBsI,GAAc/C,GAAA9I,YACd8L,GAAuBD,GAAY3gC,UACnC6gC,GAAWjD,GAAA7I,SACX+L,GAA4B9J,GAAAC,0BAC5B8J,GAA0B/J,GAAAE,wBAC1B8J,GAAkBhK,GAAAG,gBAClB8J,GAAajK,GAAAc,WACboJ,GAAsBlK,GAAAe,oBACtBoJ,GAAyBnK,GAAAK,uBACzB+J,GAAepK,GAAAa,aAIfwJ,GAAW,SAAUtuB,EAAGuuB,GAC1BH,GAAuBpuB,OACvB,IAAIjH,EAAQ,EACR5Q,EAASomC,EAAKpmC,OACd6L,EAAS,IAAIgM,EAAE7X,GACZA,EAAS4Q,GAAO/E,EAAO+E,GAASw1B,EAAKx1B,KAC5C,OAAO/E,GAGLw6B,GAAY,SAAU1iC,EAAIqG,GAC5Bo7B,GAAqBzhC,EAAIqG,EAAK,CAAEzF,IAAK,WACnC,OAAO2gC,GAAiBlhC,MAAMgG,OAI9Bs8B,GAAgB,SAAU3iC,GAC5B,IAAIk4B,EACJ,OAAOt0B,EAAcm+B,GAAsB/hC,IAAgC,gBAAxBk4B,EAAQznB,GAAQzQ,KAAkC,qBAATk4B,GAG1F0K,GAAoB,SAAUn0B,EAAQpI,GACxC,OAAOk8B,GAAa9zB,KACdrJ,EAASiB,IACVA,KAAOoI,GACPwwB,IAAkB54B,IAClBA,GAAO,GAGVw8B,GAAkC,SAAkCp0B,EAAQpI,GAE9E,OADAA,EAAM+B,EAAc/B,GACbu8B,GAAkBn0B,EAAQpI,GAC7BvE,EAAyB,EAAG2M,EAAOpI,IACnCq7B,GAA+BjzB,EAAQpI,IAGzCy8B,GAAwB,SAAwBr0B,EAAQpI,EAAKzE,GAE/D,OADAyE,EAAM+B,EAAc/B,KAChBu8B,GAAkBn0B,EAAQpI,IACzB9C,EAAS3B,IACTqF,GAAOrF,EAAY,WAClBqF,GAAOrF,EAAY,QACnBqF,GAAOrF,EAAY,QAEnBA,EAAWI,cACViF,GAAOrF,EAAY,cAAeA,EAAWK,UAC7CgF,GAAOrF,EAAY,gBAAiBA,EAAWC,WAI7C4/B,GAAqBhzB,EAAQpI,EAAKzE,IAFzC6M,EAAOpI,GAAOzE,EAAW9E,MAClB2R,IAIPlO,GACG0hC,KACHniC,EAAmC+iC,GACnCn6B,GAAyBo6B,GACzBJ,GAAUL,GAAqB,UAC/BK,GAAUL,GAAqB,cAC/BK,GAAUL,GAAqB,cAC/BK,GAAUL,GAAqB,WAGjC3yB,EAAE,CAAEjB,OAAQ,SAAUwB,MAAM,EAAME,QAAS8xB,IAA6B,CACtExgC,yBAA0BohC,GAC1BliC,eAAgBmiC,KAGlBC,GAAiB,SAAU53B,EAAMqhB,EAASwW,GACxC,IAAIvD,EAAQt0B,EAAKjO,MAAK,QAAS,GAAK,EAChCmlB,EAAmBlX,GAAQ63B,EAAU,UAAY,IAAM,QACvDC,EAAS,MAAQ93B,EACjB+3B,EAAS,MAAQ/3B,EACjBg4B,EAA8BljC,EAAOoiB,GACrCuW,EAAwBuK,EACxBC,EAAiCxK,GAAyBA,EAAsBz3B,UAChFkiC,EAAW,GAaXC,EAAa,SAAUjxB,EAAMpF,GAC/Bw0B,GAAqBpvB,EAAMpF,EAAO,CAChCrM,IAAK,WACH,OAdO,SAAUyR,EAAMpF,GAC3B,IAAIqC,EAAOiyB,GAAiBlvB,GAC5B,OAAO/C,EAAKutB,KAAKoG,GAAQh2B,EAAQwyB,EAAQnwB,EAAK6tB,YAAY,GAY/Cnd,CAAO3f,KAAM4M,IAEtBrC,IAAK,SAAU9N,GACb,OAZO,SAAUuV,EAAMpF,EAAOnQ,GAClC,IAAIwS,EAAOiyB,GAAiBlvB,GACxB2wB,IAASlmC,GAASA,EAAQ6kC,GAAM7kC,IAAU,EAAI,EAAIA,EAAQ,IAAO,IAAe,IAARA,GAC5EwS,EAAKutB,KAAKqG,GAAQj2B,EAAQwyB,EAAQnwB,EAAK6tB,WAAYrgC,GAAO,GAS/C6b,CAAOtY,KAAM4M,EAAOnQ,IAE7B+E,YAAY,KAIXogC,GAwCM5I,KACTT,EAAwBpM,GAAQ,SAAU2U,EAAO7xB,EAAMi0B,EAAkBC,GAEvE,OADAhhB,GAAW2e,EAAOiC,GACXlC,GACA39B,EAAS+L,GACVqzB,GAAcrzB,QAA0BnM,IAAZqgC,EAC5B,IAAIL,EAA4B7zB,EAAMkwB,GAAS+D,EAAkB9D,GAAQ+D,QACpDrgC,IAArBogC,EACE,IAAIJ,EAA4B7zB,EAAMkwB,GAAS+D,EAAkB9D,IACjE,IAAI0D,EAA4B7zB,GAClCizB,GAAajzB,GAAckzB,GAAS5J,EAAuBtpB,GACxDjO,EAAKq+B,GAAgB9G,EAAuBtpB,GAPvB,IAAI6zB,EAA4B1J,GAAQnqB,IAQjE6xB,EAAOvI,MAGVngB,IAAgBA,GAAemgB,EAAuBwJ,UAC9Be,IAA8B,SAAU98B,GAC5DA,KAAOuyB,GACXtvB,GAA4BsvB,EAAuBvyB,EAAK88B,EAA4B98B,OAGxFuyB,EAAsBz3B,UAAYiiC,IA5DlCxK,EAAwBpM,GAAQ,SAAUna,EAAM/C,EAAM2uB,EAAQuF,GAC5DhhB,GAAWnQ,EAAM+wB,GACjB,IAEI1I,EAAQwC,EAAY7gC,EAFpB4Q,EAAQ,EACRkwB,EAAa,EAEjB,GAAK55B,EAAS+L,GAIP,CAAA,IAAIqzB,GAAcrzB,GAalB,OAAIizB,GAAajzB,GACfkzB,GAAS5J,EAAuBtpB,GAEhCjO,EAAKq+B,GAAgB9G,EAAuBtpB,GAfnDorB,EAASprB,EACT6tB,EAAaqC,GAASvB,EAAQwB,GAC9B,IAAIgE,EAAOn0B,EAAK4tB,WAChB,QAAgB/5B,IAAZqgC,EAAuB,CACzB,GAAIC,EAAOhE,EAAO,MAAMoC,GArHjB,gBAuHP,IADA3E,EAAauG,EAAOtG,GACH,EAAG,MAAM0E,GAvHnB,qBA0HP,IADA3E,EAAa9vB,GAASo2B,GAAW/D,GAChBtC,EAAasG,EAAM,MAAM5B,GA1HnC,gBA4HTxlC,EAAS6gC,EAAauC,OAftBpjC,EAASo9B,GAAQnqB,GAEjBorB,EAAS,IAAIoH,GADb5E,EAAa7gC,EAASojC,OAoBxB+B,GAAiBnvB,EAAM,CACrBqoB,OAAQA,EACRyC,WAAYA,EACZD,WAAYA,EACZ7gC,OAAQA,EACRwgC,KAAM,IAAImF,GAAStH,KAEdztB,EAAQ5Q,GAAQinC,EAAWjxB,EAAMpF,QAGtCwL,IAAgBA,GAAemgB,EAAuBwJ,IAC1DgB,EAAiCxK,EAAsBz3B,UAAYoV,GAAO8rB,KAyBxEe,EAA+BjyB,cAAgBynB,GACjDtvB,GAA4B85B,EAAgC,cAAexK,GAG7EtvB,GAA4B85B,EAAgClB,GAAyBtJ,GAEjFuJ,IACF74B,GAA4B85B,EAAgCjB,GAAiB9f,GAG/EghB,EAAShhB,GAAoBuW,EAE7BlpB,EAAE,CACAK,QAAQ,EAAMI,OAAQyoB,GAAyBuK,EAA6Bn+B,MAAOi9B,IAClFoB,GArLiB,sBAuLOzK,GACzBtvB,GAA4BsvB,EAxLV,oBAwLoD6G,GAxLpD,sBA2LO2D,GACzB95B,GAA4B85B,EA5LV,oBA4L6D3D,GAGjFrd,GAAWC,KAER0gB,GAAiB,aI7OxBA,GAA4B,WAAW,SAAUW,GAC/C,OAAO,SAAsBp0B,EAAM6tB,EAAY9gC,GAC7C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OCFxC0mC,GAA4B,WAAW,SAAUW,GAC/C,OAAO,SAAsBp0B,EAAM6tB,EAAY9gC,GAC7C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OCFxC0mC,GAA4B,QAAQ,SAAUW,GAC5C,OAAO,SAAmBp0B,EAAM6tB,EAAY9gC,GAC1C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OCFxC0mC,GAA4B,SAAS,SAAUW,GAC7C,OAAO,SAAoBp0B,EAAM6tB,EAAY9gC,GAC3C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OCFxC0mC,GAA4B,SAAS,SAAUW,GAC7C,OAAO,SAAoBp0B,EAAM6tB,EAAY9gC,GAC3C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OCFxC0mC,GAA4B,SAAS,SAAUW,GAC7C,OAAO,SAAoBp0B,EAAM6tB,EAAY9gC,GAC3C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OCFxC0mC,GAA4B,SAAS,SAAUW,GAC7C,OAAO,SAA2Bp0B,EAAM6tB,EAAY9gC,GAClD,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OAErC,GCJH0mC,GAA4B,UAAU,SAAUW,GAC9C,OAAO,SAAqBp0B,EAAM6tB,EAAY9gC,GAC5C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,OCFxC0mC,GAA4B,UAAU,SAAUW,GAC9C,OAAO,SAAqBp0B,EAAM6tB,EAAY9gC,GAC5C,OAAOqnC,EAAKrjC,KAAMiP,EAAM6tB,EAAY9gC,UCJpC87B,GAAAW,8BAKyB,OAAQ4G,GAAgBrG,ICHrD,IAAIsK,GAAyBxL,GAAAK,wBAK7BoL,EAJmCzL,GAAAW,8BAIN,MAAM,eACjC,IAAI7rB,EAAQ,EACR5Q,EAASoD,UAAUpD,OACnB6L,EAAS,IAAKy7B,GAAuBtjC,MAA5B,CAAmChE,GACzCA,EAAS4Q,GAAO/E,EAAO+E,GAASxN,UAAUwN,KACjD,OAAO/E,IACNmxB,WCbCwK,GAAUthC,EAAY,GAAG1F,SAEzBinC,GAAgC/+B,OAAOvI,MAAsB,UAAXS,OAClD8mC,GAAwB,uBACxBC,GAAwBD,GAAyBjjC,KAAKgjC,IAE1DG,GAAiB,SAAUhnC,EAAOinC,GAChC,GAAIF,IAAyC,iBAAT/mC,EAAiB,KAC5CinC,KAAejnC,EAAQ4mC,GAAQ5mC,EAAO8mC,GAA0B,IACvE,OAAO9mC,UCNXknC,GAAiB,SAAUv7B,EAAGmD,GACxBxI,EAASwI,IAAY,UAAWA,GAClCzC,GAA4BV,EAAG,QAASmD,EAAQq4B,eCLpDC,GAAiB,SAAU/gC,EAAUghC,GACnC,YAAoBnhC,IAAbG,EAAyB7D,UAAUpD,OAAS,EAAI,GAAKioC,EAAWxzB,GAASxN,WCAlFihC,IAAkB/jC,GAAM,WACtB,IAAIE,EAAQlE,MAAM,KAClB,QAAM,UAAWkE,KAEjBvE,OAAOwE,eAAeD,EAAO,QAASoB,EAAyB,EAAG,IAC3C,IAAhBpB,EAAMzD,UCSf,IAAIunC,GAAgB58B,GAAgB,eAChC68B,GAAQxkC,EAAAzD,MACRkoC,GAAO,GAAGj+B,KAEVk+B,GAAkB,SAAwBC,EAAQC,GACpD,IAEIxyB,EAFAtG,EAAUtM,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,EAChD2hC,EAAalhC,EAAcmhC,GAAyB1kC,MAEpDoY,GACFpG,EAAOoG,GAAe,IAAIgsB,GAASK,EAAa5tB,GAAe7W,MAAQ0kC,KAEvE1yB,EAAOyyB,EAAazkC,KAAOkW,GAAOwuB,IAClCz7B,GAA4B+I,EAAMmyB,GAAe,eAEnCrhC,IAAZ0hC,GAAuBv7B,GAA4B+I,EAAM,UAAWgyB,GAAwBQ,IAC5FN,IAAyBj7B,GAA4B+I,EAAM,QAAS4xB,GAAgB5xB,EAAKpV,MAAO,IACpGknC,GAAkB9xB,EAAMtG,GACxB,IAAIi5B,EAAc,GAGlB,OAFA/jB,GAAQ2jB,EAAQF,GAAM,CAAEryB,KAAM2yB,IAC9B17B,GAA4B+I,EAAM,SAAU2yB,GACrC3yB,GAGLoG,GAAgBA,GAAeksB,GAAiBF,IAC/Cj2B,GAA0Bm2B,GAAiBF,GAAO,CAAE58B,MAAM,IAE/D,IAAIk9B,GAA0BJ,GAAgBxjC,UAAYoV,GAAOkuB,GAAMtjC,UAAW,CAChFgQ,YAAarP,EAAyB,EAAG6iC,IACzCE,QAAS/iC,EAAyB,EAAG,IACrC+F,KAAM/F,EAAyB,EAAG,oBAKpC4N,EAAE,CAAEK,QAAQ,GAAQ,CAClBk1B,eAAgBN,KC3CdpkC,KAAiB,aAAe,MAJhCmI,GAKauJ,MAAM9Q,UAAW,YAAa,CAC3Ca,cAAc,EACdpB,IAAK,WACH,IAAIgI,EAAI7B,GAAS1G,MACb6kC,EAAM73B,GAAkBzE,GAC5B,OAAc,GAAPs8B,EAAW,EAAIA,EAAM,KAIhCvuB,GAAiB,cCVfpW,KAAiB,YAAc,MAJ/BmI,GAKauJ,MAAM9Q,UAAW,WAAY,CAC1Ca,cAAc,EACdpB,IAAK,WACH,IAAIgI,EAAI7B,GAAS1G,MACb6kC,EAAM73B,GAAkBzE,GAC5B,OAAc,GAAPs8B,OAAW/hC,EAAYyF,EAAEs8B,EAAM,IAExCt6B,IAAK,SAAkB9N,GACrB,IAAI8L,EAAI7B,GAAS1G,MACb6kC,EAAM73B,GAAkBzE,GAC5B,OAAOA,EAAS,GAAPs8B,EAAW,EAAIA,EAAM,GAAKpoC,KAIvC6Z,GAAiB,0BCNHwuB,MCbZz8B,MDFA2D,GAGA+4B,GAA+B,iBAAVjlC,QAAsBA,QAAUhE,OAAOkS,oBAC5DlS,OAAOkS,oBAAoBlO,QAAU,GAWzCglC,GAAmB,SAA6BnlC,GAC9C,OAAOolC,IAA8B,UAAfziC,EAAQ3C,GAVX,SAAUA,GAC7B,IACE,OAAMqlC,GAAsBrlC,GAC5B,MAAOU,GACP,OAAOwb,GAAWkpB,KAOhBE,CAAetlC,GAAEqlC,GACIjiC,EAAgBpD,kBElB3CulC,GAAiB/kC,GAAM,WACrB,GAA0B,mBAAfy1B,YAA2B,CACpC,IAAIyE,EAAS,IAAIzE,YAAY,GAEzB95B,OAAOqpC,aAAa9K,IAASv+B,OAAOwE,eAAe+5B,EAAQ,IAAK,CAAE59B,MAAO,QCDjF,IAAI2oC,GAAgBtpC,OAAOqpC,aACvBE,GAAsBllC,GAAM,WAAcilC,GAAc,MAI5DE,GAAkBD,IAAuBH,GAA+B,SAAsBvlC,GAC5F,QAAKuD,EAASvD,OACVulC,IAA8C,eAAf5iC,EAAQ3C,OACpCylC,IAAgBA,GAAczlC,MACnCylC,UCbJG,IAAkBplC,GAAM,WAEtB,OAAOrE,OAAOqpC,aAAarpC,OAAO0pC,kBAAkB,QHQtD,IAAIC,IAAW,EACXC,GAAWz+B,GAAI,QACf0+B,GAAK,EAELC,GAAc,SAAUjmC,MACXA,EAAI+lC,GAAU,CAAEjpC,MAAO,CACpCopC,SAAU,IAAMF,KAChBG,SAAU,OA8DVC,GAAOC,GAAiB,CAC1BC,OA3BW,WACXF,GAAKE,OAAS,aACdR,IAAW,EACX,IAAIz3B,EAAsBhC,GACtBk6B,EAAShkC,EAAY,GAAGgkC,QACxBzlC,EAAO,GACXA,EAAKilC,IAAY,EAGb13B,EAAoBvN,GAAMzE,SAC5BgQ,GAA8B,SAAUrM,GAEtC,IADA,IAAIkI,EAASmG,EAAoBrO,GACxB5D,EAAI,EAAGC,EAAS6L,EAAO7L,OAAQD,EAAIC,EAAQD,IAClD,GAAI8L,EAAO9L,KAAO2pC,GAAU,CAC1BQ,EAAOr+B,EAAQ9L,EAAG,GAClB,MAEF,OAAO8L,GAGXwH,EAAE,CAAEjB,OAAQ,SAAUwB,MAAM,EAAME,QAAQ,GAAQ,CAChD9B,oBAAqB82B,OAOzBqB,QA5DY,SAAUxmC,EAAIwW,GAE1B,IAAKjT,EAASvD,GAAK,MAAoB,iBAANA,EAAiBA,GAAmB,iBAANA,EAAiB,IAAM,KAAOA,EAC7F,IAAKiH,GAAOjH,EAAI+lC,IAAW,CAEzB,IAAKJ,GAAa3lC,GAAK,MAAO,IAE9B,IAAKwW,EAAQ,MAAO,IAEpByvB,GAAYjmC,GAEZ,OAAOA,EAAG+lC,IAAUG,UAkDtBO,YA/CgB,SAAUzmC,EAAIwW,GAC9B,IAAKvP,GAAOjH,EAAI+lC,IAAW,CAEzB,IAAKJ,GAAa3lC,GAAK,OAAO,EAE9B,IAAKwW,EAAQ,OAAO,EAEpByvB,GAAYjmC,GAEZ,OAAOA,EAAG+lC,IAAUI,UAuCtBO,SAnCa,SAAU1mC,GAEvB,OADI4lC,IAAYE,IAAYH,GAAa3lC,KAAQiH,GAAOjH,EAAI+lC,KAAWE,GAAYjmC,GAC5EA,IAoCTgK,GAAW+7B,KAAY,EIxEvBY,GAAiB,SAAUtkB,EAAkBmK,EAASoa,GACpD,IAAI5G,GAA6C,IAApC3d,EAAiBxU,QAAQ,OAClCg5B,GAA+C,IAArCxkB,EAAiBxU,QAAQ,QACnCi5B,EAAQ9G,EAAS,MAAQ,MACzB+G,EAAoB9mC,EAAOoiB,GAC3B2kB,EAAkBD,GAAqBA,EAAkB5lC,UACzDmhB,EAAcykB,EACd1D,EAAW,GAEX4D,EAAY,SAAUttB,GACxB,IAAIsX,EAAwB1uB,EAAYykC,EAAgBrtB,IACxD7N,GAASk7B,EAAiBrtB,EACjB,OAAPA,EAAe,SAAa7c,GAE1B,OADAm0B,EAAsB5wB,KAAgB,IAAVvD,EAAc,EAAIA,GACvCuD,MACE,UAAPsZ,EAAkB,SAAUtT,GAC9B,QAAOwgC,IAAYtjC,EAAS8C,KAAe4qB,EAAsB5wB,KAAc,IAARgG,EAAY,EAAIA,IAC9E,OAAPsT,EAAe,SAAatT,GAC9B,OAAOwgC,IAAYtjC,EAAS8C,QAAOlD,EAAY8tB,EAAsB5wB,KAAc,IAARgG,EAAY,EAAIA,IAClF,OAAPsT,EAAe,SAAatT,GAC9B,QAAOwgC,IAAYtjC,EAAS8C,KAAe4qB,EAAsB5wB,KAAc,IAARgG,EAAY,EAAIA,IACrF,SAAaA,EAAKvJ,GAEpB,OADAm0B,EAAsB5wB,KAAc,IAARgG,EAAY,EAAIA,EAAKvJ,GAC1CuD,QAYb,GAPcoP,GACZ4S,GACChf,EAAW0jC,MAAwBF,GAAWG,EAAgBtG,UAAYlgC,GAAM,YAC/E,IAAIumC,GAAoB5sB,UAAUjC,YAMpCoK,EAAcskB,EAAOM,eAAe1a,EAASnK,EAAkB2d,EAAQ8G,GACvET,GAAAC,cACK,GAAI72B,GAAS4S,GAAkB,GAAO,CAC3C,IAAI8kB,EAAW,IAAI7kB,EAEf8kB,EAAiBD,EAASL,GAAOD,EAAU,IAAK,EAAI,IAAMM,EAE1DE,EAAuB7mC,GAAM,WAAc2mC,EAASz8B,IAAI,MAGxD48B,EAAmBtkB,IAA4B,SAAU9B,GAAY,IAAI6lB,EAAkB7lB,MAE3FqmB,GAAcV,GAAWrmC,GAAM,eAEjC,IAAIgnC,EAAY,IAAIT,EAChB95B,EAAQ,EACLA,KAASu6B,EAAUV,GAAO75B,EAAOA,GACxC,OAAQu6B,EAAU98B,KAAI,MAGnB48B,KACHhlB,EAAckK,GAAQ,SAAU2U,EAAOjgB,GACrCsB,GAAW2e,EAAO6F,GAClB,IAAI30B,EAAO6uB,GAAkB,IAAI6F,EAAqB5F,EAAO7e,GAE7D,OADgBnf,MAAZ+d,GAAuBD,GAAQC,EAAU7O,EAAKy0B,GAAQ,CAAEz0B,KAAMA,EAAMiP,WAAY0e,IAC7E3tB,MAEGlR,UAAY6lC,EACxBA,EAAgB71B,YAAcmR,IAG5B+kB,GAAwBE,KAC1BN,EAAU,UACVA,EAAU,OACVjH,GAAUiH,EAAU,SAGlBM,GAAcH,IAAgBH,EAAUH,GAGxCD,GAAWG,EAAgB3gB,cAAc2gB,EAAgB3gB,MAU/D,OAPAgd,EAAShhB,GAAoBC,EAC7B5S,EAAE,CAAEK,QAAQ,EAAMI,OAAQmS,GAAeykB,GAAqB1D,GAE9DzrB,GAAe0K,EAAaD,GAEvBwkB,GAASD,EAAOa,UAAUnlB,EAAaD,EAAkB2d,GAEvD1d,UCtGL5Z,MASA29B,GAAAG,QAGAkB,GAAmB18B,GAAAJ,IACnB+8B,GAAyB38B,GAAAE,UCR7By7B,GAAW,OAAO,SAAUjD,GAC1B,OAAO,WAAiB,OAAOA,EAAKrjC,KAAMZ,UAAUpD,OAASoD,UAAU,QAAK0D,MDS7D,CACf+jC,eAAgB,SAAU1a,EAASnK,EAAkB2d,EAAQ8G,GAC3D,IAAIxkB,EAAckK,GAAQ,SAAUna,EAAM6O,GACxCsB,GAAWnQ,EAAMoQ,GACjBilB,GAAiBr1B,EAAM,CACrBzT,KAAMyjB,EACNpV,MAAOsJ,GAAO,MACdmb,WAAOvuB,EACPykC,UAAMzkC,EACN0uB,KAAM,IAEHtxB,IAAa8R,EAAKwf,KAAO,GACd1uB,MAAZ+d,GAAuBD,GAAQC,EAAU7O,EAAKy0B,GAAQ,CAAEz0B,KAAMA,EAAMiP,WAAY0e,OAGlFvd,EAAYH,EAAYnhB,UAExB0mC,EAAmBF,GAAuBtlB,GAE1CylB,EAAS,SAAUz1B,EAAMhM,EAAKvJ,GAChC,IAEIirC,EAAU96B,EAFV3C,EAAQu9B,EAAiBx1B,GACzB4W,EAAQ+e,EAAS31B,EAAMhM,GAqBzB,OAlBE4iB,EACFA,EAAMnsB,MAAQA,GAGdwN,EAAMs9B,KAAO3e,EAAQ,CACnBhc,MAAOA,EAAKg7B,GAAW5hC,GAAK,GAC5BA,IAAKA,EACLvJ,MAAOA,EACPirC,SAAUA,EAAWz9B,EAAMs9B,KAC3B1vB,UAAM/U,EACN+kC,SAAS,GAEN59B,EAAMonB,QAAOpnB,EAAMonB,MAAQzI,GAC5B8e,IAAUA,EAAS7vB,KAAO+Q,GAC1B1oB,EAAa+J,EAAMunB,OAClBxf,EAAKwf,OAEI,MAAV5kB,IAAe3C,EAAM2C,MAAMA,GAASgc,IACjC5W,GAGP21B,EAAW,SAAU31B,EAAMhM,GAC7B,IAGI4iB,EAHA3e,EAAQu9B,EAAiBx1B,GAEzBpF,EAAKg7B,GAAW5hC,GAEpB,GAAc,MAAV4G,EAAe,OAAO3C,EAAM2C,MAAMA,GAEtC,IAAKgc,EAAQ3e,EAAMonB,MAAOzI,EAAOA,EAAQA,EAAM/Q,KAC7C,GAAI+Q,EAAM5iB,KAAOA,EAAK,OAAO4iB,GAwFjC,OApFA/G,GAAYO,EAAW,CAIrB4D,MAAO,eACL,IACI/b,EAAQu9B,EADDxnC,MAEPiP,EAAOhF,EAAM2C,MACbgc,EAAQ3e,EAAMonB,MACXzI,GACLA,EAAMif,SAAU,EACZjf,EAAM8e,WAAU9e,EAAM8e,SAAW9e,EAAM8e,SAAS7vB,UAAO/U,UACpDmM,EAAK2Z,EAAMhc,OAClBgc,EAAQA,EAAM/Q,KAEhB5N,EAAMonB,MAAQpnB,EAAMs9B,UAAOzkC,EACvB5C,EAAa+J,EAAMunB,KAAO,EAXnBxxB,KAYDwxB,KAAO,GAKnBsW,OAAU,SAAU9hC,GAClB,IAAIgM,EAAOhS,KACPiK,EAAQu9B,EAAiBx1B,GACzB4W,EAAQ+e,EAAS31B,EAAMhM,GAC3B,GAAI4iB,EAAO,CACT,IAAI/Q,EAAO+Q,EAAM/Q,KACbkwB,EAAOnf,EAAM8e,gBACVz9B,EAAM2C,MAAMgc,EAAMhc,OACzBgc,EAAMif,SAAU,EACZE,IAAMA,EAAKlwB,KAAOA,GAClBA,IAAMA,EAAK6vB,SAAWK,GACtB99B,EAAMonB,OAASzI,IAAO3e,EAAMonB,MAAQxZ,GACpC5N,EAAMs9B,MAAQ3e,IAAO3e,EAAMs9B,KAAOQ,GAClC7nC,EAAa+J,EAAMunB,OAClBxf,EAAKwf,OACV,QAAS5I,GAKbyX,QAAS,SAAiBjsB,OACxB,IAEIwU,EAFA3e,EAAQu9B,EAAiBxnC,MACzBmgC,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAEpE8lB,EAAQA,EAAQA,EAAM/Q,KAAO5N,EAAMonB,WACxC8O,EAAcvX,EAAMnsB,MAAOmsB,EAAM5iB,IAAKhG,MAE/B4oB,GAASA,EAAMif,SAASjf,EAAQA,EAAM8e,UAMjDr9B,IAAK,SAAarE,GAChB,QAAS2hC,EAAS3nC,KAAMgG,MAI5B6b,GAAYO,EAAWud,EAAS,CAG9Bp/B,IAAK,SAAayF,GAChB,IAAI4iB,EAAQ+e,EAAS3nC,KAAMgG,GAC3B,OAAO4iB,GAASA,EAAMnsB,OAIxB8N,IAAK,SAAavE,EAAKvJ,GACrB,OAAOgrC,EAAOznC,KAAc,IAARgG,EAAY,EAAIA,EAAKvJ,KAEzC,CAGFisB,IAAK,SAAajsB,GAChB,OAAOgrC,EAAOznC,KAAMvD,EAAkB,IAAVA,EAAc,EAAIA,EAAOA,MAGrDyD,GAAW8nC,GAAiB5lB,EAAW,OAAQ,CACjD7hB,IAAK,WACH,OAAOinC,EAAiBxnC,MAAMwxB,QAG3BvP,GAETmlB,UAAW,SAAUnlB,EAAaD,EAAkB2d,GAClD,IAAIsI,EAAgBjmB,EAAmB,YACnCkmB,EAA6BZ,GAAuBtlB,GACpDmmB,EAA2Bb,GAAuBW,GAUtDlvB,GAAekJ,EAAaD,GAAkB,SAAU7H,EAAUC,GAChEitB,GAAiBrnC,KAAM,CACrBzB,KAAM0pC,EACN75B,OAAQ+L,EACRlQ,MAAOi+B,EAA2B/tB,GAClCC,KAAMA,EACNmtB,UAAMzkC,OAEP,eACD,IAAImH,EAAQk+B,EAAyBnoC,MACjCoa,EAAOnQ,EAAMmQ,KACbwO,EAAQ3e,EAAMs9B,KAEX3e,GAASA,EAAMif,SAASjf,EAAQA,EAAM8e,SAE7C,OAAKz9B,EAAMmE,SAAYnE,EAAMs9B,KAAO3e,EAAQA,EAAQA,EAAM/Q,KAAO5N,EAAMA,MAAMonB,OAMjE,QAARjX,EAAuB,CAAE3d,MAAOmsB,EAAM5iB,IAAKqU,MAAM,GACzC,UAARD,EAAyB,CAAE3d,MAAOmsB,EAAMnsB,MAAO4d,MAAM,GAClD,CAAE5d,MAAO,CAACmsB,EAAM5iB,IAAK4iB,EAAMnsB,OAAQ4d,MAAM,IAN9CpQ,EAAMmE,YAAStL,EACR,CAAErG,WAAOqG,EAAWuX,MAAM,MAMlCslB,EAAS,UAAY,UAAWA,GAAQ,GAK3C5d,GAAWC,gBEtMXgkB,GAAAI,YASAgC,GAAmBz9B,GAAAJ,IACnB89B,GAAyB19B,GAAAE,UACzBy9B,GAAOlI,GAAAM,KACP6H,GAAYnI,GAAAO,UACZ6H,GAAStmC,EAAY,GAAGgkC,QACxBuC,GAAK,EAGLC,GAAsB,SAAU9L,GAClC,OAAOA,EAAM+L,SAAW/L,EAAM+L,OAAS,IAAIC,KAGzCA,GAAsB,WACxB5oC,KAAK8Z,QAAU,IAGb+uB,GAAqB,SAAUjM,EAAO52B,GACxC,OAAOsiC,GAAK1L,EAAM9iB,SAAS,SAAUna,GACnC,OAAOA,EAAG,KAAOqG,MAIrB4iC,GAAoB9nC,UAAY,CAC9BP,IAAK,SAAUyF,GACb,IAAI4iB,EAAQigB,GAAmB7oC,KAAMgG,GACrC,GAAI4iB,EAAO,OAAOA,EAAM,IAE1Bve,IAAK,SAAUrE,GACb,QAAS6iC,GAAmB7oC,KAAMgG,IAEpCuE,IAAK,SAAUvE,EAAKvJ,GAClB,IAAImsB,EAAQigB,GAAmB7oC,KAAMgG,GACjC4iB,EAAOA,EAAM,GAAKnsB,EACjBuD,KAAK8Z,QAAQ1T,KAAK,CAACJ,EAAKvJ,KAE/BqrC,OAAU,SAAU9hC,GAClB,IAAI4G,EAAQ27B,GAAUvoC,KAAK8Z,SAAS,SAAUna,GAC5C,OAAOA,EAAG,KAAOqG,KAGnB,OADK4G,GAAO47B,GAAOxoC,KAAK8Z,QAASlN,EAAO,MAC9BA,IAIdk8B,GAAiB,CACfjC,eAAgB,SAAU1a,EAASnK,EAAkB2d,EAAQ8G,GAC3D,IAAIxkB,EAAckK,GAAQ,SAAUna,EAAM6O,GACxCsB,GAAWnQ,EAAMoQ,GACjBgmB,GAAiBp2B,EAAM,CACrBzT,KAAMyjB,EACN/lB,GAAIwsC,KACJE,YAAQ7lC,IAEMA,MAAZ+d,GAAuBD,GAAQC,EAAU7O,EAAKy0B,GAAQ,CAAEz0B,KAAMA,EAAMiP,WAAY0e,OAGlFvd,EAAYH,EAAYnhB,UAExB0mC,EAAmBa,GAAuBrmB,GAE1CylB,EAAS,SAAUz1B,EAAMhM,EAAKvJ,GAChC,IAAIwN,EAAQu9B,EAAiBx1B,GACzB/C,EAAI85B,GAAepgC,GAAS3C,IAAM,GAGtC,OAFa,IAATiJ,EAAey5B,GAAoBz+B,GAAOM,IAAIvE,EAAKvJ,GAClDwS,EAAKhF,EAAMhO,IAAMQ,EACfuV,GAkDT,OA/CA6P,GAAYO,EAAW,CAIrB0lB,OAAU,SAAU9hC,GAClB,IAAIiE,EAAQu9B,EAAiBxnC,MAC7B,IAAKkD,EAAS8C,GAAM,OAAO,EAC3B,IAAIiJ,EAAI85B,GAAe/iC,GACvB,OAAa,IAATiJ,EAAsBy5B,GAAoBz+B,GAAe,OAAEjE,GACxDiJ,GAAQrI,GAAOqI,EAAMhF,EAAMhO,YAAcgT,EAAKhF,EAAMhO,KAK7DoO,IAAK,SAAarE,GAChB,IAAIiE,EAAQu9B,EAAiBxnC,MAC7B,IAAKkD,EAAS8C,GAAM,OAAO,EAC3B,IAAIiJ,EAAI85B,GAAe/iC,GACvB,OAAa,IAATiJ,EAAsBy5B,GAAoBz+B,GAAOI,IAAIrE,GAClDiJ,GAAQrI,GAAOqI,EAAMhF,EAAMhO,OAItC4lB,GAAYO,EAAWud,EAAS,CAG9Bp/B,IAAK,SAAayF,GAChB,IAAIiE,EAAQu9B,EAAiBxnC,MAC7B,GAAIkD,EAAS8C,GAAM,CACjB,IAAIiJ,EAAI85B,GAAe/iC,GACvB,OAAa,IAATiJ,EAAsBy5B,GAAoBz+B,GAAO1J,IAAIyF,GAClDiJ,EAAOA,EAAKhF,EAAMhO,SAAM6G,IAKnCyH,IAAK,SAAavE,EAAKvJ,GACrB,OAAOgrC,EAAOznC,KAAMgG,EAAKvJ,KAEzB,CAGFisB,IAAK,SAAajsB,GAChB,OAAOgrC,EAAOznC,KAAMvD,GAAO,MAIxBwlB,QClHP+mB,MAJAr+B,GAAAC,QAGAq+B,IAAWrpC,EAAO4V,eAAiB,kBAAmB5V,EAGtDspC,GAAU,SAAU7F,GACtB,OAAO,WACL,OAAOA,EAAKrjC,KAAMZ,UAAUpD,OAASoD,UAAU,QAAK0D,KAMpDqmC,GAAW7C,GAAW,UAAW4C,GAASJ,IAK9C,GAAIt/B,IAAmBy/B,GAAS,CAC9BD,GAAkBF,GAAejC,eAAeqC,GAAS,WAAW,GACpElD,GAAAC,SACA,IAAImD,GAAmBD,GAASroC,UAC5BuoC,GAAennC,EAAYknC,GAAyB,QACpDE,GAAYpnC,EAAYknC,GAAiB/+B,KACzCk/B,GAAYrnC,EAAYknC,GAAiB7oC,KACzCipC,GAAYtnC,EAAYknC,GAAiB7+B,KAC7CsX,GAAYunB,GAAkB,CAC5BtB,OAAU,SAAU9hC,GAClB,GAAI9C,EAAS8C,KAASs/B,GAAat/B,GAAM,CACvC,IAAIiE,EAAKw/B,GAAwBzpC,MAEjC,OADKiK,EAAM0+B,SAAQ1+B,EAAM0+B,OAAS,IAAIK,IAC/BK,GAAarpC,KAAMgG,IAAQiE,EAAM0+B,OAAe,OAAE3iC,GACzD,OAAOqjC,GAAarpC,KAAMgG,IAE9BqE,IAAK,SAAarE,GAChB,GAAI9C,EAAS8C,KAASs/B,GAAat/B,GAAM,CACvC,IAAIiE,EAAKw/B,GAAwBzpC,MAEjC,OADKiK,EAAM0+B,SAAQ1+B,EAAM0+B,OAAS,IAAIK,IAC/BM,GAAUtpC,KAAMgG,IAAQiE,EAAM0+B,OAAOt+B,IAAIrE,GAChD,OAAOsjC,GAAUtpC,KAAMgG,IAE3BzF,IAAK,SAAayF,GAChB,GAAI9C,EAAS8C,KAASs/B,GAAat/B,GAAM,CACvC,IAAIiE,EAAKw/B,GAAwBzpC,MAEjC,OADKiK,EAAM0+B,SAAQ1+B,EAAM0+B,OAAS,IAAIK,IAC/BM,GAAUtpC,KAAMgG,GAAOujC,GAAUvpC,KAAMgG,GAAOiE,EAAM0+B,OAAOpoC,IAAIyF,GACtE,OAAOujC,GAAUvpC,KAAMgG,IAE3BuE,IAAK,SAAavE,EAAKvJ,GACrB,GAAIyG,EAAS8C,KAASs/B,GAAat/B,GAAM,CACvC,IAAIiE,EAAKw/B,GAAwBzpC,MAC5BiK,EAAM0+B,SAAQ1+B,EAAM0+B,OAAS,IAAIK,IACtCM,GAAUtpC,KAAMgG,GAAOwjC,GAAUxpC,KAAMgG,EAAKvJ,GAASwN,EAAM0+B,OAAOp+B,IAAIvE,EAAKvJ,QACtE+sC,GAAUxpC,KAAMgG,EAAKvJ,GAC5B,OAAOuD,QCxDb,IAAI0pC,GAAS9pC,EAAA9D,OACT6tC,GAAY/pC,EAAAgD,UACZgnC,GAAMxmC,EAAW,OACjBymC,GAAUzmC,EAAW,WAErB0mC,GAAO,WAET9pC,KAAKkJ,OAAS,KACdlJ,KAAKwE,OAAS,KAEdxE,KAAK+pC,WAAa,KAClB/pC,KAAKgqC,eAAiB9zB,GAAO,OAG/B4zB,GAAKhpC,UAAUP,IAAM,SAAUyF,EAAKikC,GAClC,OAAOjqC,KAAKgG,KAAShG,KAAKgG,GAAOikC,MAGnCH,GAAKhpC,UAAU+W,KAAO,SAAU9b,EAAG4D,EAAIuqC,GACrC,IAAItN,EAAQsN,EACRlqC,KAAKgqC,eAAejuC,KAAOiE,KAAKgqC,eAAejuC,GAAK,IAAI8tC,IACxD7pC,KAAK+pC,aAAe/pC,KAAK+pC,WAAa,IAAIH,IAC1ChhB,EAAQgU,EAAMr8B,IAAIZ,GAEtB,OADKipB,GAAOgU,EAAMryB,IAAI5K,EAAIipB,EAAQ,IAAIkhB,IAC/BlhB,GAGT,IAAIuhB,GAAO,IAAIL,GAEfM,GAAiB,WACf,IAEIruC,EAAG4D,EAFH0qC,EAASF,GACTnuC,EAASoD,UAAUpD,OAGvB,IAAKD,EAAI,EAAGA,EAAIC,EAAQD,IAClBmH,EAASvD,EAAKP,UAAUrD,MAAKsuC,EAASA,EAAOxyB,KAAK9b,EAAG4D,GAAI,IAE/D,GAAIK,OAAS0pC,IAAUW,IAAWF,GAAM,MAAMR,GAAU,yDACxD,IAAK5tC,EAAI,EAAGA,EAAIC,EAAQD,IACjBmH,EAASvD,EAAKP,UAAUrD,MAAKsuC,EAASA,EAAOxyB,KAAK9b,EAAG4D,GAAI,IAC9D,OAAO0qC,GCzCX,IAAIC,GAAS1qC,EAAA9D,OAETyuC,GAAc,WAChB,IAAIC,EAASpnC,EAAW,SAAU,UAClC,OAAOonC,EAASA,EAAOt0B,GAAO,OAASA,GAAO,OAIhD7G,EAAE,CAAEK,QAAQ,GAAQ,CAClB+6B,aAAc,WACZ,OAAOlnB,GAAM6mB,GAAqBE,GAAQlrC,WAAWmB,IAAI,SAAUgqC,OCXvEl7B,EAAE,CAAEK,QAAQ,GAAQ,CAClBg7B,gBAAiB,WACf,OAAwB,GAApBtrC,UAAUpD,QAAsC,iBAAhBoD,UAAU,GAAuBgE,EAAW,UAAe,IAAEhE,UAAU,IACpGmkB,GAAM6mB,GAAqB,KAAMhrC,WAAWmB,IAAI,SAAU6C,EAAW,cCJhFiM,EAAE,CAAEK,QAAQ,GAAQ,CAClB7P,WAAYD,WCCdyP,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OCP3B,ODO8C,CAC7D66B,UEFFC,GAAiB,WAKf,IAJA,IAGIC,EAHAC,EAAaniC,GAAS3I,MACtB+qC,EAAU3lC,GAAU0lC,EAAmB,QACvCE,GAAa,EAERjvB,EAAI,EAAG8oB,EAAMzlC,UAAUpD,OAAQ+f,EAAI8oB,EAAK9oB,IAC/C8uB,EAAa7pC,EAAK+pC,EAASD,EAAY1rC,UAAU2c,IACjDivB,EAAaA,GAAcH,EAE7B,QAASG,YCbXC,GAAiB,SAAUtrC,GAEzB,OAAOqB,EAAKkqC,IAAIpqC,UAAUgZ,QAASna,ICMrC0P,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OHV3B,OGU8C,CAC7D2wB,MAAO,SAAersB,GACpB,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BH,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAQ8d,GAAQ/b,GAAU,SAAUmB,EAAKvJ,EAAO2kB,GAC9C,IAAK+e,EAAc1jC,EAAOuJ,EAAKs6B,GAAM,OAAOlf,MAC3C,CAAEH,YAAY,EAAMC,aAAa,EAAMC,aAAa,IAAQT,WCHnErR,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OJd3B,OIc8C,CAC7DywB,OAAQ,SAAgBnsB,GACtB,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BH,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GACvEqoC,EAAS,IAAKloB,GAAmBqd,EAAKl9B,EAAW,SACjDkV,EAASlT,GAAU+lC,EAAO5gC,KAI9B,OAHAqW,GAAQ/b,GAAU,SAAUmB,EAAKvJ,GAC3B0jC,EAAc1jC,EAAOuJ,EAAKs6B,IAAMt/B,EAAKsX,EAAQ6yB,EAAQnlC,EAAKvJ,KAC7D,CAAEwkB,YAAY,EAAMC,aAAa,IAC7BiqB,KCdX97B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OLV3B,OKU8C,CAC7D4wB,KAAM,SAActsB,GAClB,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BH,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAO8d,GAAQ/b,GAAU,SAAUmB,EAAKvJ,EAAO2kB,GAC7C,GAAI+e,EAAc1jC,EAAOuJ,EAAKs6B,GAAM,OAAOlf,EAAK3kB,KAC/C,CAAEwkB,YAAY,EAAMC,aAAa,EAAMC,aAAa,IAAQtZ,UCPnEwH,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,ONV3B,OMU8C,CAC7Ds7B,QAAS,SAAiBh3B,GACxB,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BH,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAO8d,GAAQ/b,GAAU,SAAUmB,EAAKvJ,EAAO2kB,GAC7C,GAAI+e,EAAc1jC,EAAOuJ,EAAKs6B,GAAM,OAAOlf,EAAKpb,KAC/C,CAAEib,YAAY,EAAMC,aAAa,EAAMC,aAAa,IAAQtZ,iBCT/DwjC,GAAO,GAAGjlC,KCHdiJ,EAAE,CAAEjB,OAAQ,MAAOwB,MAAM,GAAQ,CAC/B8S,KDIF4oB,GAAiB,SAAc9kC,GAC7B,IAEI+4B,EAASnjB,EAAOH,EAAGkkB,EAFnBnkC,EAASoD,UAAUpD,OACnB6W,EAAQ7W,EAAS,EAAIoD,UAAU,QAAK0D,EAKxC,OAHAigB,GAAa/iB,OACbu/B,OAAoBz8B,IAAV+P,IACGzN,GAAUyN,GACT/P,MAAV0D,EAA4B,IAAIxG,MACpCoc,EAAQ,GACJmjB,GACFtjB,EAAI,EACJkkB,EAAgBpuB,GAAKc,EAAO7W,EAAS,EAAIoD,UAAU,QAAK0D,GACxD8d,GAAQpa,GAAQ,SAAU+kC,GACxBvqC,EAAKqqC,GAAMjvB,EAAO+jB,EAAcoL,EAAUtvB,UAG5C2E,GAAQpa,EAAQ6kC,GAAM,CAAEr5B,KAAMoK,IAEzB,IAAIpc,KAAKoc,OEpBlB,IAAIovB,GAAOtpC,EAAY,GAAGkE,MAI1BiJ,EAAE,CAAEjB,OAAQ,MAAOwB,MAAM,GAAQ,CAC/B67B,QAAS,SAAiB5qB,EAAU6qB,GAClCtmC,GAAUsmC,GACV,IAAI7mC,EAAWqb,GAAYW,GACvBsqB,EAAS,IAAInrC,KACbqK,EAAMjF,GAAU+lC,EAAO9gC,KACvB9J,EAAM6E,GAAU+lC,EAAO5qC,KACvBgK,EAAMnF,GAAU+lC,EAAO5gC,KAM3B,OALAqW,GAAQ/b,GAAU,SAAU4N,GAC1B,IAAIk5B,EAAaD,EAAcj5B,GAC1BzR,EAAKqJ,EAAK8gC,EAAQQ,GAClBH,GAAKxqC,EAAKT,EAAK4qC,EAAQQ,GAAal5B,GADLzR,EAAKuJ,EAAK4gC,EAAQQ,EAAY,CAACl5B,MAElE,CAAEyO,aAAa,IACXiqB,YCvBXS,GAAiB,SAAUvtB,EAAGC,GAE5B,OAAOD,IAAMC,GAAKD,GAAKA,GAAKC,GAAKA,GCMnCjP,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OXV3B,OWU8C,CAC7DvC,SAAU,SAAkBs+B,GAC1B,OAAOjrB,GAAQqqB,GAAetiC,GAAS3I,QAAQ,SAAUgG,EAAKvJ,EAAO2kB,GACnE,GAAIwqB,GAAcnvC,EAAOovC,GAAgB,OAAOzqB,MAC/C,CAAEH,YAAY,EAAMC,aAAa,EAAMC,aAAa,IAAQT,WCNnErR,EAAE,CAAEjB,OAAQ,MAAOwB,MAAM,GAAQ,CAC/Bk8B,MAAO,SAAejrB,EAAU6qB,GAC9B,IAAIP,EAAS,IAAInrC,KACjBoF,GAAUsmC,GACV,IAAIpzB,EAASlT,GAAU+lC,EAAO5gC,KAI9B,OAHAqW,GAAQC,GAAU,SAAUpO,GAC1BzR,EAAKsX,EAAQ6yB,EAAQO,EAAcj5B,GAAUA,MAExC04B,KCPX97B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,ObT3B,OaS8C,CAC7Di8B,MAAO,SAAeF,GACpB,OAAOjrB,GAAQqqB,GAAetiC,GAAS3I,QAAQ,SAAUgG,EAAKvJ,EAAO2kB,GACnE,GAAI3kB,IAAUovC,EAAe,OAAOzqB,EAAKpb,KACxC,CAAEib,YAAY,EAAMC,aAAa,EAAMC,aAAa,IAAQtZ,UCCnEwH,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,Odd3B,Occ8C,CAC7Dk8B,QAAS,SAAiB53B,GACxB,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BH,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GACvEqoC,EAAS,IAAKloB,GAAmBqd,EAAKl9B,EAAW,SACjDkV,EAASlT,GAAU+lC,EAAO5gC,KAI9B,OAHAqW,GAAQ/b,GAAU,SAAUmB,EAAKvJ,GAC/BuE,EAAKsX,EAAQ6yB,EAAQhL,EAAc1jC,EAAOuJ,EAAKs6B,GAAM7jC,KACpD,CAAEwkB,YAAY,EAAMC,aAAa,IAC7BiqB,KCVX97B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,Ofd3B,Oec8C,CAC7Dm8B,UAAW,SAAmB73B,GAC5B,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BH,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GACvEqoC,EAAS,IAAKloB,GAAmBqd,EAAKl9B,EAAW,SACjDkV,EAASlT,GAAU+lC,EAAO5gC,KAI9B,OAHAqW,GAAQ/b,GAAU,SAAUmB,EAAKvJ,GAC/BuE,EAAKsX,EAAQ6yB,EAAQnlC,EAAKm6B,EAAc1jC,EAAOuJ,EAAKs6B,MACnD,CAAErf,YAAY,EAAMC,aAAa,IAC7BiqB,KCfX97B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OhBT3B,OgBS8C,CAE7Do8B,MAAO,SAAerrB,OACpB,IAAIyf,EAAM33B,GAAS3I,MACfsY,EAASlT,GAAUk7B,EAAI/1B,KACvBoQ,EAAkBvb,UAAUpD,OAC5BD,EAAI,EACDA,EAAI4e,GACTiG,GAAQxhB,UAAUrD,KAAMuc,EAAQ,CAAEtG,KAAMsuB,EAAKrf,YAAY,IAE3D,OAAOqf,YCdXjxB,EAAE,CAAEjB,OAAQ,MAAOwB,MAAM,GAAQ,CAC/Bu8B,GCFFC,GAAiB,WACf,OAAO,IAAIpsC,KAAKyjB,GAAWrkB,eCI7B,IAAIitC,GAAYzsC,EAAAgD,UAIhByM,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OnBb3B,OmBa8C,CAC7DsL,OAAQ,SAAgBhH,GACtB,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BgM,EAAYltC,UAAUpD,OAAS,EAC/BuwC,EAAcD,OAAYxpC,EAAY1D,UAAU,GAUpD,GATAgG,GAAUgP,GACVwM,GAAQ/b,GAAU,SAAUmB,EAAKvJ,GAC3B6vC,GACFA,GAAY,EACZC,EAAc9vC,GAEd8vC,EAAcn4B,EAAWm4B,EAAa9vC,EAAOuJ,EAAKs6B,KAEnD,CAAErf,YAAY,EAAMC,aAAa,IAChCorB,EAAW,MAAMD,GAAU,6CAC/B,OAAOE,KCnBXl9B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OpBV3B,OoBU8C,CAC7D0wB,KAAM,SAAcpsB,GAClB,IAAIksB,EAAM33B,GAAS3I,MACf6E,EAAWomC,GAAe3K,GAC1BH,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAO8d,GAAQ/b,GAAU,SAAUmB,EAAKvJ,EAAO2kB,GAC7C,GAAI+e,EAAc1jC,EAAOuJ,EAAKs6B,GAAM,OAAOlf,MAC1C,CAAEH,YAAY,EAAMC,aAAa,EAAMC,aAAa,IAAQT,WCTnE,IAAI8rB,GAAY5sC,EAAAgD,UAIhByM,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OrBZ3B,OqBY8C,CAC7D28B,OAAQ,SAAgBzmC,EAAK0mC,GAC3B,IAAIpM,EAAM33B,GAAS3I,MACfO,EAAM6E,GAAUk7B,EAAI//B,KACpB8J,EAAMjF,GAAUk7B,EAAIj2B,KACpBE,EAAMnF,GAAUk7B,EAAI/1B,KACpBvO,EAASoD,UAAUpD,OACvBoJ,GAAUsnC,GACV,IAAIC,EAAiB3rC,EAAKqJ,EAAKi2B,EAAKt6B,GACpC,IAAK2mC,GAAkB3wC,EAAS,EAC9B,MAAMwwC,GAAU,yBAElB,IAAI/vC,EAAQkwC,EAAiB3rC,EAAKT,EAAK+/B,EAAKt6B,GAAOZ,GAAUpJ,EAAS,EAAIoD,UAAU,QAAK0D,EAAtCsC,CAAiDY,EAAKs6B,GAEzG,OADAt/B,EAAKuJ,EAAK+1B,EAAKt6B,EAAK0mC,EAASjwC,EAAOuJ,EAAKs6B,IAClCA,KCxBX,IAAIsM,GAAMjvC,KAAK+O,IACXmgC,GAAMlvC,KAAK6O,IAIf6C,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCk9B,MAAO,SAAezuB,EAAG0uB,EAAOC,GAC9B,OAAOJ,GAAII,EAAOH,GAAIE,EAAO1uB,OCLjChP,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCq9B,YAAatvC,KAAKuvC,GAAK,MCHzB,IAAIC,GAAc,IAAMxvC,KAAKuvC,GAI7B79B,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCw9B,QAAS,SAAiBC,GACxB,OAAOA,EAAUF,gBCNrBG,GAAiB3vC,KAAK4vC,OAAS,SAAelvB,EAAGmvB,EAAOC,EAAQC,EAAQC,GACtE,IAAIC,GAAMvvB,EACNwvB,GAAUL,EACVM,GAAWL,EACXM,GAAWL,EACXM,GAAYL,EAEhB,OAAIC,GAAMA,GAAMC,GAAUA,GAAUC,GAAWA,GAAWC,GAAWA,GAAWC,GAAYA,EAAiBhvB,IACzG4uB,IAAO7uB,EAAAA,GAAY6uB,KAAQ7uB,EAAAA,EAAiB6uB,GACxCA,EAAKC,IAAWG,EAAWD,IAAYD,EAAUD,GAAUE,mBCRrEE,GAAiBtwC,KAAK+8B,MAAQ,SAAcrc,GAE1C,OAAmB,IAAXA,GAAKA,IAAWA,GAAKA,EAAIA,EAAIA,EAAI,GAAI,EAAK,GCHpD,IAAI6vB,GAAMvwC,KAAKghB,IACXwvB,GAAMxwC,KAAK67B,IACX4U,GAAUD,GAAI,GAAG,IACjBE,GAAYF,GAAI,GAAG,IACnBG,GAAQH,GAAI,EAAG,MAAQ,EAAIE,IAC3BE,GAAQJ,GAAI,GAAG,KASnBK,GAAiB7wC,KAAK8wC,QAAU,SAAgBpwB,GAC9C,IAEIjW,EAAGP,EAFH6mC,EAAOR,GAAI7vB,GACXswB,EAAQV,GAAK5vB,GAEjB,OAAIqwB,EAAOH,GAAcI,GAAwBD,EAAOH,GAAQF,GAVrD,EAAID,GAAU,EAAIA,IAUgDG,GAAQF,IAErFxmC,GADAO,GAAK,EAAIimC,GAAYD,IAAWM,IAClBtmC,EAAIsmC,IAELJ,IAASzmC,GAAUA,EAAe8mC,GAAQ5vB,EAAAA,GAChD4vB,EAAQ9mC,GClBjBwH,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCg/B,OAAQ,SAAgBvwB,EAAGmvB,EAAOC,EAAQC,EAAQC,GAChD,OAAOa,GAAOlB,GAAMjvB,EAAGmvB,EAAOC,EAAQC,EAAQC,OCJlDt+B,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCi/B,MAAO,SAAeC,EAAIC,EAAIC,EAAIC,GAChC,IAAIC,EAAMJ,IAAO,EAEbK,EAAMH,IAAO,EACjB,OAFUD,IAAO,IAEHE,IAAO,KAAOC,EAAMC,GAAOD,EAAMC,KAASD,EAAMC,IAAQ,MAAQ,IAAM,KCLxF9/B,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCw/B,MAAO,SAAeC,EAAGtxB,GACvB,IAAIuxB,EAAS,MACTC,GAAMF,EACNG,GAAMzxB,EACN0xB,EAAKF,EAAKD,EACVI,EAAKF,EAAKF,EACVK,EAAKJ,GAAM,GACXK,EAAKJ,GAAM,GACXK,GAAKF,EAAKD,IAAO,IAAMD,EAAKC,IAAO,IACvC,OAAOC,EAAKC,GAAMC,GAAK,MAAQJ,EAAKG,IAAO,IAAMC,EAAIP,IAAW,OCVpEjgC,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCkgC,MAAO,SAAehB,EAAIC,EAAIC,EAAIC,GAChC,IAAIC,EAAMJ,IAAO,EAEbK,EAAMH,IAAO,EACjB,OAFUD,IAAO,IAEHE,IAAO,MAAQC,EAAMC,IAAQD,EAAMC,GAAOD,EAAMC,IAAQ,KAAO,IAAM,KCNvF9/B,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCmgC,YAAa,IAAMpyC,KAAKuvC,KCH1B,IAAI8C,GAAcryC,KAAKuvC,GAAK,IAI5B79B,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChCy9B,QAAS,SAAiBD,GACxB,OAAOA,EAAU4C,MCHrB3gC,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChC29B,MAAOD,eCJL2C,GAAiBrwC,EAAAm/B,SAKrBmR,GAAiBrR,OAAOE,UAAY,SAAkBp/B,GACpD,MAAoB,iBAANA,GAAkBswC,GAAetwC,ICDjD,IAGIwwC,GAAmBxlC,GAAAJ,IACnB6lC,GAAmBzlC,GAAAE,UAHOwlC,2BAI1BC,GAAY1wC,EAAAgD,UAEZ2tC,GAAyB54B,IAA0B,SAA+B64B,GACpFL,GAAiBnwC,KAAM,CACrBzB,KAR0B8xC,0BAS1BG,KAAMA,EAAO,eAVG,iBAYF,WAChB,IAAIvmC,EAAQmmC,GAAiBpwC,MAE7B,MAAO,CAAEvD,OAAe,YADbwN,EAAMumC,MAAqB,WAAbvmC,EAAMumC,KAAoB,OAAS,aACtB,WAAYn2B,MAAM,MAM1DhL,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,EAAME,QAAQ,GAAQ,CAC9C2gC,WAAY,SAAoB9wC,GAC9B,IAAI6wC,EAAO7nC,GAAShJ,GAAI6wC,KACxB,IAAKN,GAAeM,GAAO,MAAMF,GAtBf,8EAuBlB,OAAO,IAAIC,GAAuBC,MC5BtCnhC,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChC8gC,QAAS,SAAiBryB,GACxB,OAAQA,GAAKA,IAAMA,GAAU,GAALA,EAAS,EAAIA,IAAMU,EAAAA,EAAWV,EAAI,KCD9DhP,EAAE,CAAEjB,OAAQ,OAAQwB,MAAM,GAAQ,CAChC+gC,MAAO,SAAetB,EAAGtxB,GACvB,IAAIuxB,EAAS,MACTC,GAAMF,EACNG,GAAMzxB,EACN0xB,EAAKF,EAAKD,EACVI,EAAKF,EAAKF,EACVK,EAAKJ,IAAO,GACZK,EAAKJ,IAAO,GACZK,GAAKF,EAAKD,IAAO,IAAMD,EAAKC,IAAO,IACvC,OAAOC,EAAKC,GAAMC,IAAM,MAAQJ,EAAKG,IAAO,IAAMC,EAAIP,KAAY,oBCXlEza,GAAAC,KAGA8b,GAAYhxC,EAAAixC,SACZC,GAASlxC,EAAA6E,OACTssC,GAAWD,IAAUA,GAAOjsC,SAC5BmsC,GAAG,YACHC,GAAO/uC,EAAY8uC,GAAI5wC,MACvB8wC,GAA2C,IAAlCN,GAAUO,oDAAiE,KAApCP,GAAUO,sDAExDJ,KAAa5wC,GAAM,WAAcywC,GAAU90C,OAAOi1C,QAIxDK,GAAiBF,GAAS,SAAkBniC,EAAQsiC,GAClD,IAAIluB,EAACmuB,GAAQ7gC,GAAS1B,IACtB,OAAO6hC,GAAUztB,EAAIkuB,IAAU,IAAOJ,GAAKD,GAAK7tB,GAAK,GAAK,MACxDytB,GCdJ,IAEIW,GAAa3xC,EAAAu5B,WACbqY,GAAc5xC,EAAA6xC,YACdC,GAAY9xC,EAAAgD,UACZ+uC,GAAK,aACLC,GAAS1vC,EAAY,GAAG+b,QACxB4zB,GAAO3vC,EAAYyvC,GAAMvxC,MACzB0xC,GAAiB5vC,EAAY,GAAIE,UACjC2vC,GAAc7vC,EAAY,GAAGrE,OAIjCwR,EAAE,CAAEjB,OAAQ,SAAUwB,MAAM,GAAQ,CAClCoiC,WAAY,SAAoBjjC,EAAQsiC,GACtC,IACIte,EAAGkf,EADHvX,EAAO,EAEX,GAAqB,iBAAV3rB,EAAoB,MAAM2iC,GAjBL,iCAkBhC,IAAK3iC,EAAO/S,OAAQ,MAAMw1C,GAlBM,iCAmBhC,GAAyB,KAArBI,GAAO7iC,EAAQ,KACjB2rB,GAAO,IACP3rB,EAASgjC,GAAYhjC,EAAQ,IACjB/S,QAAQ,MAAMw1C,GAtBI,iCAyBhC,IADAze,OAAcjwB,IAAVuuC,EAAsB,GAAKhlC,GAAoBglC,IAC3C,GAAKte,EAAI,GAAI,MAAMwe,GAxBX,iBAyBhB,IAAKM,GAAKF,GAAO5iC,IAAW+iC,GAAeG,EAAUb,GAASriC,EAAQgkB,GAAIA,KAAOhkB,EAC/E,MAAMyiC,GA3BwB,iCA6BhC,OAAO9W,EAAOuX,YCvBd5pC,GAUA6pC,GAAe3qC,GAAgB,cAI/B4qC,GAAYxnC,GAAAE,UACZunC,GAAmBznC,GAAAJ,IACnB8nC,GAA6BF,GALhB,cAMbG,GAA+BH,GALhB,gBAMfI,GAAuCJ,GALf,wBAMxBK,GAAQ5yC,EAAAgS,MAER6gC,GAAoB,SAAUC,GAChC1yC,KAAK0yC,SAAW/pC,GAAS+pC,GACzB1yC,KAAKhC,aAAU8E,EACf9C,KAAK2yC,0BAAuB7vC,GAG9B2vC,GAAkB3xC,UAAY,CAC5BvC,KAhBiB,eAiBjBq0C,MAAO,WACL,IAAI50C,EAAUgC,KAAKhC,QACnB,GAAIA,EAAS,CACXgC,KAAKhC,aAAU8E,EACf,IACE9E,IACA,MAAOqC,GACPgoB,GAAiBhoB,MAIvB+U,MAAO,WACL,IAAKlV,EAAa,CAChB,IAAI2yC,EAAe7yC,KAAKyK,OACpBkoC,EAAuB3yC,KAAK2yC,qBAChCE,EAAaC,QAAS,EAClBH,IAAsBA,EAAqBG,QAAS,GACxD9yC,KAAK0yC,cAAW5vC,GAEpBiwC,SAAU,WACR,YAAyBjwC,IAAlB9C,KAAK0yC,WAIhB,IAAIM,GAAe,SAAUN,EAAUO,GACrC,IACI5gC,EADA6gC,EAAoBd,GAAiBpyC,KAAM,IAAIyyC,GAAkBC,IAEhExyC,IAAaF,KAAK8yC,QAAS,GAChC,KACMzgC,EAAQhN,EAAUqtC,EAAU,WAAU1xC,EAAKqR,EAAOqgC,EAAU1yC,MAChE,MAAOK,GACPgoB,GAAiBhoB,GAEnB,IAAI6yC,EAAkBH,WAAtB,CACA,IAAIJ,EAAuBO,EAAkBP,qBAAuB,IAAIQ,GAAqBD,GAC7F,IACE,IAAIl1C,EAAUi1C,EAAWN,GACrBE,EAAe70C,EACJ,MAAXA,IAAiBk1C,EAAkBl1C,QAAUgF,EAAWhF,EAAQo1C,aAChE,WAAcP,EAAaO,eAC3BhuC,GAAUpH,IACd,MAAOq1C,GAEP,YADAV,EAAqBtyC,MAAMgzC,GAEvBH,EAAkBH,YAAYG,EAAkBN,UAGxDI,GAAalyC,UAAY+gB,GAAY,GAAI,CACvCuxB,YAAa,WACX,IAAIF,EAAoBZ,GAA6BtyC,MAChDkzC,EAAkBH,aACrBG,EAAkB99B,QAClB89B,EAAkBN,YAKpB1yC,GAAWozC,GAAiBN,GAAalyC,UAAW,SAAU,CAChEa,cAAc,EACdpB,IAAK,WACH,OAAO+xC,GAA6BtyC,MAAM+yC,cAI9C,IAAII,GAAuB,SAAUD,GACnCd,GAAiBpyC,KAAM,CACrBzB,KAlFwB,uBAmFxB20C,kBAAmBA,IAEhBhzC,IAAaF,KAAK8yC,QAAS,IAGlCK,GAAqBryC,UAAY+gB,GAAY,GAAI,CAC/ChK,KAAM,SAAcpb,GAClB,IAAIy2C,EAAoBX,GAAqCvyC,MAAMkzC,kBACnE,IAAKA,EAAkBH,WAAY,CACjC,IAAIL,EAAWQ,EAAkBR,SACjC,IACE,IAAIa,EAAaluC,EAAUqtC,EAAU,QACjCa,GAAYvyC,EAAKuyC,EAAYb,EAAUj2C,GAC3C,MAAO4D,GACPgoB,GAAiBhoB,MAIvBA,MAAO,SAAe5D,GACpB,IAAIy2C,EAAoBX,GAAqCvyC,MAAMkzC,kBACnE,IAAKA,EAAkBH,WAAY,CACjC,IAAIL,EAAWQ,EAAkBR,SACjCQ,EAAkB99B,QAClB,IACE,IAAIo+B,EAAcnuC,EAAUqtC,EAAU,SAClCc,EAAaxyC,EAAKwyC,EAAad,EAAUj2C,GACxC4rB,GAAiB5rB,GACtB,MAAOC,GACP2rB,GAAiB3rB,GACjBw2C,EAAkBN,UAGxBa,SAAU,WACR,IAAIP,EAAoBX,GAAqCvyC,MAAMkzC,kBACnE,IAAKA,EAAkBH,WAAY,CACjC,IAAIL,EAAWQ,EAAkBR,SACjCQ,EAAkB99B,QAClB,IACE,IAAIs+B,EAAiBruC,EAAUqtC,EAAU,YACrCgB,GAAgB1yC,EAAK0yC,EAAgBhB,GACzC,MAAOryC,GACPgoB,GAAiBhoB,GACjB6yC,EAAkBN,YAKtB1yC,GAAWozC,GAAiBH,GAAqBryC,UAAW,SAAU,CACxEa,cAAc,EACdpB,IAAK,WACH,OAAOgyC,GAAqCvyC,MAAMkzC,kBAAkBH,cAIxE,IAAIY,GAAc,SAAoBV,GACpC9wB,GAAWniB,KAAM4zC,IACjBxB,GAAiBpyC,KAAM,CACrBzB,KA9Ia,aA+Ib00C,WAAY7tC,GAAU6tC,MAItBW,GAAsBD,GAAY7yC,UAEtC+gB,GAAY+xB,GAAqB,CAC/BC,UAAW,SAAmBnB,GAC5B,IAAI12C,EAASoD,UAAUpD,OACvB,OAAO,IAAIg3C,GAAahwC,EAAW0vC,GAAY,CAC7C76B,KAAM66B,EACNryC,MAAOrE,EAAS,EAAIoD,UAAU,QAAK0D,EACnC2wC,SAAUz3C,EAAS,EAAIoD,UAAU,QAAK0D,GACpCI,EAASwvC,GAAYA,EAAW,GAAIL,GAA2BryC,MAAMizC,eAI7EpxB,GAAY8xB,GAAa,CACvBjxB,KAAM,SAAcrE,GAClB,IAAIxK,EAAIN,GAAcvT,MAAQA,KAAO2zC,GACjCG,EAAmBzuC,EAAUsD,GAAS0V,GAAI6zB,IAC9C,GAAI4B,EAAkB,CACpB,IAAIC,EAAaprC,GAAS3H,EAAK8yC,EAAkBz1B,IACjD,OAAO01B,EAAWjjC,cAAgB+C,EAAIkgC,EAAa,IAAIlgC,GAAE,SAAU6+B,GACjE,OAAOqB,EAAWF,UAAUnB,MAGhC,IAAI7tC,EAAWqb,GAAY7B,GAC3B,OAAO,IAAIxK,GAAE,SAAU6+B,GACrB9xB,GAAQ/b,GAAU,SAAUlF,EAAIyhB,GAE9B,GADAsxB,EAAS76B,KAAKlY,GACV+yC,EAASI,OAAQ,OAAO1xB,MAC3B,CAAEF,aAAa,EAAMC,aAAa,IACrCuxB,EAASe,eAGbtH,GAAI,eACF,IAAIt4B,EAAIN,GAAcvT,MAAQA,KAAO2zC,GACjC33C,EAASoD,UAAUpD,OACnBmiB,EAAQq0B,GAAMx2C,GACd4Q,EAAQ,EACLA,EAAQ5Q,GAAQmiB,EAAMvR,GAASxN,UAAUwN,KAChD,OAAO,IAAIiH,GAAE,SAAU6+B,GACrB,IAAK,IAAI32C,EAAI,EAAGA,EAAIC,EAAQD,IAE1B,GADA22C,EAAS76B,KAAKsG,EAAMpiB,IAChB22C,EAASI,OAAQ,OACrBJ,EAASe,iBAKjBhoC,GAASmoC,GAAqB1B,IAAc,WAAc,OAAOlyC,QAEjEqP,EAAE,CAAEK,QAAQ,GAAQ,CAClBskC,WAAYL,KAGd5xB,GAxMiB,cCdjB1S,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCqkC,WAAY,SAAoBpzB,GAC9B,IAAIhN,EAAI7T,KACJysB,EAAa3E,GAA6BjU,GAC1C1W,EAAUsvB,EAAWtvB,QACrBK,EAASivB,EAAWjvB,OACpBqK,EAAS0gB,IAAQ,WACnB,IAAI2rB,EAAiB9uC,GAAUyO,EAAE1W,SAC7B4c,EAAS,GACT4S,EAAU,EACVC,EAAY,EAChBhM,GAAQC,GAAU,SAAUmH,GAC1B,IAAIpb,EAAQ+f,IACRE,GAAgB,EACpBD,IACA5rB,EAAKkzC,EAAgBrgC,EAAGmU,GAAS5qB,MAAK,SAAUX,GAC1CowB,IACJA,GAAgB,EAChB9S,EAAOnN,GAAS,CAAEunC,OAAQ,YAAa13C,MAAOA,KAC5CmwB,GAAazvB,EAAQ4c,OACtB,SAAU1Z,GACPwsB,IACJA,GAAgB,EAChB9S,EAAOnN,GAAS,CAAEunC,OAAQ,WAAYzoB,OAAQrrB,KAC5CusB,GAAazvB,EAAQ4c,YAGzB6S,GAAazvB,EAAQ4c,MAGzB,OADIlS,EAAOxH,OAAO7C,EAAOqK,EAAOpL,OACzBgwB,EAAWzE,WC3BtB3Y,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCwkC,IAAK,SAAavzB,GAChB,IAAIhN,EAAI7T,KACJ4kC,EAAiBxhC,EAAW,kBAC5BqpB,EAAa3E,GAA6BjU,GAC1C1W,EAAUsvB,EAAWtvB,QACrBK,EAASivB,EAAWjvB,OACpBqK,EAAS0gB,IAAQ,WACnB,IAAI2rB,EAAiB9uC,GAAUyO,EAAE1W,SAC7BonC,EAAS,GACT5X,EAAU,EACVC,EAAY,EACZynB,GAAkB,EACtBzzB,GAAQC,GAAU,SAAUmH,GAC1B,IAAIpb,EAAQ+f,IACR2nB,GAAkB,EACtB1nB,IACA5rB,EAAKkzC,EAAgBrgC,EAAGmU,GAAS5qB,MAAK,SAAUX,GAC1C63C,GAAmBD,IACvBA,GAAkB,EAClBl3C,EAAQV,OACP,SAAU4D,GACPi0C,GAAmBD,IACvBC,GAAkB,EAClB/P,EAAO33B,GAASvM,IACdusB,GAAapvB,EAAO,IAAIonC,EAAeL,EA7B3B,qCAgChB3X,GAAapvB,EAAO,IAAIonC,EAAeL,EAhCvB,+BAmCpB,OADI18B,EAAOxH,OAAO7C,EAAOqK,EAAOpL,OACzBgwB,EAAWzE,WCrCtB3Y,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnC2kC,IAAO,SAAUngC,GACf,IAAIgU,EAAoBN,GAA6B9nB,MACjD6H,EAAS0gB,GAAQnU,GAErB,OADCvM,EAAOxH,MAAQ+nB,EAAkB5qB,OAAS4qB,EAAkBjrB,SAAS0K,EAAOpL,OACtE2rB,EAAkBJ,kBCLzBwsB,GAAMpxC,EAAW,OACjBqxC,GAAUrxC,EAAW,WACrBsxC,GAAOxyC,EAAY,GAAGkE,MAEtBuuC,GAAWxuC,GAAO,YAClByuC,GAAQD,GAAS/X,QAAU+X,GAAS/X,MAAQ,IAAI6X,IAEhDI,GAAyB,SAAUzmC,EAAQ0mC,EAAW3+B,GACxD,IAAI4+B,EAAiBH,GAAMr0C,IAAI6N,GAC/B,IAAK2mC,EAAgB,CACnB,IAAK5+B,EAAQ,OACby+B,GAAMrqC,IAAI6D,EAAQ2mC,EAAiB,IAAIP,IAEzC,IAAIQ,EAAcD,EAAex0C,IAAIu0C,GACrC,IAAKE,EAAa,CAChB,IAAK7+B,EAAQ,OACb4+B,EAAexqC,IAAIuqC,EAAWE,EAAc,IAAIR,IAChD,OAAOQ,GCpBPC,IDgDJC,GAAiB,CACftY,MAAOgY,GACPO,OAAQN,GACRxqC,IA5B2B,SAAU+qC,EAAa7sC,EAAGjD,GACrD,IAAI+vC,EAAcR,GAAuBtsC,EAAGjD,GAAG,GAC/C,YAAuBxC,IAAhBuyC,GAAoCA,EAAYhrC,IAAI+qC,IA2B3D70C,IAxB2B,SAAU60C,EAAa7sC,EAAGjD,GACrD,IAAI+vC,EAAcR,GAAuBtsC,EAAGjD,GAAG,GAC/C,YAAuBxC,IAAhBuyC,OAA4BvyC,EAAYuyC,EAAY90C,IAAI60C,IAuB/D7qC,IApB8B,SAAU6qC,EAAaE,EAAe/sC,EAAGjD,GACvEuvC,GAAuBtsC,EAAGjD,GAAG,GAAMiF,IAAI6qC,EAAaE,IAoBpDz5C,KAjB4B,SAAUuS,EAAQ0mC,GAC9C,IAAIO,EAAcR,GAAuBzmC,EAAQ0mC,GAAW,GACxDj5C,EAAO,GAEX,OADIw5C,GAAaA,EAAYhV,SAAQ,SAAU5M,EAAGztB,GAAO0uC,GAAK74C,EAAMmK,MAC7DnK,GAcP05C,MAXkB,SAAU51C,GAC5B,YAAcmD,IAAPnD,GAAiC,iBAANA,EAAiBA,EAAK+E,OAAO/E,MC7C7C41C,MAChBC,GAA4BN,GAAA3qC,IAIhC8E,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnC6lC,eAAgB,SAAwBC,EAAaC,EAAevnC,GAClE,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAYmyC,GAAc71C,UAAU,IAC3Eo2C,GAA0BE,EAAaC,EAAehtC,GAASyF,GAAS0mC,MCR5E,IAAIc,GAAgBV,GAAAK,MAChBM,GAAyBX,GAAAC,OACzBW,GAAQZ,GAAAtY,MAIZvtB,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCmmC,eAAgB,SAAwBL,EAAatnC,GACnD,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAY8yC,GAAcx2C,UAAU,IACvEi2C,EAAcQ,GAAuBltC,GAASyF,GAAS0mC,GAAW,GACtE,QAAoBhyC,IAAhBuyC,IAA8BA,EAAoB,OAAEK,GAAc,OAAO,EAC7E,GAAIL,EAAY7jB,KAAM,OAAO,EAC7B,IAAIujB,EAAiBe,GAAMv1C,IAAI6N,GAE/B,OADA2mC,EAAuB,OAAED,KAChBC,EAAevjB,MAAQskB,GAAc,OAAE1nC,MCbpD,IAAI4nC,GAAyBd,GAAA7qC,IACzB4rC,GAAyBf,GAAA30C,IACzB21C,GAAgBhB,GAAAK,MAEhBY,GAAsB,SAAUf,EAAa7sC,EAAGjD,GAElD,GADa0wC,GAAuBZ,EAAa7sC,EAAGjD,GACxC,OAAO2wC,GAAuBb,EAAa7sC,EAAGjD,GAC1D,IAAI+hB,EAASxQ,GAAetO,GAC5B,OAAkB,OAAX8e,EAAkB8uB,GAAoBf,EAAa/tB,EAAQ/hB,QAAKxC,GAKzEuM,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCwmC,YAAa,SAAqBV,EAAatnC,GAC7C,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAYozC,GAAc92C,UAAU,IAC3E,OAAO+2C,GAAoBT,EAAa/sC,GAASyF,GAAS0mC,UCb1DuB,GAAMjzC,EAAW,OACjBkzC,GAAeD,GAAIv1C,UACnBy1C,GAAar0C,EAAYo0C,GAAajW,SACtCmW,GAASt0C,EAAYo0C,GAAajsC,KAClCosC,GAASv0C,EAAYo0C,GAAa/rC,KAClCmsC,GAAOx0C,EAAY,GAAGkE,MCNtBuwC,GAAgBz0C,GDUH,SAAkB00C,GACjC,IAOIhqC,EAAO+b,EAAM3iB,EAPbgM,EAAOtL,GAAS1G,MAChBhE,EAASgR,GAAkBgF,GAC3BnK,EAASiM,GAAmB9B,EAAM,GAClCsuB,EAAM,IAAI+V,GACVQ,EAA+B,MAAZD,EAAmBxxC,GAAUwxC,GAAY,SAAUn6C,GACxE,OAAOA,GAGT,IAAKmQ,EAAQ,EAAGA,EAAQ5Q,EAAQ4Q,IAE9B5G,EAAM6wC,EADNluB,EAAO3W,EAAKpF,IAEP4pC,GAAOlW,EAAKt6B,IAAMywC,GAAOnW,EAAKt6B,EAAK2iB,GAK1C,OAHA4tB,GAAWjW,GAAK,SAAU7jC,GACxBi6C,GAAK7uC,EAAQpL,MAERoL,KC1BLivC,GAAS50C,EAAY,GAAGxE,QACxBq5C,GAA0B7B,GAAAr5C,KAC1Bm7C,GAAgB9B,GAAAK,MAEhB0B,GAAuB,SAAU1uC,EAAGjD,GACtC,IAAI4xC,EAAQH,GAAwBxuC,EAAGjD,GACnC+hB,EAASxQ,GAAetO,GAC5B,GAAe,OAAX8e,EAAiB,OAAO6vB,EAC5B,IAAIC,EAAQF,GAAqB5vB,EAAQ/hB,GACzC,OAAO6xC,EAAMn7C,OAASk7C,EAAMl7C,OAAS26C,GAAcG,GAAOI,EAAOC,IAAUA,EAAQD,GAKrF7nC,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCwnC,gBAAiB,SAAyBhpC,GACxC,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAYk0C,GAAc53C,UAAU,IAC3E,OAAO63C,GAAqBtuC,GAASyF,GAAS0mC,MCrBlD,IAAIuC,GAAyBnC,GAAA30C,IACzB+2C,GAAgBpC,GAAAK,MAIpBlmC,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnC2nC,eAAgB,SAAwB7B,EAAatnC,GACnD,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAYw0C,GAAcl4C,UAAU,IAC3E,OAAOi4C,GAAuB3B,EAAa/sC,GAASyF,GAAS0mC,MCRjE,IAAI0C,GAA0BtC,GAAAr5C,KAC1B47C,GAAgBvC,GAAAK,MAIpBlmC,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnC8nC,mBAAoB,SAA4BtpC,GAC9C,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAY20C,GAAcr4C,UAAU,IAC3E,OAAOo4C,GAAwB7uC,GAASyF,GAAS0mC,MCPrD,IAAI6C,GAAyBzC,GAAA7qC,IACzButC,GAAgB1C,GAAAK,MAEhBsC,GAAsB,SAAUzC,EAAa7sC,EAAGjD,GAElD,GADaqyC,GAAuBvC,EAAa7sC,EAAGjD,GACxC,OAAO,EACnB,IAAI+hB,EAASxQ,GAAetO,GAC5B,OAAkB,OAAX8e,GAAkBwwB,GAAoBzC,EAAa/tB,EAAQ/hB,IAKpE+J,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCkoC,YAAa,SAAqBpC,EAAatnC,GAC7C,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAY80C,GAAcx4C,UAAU,IAC3E,OAAOy4C,GAAoBnC,EAAa/sC,GAASyF,GAAS0mC,MChB9D,IAAIiD,GAAyB7C,GAAA7qC,IACzB2tC,GAAgB9C,GAAAK,MAIpBlmC,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCqoC,eAAgB,SAAwBvC,EAAatnC,GACnD,IAAI0mC,EAAY11C,UAAUpD,OAAS,OAAI8G,EAAYk1C,GAAc54C,UAAU,IAC3E,OAAO24C,GAAuBrC,EAAa/sC,GAASyF,GAAS0mC,MCRjE,IAAIoD,GAAgBhD,GAAAK,MAChB4C,GAA4BjD,GAAA3qC,IAIhC8E,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCpF,SAAU,SAAkBkrC,EAAaC,GACvC,OAAO,SAAmBvnC,EAAQpI,GAChCmyC,GAA0BzC,EAAaC,EAAehtC,GAASyF,GAAS8pC,GAAclyC,eCL5FqJ,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OxDP3B,OwDO8C,CAC7DsoC,OCFFC,GAAiB,WAGf,IAFA,IAAI9tC,EAAM5B,GAAS3I,MACfs4C,EAAQlzC,GAAUmF,EAAIme,KACjB3M,EAAI,EAAG8oB,EAAMzlC,UAAUpD,OAAQ+f,EAAI8oB,EAAK9oB,IAC/C/a,EAAKs3C,EAAO/tC,EAAKnL,UAAU2c,IAE7B,OAAOxR,KCLT8E,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,O1DP3B,O0DO8C,CAC7D66B,UAAWC,KCIbv7B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,O3DZ3B,O2DY8C,CAC7DyoC,WAAY,SAAoB13B,GAC9B,IAAItW,EAAM5B,GAAS3I,MACfw4C,EAAS,IAAKv1B,GAAmB1Y,EAAKnH,EAAW,QAAxC,CAAiDmH,GAC1DwgC,EAAU3lC,GAAUozC,EAAe,QAIvC,OAHA53B,GAAQC,GAAU,SAAUpkB,GAC1BuE,EAAK+pC,EAASyN,EAAQ/7C,MAEjB+7C,YClBXC,GAAiB,SAAU94C,GAEzB,OAAOqB,EAAK03C,IAAI53C,UAAUiZ,OAAQpa,ICMpC0P,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,O7DV3B,O6DU8C,CAC7D2wB,MAAO,SAAersB,GACpB,IAAI7J,EAAM5B,GAAS3I,MACf6E,EAAW4zC,GAAeluC,GAC1B41B,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAQ8d,GAAQ/b,GAAU,SAAUpI,EAAO2kB,GACzC,IAAK+e,EAAc1jC,EAAOA,EAAO8N,GAAM,OAAO6W,MAC7C,CAAEF,aAAa,EAAMC,aAAa,IAAQT,WCHjDrR,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,O9Dd3B,O8Dc8C,CAC7DywB,OAAQ,SAAgBnsB,GACtB,IAAI7J,EAAM5B,GAAS3I,MACf6E,EAAW4zC,GAAeluC,GAC1B41B,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GACvE01C,EAAS,IAAKv1B,GAAmB1Y,EAAKnH,EAAW,SACjDk1C,EAAQlzC,GAAUozC,EAAO9vB,KAI7B,OAHA9H,GAAQ/b,GAAU,SAAUpI,GACtB0jC,EAAc1jC,EAAOA,EAAO8N,IAAMvJ,EAAKs3C,EAAOE,EAAQ/7C,KACzD,CAAEykB,aAAa,IACXs3B,KCdXnpC,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,O/DV3B,O+DU8C,CAC7D4wB,KAAM,SAActsB,GAClB,IAAI7J,EAAM5B,GAAS3I,MACf6E,EAAW4zC,GAAeluC,GAC1B41B,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAO8d,GAAQ/b,GAAU,SAAUpI,EAAO2kB,GACxC,GAAI+e,EAAc1jC,EAAOA,EAAO8N,GAAM,OAAO6W,EAAK3kB,KACjD,CAAEykB,aAAa,EAAMC,aAAa,IAAQtZ,UCZjDwH,EAAE,CAAEjB,OAAQ,MAAOwB,MAAM,GAAQ,CAC/B8S,KAAM4oB,KCMRj8B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OjEZ3B,OiEY8C,CAC7D6oC,aAAc,SAAsB93B,GAClC,IAAItW,EAAM5B,GAAS3I,MACfw4C,EAAS,IAAKv1B,GAAmB1Y,EAAKnH,EAAW,SACjDw1C,EAAWxzC,GAAUmF,EAAIF,KACzBiuC,EAAQlzC,GAAUozC,EAAO9vB,KAI7B,OAHA9H,GAAQC,GAAU,SAAUpkB,GACtBuE,EAAK43C,EAAUruC,EAAK9N,IAAQuE,EAAKs3C,EAAOE,EAAQ/7C,MAE/C+7C,KCXXnpC,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OlEV3B,OkEU8C,CAC7D+oC,eAAgB,SAAwBh4B,GACtC,IAAItW,EAAM5B,GAAS3I,MACf44C,EAAWxzC,GAAUmF,EAAIF,KAC7B,OAAQuW,GAAQC,GAAU,SAAUpkB,EAAO2kB,GACzC,IAAmC,IAA/BpgB,EAAK43C,EAAUruC,EAAK9N,GAAiB,OAAO2kB,MAC/C,CAAED,aAAa,IAAQT,WCH9BrR,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OnEb3B,OmEa8C,CAC7DgpC,WAAY,SAAoBj4B,GAC9B,IAAIhc,EAAWqb,GAAYlgB,MACvB+4C,EAAWpwC,GAASkY,GACpB+3B,EAAWG,EAAS1uC,IAKxB,OAJKrH,EAAW41C,KACdG,EAAW,IAAK31C,EAAW,OAAhB,CAAwByd,GACnC+3B,EAAWxzC,GAAU2zC,EAAS1uC,OAExBuW,GAAQ/b,GAAU,SAAUpI,EAAO2kB,GACzC,IAAwC,IAApCpgB,EAAK43C,EAAUG,EAAUt8C,GAAkB,OAAO2kB,MACrD,CAAEF,aAAa,EAAMC,aAAa,IAAQT,WCdjDrR,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OpEV3B,OoEU8C,CAC7DkpC,aAAc,SAAsBn4B,GAClC,IAAItW,EAAM5B,GAAS3I,MACf44C,EAAWxzC,GAAUmF,EAAIF,KAC7B,OAAQuW,GAAQC,GAAU,SAAUpkB,EAAO2kB,GACzC,IAAmC,IAA/BpgB,EAAK43C,EAAUruC,EAAK9N,GAAkB,OAAO2kB,MAChD,CAAED,aAAa,IAAQT,WCP9B,IAAIu4B,GAAY/2C,EAAY,GAAG6J,MAC3BmtC,GAAO,GAAG9yC,KAIdiJ,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OrEd3B,OqEc8C,CAC7D/D,KAAM,SAAcotC,GAClB,IAAI5uC,EAAM5B,GAAS3I,MACf6E,EAAW4zC,GAAeluC,GAC1B6uC,OAAoBt2C,IAAdq2C,EAA0B,IAAM1oC,GAAS0oC,GAC/CtxC,EAAS,GAEb,OADA+Y,GAAQ/b,EAAUq0C,GAAM,CAAElnC,KAAMnK,EAAQqZ,aAAa,IAC9C+3B,GAAUpxC,EAAQuxC,MCP7B/pC,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OtEd3B,OsEc8C,CAC7DwwB,IAAK,SAAalsB,GAChB,IAAI7J,EAAM5B,GAAS3I,MACf6E,EAAW4zC,GAAeluC,GAC1B41B,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GACvE01C,EAAS,IAAKv1B,GAAmB1Y,EAAKnH,EAAW,SACjDk1C,EAAQlzC,GAAUozC,EAAO9vB,KAI7B,OAHA9H,GAAQ/b,GAAU,SAAUpI,GAC1BuE,EAAKs3C,EAAOE,EAAQrY,EAAc1jC,EAAOA,EAAO8N,MAC/C,CAAE2W,aAAa,IACXs3B,KCnBXnpC,EAAE,CAAEjB,OAAQ,MAAOwB,MAAM,GAAQ,CAC/Bu8B,GAAIC,KCGN,IAAIiN,GAAYz5C,EAAAgD,UAIhByM,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OxEb3B,OwEa8C,CAC7DsL,OAAQ,SAAgBhH,GACtB,IAAI7J,EAAM5B,GAAS3I,MACf6E,EAAW4zC,GAAeluC,GAC1B+hC,EAAYltC,UAAUpD,OAAS,EAC/BuwC,EAAcD,OAAYxpC,EAAY1D,UAAU,GAUpD,GATAgG,GAAUgP,GACVwM,GAAQ/b,GAAU,SAAUpI,GACtB6vC,GACFA,GAAY,EACZC,EAAc9vC,GAEd8vC,EAAcn4B,EAAWm4B,EAAa9vC,EAAOA,EAAO8N,KAErD,CAAE2W,aAAa,IACdorB,EAAW,MAAM+M,GAAU,6CAC/B,OAAO9M,KCnBXl9B,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,OzEV3B,OyEU8C,CAC7D0wB,KAAM,SAAcpsB,GAClB,IAAI7J,EAAM5B,GAAS3I,MACf6E,EAAW4zC,GAAeluC,GAC1B41B,EAAgBpuB,GAAKqC,EAAYhV,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GAC3E,OAAO8d,GAAQ/b,GAAU,SAAUpI,EAAO2kB,GACxC,GAAI+e,EAAc1jC,EAAOA,EAAO8N,GAAM,OAAO6W,MAC5C,CAAEF,aAAa,EAAMC,aAAa,IAAQT,WCLjDrR,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,O1EZ3B,O0EY8C,CAC7DwpC,oBAAqB,SAA6Bz4B,GAChD,IAAItW,EAAM5B,GAAS3I,MACfw4C,EAAS,IAAKv1B,GAAmB1Y,EAAKnH,EAAW,QAAxC,CAAiDmH,GAC1DwgC,EAAU3lC,GAAUozC,EAAe,QACnCF,EAAQlzC,GAAUozC,EAAO9vB,KAI7B,OAHA9H,GAAQC,GAAU,SAAUpkB,GAC1BuE,EAAK+pC,EAASyN,EAAQ/7C,IAAUuE,EAAKs3C,EAAOE,EAAQ/7C,MAE/C+7C,KCVXnpC,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMiZ,MAAM,EAAMld,O3EX3B,O2EW8C,CAC7DypC,MAAO,SAAe14B,GACpB,IAAItW,EAAM5B,GAAS3I,MACfw4C,EAAS,IAAKv1B,GAAmB1Y,EAAKnH,EAAW,QAAxC,CAAiDmH,GAE9D,OADAqW,GAAQC,EAAUzb,GAAUozC,EAAO9vB,KAAM,CAAE1W,KAAMwmC,IAC1CA,YCdP/mB,GAAAxT,OAMAu7B,GAASr5C,GAAM,WACjB,MAAmB,OAAZ,KAAGs5C,IAAM,MAKfpqC,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMjE,OAAQ0pC,IAAU,CACnDC,GAAI,SAAY7sC,GACd,IAAIuW,EAAI1S,GAAS5N,EAAuB7C,OACpC6kC,EAAM1hB,EAAEnnB,OACR09C,EAAgBrtC,GAAoBO,GACpCmP,EAAI29B,GAAiB,EAAIA,EAAgB7U,EAAM6U,EACnD,OAAQ39B,EAAI,GAAKA,GAAK8oB,OAAO/hC,EAAS62C,GAAUx2B,EAAGpH,MCZ1D,IAAI69B,GAASnoB,GAAAC,OACTmoB,GAASpoB,GAAAxT,OAET67B,GAAmBnvC,GAAAJ,IACnBwvC,GAAmBpvC,GAAAE,UAFD,mBAKlBmvC,GAAkBriC,IAA0B,SAAwB5I,GACtE+qC,GAAiB95C,KAAM,CACrBzB,KAPkB,kBAQlBwQ,OAAQA,EACRnC,MAAO,MAER,UAAU,WACX,IAGIqtC,EAHAhwC,EAAQ8vC,GAAiB/5C,MACzB+O,EAAS9E,EAAM8E,OACfnC,EAAQ3C,EAAM2C,MAElB,OAAIA,GAASmC,EAAO/S,OAAe,CAAES,WAAOqG,EAAWuX,MAAM,IAC7D4/B,EAAQJ,GAAO9qC,EAAQnC,GACvB3C,EAAM2C,OAASqtC,EAAMj+C,OACd,CAAES,MAAO,CAAEy9C,UAAWN,GAAOK,EAAO,GAAI1oB,SAAU3kB,GAASyN,MAAM,OAK1EhL,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,GAAQ,CACnComC,WAAY,WACV,OAAO,IAAIH,GAAgBvpC,GAAS5N,EAAuB7C,kBChC3Do6C,GAAQ7yC,GAAgB,SAI5B8yC,GAAiB,SAAU16C,GACzB,IAAI26C,EACJ,OAAOp3C,EAASvD,UAAmCmD,KAA1Bw3C,EAAW36C,EAAGy6C,OAA0BE,EAA0B,UAAfh4C,EAAQ3C,KCetF,IAAI46C,GAAYhzC,GAAgB,YAG5BizC,GAAmB7vC,GAAAJ,IACnBkwC,GAAmB9vC,GAAAE,UAFM6vC,0BAGzBC,GAAkB/sB,OAAO9sB,UACzB85C,GAAYh7C,EAAAgD,UACZi4C,GAAW34C,EAAYmrB,IACvBytB,GAAgB54C,EAAY,GAAGsL,SAC/ButC,GAAc74C,EAAY,GAAG84C,UAE7BC,KAAgCF,KAAgB56C,GAAM,WACxD46C,GAAY,IAAG,QAGbG,GAAwBvjC,IAA0B,SAA8B8Y,EAAQ1hB,EAAQosC,EAAShnB,GAC3GqmB,GAAiBx6C,KAAM,CACrBzB,KAfyBm8C,yBAgBzBjqB,OAAQA,EACR1hB,OAAQA,EACRW,OAAQyrC,EACR1tB,QAAS0G,EACT9Z,MAAM,MArBU,iBAuBF,WAChB,IAAIpQ,EAAQwwC,GAAiBz6C,MAC7B,GAAIiK,EAAMoQ,KAAM,MAAO,CAAE5d,WAAOqG,EAAWuX,MAAM,GACjD,IAAI0Y,EAAI9oB,EAAMwmB,OACVtN,EAAIlZ,EAAM8E,OACVlS,EAAQi2B,GAAWC,EAAG5P,GAC1B,OAAc,OAAVtmB,EAAuB,CAAEJ,WAAOqG,EAAWuX,KAAMpQ,EAAMoQ,MAAO,GAC9DpQ,EAAMyF,QACmB,KAAvBe,GAAS5T,EAAM,MAAYk2B,EAAEhF,UAAY4D,GAAmBxO,EAAGpW,GAASgmB,EAAEhF,WAAY9jB,EAAMwjB,UACzF,CAAEhxB,MAAOI,EAAOwd,MAAM,KAE/BpQ,EAAMoQ,MAAO,EACN,CAAE5d,MAAOI,EAAOwd,MAAM,OAG3B+gC,GAAY,SAAUrsC,GACxB,IAEI8E,EAAGwnC,EAAY9sB,EAAO+sB,EAASH,EAAShnB,EAFxCpB,EAAIpqB,GAAS3I,MACbmjB,EAAI1S,GAAS1B,GAYjB,OAVA8E,EAAIoP,GAAmB8P,EAAGnF,aAEP9qB,KADnBu4C,EAAatoB,EAAExE,QACiBhrB,EAAco3C,GAAiB5nB,MAAQ,UAAW4nB,MAChFU,EAAaR,GAAS9nB,IAExBxE,OAAuBzrB,IAAfu4C,EAA2B,GAAK5qC,GAAS4qC,GACjDC,EAAU,IAAIznC,EAAEA,IAAM+Z,OAASmF,EAAEvsB,OAASusB,EAAGxE,GAC7C4sB,KAAaL,GAAcvsB,EAAO,KAClC4F,KAAiB2mB,GAAcvsB,EAAO,KACtC+sB,EAAQvtB,UAAYhhB,GAASgmB,EAAEhF,WACxB,IAAImtB,GAAsBI,EAASn4B,EAAGg4B,EAAShnB,IAKxD9kB,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,EAAMjE,OAAQmrC,IAA+B,CACxED,SAAU,SAAkBvqB,GAC1B,IACIlC,EAAOpL,EAAGm4B,EADV/yC,EAAI1F,EAAuB7C,MAE/B,GAAc,MAAVywB,EAAgB,CAClB,GAAI4pB,GAAS5pB,KACXlC,EAAQ9d,GAAS5N,EAAuB,UAAW83C,GAC/ClqB,EAAOlC,MACPssB,GAASpqB,OAEPqqB,GAAcvsB,EAAO,MAAM,MAAMqsB,GAAU,iDAEnD,GAAIK,GAA6B,OAAOF,GAAYxyC,EAAGkoB,GAGvD,GAFA6qB,EAAUj2C,EAAUorB,EAAQ8pB,IAEf,OAAOv5C,EAAKs6C,EAAS7qB,EAAQloB,QACrC,GAAI0yC,GAA6B,OAAOF,GAAYxyC,EAAGkoB,GAG9D,OAFAtN,EAAI1S,GAASlI,GACR,IAAIqlB,OAAO6C,EAAQ,KACqB8pB,IAAWp3B,MAIjDo3B,MAAaI,IAAmBlvC,GAASkvC,GAAiBJ,GAAWa,IC3FhF,IAAIG,GAAUh0C,GAAgB,WAC1Bi0C,GAAkB5tB,OAAO9sB,UACzB26C,GAAY77C,EAAAgD,UACZ84C,GAAWx5C,EAAYmrB,IACvBsuB,GAAUz5C,EAAY,GAAGsL,SAEzBouC,IADU15C,EAAY,GAAG1F,SACX0F,EAAY,GAAGrE,QAC7Bg+C,GAAMl+C,KAAK6O,IAEXsvC,GAAgB,SAAU/sC,EAAQ8kB,EAAavmB,GACjD,OAAIA,EAAYyB,EAAO/S,QAAe,EAClB,KAAhB63B,EAA2BvmB,EACxBquC,GAAQ5sC,EAAQ8kB,EAAavmB,IAKtC+B,EAAE,CAAEjB,OAAQ,SAAU2F,OAAO,GAAQ,CACnCgoC,WAAY,SAAoBloB,EAAaC,GAC3C,IACgBvF,EAAOwF,EAAUhlB,EAAQitC,EAAc9nB,EAAmB+nB,EAAcC,EAAW3pB,EAD/FhqB,EAAI1F,EAAuB7C,MAE3BuxB,EAAW,EACX4qB,EAAiB,EACjBt0C,EAAS,GACb,GAAmB,MAAfgsB,EAAqB,CAEvB,GADawmB,GAASxmB,KAEpBtF,EAAQ9d,GAAS5N,EAAuB,UAAW24C,GAC/C3nB,EAAYtF,MACZmtB,GAAS7nB,OAEP8nB,GAAQptB,EAAO,MAAM,MAAMktB,GAAU,mDAG7C,GADA1nB,EAAW1uB,EAAUwuB,EAAa0nB,IAEhC,OAAOv6C,EAAK+yB,EAAUF,EAAatrB,EAAGurB,OAK1C/kB,EAAS0B,GAASlI,GAClByzC,EAAevrC,GAASojB,IACxBK,EAAoBlxB,EAAW8wB,MACPA,EAAerjB,GAASqjB,IAChDmoB,EAAeD,EAAahgD,OAC5BkgD,EAAYL,GAAI,EAAGI,GACnB1qB,EAAWuqB,GAAc/sC,EAAQitC,EAAc,IAC3B,IAAbzqB,GACLgB,EAAc2B,EACVzjB,GAASqjB,EAAakoB,EAAczqB,EAAUxiB,IAC9CojB,GAAgB6pB,EAAcjtC,EAAQwiB,EAAU,QAAIzuB,EAAWgxB,GACnEjsB,GAAU+zC,GAAY7sC,EAAQotC,EAAgB5qB,GAAYgB,EAC1D4pB,EAAiB5qB,EAAW0qB,EAC5B1qB,EAAWuqB,GAAc/sC,EAAQitC,EAAczqB,EAAW2qB,GAK5D,OAHIC,EAAiBptC,EAAO/S,SAC1B6L,GAAU+zC,GAAY7sC,EAAQotC,IAEzBt0C,KCrEX2J,GAAsB,WCAtBA,GAAsB,cCCtBA,GAAsB,gBCEtBnC,EAAE,CAAEjB,OAAQ,UAAW2F,OAAO,EAAMiZ,MAAM,EAAMld,OpFP/B,OoFOkD,CACjE66B,UAAWC,KCHbv7B,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnC8S,KAAM4oB,KCDRj8B,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCu8B,GAAIC,KCCN/8B,EAAE,CAAEjB,OAAQ,UAAW2F,OAAO,EAAMiZ,MAAM,EAAMld,OvFP/B,OuFOkD,CACjEsoC,OAAQC,KCDVhpC,EAAE,CAAEjB,OAAQ,UAAW2F,OAAO,EAAMiZ,MAAM,EAAMld,OxFP/B,OwFOkD,CACjE66B,UAAWC,KCHbv7B,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnC8S,KAAM4oB,KCDRj8B,EAAE,CAAEjB,OAAQ,UAAWwB,MAAM,GAAQ,CACnCu8B,GAAIC,YCJNgQ,GAAiB,CACfC,YAAa,EACbC,oBAAqB,EACrBC,aAAc,EACdC,eAAgB,EAChBC,YAAa,EACbC,cAAe,EACfC,aAAc,EACdC,qBAAsB,EACtBC,SAAU,EACVC,kBAAmB,EACnBC,eAAgB,EAChBC,gBAAiB,EACjBC,kBAAmB,EACnBC,UAAW,EACXC,cAAe,EACfC,aAAc,EACdC,SAAU,EACVC,iBAAkB,EAClBC,OAAQ,EACRC,YAAa,EACbC,cAAe,EACfC,cAAe,EACfC,eAAgB,EAChBC,aAAc,EACdC,cAAe,EACfC,iBAAkB,EAClBC,iBAAkB,EAClBC,eAAgB,EAChBC,iBAAkB,EAClBC,cAAe,EACfC,UAAW,UC9BTC,GAAYl2C,GAAsB,QAAQm2C,UAC1CC,GAAwBF,IAAaA,GAAUttC,aAAestC,GAAUttC,YAAYhQ,UAExFy9C,GAAiBD,KAA0BxiD,OAAOgF,eAAYgC,EAAYw7C,GCC1E,IAAIE,GAAWj3C,GAAgB,YAC3Bk3C,GAAgBl3C,GAAgB,eAChCm3C,GAAcxkC,GAAqBH,OAEnC4kC,GAAkB,SAAUC,EAAqBC,GACnD,GAAID,EAAqB,CAEvB,GAAIA,EAAoBJ,MAAcE,GAAa,IACjDz1C,GAA4B21C,EAAqBJ,GAAUE,IAC3D,MAAOr+C,GACPu+C,EAAoBJ,IAAYE,GAKlC,GAHKE,EAAoBH,KACvBx1C,GAA4B21C,EAAqBH,GAAeI,GAE9DzC,GAAayC,GAAkB,IAAK,IAAI5jC,KAAef,GAEzD,GAAI0kC,EAAoB3jC,KAAiBf,GAAqBe,GAAc,IAC1EhS,GAA4B21C,EAAqB3jC,EAAaf,GAAqBe,IACnF,MAAO5a,GACPu+C,EAAoB3jC,GAAef,GAAqBe,MAMhE,IAAK,IAAI6jC,MAAmB1C,GAC1BuC,GAAgB/+C,EAAOk/C,KAAoBl/C,EAAOk/C,IAAiBh+C,UAAWg+C,IAGhFH,GAAgBJ,GAAuB,gBCjCvC,IAAIQ,IAAUn/C,EAAAokB,eAAwBpkB,EAAAskB,eAGtC7U,EAAE,CAAEK,QAAQ,EAAMhP,MAAM,EAAMc,YAAY,EAAMsO,OAAQivC,IAAU,CAGhE/6B,aAAc+B,GAAAxb,IAGd2Z,eAAgB6B,GAAAC,QCRlB,IAAIg5B,GAAUp/C,EAAAiE,QAIdwL,EAAE,CAAEK,QAAQ,EAAMlO,YAAY,EAAMqK,aAAa,GAAQ,CACvDozC,eAAgB,SAAwB98C,GACtC,IAAIwT,EAASuF,IAAW8jC,GAAQrpC,OAChCiS,GAAUjS,EAASA,EAAOjV,KAAKyB,GAAMA,aCXrCsvB,GAAAxT,OAMAihC,GAAmBv0C,GAAAJ,IACnB40C,GAAmBx0C,GAAAE,UAFD,mBAMtBkO,GAAerU,OAAQ,UAAU,SAAUyV,GACzC+kC,GAAiBl/C,KAAM,CACrBzB,KARkB,kBASlBwQ,OAAQ0B,GAAS0J,GACjBvN,MAAO,OAIR,WACD,IAGIqtC,EAHAhwC,EAAQk1C,GAAiBn/C,MACzB+O,EAAS9E,EAAM8E,OACfnC,EAAQ3C,EAAM2C,MAElB,OAAIA,GAASmC,EAAO/S,OAAe,CAAES,WAAOqG,EAAWuX,MAAM,IAC7D4/B,EAAKmF,GAAUrwC,EAAQnC,GACvB3C,EAAM2C,OAASqtC,EAAMj+C,OACd,CAAES,MAAOw9C,EAAO5/B,MAAM,cCxB3BglC,GAAW93C,GAAgB,YAE/B+3C,IAAkBn/C,GAAM,WAEtB,IAAI5D,EAAM,IAAIgjD,IAAI,gBAAiB,YAC/BC,EAAejjD,EAAIijD,aACnB33C,EAAS,GAMb,OALAtL,EAAIkjD,SAAW,QACfD,EAAanf,SAAQ,SAAU5jC,EAAOuJ,GACpCw5C,EAAqB,OAAE,KACvB33C,GAAU7B,EAAMvJ,MAGZ+iD,EAAaliC,MACD,2BAAb/gB,EAAImjD,MACsB,MAA1BF,EAAaj/C,IAAI,MACuB,QAAxCmE,OAAO,IAAIi7C,gBAAgB,WAC1BH,EAAaH,KAEsB,MAApC,IAAIE,IAAI,eAAeK,UACsC,MAA7D,IAAID,gBAAgB,IAAIA,gBAAgB,QAAQp/C,IAAI,MAErB,eAA/B,IAAIg/C,IAAI,eAAan6B,MAEK,YAFsB,IAE5Cm6B,IAAA,cAAgBM,MAEd,SAFkCh4C,GAIL,MAFlB,IAAA03C,IAEd,gBAAez8C,GAAEsiB,eCvBvB/Q,SCGAyrC,GAAUhkD,OAAOikD,OAEjBC,GAAiBlkD,OAAOwE,eACxB2/C,GAAS/9C,EAAY,GAAGxE,QAI5BwiD,IAAkBJ,IAAW3/C,GAAM,WAEjC,GAAID,GAQiB,IARF4/C,GAAQ,CAAE9hC,EAAG,GAAK8hC,GAAQE,GAAe,GAAI,IAAK,CACnEx+C,YAAY,EACZjB,IAAK,WACHy/C,GAAehgD,KAAM,IAAK,CACxBvD,MAAO,EACP+E,YAAY,OAGd,CAAEwc,EAAG,KAAMA,EAAS,OAAO,EAE/B,IAAI9J,EAAI,GACJisC,EAAI,GAEJ37C,EAASC,SACT27C,EAAW,uBAGf,OAFAlsC,EAAE1P,GAAU,EACZ47C,EAAS39C,MAAM,IAAI49B,SAAQ,SAAUxiB,GAAOsiC,EAAEtiC,GAAOA,KACpB,GAA1BiiC,GAAQ,GAAI5rC,GAAG1P,IAAgB8P,GAAWwrC,GAAQ,GAAIK,IAAIp0C,KAAK,KAAOq0C,KAC1E,SAAgBhyC,EAAQ5H,OAC3B,IAAI65C,EAAI35C,GAAS0H,GACbuM,EAAkBvb,UAAUpD,OAC5B4Q,EAAQ,EACRrI,EAAwBsJ,GACxB3M,EAAuBN,EACpB+Z,EAAkB/N,OACvB,IAII5G,EAJAmd,EAAIzgB,EAActD,UAAUwN,MAC5B/Q,EAAO0I,EAAwB07C,GAAO3rC,GAAW6O,GAAI5e,EAAsB4e,IAAM7O,GAAW6O,GAC5FnnB,EAASH,EAAKG,OACdygB,EAAI,EAEDzgB,EAASygB,GACdzW,EAAMnK,EAAK4gB,KACNvc,IAAec,EAAKE,EAAsBiiB,EAAGnd,KAAMq6C,EAAEr6C,GAAOmd,EAAEnd,IAErE,OAAOq6C,GACPP,aCpDJQ,GAAiB,SAAUz7C,EAAU1C,EAAI1F,EAAO8jD,GAC9C,IACE,OAAOA,EAAUp+C,EAAGwG,GAASlM,GAAO,GAAIA,EAAM,IAAM0F,EAAG1F,GACvD,MAAO4D,GACPggB,GAAcxb,EAAU,QAASxE,KCKrC,IAAImgD,GAAQ5gD,EAAAgS,MAIZ6uC,GAAiB,SAAcC,GAC7B,IAAIn4C,EAAI7B,GAASg6C,GACbC,EAAiBptC,GAAcvT,MAC/B2a,EAAkBvb,UAAUpD,OAC5BsjC,EAAQ3kB,EAAkB,EAAIvb,UAAU,QAAK0D,EAC7Cy8B,OAAoBz8B,IAAVw8B,EACVC,IAASD,EAAQvtB,GAAKutB,EAAO3kB,EAAkB,EAAIvb,UAAU,QAAK0D,IACtE,IAEI9G,EAAQ6L,EAAQmZ,EAAMnc,EAAUgT,EAAMpb,EAFtC2jB,EAAiBJ,GAAkBzX,GACnCqE,EAAQ,EAGZ,IAAIwT,GAAoBpgB,MAAQwgD,IAAS1gC,GAAsBM,GAW7D,IAFApkB,EAASgR,GAAkBzE,GAC3BV,EAAS84C,EAAiB,IAAI3gD,KAAKhE,GAAUwkD,GAAMxkD,GAC7CA,EAAS4Q,EAAOA,IACpBnQ,EAAQ8iC,EAAUD,EAAM/2B,EAAEqE,GAAQA,GAASrE,EAAEqE,GAC7C6O,GAAe5T,EAAQ+E,EAAOnQ,QAThC,IAFAob,GADAhT,EAAWqb,GAAY3X,EAAG6X,IACVvI,KAChBhQ,EAAS84C,EAAiB,IAAI3gD,KAAS,KAC/BghB,EAAOhgB,EAAK6W,EAAMhT,IAAWwV,KAAMzN,IACzCnQ,EAAQ8iC,EAAU+gB,GAA6Bz7C,EAAUy6B,EAAO,CAACte,EAAKvkB,MAAOmQ,IAAQ,GAAQoU,EAAKvkB,MAClGgf,GAAe5T,EAAQ+E,EAAOnQ,GAWlC,OADAoL,EAAO7L,OAAS4Q,EACT/E,aH7BL4pB,GAAAC,OIFAkvB,GAAa,eACbC,GAAe,yBAIfC,GAAalhD,EAAAu5B,WACb4nB,GAAO7+C,EAAY2+C,GAAgBzgD,MACnC4gD,GAAQrjD,KAAKyO,MACb60C,GAAev8C,OAAOoZ,aACtBojC,GAAah/C,EAAY,GAAG8uB,YAC5BmwB,GAAOj/C,EAAY,GAAG6J,MACtBq1C,GAAOl/C,EAAY,GAAGkE,MACtBi7C,GAAUn/C,EAAY,GAAG1F,SACzB8kD,GAAQp/C,EAAY,GAAGO,OACvB8+C,GAAcr/C,EAAY,GAAG8M,aAoC7BwyC,GAAe,SAAUC,GAG3B,OAAOA,EAAQ,GAAK,IAAMA,EAAQ,KAOhCC,GAAQ,SAAUC,EAAOC,EAAWC,GACtC,IAAI9lC,EAAI,MACR4lC,EAAQE,EAAYb,GAAMW,EAlEjB,KAkEiCA,GAAS,EACnDA,GAASX,GAAMW,EAAQC,GAChBD,EAAQG,KACbH,EAAQX,GAAMW,EA9DEI,IA+DhBhmC,GA1EO,GA4ET,OAAOilC,GAAMjlC,EAAC,GAAyB4lC,GAASA,EAzEvC,MAgFPK,GAAS,SAAUt8C,GACrB,IAAIu8C,EAAS,GAGbv8C,EAxDe,SAAUqJ,OACzB,IAAIkzC,EAAS,GACTt1B,EAAU,EACV3wB,EAAS+S,EAAO/S,OACb2wB,EAAU3wB,GAAQ,CACvB,IAAIS,EAAQykD,GAAWnyC,EAAQ4d,KAC/B,GAAIlwB,GAAS,OAAUA,GAAS,OAAUkwB,EAAU3wB,EAAQ,CAE1D,IAAIkmD,EAAQhB,GAAWnyC,EAAQ4d,KACP,QAAX,MAARu1B,GACHd,GAAKa,IAAkB,KAARxlD,IAAkB,KAAe,KAARylD,GAAiB,QAIzDd,GAAKa,EAAQxlD,GACbkwB,UAGFy0B,GAAKa,EAAQxlD,GAGjB,OAAOwlD,EAmCCE,CAAWz8C,GAGnB,IAMI3J,EAAGqmD,EANHC,EAAc38C,EAAM1J,OAGpBigB,EAvFS,IAwFT0lC,EAAQ,EACRW,EA1FY,GA8FhB,IAAKvmD,EAAI,EAAGA,EAAI2J,EAAM1J,OAAQD,KAC5BqmD,EAAe18C,EAAM3J,IACF,KACjBqlD,GAAKa,EAAQhB,GAAamB,IAI9B,IAAIG,EAAcN,EAAOjmD,OACrBwmD,EAAiBD,MAGjBA,GACFnB,GAAKa,EAxGO,KA4GPO,EAAiBH,GAAa,CAEnC,IAAItkD,EAtHK,WAuHT,IAAKhC,EAAI,EAAGA,EAAI2J,EAAM1J,OAAQD,KAC5BqmD,EAAe18C,EAAM3J,KACDkgB,GAAKmmC,EAAerkD,IACtCA,EAAIqkD,GAKR,IAAIK,EAAwBD,EAAiB,EAC7C,GAAIzkD,EAAIke,EAAI+kC,IAhIH,WAgImBW,GAASc,GACnC,MAAM3B,GAtHS,mDA4HjB,IAHAa,IAAU5jD,EAAIke,GAAKwmC,EACnBxmC,EAAIle,EAEChC,EAAI,EAAGA,EAAI2J,EAAM1J,OAAQD,IAAK,CAEjC,IADAqmD,EAAe18C,EAAM3J,IACFkgB,KAAO0lC,EAzInB,WA0IL,MAAMb,GA/HO,mDAiIf,GAAIsB,GAAgBnmC,EAAG,KAErB,IAAIymC,EAAIf,EACJ5lC,EA9ID,KA+IU,CACX,IAAI8zB,EAAI9zB,GAAKumC,EA/IZ,EA+I2BvmC,GAAKumC,EA9IhC,GAAA,GA8IqDvmC,EAAIumC,EAC1D,GAAII,EAAI7S,EAAG,MACX,IAAI8S,EAAUD,EAAI7S,EACd+S,EAnJH,GAmJuB/S,EACxBuR,GAAKa,EAAQhB,GAAaO,GAAa3R,EAAI8S,EAAUC,KACrDF,EAAI1B,GAAM2B,EAAUC,GACpB7mC,GAtJC,GAyJHqlC,GAAKa,EAAQhB,GAAaO,GAAakB,KACvCJ,EAAOZ,GAAMC,EAAOc,EAAuBD,GAAkBD,GAC7DZ,EAAQ,EACRa,KAIJb,IACA1lC,IAEF,OAAOklC,GAAKc,EAAQ,KAGtBY,GAAiB,SAAUn9C,GACzB,IAEI3J,EAAG+mD,EAFHC,EAAU,GACVC,EAAS1B,GAAMD,GAAQE,GAAY77C,GAAQm7C,GAAiB,KAAW,KAE3E,IAAK9kD,EAAI,EAAGA,EAAIinD,EAAOhnD,OAAQD,IAC7B+mD,EAAQE,EAAOjnD,GACfqlD,GAAK2B,EAAShC,GAAKH,GAAekC,GAAS,OAASd,GAAOc,GAASA,GAEtE,OAAO3B,GAAK4B,EAAS,gBClLnBE,GAAYrjD,EAAAgD,UAEhBsgD,GAAiB,SAAUC,EAAQC,GACjC,GAAID,EAASC,EAAU,MAAMH,GAAU,wBACvC,OAAOE,GCwBT,IAAIE,GAAW97C,GAAgB,YAG3B+7C,GAAmB34C,GAAAJ,IACnBg5C,GAAyB54C,GAAAE,UAHL,mBAIpB24C,GAA2B74C,GAAAE,UAHE44C,2BAK7BC,GAAUtgD,EAAW,SACrBugD,GAAYvgD,EAAW,WACvBwgD,GAAUxgD,EAAW,WACrBygD,GAAmBF,IAAaA,GAAU7iD,UAC1CgjD,GAAmBF,IAAWA,GAAQ9iD,UACtCijD,GAASnkD,EAAAguB,OACTo2B,GAAYpkD,EAAAgD,UACZqhD,GAAqBrkD,EAAAskD,mBACrBC,GAAqBvkD,EAAAwkD,mBACrBC,GAASniD,EAAY,GAAG+b,QACxBqmC,GAAOpiD,EAAY,GAAG6J,MACtBw4C,GAAOriD,EAAY,GAAGkE,MACtBo+C,GAAUtiD,EAAY,GAAG1F,SACzBioD,GAAQviD,EAAY,GAAGwiD,OACvBC,GAASziD,EAAY,GAAGgkC,QACxB0e,GAAQ1iD,EAAY,GAAGO,OACvBoiD,GAAc3iD,EAAY,GAAGrE,OAE7BinD,GAAI,MACJC,GAAYnzC,MAAM,GAElBozC,GAAkB,SAAU/qB,GAC9B,OAAO8qB,GAAU9qB,EAAQ,KAAO8qB,GAAU9qB,EAAQ,GAAK8pB,GAAO,qBAAuB9pB,EAAQ,KAAM,QAGjGgrB,GAAgB,SAAUC,GAC5B,IACE,OAAOjB,GAAmBiB,GAC1B,MAAO7kD,GACP,OAAO6kD,IAIPC,GAAc,SAAUxlD,GAC1B,IAAIkI,EAAS28C,GAAQ7kD,EAAImlD,GAAM,KAC3B7qB,EAAQ,EACZ,IACE,OAAOgqB,GAAmBp8C,GAC1B,MAAOxH,QACA45B,GACLpyB,EAAS28C,GAAQ38C,EAAQm9C,GAAgB/qB,KAAUgrB,IAErD,OAAOp9C,IAIPu9C,GAAI,eAEJC,GAAe,CACjB,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,MAAO,KAGLC,GAAW,SAAUzoD,GACvB,OAAOwoD,GAAaxoD,IAGlB0oD,GAAY,SAAU5lD,GACxB,OAAO6kD,GAAQL,GAAmBxkD,GAAKylD,GAAME,KAG3CE,GAA0B7tC,IAA0B,SAAkB8tC,EAAQrrC,GAChFkpC,GAAiBtjD,KAAM,CACrBzB,KAxE6BklD,0BAyE7B5+C,SAAUqb,GAAYqjC,GAAuBkC,GAAQ3rC,SACrDM,KAAMA,MAEP,YAAY,WACb,IAAInQ,EAAQu5C,GAAyBxjD,MACjCoa,EAAOnQ,EAAMmQ,KACb4G,EAAO/W,EAAMpF,SAASgT,OACtB+Q,EAAQ5H,EAAKvkB,MAGf,OAFGukB,EAAK3G,OACR2G,EAAKvkB,MAAiB,SAAT2d,EAAkBwO,EAAM5iB,IAAe,WAAToU,EAAoBwO,EAAMnsB,MAAQ,CAACmsB,EAAM5iB,IAAK4iB,EAAMnsB,QACxFukB,KACR,GAEC0kC,GAAuB,SAAUriB,GACnCrjC,KAAK8Z,QAAU,GACf9Z,KAAKzD,IAAM,UAEEuG,IAATugC,IACEngC,EAASmgC,GAAOrjC,KAAK2lD,YAAYtiB,GAChCrjC,KAAK4lD,WAA0B,iBAARviB,EAAuC,MAApBghB,GAAOhhB,EAAM,GAAawhB,GAAYxhB,EAAM,GAAKA,EAAO5yB,GAAU4yB,MAIrHqiB,GAAqB5kD,UAAY,CAC/BvC,KAlGsB,kBAmGtBsnD,QAAS,SAAUtpD,GACjByD,KAAKzD,IAAMA,EACXyD,KAAKysC,UAEPkZ,YAAa,SAAUz8C,GACrB,IACIrE,EAAUgT,EAAMmJ,EAAM8kC,EAAeC,EAAW10B,EAAOC,EADvDlR,EAAiBJ,GAAkB9W,GAGvC,GAAIkX,MAEFvI,GADAhT,EAAWqb,GAAYhX,EAAQkX,IACfvI,OACPmJ,EAAOhgB,EAAK6W,EAAMhT,IAAWwV,MAAM,CAG1C,GADA0rC,GADAD,EAAgB5lC,GAAYvX,GAASqY,EAAKvkB,SAChBob,MAEvBwZ,EAAQrwB,EAAK+kD,EAAWD,IAAgBzrC,OACxCiX,EAAStwB,EAAK+kD,EAAWD,IAAgBzrC,OACzCrZ,EAAK+kD,EAAWD,GAAezrC,KAChC,MAAM2pC,GAAU,mCAClBO,GAAKvkD,KAAK8Z,QAAS,CAAE9T,IAAKyK,GAAU4gB,EAAM50B,OAAQA,MAAOgU,GAAU6gB,EAAO70B,cAEvE,IAAK,IAAIuJ,KAAOkD,EAAYtC,GAAOsC,EAAQlD,IAChDu+C,GAAKvkD,KAAK8Z,QAAS,CAAE9T,IAAKA,EAAKvJ,MAAOgU,GAAUvH,EAAOlD,OAG3D4/C,WAAY,SAAUI,GACpB,GAAIA,MACF,IAEIC,EAAWr9B,EAFXs9B,EAAatB,GAAMoB,EAAO,KAC1Bp5C,EAAQ,EAELA,EAAQs5C,EAAWlqD,SACxBiqD,EAAYC,EAAWt5C,MACT5Q,SACZ4sB,EAAQg8B,GAAMqB,EAAW,KACzB1B,GAAKvkD,KAAK8Z,QAAS,CACjB9T,IAAKm/C,GAAYV,GAAM77B,IACvBnsB,MAAO0oD,GAAYb,GAAK17B,EAAO,UAMzCu9B,UAAW,eACT,IAGIv9B,EAHA9O,EAAU9Z,KAAK8Z,QACfjS,EAAS,GACT+E,EAAQ,EAELA,EAAQkN,EAAQ9d,QACrB4sB,EAAQ9O,EAAQlN,KAChB23C,GAAK18C,EAAQ09C,GAAU38B,EAAM5iB,KAAO,IAAMu/C,GAAU38B,EAAMnsB,QAC1D,OAAO6nD,GAAKz8C,EAAQ,MAExB4kC,OAAQ,WACNzsC,KAAK8Z,QAAQ9d,OAAS,EACtBgE,KAAK4lD,WAAW5lD,KAAKzD,IAAIypD,QAE3BI,UAAW,WACLpmD,KAAKzD,KAAKyD,KAAKzD,IAAIkwC,WAM3B,IAAI4Z,GAA6B,WAC/BlkC,GAAWniB,KAAMsmD,IACjB,IAAIjjB,EAAOjkC,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,EACjDwgD,GAAiBtjD,KAAM,IAAI0lD,GAAqBriB,KAG9CijB,GAA2BD,GAA2BvlD,UAwI1D,GAtIA+gB,GAAYykC,GAA0B,CAGpCC,OAAQ,SAAgB/+C,EAAM/K,GAC5BymD,GAAwB9jD,UAAUpD,OAAQ,GAC1C,IAAIiO,EAAQs5C,GAAuBvjD,MACnCukD,GAAKt6C,EAAM6P,QAAS,CAAE9T,IAAKyK,GAAUjJ,GAAO/K,MAAOgU,GAAUhU,KAC7DwN,EAAMm8C,aAIRte,OAAU,SAAUtgC,GAClB07C,GAAwB9jD,UAAUpD,OAAQ,OAC1C,IAAIiO,EAAQs5C,GAAuBvjD,MAC/B8Z,EAAU7P,EAAM6P,QAChB9T,EAAMyK,GAAUjJ,GAChBoF,EAAQ,EACLA,EAAQkN,EAAQ9d,QACjB8d,EAAQlN,GAAO5G,MAAQA,EAAK2+C,GAAO7qC,EAASlN,EAAO,GAClDA,IAEP3C,EAAMm8C,aAIR7lD,IAAK,SAAaiH,GAChB07C,GAAwB9jD,UAAUpD,OAAQ,GAI1C,IAHA,IAAI8d,EAAUypC,GAAuBvjD,MAAM8Z,QACvC9T,EAAMyK,GAAUjJ,GAChBoF,EAAQ,EACLA,EAAQkN,EAAQ9d,OAAQ4Q,IAC7B,GAAIkN,EAAQlN,GAAO5G,MAAQA,EAAK,OAAO8T,EAAQlN,GAAOnQ,MAExD,OAAO,MAIT+pD,OAAQ,SAAgBh/C,GACtB07C,GAAwB9jD,UAAUpD,OAAQ,GAK1C,IAJA,IAAI8d,EAAUypC,GAAuBvjD,MAAM8Z,QACvC9T,EAAMyK,GAAUjJ,GAChBK,EAAS,GACT+E,EAAQ,EACLA,EAAQkN,EAAQ9d,OAAQ4Q,IACzBkN,EAAQlN,GAAO5G,MAAQA,GAAKu+C,GAAK18C,EAAQiS,EAAQlN,GAAOnQ,OAE9D,OAAOoL,GAITwC,IAAK,SAAa7C,GAChB07C,GAAwB9jD,UAAUpD,OAAQ,OAC1C,IAAI8d,EAAUypC,GAAuBvjD,MAAM8Z,QACvC9T,EAAMyK,GAAUjJ,GAChBoF,EAAQ,EACLA,EAAQkN,EAAQ9d,QACrB,GAAI8d,EAAQlN,KAAS5G,MAAQA,EAAK,OAAO,EAE3C,OAAO,GAITuE,IAAK,SAAa/C,EAAM/K,GACtBymD,GAAwB9jD,UAAUpD,OAAQ,GAQ1C,IAPA,IAMI4sB,EANA3e,EAAQs5C,GAAuBvjD,MAC/B8Z,EAAU7P,EAAM6P,QAChB2sC,GAAQ,EACRzgD,EAAMyK,GAAUjJ,GAChB5B,EAAM6K,GAAUhU,GAChBmQ,EAAQ,EAELA,EAAQkN,EAAQ9d,OAAQ4Q,KAC7Bgc,EAAQ9O,EAAQlN,IACN5G,MAAQA,IACZygD,EAAO9B,GAAO7qC,EAASlN,IAAS,IAElC65C,GAAQ,EACR79B,EAAMnsB,MAAQmJ,IAIf6gD,GAAOlC,GAAKzqC,EAAS,CAAE9T,IAAKA,EAAKvJ,MAAOmJ,IAC7CqE,EAAMm8C,aAIR9oC,KAAM,WACJ,IAAIrT,EAAQs5C,GAAuBvjD,MACnC8c,GAAU7S,EAAM6P,SAAS,SAAU1R,EAAG4V,GACpC,OAAO5V,EAAEpC,IAAMgY,EAAEhY,IAAM,GAAI,KAE7BiE,EAAMm8C,aAGR/lB,QAAS,SAAiBqM,OACxB,IAGI9jB,EAHA9O,EAAUypC,GAAuBvjD,MAAM8Z,QACvCqmB,EAAgBpuB,GAAK26B,EAAUttC,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,GACrE8J,EAAQ,EAELA,EAAQkN,EAAQ9d,QAErBmkC,GADAvX,EAAQ9O,EAAQlN,MACInQ,MAAOmsB,EAAM5iB,IAAKhG,OAI1CnE,KAAM,WACJ,OAAO,IAAI2pD,GAAwBxlD,KAAM,SAG3C+Z,OAAQ,WACN,OAAO,IAAIyrC,GAAwBxlD,KAAM,WAG3C8Z,QAAS,WACP,OAAO,IAAI0rC,GAAwBxlD,KAAM,aAE1C,CAAEwB,YAAY,IAGjBiK,GAAS66C,GAA0BjD,GAAUiD,GAAyBxsC,QAAS,CAAEtS,KAAM,YAIvFiE,GAAS66C,GAA0B,YAAY,WAC7C,OAAO/C,GAAuBvjD,MAAMmmD,cACnC,CAAE3kD,YAAY,IAEjB+V,GAAe8uC,GAzSS,mBA2SxBh3C,EAAE,CAAEK,QAAQ,EAAMI,QAASwvC,IAAkB,CAC3CK,gBAAiB0G,MAId/G,IAAkBt8C,EAAW4gD,IAAU,CAC1C,IAAI8C,GAAaxkD,EAAY4hD,GAAiBz5C,KAC1Cs8C,GAAazkD,EAAY4hD,GAAiBv5C,KAE1Cq8C,GAAqB,SAAUvjB,GACjC,GAAIngC,EAASmgC,GAAO,CAClB,IACIwjB,EADAC,EAAOzjB,EAAKyjB,KAEhB,GAxTkB,oBAwTd12C,GAAQ02C,GAKV,OAJAD,EAAUxjB,EAAKwjB,QAAU,IAAIjD,GAAQvgB,EAAKwjB,SAAW,IAAIjD,GACpD8C,GAAWG,EAAS,iBACvBF,GAAWE,EAAS,eAAgB,mDAE/B3wC,GAAOmtB,EAAM,CAClByjB,KAAMrlD,EAAyB,EAAGgP,GAAUq2C,IAC5CD,QAASplD,EAAyB,EAAGolD,KAGzC,OAAOxjB,GAWX,GARIrgC,EAAW0gD,KACbr0C,EAAE,CAAEK,QAAQ,EAAMlO,YAAY,EAAMsO,QAAQ,GAAQ,CAClDi3C,MAAO,SAAerhD,GACpB,OAAOg+C,GAAQh+C,EAAOtG,UAAUpD,OAAS,EAAI4qD,GAAmBxnD,UAAU,IAAM,OAKlF4D,EAAW2gD,IAAY,CACzB,IAAIqD,GAAqB,SAAiBthD,GAExC,OADAyc,GAAWniB,KAAM6jD,IACV,IAAIF,GAAUj+C,EAAOtG,UAAUpD,OAAS,EAAI4qD,GAAmBxnD,UAAU,IAAM,KAGxFykD,GAAiB/yC,YAAck2C,GAC/BA,GAAmBlmD,UAAY+iD,GAE/Bx0C,EAAE,CAAEK,QAAQ,EAAMI,QAAQ,GAAQ,CAChCm3C,QAASD,MAKfE,GAAiB,CACfvH,gBAAiB0G,GACjBc,SAAU5D,INtWZ,IAAI6D,GAAmBz8C,GAAAJ,IACnB88C,GAAsB18C,GAAAE,UAA8B,OACpDy8C,GAAkBJ,GAAAvH,gBAClB4H,GAA+BL,GAAAC,SAE/BK,GAAY5nD,EAAA2/C,IACZkI,GAAY7nD,EAAAgD,UACZ8kD,GAAW9nD,EAAAixC,SACX8W,GAAQhqD,KAAKyO,MACbw7C,GAAMjqD,KAAK67B,IACXquB,GAAS3lD,EAAY,GAAG+b,QACxB6pC,GAAO5lD,EAAW,IAAK9B,MACvB2nD,GAAO7lD,EAAY,GAAG6J,MACtBi8C,GAAiB9lD,EAAY,GAAIE,UACjC6lD,GAAM/lD,EAAY,GAAGgmD,KACrBC,GAAOjmD,EAAY,GAAGkE,MACtBgiD,GAAUlmD,EAAY,GAAG1F,SACzB6rD,GAAQnmD,EAAY,GAAGwiD,OACvB4D,GAAQpmD,EAAY,GAAGO,OACvB8lD,GAAcrmD,EAAY,GAAGrE,OAC7B2qD,GAActmD,EAAY,GAAG8M,aAC7By5C,GAAUvmD,EAAY,GAAGwmD,SAOzBC,GAAK,SAELC,GAAY,cACZC,GAAK,KACLC,GAAS,OACTC,GAAG,WACHC,GAAG,QACHC,GAAG,cAEHC,GAAyB,6BACzBC,GAA2C,4BAC3CC,GAAwC,uCACxCC,GAAgB,YAoJhBC,GAAgB,SAAUlkC,GAC5B,IAAIvd,EAAQ+E,EAAO28C,EAAUC,EAE7B,GAAmB,iBAARpkC,EAAkB,CAE3B,IADAvd,EAAS,GACJ+E,EAAQ,EAAGA,EAAQ,EAAGA,IACzB67C,GAAQ5gD,EAAQud,EAAO,KACvBA,EAAOuiC,GAAMviC,EAAO,KACpB,OAAO2iC,GAAKlgD,EAAQ,KAEjB,GAAmB,iBAARud,EAAkB,CAGlC,IAFAvd,EAAS,GACT0hD,EAvC0B,SAAUE,GAMtC,IALA,IAAIC,EAAW,KACXC,EAAY,EACZC,EAAY,KACZC,EAAa,EACbj9C,EAAQ,EACLA,EAAQ,EAAGA,IACI,IAAhB68C,EAAK78C,IACHi9C,EAAaF,IACfD,EAAWE,EACXD,EAAYE,GAEdD,EAAY,KACZC,EAAa,IAEK,OAAdD,IAAoBA,EAAYh9C,KAClCi9C,GAON,OAJIA,EAAaF,IACfD,EAAWE,EACXD,EAAYE,GAEPH,EAgBMI,CAAwB1kC,GAC9BxY,EAAQ,EAAGA,EAAQ,EAAGA,IACrB48C,GAA2B,IAAhBpkC,EAAKxY,KAChB48C,IAASA,GAAU,GACnBD,IAAa38C,GACf/E,GAAU+E,EAAQ,IAAM,KACxB48C,GAAU,IAEV3hD,GAAUmgD,GAAe5iC,EAAKxY,GAAQ,IAClCA,EAAQ,IAAG/E,GAAU,OAG7B,MAAO,IAAMA,EAAS,IACtB,OAAOud,GAGP2kC,GAA4B,GAC5BC,GAA2B9J,GAAO,GAAI6J,GAA2B,CACnE,IAAK,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,IAEnCE,GAAuB/J,GAAO,GAAI8J,GAA0B,CAC9D,IAAK,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,IAE3BE,GAA2BhK,GAAO,GAAI+J,GAAsB,CAC9D,IAAK,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,EAAG,KAAM,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,IAG5EE,GAAgB,SAAUtsC,EAAKtT,GACjC,IAAIqT,EAAIwsC,GAAUvsC,EAAK,GACvB,OAAOD,EAAO,IAAQA,EAAO,MAAShX,GAAO2D,EAAKsT,GAAOA,EAAMumC,mBAAmBvmC,IAIhFwsC,GAAiB,CACnBC,IAAK,GACLC,KAAM,KACNC,KAAM,GACNC,MAAO,IACPC,GAAI,GACJC,IAAK,KAIHC,GAAuB,SAAU77C,EAAQ87C,GAC3C,IAAIv5B,EACJ,OAAwB,GAAjBviB,EAAO/S,QAAe8rD,GAAKa,GAAOd,GAAO94C,EAAQ,MAClB,MAA/BuiB,EAASu2B,GAAO94C,EAAQ,MAAgB87C,GAAwB,KAAVv5B,IAI3Dw5B,GAA+B,SAAU/7C,GAC3C,IAAIg8C,EACJ,OAAOh8C,EAAO/S,OAAS,GAAK4uD,GAAqBrC,GAAYx5C,EAAQ,EAAG,MACrD,GAAjBA,EAAO/S,QAC0B,OAA/B+uD,EAAQlD,GAAO94C,EAAQ,KAAyB,OAAVg8C,GAA4B,MAAVA,GAA2B,MAAVA,IAK3EC,GAAc,SAAUC,GAC1B,MAAmB,MAAZA,GAA4C,QAAzBzC,GAAYyC,IAUpCC,GAAe,GACfC,GAAS,GACTC,GAAY,GACZC,GAAgC,GAChCC,GAAoB,GACpBC,GAAW,GACXC,GAAiB,GACjBC,GAA4B,GAC5BC,GAAmC,GACnCC,GAAY,GACZC,GAAO,GACPC,GAAW,GACXC,GAAO,GACPC,GAAO,GACPC,GAAa,GACbC,GAAY,GACZC,GAAa,GACbC,GAAO,GACPC,GAA4B,GAC5BC,GAAQ,GACRC,GAAW,GAEXC,GAAW,SAAUhwD,EAAKiwD,EAAQC,GACpC,IACIC,EAAWC,EAASnN,EADpBoN,EAAYn8C,GAAUlU,GAE1B,GAAIiwD,EAAQ,CAEV,GADAG,EAAU3sD,KAAKR,MAAMotD,GACR,MAAMnF,GAAUkF,GAC7B3sD,KAAKw/C,aAAe,SACf,CAGL,QAFa18C,IAAT2pD,IAAoBC,EAAY,IAAIH,GAASE,GAAM,IACvDE,EAAU3sD,KAAKR,MAAMotD,EAAW,KAAMF,GACzB,MAAMjF,GAAUkF,IAC7BnN,EAAe+H,GAA6B,IAAID,KACnCzB,QAAQ7lD,MACrBA,KAAKw/C,aAAeA,IAIxB+M,GAASzrD,UAAY,CACnBvC,KAAM,MAGNiB,MAAO,SAAUkG,EAAOmnD,EAAeJ,GACrC,IAOItS,EAAYt8B,EAAKivC,EAAkBH,EAzDf1B,EAkDpB1uD,EAAMyD,KACNiK,EAAQ4iD,GAAiB3B,GACzB6B,EAAU,EACV1yB,EAAS,GACT2yB,GAAS,EACTC,GAAc,EACdC,GAAoB,MAGxBxnD,EAAQ+K,GAAU/K,GAEbmnD,IACHtwD,EAAI4wD,OAAS,GACb5wD,EAAIqjD,SAAW,GACfrjD,EAAI6wD,SAAW,GACf7wD,EAAI6oB,KAAO,KACX7oB,EAAI8wD,KAAO,KACX9wD,EAAI+wD,KAAO,GACX/wD,EAAIypD,MAAQ,KACZzpD,EAAIgxD,SAAW,KACfhxD,EAAIixD,kBAAmB,EACvB9nD,EAAQ0iD,GAAQ1iD,EAAO0jD,GAA0C,KAGnE1jD,EAAQ0iD,GAAQ1iD,EAAO2jD,GAAkB,IAEzClP,EAAasG,GAAU/6C,GAEhBqnD,GAAW5S,EAAWn+C,QAAQ,CAEnC,OADA6hB,EAAMs8B,EAAW4S,GACT9iD,GACN,KAAKihD,GACH,IAAIrtC,IAAOiqC,GAAKa,GAAO9qC,GAGhB,CAAA,GAAKgvC,EAGL,MAxUI,iBAsUT5iD,EAAQmhD,GACR,SAJA/wB,GAAUmuB,GAAY3qC,GACtB5T,EAAQkhD,GAKV,MAEF,KAAKA,GACH,GAAIttC,IAAQiqC,GAAKc,GAAc/qC,IAAe,KAAPA,GAAqB,KAAPA,GAAqB,KAAPA,GACjEwc,GAAUmuB,GAAY3qC,OACjB,CAAA,GAAW,KAAPA,EA0BJ,CAAA,GAAKgvC,EAKL,MA7WI,iBAyWTxyB,EAAS,GACTpwB,EAAQmhD,GACR2B,EAAU,EACV,SA7BA,GAAIF,IACDtwD,EAAIkxD,aAAe7mD,GAAOyjD,GAAgBhwB,IAChC,QAAVA,IAAqB99B,EAAImxD,uBAAsC,OAAbnxD,EAAI8wD,OACxC,QAAd9wD,EAAI4wD,SAAqB5wD,EAAI6oB,MAC7B,OAEH,GADA7oB,EAAI4wD,OAAS9yB,EACTwyB,EAEF,YADItwD,EAAIkxD,aAAepD,GAAe9tD,EAAI4wD,SAAW5wD,EAAI8wD,OAAM9wD,EAAI8wD,KAAO,OAG5EhzB,EAAS,GACS,QAAd99B,EAAI4wD,OACNljD,EAAQ8hD,GACCxvD,EAAIkxD,aAAehB,GAAQA,EAAKU,QAAU5wD,EAAI4wD,OACvDljD,EAAQohD,GACC9uD,EAAIkxD,YACbxjD,EAAQwhD,GAC4B,KAA3BtR,EAAW4S,EAAU,IAC9B9iD,EAAQqhD,GACRyB,MAEAxwD,EAAIixD,kBAAmB,EACvBrF,GAAK5rD,EAAI+wD,KAAM,IACfrjD,EAAQmiD,IAQZ,MAEF,KAAKhB,GACH,IAAKqB,GAASA,EAAKe,kBAA2B,KAAP3vC,EAAa,MAjXzC,iBAkXX,GAAI4uC,EAAKe,kBAA2B,KAAP3vC,EAAY,CACvCthB,EAAI4wD,OAASV,EAAKU,OAClB5wD,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIypD,MAAQyG,EAAKzG,MACjBzpD,EAAIgxD,SAAW,GACfhxD,EAAIixD,kBAAmB,EACvBvjD,EAAQqiD,GACR,MAEFriD,EAAuB,QAAfwiD,EAAKU,OAAmBpB,GAAOR,GACvC,SAEF,KAAKF,GACH,GAAW,KAAPxtC,GAAyC,KAA3Bs8B,EAAW4S,EAAU,GAGhC,CACL9iD,EAAQshD,GACR,SAJAthD,EAAQyhD,GACRqB,IAIA,MAEJ,KAAKzB,GACH,GAAW,KAAPztC,EAAY,CACd5T,EAAQ0hD,GACR,MAEA1hD,EAAQkiD,GACR,SAGJ,KAAKZ,GAEH,GADAhvD,EAAI4wD,OAASV,EAAKU,OA/XxBQ,MAgYU9vC,EACFthB,EAAIqjD,SAAW6M,EAAK7M,SACpBrjD,EAAI6wD,SAAWX,EAAKW,SACpB7wD,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI8wD,KAAOZ,EAAKY,KAChB9wD,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIypD,MAAQyG,EAAKzG,WACZ,GAAW,KAAPnoC,GAAsB,MAAPA,GAAethB,EAAIkxD,YAC3CxjD,EAAQuhD,QACH,GAAW,KAAP3tC,EACTthB,EAAIqjD,SAAW6M,EAAK7M,SACpBrjD,EAAI6wD,SAAWX,EAAKW,SACpB7wD,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI8wD,KAAOZ,EAAKY,KAChB9wD,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIypD,MAAQ,GACZ/7C,EAAQoiD,OACH,CAAA,GAAW,KAAPxuC,EASJ,CACLthB,EAAIqjD,SAAW6M,EAAK7M,SACpBrjD,EAAI6wD,SAAWX,EAAKW,SACpB7wD,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI8wD,KAAOZ,EAAKY,KAChB9wD,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAI+wD,KAAKtxD,SACTiO,EAAQkiD,GACR,SAhBA5vD,EAAIqjD,SAAW6M,EAAK7M,SACpBrjD,EAAI6wD,SAAWX,EAAKW,SACpB7wD,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI8wD,KAAOZ,EAAKY,KAChB9wD,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIypD,MAAQyG,EAAKzG,MACjBzpD,EAAIgxD,SAAW,GACftjD,EAAQqiD,GAUR,MAEJ,KAAKd,GACH,IAAIjvD,EAAIkxD,aAAuB,KAAP5vC,GAAqB,MAAPA,EAE/B,CAAA,GAAW,KAAPA,EAEJ,CACLthB,EAAIqjD,SAAW6M,EAAK7M,SACpBrjD,EAAI6wD,SAAWX,EAAKW,SACpB7wD,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI8wD,KAAOZ,EAAKY,KAChBpjD,EAAQkiD,GACR,SAPAliD,EAAQ0hD,QAFR1hD,EAAQyhD,GAUR,MAEJ,KAAKD,GAEH,GADAxhD,EAAQyhD,GACG,KAAP7tC,GAA6C,KAA/BgqC,GAAOxtB,EAAQ0yB,EAAU,GAAW,SACtDA,IACA,MAEF,KAAKrB,GACH,GAAW,KAAP7tC,GAAqB,MAAPA,EAAa,CAC7B5T,EAAQ0hD,GACR,SACA,MAEJ,KAAKA,GACH,GAAW,KAAP9tC,EAAY,CACVmvC,IAAQ3yB,EAAS,MAAQA,GAC7B2yB,GAAS,EACTF,EAAmBrM,GAAUpmB,GAC7B,IAAK,IAAIt+B,EAAI,EAAGA,EAAI+wD,EAAiB9wD,OAAQD,IAAK,CAChD,IAAIm+C,EAAY4S,EAAiB/wD,GACjC,GAAiB,KAAbm+C,GAAqBgT,EAAzB,CAIA,IAAIU,EAAoBzD,GAAcjQ,EAAWgQ,IAC7CgD,EAAmB3wD,EAAI6wD,UAAYQ,EAClCrxD,EAAIqjD,UAAYgO,OALnBV,GAAoB,EAOxB7yB,EAAS,QACJ,GA/cbszB,MAgdQ9vC,GAAqB,KAAPA,GAAqB,KAAPA,GAAqB,KAAPA,GAClC,MAAPA,GAAethB,EAAIkxD,YACpB,CACA,GAAIT,GAAoB,IAAV3yB,EAAc,MAtehB,oBAueZ0yB,GAAWtM,GAAUpmB,GAAQr+B,OAAS,EACtCq+B,EAAS,GACTpwB,EAAQ2hD,QACHvxB,GAAUxc,EACjB,MAEF,KAAK+tC,GACL,KAAKC,GACH,GAAIgB,GAA+B,QAAdtwD,EAAI4wD,OAAkB,CACzCljD,EAAQgiD,GACR,SACK,GAAW,KAAPpuC,GAAeovC,EAOnB,CAAA,GAtebU,MAueQ9vC,GAAqB,KAAPA,GAAqB,KAAPA,GAAqB,KAAPA,GAClC,MAAPA,GAAethB,EAAIkxD,YACpB,CACA,GAAIlxD,EAAIkxD,aAAyB,IAAVpzB,EAAc,MA3f9B,eA4fP,GAAIwyB,GAA2B,IAAVxyB,IAAiB99B,EAAImxD,uBAAsC,OAAbnxD,EAAI8wD,MAAgB,OAEvF,GADAV,EAAUpwD,EAAIsxD,UAAUxzB,GACX,OAAOsyB,EAGpB,GAFAtyB,EAAS,GACTpwB,EAAQiiD,GACJW,EAAe,OACnB,SAEW,KAAPhvC,EAAYovC,GAAc,EACd,KAAPpvC,IAAYovC,GAAc,GACnC5yB,GAAUxc,MAtB2B,CACrC,GAAc,IAAVwc,EAAc,MAjfX,eAmfP,GADAsyB,EAAUpwD,EAAIsxD,UAAUxzB,GACX,OAAOsyB,EAGpB,GAFAtyB,EAAS,GACTpwB,EAAQ6hD,GACJe,GAAiBhB,GAAU,OAiB/B,MAEJ,KAAKC,GACH,IAAIhE,GAAKe,GAAOhrC,GAET,CAAA,GA3fb8vC,MA4fQ9vC,GAAqB,KAAPA,GAAqB,KAAPA,GAAqB,KAAPA,GAClC,MAAPA,GAAethB,EAAIkxD,aACpBZ,EACA,CACA,GAAc,IAAVxyB,EAAc,CAChB,IAAIgzB,EAAO3F,GAASrtB,EAAQ,IAC5B,GAAIgzB,EAAO,MAAQ,MAlhBd,eAmhBL9wD,EAAI8wD,KAAQ9wD,EAAIkxD,aAAeJ,IAAShD,GAAe9tD,EAAI4wD,QAAW,KAAOE,EAC7EhzB,EAAS,GAEX,GAAIwyB,EAAe,OACnB5iD,EAAQiiD,GACR,SACK,MAzhBE,eA0gBP7xB,GAAUxc,EAgBZ,MAEF,KAAKkuC,GAEH,GADAxvD,EAAI4wD,OAAS,OACF,KAAPtvC,GAAqB,MAAPA,EAAa5T,EAAQ+hD,OAClC,CAAA,IAAIS,GAAuB,QAAfA,EAAKU,OAyBf,CACLljD,EAAQkiD,GACR,SA1BA,GAhhBRwB,MAghBY9vC,EACFthB,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIypD,MAAQyG,EAAKzG,WACZ,GAAW,KAAPnoC,EACTthB,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIypD,MAAQ,GACZ/7C,EAAQoiD,OACH,CAAA,GAAW,KAAPxuC,EAMJ,CACAitC,GAA6B/C,GAAKlsC,GAAWs+B,EAAY4S,GAAU,OACtExwD,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIuxD,eAEN7jD,EAAQkiD,GACR,SAZA5vD,EAAI6oB,KAAOqnC,EAAKrnC,KAChB7oB,EAAI+wD,KAAOzxC,GAAW4wC,EAAKa,MAC3B/wD,EAAIypD,MAAQyG,EAAKzG,MACjBzpD,EAAIgxD,SAAW,GACftjD,EAAQqiD,IAaV,MAEJ,KAAKN,GACH,GAAW,KAAPnuC,GAAqB,MAAPA,EAAa,CAC7B5T,EAAQgiD,GACR,MAEEQ,GAAuB,QAAfA,EAAKU,SAAqBrC,GAA6B/C,GAAKlsC,GAAWs+B,EAAY4S,GAAU,OACnGnC,GAAqB6B,EAAKa,KAAK,IAAI,GAAOnF,GAAK5rD,EAAI+wD,KAAMb,EAAKa,KAAK,IAClE/wD,EAAI6oB,KAAOqnC,EAAKrnC,MAEvBnb,EAAQkiD,GACR,SAEF,KAAKF,GACH,GA1jBN0B,MA0jBU9vC,GAAqB,KAAPA,GAAqB,MAAPA,GAAsB,KAAPA,GAAqB,KAAPA,EAAY,CACvE,IAAKgvC,GAAiBjC,GAAqBvwB,GACzCpwB,EAAQkiD,QACH,GAAc,IAAV9xB,EAAc,CAEvB,GADA99B,EAAI6oB,KAAO,GACPynC,EAAe,OACnB5iD,EAAQiiD,OACH,CAEL,GADAS,EAAUpwD,EAAIsxD,UAAUxzB,GACX,OAAOsyB,EAEpB,GADgB,aAAZpwD,EAAI6oB,OAAqB7oB,EAAI6oB,KAAO,IACpCynC,EAAe,OACnBxyB,EAAS,GACTpwB,EAAQiiD,GACR,SACG7xB,GAAUxc,EACjB,MAEF,KAAKquC,GACH,GAAI3vD,EAAIkxD,aAEN,GADAxjD,EAAQkiD,GACG,KAAPtuC,GAAqB,MAAPA,EAAa,cAC1B,GAAKgvC,GAAwB,KAAPhvC,EAGtB,GAAKgvC,GAAwB,KAAPhvC,GAGtB,GAtlBb8vC,MAslBiB9vC,IACT5T,EAAQkiD,GACG,KAAPtuC,GAAY,cAJhBthB,EAAIgxD,SAAW,GACftjD,EAAQqiD,QAJR/vD,EAAIypD,MAAQ,GACZ/7C,EAAQoiD,GAOR,MAEJ,KAAKF,GACH,GA5lBNwB,MA6lBQ9vC,GAAqB,KAAPA,GACN,MAAPA,GAAethB,EAAIkxD,cAClBZ,IAAyB,KAAPhvC,GAAqB,KAAPA,GAClC,CAkBA,GAlZS,QADnBotC,EAAUzC,GADgByC,EAmYA5wB,KAjYa,SAAZ4wB,GAAkC,SAAZA,GAAkC,WAAZA,GAkY3D1uD,EAAIuxD,cACO,KAAPjwC,GAAuB,MAAPA,GAAethB,EAAIkxD,aACrCtF,GAAK5rD,EAAI+wD,KAAM,KAERtC,GAAY3wB,GACV,KAAPxc,GAAuB,MAAPA,GAAethB,EAAIkxD,aACrCtF,GAAK5rD,EAAI+wD,KAAM,KAGC,QAAd/wD,EAAI4wD,SAAqB5wD,EAAI+wD,KAAKtxD,QAAU4uD,GAAqBvwB,KAC/D99B,EAAI6oB,OAAM7oB,EAAI6oB,KAAO,IACzBiV,EAASwtB,GAAOxtB,EAAQ,GAAK,KAE/B8tB,GAAK5rD,EAAI+wD,KAAMjzB,IAEjBA,EAAS,GACS,QAAd99B,EAAI4wD,SAlnBhBQ,MAknBqC9vC,GAAqB,KAAPA,GAAqB,KAAPA,GAAU,KAC1DthB,EAAI+wD,KAAKtxD,OAAS,GAAqB,KAAhBO,EAAI+wD,KAAK,IACrCjF,GAAM9rD,EAAI+wD,MAGH,KAAPzvC,GACFthB,EAAIypD,MAAQ,GACZ/7C,EAAQoiD,IACQ,KAAPxuC,IACTthB,EAAIgxD,SAAW,GACftjD,EAAQqiD,SAGVjyB,GAAU8vB,GAActsC,EAAKosC,IAC7B,MAEJ,KAAKmC,GACQ,KAAPvuC,GACFthB,EAAIypD,MAAQ,GACZ/7C,EAAQoiD,IACQ,KAAPxuC,GACTthB,EAAIgxD,SAAW,GACftjD,EAAQqiD,IAxoBhBqB,MAyoBiB9vC,IACTthB,EAAI+wD,KAAK,IAAMnD,GAActsC,EAAKksC,KAClC,MAEJ,KAAKsC,GACEQ,GAAwB,KAAPhvC,EA9oB5B8vC,MAipBiB9vC,IACE,KAAPA,GAActhB,EAAIkxD,YAAalxD,EAAIypD,OAAS,MAC3BzpD,EAAIypD,OAAT,KAAPnoC,EAAyB,MAChBssC,GAActsC,EAAKksC,MALrCxtD,EAAIgxD,SAAW,GACftjD,EAAQqiD,IAKR,MAEJ,KAAKA,GAvpBTqB,MAwpBU9vC,IAAYthB,EAAIgxD,UAAYpD,GAActsC,EAAKmsC,KAIvD+C,MAIJc,UAAW,SAAUnoD,GACnB,IAAImC,EAAQsyC,EAAYvtC,EACxB,GAAwB,KAApBi7C,GAAOniD,EAAO,GAAW,CAC3B,GAAuC,KAAnCmiD,GAAOniD,EAAOA,EAAM1J,OAAS,GAAW,MAprB/B,eAsrBb,GADA6L,EAznBU,SAAUnC,GACxB,IAIIjJ,EAAOT,EAAQ+xD,EAAaC,EAAW1hD,EAAQ2hD,EAAOC,EAJtDC,EAAU,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAChCC,EAAa,EACb7E,EAAW,KACXwD,EAAU,EAGVlvC,EAAM,WACR,OAAOgqC,GAAOniD,EAAOqnD,IAGvB,GAAa,KAATlvC,IAAc,CAChB,GAAwB,KAApBgqC,GAAOniD,EAAO,GAAW,OAC7BqnD,GAAW,EAEXxD,IADA6E,OAGKvwC,KAAO,CACZ,GAAkB,GAAduwC,EAAiB,OACrB,GAAa,KAATvwC,IAAJ,KAOAphB,EAAQT,EAAS,EACVA,EAAS,GAAK8rD,GAAKmB,GAAKprC,MAC7BphB,EAAgB,GAARA,EAAairD,GAAS7pC,IAAO,IACrCkvC,IACA/wD,IAEF,GAAa,KAAT6hB,IAAc,CAChB,GAAc,GAAV7hB,EAAa,OAEjB,GADA+wD,GAAW/wD,EACPoyD,EAAa,EAAG,WACpBL,EAAc,EACPlwC,KAAO,CAEZ,GADAmwC,EAAY,KACRD,EAAc,EAAG,CACnB,KAAa,KAATlwC,KAAgBkwC,EAAc,GAC7B,OADgChB,IAGvC,IAAKjF,GAAKe,GAAOhrC,KAAQ,YAClBiqC,GAAKe,GAAOhrC,MAAQ,CAEzB,GADAvR,EAASo7C,GAAS7pC,IAAO,IACP,OAAdmwC,EAAoBA,EAAY1hD,MAC/B,CAAA,GAAiB,GAAb0hD,EAAgB,OACpBA,EAAwB,GAAZA,EAAiB1hD,EAClC,GAAI0hD,EAAY,IAAK,OACrBjB,IAEFoB,EAAQC,GAAoC,IAAtBD,EAAQC,GAAoBJ,EAE/B,KADnBD,GACuC,GAAfA,GAAkBK,IAE5C,GAAmB,GAAfL,EAAkB,OACtB,MACK,GAAa,KAATlwC,KAET,GADAkvC,KACKlvC,IAAO,YACP,GAAIA,IAAO,OAClBswC,EAAQC,KAAgB3xD,MA3CxB,CACE,GAAiB,OAAb8sD,EAAmB,OACvBwD,IAEAxD,IADA6E,GA0CJ,GAAiB,OAAb7E,MACF0E,EAAQG,EAAa7E,EACrB6E,EAAa,EACQ,GAAdA,GAAmBH,EAAQ,GAChCC,EAAOC,EAAQC,GACfD,EAAQC,KAAgBD,EAAQ5E,EAAW0E,EAAQ,GACnDE,EAAQ5E,IAAa0E,GAASC,OAE3B,GAAkB,GAAdE,EAAiB,OAC5B,OAAOD,EAgjBME,CAAU9F,GAAY7iD,EAAO,GAAG,KACpCmC,EAAQ,MAtrBA,eAurBb7H,KAAKolB,KAAOvd,OAEP,GAAK7H,KAAKytD,YAQV,CAEL,GADA/nD,EAAQm9C,GAAQn9C,GACZoiD,GAAKoB,GAA2BxjD,GAAQ,MAnsB/B,eAqsBb,GADAmC,EAhrBU,SAAUnC,GACxB,IACI4oD,EAAaC,EAAS3hD,EAAO4hD,EAAMnd,EAAO/kC,EAAQmiD,EADlDC,EAAQpG,GAAM5iD,EAAO,KAMzB,GAJIgpD,EAAM1yD,QAAqC,IAA3B0yD,EAAMA,EAAM1yD,OAAS,IACvC0yD,EAAM1yD,UAERsyD,EAAcI,EAAM1yD,QACF,EAAG,OAAO0J,EAE5B,IADA6oD,EAAU,GACL3hD,EAAQ,EAAGA,EAAQ0hD,EAAa1hD,IAAS,CAE5C,GAAY,KADZ4hD,EAAOE,EAAM9hD,IACG,OAAOlH,EAMvB,GALA2rC,EAAQ,GACJmd,EAAKxyD,OAAS,GAAwB,KAAnB6rD,GAAO2G,EAAM,KAClCnd,EAAQyW,GAAKgB,GAAW0F,GAAQ,GAAK,EACrCA,EAAOjG,GAAYiG,EAAe,GAATnd,EAAa,EAAI,IAE/B,KAATmd,EACFliD,EAAS,MACJ,CACL,IAAKw7C,GAAc,IAATzW,EAAc2X,GAAe,GAAT3X,EAAa0X,GAAME,GAAKuF,GAAO,OAAO9oD,EACpE4G,EAASo7C,GAAS8G,EAAMnd,GAE1B8W,GAAKoG,EAASjiD,GAEhB,IAAKM,EAAQ,EAAGA,EAAQ0hD,EAAa1hD,IAEnC,GADAN,EAASiiD,EAAQ3hD,GACbA,GAAS0hD,EAAc,GACzB,GAAIhiD,GAAUs7C,GAAI,IAAK,EAAI0G,GAAc,OAAO,UAC3C,GAAIhiD,EAAS,IAAK,OAAO,KAGlC,IADAmiD,EAAOxG,GAAIsG,GACN3hD,EAAQ,EAAGA,EAAQ2hD,EAAQvyD,OAAQ4Q,IACtC6hD,GAAQF,EAAQ3hD,GAASg7C,GAAI,IAAK,EAAIh7C,GAExC,OAAO6hD,EA6oBME,CAAUjpD,GACJ,OAAXmC,EAAiB,MArsBR,eAssBb7H,KAAKolB,KAAOvd,MAbgB,CAC5B,GAAIigD,GAAKqB,GAA6CzjD,GAAQ,MA1rBjD,eA6rBb,IAFAmC,EAAS,GACTsyC,EAAasG,GAAU/6C,GAClBkH,EAAQ,EAAGA,EAAQutC,EAAWn+C,OAAQ4Q,IACzC/E,GAAUsiD,GAAchQ,EAAWvtC,GAAQm9C,IAE7C/pD,KAAKolB,KAAOvd,IAUhB+mD,+BAAgC,WAC9B,OAAQ5uD,KAAKolB,MAAQplB,KAAKwtD,kBAAmC,QAAfxtD,KAAKmtD,QAGrDO,oBAAqB,WACnB,MAAwB,IAAjB1tD,KAAK4/C,UAAmC,IAAjB5/C,KAAKotD,UAGrCK,UAAW,WACT,OAAO7mD,GAAOyjD,GAAgBrqD,KAAKmtD,SAGrCW,YAAa,WACX,IAAIR,EAAOttD,KAAKstD,KACZuB,EAAWvB,EAAKtxD,QAChB6yD,GAA4B,QAAf7uD,KAAKmtD,QAAgC,GAAZ0B,GAAkBjE,GAAqB0C,EAAK,IAAI,IACxFA,EAAKtxD,UAITmqD,UAAW,WACT,IAAI5pD,EAAMyD,KACNmtD,EAAS5wD,EAAI4wD,OACbvN,EAAWrjD,EAAIqjD,SACfwN,EAAW7wD,EAAI6wD,SACfhoC,EAAO7oB,EAAI6oB,KACXioC,EAAO9wD,EAAI8wD,KACXC,EAAO/wD,EAAI+wD,KACXtH,EAAQzpD,EAAIypD,MACZuH,EAAWhxD,EAAIgxD,SACftL,EAASkL,EAAS,IAYtB,OAXa,OAAT/nC,GACF68B,GAAU,KACN1lD,EAAImxD,wBACNzL,GAAUrC,GAAYwN,EAAW,IAAMA,EAAW,IAAM,KAE1DnL,GAAUqH,GAAclkC,GACX,OAATioC,IAAepL,GAAU,IAAMoL,IAChB,QAAVF,IAAkBlL,GAAU,MACvCA,GAAU1lD,EAAIixD,iBAAmBF,EAAK,GAAKA,EAAKtxD,OAAS,IAAM+rD,GAAKuF,EAAM,KAAO,GACnE,OAAVtH,IAAgB/D,GAAU,IAAM+D,GACnB,OAAbuH,IAAmBtL,GAAU,IAAMsL,GAChCtL,GAGT6M,QAAS,SAAUpP,GACjB,IAAIiN,EAAU3sD,KAAKR,MAAMkgD,GACzB,GAAIiN,EAAS,MAAMlF,GAAUkF,GAC7B3sD,KAAKw/C,aAAa/S,UAGpBsiB,UAAW,WACT,IAAI5B,EAASntD,KAAKmtD,OACdE,EAAOrtD,KAAKqtD,KAChB,GAAc,QAAVF,EAAkB,IACpB,OAAO,IAAI6B,GAAe7B,EAAOG,KAAK,IAAI2B,OAC1C,MAAO5uD,GACP,MAAO,OAET,MAAc,QAAV8sD,GAAqBntD,KAAKytD,YACvBN,EAAS,MAAQ7D,GAActpD,KAAKolB,OAAkB,OAATioC,EAAgB,IAAMA,EAAO,IAD/B,QAIpD6B,YAAa,WACX,OAAOlvD,KAAKmtD,OAAS,KAEvBgC,YAAa,SAAUhqC,GACrBnlB,KAAKR,MAAMiR,GAAU0U,GAAY,IAAK+lC,KAGxCkE,YAAa,WACX,OAAOpvD,KAAK4/C,UAEdyP,YAAa,SAAUzP,GACrB,IAAIzF,EAAasG,GAAUhwC,GAAUmvC,IACrC,IAAI5/C,KAAK4uD,iCAAT,CACA5uD,KAAK4/C,SAAW,GAChB,IAAK,IAAI7jD,EAAI,EAAGA,EAAIo+C,EAAWn+C,OAAQD,IACrCiE,KAAK4/C,UAAYuK,GAAchQ,EAAWp+C,GAAImuD,MAIlDoF,YAAa,WACX,OAAOtvD,KAAKotD,UAEdmC,YAAa,SAAUnC,GACrB,IAAIjT,EAAasG,GAAUhwC,GAAU28C,IACrC,IAAIptD,KAAK4uD,iCAAT,CACA5uD,KAAKotD,SAAW,GAChB,IAAK,IAAIrxD,EAAI,EAAGA,EAAIo+C,EAAWn+C,OAAQD,IACrCiE,KAAKotD,UAAYjD,GAAchQ,EAAWp+C,GAAImuD,MAIlDsF,QAAS,WACP,IAAIpqC,EAAOplB,KAAKolB,KACZioC,EAAOrtD,KAAKqtD,KAChB,OAAgB,OAATjoC,EAAgB,GACV,OAATioC,EAAgB/D,GAAclkC,GAC9BkkC,GAAclkC,GAAQ,IAAMioC,GAElCoC,QAAS,SAAUrqC,GACbplB,KAAKwtD,kBACTxtD,KAAKR,MAAM4lB,EAAMwmC,KAGnB8D,YAAa,WACX,IAAItqC,EAAOplB,KAAKolB,KAChB,OAAgB,OAATA,EAAgB,GAAKkkC,GAAclkC,IAE5CuqC,YAAa,SAAUC,GACjB5vD,KAAKwtD,kBACTxtD,KAAKR,MAAMowD,EAAU/D,KAGvBgE,QAAS,WACP,IAAIxC,EAAOrtD,KAAKqtD,KAChB,OAAgB,OAATA,EAAgB,GAAK58C,GAAU48C,IAExCyC,QAAS,SAAUzC,GACbrtD,KAAK4uD,mCAEG,KADZvB,EAAO58C,GAAU48C,IACDrtD,KAAKqtD,KAAO,KACvBrtD,KAAKR,MAAM6tD,EAAMvB,MAGxBiE,YAAa,WACX,IAAIzC,EAAOttD,KAAKstD,KAChB,OAAOttD,KAAKwtD,iBAAmBF,EAAK,GAAKA,EAAKtxD,OAAS,IAAM+rD,GAAKuF,EAAM,KAAO,IAEjF0C,YAAa,SAAUvQ,GACjBz/C,KAAKwtD,mBACTxtD,KAAKstD,KAAO,GACZttD,KAAKR,MAAMigD,EAAUyM,MAGvB+D,UAAW,WACT,IAAIjK,EAAQhmD,KAAKgmD,MACjB,OAAOA,EAAQ,IAAMA,EAAQ,IAE/BkK,UAAW,SAAUC,GAEL,KADdA,EAAS1/C,GAAU0/C,IAEjBnwD,KAAKgmD,MAAQ,MAET,KAAO6B,GAAOsI,EAAQ,KAAIA,EAAS5H,GAAY4H,EAAQ,IAC3DnwD,KAAKgmD,MAAQ,GACbhmD,KAAKR,MAAM2wD,EAAQ9D,KAErBrsD,KAAKw/C,aAAa/S,UAGpB2jB,gBAAiB,WACf,OAAOpwD,KAAKw/C,aAAa/0C,QAG3B4lD,QAAS,WACP,IAAI9C,EAAWvtD,KAAKutD,SACpB,OAAOA,EAAW,IAAMA,EAAW,IAErC+C,QAAS,SAAUzQ,GAEL,KADZA,EAAOpvC,GAAUovC,KAKb,KAAOgI,GAAOhI,EAAM,KAAIA,EAAO0I,GAAY1I,EAAM,IACrD7/C,KAAKutD,SAAW,GAChBvtD,KAAKR,MAAMqgD,EAAMyM,KALftsD,KAAKutD,SAAW,MAOpB9gB,OAAQ,WACNzsC,KAAKgmD,MAAQhmD,KAAKw/C,aAAa2G,aAAe,OAMlD,IAAI6I,GAAiB,SAAazyD,GAChC,IAAIyV,EAAOmQ,GAAWniB,KAAMuwD,IACxB9D,EAAOrtD,UAAUpD,OAAS,EAAIoD,UAAU,QAAK0D,EAC7CmH,EAAQm9C,GAAiBp1C,EAAM,IAAIu6C,GAAShwD,GAAK,EAAOkwD,IACvDvsD,IACH8R,EAAK0tC,KAAOz1C,EAAMk8C,YAClBn0C,EAAKi9C,OAAShlD,EAAM8kD,YACpB/8C,EAAKmT,SAAWlb,EAAMilD,cACtBl9C,EAAK4tC,SAAW31C,EAAMmlD,cACtBp9C,EAAKo7C,SAAWnjD,EAAMqlD,cACtBt9C,EAAKoT,KAAOnb,EAAMulD,UAClBx9C,EAAK49C,SAAW3lD,EAAMylD,cACtB19C,EAAKq7C,KAAOpjD,EAAM4lD,UAClB79C,EAAKytC,SAAWx1C,EAAM8lD,cACtB/9C,EAAKm+C,OAASlmD,EAAMgmD,YACpBj+C,EAAKwtC,aAAev1C,EAAMmmD,kBAC1Bp+C,EAAK6tC,KAAO51C,EAAMomD,YAIlBE,GAAevB,GAAeluD,UAE9B0vD,GAAqB,SAAU7wC,EAAQrH,GACzC,MAAO,CACL/X,IAAK,WACH,OAAO8mD,GAAoBrnD,MAAM2f,MAEnCpV,IAAK+N,GAAU,SAAU7b,GACvB,OAAO4qD,GAAoBrnD,MAAMsY,GAAQ7b,IAE3CkF,cAAc,EACdH,YAAY,IAyDhB,GArDItB,GAAWuwD,GACIF,GAAc,CAG7B7Q,KAAM8Q,GAAmB,YAAa,WAGtCvB,OAAQuB,GAAmB,aAG3BrrC,SAAUqrC,GAAmB,cAAe,eAG5C5Q,SAAU4Q,GAAmB,cAAe,eAG5CpD,SAAUoD,GAAmB,cAAe,eAG5CprC,KAAMorC,GAAmB,UAAW,WAGpCZ,SAAUY,GAAmB,cAAe,eAG5CnD,KAAMmD,GAAmB,UAAW,WAGpC/Q,SAAU+Q,GAAmB,cAAe,eAG5CL,OAAQK,GAAmB,YAAa,aAGxChR,aAAcgR,GAAmB,mBAGjC3Q,KAAM2Q,GAAmB,UAAW,aAMxC/kD,GAAS8kD,GAAc,UAAU,WAC/B,OAAOlJ,GAAoBrnD,MAAMmmD,cAChC,CAAE3kD,YAAY,IAIjBiK,GAAS8kD,GAAc,YAAY,WACjC,OAAOlJ,GAAoBrnD,MAAMmmD,cAChC,CAAE3kD,YAAY,IAEbgmD,GAAW,CACb,IAAIkJ,GAAwBlJ,GAAUmJ,gBAClCC,GAAwBpJ,GAAUqJ,gBAGlCH,IAAuBjlD,GAASujD,GAAgB,kBAAmBj9C,GAAK2+C,GAAuBlJ,KAG/FoJ,IAAuBnlD,GAASujD,GAAgB,kBAAmBj9C,GAAK6+C,GAAuBpJ,KOr/BrG,GPw/BAjwC,GAAey3C,GAAgB,OAE/B3/C,EAAE,CAAEK,QAAQ,EAAMI,QAASwvC,GAAgB36C,MAAOzE,GAAe,CAC/Dq/C,IAAKyP,KQ3gCP3/C,EAAE,CAAEjB,OAAQ,MAAO2F,OAAO,EAAMvS,YAAY,GAAQ,CAClDsvD,OAAQ,WACN,OAAO9vD,EAAKu+C,IAAIz+C,UAAUsB,SAAUpC,SCRvC,oBAAoB+wD,IAAI,IAAIC,EAAEp/C,MAAM9Q,UAAUjD,MAAMkD,KAAK3B,WAAW6c,EAAE7d,SAAS6yD,yBAAyBD,EAAE3wB,SAAQ,SAAS3hC,GAAG,IAAImxC,EAAEnxC,aAAawyD,KAAKj1C,EAAErd,YAAYixC,EAAEnxC,EAAEN,SAASqpB,eAAe/iB,OAAOhG,QAAOsB,KAAKpB,YAAYqd,GAAG,CAACk1C,QAAQrwD,UAAUswD,SAAStwD,UAAUuwD,iBAAiBvwD,WAAWu/B,SAAQ,SAAS3hC,GAAGA,EAAEiC,eAAe,WAAW7E,OAAOwE,eAAe5B,EAAE,SAAS,CAACiD,cAAY,EAAIH,YAAU,EAAII,UAAQ,EAAInF,MAAMs0D,OAAta,GFGK,aAAcI,QAAQrwD,WACxBhF,OAAOwE,eAAe6wD,QAAQrwD,UAAW,WAAY,CACjDrE,MAAO,SAAU4hB,EAAGC,GAChBte,KAAKsxD,WAAajzC,EAClBre,KAAKuxD,UAAYjzC,KAKvB,aAAc6yC,QAAQrwD,WACxBhF,OAAOwE,eAAe6wD,QAAQrwD,UAAW,WAAY,CACjDrE,MAAO,SAAU4hB,EAAGC,GAChBte,KAAKsxD,YAAcjzC,EACnBre,KAAKuxD,WAAajzC,OAMxB,iBAAkBxe,QACpB,IACIA,OAAqB,aAAI,CACrB0xD,QAAO,IAAQ,KACfC,QAAO,OACPC,WAAU,QAEhB,MAAOhzD,aG7BGizD,GAAaC,EAAYC,GACrC,MAAMhqD,EAASzJ,SAASC,cAAc,UAKtC,OAJIuzD,GAAKC,IACLhqD,EAAOiqD,MAAQF,EACf/pD,EAAOkqD,OAASF,GAEbhqD,ECJJ,MAAMmqD,GAAYC,UAAUC,UAAUljD,cAAcxB,QAAQ,YAAa,EAEnE2kD,GAA6B,WAEtC,IAAIA,EAA4C,KAYhD,OAXI/zD,SAAS0oD,KAAI,WAET,MAAM9hC,EAAQ,IAAIotC,MAAM,IACxBD,EAA4BntC,EAAMqtC,UAAY,KAHrC,GAMbvyD,OAAO6lB,iBAAiB,oBAAoB,SAASX,GACjDmtC,EAA4BntC,EAAMqtC,UAAY,QAI/C,WACH,GAAkC,OAA9BF,EACA,KAAM,4CAEV,OAAOA,GAlB2B,GAsB7BG,GAAqB,MAK9B,KAAM,eAAgBxyD,QAClB,OAAO,EAEX,IAAIyyD,EACJ,IACIA,EAAa,IAAIC,WAAW,aAC9B,MAAO9zD,GACL,OAAO,EAEX,MAAM,cAAe6zD,IAGbP,IAjBsB,GAoBrBS,KAAqB3yD,OAAO4yD,aAE5BC,GAAY,WAErB,MAAMC,EAAY,WACd,MAAMC,EAASlB,KACf,IAEI,OADAkB,EAAOC,WAAW,qBAAsB,CAAEC,oBAAoB,KACvD,EACT,MAAOr0D,GACL,OAAO,GANG,GAUlB,OAAO,WACH,OAAOk0D,GAbU,GAiBZI,GAAc,WACvB,MAAMC,EAAU,CACZC,QAAQ,EACRC,IAAI,GAQR,OALKrzD,OAAeozD,QAAWpzD,OAAeozD,OAAOE,MACjDH,EAAQC,QAAS,GAGrBD,EAAQE,GAAKR,KACN,WACH,OAAOpzD,KAAKC,MAAMD,KAAK8zD,UAAUJ,KAZd,GAgBdK,GAAwB,WACjC,IAAIzrD,EAAyB,cAEpBpH,IACL,MAAM2e,EAAMhhB,SAASC,cAAc,OACnC+gB,EAAIxJ,MAAM2b,SAAW,WACrBnS,EAAIxJ,MAAM29C,IAAM,IAChBn0C,EAAIxJ,MAAMkF,KAAO,iBACjB1c,SAAS0oD,KAAKloD,YAAYwgB,GAC1B0G,YAAW,WACPje,EAA4B,KAAnBuX,EAAIo0C,WACbp1D,SAAS0oD,KAAKjhC,YAAYzG,KAC3B,IAWP,OARIhhB,SAAS0oD,KACTrmD,IAEAX,OAAO6lB,iBAAiB,oBAAoB,WACxCllB,OAID,WACH,GAAe,OAAXoH,EACA,MAAM,IAAI1L,MAAM,wCAEpB,OAAO0L,GA3BsB,GC/E/B4rD,GAAkB,GASXC,GAAmB,SAAUC,EAAOp1D,EAAMq1D,EAAUloD,GACxD+mD,KACDl0D,EAAOA,EAAK/B,QAAQ,UAAW,UAE7B+B,KAAQk1D,KACVA,GAAgBl1D,GAAQ,IAE5Bk1D,GAAgBl1D,GAAM6H,KAAKwtD,GAC3BD,EAAMhuC,iBAAiBpnB,EAAMq1D,EAAUloD,IAG9BmoD,GAAsB,SAAUF,EAAOp1D,EAAMq1D,EAAUloD,GAIhE,GAHK+mD,KACDl0D,EAAOA,EAAK/B,QAAQ,UAAW,UAE/B+B,KAAQk1D,GACR,IAAK,IAAI13D,EAAI,EAAGA,EAAI03D,GAAgBl1D,GAAMvC,OAAQD,IAC1C03D,GAAgBl1D,GAAMxC,KAAO63D,IAC7BH,GAAgBl1D,GAAM2nC,OAAOnqC,EAAG,GAChCA,KAIZ43D,EAAMG,oBAAoBv1D,EAAMq1D,EAAUloD,aCP9BqoD,GAAK1mD,EAA8B2mD,GAC/C,MAAMC,EAASn4D,OAAOD,KAAKm4D,GAC3B,IAAIE,EACJ,MAAMt+C,EAASvI,EAAGuI,MAClB,IAAK,IAAI7Z,EAAI,EAAGA,EAAIk4D,EAAOj4D,OAAQD,IAC/Bm4D,EAASD,EAAOl4D,GAChB6Z,EAAMs+C,GAAUF,EAASE,GACzBt+C,EAAMu+C,aAAe,OACN,eAAXD,IACAt+C,EAAMw+C,iBAAmBJ,EAASE,aAmG9BG,GAAKjsD,EAAW4V,GAC5B,OAAOA,EAAIq2C,GAAIr2C,EAAG5V,EAAI4V,GAAK5V,WAGfksD,GAAQC,EAAmBC,GACvC,MAAMC,EAAIJ,GAAIE,EAAWC,GACzB,MAAO,CAACD,EAAYE,EAAGD,EAAcC,GC1IzC,MAAMC,GAAS,MAEX,MAAMC,EAAiB,CACnBC,MAAS,CAAC,IAAK,YACfC,IAAO,CAAC,MAAO,YACfnQ,MAAS,QACToQ,KAAQ,UACRC,IAAO,CAAC,OAAQ,WAAY,aAC5BxtC,MAAS,QACTytC,IAAO,SACPC,UAAa,YACbntB,OAAU,SACVotB,UAAa,IACbC,WAAc,IACd/sD,EAAK,CAAC,IAAK,KACX4V,EAAK,CAAC,IAAK,KACXoc,EAAK,CAAC,IAAK,KACX17B,EAAK,CAAC,IAAK,KACXk0B,EAAK,CAAC,IAAK,KACX6hC,EAAK,CAAC,IAAK,KACXjoC,EAAK,CAAC,IAAK,KACX4oC,EAAK,CAAC,IAAK,KACXvlB,EAAK,CAAC,IAAK,KACXR,EAAK,CAAC,IAAK,KACXhxB,EAAK,CAAC,IAAK,KACXC,EAAK,CAAC,IAAK,KACX+2C,EAAK,CAAC,IAAK,KACXC,KAAQ,IACRC,MAAS,IACTz6C,KAAQ,YACRC,MAAS,aACTy6C,GAAM,UACNC,KAAQ,YACRC,KAAQ,OACR55C,IAAO,OAGL65C,EAAiB75D,OAAOD,KAAK84D,GAC7BiB,EAAY,GACZC,EAAiB,GACvB,IAAIC,EAAW,GAEXC,EAAgB,GACpB,MAAMC,EAAc,GAEpB,IAAK,IAAIC,EAAI,EAAGA,EAAIN,EAAe35D,OAAQi6D,IAAK,CAC5CL,EAAUD,EAAeM,KAAM,EAG/B,MAAMr4C,EAAO+2C,EAAegB,EAAeM,IAC3C,GAAoB,iBAATr4C,EACPi4C,EAAelB,EAAegB,EAAeM,KAAON,EAAeM,QAEnE,IAAK,IAAIv3D,EAAI,EAAGA,EAAIkf,EAAK5hB,OAAQ0C,IAE7Bm3D,EAAej4C,EAAKlf,IAAMi3D,EAAeM,YAK5CC,EAAS9tD,EAAG4V,EAAGoc,EAAG+7B,GACvBH,EAAY31B,SAAQ1X,IACXA,EAAK,IAGVA,EAAK,GAAGvgB,EAAG4V,EAAGoc,EAAG+7B,eAIhBC,EAAOhuD,EAAG4V,EAAGoc,GAClB47B,EAAY31B,SAAQ1X,IACXA,EAAK,IAGVA,EAAK,GAAGvgB,EAAG4V,EAAGoc,eAabi8B,EAAQ33D,GACb,MAAMsH,EAAMtH,EAAEsH,IACR4X,EAAO,SAAUlf,EAAIA,EAAEkf,KAAOlf,EAAE43D,QAGtC,GAFAhuC,QAAQqR,IAAI/b,GAER5X,KAAO6vD,EAAgB,CACvB,MAAM3B,EAAS2B,EAAe7vD,GAC9B,GAAI4vD,EAAU1B,GAEV,YADAgC,EAAShC,EAAQx1D,EAAGo3D,EAAS/pD,KAAK,MAAM,GAG5C6pD,EAAU1B,IAAU,EACpB6B,EAAcn4C,GAAQs2C,EAGtB4B,EAAS1vD,KAAK8tD,GAEdgC,EAAShC,EAAQx1D,EAAGo3D,EAAS/pD,KAAK,gBAKjCwqD,EAAM73D,GACCA,EAAEsH,IAAd,MACM4X,EAAO,SAAUlf,EAAIA,EAAEkf,KAAOlf,EAAE43D,QAChCE,EAAcV,EAAS/pD,KAAK,KAIlC,GAAI,CACA,OAAQ,WAAY,YACpB,SAAU,WACZwB,SAASqQ,GACP64C,EAAK,WAIT,GAAI74C,KAAQm4C,GAAyC,OAAxBA,EAAcn4C,GAAgB,CACvD,MAAMs2C,EAAS6B,EAAcn4C,GAC7Bg4C,EAAU1B,IAAU,EACpB6B,EAAcn4C,GAAQ,KAGtB,IAAK,IAAI7hB,EAAI,EAAGA,EAAI+5D,EAAS95D,OAAQD,IAC7B+5D,EAAS/5D,IAAMm4D,IACf4B,EAAS5vB,OAAOnqC,EAAG,GACnBA,KAIRq6D,EAAOlC,EAAQx1D,EAAG83D,aAIjBC,EAAKzxC,GACV,MAAMwxC,EAAcV,EAAS/pD,KAAK,KAClC+pD,EAAW,GACXC,EAAgB,GAEhB,MAAMW,EAAW,GACjB,IAAK,IAAI36D,EAAI,EAAGA,EAAI45D,EAAe35D,OAAQD,IACnC65D,EAAUD,EAAe55D,MACzB65D,EAAUD,EAAe55D,KAAM,EAC/B26D,EAAStwD,KAAKuvD,EAAe55D,KAGrC,IAAK,IAAI46D,EAAI,EAAGA,EAAID,EAAS16D,OAAQ26D,IACjCP,EACIM,EAASC,GACT,CACIC,eAAgB,aAChBC,gBAAiB,cAErBL,GAjFRR,EAAY31B,SAAQ1X,IACXA,EAAK,IAGVA,EAAK,QAqFb,MAAO,CACHD,IAAMouC,IACF,GAAId,EAAYzoD,SAASupD,GACrB,OAEJ,MAAMzlC,EAA+B,IAAvB2kC,EAAYh6D,OAC1Bg6D,EAAY5vD,KAAK0wD,GAEbzlC,IACAqiC,GAAiBt1D,SAAU,UAAWi4D,GACtC3C,GAAiBt1D,SAAU,QAASm4D,GACpC7C,GAAiB5zD,OAAQ,OAAQ22D,KAGzCt4D,OAAS24D,IACL,IAAKd,EAAYzoD,SAASupD,GACtB,OAEJ,MAAMvvB,EAA8B,IAAvByuB,EAAYh6D,OACzB,IAAK,IAAID,EAAI,EAAGA,EAAIi6D,EAAYh6D,OAAQD,IACpC,GAAIi6D,EAAYj6D,KAAO+6D,EAAa,CAChCd,EAAY9vB,OAAOnqC,EAAG,GACtB,MAGJwrC,IACAssB,GAAoBz1D,SAAU,UAAWi4D,GACzCxC,GAAoBz1D,SAAU,QAASm4D,GACvC1C,GAAoB/zD,OAAQ,OAAQ22D,KAG5CM,UAAS,IACEnB,EAEXoB,SAAQ,IACGlB,IA3MJ,YCDCmB,GAAK7uD,EAAW4V,EAAW4U,GACvC,OAAOxqB,GAAK,EAAIwqB,GAAK5U,EAAI4U,WAGbskC,GAAMC,EAAYC,EAAYC,EAAYC,GACtD,OAAO35D,KAAKkhB,KAAKlhB,KAAK67B,IAAI29B,EAAKE,EAAI,GAAK15D,KAAK67B,IAAI49B,EAAKE,EAAI,aAa9CC,GAAkBC,EAAeC,GAC7C,OAAO95D,KAAK+5D,MAAMD,EAAGn5C,EAAIk5C,EAAGl5C,EAAGm5C,EAAGp5C,EAAIm5C,EAAGn5C,YAG7Bs5C,GAAkBH,EAAeC,GAC7C,OAAkC,IAA3BF,GAAiBC,EAAIC,GAAY95D,KAAKuvC,YAGjC0qB,GAAOC,EAAanrD,EAAaF,GAC7C,OAAOqrD,GAAOnrD,EACRA,EACAmrD,GAAOrrD,EACHA,EACAqrD,WAGEC,GAAQz5C,EAAWC,EAAWy5C,GAC1C,MAAMC,EAAQD,GAAOp6D,KAAKuvC,GAAK,KACzB+qB,EAAKt6D,KAAKu6D,IAAIF,GACdG,EAAKx6D,KAAKy6D,IAAIJ,GAEpB,MAAO,CACH35C,EAAGA,EAAI45C,EAAK35C,EAAI65C,EAChB75C,EAAGD,EAAI85C,EAAK75C,EAAI25C,GCrBxB,MAAMI,GAAe,SAAU3rB,GAC3B,MAEM4rB,EAAe,CAAC,KACtB,IAEIC,EAFAC,EAAiB,EACjBC,EAAe,KAEfC,EAAc,KACdnnC,EAAW,cAGNzF,EAAK61B,GACVjV,EAAS,CACLisB,OAAQh7D,KAAK4jC,MAAMogB,EAAQ8W,GAC3BG,MAAOrnC,EAASqnC,MAChBC,MAAOtnC,EAASsnC,MAChBC,QAASvnC,EAASunC,QAClBC,QAASxnC,EAASwnC,mBAIjBC,IACe,OAAhBN,IACA5sC,EAAK4sC,GACLA,EAAc,MAEG,OAAjBD,GAA2BH,EAAa/qD,SAASkrD,IACjDH,EAAalyD,KAAKqyD,GAEtBD,EAAiB,EACjBC,EAAe,KAInBz4D,KAAK6D,QAAU,SAAUmhB,GAErBuM,EAAW,CACPqnC,MAAO5zC,EAAM4zC,MACbC,MAAO7zC,EAAM6zC,MACbC,QAAS9zC,EAAM8zC,QACfC,QAAS/zC,EAAM+zC,SAGnBE,aAAaV,GACbA,EAAqBzyC,WAAWkzC,EA3CV,KA8CtB,IAAIrX,EAAQ38B,EAAM2zC,OACd,cAAe3zC,GAA6B,IAApBA,EAAMk0C,YAC9BvX,GAAS,IAAM,GAEnB,MAAMwX,EAAWx7D,KAAKghB,IAAIgjC,GAG1B,GAAI6W,EAAiB,GAAsB,OAAjBC,EAEtBC,EAAc,SAFlB,CAOA,GAAuB,IAAnBF,EAAsB,CAEtB,GADAA,IACIW,EAAW,GAEX,OAWJ,OARAV,EAAeU,OACXb,EAAa/qD,SAASkrD,GAEtB3sC,EAAK61B,GAGL+W,EAAc/W,GAMtB,GAAiB,IAAbwX,EAAJ,CAIA,GACIA,IAAaV,GACZU,EAAWV,EAAgB,EAAI,WAG7B,GAAKA,EAAeU,EAAY,EAAI,KAEvCV,EAAeU,OAEZ,GAAIA,IAAaV,EAIpB,OAFAA,EAAe,UACfC,EAAc,MAKE,OAAhBA,IACA5sC,EAAK4sC,GACLA,EAAc,MAElB5sC,EAAK61B,OA8DAyX,GAAmB,WAG5B,MAAMC,EAAa,GA2BnB,IAAIC,EAA4B,EAC5BC,EAA+B,KAC/BC,GAA8B,EAC9BC,EAA0B,EAE9B,OAAO,SAAUC,GACb,MAAMC,EAAgBD,EAAEtrD,OAClBwrD,EAAoBF,EAAEG,UACtBC,EAAkBJ,EAAEK,QACpBC,EAAuBN,EAAEO,aACzBC,EAAc,gBAAiBR,EAAIA,EAAEQ,YAAc,EACnDC,EAAe,CACjB,EAAK,OACL,EAAK,QACL,EAAK,UAEHC,EAAe,IAAI/B,IAAa,SAAUgC,GAC5C,IAAIC,GAGAR,EAAiB,CACjB,MAAMS,EAASZ,EAAca,wBAC7BH,EAAWI,KAAOJ,EAAWvB,QAAUyB,EAAOz/C,KAAO6+C,EAAcrI,WACnE+I,EAAWK,KAAOL,EAAWtB,QAAUwB,EAAOhH,IAAMoG,EAAcpI,UAClEuI,EAAgBO,OAGxB,IAAIC,GAAc,EAElB,MAAMK,EAAkBxI,KAA8B,GAAKyI,YAAYC,OAAOC,gBAI9E,IAAIC,EAAkB,GAClBC,GAAU,EAgBd,MAAMC,EAAa,GACbC,EAAmB,YAEhBC,EAAWC,GAChB,IAAK,IAAIr/D,EAAI,EAAGA,EAAIk/D,EAAWj/D,OAAQD,IACnC,GAAIq/D,IAAcH,EAAWl/D,GAAGq/D,UAC5B,OAAOH,EAAWl/D,GAG1B,OAAO,cAGFs/D,EAAcD,GACnB,IAAIE,EAAiB,KACrB,IAAK,IAAIv/D,EAAI,EAAGA,EAAIm/D,EAAiBl/D,OAAQD,IACrCm/D,EAAiBn/D,KAAOq/D,IACxBE,EAAiBL,EAAWl/D,GAC5Bk/D,EAAW/0B,OAAOnqC,EAAG,GACrBm/D,EAAiBh1B,OAAOnqC,EAAG,GAC3BA,KAGR,OAAOu/D,WAIFC,EAAkBC,EAAUj9D,GACjC,OAAiB,IAAbi9D,GAA+B,IAAbA,EACXA,GAQPlC,EAA4B,IAExBC,EAD8B,IAA9BD,EAC+BkC,EAEAvE,GAAIuE,EAAUjC,EAA8B,KAE/ED,KACQE,IACRA,GAA8B,EAE1BD,EAA+B,MAC/BE,EAA0B,MAK3B97D,KAAK67B,IAAIgiC,EAAU,EAAI/B,IAW/B,SACMgC,EAAoBz2C,GACzB,GAAIA,EAAM02C,UACN,OAAO12C,EAAM02C,UASjB,MAAMC,EAAe,CACjBP,UAAWp2C,EAAMo2C,UACjBQ,YAAa52C,EAAM42C,YACnBhD,MAAO5zC,EAAM4zC,MACbC,MAAO7zC,EAAM6zC,MACbC,QAAS9zC,EAAM8zC,QACfC,QAAS/zC,EAAM+zC,QACf8C,UAAW72C,EAAM62C,UACjBC,UAAW92C,EAAM82C,UACjBzJ,UAAWrtC,EAAMqtC,UAAYsI,EAC7Ba,SAAUD,EAAkBv2C,EAAMw2C,SAAUx2C,EAAMzmB,MAClDw9D,QAAS/2C,EAAM+2C,QACfC,OAAQh3C,EAAMg3C,OACdC,aAAc,GACdC,oBAAqB,WACjBl3C,EAAM4xC,kBAEVuF,qBAAsB,WAClBn3C,EAAM6xC,oBAGd7xC,EAAM02C,UAAYC,EAElB,IAAIS,EAAiB,KACjB,cAAep3C,EACX,aAAcA,GAA2B,IAAlBA,EAAM+2C,UAAkB,CAAC,SAASxuD,SAASyX,EAAM42C,cAAuC,UAAtB52C,EAAM42C,aAA8C,IAAnB52C,EAAMw2C,YAChIG,EAAaH,SAAW,EACxBY,EAAiB,IAGrBT,EAAaP,UAAY,EACzBO,EAAaC,YAAc,QAC3BD,EAAaH,SAA6B,IAAlBx2C,EAAM+2C,QAAgB,EAAI,EAClDK,EAAiBT,EAAaH,UAG9BxJ,IAAkC,SAArBhtC,EAAM42C,aAAyC,gBAAf52C,EAAMzmB,MAA4C,IAAlBymB,EAAM+2C,UACnFJ,EAAaI,QAAU,GAG3B,IAAIM,EAAoB,GACpB,uBAAwBr3C,IACxBq3C,EAAoBr3C,EAAMs3C,sBAM9B,IAAIC,WAvLQv3C,GAChB,IAAK,IAAIjpB,EAAIs9D,EAAWr9D,OAAS,EAAGD,GAAK,EAAGA,IACxC,GAAIipB,EAAMo2C,YAAc/B,EAAWt9D,GAAGq/D,UAClC,OAAO/B,EAAWt9D,GAG1B,OAAO,KAiLcygE,CAAWb,GACT,OAAfY,IACAA,WAxMQv3C,GAChB,MAAMu3C,EAAa,CACfnB,UAAWp2C,EAAMo2C,UACjBqB,UAAW,KACXC,UAAW,MAQf,OANArD,EAAWjzD,KAAKm2D,GAEZlD,EAAWr9D,OAAS,IACpBq9D,EAAW3U,QAGR6X,EA4LcI,CAAWhB,IAG5B,MAAMiB,EAAaL,EAAWE,UACxBI,EAAaN,EAAWG,UAE9B,IAAK,IAAI3gE,EAAI,EAAGA,EAAIsgE,EAAkBrgE,OAAQD,IAAK,CAC/C,MAAM+gE,EAAYT,EAAkBtgE,GAEpC4/D,EAAaM,aAAa71D,KAAK,CAC3BwyD,MAAOkE,EAAUlE,MACjBC,MAAOiE,EAAUjE,MACjBC,QAASgE,EAAUhE,QACnBC,QAAS+D,EAAU/D,QACnB8C,UAAoC,OAAzBU,EAAWE,UAAqB,EAAIK,EAAUlE,MAAQ2D,EAAWE,UAC5EX,UAAoC,OAAzBS,EAAWG,UAAqB,EAAII,EAAUjE,MAAQ0D,EAAWG,UAC5ErK,UAAmC,IAAxByK,EAAUzK,UAAkBsJ,EAAatJ,UAAayK,EAAUzK,UAAYsI,EACvFa,SAA6B,OAAnBY,EAA0Bb,EAAkBuB,EAAUtB,UAAYY,IAGhFG,EAAWE,UAAYK,EAAUlE,MACjC2D,EAAWG,UAAYI,EAAUjE,MAQrC,OALA0D,EAAWE,UAAYd,EAAa/C,MACpC2D,EAAWG,UAAYf,EAAa9C,MACpC8C,EAAaE,UAA2B,OAAfe,EAAsB,EAAIL,EAAWE,UAAYG,EAC1EjB,EAAaG,UAA2B,OAAfe,EAAsB,EAAIN,EAAWG,UAAYG,EAEnElB,EAWR,SACMoB,EAAsBC,EAASC,EAAgBC,GAEpD,MAAM3C,EAASZ,EAAca,wBACvB3yD,EAAc,CAChBtJ,KAAMy+D,EACN5B,UAAW6B,EAAe7B,UAC1BQ,YAAaqB,EAAerB,YAC5BhD,MAAOqE,EAAerE,MACtBC,MAAOoE,EAAepE,MACtBC,QAASmE,EAAenE,QACxBC,QAASkE,EAAelE,QACxB0B,KAAMwC,EAAenE,QAAUyB,EAAOz/C,KAAO6+C,EAAcrI,WAC3DoJ,KAAMuC,EAAelE,QAAUwB,EAAOhH,IAAMoG,EAAcpI,UAC1D4L,GAAIF,EAAepB,UACnBuB,GAAIH,EAAenB,UACnBuB,KAAMJ,EAAe5K,UACrB6J,oBAAqBe,EAAef,oBACpCC,qBAAsBc,EAAed,sBAGzC,GAAgB,gBAAZa,IACAn1D,EAAOo0D,aAAe,GAClBgB,EAAehB,aAAajgE,OAAS,GAAG,CACxC,IAAIshE,EACJ,IAAK,IAAIvhE,EAAI,EAAGA,EAAIkhE,EAAehB,aAAajgE,OAAQD,IACpDuhE,EAAgBL,EAAehB,aAAalgE,GAC5C8L,EAAOo0D,aAAa71D,KAAK,CACrBwyD,MAAO0E,EAAc1E,MACrBC,MAAOyE,EAAczE,MACrBC,QAASwE,EAAcxE,QACvBC,QAASuE,EAAcvE,QACvB0B,KAAM6C,EAAcxE,QAAUyB,EAAOz/C,KAAO6+C,EAAcrI,WAC1DoJ,KAAM4C,EAAcvE,QAAUwB,EAAOhH,IAAMoG,EAAcpI,UACzD4L,GAAIG,EAAczB,UAClBuB,GAAIE,EAAcxB,UAClBuB,KAAMC,EAAcjL,YAMpC,GAAI6K,EAAQ,CACR,MAAMjJ,EAASn4D,OAAOD,KAAKqhE,GAC3B,IAAK,IAAInhE,EAAI,EAAGA,EAAIk4D,EAAOj4D,OAAQD,IAC/B8L,EAAOosD,EAAOl4D,IAAMmhE,EAAOjJ,EAAOl4D,IAI1C,OAAO8L,EAWR,SACM01D,EAAoBP,EAASQ,EAAeC,EAAYP,GAC7D,MAAM3C,EAASZ,EAAca,wBACvB3yD,EAAc,CAChBtJ,KAAMy+D,EACN5B,UAAWoC,EAAcE,WACzB9B,YAAa,QACbhD,MAAO4E,EAAc5E,MACrBC,MAAO2E,EAAc3E,MACrBC,QAAS0E,EAAc1E,QACvBC,QAASyE,EAAczE,QACvB0B,KAAM+C,EAAc5E,MAAQ2B,EAAOz/C,KAAO6+C,EAAcrI,WACxDoJ,KAAM8C,EAAc3E,MAAQ0B,EAAOhH,IAAMoG,EAAcpI,UACvD8L,KAAMI,EAAWpL,UAAYsI,EAC7BuB,oBAAqB,WAAauB,EAAW7G,kBAC7CuF,qBAAsB,WAAasB,EAAW5G,oBAGlC,gBAAZmG,IACAn1D,EAAOo0D,aAAe,IAG1B,MAAMhI,EAASn4D,OAAOD,KAAKqhE,GAC3B,IAAK,IAAInhE,EAAI,EAAGA,EAAIk4D,EAAOj4D,OAAQD,IAC/B8L,EAAOosD,EAAOl4D,IAAMmhE,EAAOjJ,EAAOl4D,IAGtC,OAAO8L,WASF81D,IACL9J,GAAoBz1D,SAAU,cAAew/D,GAC7C/J,GAAoBz1D,SAAU,YAAay/D,GAC3ChK,GAAoBz1D,SAAU,eAAgB0/D,GAGlD,IAmPIC,EACAC,EACAC,EArPAC,EAAgB,WACXC,IACLD,IACIlE,GACAA,GAAqB,YAIpBoE,IACLF,IACIlE,GACAA,GAAqB,YAIpBqE,EAAcr5C,GACnBA,EAAQy2C,EAAoBz2C,GAE5B,MAAMs5C,EAAsBvD,EAG5B,GAFAA,EAAkB/1C,EAAM42C,YAEpBV,EAAiB3tD,SAASyX,EAAMo2C,YAAcF,EAAiBl/D,SAAWk+D,GAAqC,UAAtBl1C,EAAM42C,YAE/F,YADAZ,GAAU,GAKd,IAAKA,GAAiC,UAAtBh2C,EAAM42C,aAAmD,QAAxB0C,EAE7C,YADAtD,GAAU,GAGdA,GAAU,EAEV,MAAMuD,EAAWxB,EAAsB,cAAe/3C,GACtD40C,EAAkB2E,YAIbC,EAAcx5C,GAInB,GAFAA,EAAQy2C,EAAoBz2C,GAExBk2C,EAAiB3tD,SAASyX,EAAMo2C,YAAcF,EAAiBl/D,SAAWk+D,IAAiB,CAAC,EAAG,EAAG,GAAG3sD,SAASyX,EAAM+2C,SAEpH,OAKsB,IAAtBd,EAAWj/D,SA5Df03D,GAAiBt1D,SAAU,cAAew/D,GAC1ClK,GAAiBt1D,SAAU,YAAay/D,GACxCnK,GAAiBt1D,SAAU,eAAgB0/D,IA6D3C,MAAMW,EAAU,CACZrD,UAAWp2C,EAAMo2C,UACjBQ,YAAa52C,EAAM42C,YACnB8C,UAAW15C,EAAM4zC,MACjB+F,UAAW35C,EAAM6zC,MACjBkD,QAAS/2C,EAAM+2C,QACfU,UAAWz3C,EAAM4zC,MACjB8D,UAAW13C,EAAM6zC,MACjB+F,cAAe55C,EAAMqtC,WAEzB4I,EAAW70D,KAAKq4D,GAChBI,EAAgBJ,GAChBvD,EAAiB90D,KAAK4e,EAAMo2C,WAE5B,MAAMmD,EAAWxB,EAAsB,cAAe/3C,EAAO,CACzD05C,UAAW15C,EAAM4zC,MACjB+F,UAAW35C,EAAM6zC,MACjBmD,OAAQ7B,EAAan1C,EAAM+2C,SAC3BP,SAAUx2C,EAAMw2C,WAGpB5B,EAAkB2E,YAIbX,EAAoB54C,GAIzB,GAFAA,EAAQy2C,EAAoBz2C,IAEtBk2C,EAAiB3tD,SAASyX,EAAMo2C,WAClC,OAGJ,MAAMqD,EAAUtD,EAAWn2C,EAAMo2C,WAIjC,GAHA0D,EAAkBL,GAGdz5C,EAAM+2C,UAAY0C,EAAQ1C,QAAS,CAIT,IAAtBd,EAAWj/D,QACX2hE,IAEJtC,EAAcr2C,EAAMo2C,WAEpB,MAAMmD,EAAWxB,EAAsB,YAAa/3C,EAAO,CACvD05C,UAAWD,EAAQC,UACnBC,UAAWF,EAAQE,YAGvB,YADA/E,EAAkB2E,GAQtB,GAHAM,EAAgBJ,GAIU,QAAtBz5C,EAAM42C,aACN52C,EAAM4zC,QAAU6F,EAAQhC,WACxBz3C,EAAM6zC,QAAU4F,EAAQ/B,WACxB13C,EAAMqtC,YAAcoM,EAAQG,cAG5B,OAGJ,MAAML,EAAWxB,EAAsB,cAAe/3C,EAAO,CACzD05C,UAAWD,EAAQC,UACnBC,UAAWF,EAAQE,UACnB3C,OAAQ7B,EAAan1C,EAAM+2C,SAC3BP,SAAUx2C,EAAMw2C,WAGpBiD,EAAQhC,UAAYz3C,EAAM4zC,MAC1B6F,EAAQ/B,UAAY13C,EAAM6zC,MAC1B4F,EAAQG,cAAgB55C,EAAMqtC,UAE9BuH,EAAkB2E,YAIbV,EAAkB74C,GAIvB,GAFAA,EAAQy2C,EAAoBz2C,IAEtBk2C,EAAiB3tD,SAASyX,EAAMo2C,WAClC,OAIsB,IAAtBH,EAAWj/D,QACX2hE,IAEJ,MAAMc,EAAUpD,EAAcr2C,EAAMo2C,WACpC0D,EAAkBL,GAElB,MAAMF,EAAWxB,EAAsB,YAAa/3C,EAAO,CACvD05C,UAAWD,EAAQC,UACnBC,UAAWF,EAAQE,YAEvB/E,EAAkB2E,YAIbT,EAAqB94C,GAI1B,GAFAA,EAAQy2C,EAAoBz2C,IAEtBk2C,EAAiB3tD,SAASyX,EAAMo2C,WAClC,OAIsB,IAAtBH,EAAWj/D,QACX2hE,IAEJ,MAAMc,EAAUpD,EAAcr2C,EAAMo2C,WACpC0D,EAAkBL,GAElB,MAAMF,EAAWxB,EAAsB,YAAa/3C,EAAO,CACvD05C,UAAWD,EAAQC,UACnBC,UAAWF,EAAQE,YAEvB/E,EAAkB2E,YAmCbM,EAAgBJ,GACO,UAAxBA,EAAQ7C,cAGZ6C,EAAQM,aAAej5C,YAAW,YA3BpC,SACsB24C,GAmBpBZ,EAhBkB,CACdzC,UAAWqD,EAAQrD,UACnBQ,YAAa6C,EAAQ7C,YACrBr9D,KAAM,YACN8zD,UAAWuI,YAAYr1C,MACvBqzC,MAAO,EACPC,MAAO,EACPC,QAAS,EACTC,QAAS,EACTnC,eAAgB,aAEhBC,gBAAiB,eAajBmI,CAAeP,KAChB,gBAGEK,EAAkBL,GAClBA,EAAQM,eAGb9F,aAAawF,EAAQM,cACrBN,EAAQM,aAAe,MAIvB/E,IACAtG,GAAiBiG,EAAe,eAAgBwE,GAChDzK,GAAiBiG,EAAe,eAAgByE,IAEhDxE,IACAlG,GAAiBiG,EAAe,cAAe0E,GAC/C3K,GAAiBiG,EAAe,cAAe6E,IAE/C1E,GACApG,GAAiBiG,EAAe,QAASS,EAAav2D,SASpD4uD,GA2GKiH,EAAEuF,cAETjB,EAAc,SAASt/D,GACnBA,EAAEk4D,kBAENlD,GAAiBiG,EAAe,YAAaqE,KA9G7CD,EAAe,SAAU/4C,GAErBA,EAAM4xC,iBAEN,MAAMsI,EAAWl6C,EAAMm6C,eACvB,IAAK,IAAIpjE,EAAI,EAAGA,EAAImjE,EAASljE,QAAUi/D,EAAWj/D,OAASk+D,EAAan+D,IAAK,CACzE,MAAMqjE,EAAWF,EAASnjE,GAGA,IAAtBk/D,EAAWj/D,SACX03D,GAAiBt1D,SAAU,YAAa4/D,GACxCtK,GAAiBt1D,SAAU,WAAY6/D,GACvCvK,GAAiBt1D,SAAU,cAAe6/D,IAE9ChD,EAAW70D,KAAK,CACZg1D,UAAWgE,EAAS1B,WACpBgB,UAAWU,EAASxG,MACpB+F,UAAWS,EAASvG,MACpBkD,QAAS,EACTU,UAAW2C,EAASxG,MACpB8D,UAAW0C,EAASvG,QAExBqC,EAAiB90D,KAAKg5D,EAAS1B,YAE/B,MAAMa,EAAWhB,EAAoB,cAAe6B,EAAUp6C,EAAO,CACjEm4C,GAAI,EACJC,GAAI,EACJsB,UAAWU,EAASV,UACpBC,UAAWS,EAAST,UACpB3C,OAAQ,OACRR,SAAU,IAEd5B,EAAkB2E,KAK1BP,EAAc,SAAUh5C,GACpBA,EAAM4xC,iBAGN,MAAMsI,EAAWl6C,EAAMm6C,eACvB,IAAK,IAAIpjE,EAAI,EAAGA,EAAImjE,EAASljE,OAAQD,IAAK,CACtC,MAAMqjE,EAAWF,EAASnjE,GAE1B,IAAMm/D,EAAiB3tD,SAAS6xD,EAAS1B,YACrC,SAEJ,MAAMe,EAAUtD,EAAWiE,EAAS1B,YAE9Ba,EAAWhB,EAAoB,cAAe6B,EAAUp6C,EAAO,CACjEm4C,GAAIiC,EAASxG,MAAQ6F,EAAQhC,UAC7BW,GAAIgC,EAASvG,MAAQ4F,EAAQ/B,UAC7BgC,UAAWD,EAAQC,UACnBC,UAAWF,EAAQE,UACnB3C,OAAQ,OACRqD,aAAa,EACb7D,SAAU,IAEdiD,EAAQhC,UAAY2C,EAASxG,MAC7B6F,EAAQ/B,UAAY0C,EAASvG,MAC7Be,EAAkB2E,KAM1BN,EAAa,SAAUj5C,GACA,gBAAfA,EAAMzmB,MACNymB,EAAM4xC,iBAIV,MAAMsI,EAAWl6C,EAAMm6C,eACvB,IAAK,IAAIpjE,EAAI,EAAGA,EAAImjE,EAASljE,OAAQD,IAAK,CACtC,MAAMqjE,EAAWF,EAASnjE,GAE1B,IAAMm/D,EAAiB3tD,SAAS6xD,EAAS1B,YACrC,SAIsB,IAAtBzC,EAAWj/D,SACX63D,GAAoBz1D,SAAU,YAAa4/D,GAC3CnK,GAAoBz1D,SAAU,WAAY6/D,GAC1CpK,GAAoBz1D,SAAU,cAAe6/D,IAEjD,MAAMQ,EAAUpD,EAAc+D,EAAS1B,YAEjCa,EAAWhB,EAAoB,YAAa6B,EAAUp6C,EAAO,CAC/Dm4C,GAAIiC,EAASxG,MAAQ6F,EAAQhC,UAC7BW,GAAIgC,EAASvG,MAAQ4F,EAAQ/B,UAC7BgC,UAAWD,EAAQC,UACnBC,UAAWF,EAAQE,YAGvB/E,EAAkB2E,KAKtB3E,GACAlG,GAAiBiG,EAAe,aAAcoE,IAetD/9D,KAAKs/D,OAAS,WACV,OAAOpB,EAAgB,GAG3Bl+D,KAAKu/D,QAAU,WACPjF,IAGJA,GAAc,EACdzG,GAAoB8F,EAAe,eAAgBwE,GACnDtK,GAAoB8F,EAAe,eAAgByE,GACnDvK,GAAoB8F,EAAe,cAAe0E,GAClDxK,GAAoB8F,EAAe,cAAe6E,GAClD3K,GAAoB8F,EAAe,QAASS,EAAav2D,SACrDo3D,EAAWj/D,OAAS,GACpB2hE,IAGElL,GAQFoB,GAAoB8F,EAAe,YAAaqE,IAPhDnK,GAAoB8F,EAAe,aAAcoE,GAC7C9C,EAAWj/D,OAAS,IACpB63D,GAAoBz1D,SAAU,YAAa4/D,GAC3CnK,GAAoBz1D,SAAU,WAAY6/D,GAC1CpK,GAAoBz1D,SAAU,cAAe6/D,QAjuBjC,ibCzKzB,MAAMuB,GAAa,SAAU9F,GAEhC,MAAM+F,EAAW/F,EAAE+F,SACnB,IAAIC,EAAQ,gBAEHC,EAAc5jE,EAAGipB,GACtB,KAAOjpB,EAAI0jE,EAASzjE,OAAQD,IAExB,GAAc,QADdipB,EAAQy6C,EAAS1jE,GAAG6jE,QAAQ56C,IAExB,OAAO,KAIf,OADA06C,EAAS16C,GACF,KAGX,IAAK,IAAIixC,EAAI,EAAGA,EAAIwJ,EAASzjE,OAAQi6D,KAAC,SACvBl6D,GACP0jE,EAAS1jE,GAAG8jE,aAAY,SAAU76C,GAC9B26C,EAAc5jE,EAAI,EAAGipB,MAHK,CAK/BixC,GAKPj2D,KAAK4/D,QAAU,SAAU56C,GACrB,OAAO26C,EAAc,EAAG36C,IAE5BhlB,KAAK6/D,YAAc,SAAUt6D,GACzBm6D,EAAWn6D,IAoBNu6D,GAAe,SAAUpG,GAElC,IAAIgG,EAAyB,aAU7B,IAAIK,EAAwB,CAAC,QAAS,QAAS,OAC3CC,EAAmB,CAAC,QAEpBC,EAAc,GAClB,MAAMC,EAAoB,GAC1B,IAAIC,EAAa,EACbC,EAAU,EAEVC,EAAgB,YAGXp1C,IACL,GAA2B,IAAvBg1C,EAAYjkE,OAAhB,CAGAi9D,aAAaqH,EAAWr1C,MACxBguC,aAAaqH,EAAWC,oBACxBtH,aAAaqH,EAAWE,SACxBF,EAAWr1C,KAAO,KAClBq1C,EAAWC,mBAAqB,KAChCD,EAAWE,QAAU,KAGrB,IAAK,IAAIzkE,EAAI,EAAGA,EAAIskE,EAAcrkE,OAAQD,IACtC2jE,EAASW,EAActkE,IAE3BskE,EAAgB,GAEhBJ,EAAc,aAITO,IACLF,EAAWr1C,KAAO,KAClBq1C,EAAWE,QAAU,KACrBH,EAAgB,GAChB,MAAMI,EAAmBR,EAAYA,EAAYjkE,OAAS,GAC1DikE,EAAc,GACdvG,EAAEgH,YAAY,CAAC9H,MAAO6H,EAAiB7H,MAAOC,MAAO4H,EAAiB5H,QAI1E,MAAMyH,EAAa,CACfr1C,KAAM,KACNs1C,mBAAoB,KACpBC,QAAS,eAIJG,EAAaC,EAAYC,EAAYC,GAC1C,MAAMC,EAAOD,EAASV,EAEtB,QAAIW,GAAQ,KAGZT,EAAWM,GAAc96C,WAAW+6C,EAAYE,IACzC,GA0JX/gE,KAAK4/D,QAAU,SAAU56C,GAIrB,OAxJD,SACmBA,GAElB,GAAmB,gBAAfA,EAAMzmB,KACN2hE,EAAkB95D,KAAK4e,EAAMo2C,gBAC1B,GAAmB,cAAfp2C,EAAMzmB,KACb,IAAK,IAAIxC,EAAI,EAAGA,EAAImkE,EAAkBlkE,OAAQD,IAC1C,GAAImkE,EAAkBnkE,KAAOipB,EAAMo2C,UAAW,CAC1C8E,EAAkBh6B,OAAOnqC,EAAG,GAC5B,MAKZ,IAAKgkE,EAAsBxyD,SAASyX,EAAM42C,aAGtC,YADA3wC,IAIJm1C,EAAUxF,YAAYr1C,MACtB,MAAMk7C,EAAmBR,EAAYjkE,OAAS,EAAIikE,EAAYA,EAAYjkE,OAAS,GAAK,KAKxF,GAJmB,cAAfgpB,EAAMzmB,OACN4hE,EAAan7C,EAAMq4C,MAGJ,gBAAfr4C,EAAMzmB,KAAwB,CAC9B,GAAI2hE,EAAkBlkE,OAAS,EAG3B,YADAivB,IAGJ,GAA2B,OAAvBq1C,EAAWE,QAGX,YADAv1C,IAGJ,GAA2B,IAAvBg1C,EAAYjkE,QAAgBokE,EAAUD,EA3Gf,IA8GvB,YADAl1C,IAGJ,IAAK+0C,EAAiBzyD,SAASyX,EAAMg3C,QAGjC,YADA/wC,IAGJ,GAAIw1C,GAAoBA,EAAiBO,QAAUf,EAAYjkE,OAAS,EAGpE,YADAivB,IAGJ,GAAIw1C,GACiBvJ,GAAKuJ,EAAiBlvC,SAAS,GAAIkvC,EAAiBlvC,SAAS,GAAIvM,EAAM4zC,MAAO5zC,EAAM6zC,OAxHlF,KA2Hf5tC,IAEIm1C,EAAUK,EAAiBpD,KAhIZ,KAiIf,OAYZ,GARA4C,EAAY75D,KAAK,CACb46D,QAAQ,EACR3D,KAAM+C,EACN7uC,SAAU,CAACvM,EAAM4zC,MAAO5zC,EAAM6zC,OAC9BuC,UAAWp2C,EAAMo2C,YAIjB6E,EAAYjkE,OAAS,EACrBi9D,aAAaqH,EAAWC,yBACrB,IAAKI,EAAa,qBAAsB11C,EAAMjG,EAAMq4C,KA1I9B,KA6IzB,YADApyC,IAMJ,GADAguC,aAAaqH,EAAWr1C,OACnB01C,EAAa,OAAQ11C,EAAMjG,EAAMq4C,KAtJjB,KAyJjB,YADApyC,IAIR,GAAIw1C,GAAmC,gBAAfz7C,EAAMzmB,MAA0BkiE,EAAiBrF,YAAcp2C,EAAMo2C,WAMxElE,GAAKuJ,EAAiBlvC,SAAS,GAAIkvC,EAAiBlvC,SAAS,GAAIvM,EAAM4zC,MAAO5zC,EAAM6zC,OAjKhF,GAqKjB,YADA5tC,IAIR,GAAIw1C,GAAmC,cAAfz7C,EAAMzmB,KAAsB,CAChD,GAAIkiE,EAAiBrF,YAAcp2C,EAAMo2C,UAErC,YADAnwC,IAGJ,GAAIm1C,GAAWK,EAAiBpD,KA9KX,IAgLjB,YADApyC,IAKJ,GAFAguC,aAAaqH,EAAWr1C,MAEpBg1C,EAAYjkE,OAAS,EACrB,OAAK2kE,EAAa,OAAQ11C,EAAMjG,EAAMq4C,KAlLtB,UAuLhB4C,EAAc,CACVQ,EACA,CACIQ,MAAM,EACN5D,KAAM+C,EACN7uC,SAAU,CAACvM,EAAM4zC,MAAO5zC,EAAM6zC,eATlC5tC,IAeJm1C,EAAUH,EAAY,GAAG5C,KAlMT,KAqMhB4C,EAAY75D,KAAK,CACbwyD,MAAO5zC,EAAM4zC,MACbC,MAAO7zC,EAAM6zC,QAEZ8H,EAAa,UAAWH,EAASx7C,EAAMq4C,KAvM9B,MAwMVpyC,KAGJA,KAWRi2C,CAAal8C,GAEc,IAAvBi7C,EAAYjkE,QACZivB,IACOjG,IAGXq7C,EAAcj6D,KAAK4e,GACZ,OAGXhlB,KAAK6/D,YAAc,SAAUt6D,GACzBm6D,EAAWn6D,GAGfvF,KAAKmhE,yBAA2B,SAAUC,GACtCrB,EAAwBqB,GAG5BphE,KAAKqhE,oBAAsB,SAAUD,GACjCpB,EAAmBoB,IAmBdE,GAAgB,SAAU5H,GAEnC,MAAM6H,EAAU7H,EAAE6H,QAClB,IAAI7B,EAAyB,aAmB7B,IACI8B,EADAC,EAAY,GAEZpB,EAAgB,GAChBqB,EAAgB,EACpB,MAAMxB,EAAoB,YAEjBj1C,IACL,GAA6B,IAAzBo1C,EAAcrkE,OAAlB,CAGAi9D,aAAaqH,EAAWqB,sBACxB1I,aAAaqH,EAAWsB,YACxB,IAAK,IAAI7lE,EAAI,EAAGA,EAAIskE,EAAcrkE,OAAQD,IACtC2jE,EAASW,EAActkE,IAE3BskE,EAAgB,GAChBoB,EAAY,IAWhB,IAAIrB,EACJ,MAAME,EAAa,CACfqB,qBAAsB,KACtBC,WAAY,eAGPjB,EAAaC,EAAYE,GAC9B,MAAMC,EAAOD,EAASV,EAEtB,QAAIW,GAAQ,KAGZT,EAAWM,GAAc96C,WAAWmF,EAAM81C,IACnC,YAGFG,EAAal8C,GAElB,MAAM68C,EAAoBH,EAG1B,GAFAA,EAAgB18C,EAAMq4C,KAEH,gBAAfr4C,EAAMzmB,KACN2hE,EAAkB95D,KAAK4e,EAAMo2C,gBAC1B,GAAmB,cAAfp2C,EAAMzmB,KACb,IAAK,IAAIxC,EAAI,EAAGA,EAAImkE,EAAkBlkE,OAAQD,IAC1C,GAAImkE,EAAkBnkE,KAAOipB,EAAMo2C,UAAW,CAC1C8E,EAAkBh6B,OAAOnqC,EAAG,GAC5B,MAKZ,GAA0B,UAAtBipB,EAAM42C,YAAV,CASA,GAFAwE,EAAUxF,YAAYr1C,MAEH,gBAAfP,EAAMzmB,KAEN,OAAIkjE,EAAUzlE,OAAS,IAAMkkE,EAAkBlkE,QAI3CylE,EAAUzlE,SAAWulE,GAKrBE,EAAUzlE,OAAS,GAAKgpB,EAAMq4C,KA7FT,IA6F2CoE,EAAU,GAAGK,UAKxD,IAArBL,EAAUzlE,QAAgBgpB,EAAMq4C,KApGT,GAoG6CwE,OAbpE52C,IAmBqB,IAArBw2C,EAAUzlE,SACVwlE,EAAgBx8C,EAAMq4C,KAEjBsD,EAAa,uBAAwB37C,EAAMq4C,KA3G3B,MA2GgEsD,EAAa,aAAc37C,EAAMq4C,KA5GjH,WAkHToE,EAAUr7D,KAAK,CACXg1D,UAAWp2C,EAAMo2C,UACjB0G,SAAU98C,EAAMq4C,KAChBqB,UAAW15C,EAAM4zC,MACjB+F,UAAW35C,EAAM6zC,aATb5tC,IAeZ,GAAmB,gBAAfjG,EAAMzmB,KAAwB,CAE9B,GAAyB,IAArBkjE,EAAUzlE,OAEV,OAGJ,IAAI+lE,EAAY,KAChB,IAAK,IAAIhmE,EAAI,EAAGA,EAAI0lE,EAAUzlE,OAAQD,IAClC,GAAI0lE,EAAU1lE,GAAGq/D,YAAcp2C,EAAMo2C,UAAW,CAC5C2G,EAAYN,EAAU1lE,GACtB,MAGR,GAAkB,OAAdgmE,EAEA,YADA92C,IAIJ,GAAIjG,EAAMq4C,KA/ID,IA+ImBmE,EAGxB,YADAv2C,IAKJ,GADiBisC,GAAKlyC,EAAM4zC,MAAO5zC,EAAM6zC,MAAOkJ,EAAUrD,UAAWqD,EAAUpD,WAnJ1D,GAuJjB,YADA1zC,IAMR,GAAmB,cAAfjG,EAAMzmB,KAAsB,CAE5B,GAAyB,IAArBkjE,EAAUzlE,OAEV,OAIJ,GAAIylE,EAAUzlE,SAAWulE,EAGrB,YADAt2C,IAIJ,IAAI82C,EAAY,KACZhmE,EAAI,EACR,KAAOA,EAAI0lE,EAAUzlE,OAAQD,IACzB,GAAI0lE,EAAU1lE,GAAGq/D,YAAcp2C,EAAMo2C,UAAW,CAC5C2G,EAAYN,EAAU1lE,GACtB,MAGR,GAAkB,OAAdgmE,EAEA,OAGJ,GAAI/8C,EAAMq4C,KAzLD,IAyLmBmE,EAGxB,YADAv2C,IAKJ,GADiBisC,GAAKlyC,EAAM4zC,MAAO5zC,EAAM6zC,MAAOkJ,EAAUrD,UAAWqD,EAAUpD,WA7L1D,GAkMjB,YADA1zC,IAIJ82C,EAAUd,MAAO,EAEjB,IAAIe,GAAW,EACf,IAAK,IAAIrL,EAAI,EAAGA,EAAI8K,EAAUzlE,OAAQ26D,IAClC,IAAK8K,EAAU9K,GAAGsK,KAAM,CACpBe,GAAW,EACX,MAKR,GAAIA,EAEA,OAjLR/I,aAAaqH,EAAWqB,sBACxB1I,aAAaqH,EAAWsB,YACxBvB,EAAgB,GAChBoB,EAAY,GACZ/H,EAAEuI,SA6Ka,QAzIPR,EAAUzlE,OAAS,GACnBivB,IAmJZjrB,KAAK4/D,QAAU,SAAU56C,GAMrB,OAAe,IAJAk8C,EAAal8C,GAMjB,KAEc,IAArBy8C,EAAUzlE,OACHgpB,GAEPq7C,EAAcj6D,KAAK4e,GAGhB,OAIXhlB,KAAK6/D,YAAc,SAAUt6D,GACzBm6D,EAAWn6D,IA6BN28D,GAAc,SAAUxI,GAKjC,IAAIgG,EAAyB,aAE7B,MAAMQ,EAAoB,GAc1B,IAwBIE,EAxBA+B,EAAa,KACb9B,EAAgB,YAGXvkD,IACLqmD,EAAa,KACb9B,EAAgB,YAGXp1C,EAAKm3C,GACV,GAAKD,EAAL,CAKA,GADAlJ,aAAaqH,EAAW+B,sBACnBD,EACD,IAAK,IAAIrmE,EAAI,EAAGA,EAAIskE,EAAcrkE,OAAQD,IACtC2jE,EAASW,EAActkE,IAG/B+f,KAKJ,MAAMwkD,EAAa,CACf+B,oBAAqB,eAahBnB,EAAal8C,GAElB,GAAmB,gBAAfA,EAAMzmB,KACN2hE,EAAkB95D,KAAK4e,EAAMo2C,gBAE1B,GAAmB,cAAfp2C,EAAMzmB,KACb,IAAK,IAAIxC,EAAI,EAAGA,EAAImkE,EAAkBlkE,OAAQD,IAC1C,GAAImkE,EAAkBnkE,KAAOipB,EAAMo2C,UAAW,CAC1C8E,EAAkBh6B,OAAOnqC,EAAG,GAC5B,MAMZ,GACKomE,KACyB,UAAtBn9C,EAAM42C,aACU,gBAAf52C,EAAMzmB,MAA0B2hE,EAAkBlkE,OAAS,GAC5DkkE,EAAkBlkE,OAAS,GACZ,cAAfgpB,EAAMzmB,MALd,CAeA,GAJA6hE,EAAUxF,YAAYr1C,MAIH,gBAAfP,EAAMzmB,KAEN,OAAI4jE,EAC0B,UAAtBn9C,EAAM42C,aAENuG,EAAWG,gBAAgBl8D,KAAK,CAC5Bg1D,UAAWp2C,EAAMo2C,UACjBX,KAAMz1C,EAAMy1C,KACZC,KAAM11C,EAAM01C,YAGZyH,EAAWI,aACXC,EAAcL,EAAY,CACtB5jE,KAAM,OACNqO,MAAOu1D,EAAWG,gBAAgBtmE,OAAS,KAG/Ci9D,aAAaqH,EAAW+B,qBACxBF,EAAWI,cAAe,EAC1BE,EAAWN,WAMXA,EAAWI,aACXJ,EAAWO,kBAAkBt8D,KAAK4e,EAAMo2C,WAExCnwC,MAQRk3C,EAAa,CACTG,gBAAiB,CAAC,CACdlH,UAAWp2C,EAAMo2C,UACjBX,KAAMz1C,EAAMy1C,KACZC,KAAM11C,EAAM01C,KACZiI,SAAU39C,EAAMy1C,KAChBmI,SAAU59C,EAAM01C,OAEpBgI,kBAAmB,GACnBH,cAAc,YArFR3B,EAAYC,EAAYC,GAC1C,MAAMC,EAAOD,EAASV,EACtB,QAAIW,GAAQ,IAGZT,EAAWM,GAAc96C,WAAW+6C,EAAYE,GACzC,IAiFMJ,CAAa,uBAAuB,WACrC11C,MACDjG,EAAMq4C,KAxIe,UA4IxB,OAHIpyC,KAUZ,GAAmB,gBAAfjG,EAAMzmB,MAAgD,UAAtBymB,EAAM42C,aAsC1C,GAAmB,cAAf52C,EAAMzmB,KAAsB,CAG5B,GAA0B,UAAtBymB,EAAM42C,YAAyB,CAC/B,IAAI7/D,EAAI,EACR,KAAOA,EAAIomE,EAAWG,gBAAgBtmE,OAAQD,IAC1C,GAAIomE,EAAWG,gBAAgBvmE,GAAGq/D,YAAcp2C,EAAMo2C,UAAW,CAC7D+G,EAAWG,gBAAgBp8B,OAAOnqC,EAAG,GACrC,MAGJomE,EAAWG,gBAAgBtmE,OAAS,GACpCwmE,EAAcL,EAAY,CACtB5jE,KAAM,KACNqO,MAAO7Q,SAKf,IAAK,IAAIA,EAAI,EAAGA,EAAIomE,EAAWO,kBAAkB1mE,OAAQD,IACrD,GAAIomE,EAAWO,kBAAkB3mE,KAAOipB,EAAMo2C,UAAW,CACrD+G,EAAWO,kBAAkBx8B,OAAOnqC,EAAG,GACvC,MAMZ,GAA0C,IAAtComE,EAAWG,gBAAgBtmE,QAAwD,IAAxCmmE,EAAWO,kBAAkB1mE,OAOxE,YANImmE,EAAWI,cACXzmD,IACA+mD,KAEA53C,UAvEZ,CAGI,IAAI63C,EAAkB,KAClB/mE,EAAI,EACR,KAAOA,EAAIomE,EAAWG,gBAAgBtmE,OAAQD,IAC1C,GAAIipB,EAAMo2C,YAAc+G,EAAWG,gBAAgBvmE,GAAGq/D,UAAW,CAC7D0H,EAAkBX,EAAWG,gBAAgBvmE,GAC7C,MASR,GAHA+mE,EAAgBrI,KAAOz1C,EAAMy1C,KAC7BqI,EAAgBpI,KAAO11C,EAAM01C,KAExByH,EAAWI,aAQRxmE,EAAI,GACJymE,EAAcL,EAAY,CACtB5jE,KAAM,OACNqO,MAAO7Q,QAXW,CAE1B,GADiBm7D,GAAK4L,EAAgBH,SAAUG,EAAgBF,SAAUE,EAAgBrI,KAAMqI,EAAgBpI,MAtK3F,GAyKjB,YADAzvC,OAgEhB,IAAI83C,EAAa,YAERN,EAAWO,GAEhB,IAAK,IAAIjnE,EAAI,EAAGA,EAAIinE,EAAWV,gBAAgBtmE,OAAQD,IAAK,CACxD,MAAMwgE,EAAayG,EAAWV,gBAAgBvmE,GAC9CgnE,EAAW38D,KAAK,CACZg1D,UAAWmB,EAAWnB,UACtBX,KAAM8B,EAAW9B,KACjBC,KAAM6B,EAAW7B,KACjBiI,SAAUpG,EAAW9B,KACrBmI,SAAUrG,EAAW7B,OAI7B,MAAM11C,EAAa,CACfzmB,KAAM,OACN0kE,SAAU,EACV11B,MAAO,GAGe,IAAtBw1B,EAAW/mE,QACXgpB,EAAMy1C,KAAOsI,EAAW,GAAGJ,SAC3B39C,EAAM01C,KAAOqI,EAAW,GAAGH,WAE3B59C,EAAMy1C,KAAO,IAAOsI,EAAW,GAAGJ,SAAWI,EAAW,GAAGJ,UAC3D39C,EAAM01C,KAAO,IAAOqI,EAAW,GAAGH,SAAWG,EAAW,GAAGH,WAE/D59C,EAAM29C,SAAW39C,EAAMy1C,KACvBz1C,EAAM49C,SAAW59C,EAAM01C,KAEvBhB,EAAEwJ,QAAQl+C,YAKLw9C,EAAcQ,EAAYG,GAE/B,KAAIA,EAAUv2D,MAAQ,GAItB,GAAuB,SAAnBu2D,EAAU5kE,KAAiB,CAE3B,IAAIymB,EAIJ,GAHA+9C,EAAWI,EAAUv2D,OAAO6tD,KAAOuI,EAAWV,gBAAgBa,EAAUv2D,OAAO6tD,KAC/EsI,EAAWI,EAAUv2D,OAAO8tD,KAAOsI,EAAWV,gBAAgBa,EAAUv2D,OAAO8tD,KAErD,IAAtBqI,EAAW/mE,OAEXgpB,EAAQ,CACJzmB,KAAM,OACNokE,SAAUI,EAAW,GAAGJ,SACxBC,SAAUG,EAAW,GAAGH,SACxBnI,KAAMsI,EAAW,GAAGtI,KACpBC,KAAMqI,EAAW,GAAGrI,KACpBuI,SAAU,EACV11B,MAAO,OAGR,CAEH,MAAM61B,EAAYlM,GAAK6L,EAAW,GAAGJ,SAAUI,EAAW,GAAGH,SAAUG,EAAW,GAAGJ,SAAUI,EAAW,GAAGH,UACvGS,EAAWnM,GAAK6L,EAAW,GAAGtI,KAAMsI,EAAW,GAAGrI,KAAMqI,EAAW,GAAGtI,KAAMsI,EAAW,GAAGrI,MAE1F4I,EAAa/L,GAAiB,CAChCl5C,EAAG0kD,EAAW,GAAGJ,SACjBrkD,EAAGykD,EAAW,GAAGH,UAClB,CAACvkD,EAAG0kD,EAAW,GAAGJ,SAAUrkD,EAAGykD,EAAW,GAAGH,WAC1CW,EAAQhM,GAAiB,CAC3Bl5C,EAAG0kD,EAAW,GAAGtI,KACjBn8C,EAAGykD,EAAW,GAAGrI,MAClB,CAACr8C,EAAG0kD,EAAW,GAAGtI,KAAMn8C,EAAGykD,EAAW,GAAGrI,OAE5C11C,EAAQ,CACJzmB,KAAM,OACNokE,SAAU,IAAOI,EAAW,GAAGJ,SAAWI,EAAW,GAAGJ,UACxDC,SAAU,IAAOG,EAAW,GAAGH,SAAWG,EAAW,GAAGH,UACxDnI,KAAM,IAAOsI,EAAW,GAAGtI,KAAOsI,EAAW,GAAGtI,MAChDC,KAAM,IAAOqI,EAAW,GAAGrI,KAAOqI,EAAW,GAAGrI,MAChDuI,SAAUM,EAAQD,EAClB/1B,MAAO81B,EAAWD,GAK1B1J,EAAEwJ,QAAQl+C,OAEgB,SAAnBm+C,EAAU5kE,MAAsC,OAAnB4kE,EAAU5kE,OAC9CskE,IACAJ,EAAWO,aAKVH,IACLE,EAAa,GACbrJ,EAAEwJ,QAAQ,CACN3kE,KAAM,QAOdyB,KAAK4/D,QAAU,SAAU56C,GAErB,OADAk8C,EAAal8C,GACTm9C,GACKA,EAAWI,cACZlC,EAAcj6D,KAAK4e,GAKpB,MAFIA,GAKfhlB,KAAK6/D,YAAc,SAAUt6D,GACzBm6D,EAAWn6D,IAUNi+D,GAAoB,WAE7B,IAAI9D,EAAyB,aAK7B1/D,KAAK4/D,QAAU,SAAU56C,GAErB,GAAmB,gBAAfA,EAAMzmB,KAiCN,OAAOymB,EA/BP,KAAIA,EAAMi3C,aAAajgE,OAAS,GA4B5B,OAAOgpB,EA5BwB,CAE/B,IAEIs4C,EAFAmG,EAAYlkE,KAAKC,MAAMD,KAAK8zD,UAAUruC,IAC1Cy+C,EAAUxH,aAAe,GAGzB,IAAK,IAAIlgE,EAAI,EAAGA,EAAIipB,EAAMi3C,aAAajgE,OAAQD,IAEvCA,EAAI,IACJ0nE,EAAYlkE,KAAKC,MAAMD,KAAK8zD,UAAUruC,KAE1Cs4C,EAAgBt4C,EAAMi3C,aAAalgE,GAEnC0nE,EAAU7K,MAAQ0E,EAAc1E,MAChC6K,EAAU5K,MAAQyE,EAAczE,MAChC4K,EAAUhJ,KAAO6C,EAAc7C,KAC/BgJ,EAAU/I,KAAO4C,EAAc5C,KAC/B+I,EAAUtG,GAAKG,EAAcH,GAC7BsG,EAAUrG,GAAKE,EAAcF,GAC7BqG,EAAUpG,KAAOC,EAAcD,KAC3BthE,EAAIipB,EAAMi3C,aAAajgE,OAAS,IAChCynE,EAAUpE,aAAc,GAG5BK,EAAS+D,GAUrB,OAAO,MAGXzjE,KAAK6/D,YAAc,SAAUt6D,GACzBm6D,EAAWn6D,IAINm+D,GAAoB,SAAUC,GAEvC,IAAIjE,EAAyB,aAGzBkE,EAAgB,KACpB,MAAMC,EAAqB,GAK3B7jE,KAAK4/D,QAAU,SAAU56C,GAErB,GAAI6+C,EAAmBt2D,SAASyX,EAAMo2C,WAAY,CAC9C,GAAmB,cAAfp2C,EAAMzmB,KACN,IAAK,IAAIxC,EAAI,EAAGA,EAAI8nE,EAAmB7nE,OAAQD,IAC3C,GAAI8nE,EAAmB9nE,KAAOipB,EAAMo2C,UAAW,CAC3CyI,EAAmB39B,OAAOnqC,EAAG,GAC7B,MAIZ,OAAO,KAGX,OAAsB,OAAlB6nE,GACmB,gBAAf5+C,EAAMzmB,OACNqlE,EAAgB5+C,EAAMo2C,WAEnBp2C,GAGHA,EAAMo2C,YAAcwI,GACD,gBAAf5+C,EAAMzmB,MACNslE,EAAmBz9D,KAAK4e,EAAMo2C,WAE3B,OAEQ,cAAfp2C,EAAMzmB,OACNqlE,EAAgB,MAEb5+C,IAOfhlB,KAAK6/D,YAAc,SAAUt6D,GACdA,IAgCNu+D,GAAoB,SAAUpK,GAEvC,IAAIqK,EAAY,KACZC,EAAa,GACbC,EAAY,KAGhBjkE,KAAK6D,QAAU,SAAUmhB,GACrB,GAAmB,SAAfA,EAAMzmB,OACNwlE,EAAY/+C,EACZi/C,EAAY,KAERj/C,EAAMk/C,gBAaN,OAXAxK,EAAEyK,OAAO,CACL5lE,KAAM,OACNuwC,GAAI,KACJE,GAAI,KACJo1B,UAAW,KACXr1B,GAAI/pB,EAAM3G,EACV4wB,GAAIjqB,EAAM1G,EACV+lD,UAAWr/C,EAAMw2C,gBAGrBwI,EAAW59D,KAAK4e,GAMxB,GAAmB,SAAfA,EAAMzmB,KAEN,GAAIymB,EAAMk/C,eAAgB,CAEtB,GAAkB,OAAdD,EAAoB,CACpB,MAAM9G,EAAKx/D,KAAKghB,IAAIqG,EAAM3G,EAAI0lD,EAAU1lD,GAClC++C,EAAKz/D,KAAKghB,IAAIqG,EAAM1G,EAAIylD,EAAUzlD,GAExC,GAAI6+C,EAAK,GAAKC,EAAK,EAAG,CAClB6G,EAAY9G,EAAKC,EAlCvB,EAAW,EAoCL,IAAK,IAAIrhE,EAAI,EAAGA,EAAIioE,EAAWhoE,OAAQD,IAAK,CACxC,MAAM2C,EAAIslE,EAAWjoE,GArC/B,IAsCckoE,EACAvlE,EAAE4f,EAAIylD,EAAUzlD,EAEhB5f,EAAE2f,EAAI0lD,EAAU1lD,EAEpBq7C,EAAEyK,OAAO5kE,KAAKC,MAAMD,KAAK8zD,UAAU30D,KAEvCslE,EAAa,IAIrB,GAAkB,OAAdC,EAEA,YADAD,EAAW59D,KAAK4e,GAlDlB,IAsDEi/C,EACAj/C,EAAM1G,EAAIylD,EAAUzlD,EAEpB0G,EAAM3G,EAAI0lD,EAAU1lD,OAIxB,GAAI2lD,EAAWhoE,OAAS,EAAG,CACvB,IAAK,IAAID,EAAI,EAAGA,EAAIioE,EAAWhoE,OAAQD,IACnC29D,EAAEyK,OAAO5kE,KAAKC,MAAMD,KAAK8zD,UAAU2Q,EAAWjoE,MAElDioE,EAAa,GAMN,OAAfh/C,EAAMzmB,OACNylE,EAAa,IAGjBtK,EAAEyK,OAAO5kE,KAAKC,MAAMD,KAAK8zD,UAAUruC,OAY9Bs/C,GAAgB,WAEzB,IAAI5E,EAAyB,aAGzB6E,GAAY,EAGhBvkE,KAAK4/D,QAAU,SAAU56C,GAerB,MAbmB,SAAfA,EAAMzmB,OACFgmE,EAEA7E,EAAS,CACLnhE,KAAM,KACNgvC,MAAOvoB,EAAMuoB,MACb22B,eAAgBl/C,EAAMk/C,eACtB7E,aAAa,IAGjBkF,GAAY,GAGfA,GAA6B,SAAfv/C,EAAMzmB,MAAkC,OAAfymB,EAAMzmB,MAK/B,OAAfymB,EAAMzmB,MAAiBgmE,IACvBA,GAAY,GAGTv/C,GAPI,MASfhlB,KAAK6/D,YAAc,SAAUt6D,GACzBm6D,EAAWn6D,GAEfvF,KAAKwkE,aAAe,WAChB,OAAOD,IAoBFE,GAAgB,SAAU/K,GAEnC,IAGIgL,EACAC,EACAC,EALAlF,EAAyB,aAEzBmF,EAAYjN,GAAM8B,EAAEmL,UAAW,EAAG,GAOtC7kE,KAAK4/D,QAAU,SAAU56C,GAarB,GAZAA,EAAQzlB,KAAKC,MAAMD,KAAK8zD,UAAUruC,IAClCi0C,aAAa2L,GACbE,cAAcH,GAEK,SAAf3/C,EAAMzmB,OACNmmE,EAAiB,CACbrmD,EAAG2G,EAAM3G,EACTC,EAAG0G,EAAM1G,EACTk9C,SAAUx2C,EAAMw2C,WAIL,SAAfx2C,EAAMzmB,KAAiB,CAEvB,MAAMwmE,EAAS//C,EAAM3G,EACf2mD,EAAShgD,EAAM1G,EACf2mD,EAAgBjgD,EAAMw2C,SAE5Bx2C,EAAM3G,EAAI44C,GAAIjyC,EAAM3G,EAAGqmD,EAAermD,EAAGwmD,GACzC7/C,EAAM1G,EAAI24C,GAAIjyC,EAAM1G,EAAGomD,EAAepmD,EAAGumD,GACzC7/C,EAAMw2C,SAAWvE,GAAIjyC,EAAMw2C,SAAUkJ,EAAelJ,SAAUqJ,GAC9DH,EAAiB,CACbrmD,EAAG2G,EAAM3G,EACTC,EAAG0G,EAAM1G,EACTk9C,SAAUx2C,EAAMw2C,UAGhBqJ,EAAY,IACZD,EAAU9+C,YAAW,WACjB6+C,EAAWO,aAAY,YACnBlgD,EAAQzlB,KAAKC,MAAMD,KAAK8zD,UAAUruC,KAE5B3G,EAAI44C,GAAI8N,EAAQL,EAAermD,EAAGwmD,GACxC7/C,EAAM1G,EAAI24C,GAAI+N,EAAQN,EAAepmD,EAAGumD,GACxC7/C,EAAMw2C,SAAWvE,GAAIgO,EAAeP,EAAelJ,SAAUqJ,GAC7DH,EAAiB,CACbrmD,EAAG2G,EAAM3G,EACTC,EAAG0G,EAAM1G,EACTk9C,SAAUx2C,EAAMw2C,UAGpBkE,EAAS16C,KACV,MACJ,KAKX,OAAOA,GAGXhlB,KAAK6/D,YAAc,SAAUt6D,GACzBm6D,EAAWn6D,GAGfvF,KAAKmlE,aAAe,SAAU/P,GAC1ByP,EAAYjN,GAAMxC,EAAG,EAAG,KCvpCzB,MAAMgQ,GAAsB,SAAS5zC,GACxC,MAAMqhC,EAASlB,KACf,IAAI0T,EACJ,GAAI7zC,EAAO,EAAG,CAIV,GAHAqhC,EAAOf,MAAQ,EACfe,EAAOd,OAAS,EAChBsT,EAAMxS,EAAOC,WAAW,OACnBuS,EACD,MAAM,IAAIlpE,MAAM,0DAEpBkpE,EAAIC,UAAY,qBAChBD,EAAIE,SAAS,EAAG,EAAG,EAAG,QACnB,GAAI/zC,EAAO,IACdqhC,EAAOf,MAAQ,IACfe,EAAOd,OAAS,QACb,CAIH,GAHAc,EAAOf,MAAe,EAAPtgC,EACfqhC,EAAOd,OAAgB,EAAPvgC,EAChB6zC,EAAMxS,EAAOC,WAAW,OACnBuS,EACD,MAAM,IAAIlpE,MAAM,0DAEpBkpE,EAAIC,UAAY,qBAChBD,EAAIE,SAAS,EAAG,EAAU,EAAP/zC,EAAiB,EAAPA,GAC7B6zC,EAAIC,UAAY,qBAChBD,EAAIE,SAAS,EAAG,EAAG/zC,EAAMA,GACzB6zC,EAAIE,SAAS/zC,EAAMA,EAAa,EAAPA,EAAiB,EAAPA,GAEvC,OAAOqhC,GAGE2S,GAAwB,WACjC,MAAMtmE,EAAoB,CACtB,EAAK,qKACL,EAAK,0JAGT,OAAO,SAAUumE,EAAc/4B,YAClBv2B,EAAOqb,GAEZ,GADAA,EAAOqf,SAAS,GAAKrf,GACjBtyB,EAAM,GAAKsyB,GACX,OAAOtyB,EAAM,GAAKsyB,GAEtB,MACM3pB,EADSu9D,GAAoB5zC,GACbk0C,UAAU,aAEhC,OADAxmE,EAAM,GAAKsyB,GAAQ3pB,EACZA,EAGX,IAAI6kC,EAKA,OAAOv2B,EAAOsvD,GAJd3/C,YAAW,WACP4mB,EAASv2B,EAAOsvD,MACjB,IArBsB,GCvL9B,MAAME,GAAU,oBAQRC,EAAqBC,EAAQ5rB,GAOpC,MANe,CACVA,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,IAC7F5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,IAC7F5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,IAAQ5rB,EAAM,GAAK4rB,EAAO,IAC9F5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,GAAO5rB,EAAM,GAAK4rB,EAAO,IAAQ5rB,EAAM,GAAK4rB,EAAO,KAyDvG,MAAO,CACHC,YAAa,WACT,MAAO,CACH,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,IAGjBF,uBAAwBA,EACxBG,0BA7DsBC,EAASC,GAG/B,MAAMC,EAAO,CAACD,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,IACpDE,EAAO,CAACF,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,IACpDG,EAAO,CAACH,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,IAAKA,EAAQ,KACrDI,EAAO,CAACJ,EAAQ,IAAKA,EAAQ,IAAKA,EAAQ,IAAKA,EAAQ,KAGvDK,EAAUV,EAAuBI,EAASE,GAC1CK,EAAUX,EAAuBI,EAASG,GAC1CK,EAAUZ,EAAuBI,EAASI,GAC1CK,EAAUb,EAAuBI,EAASK,GAGhD,MAAO,CACHC,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAC5CC,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAC5CC,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAC5CC,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,GAAIA,EAAQ,KA2ChDC,iCAvC6BroD,EAAGC,GAChC,MAAO,CACH,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACTD,EAAGC,EAAG,EAAG,IAmCbqoD,8BA/B0B1D,GAE1B,MAAO,CACHtlE,KAAKu6D,KAAK+K,IAAYtlE,KAAKy6D,KAAK6K,GAAW,EAAG,EAC9CtlE,KAAKy6D,KAAK6K,GAAWtlE,KAAKu6D,KAAK+K,GAAW,EAAG,EAC7C,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,IA0Bb2D,2BAtBuBh0C,GACvB,MAAO,CACHA,EAAG,EAAG,EAAG,EACT,EAAGA,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,KAlEE,GCEVi0C,GAAO,CAChBn+C,IAAK,SAAU8uC,EAAeC,GAC1B,MAAO,CAACp5C,EAAGm5C,EAAGn5C,EAAIo5C,EAAGp5C,EAAGC,EAAGk5C,EAAGl5C,EAAIm5C,EAAGn5C,IAEzCwoD,IAAK,SAAUtP,EAAeC,GAC1B,MAAO,CAACp5C,EAAGm5C,EAAGn5C,EAAIo5C,EAAGp5C,EAAGC,EAAGk5C,EAAGl5C,EAAIm5C,EAAGn5C,IAEzCyoD,IAAK,SAAUrN,GACX,MAAM70B,EAAMlnC,KAAKkhB,KAAKlhB,KAAK67B,IAAIkgC,EAAEr7C,EAAG,GAAK1gB,KAAK67B,IAAIkgC,EAAEp7C,EAAG,IACvD,MAAO,CAACD,EAAGq7C,EAAEr7C,EAAIwmB,EAAKvmB,EAAGo7C,EAAEp7C,EAAIumB,IAEnCA,IAAK,SAAU60B,GACX,OAAO/7D,KAAKkhB,KAAKlhB,KAAK67B,IAAIkgC,EAAEr7C,EAAG,GAAK1gB,KAAK67B,IAAIkgC,EAAEp7C,EAAG,KAEtD0oD,KAAM,SAAUxP,EAAeC,GAC3B,OAAOoP,GAAKhiC,IAAIgiC,GAAKC,IAAItP,EAAIC,KAEjCwP,IAAK,SAAUvN,EAActE,GACzB,MAAO,CAAC/2C,EAAGq7C,EAAEr7C,EAAI+2C,EAAG92C,EAAGo7C,EAAEp7C,EAAI82C,IAEjCmO,MAAO,SAAU/L,EAAeC,GAC5B,OAAO95D,KAAK+5D,MAAMD,EAAGn5C,EAAIk5C,EAAGl5C,EAAGm5C,EAAGp5C,EAAIm5C,EAAGn5C,IAE7C6oD,IAAK,SAAS9+D,EAAc4V,GACxB,MAAMmpD,EAAO,CAAC/+D,EAAEiW,EAAGjW,EAAEkW,GACf8oD,EAAO,CAACppD,EAAEK,EAAGL,EAAEM,GACrB,OAAO6oD,EAAK7mC,KAAG,CAAEjiB,EAAGtiB,IAAMorE,EAAKprE,GAAKqrE,EAAKrrE,KAAIqf,QAAM,CAAErd,EAAGke,IAAMle,EAAIke,MCgB7DorD,GAAY,SAAU5hB,GAC/B,MAAM6hB,EAAa,GACbC,EAAQvnE,KAEd,IAAK,IAAIi2D,EAAI,EAAGA,EAAIxQ,EAAO+hB,OAAOxrE,OAAQi6D,KAAC,SAC5Bl6D,GACP,IAAIC,EACAD,EAAI0pD,EAAO+hB,OAAOxrE,OAAS,IAC3BA,EAASk7D,GAAKzR,EAAO+hB,OAAOzrE,GAAGsiB,EAAGonC,EAAO+hB,OAAOzrE,GAAGuiB,EAAGmnC,EAAO+hB,OAAOzrE,EAAI,GAAGsiB,EAAGonC,EAAO+hB,OAAOzrE,EAAI,GAAGuiB,IAEvGgpD,EAAWvrE,GAAK,CACZsiB,EAAGonC,EAAO+hB,OAAOzrE,GAAGsiB,EACpBC,EAAGmnC,EAAO+hB,OAAOzrE,GAAGuiB,EACpBtiB,OAAQA,GATuB,CAWpCi6D,GAOPj2D,KAAKynE,UAAY,SAAUT,GACvB,IAAIU,EAAY/pE,KAAK+O,IAAI66D,EAAMI,YAAaX,GACxCjrE,EAAI,EAER,KAAO2rE,EAAYJ,EAAWvrE,GAAGC,QAAUD,EAAIurE,EAAWtrE,OAAS,EAAGD,IAClE2rE,GAAaJ,EAAWvrE,GAAGC,OAG/B,MAAM4rE,EAAMjqE,KAAK+O,IAAI,EAAG/O,KAAK6O,IAAI,EAAGk7D,EAAYJ,EAAWvrE,GAAGC,SAE9D,MAAO,CACHqiB,EAAIipD,EAAWvrE,GAAGsiB,GAAK,EAAIupD,GAAON,EAAWvrE,EAAI,GAAGsiB,EAAIupD,EACxDtpD,EAAIgpD,EAAWvrE,GAAGuiB,GAAK,EAAIspD,GAAON,EAAWvrE,EAAI,GAAGuiB,EAAIspD,IAGhE5nE,KAAK2nE,UAAY,WACb,IAAI9/D,EAAS,EACb,IAAK,IAAI9L,EAAI,EAAGA,EAAIurE,EAAWtrE,OAAS,EAAGD,IACvC8L,GAAUy/D,EAAWvrE,GAAGC,OAE5B,OAAO6L,IA6JFggE,GAAqB,SAAUL,GACxC,MAAMvrD,EAAIurD,EAAOxrE,OAKjB,IAAID,EAJJiE,KAAK8nE,GAAK,GACV9nE,KAAK+nE,GAAK,GACV/nE,KAAKqvC,EAAI,GACTrvC,KAAKgoE,GAAK,GAGV,MAAM32C,EAAQm2C,EAAO,GAAG,GAClBjgC,EAAOigC,EAAOA,EAAOxrE,OAAS,GAAG,GAKvC,IAHAwrE,EAAOlqD,MAAK,SAAUlV,EAAG4V,GACrB,OAAO5V,EAAE,GAAK4V,EAAE,MAEfjiB,EAAI,EAAGA,EAAIkgB,EAAGlgB,IACfiE,KAAK8nE,GAAG1hE,KAAKohE,EAAOzrE,GAAG,IACvBiE,KAAK+nE,GAAG3hE,KAAKohE,EAAOzrE,GAAG,IAM3B,IAHAiE,KAAKqvC,EAAE,GAAK,EACZrvC,KAAKgoE,GAAG,GAAK,EAERjsE,EAAI,EAAGA,EAAIkgB,EAAI,IAAKlgB,EAAG,CAGxB,MAAMksE,EAAKjoE,KAAK8nE,GAAG/rE,EAAI,GAAKiE,KAAK8nE,GAAG/rE,EAAI,GAClCmsE,GAAOloE,KAAK8nE,GAAG/rE,GAAKiE,KAAK8nE,GAAG/rE,EAAI,IAAMksE,EACtCvO,EAAIwO,EAAMloE,KAAKgoE,GAAGjsE,EAAI,GAAK,EAEjCiE,KAAKgoE,GAAGjsE,IAAMmsE,EAAM,GAAOxO,EAE3B,MAAMyO,GACDnoE,KAAK+nE,GAAGhsE,EAAI,GAAKiE,KAAK+nE,GAAGhsE,KAAOiE,KAAK8nE,GAAG/rE,EAAI,GAAKiE,KAAK8nE,GAAG/rE,KACzDiE,KAAK+nE,GAAGhsE,GAAKiE,KAAK+nE,GAAGhsE,EAAI,KAAOiE,KAAK8nE,GAAG/rE,GAAKiE,KAAK8nE,GAAG/rE,EAAI,IAE9DiE,KAAKqvC,EAAEtzC,IAAM,EAAMosE,EAAQF,EAAKC,EAAMloE,KAAKqvC,EAAEtzC,EAAI,IAAM29D,EAM3D,IAHA15D,KAAKgoE,GAAG/rD,EAAI,GAAK,EAGZlgB,EAAIkgB,EAAI,EAAGlgB,GAAK,IAAKA,EACtBiE,KAAKgoE,GAAGjsE,GAAKiE,KAAKgoE,GAAGjsE,GAAKiE,KAAKgoE,GAAGjsE,EAAI,GAAKiE,KAAKqvC,EAAEtzC,GAGtDiE,KAAKooE,UAAY,WACb,OAAO/2C,GAEXrxB,KAAKqoE,SAAW,WACZ,OAAO9gC,IAIfsgC,GAAmB/mE,UAAUwnE,YAAc,SAAUjqD,GAEjD,IAAIkqD,EAAM,EACNC,EAFMxoE,KAAK+nE,GAAG/rE,OAEJ,OAOPwsE,EAAMD,EAAM,GAAG,CAClB,MAAMxsD,EAAKysD,EAAMD,GAAQ,EAErBvoE,KAAK8nE,GAAG/rD,GAAKsC,EACbmqD,EAAMzsD,EAENwsD,EAAMxsD,EAId,MAAM81C,EAAI7xD,KAAK8nE,GAAGU,GAAOxoE,KAAK8nE,GAAGS,GAC3BngE,GAAKpI,KAAK8nE,GAAGU,GAAOnqD,GAAKwzC,EACzB7zC,GAAKK,EAAIre,KAAK8nE,GAAGS,IAAQ1W,EAG/B,OAAOzpD,EAAIpI,KAAK+nE,GAAGQ,GAAOvqD,EAAIhe,KAAK+nE,GAAGS,KAChCpgE,EAAIA,EAAIA,EAAIA,GAAKpI,KAAKgoE,GAAGO,IAAQvqD,EAAIA,EAAIA,EAAIA,GAAKhe,KAAKgoE,GAAGQ,KAAS3W,EAAIA,GAAK,GAUtFgW,GAAmB/mE,UAAU2nE,MAAQ,SAAUnqD,EAAGoqD,GAC9C,IAAIrqD,EAAI,KACJ2oD,EAAO,KACX,IAAK,IAAIjrE,EAAI,EAAGA,GAAK2sE,EAAY3sE,IAAK,CAClC,MAAM4sE,EAAQ5sE,EAAI2sE,EACZE,EAAQ5oE,KAAKsoE,YAAYK,GAC/B,GAAU,OAANtqD,EAAY,CACZA,EAAIsqD,EACJ3B,EAAOrpE,KAAKghB,IAAIiqD,EAAQtqD,GACxB,SAGJ,MAAMuqD,EAAWlrE,KAAKghB,IAAIiqD,EAAQtqD,GAElC,KAAIuqD,EAAW7B,GAKX,MAJA3oD,EAAIsqD,EACJ3B,EAAO6B,EAMf,OAAOxqD,SC5VEyqD,eAIGjX,EAAWuD,EAAWr3C,GAC9B/d,KAAK6xD,EAAIl0D,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAKmlD,IACnC7xD,KAAKo1D,EAAIz3D,KAAK6O,IAAI,KAAO7O,KAAK+O,IAAI,IAAK0oD,IACvCp1D,KAAK+d,EAAIpgB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAKqR,WAI9BgrD,eAIGv8C,EAAWioC,EAAWz2C,GAC9Bhe,KAAKwsB,EAAI7uB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAK8f,IACnCxsB,KAAKy0D,EAAI92D,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAK+nD,IACnCz0D,KAAKge,EAAIrgB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAKsR,WAI9BgrD,eAKG5uC,EAAWr8B,EAAWugB,EAAWvC,GACzC/b,KAAKo6B,EAAIz8B,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAK0tB,IACnCp6B,KAAKjC,EAAIJ,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAK3O,IACnCiC,KAAKse,EAAI3gB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAK4R,IACnCte,KAAK+b,EAAIpe,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAKqP,KAIpC,MAAMktD,GAAiB,CAE1BC,UAAW,SAAUH,GACjB,MAAMlhE,EAAS,IAAIihE,GAAI,EAAG,EAAG,GAEvBt8C,EAAIu8C,EAAIv8C,EAAI,IACZioC,EAAIsU,EAAItU,EAAI,IACZz2C,EAAI+qD,EAAI/qD,EAAI,IAEZmrD,EAASxrE,KAAK+O,IAAI8f,EAAGioC,EAAGz2C,GACxBorD,EAASzrE,KAAK6O,IAAIggB,EAAGioC,EAAGz2C,GACxB2jC,EAAQynB,EAASD,EAIvB,GAFAthE,EAAOkW,EAAIqrD,EAEE,GAATznB,EACA95C,EAAOgqD,EAAI,EACXhqD,EAAOutD,EAAI,MACR,CACHvtD,EAAOutD,EAAIzT,EAAQynB,EACnB,MAAMC,IAAWD,EAAS58C,GAAK,EAAMm1B,EAAQ,GAAMA,EAC7C2nB,IAAWF,EAAS3U,GAAK,EAAM9S,EAAQ,GAAMA,EAC7C4nB,IAAWH,EAASprD,GAAK,EAAM2jC,EAAQ,GAAMA,EAE/Cn1B,GAAK48C,EACLvhE,EAAOgqD,EAAI0X,EAAQD,EACZ7U,GAAK2U,EACZvhE,EAAOgqD,EAAK,EAAI,EAAKwX,EAAQE,EACtBvrD,GAAKorD,IACZvhE,EAAOgqD,EAAK,EAAI,EAAKyX,EAAQD,GAG7BxhE,EAAOgqD,EAAI,IACXhqD,EAAOgqD,GAAK,GAEZhqD,EAAOgqD,EAAI,IACXhqD,EAAOgqD,GAAK,GAQpB,OAJAhqD,EAAOgqD,EAAIl0D,KAAK4jC,MAAiB,IAAX15B,EAAOgqD,GAC7BhqD,EAAOutD,EAAIz3D,KAAK4jC,MAAiB,IAAX15B,EAAOutD,GAC7BvtD,EAAOkW,EAAIpgB,KAAK4jC,MAAiB,IAAX15B,EAAOkW,GAEtBlW,GAGX2hE,UAAW,SAAUV,GACjB,MAAMjhE,EAAS,IAAIkhE,GAAI,EAAG,EAAG,GAE7B,IAAIU,EAAOC,EAAOC,EAAOC,EAAOC,EAAOC,EAAOC,EAAOC,EAErD,MAAMnY,EAAKiX,EAAIjX,EAAI,IAAO,EACpBuD,EAAI0T,EAAI1T,EAAI,IACZr3C,EAAI+qD,EAAI/qD,EAAI,IAgDlB,OA9CS,GAALq3C,GACAvtD,EAAO2kB,EAAQ,IAAJzO,EACXlW,EAAO4sD,EAAQ,IAAJ12C,EACXlW,EAAOmW,EAAQ,IAAJD,IAEX0rD,EAAY,EAAJ5X,EACR6X,EAAQ/rE,KAAKyO,MAAMq9D,GACnBE,EAAQ5rD,GAAK,EAAIq3C,GACjBwU,EAAQ7rD,GAAK,EAAIq3C,GAAKqU,EAAQC,IAC9BG,EAAQ9rD,GAAK,EAAIq3C,GAAK,GAAKqU,EAAQC,KAEtB,GAATA,GACAI,EAAQ/rD,EACRgsD,EAAQF,EACRG,EAAQL,GACQ,GAATD,GACPI,EAAQF,EACRG,EAAQhsD,EACRisD,EAAQL,GACQ,GAATD,GACPI,EAAQH,EACRI,EAAQhsD,EACRisD,EAAQH,GACQ,GAATH,GACPI,EAAQH,EACRI,EAAQH,EACRI,EAAQjsD,GACQ,GAAT2rD,GACPI,EAAQD,EACRE,EAAQJ,EACRK,EAAQjsD,IAER+rD,EAAQ/rD,EACRgsD,EAAQJ,EACRK,EAAQJ,GAGZ/hE,EAAO2kB,EAAY,IAARs9C,EACXjiE,EAAO4sD,EAAY,IAARsV,EACXliE,EAAOmW,EAAY,IAARgsD,EAEXniE,EAAO2kB,EAAI7uB,KAAK4jC,MAAM15B,EAAO2kB,GAC7B3kB,EAAO4sD,EAAI92D,KAAK4jC,MAAM15B,EAAO4sD,GAC7B5sD,EAAOmW,EAAIrgB,KAAK4jC,MAAM15B,EAAOmW,IAG1BnW,GAGXoiE,WAAY,SAAUjB,GAClB,MAAMnhE,EAAS,IAAIkhE,GAAI,EAAG,EAAG,GAEvB3uC,EAAI4uC,EAAK5uC,EAAI,IACbr8B,EAAIirE,EAAKjrE,EAAI,IACbugB,EAAI0qD,EAAK1qD,EAAI,IACbvC,EAAIitD,EAAKjtD,EAAI,IAUnB,OARAlU,EAAO2kB,EAAI,EAAI7uB,KAAK+O,IAAI,EAAG0tB,GAAK,EAAIre,GAAKA,GACzClU,EAAO4sD,EAAI,EAAI92D,KAAK+O,IAAI,EAAG3O,GAAK,EAAIge,GAAKA,GACzClU,EAAOmW,EAAI,EAAIrgB,KAAK+O,IAAI,EAAG4R,GAAK,EAAIvC,GAAKA,GAEzClU,EAAO2kB,EAAI7uB,KAAK4jC,MAAiB,IAAX15B,EAAO2kB,GAC7B3kB,EAAO4sD,EAAI92D,KAAK4jC,MAAiB,IAAX15B,EAAO4sD,GAC7B5sD,EAAOmW,EAAIrgB,KAAK4jC,MAAiB,IAAX15B,EAAOmW,GAEtBnW,GAGXqiE,WAAY,SAAUnB,GAClB,MAAMlhE,EAAS,IAAImhE,GAAK,EAAG,EAAG,EAAG,GAE3Bx8C,EAAIu8C,EAAIv8C,EAAI,IACZioC,EAAIsU,EAAItU,EAAI,IACZz2C,EAAI+qD,EAAI/qD,EAAI,IAYlB,OAVAnW,EAAOkU,EAAIpe,KAAK+O,IAAI,EAAI8f,EAAG,EAAIioC,EAAG,EAAIz2C,GACtCnW,EAAOuyB,GAAK,EAAI5N,EAAI3kB,EAAOkU,IAAM,EAAIlU,EAAOkU,GAC5ClU,EAAO9J,GAAK,EAAI02D,EAAI5sD,EAAOkU,IAAM,EAAIlU,EAAOkU,GAC5ClU,EAAOyW,GAAK,EAAIN,EAAInW,EAAOkU,IAAM,EAAIlU,EAAOkU,GAE5ClU,EAAOuyB,EAAIz8B,KAAK4jC,MAAiB,IAAX15B,EAAOuyB,GAC7BvyB,EAAO9J,EAAIJ,KAAK4jC,MAAiB,IAAX15B,EAAO9J,GAC7B8J,EAAOyW,EAAI3gB,KAAK4jC,MAAiB,IAAX15B,EAAOyW,GAC7BzW,EAAOkU,EAAIpe,KAAK4jC,MAAiB,IAAX15B,EAAOkU,GAEtBlU,GAGXsiE,MAAO,SAAUC,GACb,OAAIA,aAAarB,GACNqB,EAEPA,aAAatB,GACN9oE,KAAKwpE,UAAUY,GAEtBA,aAAapB,GACNhpE,KAAKiqE,WAAWG,QAD3B,GAKJC,MAAO,SAAUD,GACb,OAAIA,aAAatB,GACNsB,EAEPA,aAAarB,GACN/oE,KAAKkpE,UAAUkB,GAEtBA,aAAapB,GACNhpE,KAAKkpE,UAAUlpE,KAAKiqE,WAAWG,SAD1C,GAKJE,OAAQ,SAAUF,GACd,OAAIA,aAAapB,GACNoB,EAEPA,aAAarB,GACN/oE,KAAKkqE,WAAWE,GAEvBA,aAAatB,GACN9oE,KAAKkqE,WAAWlqE,KAAKwpE,UAAUY,SAD1C,GAIJG,YAAa,SAAUH,GACnB,GAAIA,aAAarB,GAAK,CAClB,IAAIyB,EAAM35B,SAAS,GAAKu5B,EAAE59C,GAAIpqB,SAAS,IACnCqoE,EAAM55B,SAAS,GAAKu5B,EAAE3V,GAAIryD,SAAS,IACnCsoE,EAAM75B,SAAS,GAAKu5B,EAAEpsD,GAAI5b,SAAS,IAOvC,OANiB,GAAbooE,EAAGxuE,SACHwuE,EAAK,IAAMA,GACE,GAAbC,EAAGzuE,SACHyuE,EAAK,IAAMA,GACE,GAAbC,EAAG1uE,SACH0uE,EAAK,IAAMA,GACRF,EAAKC,EAAKC,IAGzBC,SAAU,SAASC,GACf,MAAO,OAASjtE,KAAK4jC,MAAMqpC,EAAOp+C,GAAK,KAAO7uB,KAAK4jC,MAAMqpC,EAAOnW,GAAK,KAAO92D,KAAK4jC,MAAMqpC,EAAO5sD,GAAK,KAEvG6sD,UAAW,SAASC,GAChB,MAAO,QAAUntE,KAAK4jC,MAAMupC,EAAQt+C,GAAK,KAAO7uB,KAAK4jC,MAAMupC,EAAQrW,GAAK,KAAO92D,KAAK4jC,MAAMupC,EAAQ9sD,GAAK,KAAO8sD,EAAQ1iE,EAAI,KAE9H2iE,SAAU,SAASC,GAIfA,GAHAA,EAASA,EAAOl2C,QAGAt4B,QADI,oCACoB,SAASuB,EAAGyuB,EAAGioC,EAAGz2C,GACtD,OAAOwO,EAAIA,EAAIioC,EAAIA,EAAIz2C,EAAIA,KAG/B,MAAMnW,EAAM,4CAA+CzH,KAAK4qE,GAChE,OAAOnjE,EAAS,IAAIkhE,GAChBl4B,SAAShpC,EAAO,GAAI,IACpBgpC,SAAShpC,EAAO,GAAI,IACpBgpC,SAAShpC,EAAO,GAAI,KACpB,OC1ML,MAAMojE,GAAmB,oBAEnBC,EAAalmD,GAClBA,EAAM4xC,iBACN,IAAIuU,GAAkB,EACtB,GAAInmD,EAAMomD,cACN,IACKpmD,EAAMomD,cAA8BC,QACrCF,GAAkB,EACpB,MAAMzsE,GACJ4pB,QAAQjoB,MAAM,mBAGjB8qE,GACAnmD,EAAMsmD,cAA8B7U,OAI7C,OAAO,SAAS8U,GACZA,EAAGC,aAAa,WAAY,MAC5B9X,GAAiB6X,EAAI,QAASL,IApBN,GAyB1BO,GAGA,SC9EOC,oBAOQ9X,GACT8X,GAAMC,UAAUp+D,SAASqmD,IAG7B8X,GAAMC,UAAUvlE,KAAKwtD,sBAGNA,GACf,IAAK,IAAI73D,EAAI,EAAGA,EAAI2vE,GAAMC,UAAU3vE,OAAQD,IACxC,GAAI63D,IAAa8X,GAAMC,UAAU5vE,GAE7B,YADA2vE,GAAMC,UAAUzlC,OAAOnqC,EAAG,eAMzB6vE,GACTF,GAAMC,UAAUtrC,SAAQ1X,IACpBA,EAAKijD,sBAzBJF,GAEMC,UAAmB,SCCzBE,kBAIO7lE,GACZ,IAAI6B,EAAS,KACb,IACIA,EAASikE,aAAata,QAAQxrD,GAChC,MAAOtH,GACLsB,KAAKK,MAAQ3B,EAEjB,OAAOmJ,iBAGK7B,EAAavJ,GACzB,IACIqvE,aAAara,QAAQzrD,EAAKvJ,GAC5B,MAAOiC,GACLsB,KAAKK,MAAQ3B,qBAIFsH,GACf,IACI8lE,aAAapa,WAAW1rD,GAC1B,MAAOtH,GACLsB,KAAKK,MAAQ3B,qBAKjB,OAAOsB,KAAKK,OCcb,MAAM0rE,GAAK,2BAGd5Z,yBACAG,oBACAG,YACAE,cACAK,wBACAM,iBfuDyB,WACzB,MAAO,UAAWrB,WAAa,aAAcA,gCE/GpB+Z,EAAwBC,GAC7CD,EAAcE,YACdF,EAAcE,WAAWC,aAAaF,EAASD,EAAcI,iCAI1CC,EAAsB3/B,GAC7C,IAAI/f,EAAU,YAEL2/C,IACW,MAAZ3/C,EAIA0/C,EAAG54B,UACH9mB,IACA+f,KAEA5mB,WAAWwmD,EAAO,GAPlBC,MAAM,iBAWdD,QauCAvY,0BbtB2B1mD,EAAiBm/D,GAC5C,MAAMvY,EAASn4D,OAAOD,KAAK2wE,GAC3B,IAAItY,EACJ,IAAK,IAAIn4D,EAAI,EAAGA,EAAIk4D,EAAOj4D,OAAQD,IAC/Bm4D,EAASD,EAAOl4D,GAChBsR,EAAGm+D,aAAatX,EAAQsY,EAAQtY,2BAIV7mD,EAA8Bo/D,GACxD,MAAMC,EAAYr/D,EAAGs/D,aAAa,SAC5BC,EAAyB,OAAdF,EAAqB,GAAKA,EAAUjqE,MAAM,KACvDmqE,EAASr/D,SAASk/D,KAGtBG,EAASxmE,KAAKqmE,GACdp/D,EAAGm+D,aAAa,QAASoB,EAAS7gE,KAAK,iCAGVsB,EAA8Bo/D,GAC3D,MAAMC,EAAYr/D,EAAGs/D,aAAa,SAC5BC,EAAyB,OAAdF,EAAqB,GAAKA,EAAUjqE,MAAM,KAC3D,GAAKmqE,EAASr/D,SAASk/D,GAAvB,CAGA,IAAK,IAAI1wE,EAAI,EAAGA,EAAI6wE,EAAS5wE,OAAQD,IAC7B6wE,EAAS7wE,KAAO0wE,IAChBG,EAAS1mC,OAAOnqC,EAAG,GACnBA,KAGRsR,EAAGm+D,aAAa,QAASoB,EAAS7gE,KAAK,wBAQpBqC,EAAqBy+D,GACxC,MAAMtf,EAAWnvD,SAAS6yD,yBAC1B4b,EAAIxsC,SAAQ1X,GAAQA,EAAO4kC,EAAShH,OAAO59B,GAAQ,OACnDva,EAAOm4C,OAAOgH,qBAWOuf,EAAYC,EAAYC,EAAYC,EAAYvgE,GACrE,IAAIolD,EAAQgb,EAAKE,EAAIjb,EAASgb,EAAKC,EAanC,OAZIlb,EAAQkb,IACRjb,GAASib,EAAKlb,EACdA,EAAQkb,GAERjb,EAASkb,IACTnb,GAAQmb,EAAKlb,EACbA,EAASkb,GAETvgE,IACAolD,EAAQn0D,KAAK6O,IAAIE,EAAKolD,GACtBC,EAASp0D,KAAK6O,IAAIE,EAAKqlD,IAEpB,OAACD,SAAOC,0BAUW+a,EAAYC,EAAYC,EAAYC,GAC9D,MAAO,CACH5uD,EAAGyuD,EAAK,EAAIE,EAAK,EACjB1uD,EAAGyuD,EAAK,EAAIE,EAAK,uBAKrB,MAAMC,EAAO,IAAIC,KAMjB,OALaD,EAAKE,cAKJ,KAJCF,EAAKG,WAAa,GAAGjrE,WAAWkrE,SAAS,EAAG,KAI/B,IAHhBJ,EAAKK,UAAUnrE,WAAWkrE,SAAS,EAAG,KAGV,KAFL,GAAlBJ,EAAKM,WAAkBN,EAAKO,cAAcrrE,SAAS,IAAIkrE,SAAS,EAAG,KAE5B,Sa7DxDjZ,UACAC,0BbwE2BoZ,GAC3B,MAAM7oC,EAAM6oC,EAActrE,WAAWpG,OAAS,EACxCw4D,EAAc72D,KAAK67B,IAAI,GAAIqL,GAEjC,OAAOyvB,GADWoZ,EAAgBlZ,EACTA,4BAQEmZ,GAC3B,IAAKA,EACD,MAAM,IAAIxxE,MAAM,gCAEpB,GAAI2D,OAAO8tE,MAAQD,aAAmBC,KAClC,OAAOruB,IAAIoR,gBAAgBgd,GACxB,GAAiC,WAA7BA,EAAQ78D,YAAYtJ,KAAmB,CAC9C,MAAMqmE,EAAYF,EAClB,MAAO,QAAUE,EAAStvE,KAAO,IAAMsvE,EAASC,SAAW,IAAMD,EAAS5+D,KAE1E,MAAM,IAAI9S,MAAM,mDAIW4xE,EAAsBC,GAKrD,OAJAD,EAAQ,IAAIZ,KAAKY,GACjBC,EAAQ,IAAIb,KAAKa,GACjBD,EAAME,SAAS,EAAG,EAAG,EAAG,GACxBD,EAAMC,SAAS,EAAG,EAAG,EAAG,IAChBD,EAAME,UAAYH,EAAMG,WAAc,wBAIzBjhE,GACrB,OAAO1N,KAAKC,MAAMD,KAAK8zD,UAAUpmD,0BAgBRysD,GACzB,MAAMyU,EAAW,YACXzxE,EAAG,IAAS6vE,MAAM,yBACxB7S,EAAE7G,OAAOub,QAAO,SAASC,GACrB,GAAa,OAATA,EAGA,OAFA3xE,SACAg9D,EAAEhtB,WAGN,IACI,MAAM4hC,EAAa,CAAC,IAAIC,KAAK,CAACF,GAAO3U,EAAE8U,SAAU,CAACjwE,KAAM4vE,KACxDlc,UAAUwc,MAAM,CACZC,MAAOhV,EAAEgV,MACTC,MAAOL,IAENlxE,MAAKovB,QAGLntB,OAAMX,IACHhC,OAEV,MAAMgC,GACJhC,IAEJg9D,EAAEhtB,aACHyhC,yBAUsBS,GACzB,MAAMxgE,EAA6BwgE,EAAWxgE,OAC9C,QAAKA,OAGD,CAAC,IAAK,QAAS,SAASb,SAASa,EAAOygE,WAAazgE,EAAe0gE,cAGxEF,EAAWhY,kBACJ,wBAQKmY,EAAW1hE,GACvB,MAAMxF,EAASzJ,SAAS4wE,gBAAgB,6BAA8B3hE,EAAG4hE,aACnEhb,EAASn4D,OAAOD,KAAKwR,GAC3B,IAAI6mD,EACJ,IAAK,IAAIn4D,EAAI,EAAGA,EAAIk4D,EAAOj4D,OAAQD,IAE/B,GADAm4D,EAASD,EAAOl4D,GACD,gBAAXm4D,EACA,IAAK,IAAIx1D,EAAI,EAAGA,EAAI2O,EAAG6hE,YAAYlzE,OAAQ0C,IACvCmJ,EAAOjJ,YAAYmwE,EAAU1hE,EAAG6hE,YAAYxwE,SAE9B,gBAAXw1D,GACPrsD,EAAO2jE,aAAatX,EAAQ7mD,EAAG6mD,IAGvC,OAAOrsD,SatLP6jE,gBACAG,OAGA5U,QACAC,wBX3EyBC,EAAYC,EAAYC,EAAYC,GAE7D,OAAO35D,KAAK67B,IAAI29B,EAAKE,EAAI,GAAK15D,KAAK67B,IAAI49B,EAAKE,EAAI,wBAGxBj5C,EAAWC,GAEnC,OAAOD,EAAIA,EAAIC,EAAIA,oBWuEnBi5C,oBACAI,SACAC,UACAE,yBX5C0BqX,EAAmBl1B,EAAkB8d,GAC/D,MAAMqX,EAAMtX,GAAO7d,EAAM57B,EAAI8wD,EAAO9wD,EAAG47B,EAAM37B,EAAI6wD,EAAO7wD,EAAGy5C,GAG3D,OAFAqX,EAAI/wD,GAAK8wD,EAAO9wD,EAChB+wD,EAAI9wD,GAAK6wD,EAAO7wD,EACT8wD,UW0CPzJ,QACAkB,mBXxCmBa,EAAsB2H,EAAaC,GACtD5H,EAAUrpD,GAAKgxD,EACf3H,EAAUppD,GAAKgxD,EACf,MAAMnS,EAAKx/D,KAAK4jC,MAAMmmC,EAAUrpD,GAC1B++C,EAAKz/D,KAAK4jC,MAAMmmC,EAAUppD,GAGhC,OAFAopD,EAAUrpD,GAAK8+C,EACfuK,EAAUppD,GAAK8+C,EACR,IACHD,KACAC,uBAQkBxqC,GACtB,GAAIA,EAAI,GAAM,EACV,OAAIA,EAAI,GAAM,EACHA,EAEJA,EAAI,EAEf,MAAM28C,EAAQ5xE,KAAKuO,KAAK0mB,GAClB48C,EAAQ7xE,KAAKyO,MAAMwmB,GACzB,OAAI28C,EAAQ,GAAM,EACPA,EAEAC,wBAQa58C,GACxB,GAAIA,EAAI,GAAM,EACV,OAAIA,EAAI,GAAM,EACHA,EAAI,EAERA,EAEX,MAAM28C,EAAQ5xE,KAAKuO,KAAK0mB,GAClB48C,EAAQ7xE,KAAKyO,MAAMwmB,GACzB,OAAI28C,EAAQ,GAAM,EACPA,EAEAC,yBASephE,EAAiBmsD,GAC3C,OAAKA,GAGAnsD,GAGDA,EAAO2gC,GAAKpxC,KAAK+O,IAAI0B,EAAO2gC,GAAIwrB,EAAOxrB,IACvC3gC,EAAO6gC,GAAKtxC,KAAK+O,IAAI0B,EAAO6gC,GAAIsrB,EAAOtrB,IACvC7gC,EAAOqhE,GAAK9xE,KAAK6O,IAAI4B,EAAOqhE,GAAIlV,EAAOkV,IACvCrhE,EAAO45D,GAAKrqE,KAAK6O,IAAI4B,EAAO45D,GAAIzN,EAAOyN,KALvC55D,EAAS,CAAE2gC,GAAIwrB,EAAOxrB,GAAIE,GAAIsrB,EAAOtrB,GAAIwgC,GAAIlV,EAAOkV,GAAIzH,GAAIzN,EAAOyN,IAOhE55D,GAVIA,yBAgBemsD,EAAiBzI,EAAeC,GAC1D,IAAIhjB,EAAKpxC,KAAK6O,IAAI,EAAG+tD,EAAOxrB,IACxBE,EAAKtxC,KAAK6O,IAAI,EAAG+tD,EAAOtrB,IACxBwgC,EAAK9xE,KAAK+O,IAAIolD,EAAQ,EAAGyI,EAAOkV,IAChCzH,EAAKrqE,KAAK+O,IAAIqlD,EAAS,EAAGwI,EAAOyN,IACrC,OAAIj5B,EAAK0gC,GAAMxgC,EAAK+4B,EACT,KAEJ,IAAEj5B,KAAIE,KAAIwgC,KAAIzH,uBMhIS,SAAU0H,EAAsBC,EAAoBjW,GAClF,IAAIr7C,EAAGC,EACP,GAAIoxD,EAAUrxD,IAAMsxD,EAAQtxD,EAIxB,OAHAA,EAAIqxD,EAAUrxD,EACdC,EAAIo7C,EAAEp7C,EAEC,CACHD,EAAGA,EACHC,EAAGA,GAGX,MAAMvgB,GAAK4xE,EAAQrxD,EAAIoxD,EAAUpxD,IAAMqxD,EAAQtxD,EAAIqxD,EAAUrxD,GACvDL,EAAI0xD,EAAUpxD,EAAKvgB,EAAI2xE,EAAUrxD,EAKvC,OAHAA,GAAKtgB,EAAI27D,EAAEp7C,EAAIo7C,EAAEr7C,EAAItgB,EAAIigB,IAAMjgB,EAAIA,EAAI,GACvCugB,GAAKvgB,EAAIA,EAAI27D,EAAEp7C,EAAIvgB,EAAI27D,EAAEr7C,EAAIL,IAAMjgB,EAAIA,EAAI,GAEpC,CACHsgB,EAAGA,EACHC,EAAGA,cK0EP+oD,cLPsB,WACtB,MAAME,EAAQvnE,KACR4vE,EAAW,GACjB,IACIC,EACAC,EACAC,EAHAC,EAAU,EAIVC,EAAc,KAoClBjwE,KAAK0oB,IAAM,SAAUrK,EAAGC,EAAG4xD,EAASxjC,EAAUyjC,GAC1C,GAAIN,GAAaxxD,IAAMwxD,EAAUxxD,GAAKC,IAAMuxD,EAAUvxD,EAClD,OAUJ,GARAuxD,EAAY,CAACxxD,EAAGA,EAAGC,EAAGA,GACtBsxD,EAASA,EAAS5zE,QAAU,CACxBqiB,EAAGA,EACHC,EAAGA,EACH4xD,QAASA,GAIW,IAApBN,EAAS5zE,OAET,YADAi0E,EAAcC,GAEX,GAAwB,IAApBN,EAAS5zE,OAIhB,OAHA4zE,EAAS,GAAGQ,IAAMvJ,GAAKE,IAAIF,GAAKC,IAAI8I,EAAS,GAAIA,EAAS,KAC1DI,EAAUE,OACVD,EAAcC,GAEX,CACH,MAAMG,EAAUT,EAASA,EAAS5zE,OAAS,GACrCs0E,EAAUV,EAASA,EAAS5zE,OAAS,GACrCu0E,EAAUX,EAASA,EAAS5zE,OAAS,GAC3Cs0E,EAAQF,IAAMvJ,GAAKE,IAAIF,GAAKC,IAAIuJ,EAASE,KACrCC,MAAMF,EAAQF,IAAI/xD,IAAMmyD,MAAMF,EAAQF,IAAI9xD,MAE1CgyD,EAAQF,IAAM7wE,KAAKC,MAAMD,KAAK8zD,UAAUkd,EAAQH,OAKxD,MAAMhoE,EAAIwnE,EAASA,EAAS5zE,OAAS,GAC/BgiB,EAAI4xD,EAASA,EAAS5zE,OAAS,GAC/Bw7D,EAAKpvD,EACLqvD,EAAKoP,GAAKn+C,IAAItgB,EAAGy+D,GAAKI,IAAI7+D,EAAEgoE,IAAKvJ,GAAKG,KAAK5+D,EAAG4V,GAAK,IACnDyyD,EAAK5J,GAAKC,IAAI9oD,EAAG6oD,GAAKI,IAAIjpD,EAAEoyD,IAAKvJ,GAAKG,KAAK5+D,EAAG4V,GAAK,IACnD0yD,EAAK1yD,EAGX,IAAI2yD,EACJ,GAAIjkC,EAAU,CACV,IAAIkkC,EACJA,EApEL,SACsBpZ,EAAIC,EAAIgZ,EAAIC,EAAIhI,GACrC,MAAMkI,EAAc,GACpB,IAAI/gC,EAAGhoC,EACP,IAAK,IAAI9L,EAAI,EAAGA,GAAK2sE,EAAY3sE,IAC7B8zC,EAAI9zC,EAAI2sE,EACR7gE,EAAS,GACTA,EAAOwW,EAAI1gB,KAAK67B,IAAI,EAAIqW,EAAG,GAAK2nB,EAAGn5C,EAAI,EAAI1gB,KAAK67B,IAAI,EAAIqW,EAAG,GAAKA,EAAI4nB,EAAGp5C,EAAI,GAAK,EAAIwxB,GAAKlyC,KAAK67B,IAAIqW,EAAG,GAAK4gC,EAAGpyD,EAAI1gB,KAAK67B,IAAIqW,EAAG,GAAK6gC,EAAGryD,EACrIxW,EAAOyW,EAAI3gB,KAAK67B,IAAI,EAAIqW,EAAG,GAAK2nB,EAAGl5C,EAAI,EAAI3gB,KAAK67B,IAAI,EAAIqW,EAAG,GAAKA,EAAI4nB,EAAGn5C,EAAI,GAAK,EAAIuxB,GAAKlyC,KAAK67B,IAAIqW,EAAG,GAAK4gC,EAAGnyD,EAAI3gB,KAAK67B,IAAIqW,EAAG,GAAK6gC,EAAGpyD,EACrIsyD,EAAYA,EAAY50E,QAAU6L,EAEtC,OAAO+oE,EAyDWC,CAAgBrZ,EAAIC,EAAIgZ,EAAIC,EAAI,IAC9CC,EAAY,IAAItJ,GAAU,CAACG,OAAQoJ,SAEnCD,EAAY,IAAItJ,GAAU,CAACG,OAAQ,CAAChQ,EAAIkZ,KAI5C,MAAM7rC,EAAM8rC,EAAUhJ,YACtB,IAAImJ,EAAc7Z,GAAIgZ,EAAaC,EAAStY,GAAMoY,EAAUnrC,EAAK,EAAG,IAChEsxB,EAAI6Z,EACR,KAAO7Z,GAAKtxB,EAAKsxB,GAAK2a,EAAa,CAC/BA,EAAc7Z,GAAIgZ,EAAaC,EAAStY,GAAMzB,EAAItxB,EAAK,EAAG,IAC1D,MAAMoV,EAAQ02B,EAAUlJ,UAAUtR,GAC5BoN,EAAQuM,EAAoBnY,GAAiBmY,EAAmB71B,QAASn3C,EAC3E4pC,GACAA,EAAS,CACLruB,EAAG47B,EAAM57B,EACTC,EAAG27B,EAAM37B,EACTuxB,EAAGsmB,EAAItxB,EACP0+B,MAAOA,EACPwN,OAAQjB,EAAoBvM,EAAQwM,EAAY,IAGxDD,EAAoB71B,EACpB81B,EAAYxM,EAGZ72B,EACAsjC,EAAU7Z,EAAItxB,GAEdmrC,EAAU,EACVG,EAAiB,CAAC3Y,GAAIA,EAAIC,GAAIA,EAAIgZ,GAAIA,EAAIC,GAAIA,KAGlDT,EAAcC,GAGlBlwE,KAAKgxE,SAAW,SAASd,EAASxjC,EAAUyjC,GACxC,GAAIP,EAAS5zE,OAAS,EAClB,OAGJ,MAAMw7D,EAAKoY,EAASA,EAAS5zE,OAAS,GAChCy7D,EAAKmY,EAASA,EAAS5zE,OAAS,GAEhCi1E,EAAOpK,GAAKn+C,IAAI+uC,EAAIoP,GAAKC,IAAIrP,EAAID,IAEvC+P,EAAM7+C,IAAIuoD,EAAK5yD,EAAG4yD,EAAK3yD,EAAG4xD,EAASxjC,EAAUyjC,wBK5HjDtI,wBLoQgC,SAAUqJ,EAAUC,EAAQC,YACnD7vC,EAAMxjB,EAAGszD,GACd,OAAO1zE,KAAK4jC,MAAMxjB,EAAIpgB,KAAK67B,IAAI,GAAI63C,IAAQ1zE,KAAK67B,IAAI,GAAI63C,GAG5D,MAAMC,EAAY,GAClB,IAAK,IAAIv1E,EAAI,EAAGA,GAAK,EAAGA,GAAKq1E,EACzBE,EAAUlrE,KAAK,CAACm7B,EAAMxlC,EAAG,GAAIwlC,EAAM2vC,EAAWvzE,KAAK67B,IAAIz9B,EAAG,IAAMo1E,EAASD,GAAW,KAExF,OAAOI,GKzQPze,OAAQlB,uBR1GekB,GACvB,MAAM0e,EAAe5f,GAAakB,EAAOf,MAAOe,EAAOd,QACjDsT,EAAMkM,EAAaze,WAAW,MACpC,IAAKuS,EACD,MAAM,IAAIlpE,MAAM,0DAGpB,OADAkpE,EAAImM,UAAU3e,EAAQ,EAAG,GAClB0e,+BAQPE,EACAC,EACAC,GAEA,IACK,CAAC,GAAG,GAAIpkE,SAASmkE,KAAY,CAAC,GAAG,GAAInkE,SAASokE,IAC/CF,EAAU3f,MAAQ,GAAM,GAAK2f,EAAU1f,OAAS,GAAM,GACtDp0D,KAAKghB,IAAI8yD,EAAUG,UAAY,IAAO,EAEtC,OAAO,EAEX,MAAMC,EAAYl0E,KAAKghB,IAAI8yD,EAAUG,SAAW,IAAM,KAAQ,EACxD9f,EAAQ+f,EAAYJ,EAAU1f,OAAS0f,EAAU3f,MACjDC,EAAS8f,EAAYJ,EAAU3f,MAAQ2f,EAAU1f,OACvD,OACSp0D,KAAKghB,IAAImzC,GAAS,GAAM,GAAK2f,EAAUpzD,EAAI,GAAM,GACjD1gB,KAAKghB,IAAImzC,GAAS,GAAM,GAAK2f,EAAUpzD,EAAI,GAAM,MAGjD1gB,KAAKghB,IAAIozC,GAAU,GAAM,GAAK0f,EAAUnzD,EAAI,GAAM,GAClD3gB,KAAKghB,IAAIozC,GAAU,GAAM,GAAK0f,EAAUnzD,EAAI,GAAM,6CAa3DwzD,EACAC,EACAN,EACAlX,EACAyX,GAEKzX,IACDA,EAAS,CACLl8C,EAAG,EACHC,EAAG,EACHwzC,MAAOigB,EAAejgB,MACtBC,OAAQggB,EAAehgB,SAI/B+f,EAAQG,OACJD,EACAF,EAAQI,uBAAwB,GAEhCJ,EAAQI,uBAAwB,EAChCJ,EAAQK,sBAAwB,QAGpCL,EAAQM,UAAUX,EAAUpzD,EAAGozD,EAAUnzD,GACzCwzD,EAAQO,OAAOZ,EAAUG,SAAW,IAAMj0E,KAAKuvC,IAC/C4kC,EAAQvkC,MAAMkkC,EAAU3f,MAAQ,EAAI,GAAI,EAAI2f,EAAU1f,OAAS,EAAI,GAAI,GACvE+f,EAAQN,UACJO,EACAxX,EAAOl8C,EAAGk8C,EAAOj8C,EAAGi8C,EAAOzI,MAAOyI,EAAOxI,QACxCp0D,KAAKghB,IAAI8yD,EAAU3f,OAAS,GAAIn0D,KAAKghB,IAAI8yD,EAAU1f,QAAU,EAAGp0D,KAAKghB,IAAI8yD,EAAU3f,OAAQn0D,KAAKghB,IAAI8yD,EAAU1f,SAEnH+f,EAAQQ,iDAYRC,EACAR,EACAS,IAOAA,EAAejzE,KAAKC,MAAMD,KAAK8zD,UAAUmf,KACvBrD,SACdqD,EAAarD,OAAS,CAClB9wD,EAAG0zD,EAAejgB,MAAQ,EAC1BxzC,EAAGyzD,EAAehgB,OAAS,IAG9BygB,EAAajlC,QACdilC,EAAajlC,MAAQ,CACjBlvB,EAAG,EACHC,EAAG,IAGNk0D,EAAaC,cACdD,EAAaC,YAAc,GAE1BD,EAAaJ,YACdI,EAAaJ,UAAY,CACrB/zD,EAAG,EACHC,EAAG,IAIX,MAAM+mD,EAAMkN,EAAWzf,WAAW,MAClC,IAAKuS,EACD,MAAM,IAAIlpE,MAAM,0DAEpBkpE,EAAI4M,OAEAt0E,KAAKghB,IAAI6zD,EAAajlC,MAAMlvB,EAAI,GAAM,MACtC1gB,KAAKghB,IAAI6zD,EAAajlC,MAAMjvB,EAAI,GAAK,MACrC3gB,KAAKghB,IAAI6zD,EAAaC,YAAc,IAAM,MAE1CpN,EAAI6M,uBAAwB,EAC5B7M,EAAI8M,sBAAwB,QAE5B9M,EAAI6M,uBAAwB,EAGhC7M,EAAI+M,UAAUI,EAAaJ,UAAU/zD,EAAGm0D,EAAaJ,UAAU9zD,GAC/D+mD,EAAI+M,UAAUI,EAAarD,OAAO9wD,EAAGm0D,EAAarD,OAAO7wD,GACzD+mD,EAAIgN,OAAOG,EAAaC,YAAc,IAAM90E,KAAKuvC,IACjDm4B,EAAI93B,MAAMilC,EAAajlC,MAAMlvB,EAAGm0D,EAAajlC,MAAMjvB,GACnD+mD,EAAI+M,WAAWI,EAAarD,OAAO9wD,GAAIm0D,EAAarD,OAAO7wD,GAC3D+mD,EAAImM,UAAUO,EAAgB,EAAG,EAAGA,EAAejgB,MAAOigB,EAAehgB,QAEzEsT,EAAIiN,+BQnCJlN,wBACAI,yBRwGYkN,EACZ7f,EACAjB,EACAC,EACA8gB,EACAC,GAgBA,GAAKhhB,GAAMC,IAAMD,IAAMiB,EAAOf,OAASD,IAAMgB,EAAOd,QAKpD,GAFAH,EAAIj0D,KAAK6O,IAAIolD,EAAG,GAChBC,EAAIl0D,KAAK6O,IAAIqlD,EAAG,GACZD,GAAKiB,EAAOf,OAASD,GAAKgB,EAAOd,OAAQ,CAEzC4gB,EAAQA,GAAOhhB,KACfihB,EAAQA,GAAOjhB,KAEf,MAAMkhB,WAtBWC,EAAcC,EAAcC,EAAcC,GAC3D,MAAMprE,EAAS,CACXqrE,WAAYv1E,KAAK4jC,MAAM5jC,KAAKw1E,KAAKL,IACjCM,YAAaz1E,KAAK4jC,MAAM5jC,KAAKw1E,KAAKJ,IAClCM,WAAY11E,KAAKuO,KAAKvO,KAAKw1E,KAAKH,IAChCM,YAAa31E,KAAKuO,KAAKvO,KAAKw1E,KAAKF,KAIrC,OAFAprE,EAAOqrE,WAAav1E,KAAK6O,IAAI3E,EAAOqrE,WAAYrrE,EAAOwrE,YACvDxrE,EAAOurE,YAAcz1E,KAAK6O,IAAI3E,EAAOurE,YAAavrE,EAAOyrE,aAClDzrE,EAaO0rE,CAAY1gB,EAAOf,MAAOe,EAAOd,OAAQH,EAAGC,GAQ1D,IAAI2hB,EAAIC,EALRb,EAAK9gB,MAAQ+gB,EAAMK,WAAaL,EAAMQ,WAAa11E,KAAK67B,IAAI,EAAGq5C,EAAMK,YAActhB,EACnFghB,EAAK7gB,OAAS8gB,EAAMO,YAAcP,EAAMS,YAAc31E,KAAK67B,IAAI,EAAGq5C,EAAMO,aAAevhB,EACvF8gB,EAAK7f,WAAW,MAAOmf,OACvBW,EAAK9f,WAAW,MAAOmf,OAGvB,IAAIyB,EAAUf,EAAMgB,EAAUf,EAE9BY,EAAKX,EAAMK,WACXO,EAAKZ,EAAMO,YAEX,IAAIQ,EAAYD,EAAQ7gB,WAAW,MACnC8gB,EAAU1B,uBAAwB,EAClC0B,EAAUzB,sBAAyB,OACnCyB,EAAUC,yBAA4B,OACtCD,EAAUpC,UAAU3e,EAAQ,EAAG,EAAG8gB,EAAQ7hB,MAAO6hB,EAAQ5hB,QAEzD,IAAI+hB,EAAeH,EAAQ7hB,MACvBiiB,EAAgBJ,EAAQ5hB,OAG5B,KAAOyhB,EAAKX,EAAMQ,YAAcI,EAAKZ,EAAMS,YAAaE,IAAMC,IAAM,CAChEG,EAAYF,EAAQ5gB,WAAW,MAC/B8gB,EAAU1B,uBAAwB,EAClC0B,EAAUzB,sBAAyB,OACnCyB,EAAUC,yBAA4B,OAEtC,MAAMG,EAAYR,EAAKX,EAAMQ,WAAcS,EAAe,EAAIA,EACxDG,EAAaR,EAAKZ,EAAMS,YAAeS,EAAgB,EAAIA,EAGjEL,EAAQ5hB,MAAQkiB,EAChBN,EAAQ3hB,OAASkiB,EAEjBL,EAAUpC,UACNmC,EACA,EAAG,EACHG,EAAcC,EACd,EAAG,EACHC,EAAUC,GAEdH,EAAeE,EACfD,EAAgBE,EAGhB,MAAMC,EAAMR,EACZA,EAAUC,EACVA,EAAUO,EAIdrhB,EAAOf,MAAQF,EACfiB,EAAOd,OAASF,EAChB,MAAMsiB,EAAYthB,EAAOC,WAAW,MACpCqhB,EAAUlC,OACVkC,EAAUjC,uBAAwB,EAClCiC,EAAUhC,sBAAyB,OACnCgC,EAAU3C,UACNmC,EACA,EAAG,EACHG,EAAcC,EACd,EAAG,EACHniB,EAAGC,GAEPsiB,EAAU7B,UACVK,EAAK7f,WAAW,MAAOwf,UACvBM,EAAK9f,WAAW,MAAOwf,eAEpB,GAAI1gB,GAAKiB,EAAOf,OAASD,GAAKgB,EAAOd,OAAQ,EAEhD4gB,EAAQA,GAAOhhB,MACVG,MAAQF,EACb+gB,EAAK5gB,OAASF,EACd,MAAMuiB,EAAUzB,EAAK7f,WAAW,MAChCshB,EAAQnC,OACRmC,EAAQlC,uBAAwB,EAChCkC,EAAQjC,sBAAyB,OACjCiC,EAAQ5C,UAAU3e,EAAQ,EAAG,EAAGjB,EAAGC,GACnCuiB,EAAQ9B,UAERzf,EAAOf,MAAQF,EACfiB,EAAOd,OAASF,EAChBgB,EAAOC,WAAW,MAAO0e,UAAUmB,EAAM,EAAG,QAG5CD,EAAa7f,EAAQjB,EAAGiB,EAAOd,OAAQ4gB,EAAMC,GAC7CF,EAAa7f,EAAQjB,EAAGC,EAAG8gB,EAAMC,yCASG/f,GACxC,MAAMwhB,EAAQxhB,EAAOC,WAAW,MAAOwhB,aAAa,EAAG,EAAGzhB,EAAOf,MAAOe,EAAOd,QAC/E,IAAK,IAAIh2D,EAAI,EAAGA,EAAIs4E,EAAMplE,KAAKjT,OAAQD,GAAK,EACd,IAAtBs4E,EAAMplE,KAAKlT,EAAI,KAGnBs4E,EAAMplE,KAAKlT,EAAI,IAAMs4E,EAAMplE,KAAKlT,GAAKs4E,EAAMplE,KAAKlT,EAAI,GAAKs4E,EAAMplE,KAAKlT,EAAI,IAAM,GAAKs4E,EAAMplE,KAAKlT,EAAI,GAAK,MAE3G82D,EAAOC,WAAW,MAAOyhB,aAAaF,EAAO,EAAG,QQ5OhDvL,OACAC,QACAC,kBACAC,oCJuIoC2B,GACpC,MAAmB,KAAXA,EAAOp+C,EAAuB,KAAXo+C,EAAOnW,EAAuB,KAAXmW,EAAO5sD,EAAa,4BC9PxC5P,EAAqBomE,GAC/C,MAAMp1D,EAAMhhB,SAASC,cAAc,OAGnC,OAFA+gB,EAAIq1D,UAAYD,EAChBpmE,EAAOxP,YAAYwgB,GACZA,6BAsBP,GAAItf,OAAO40E,aAAc,CACrB,MAAMC,EAAM70E,OAAO40E,eACfC,IACIA,EAAIC,MACJD,EAAIC,QACGD,EAAIE,iBACXF,EAAIE,uBAGL,cAAez2E,UACrBA,SAAiB02E,UAAUF,yBGwFhC3J,eH9BAxlB,GAcA,MAAMrmC,EAAMhhB,SAASC,cAAconD,EAAOopB,QAAUppB,EAAOopB,QAAU,OAEjEppB,EAAOsvB,KACPhhB,GAAI30C,EAAKqmC,EAAOsvB,KAGhBtvB,EAAO1wC,UACuB,iBAAnB0wC,EAAO1wC,QACdqK,EAAIq1D,UAAYhvB,EAAO1wC,QAEhBnD,MAAMC,QAAQ4zC,EAAO1wC,SAC5Bg3D,GAAGxlB,OAAOnnC,EAAKqmC,EAAO1wC,SAGtBqK,EAAIxgB,YAAY6mD,EAAO1wC,UAI3B0wC,EAAOhnD,cACP2gB,EAAI3gB,YAAcgnD,EAAOhnD,aAEzBgnD,EAAOuvB,YACP51D,EAAI41D,UAAYvvB,EAAOuvB,WAEvBvvB,EAAOxpD,KACPmjB,EAAInjB,GAAKwpD,EAAOxpD,IAEhBwpD,EAAOp+B,QACPo+B,EAAOp+B,OAAOzoB,YAAYwgB,GAE1B,UAAWqmC,QAA2B3iD,IAAjB2iD,EAAOipB,QAC5BtvD,EAAIsvD,MAAQjpB,EAAOipB,OAEvB,MAAM/C,EAAY,GAiBlB,GAhBI,YAAalmB,IACbiO,GAAiBt0C,EAAK,QAASqmC,EAAOwvB,SACtCtJ,EAAUvlE,KAAK,CAAC,QAASq/C,EAAOwvB,WAEhC,aAAcxvB,IACdiO,GAAiBt0C,EAAK,SAAUqmC,EAAOyvB,UACvCvJ,EAAUvlE,KAAK,CAAC,SAAUq/C,EAAOyvB,YAEjCvJ,EAAU3vE,OAAS,GACnByvE,GAAIrlE,KAAK,CACLiH,GAAI+R,EACJusD,UAAWA,IAKf,WAAYlmB,EAAQ,CACpB,MAAM0vB,EAAer5E,OAAOD,KAAK4pD,EAAOyX,QACxC,IAAK,IAAInhE,EAAI,EAAGA,EAAIo5E,EAAan5E,OAAQD,IACrCqjB,EAAIosD,aAAa2J,EAAap5E,GAAI0pD,EAAOyX,OAAOiY,EAAap5E,KAGrE,OAAOqjB,sBAOemsD,GACtB,IAAK,IAAIxvE,EAAI,EAAGA,EAAI0vE,GAAIzvE,OAAQD,IAAK,CACjC,MAAMq5E,EAAO3J,GAAI1vE,GACjB,GAAIq5E,EAAK/nE,KAAOk+D,EAKZ,OAJA6J,EAAKzJ,UAAUtrC,SAAQ1X,IACnB4iD,EAAGzX,oBAAoBnrC,EAAK,GAAIA,EAAK,YAEzC8iD,GAAIvlC,OAAOnqC,EAAG,KGnDtBs5E,wBHlH2B7uB,GAAkB,GAC7C,IAAI3+C,EAASzJ,SAASk3E,eAAiB,CAAC,QAAS,YAAY/nE,SAASnP,SAASk3E,cAAczG,SAC7F,OAAIroB,EACO3+C,EAEAA,IAAWzJ,SAASk3E,cAAc3I,aAAa,sBGkH1DhnD,iBAAkB+tC,GAClBI,oBAAqBD,GACrB0hB,iBdvI4B,SAAU5hB,EAAOp1D,EAAMq1D,GAC9CnB,KACDl0D,EAAOA,EAAK/B,QAAQ,UAAW,UAEnCm3D,EAAMp1D,GAAQq1D,qBE0Od4hB,UAAWthB,GACP,KAAMA,KAAUQ,GAAUqC,aACtB,KAAM,QAAU7C,EAAS,cAE7B,OAAOQ,GAAUqC,YAAY7C,GAGjCuhB,cACI,OAAO/gB,GAAUsC,WAAWjrD,KAAK,KAGrC2pE,kBAAmBC,GACf,IAAK,IAAI55E,EAAI,EAAGA,EAAI24D,GAAUsC,WAAWh7D,OAAQD,IAC7C,IAAK45E,EAAUpoE,SAASmnD,GAAUsC,WAAWj7D,IACzC,OAAO,EAGf,OAAO,EAGXwjE,UACI7K,GAAUv2D,OAAO6B,KAAK41E,iBAlCtBlc,GAMA15D,KAAK61E,OAASnc,EAAEmc,OAChB71E,KAAK81E,KAAOpc,EAAEoc,KACd91E,KAAK+1E,OAASrc,EAAEqc,OAChB/1E,KAAK41E,IAAM,CAAC51E,KAAK61E,OAAQ71E,KAAK81E,KAAM91E,KAAK+1E,QACzCrhB,GAAUhsC,IAAI1oB,KAAK41E,uBYjGvBxc,qBZ6HqB4c,EAAmBC,GACxC,OAAOD,EAAUvzE,MAAM,KAAK6a,OAAOvR,KAAK,OAAQkqE,EAAUxzE,MAAM,KAAK6a,OAAOvR,KAAK,iBY3HjFmqE,IC/HJ,IAAIC,IAA2B,QAelBC,GACTC,MAAOr4D,IACPs4D,YAAaC,IACbnwE,KAAM1H,IACN83E,OAAoC,MAAO,GAC3CC,OAAoC,MAAO,GAC3CjwB,SAAsC,MAAO,GAC7CkwB,UAAsB,OAAO,EAC7BC,UAAsB,OAAO,EAC7BxvB,WAAsB,OAAO,EAC7ByvB,kBAA6B,OAAO,GAgJjC,MAAMC,GAAY,UAnIbC,UAAWpd,GACf5zC,YAAU,KACN,IAAK,IAAI/pB,EAAI,EAAGA,EAAIiE,KAAK2rE,UAAU3vE,OAAQD,IACvCiE,KAAK2rE,UAAU5vE,GAAG29D,GAEtB15D,KAAKiK,UACN,GA4BPosE,MAAOr4D,IACO,IAANA,EACAhe,KAAK+2E,WAAap5E,KAAK6O,IAAI,EAAGxM,KAAK+2E,WAAa,GAEhD/2E,KAAK+2E,aAIbT,YAAaC,GACTv2E,KAAK2rE,UAAUvlE,KAAKmwE,GAGxBnwE,KAAM1H,GACF,GAAIsB,KAAK+2E,WAAa,EAClB,YAEG/2E,KAAKg3E,aAAeh3E,KAAKi3E,QAAQj7E,OAAS,GAC7CgE,KAAKi3E,QAAQ/uB,MAIjB,MAAMqL,EAAMvzD,KAAKi3E,QAAQj3E,KAAKi3E,QAAQj7E,OAAS,GAC/C,GAAiB,iBAAb0C,EAAEw4E,QAA6B3jB,GAAsB,iBAAfA,EAAI2jB,QAA6B3jB,EAAI9N,OAAO,KAAO/mD,EAAE+mD,OAAO,GAGlG,OAFAzlD,KAAKi3E,QAAQj3E,KAAKi3E,QAAQj7E,OAAS,GAAK0C,OACxCsB,KAAKiK,QAGT,GAAiB,eAAbvL,EAAEw4E,QAA2B3jB,GAAsB,eAAfA,EAAI2jB,OAGxC,OAFAl3E,KAAKi3E,QAAQj3E,KAAKi3E,QAAQj7E,OAAS,GAAK0C,OACxCsB,KAAKiK,QAKTjK,KAAKi3E,QAAQj3E,KAAKi3E,QAAQj7E,QAAU0C,EACpCsB,KAAKg3E,aAAeh3E,KAAKi3E,QAAQj7E,OAAS,EAC1C,MAAMm7E,EAAYn3E,KAAKo3E,SACvBp3E,KAAKo3E,SAAWz5E,KAAK6O,IAAIxM,KAAKo3E,SAAUp3E,KAAKg3E,aAAeh3E,KAAKwM,KAC7D2qE,EAAYn3E,KAAKo3E,SACjBp3E,KAAK82E,UAAU,CAACO,aAAcr3E,KAAKi3E,QAAQj3E,KAAKo3E,YAEhDp3E,KAAK82E,UAAU,MAEf92E,KAAKo3E,UAAY,IACjBp3E,KAAKi3E,QAAQj3E,KAAKo3E,UAAY,MAItCZ,OACI,IAAI3uE,EACJ,GAAI7H,KAAK22E,UAAW,CAChB9uE,EAAS,GACT,IAAK,IAAI9L,EAAIiE,KAAKo3E,SAAW,EAAGr7E,EAAIiE,KAAKg3E,aAAcj7E,IACnD8L,EAAOzB,KAAKpG,KAAKi3E,QAAQl7E,IAE7BiE,KAAKg3E,eACLh3E,KAAK82E,UAAU,MAGnB,OAAOjvE,EAGX4uE,OACI,MAAM5uE,EAAS,GAMf,OALI7H,KAAK02E,YACL12E,KAAKg3E,eACLnvE,EAAOzB,KAAKpG,KAAKi3E,QAAQj3E,KAAKg3E,eAC9Bh3E,KAAK82E,UAAU,OAEZjvE,EAGX2+C,SACI,MAAO,GAAG9oD,OAAOsC,KAAKi3E,SAG1BP,UACI,OAAO12E,KAAKg3E,aAAeh3E,KAAKi3E,QAAQj7E,OAAS,EAGrD26E,UACI,OAAO32E,KAAKg3E,aAAeh3E,KAAKo3E,SAGpCjwB,WACI,OAAOnnD,KAAKiK,MAMhB2sE,kBACI,OAAQ52E,KAAKg3E,aAAe,gBAlH5B,GAtBDh3E,KAMcwM,IAAc,GAgBvB2pE,GACA,MAAM,IAAIh6E,MAAM,kCAEpBg6E,IAAkB,EAClBn2E,KAAKiK,MAAQ,EACbjK,KAAKi3E,QAAU,GACfj3E,KAAK2rE,UAAY,GACjB3rE,KAAK+2E,WAAa,EAClB/2E,KAAKo3E,UAAW,EAChBp3E,KAAKg3E,cAAe,ICpCrB,MAAMM,GAAgB,UA9BjBxrD,OACJ9rB,KAAK2rE,UAAUtrC,SAAQ1X,IACnBA,EAAK3oB,KAAKy8B,UAIlB86C,SAAUx5D,QACIjb,IAANib,EACA/d,KAAKy8B,OAAS1e,EAEd/d,KAAKy8B,QAETz8B,KAAK8rB,OAET0rD,SAAUz5D,QACIjb,IAANib,EACA/d,KAAKy8B,OAAS1e,EAEd/d,KAAKy8B,QAETz8B,KAAK8rB,OAETvrB,MACI,OAAOP,KAAKy8B,MAEhBoX,UAAW+f,GACP5zD,KAAK2rE,UAAUvlE,KAAKwtD,iBA9BrB5zD,KACK2rE,UAAqC,GAD1C3rE,KAEKy8B,MAAQ,WCTpBg7C,GAAiBx6E,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHu6E,GAAiBz6E,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCK/G,MAAMw6E,GAAUC,ECLNr4E,KAAKC,MAAM,y6UDMfq4E,GAA4C,CACrD,CACIj6D,KAAM,KACNpW,KAAM,WAEV,CACIoW,KAAM,KACNpW,KAAM,WAEV,CACIoW,KAAM,KACNpW,KAAM,OAEV,CACIoW,KAAM,QACNpW,KAAM,SAGDswE,GAAYx5E,MAAUsf,IAC/B,GAAa,OAATA,EACA,OAAO+5D,GACJ,GAAa,OAAT/5D,EAEP,aAAa3gB,EAAA,SACV,GAAa,OAAT2gB,EAEP,aAAa3gB,EAAA,SACV,GAAa,UAAT2gB,EAEP,aAAa3gB,EAAA,SAEjB,MAAM,IAAId,MAAM,0BE4BpB,IAAI47E,GAA6B,KACjC,CACI,MAAMC,EAAkB,IACP/lB,UAAUgmB,UAAYhmB,UAAUgmB,UAAY,CAAChmB,UAAUimB,WAC/D73C,SAAQ1X,IACb,MAAMlmB,EAAQkmB,EAAKlmB,MAAM,KACzBu1E,EAAM5xE,KAAKuiB,GACU,IAAjBlmB,EAAMzG,QACNg8E,EAAM5xE,KAAK3D,EAAM,OAGzB,IACQqpE,aAAata,QA1EM,oBA2EnBwmB,EAAMtvB,QAAQojB,aAAata,QA3ER,oBA6EzB,MAAO9yD,IAGT,IAAK,IAAI3C,EAAI,EAAGA,EAAIi8E,EAAMh8E,OAAQD,IAAK,CACnC,MAAMo8E,EAAOH,EAAMj8E,GACnB,GAAI87E,GAAUn3C,MAAK/X,GACRA,EAAK/K,KAAK5O,gBAAkBmpE,EAAKnpE,gBACxC,CACA+oE,GAAqBI,EACrB,QAKL,MAAMC,GAAkB,4BA7ERC,GAEXr4E,KAAKiP,KADQ,OAAbopE,EACY,IAAIV,IAEJ,IAAIA,YAAmBG,GAAaO,IAEpDr4E,KAAK4d,KAAOy6D,EACZj6E,SAASk6E,gBAAgB9M,aAAa,OAAQ6M,GAC9Cr4E,KAAK2rE,UAAUtrC,SAAQ1X,IACnBA,OAIRpoB,IAAKqd,GACD,KAAMA,KAAQ5d,KAAKiP,MACf,MAAM,IAAI9S,MAAM,mCAAsCyhB,GAE1D,OAAO5d,KAAKiP,KAAK2O,GAGrB26D,cACI,OAAOV,GAAUn3C,MAAK/X,GACXA,EAAK/K,OAAS5d,KAAK4d,OAIlC46D,UACI,OAAOx4E,KAAK4d,KAIhBi2B,UAAWZ,GACHjzC,KAAK2rE,UAAUp+D,SAAS0lC,IAG5BjzC,KAAK2rE,UAAUvlE,KAAK6sC,GAGxBG,YAAaH,GACT,IAAK,IAAIl3C,EAAI,EAAGA,EAAIiE,KAAK2rE,UAAU3vE,OAAQD,IACvC,GAAIk3C,IAAejzC,KAAK2rE,UAAU5vE,GAE9B,YADAiE,KAAK2rE,UAAUzlC,OAAOnqC,EAAG,iBArDlCiE,KAEK2rE,UAA4B,GAMhC3rE,KAAKiP,KAAO,IAAI0oE,IAChB33E,KAAK4d,KAAO,OAkFP66D,GAAI,CAAI76D,EAA+BphB,KAChD,GAAIA,EAAS,CACT,IAAIqL,EAASuwE,GAAgB73E,IAAIqd,GAKjC,OAJe9hB,OAAOD,KAAKW,GACpB6jC,SAAQr6B,IACX6B,EAASA,EAAOrL,QAAO,IAAKwJ,KAAQxJ,EAAQwJ,OAEzC6B,EAEP,OAAOuwE,GAAgB73E,IAAIqd,aC5FnB86D,GACZhf,GAeA4d,GAAcC,WACd,IAAIxkC,GAAW,EAIf,MAAM4lC,EAAa5M,GAAG1+D,GAAG,CACrBga,OAAQjpB,SAAS0oD,KACjBiuB,IAAK,CACDxjD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLx4C,MAAO,IACP69D,OAAQ,IACRC,SAAU,YAGZC,EAAS/M,GAAG1+D,GAAG,CACjBga,OAAQsxD,EACR3D,UAAW,aAGT+D,EAAgBhN,GAAG1+D,GAAG,CACxBga,OAAQyxD,EACR/D,IAAK,CACDjjB,MAAO,OACPknB,UAAW,OAEXznD,SAAU,WACV1b,QAAS,OACTojE,cAAe,SACfC,eAAgB,SAChBC,WAAY,YAIdC,EAAOrN,GAAG1+D,GAAG,CACfga,OAAQ0xD,EACR9D,QAAO,KACCvb,EAAE2f,kBAGNjkE,EAAM,WAEV2/D,IAAK,CACDxjD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACL+lB,OAAQ,IACRxnB,MAAO,OACPC,OAAQ,UAKVwnB,EAAUxN,GAAG1+D,GAAG,CAClBwhE,QAAS,SACTmG,UAAW,UACXjgE,QAAO,aAAe0jE,GAAK,oCAAoCb,EAAAF,QAC/DhJ,MAAO+J,GAAK,eACZxD,QAAO,KACH7/D,EAAM,WAEV2/D,IAAK,CACDjjB,MAAO0nB,OACPznB,OAAQynB,OACRC,WAAYD,OACZjoD,SAAU,WACVxW,MAAO,IACPw4C,IAAK,IACLmmB,WAAY,OACZC,UAAW,UAIbC,EAAa,CAAC,gBACpBA,EAAWxzE,KAAK,oBAChB,MAAMyzE,EAAQ9N,GAAG1+D,GAAG,CAChB0H,QAAS,CACLwkE,EACAxN,GAAG1+D,GAAG,CACF0H,QAAQ2kD,EAAEl1B,QACVuwC,IAAK,CACD+E,aAAcpgB,EAAEt6C,IAAM,OAAS,KAC/B26D,YAAa,UAGrBrgB,EAAEt6C,KAEN41D,UAAW4E,EAAW7tE,KAAK,KAC3BgpE,IAAKrb,EAAE9jD,MAAQ8jD,EAAE9jD,MAAQ,OAG7BmjE,EAAcxyB,OACVwlB,GAAG1+D,GAAG,CACF0nE,IAAK,CACDiF,KAAM,SAGdH,EACA9N,GAAG1+D,GAAG,CACF0nE,IAAK,CACDiF,KAAM,QAKH,UAAXtgB,EAAEn7D,MACFwtE,GAAGkO,aAAaJ,EAAO,YAEZ,OAAXngB,EAAEn7D,MACFwtE,GAAGkO,aAAaJ,EAAO,SAEZ,YAAXngB,EAAEn7D,MACFwtE,GAAGkO,aAAaJ,EAAO,cAEZ,WAAXngB,EAAEn7D,MACFwtE,GAAGkO,aAAaJ,EAAO,aAG3B,MAAM/iB,EAAc,IAAIiV,GAAGmO,YAAY,CACnCrE,OAAQ,SAAS3hB,EAAQx1D,EAAGy7E,GACpBpnC,IAGAqnC,GAAgC,UAAbD,IAAyBpO,GAAGsJ,mBAC/C32E,EAAEm4D,kBACF/wC,YAAW,WACPs0D,EAAgBC,UACjB,KAEU,QAAbF,IACAz7E,EAAEm4D,kBACFzhD,EAAM,eAKZklE,EAAgBt1D,IACd8xC,EAAY0e,UAAU,SACtBxwD,EAAM4xC,kBAGdmV,GAAGpmD,iBAAiBmzD,EAAQ,QAASwB,GACrCxB,EAAOyB,QAAUxO,GAAGyO,YAEpB,IAAIC,EAAY,KAEZA,EADA/gB,EAAE+gB,UACU/gB,EAAE+gB,WACS,IAAhB/gB,EAAE+gB,UACG,KAEA,KAGhB,MAAMC,EAAchhB,EAAEqC,SAAWrC,EAAEqC,QAAQ//D,OAAS,EAAI+vE,GAAG1+D,GAAG,CAC1Dga,OAAQwyD,EACR9E,IAAK,CACDl/D,QAAS,OACT8kE,SAAU,OACVzB,eAAgB,WAChB0B,UAAW,OACXC,WAAY,UAEf,KACL,IAAIT,EACJ,MAAMU,EAAW,YAqDR1lE,EAAO3Y,GACRs2C,IAIJA,GAAW,EACXg5B,GAAGgP,iBACH38E,SAAS0oD,KAAKjhC,YAAY8yD,GAC1BrB,GAAcE,WACdzL,GAAGiP,UAAUzB,GACbxN,GAAGiP,UAAU5B,GACbtiB,EAAYyI,UACZwM,GAAGjY,oBAAoBglB,EAAQ,QAASwB,GACxCxB,EAAOyB,QAAU,KACjBO,EAASz6C,SAAQ1X,IACbojD,GAAGiP,UAAUryD,MAEjBmyD,EAAS50C,OAAO,EAAG40C,EAAS9+E,QAExB09D,EAAEhtB,UACFgtB,EAAEhtB,SAASjwC,IAxEfi9D,EAAEqC,SACFrC,EAAEqC,QAAQ17B,SAAQ46C,IACd,MAAMC,EAAa,CAAC,iBAIpB,IAAIC,GAHe,OAAfF,GAAwBvhB,EAAE0hB,WAAa1hB,EAAE0hB,UAAU7tE,SAAS0tE,KAC5DC,EAAW90E,KAAK,qBAGpB,IAAI08C,EAAQm4B,EACO,OAAfA,IACAn4B,EAAQ21B,GAAK,YACb0C,EAAUvD,EAAAH,KAEK,WAAfwD,IACAn4B,EAAQ21B,GAAK,gBACb0C,EAAUvD,EAAAF,KAEd,IAAI2D,EAAU,KACVF,IACAE,EAAUtP,GAAG1+D,GAAG,CACZwhE,QAAS,MACT3R,OAAQ,CACJpnD,IAAKqlE,EACLppB,OAAQ,SAIpB,MAAMupB,EAAMvP,GAAG1+D,GAAG,CACdga,OAAQqzD,EACR7L,QAAS,SACTmG,UAAWkG,EAAWnvE,KAAK,KAC3BgJ,QAAS,CAACsmE,EAASv4B,GACnBmyB,QAAO,KACH7/D,EAAM6lE,MAGdH,EAAS10E,KAAKk1E,GACVb,IAAcQ,IACdn1D,YAAU,KACNw1D,EAAIjQ,QACJyN,EAAOyC,SAAS,EAAG,KACpB,IACHz1D,YAAU,KAENgzD,EAAOyC,SAAS,EAAG,KACpB,KAEHN,IAAevhB,EAAE8hB,eACjBpB,EAAkBkB,MA6B1B5hB,EAAE+hB,WACF/hB,EAAE+hB,WAAU,WACRrmE,EAAM,aAxQlBtV,OAAO47E,SAAYh9E,IACfA,EAAEk4D,kBAsSC,MAAM+kB,GAAQ,SAASjiB,GAC1B4d,GAAcC,WACd,MAAMlwD,EAASjpB,SAAS0oD,KAClB1nC,EAAM2sD,GAAG1+D,GAAG,CACdga,OAAQA,EACR2tD,UAAW,SACXD,IAAK,CACDxjD,SAAU,QACVzW,KAAM,IACNy4C,IAAK,IACLqlB,OAAQ,IACR79D,MAAO,IACP2+D,WAAY,sBACZb,SAAU,OACV+C,cAAe,YACfC,kBAAmB,OACnBC,wBAAyB,uBAOxB1mE,IACLkiE,GAAcE,WACdp4D,EAAIm7D,QAAU,KACdlzD,EAAOxB,YAAYzG,GACnB0lD,cANAiX,WAOAj8E,OAAOg0D,oBAAoB,SAAUkoB,GACrCllB,EAAYyI,UACZwM,GAAGiP,UAAUzB,GACbxN,GAAGiP,UAAU5B,GACT1f,EAAEuiB,SACFviB,EAAEuiB,UAdV78D,EAAIm7D,QAAUxO,GAAGyO,YAmBjB,MAAMpB,EAAOrN,GAAG1+D,GAAG,CACfga,OAAQjI,EACR21D,IAAK,CACDxjD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLqlB,OAAQ,IACR79D,MAAO,KAEXk6D,QAAS7/D,IAIP8mE,EAAUnQ,GAAG1+D,GAAG,CAClBga,OAAQjI,EACR21D,IAAK,CACDxjD,SAAU,WACVugC,MAAQia,GAAGoQ,uBACP,2BAA6BziB,EAAE5H,MAAQ4H,EAAE5H,MAAQ,KAAO,OACvD4H,EAAE5H,MAAQ4H,EAAE5H,MAAQ,KAAO,KAChCC,OAAQ,oBACR2nB,WAAY,OACZ0C,aAAc,OACdvD,SAAU,SACVc,UAAW,+CAKVqC,IACL,MAAMK,EAAMH,EAAQI,YACdC,EAAML,EAAQM,aAEpBzQ,GAAGgJ,IAAImH,EAAS,CACZphE,KAAMnd,KAAK6O,IAAI,GAAI1M,OAAO28E,WAAaJ,GAAO,GAAK,KACnD9oB,IAAK51D,KAAK6O,IAAI,IAAK1M,OAAO48E,YAAcH,GAAO,EAAW,GAANA,GAAe,OAK3EP,IACAl8E,OAAO6lB,iBAAiB,SAAUq2D,GAGlC,MACMW,EAAU5Q,GAAG1+D,GAAG,CAClBga,OAAQ60D,EACRnH,IAAK,CACDhjB,OAAQynB,OACR3jE,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,SACZyD,YAAcpD,UAGlB9f,EAAEgV,OACFiO,EAAQ/9E,YAAY86D,EAAEgV,OAE1B,MAAM6K,EAAUxN,GAAG1+D,GAAG,CAClBga,OAAQs1D,EACR9N,QAAS,SACTmG,UAAW,UACXjgE,QAAO,aAAe0jE,GAAK,oCAAoCb,EAAAF,QAC/DhJ,MAAO+J,GAAK,eACZxD,QAAS7/D,EACT2/D,IAAK,CACDjjB,MAAO0nB,OACPznB,OAAQynB,OACRC,WAAYD,OACZE,WAAY,OACZC,UAAW,QAEfzc,OAAQ,CACJ2f,SAAU,OAIZC,EAAY/Q,GAAG1+D,GAAG,CACpBga,OAAQ60D,EACRnH,IAAK,CACDhjB,OAAQ,uBAGZ2H,EAAE3kD,SACF+nE,EAAUl+E,YAAY86D,EAAE3kD,SAG5B,MAAM+hD,EAAc,IAAIiV,GAAGmO,YAAY,CACnCrE,OAAQ,SAAS3hB,EAAQx1D,GACN,QAAXw1D,IACAx1D,EAAEm4D,kBACFzhD,QAOZpV,KAAKoV,MAAQ,WACTA,YCpbK2nE,GAyETC,WACI,OAAOh9E,KAAKssE,MAAM2Q,QAGtBC,aACI,OAAOl9E,KAAKyS,QAGhB8sD,UACIv/D,KAAKssE,MAAM6Q,SAAW,iBA3Eb13B,GASTzlD,KAAKyS,QAAUs5D,GAAG1+D,GAAG,CACjB2nE,UAAW,gBAGf,MAAMoI,EAAUrR,GAAG1+D,GAAG,CAClBga,OAAQrnB,KAAKyS,QACbo8D,QAAS,QACTmG,UAAW,uBAGfh1E,KAAKssE,MAAQP,GAAG1+D,GAAG,CACfga,OAAQ+1D,EACRvO,QAAS,QACTkG,IAAK,CACD8F,WAAY,IACZhlE,QAAS,gBAEbqnD,OAAQ,CACJ3+D,KAAM,cAGdyB,KAAKssE,MAAM2Q,QAAUx3B,EAAOpiB,KACxBoiB,EAAO43B,aAAer9E,KAAKssE,MAAM2Q,SACjClR,GAAGkO,aAAaj6E,KAAKyS,QAAS,0BAE7BgzC,EAAO63B,WACRt9E,KAAKssE,MAAMiR,UAAW,GAGtB93B,EAAOipB,QACP0O,EAAQ1O,MAAQjpB,EAAOipB,OAG3B,MAAM5rB,EAAQ1kD,SAASC,cAAc,OACrCykD,EAAMltC,MAAMC,QAAU,eACtBitC,EAAM2xB,UAAYhvB,EAAO3C,MACxBA,EAAcgsB,YAAa,EAC5BsO,EAAQx+E,YAAYkkD,GAEpB9iD,KAAKssE,MAAM6Q,SAAQ,KACX13B,EAAO43B,cACHr9E,KAAKssE,MAAM2Q,QACXlR,GAAGkO,aAAaj6E,KAAKyS,QAAS,0BAE9Bs5D,GAAGyR,gBAAgBx9E,KAAKyS,QAAS,2BAGzCgzC,EAAO/Y,SAAS1sC,KAAKssE,MAAM2Q,SAC3Bn3D,YAAU,KACN9lB,KAAKssE,MAAM7V,SACZ,IAEHhR,EAAOsvB,KACPhJ,GAAGgJ,IAAI/0E,KAAKyS,QAASgzC,EAAOsvB,MCvEjC,MAAM0I,GAAQ,SAAUh4B,GAQ3B,MAAM59C,EAASzJ,SAASC,cAAc,SACtC,GAAIonD,EAAOlnD,KACP,IACIsJ,EAAOtJ,KAAOknD,EAAOlnD,KACvB,MAAMG,SAERmJ,EAAOtJ,KAAO,OAkBlB,YAhBmBuE,IAAf2iD,EAAO/4C,MACP7E,EAAO6E,IAAM,GAAK+4C,EAAO/4C,UAEV5J,IAAf2iD,EAAOj5C,MACP3E,EAAO2E,IAAM,GAAKi5C,EAAOj5C,KAE7B3E,EAAOpL,MAAQ,GAAKgpD,EAAOpiB,KACvBoiB,EAAO/Y,WACP7kC,EAAOs1E,SAAW,WACd13B,EAAO/Y,SAAS7kC,EAAOpL,SAG3BgpD,EAAOsvB,KACPhJ,GAAGgJ,IAAIltE,EAAQ49C,EAAOsvB,KAGnBltE,SC7BE61E,GA0DTC,SAAU/3E,GACN5F,KAAK49E,SAASnhF,MAAQmJ,EAG1Bo3E,WACI,OAAOh9E,KAAK49E,SAASnhF,MAGzBohF,cAAel8B,GACX,IAAI/0C,EAAQ,EACZ,IAAK,IAAI7Q,EAAI,EAAGA,EAAIiE,KAAK89E,UAAU9hF,OAAQD,IACvC,GAAI,GAAKiE,KAAK89E,UAAU/hF,GAAG,KAAOiE,KAAK49E,SAASnhF,MAAO,CACnDmQ,EAAQ7Q,EACR,MAGR6Q,EAAQjP,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI1M,KAAK89E,UAAU9hF,OAAQ,EAAG4Q,EAAQ+0C,IAC/D3hD,KAAK49E,SAASnhF,MAAQuD,KAAK89E,UAAUlxE,GAAO,GAC5C5M,KAAKk1E,SAASl1E,KAAK49E,SAASnhF,OAGhCygF,aACI,OAAOl9E,KAAK49E,qBAvEHlkB,GATV15D,KAmFHu/D,QAAO,KACHv/D,KAAK49E,SAAS9pB,oBAAoB,SAAU9zD,KAAK+9E,iBAnEjD/9E,KAAK49E,SAAW7R,GAAG1+D,GAAG,CAClBwhE,QAAS,SACTH,MAAOhV,EAAEgV,MACTqG,IAAK,CACDiJ,OAAQ,UACRC,SAAU,OACVC,QAAS,MACTxE,WAAY,OAEZyE,YAAa,gBAGjBzkB,EAAEqb,KACFhJ,GAAGgJ,IAAI/0E,KAAK49E,SAAUlkB,EAAEqb,KAG5B,MAAMqJ,EAAc1kB,EAAE0kB,YACjBA,IACDp+E,KAAK49E,SAASL,UAAW,GAE7Bv9E,KAAK89E,UAAYpkB,EAAEokB,UACnB,IAAK,IAAI/hF,EAAI,EAAGA,EAAIiE,KAAK89E,UAAU9hF,OAAQD,IAAK,CAC5C,GAA0B,OAAtBiE,KAAK89E,UAAU/hF,GACf,SAEJ,MAAMsiF,EAASjgF,SAASC,cAAc,UACtCggF,EAAO5hF,MAAQuD,KAAK89E,UAAU/hF,GAAG,GACjCsiF,EAAO5/E,YAAcuB,KAAK89E,UAAU/hF,GAAG,GACvCiE,KAAK49E,SAASr3B,OAAO83B,GAEzBr+E,KAAKk1E,SAAWxb,EAAEwb,SAClBl1E,KAAK+9E,eAAkBr/E,IACd0/E,GACDp+E,KAAK49E,SAASnnB,OAElBz2D,KAAKk1E,SAASl1E,KAAK49E,SAASnhF,QAEhCuD,KAAK49E,SAASj4D,iBAAiB,SAAU3lB,KAAK+9E,gBAC9C/9E,KAAK49E,SAASnhF,MAAQ,cAAei9D,EAAIA,EAAE4kB,UAAY,MC7CxD,MAAMC,GAAc,SAAS7kB,GAChC,IAAI8kB,IAAa9kB,EAAE4kB,UACnB,MAAMl/D,EAAM2sD,GAAG1+D,GAAG,CACd2nE,UAAW,eACXtG,MAAOhV,EAAEgV,MACTqG,IAAK,CACD0J,gBAAiB,QAAU/kB,EAAEglB,MAAQ,MAEzCzJ,QAAS,SAASv2E,GACdA,EAAEk4D,iBACE8C,EAAEilB,SAAWH,IAGjBA,GAAYA,EACZ/xC,IACAitB,EAAEwb,SAASsJ,gBAIV/xC,IACD+xC,EACAzS,GAAGkO,aAAa76D,EAAK,uBAErB2sD,GAAGyR,gBAAgBp+D,EAAK,uBAIhCqtB,IAGAzsC,KAAK29E,SAAW,SAAS3/D,GACrBwgE,IAAaxgE,EACbyuB,KAEJzsC,KAAKk9E,WAAa,WACd,OAAO99D,GAEXpf,KAAKg9E,SAAW,WACZ,OAAOwB,ICnCFI,GAAiB,SAASllB,GAEnC,MAAMt6C,EAAM2sD,GAAG1+D,GAAG,CACd2nE,UAAW,sBACXD,IAAK,CACDl/D,QAAS,UAIjB,IAAIgpE,EACJ,MAAMf,EAAY,YAUTgB,EAAalyE,EAAOw9D,GACrBA,EAAEnuE,KAAOy9D,EAAEqlB,SACXF,EAAcjyE,GAElB,MAAMoyE,EAAU,IAAIT,GAAY,CAC5BG,MAAOtU,EAAEsU,MACThQ,MAAOtE,EAAEsE,MACT4P,UAAWlU,EAAEnuE,KAAOy9D,EAAEqlB,OACtBJ,SAAS,EACTzJ,SAAU,qBAjBFtoE,EAAO3Q,GACnB4iF,EAAcjyE,EACd,IAAK,IAAI7Q,EAAI,EAAGA,EAAI+hF,EAAU9hF,OAAQD,IAClC+hF,EAAU/hF,GAAG4hF,SAAS5hF,IAAM8iF,GAEhCnlB,EAAEwb,SAASj5E,GAaHgjF,CAAOryE,EAAOw9D,EAAEnuE,OAKxB,OAFAmjB,EAAIxgB,YAAYogF,EAAQ9B,cAEjB8B,EAIX,IAAK,IAAI/oB,EAAI,EAAGA,EAAIyD,EAAEokB,UAAU9hF,OAAQi6D,IACpC6nB,EAAU13E,KAAK04E,EAAa7oB,EAAGyD,EAAEokB,UAAU7nB,KAK/Cj2D,KAAKk9E,WAAa,WACd,OAAO99D,GAEXpf,KAAKg9E,SAAW,WACZ,OAAOtjB,EAAEokB,UAAUe,GAAa5iF,YCpExCijF,GAAiBjiF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCY/G,MAAMgiF,GAAoB,SAASC,EAAWC,GAEjD,MAAMC,EAAYvT,GAAG1+D,GAAG,CACpB0nE,IAAK,CACDwK,SAAU,QACVnD,aAAc,MACdtqB,MAAO,OACPC,OAAQ,OACR0sB,gBAAiB,QAAU7G,EAAAsH,IAAU,KACrCM,eAAgB,UAChBC,iBAAkB,YAClBzB,OAAQ,UACR0B,UAAW,aACXvB,YAAa,yBAQZwB,IACDP,EACArT,GAAGgJ,IAAIuK,EAAW,CACdM,gBAAiB,OACjBC,QAAS,MACTC,OAAQ,4CAGZ/T,GAAGgJ,IAAIuK,EAAW,CACdM,gBAAiB,cACjBC,QAAS,MACTC,OAAQ,mBAepB,OA9BK/T,GAAGgU,mBACJT,EAAU1pE,MAAMC,QAAU,QAmB9BypE,EAAU5Q,MAAQ+J,GAAK,yBACvB6G,EAAU/E,QAAU,WAChB6E,GAAaA,EACbO,IACAN,EAAeD,IAGnBO,IACAN,EAAeD,GAERE,GCpDEU,GAA0B,SAASrnB,EAAQsnB,GACpD,IAAIp4E,EAASlK,KAAK+O,IAAI,GAAI,EAAI/O,KAAK67B,IAAI77B,KAAKyO,MAAMusD,EAAS,IAAK,IAIhE,OAHIsnB,IACAp4E,GAAU,GAEP,EAAIA,GCuBFq4E,GAAW,SAAUxmB,GAC9B,MAAM6N,EAAQvnE,KACd,IAEImgF,EAFAC,GAA4B,IAAhB1mB,EAAE0mB,UACdC,IAAc3mB,EAAE4mB,MAGpB,IAAK5mB,EAAE5W,QAAU4W,EAAEwb,SACf,KAAM,0BAEV,KAAa,GAATxb,EAAEhtD,KAAqB,GAATgtD,EAAEltD,KAA2B,GAAfktD,EAAE4kB,WACzB5kB,EAAEhtD,KAAQgtD,EAAEltD,KAAQktD,EAAE4kB,WACvB,KAAM,yBAGd,GAAI5kB,EAAEhtD,KAAOgtD,EAAEltD,IACX,KAAM,yBAGV,MAAM+zE,EAAe7mB,EAAE5H,MACjB0uB,EAAgB9mB,EAAE3H,OAClB2W,EAAahP,EAAEgP,WAAahP,EAAEgP,WAAa6X,EACjD,IAAI7zE,EAAMgtD,EAAEhtD,IACRF,EAAMktD,EAAEltD,IACZ,MAAM0oE,EAAWxb,EAAEwb,SACbuL,IAAoB/mB,EAAE+mB,gBACtBC,EAAahnB,EAAEgnB,WACfC,EAAajnB,EAAEinB,WAErB,GAAIN,EAAW,CACX,MAAMO,EAAuB,cAAZlnB,EAAE4mB,MAAwBvU,GAAG8U,qBAAqBn0E,EAAKF,EAAK,IAAOktD,EAAE4mB,MACtFH,EAAqB,IAAIpU,GAAG+U,mBAAmBF,YAG1CG,EAActkF,GACnB,OAAI4jF,EACOF,EAAmB1X,MAAMhsE,EAAOkB,KAAKyO,MAAmB,IAAbs8D,KAE9CjsE,EAAQiQ,IAAQF,EAAME,GAWlC,MAAM0S,EAAM2sD,GAAG1+D,GAAG,CACd2nE,UAAW,gBACXD,IAAK,CACD8D,SAAU,SACVtnD,SAAU,WACVugC,MAAOyuB,EAAe,KACtBxuB,OAAQyuB,EAAgB,KACxBQ,WAAY,UAGdC,EAAevnB,EAAE5W,MACjBA,EAAQ1kD,SAASC,cAAc,OAC/B6iF,EAAU9iF,SAASC,cAAc,OACjC8iF,EAAe/iF,SAASC,cAAc,OAC5C,IAAI+iF,EAAcL,EAAcrnB,EAAE4kB,WAElCl/D,EAAIxgB,YAAYsiF,GAChB9hE,EAAIxgB,YAAYkkD,GAChBo+B,EAAQtiF,YAAYuiF,GACpBD,EAAQlM,UAAY,cAGpB51D,EAAIiiE,cAAgB,WAChB,OAAO,GAGXv+B,EAAM2xB,UAAYwM,EAElBC,EAAQtrE,MAAM2b,SAAW,WACzB2vD,EAAQtrE,MAAMkF,KAAO,IACrBomE,EAAQtrE,MAAM29C,IAAM,IACpB2tB,EAAQtrE,MAAMk8C,MAASsvB,EAAcb,EAAgB,KACrDW,EAAQtrE,MAAMm8C,OAASyuB,EAAgB,KAEvC,MAAMc,EAAgBd,EAAgB,YAU7Be,IACDnB,EACArU,GAAGgJ,IAAI31D,EAAK,CACRygE,QAAS,KACT2B,cAAe,OAGnBzV,GAAGgJ,IAAI31D,EAAK,CACRygE,QAAS,MACT2B,cAAe,kBAMlBC,IACL,IAAI55E,EAAS6E,EAAM00E,GAAe50E,EAAME,GAIxC,OAHI2zE,IACAx4E,EAASs4E,EAAmB7X,YAAY8Y,IAErCv5E,WAGF65E,IACL,IAAIC,WA5ESC,GACb,IAAI/5E,EAAS6E,EAAMk1E,GAAgBp1E,EAAME,GAIzC,OAHI2zE,IACAx4E,EAASs4E,EAAmB7X,YAAYsZ,IAErC/5E,EAuEMg6E,CAAQT,GACrBO,EAASjB,EAAaA,EAAWiB,GAAU9wC,SAAS8wC,GACpDA,EAASA,EAAOG,eAAe1J,GAAgBI,WAC/C11B,EAAM2xB,UAAYwM,EAAe,8CAAgDU,EAAS,UAC1FT,EAAQtrE,MAAMk8C,MAASsvB,EAAcb,EAAgB,KArCzDxU,GAAGgJ,IAAIjyB,EAAO,CACVvxB,SAAU,WACVzW,KAAM,MACNy4C,IAAMitB,EAAgB,EAAIc,EAAgB,EAAI,EAAK,KACnD7H,WAAY6H,EAAgB,KAC5BrD,SAAUqD,EAAgB,KAC1BE,cAAe,SAgBnBD,IAkBA,IAgBIQ,EA0CAC,EA1DAC,EAAmB,WACdn2D,EAAKo2D,GACV,GAAKA,IAAWzB,EAGhB,GAAIE,IAAeuB,EAAS,CACxB,MAAM38D,EAAMq1C,YAAYr1C,MACpBA,EAAM08D,GAAoBtB,IAC1BsB,EAAmB18D,EACnB2vD,EAASuM,WAGbvM,EAASuM,cAKR5nB,EAAU70C,GAGf,GAFAA,EAAMk3C,sBAEDkkB,EAAL,CAgBA,GAZmB,gBAAfp7D,EAAMzmB,OACN6gB,EAAI41D,UAAY,oCAEK,SAAjBhwD,EAAMg3C,SACNolB,EAAcp8D,EAAMy1C,KAAO8lB,EAC3Ba,EAAczjF,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAG00E,IACtCM,IACA51D,GAAK,IAETi2D,EAAaX,GAGE,gBAAfp8D,EAAMzmB,MAA0B,CAAC,OAAQ,SAASgP,SAASyX,EAAMg3C,QAAS,CAE1E,IAAImmB,EAASn9D,EAAMm4C,GACnB,MAAMxE,EAASh7D,KAAKghB,IAAIqG,EAAM6zC,MAAQ7zC,EAAM25C,WAE5CwjB,GADenC,GAAwBrnB,EAAyB,UAAjB3zC,EAAMg3C,QAErDmmB,GAAU5B,EAEVwB,GAAcI,EACdf,EAAczjF,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGq1E,IAEtCL,IACA51D,GAAK,GAGU,cAAf9G,EAAMzmB,OACN6gB,EAAI41D,UAAY,gBAChBlpD,GAAK,KAMb,MAAMs2D,EAAyBt8D,YAAU,KACrCk8D,EAAkB,IAAIjW,GAAGsW,gBAAgB,CACrCj0E,OAAQgR,EACR86C,YAAa,EACb+E,aAAa,EACbpF,UAAWA,EACXE,QAAS,SAAS/0C,GACVq7D,GACAe,IAAgBp8D,EAAM2zC,QAAUwnB,EAAmB9X,WAAa8X,EAAmB/X,aAAe,GAClGgZ,EAAczjF,KAAK6O,IAAI2zE,EAAmB/X,YAAazqE,KAAK+O,IAAIyzE,EAAmB9X,WAAY+Y,MAE/FA,IAAgBp8D,EAAM2zC,OAAS,GAC/ByoB,EAAczjF,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAG00E,KAE1CM,IACAxM,EAASuM,QAGjBC,MACD,GAIH1hF,KAAKsiF,cAAgB,SAAU1vD,GAC3BwuD,EAAczjF,KAAK+O,IAAI,EAAG00E,EAAczjF,KAAKghB,IAAIiU,IACjD8uD,IACAxM,EAASuM,MAEbzhF,KAAKuiF,cAAgB,SAAU3vD,GAC3BwuD,EAAczjF,KAAK6O,IAAI,EAAG40E,EAAczjF,KAAKghB,IAAIiU,IACjD8uD,IACAxM,EAASuM,MAEbzhF,KAAK29E,SAAW,SAAS5/D,GACrBqjE,EAAcL,EAAchjE,GAC5B2jE,KAEJ1hF,KAAKg9E,SAAW,WACZ,OAAOyE,KAEXzhF,KAAKysC,OAAS,SAAS+1C,GAInB,GAHA91E,EAAM81E,EAAO91E,IACbF,EAAMg2E,EAAOh2E,IACb6zE,IAAcmC,EAAOlC,MACjBD,EAAW,CACX,MAAMO,EAA4B,cAAjB4B,EAAOlC,MAAwBvU,GAAG8U,qBAAqBn0E,EAAKF,EAAK,IAAOg2E,EAAOlC,MAChGH,EAAqB,IAAIpU,GAAG+U,mBAAmBF,QAE/CT,EAAqB,KAEzB5Y,EAAMkb,cAAcD,EAAOE,aAE/B1iF,KAAKyiF,aAAe,SAAU/jF,GAC1B0hF,IAAc1hF,EACd6iF,KAGJvhF,KAAKu/D,QAAU,WACXtG,aAAampB,GACTJ,GACAA,EAAgBziB,WAIxBv/D,KAAKk9E,WAAa,WACd,OAAO99D,WC1RfujE,GAAiB1lF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCY/G,MAAMylF,GAAiB,SAAUlpB,GAEpC,IAAImpB,EAAe,IAAI9W,GAAG+W,IAAIppB,EAAEqpB,MAAMv2D,EAAGktC,EAAEqpB,MAAMtuB,EAAGiF,EAAEqpB,MAAM/kE,GAE5D,MAAMoB,EAAM2sD,GAAG1+D,GAAG,IAEZ21E,EAAYjX,GAAG1+D,GAAG,CACpB0nE,IAAK,CACDjjB,MAAO,OACPC,OAAQ,OACR+nB,aAAc,OACdH,UAAW,uCACXD,WAAY,IAAM3N,GAAGkX,eAAe1Y,YAAYsY,GAChD1E,YAAa,gBAGrB/+D,EAAIxgB,YAAYokF,GAIhB,MAAME,EAAWnX,GAAG1+D,GAAG,CACnB0nE,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZW,aAAc,UAGhBqJ,EAAWpX,GAAG1+D,GAAG,CACnB0H,QAAS0jE,GAAK,WACd1D,IAAK,CACDjjB,MAAO,UAGTsxB,EAAW3F,GAAM,CACnBp6C,KAAM,IAAM0oC,GAAGkX,eAAe1Y,YAAYsY,GAC1C9N,IAAK,CACDjjB,MAAO,QAEXplB,SAAU,WACN,IAAIk+B,EAASmB,GAAGkX,eAAelY,SAASqY,EAAS3mF,OAClC,OAAXmuE,GACAA,EAASiY,EACTO,EAAS3mF,MAAQ,IAAMsvE,GAAGkX,eAAe1Y,YAAYsY,IAErDA,EAAejY,EAEnBoY,EAAUptE,MAAM8jE,WAAa,IAAM3N,GAAGkX,eAAe1Y,YAAYK,GAEjE,IAAK,IAAI7uE,EAAI,EAAGA,EAAIsnF,EAAOrnF,OAAQD,IAC/BsnF,EAAOtnF,GAAG0wC,YAIhB62C,EAAavX,GAAG1+D,GAAG,CACrBwhE,QAAS,SACT95D,QAAS,aAAe6iE,EAAA+K,IAAU,kBAClCjU,MAAO+J,GAAK,YACZ1D,IAAK,CACD8F,WAAY,QAEhB5F,QAAS,WACLmO,EAASnE,SACT7gF,SAASmlF,YAAY,oBAcpBC,EAAkBC,EAAUC,GACjC,MAAM77E,EAAc,GAEd87E,EAAQ5X,GAAG1+D,GAAG,CAChB0nE,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZyB,UAAW,SAGbgJ,EAAU7X,GAAG1+D,GAAG,CAClB0H,QAAS0uE,EACT1O,IAAK,CACDjjB,MAAO,UAIT+xB,EAAUpG,GAAM,CAClBp6C,KAAMw/C,EAAaa,GACnBh3E,IAAK,EACLF,IAAK,IACLjO,KAAM,SACNw2E,IAAK,CACDjjB,MAAO,QAEXplB,SAAU,WACgB,KAAlBm3C,EAAQpnF,OAAgBqnF,WAAWD,EAAQpnF,OAAS,GAAKqnF,WAAWD,EAAQpnF,OAAS,IACrFoL,EAAO4kC,UAGXo3C,EAAQpnF,MAAQ,GAAKkB,KAAK4jC,MAAMuiD,WAAWD,EAAQpnF,QACnDomF,EAAaa,GAAgBG,EAAQpnF,MACrCumF,EAAUptE,MAAM8jE,WAAa,IAAM3N,GAAGkX,eAAe1Y,YAAYsY,GACjEO,EAAS3mF,MAAQ,IAAMsvE,GAAGkX,eAAe1Y,YAAYsY,OAY7D,OARAc,EAAM/kF,YAAYglF,GAClBD,EAAM/kF,YAAYilF,GAClBzkE,EAAIxgB,YAAY+kF,GAGhB97E,EAAO4kC,OAAS,WACZo3C,EAAQpnF,MAAQomF,EAAaa,IAE1B77E,EAxDXq7E,EAAStkF,YAAYukF,GACrBD,EAAStkF,YAAYwkF,GACrBF,EAAStkF,YAAY0kF,GACrBlkE,EAAIxgB,YAAYskF,GAChBp9D,YAAW,WACPs9D,EAAS/X,QACT+X,EAASnE,WACV,GAmDH,MAAMoE,EAAS,GACfA,EAAOj9E,KAAKo9E,EAAkB/K,GAAK,OAAQ,MAC3C4K,EAAOj9E,KAAKo9E,EAAkB/K,GAAK,SAAU,MAC7C4K,EAAOj9E,KAAKo9E,EAAkB/K,GAAK,QAAS,MAG5CC,GAAM,CACFtqE,OAAQhQ,SAAS0oD,KACjBtiB,QAAO,MAAQi0C,GAAK,4BACpBr5D,IAAKA,EACLq7D,WAAW,EACXe,aAAc,KACdzf,QAAS,CAAC,KAAM,UAChBrvB,SAAU,SAAUq3C,GAChB,IAAInZ,EAAS,KACK,OAAdmZ,IACAnZ,EAASmB,GAAGkX,eAAelY,SAASqY,EAAS3mF,QAEjDi9D,EAAEuiB,QAAQrR,cCzJtBoZ,GAAiB/mF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCsB/G,MCJM8mF,GAAqB,SAAUx+B,GACxC,MAAMrmC,EAAMhhB,SAASC,cAAc,OACnC+gB,EAAIiiE,cAAgB,SAAS3iF,GACzBA,EAAEk4D,kBAEN,IAAImsB,EAAQhX,GAAGkX,eAAe5Y,MAAM,IAAI0B,GAAG+W,IAAIr9B,EAAOs9B,MAAMv2D,EAAGi5B,EAAOs9B,MAAMtuB,EAAGhP,EAAOs9B,MAAM/kE,IAC5F+tD,GAAGgJ,IAAI31D,EAAK,CACR0yC,MAAOrM,EAAOqM,MAAQ,KACtBvgC,SAAU,WACVsnD,SAAU,SACVmI,WAAY,SAGhB,MAAMkD,EAAWnY,GAAGlZ,OAAO,GAAI,aAKtBsxB,IACL,MAAM9e,EAAM6e,EAASpxB,WAAW,MAChC,IAAK,IAAI/2D,EAAI,EAAGA,EAAImoF,EAASnyB,OAAQh2D,GAAK,EAAG,CACzC,MAAMqoF,EAAY/e,EAAIgf,qBAAqB,EAAG,EAAGH,EAASpyB,MAAO,GAE3DwyB,EAAUvY,GAAGkX,eAAe9Y,MAAM,IAAI4B,GAAGwY,IAAIxB,EAAMlxB,EAAG,EAAG,IAAO91D,EAAImoF,EAASnyB,OAAS,MACtFyyB,EAAWzY,GAAGkX,eAAe9Y,MAAM,IAAI4B,GAAGwY,IAAIxB,EAAMlxB,EAAG,IAAK,IAAO91D,EAAImoF,EAASnyB,OAAS,MAC/FqyB,EAAUK,aAAa,EAAG,IAAM1Y,GAAGkX,eAAe1Y,YAAY+Z,IAC9DF,EAAUK,aAAa,EAAG,IAAM1Y,GAAGkX,eAAe1Y,YAAYia,IAC9Dnf,EAAIC,UAAY,UAChBD,EAAIC,UAAY8e,EAChB/e,EAAIE,SAAS,EAAGxpE,EAAGmoF,EAASpyB,MAAO,IAf3CoyB,EAAStuE,MAAMk8C,MAAQrM,EAAOqM,MAAQ,KACtCoyB,EAAStuE,MAAMm8C,OAAStM,EAAOi/B,SAAW,KAC1CR,EAAStuE,MAAMooE,OAAS,YAiBxBmG,IAEA,MAAMQ,EAAU5Y,GAAGlZ,OAAOpN,EAAOqM,MAAOrM,EAAOm/B,SAC/CD,EAAQ/uE,MAAMooE,OAAS,uBAEnB,MAAM3Y,EAAMsf,EAAQ7xB,WAAW,MAEzB+xB,EAAQxf,EAAIgf,qBAAqB,EAAG,EAAG5+B,EAAOqM,MAAO,GAC3D,IAAK,IAAI/1D,EAAI,EAAGA,EAAI,EAAGA,GAAK,IAAM,CAC9B,MAAM+oF,EAAM/Y,GAAGkX,eAAe9Y,MAAM,IAAI4B,GAAGwY,IAAQ,IAAJxoF,EAAS,IAAK,MAC7D8oF,EAAMJ,aAAa1oF,EAAG,QAAU80C,SAAS,GAAKi0C,EAAIt4D,GAAK,KAAOqkB,SAAS,GAAKi0C,EAAIrwB,GAAK,KAAO5jB,SAAS,GAAKi0C,EAAI9mE,GAAK,QAEvHqnD,EAAIC,UAAYuf,EAChBxf,EAAIE,SAAS,EAAG,EAAG9f,EAAOqM,MAAOrM,EAAOm/B,YAG5C7Y,GAAGgJ,IAAImP,EAAU,CACbpyB,MAAOrM,EAAOqM,MAAQ,KACtBC,OAAQtM,EAAOi/B,SAAW,KAC1B7L,SAAU,SACVtnD,SAAU,aAEd2yD,EAAStuE,MAAM2pE,SAAW,OAC1BoF,EAAQ/uE,MAAM2pE,SAAW,OAEzBngE,EAAIxgB,YAAYslF,GAChB9kE,EAAIxgB,YAAY+lF,GAEhB,MAAMI,EAAY3mF,SAASC,cAAc,OACzC0tE,GAAGgJ,IAAIgQ,EAAW,CACdjzB,MAAO,MACPC,OAAQ,MACRqqB,aAAc,MACd7qD,SAAU,WACViwD,cAAe,OACf7H,UAAW,yCAEfv6D,EAAIxgB,YAAYmmF,GAEhB,MAAMC,EAAW5mF,SAASC,cAAc,gBAa/B4mF,IACL,MAAMnqE,EAAOioE,EAAM3tB,EAAI,IAAM3P,EAAOqM,MAAQ,EACtCyB,GAAO,EAAIwvB,EAAMhlE,EAAI,KAAO0nC,EAAOi/B,SAAW,EACpD3Y,GAAGgJ,IAAIgQ,EAAW,CACdjqE,KAAMA,EAAO,KACby4C,IAAKA,EAAM,gBASV2xB,IACLF,EAASpvE,MAAMkF,KAAQioE,EAAMlxB,EAAI,QAAUpM,EAAOqM,MAAQ,EAAK,KA3BnEia,GAAGgJ,IAAIiQ,EAAU,CACblzB,MAAO,IACPC,OAAQtM,EAAOm/B,QAAU,KACzBO,WAAY,iBACZC,YAAa,iBACb7zD,SAAU,WACVgiC,IAAK9N,EAAOi/B,SAAW,KACvBlD,cAAe,SAEnBpiE,EAAIxgB,YAAYomF,GAqBhBC,IACAC,IAEA,MAAMG,EAAa,CACfxzB,EAAG,EACHuD,EAAG,EACHr3C,EAAG,GAGP,IAAIunE,EAAc,KAClB,MAAMC,EAAoB,IAAIxZ,GAAGsW,gBAAgB,CAC7Cj0E,OAAQ81E,EACRhqB,YAAa,EACb+E,aAAa,EACbpF,UAAW,SAAS70C,GAmBhB,GAjBmB,gBAAfA,EAAMzmB,OACN+mF,EAActgE,EAAMo2C,UACC,SAAjBp2C,EAAMg3C,QAENqpB,EAAWjwB,EAAIpwC,EAAMy1C,KAAOhV,EAAOqM,MAAQ,IAC3CuzB,EAAWtnE,EAAI,IAAMiH,EAAM01C,KAAOjV,EAAOi/B,SAAW,IAEpD3B,EAAQ,IAAIhX,GAAGwY,IAAIxB,EAAMlxB,EAAGwzB,EAAWjwB,EAAGiwB,EAAWtnE,GAErDknE,IACAx/B,EAAO/Y,SAASq/B,GAAGkX,eAAe9Y,MAAM4Y,MAExCsC,EAAWjwB,EAAI2tB,EAAM3tB,EACrBiwB,EAAWtnE,EAAIglE,EAAMhlE,IAIV,gBAAfiH,EAAMzmB,MAA0B,CAAC,OAAQ,SAASgP,SAASyX,EAAMg3C,SAAWspB,IAAgBtgE,EAAMo2C,UAAW,CAE7G,IAAIoqB,EAAS,EACQ,UAAjBxgE,EAAMg3C,SACNwpB,EAAS,IAGbH,EAAWjwB,GAAKpwC,EAAMm4C,GAAK1X,EAAOqM,MAAQ,IAAM0zB,EAChDH,EAAWtnE,GAAKiH,EAAMo4C,GAAK3X,EAAOi/B,SAAW,IAAMc,EAEnDzC,EAAQ,IAAIhX,GAAGwY,IAAIxB,EAAMlxB,EAAGwzB,EAAWjwB,EAAGiwB,EAAWtnE,GACrDknE,IACAx/B,EAAO/Y,SAASq/B,GAAGkX,eAAe9Y,MAAM4Y,IAGzB,cAAf/9D,EAAMzmB,OACN+mF,EAAc,SAM1B,IAAIG,EAAa,KACjB,MAAMC,EAAmB,IAAI3Z,GAAGsW,gBAAgB,CAC5Cj0E,OAAQu2E,EACRzqB,YAAa,EACb+E,aAAa,EACbpF,UAAW,SAAS70C,GAiBhB,GAfmB,gBAAfA,EAAMzmB,OACNknF,EAAazgE,EAAMo2C,UACE,SAAjBp2C,EAAMg3C,QAENqpB,EAAWxzB,EAAI7sC,EAAMy1C,KAAOhV,EAAOqM,MAAQ,OAE3CixB,EAAQ,IAAIhX,GAAGwY,IAAIc,EAAWxzB,EAAGkxB,EAAM3tB,EAAG2tB,EAAMhlE,GAChDomE,IACAe,IACAz/B,EAAO/Y,SAASq/B,GAAGkX,eAAe9Y,MAAM4Y,KAExCsC,EAAWxzB,EAAIkxB,EAAMlxB,GAIV,gBAAf7sC,EAAMzmB,MAA0B,CAAC,OAAQ,SAASgP,SAASyX,EAAMg3C,SAAWypB,IAAezgE,EAAMo2C,UAAW,CAE5G,MAAMzC,EAASh7D,KAAKghB,IAAIqG,EAAM6zC,MAAQ7zC,EAAM25C,WACtC6mB,EAASxF,GAAwBrnB,EAAyB,UAAjB3zC,EAAMg3C,QAErDqpB,EAAWxzB,GAAK7sC,EAAMm4C,GAAK1X,EAAOqM,MAAQ,OAAS0zB,EAE9B,UAAjBxgE,EAAMg3C,SACNqpB,EAAWxzB,EAAIwzB,EAAWxzB,EAAI,OAC1BwzB,EAAWxzB,EAAI,IACfwzB,EAAWxzB,GAAK,SAGxBwzB,EAAWxzB,EAAIl0D,KAAK+O,IAAI,OAAQ24E,EAAWxzB,GAC3CkxB,EAAQ,IAAIhX,GAAGwY,IAAIc,EAAWxzB,EAAGkxB,EAAM3tB,EAAG2tB,EAAMhlE,GAChDomE,IACAe,IACAz/B,EAAO/Y,SAASq/B,GAAGkX,eAAe9Y,MAAM4Y,IAGzB,cAAf/9D,EAAMzmB,OACNknF,EAAa,SAMnBE,EAAWvnF,SAASC,cAAc,OACxCsnF,EAAS/vE,MAAMoQ,MAAQ,OACvB5G,EAAIxgB,YAAY+mF,GAGhB3lF,KAAK4lF,SAAW,SAAUxrD,GACtB2oD,EAAQhX,GAAGkX,eAAe5Y,MAAM,IAAI0B,GAAG+W,IAAI1oD,EAAE5N,EAAG4N,EAAEq6B,EAAGr6B,EAAEpc,IACvDmmE,IACAc,IACAC,KAEJllF,KAAK6lF,SAAW,WACZ,OAAO9Z,GAAGkX,eAAe9Y,MAAM4Y,IAEnC/iF,KAAKk9E,WAAa,WACd,OAAO99D,GAEXpf,KAAKu/D,QAAU,WACXgmB,EAAkBhmB,UAClBmmB,EAAiBnmB,WAErBv/D,KAAK8b,IAAM,WACPwpE,EAAc,KACdG,EAAa,OC5ORK,GAAc,SAASC,GAEhC,MAAM3mE,EAAMhhB,SAASC,cAAc,OACnC+gB,EAAIxJ,MAAM2b,SAAW,WACrB,MAAMy0D,EAAaja,GAAG1+D,GAAG,IACnB44E,EAAcla,GAAG1+D,GAAG,CACtB0nE,IAAK,CACDoJ,YAAa,gBAKrB,IAAI+H,EAFJ9mE,EAAIxgB,YAAYonF,GAChB5mE,EAAIxgB,YAAYqnF,GAEhB,IAAIE,GAAa,EAIbpa,GAAGgJ,IAAIiR,EAAY,CACfpL,UAAW/pC,SAAS,IAAMk1C,EAAMK,UAAY,EAAI,IAAM,KACtDr0B,OAAQ,MACR2nB,WAAY,OACZ5nB,MAAOi0B,EAAMj0B,MAAQ,OAITia,GAAG1+D,GAAG,CACtBga,OAAQ4+D,EACRlR,IAAK,CAEDsR,OAAQ,gBACRv0B,MAAO,oBACPC,OAAQ,+BAIPu0B,IACLL,EAAYrwE,MAAMkF,KAAOorE,EAAY,KAEjCD,EAAYrwE,MAAM+jE,UADlBwM,EAC8B,wBAEA,mCAG7BnJ,IACL,OAAOkJ,GAAcH,EAAMj0B,MAAQi0B,EAAMK,WAG7C,IAAIpE,EACJ,CACI,IAAIuE,EAcAC,EAbJN,EAAYna,GAAGj/B,MAAMi5C,EAAM1iD,MAAQ0iD,EAAMj0B,MAAQi0B,EAAMK,WAAY,EAAGL,EAAMj0B,MAAQi0B,EAAMK,WAC1Fra,GAAGgJ,IAAIkR,EAAa,CAChB10D,SAAU,WACVgiC,IAAK,MACLqsB,gBAAiB,UACjBjG,UAAW,0BACX7nB,MAAOi0B,EAAMK,UAAY,KACzBr0B,OAAQg0B,EAAMK,UAAY,KAC1BhK,aAAc2J,EAAMK,UAAY,KAChCpI,OAAQ,YACRyI,WAAY,gCAEhBH,IAEAtE,EAAkB,IAAIjW,GAAGsW,gBAAgB,CACrCj0E,OAAQ63E,EACRhnB,aAAa,EACbpF,UAAW,SAAS70C,GACG,gBAAfA,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,QACtCuqB,GAAU,EACVJ,GAAa,EACbK,EAAeN,EACfI,IACAthE,EAAMm3C,wBACgB,gBAAfn3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,SAC7Ch3C,EAAMm3C,uBACNqqB,GAA8BxhE,EAAMm4C,GACpC+oB,EAAYr1C,SAAS,GAAKk7B,GAAGj/B,MAAM05C,EAAc,EAAGT,EAAMj0B,MAAQi0B,EAAMK,YACxEE,IACAP,EAAMr5C,SAASswC,IAAYuJ,GAAS,GACpCA,GAAU,GAEK,cAAfvhE,EAAMzmB,OACNymB,EAAMm3C,uBACNgqB,GAAa,EACbG,IACAP,EAAMr5C,SAASswC,KAAY,GAAO,OAOlDh9E,KAAK0mF,MAAQ,WACT,OAAOtnE,GAEXpf,KAAK2mF,UAAY,SAASnI,GAElByH,EAAYrwE,MAAMgqE,gBADlBpB,EACoC,OAEA,WAG5Cx+E,KAAKu/D,QAAU,WACXyiB,EAAgBziB,YCnGXqnB,GAAe,SAASltB,GACjC,MAAMt6C,EAAM2sD,GAAG1+D,GAAG,CACd0H,QAAS2kD,EAAE5W,MAAQ4W,EAAE5W,MAAQ,GAC7BiyB,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZgF,YAAa,gBAIrB,IAAI0I,EAAgB,EACpB,MAAMC,EAAW,GACXC,EAAY,GAEZC,EAAajb,GAAGkb,qBAAqB,GAG3C,IAAK,IAAItwB,EAAI,EAAGA,EAAI+C,EAAEotB,SAAS9qF,OAAQ26D,IAAK,CACxC,MAAMhuC,EAAO+wC,EAAEotB,SAASnwB,GACxB,IAAIlQ,GAAQ,EACZ,IAAK,IAAI/nD,EAAI,EAAGA,EAAIooF,EAAS9qF,OAAQ0C,IAAK,CACtC,MAAMwoF,EAAQJ,EAASpoF,GACvB,GAAc,OAAVwoF,GAA2B,OAATv+D,IAGlBu+D,EAAM16D,IAAM7D,EAAK6D,GAAK06D,EAAMzyB,IAAM9rC,EAAK8rC,GAAKyyB,EAAMlpE,IAAM2K,EAAK3K,GAAKkpE,EAAM9+E,IAAMugB,EAAKvgB,GAAG,CACtFq+C,GAAQ,EACR,OAGJA,IAGJqgC,EAAS1gF,KAAKuiB,GACV,iBAAkB+wC,GAAKA,EAAEytB,eAAiBxwB,IAC1CkwB,EAAgBC,EAAS9qF,OAAS,IAI1C,IAAK,IAAIi6D,EAAI,EAAGA,EAAI6wB,EAAS9qF,OAAQi6D,KAAC,SACxBl6D,GAEN,MAAMqrF,EAAcrb,GAAG1+D,GAAG,CACtB0H,QAAS+xE,EAAS/qF,GAAK,GAAK,IAC5Bg5E,IAAK,CACDjjB,MAAOu1B,OACPt1B,OAAQs1B,OACRzH,gBAAiBkH,EAAS/qF,GAAKgwE,GAAGkX,eAAepY,UAAUic,EAAS/qF,IAAM,cAC1E8+E,WAAY,MACZlB,UAAW,iBACXqE,OAAQ,UACRgD,WAAY,OACZsG,UAAW,SACX7N,WAAa4N,OACbtE,MAAO,UAGX+D,EAAS/qF,IAAwB,IAAlB+qF,EAAS/qF,GAAGqM,IAC3Bg/E,EAAYxxE,MAAM6oE,gBAAkB,OAASuI,EAAa,KAG9DI,EAAY7M,QAAU,SAAS77E,GAC3BA,EAAEk4D,iBACFiwB,EAAgB9qF,EAChB0wC,IACAitB,EAAEwb,SAAS4R,EAAS/qF,KAGvBqrF,EAAoBG,cAAgB,SAASvpE,GACtCA,EACA+tD,GAAGgJ,IAAIqS,EAAa,CAChBzN,UAAW,mFACX6H,cAAe,SAGnBzV,GAAGgJ,IAAIqS,EAAa,CAChBzN,UAAW,iBACX6H,cAAe,MAM3BpiE,EAAIxgB,YAAYwoF,GAChBL,EAAU3gF,KAAKghF,GA7Ce,CA8C/BnxB,YAIExpB,IACL,IAAK,IAAI1wC,EAAI,EAAGA,EAAIgrF,EAAU/qF,OAAQD,IAClCgrF,EAAUhrF,GAAGwrF,cAAcxrF,IAAM8qF,GAGzCp6C,IAGAzsC,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAKu/D,QAAO,KACRwnB,EAAU1mD,SAAQ1X,IACdA,EAAK4xD,QAAU,QAEnBwM,EAAU7gD,OAAO,EAAG6gD,EAAU/qF,UCzGzBwrF,GAAU,SAAS9tB,GAC5B,MAAMt6C,EAAM2sD,GAAG1+D,GAAG,IAEZo6E,EAAY1b,GAAG1+D,GAAG,CACpBga,OAAQjI,EACR41D,UAAW,oBACXD,IAAK,CACDl/D,QAAS,UAIXioE,EAGA,GACN,IAAI4J,EAAa,cAAehuB,EAAIA,EAAEiuB,UAAYjuB,EAAEokB,UAAU,GAAG7hF,YAExD6iF,EAAa1U,GAClB,MAAMwd,EAAY,CACd3rF,GAAImuE,EAAEnuE,GACNoR,GAAI,MAGFw6E,EAAW,CAAC,aACdnuB,EAAEouB,SACFD,EAASzhF,KAAK,oBAEK,iBAAZgkE,EAAEtnB,QACT+kC,EAASzhF,KAAK,wBACd2lE,GAAGgJ,IAAI3K,EAAEtnB,MAAO,CACZjtC,QAAS,QACT2rE,cAAe,UAIvBoG,EAAUv6E,GAAK0+D,GAAG1+D,GAAG,CACjBga,OAAQogE,EACR1yE,QAASq1D,EAAEtnB,MACXkyB,UAAW6S,EAAS97E,KAAK,KACzBkpE,QAAS,WACDyS,IAAeE,EAAU3rF,KACzByrF,EAAaE,EAAU3rF,GACvBwwC,IACAitB,EAAEwb,SAASwS,OAKnBtd,EAAEsE,QACFkZ,EAAUv6E,GAAGqhE,MAAQtE,EAAEsE,OAG3BoP,EAAU13E,KAAKwhF,YAGVn7C,IACL,IAAK,IAAI1wC,EAAI,EAAGA,EAAI+hF,EAAU9hF,OAAQD,IAC9B+hF,EAAU/hF,GAAGE,KAAOyrF,EACpB3b,GAAGkO,aAAa6D,EAAU/hF,GAAGsR,GAAI,sBAEjC0+D,GAAGyR,gBAAgBM,EAAU/hF,GAAGsR,GAAI,sBAKhD,IAAK,IAAI4oD,EAAI,EAAGA,EAAIyD,EAAEokB,UAAU9hF,OAAQi6D,IACpC6oB,EAAaplB,EAAEokB,UAAU7nB,aAWpB8xB,IACL,IAAK,IAAIhsF,EAAI,EAAGA,EAAI+hF,EAAU9hF,OAAQD,IAClC,GAAI+hF,EAAU/hF,GAAGE,KAAOyrF,EACpB,OAAO3rF,EAXnB0wC,IAEIitB,EAAEsuB,cACFliE,YAAW,WACP4zC,EAAEwb,SAASwS,KACZ,GAYP1nF,KAAKk9E,WAAa,WACd,OAAO99D,GAEXpf,KAAKg9E,SAAW,WACZ,OAAO0K,GAEX1nF,KAAK6X,KAAO,WACR6vE,EAAa5J,GAAWiK,IAAa,GAAKjK,EAAU9hF,QAAQC,GAC5DwwC,IACAitB,EAAEwb,SAASwS,IAEf1nF,KAAK0nC,SAAW,WACZggD,EAAa5J,GAAWA,EAAU9hF,OAAS+rF,IAAa,GAAKjK,EAAU9hF,QAAQC,GAC/EwwC,IACAitB,EAAEwb,SAASwS,IAEf1nF,KAAKu/D,QAAO,KACRue,EAAUz9C,SAAQ1X,IACdojD,GAAGiP,UAAUryD,EAAKtb,OAEtBywE,EAAU53C,OAAO,EAAG43C,EAAU9hF,iBC3HtCisF,GAAiBhrF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,kBCgBtG+qF,GAASnC,GACrB,MAAM3mE,EAAMhhB,SAASC,cAAc,OAUnC,IAAI8pF,WACKC,IACLD,EAAO,CACH9pE,EAAG,EACHC,EAAG,EACHwzC,MAAOi0B,EAAMlzB,OAAOf,MACpBC,OAAQg0B,EAAMlzB,OAAOd,iBAMpBs2B,IACLC,EAAcx2B,MAAQn0D,KAAK4jC,MAAM4mD,EAAKr2B,OACtCw2B,EAAcv2B,OAASp0D,KAAK4jC,MAAM4mD,EAAKp2B,QAC7Bu2B,EAAcx1B,WAAW,MAC/B0e,UAAUuU,EAAMlzB,OAAQl1D,KAAK4jC,OAAO4mD,EAAK9pE,GAAI1gB,KAAK4jC,OAAO4mD,EAAK7pE,IAC9DiqE,IACAA,EAAazyE,IAAMwyE,EAAc5iB,UAAU,cAG3CqgB,EAAM7Q,UACN6Q,EAAM7Q,SAASoT,EAAcx2B,MAAOw2B,EAAcv2B,iBAGjDy2B,IACLzc,GAAGgJ,IAAI0T,EAAe,CAClB3tE,KAAO4tE,EAASP,EAAK9pE,EAAIsqE,EAAU,KACnCp1B,IAAMq1B,EAAST,EAAK7pE,EAAIuqE,EAAU,KAClC/2B,MAAQq2B,EAAKr2B,MAAQ62B,EAAU,KAC/B52B,OAASo2B,EAAKp2B,OAAS82B,EAAU,OAEjC9C,EAAM7Q,UACN6Q,EAAM7Q,SAASv3E,KAAK4jC,MAAM4mD,EAAKr2B,OAAQn0D,KAAK4jC,MAAM4mD,EAAKp2B,SA1C/Dga,GAAGgJ,IAAI31D,EAAK,CACRmS,SAAU,WACVwgC,OAAQg0B,EAAMh0B,OAAS,KACvBD,MAAOi0B,EAAMj0B,MAAQ,KACrB+mB,SAAU,SACVsF,YAAa,eAEjB/+D,EAAIxJ,MAAM2b,SAAW,WAWrB62D,IAsCA,MAAME,EAAgBvc,GAAGlZ,SACzB,IAAIi2B,EAAcR,EACdC,EAAe,KACdxC,EAAMgD,YACPR,EAAe,IAAIS,MACnBF,EAAcP,GAElBxc,GAAGgJ,IAAI+T,EAAa,CAChB/2B,OAAQg0B,EAAMh0B,OAAS,KACvBD,MAAOi0B,EAAMj0B,MAAQ,OAEzB1yC,EAAIxgB,YAAYkqF,GAChBT,IAEA,MACMY,EAAiBld,GAAG1+D,GAAG,CACzB0nE,IAAK,CACDjjB,MAAOi0B,EAAMj0B,MAAQ,KACrBC,OAAQg0B,EAAMh0B,OAAS,KACvBxgC,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLiuB,cAAe,UAGvBpiE,EAAIxgB,YAAYqqF,GAChBld,GAAGkb,qBAAqB,GAAG,SAASlpE,GAChCkrE,EAAerzE,MAAM6oE,gBAAkB,OAAO1gE,EAAE,OAGpD,MAAMmrE,EAAYnd,GAAGod,QAAQpD,EAAMlzB,OAAOf,MAAOi0B,EAAMlzB,OAAOd,OAAQg0B,EAAMj0B,MAAQosB,GAAa6H,EAAMh0B,OAASmsB,GAAa,GACvHkL,EAAcrd,GAAGlZ,OAAOl1D,KAAK4jC,MAAM2nD,EAAUp3B,OAAQn0D,KAAK4jC,MAAM2nD,EAAUn3B,SAChFq3B,EAAYxzE,MAAMyzE,eAAiB,YACnC,MAAMV,EAASS,EAAYt3B,MAAQi0B,EAAMlzB,OAAOf,MAC1C+2B,EAASO,EAAYr3B,OAASg0B,EAAMlzB,OAAOd,OAC3Cu3B,EAAWF,EAAYt2B,WAAW,MACxCw2B,EAASpX,uBAAwB,EACjCoX,EAAS9X,UAAUuU,EAAMlzB,OAAQ,EAAG,EAAGu2B,EAAYt3B,MAAOs3B,EAAYr3B,QACtEk3B,EAAerqF,YAAYwqF,GAC3B,MAAMV,EAAS73C,SAAS,IAAOk1C,EAAMj0B,MAAQs3B,EAAYt3B,OAAS,GAC5D82B,EAAS/3C,SAAS,IAAOk1C,EAAMh0B,OAASq3B,EAAYr3B,QAAU,GACpEga,GAAGgJ,IAAIqU,EAAa,CAChB73D,SAAU,WACVzW,KAAM4tE,EAAS,KACfn1B,IAAKq1B,EAAS,OAGlB,MAAMH,EAAgB1c,GAAG1+D,GAAG,CACxB0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,gEAOV4P,EAAgB7vB,GACrB,MAAO,CACHr7C,EAAG0tD,GAAGj/B,OAAO4sB,EAAEr7C,EAAIqqE,GAAUC,EAAQ,EAAG5C,EAAMlzB,OAAOf,OACrDxzC,EAAGytD,GAAGj/B,OAAO4sB,EAAEp7C,EAAIsqE,GAAUC,EAAQ,EAAG9C,EAAMlzB,OAAOd,kBAIpDy3B,EAAQhyB,EAAIC,GACjB,IAAIgyB,EAAW,CACXprE,EAAG1gB,KAAK+O,IAAI8qD,EAAGn5C,EAAGo5C,EAAGp5C,GACrBC,EAAG3gB,KAAK+O,IAAI8qD,EAAGl5C,EAAGm5C,EAAGn5C,IAErBorE,EAAe,CACfrrE,EAAG1gB,KAAK6O,IAAIgrD,EAAGn5C,EAAGo5C,EAAGp5C,GACrBC,EAAG3gB,KAAK6O,IAAIgrD,EAAGl5C,EAAGm5C,EAAGn5C,IAErBqrE,EAAeJ,EAAgBE,GAC/BG,EAAmBL,EAAgBG,GAKvC,OAJAC,EAAatrE,EAAI1gB,KAAKyO,MAAMu9E,EAAatrE,GACzCsrE,EAAarrE,EAAI3gB,KAAKyO,MAAMu9E,EAAarrE,GACzCsrE,EAAiBvrE,EAAI1gB,KAAKuO,KAAK09E,EAAiBvrE,GAChDurE,EAAiBtrE,EAAI3gB,KAAKuO,KAAK09E,EAAiBtrE,GACzC,CACHD,EAAGsrE,EAAatrE,EAChBC,EAAGqrE,EAAarrE,EAChBwzC,MAAO83B,EAAiBvrE,EAAIsrE,EAAatrE,EACzC0zC,OAAQ63B,EAAiBtrE,EAAIqrE,EAAarrE,YAIzCurE,IACL,OAAkB,IAAX1B,EAAK9pE,GAAsB,IAAX8pE,EAAK7pE,GAAW6pE,EAAKr2B,QAAUi0B,EAAMlzB,OAAOf,OAASq2B,EAAKp2B,SAAWg0B,EAAMlzB,OAAOd,OAG7G,IAAI+3B,EAtCJb,EAAerqF,YAAY6pF,GAC3BD,IAsCA,IAGIuB,EAHAC,EAAY,KACZ7D,GAAa,EACb8D,GAAU,EAEd,MAAMjI,EAAkB,IAAIjW,GAAGsW,gBAAgB,CAC3Cj0E,OAAQ06E,EACR7pB,aAAa,EACbpF,UAAW,SAAS70C,GAEG,gBAAfA,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,QACtCh3C,EAAMk3C,sBACNiqB,GAAa,EACb2D,EAAS,CACLzrE,EAAG2G,EAAMy1C,KACTn8C,EAAG0G,EAAM01C,OAERmvB,cAvHcnwB,GAC3B,IAAIwwB,EACGvsF,KAAK4jC,MAAMmnD,EAASP,EAAK9pE,EAAIsqE,GADhCuB,EAEGvsF,KAAK4jC,MAAMqnD,EAAST,EAAK7pE,EAAIuqE,GAFhCqB,EAGOvsF,KAAK4jC,MAAM4mD,EAAKr2B,MAAQ62B,GAH/BuB,EAIQvsF,KAAK4jC,MAAM4mD,EAAKp2B,OAAS82B,GAErC,OAAOqB,GAAUxwB,EAAEr7C,GAAKq7C,EAAEr7C,GAAK6rE,EAASA,GACpCA,GAAUxwB,EAAEp7C,GAAKo7C,EAAEp7C,GAAK4rE,EAASA,EA+GXC,CAAsBL,GACpCE,EAAY,CACR3rE,EAAG8pE,EAAK9pE,EACRC,EAAG6pE,EAAK7pE,EACRwzC,MAAOq2B,EAAKr2B,MACZC,OAAQo2B,EAAKp2B,QAGjBo2B,EAAOqB,EAAQM,EAAQA,IAEL,gBAAf9kE,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,QAC7Ch3C,EAAMk3C,sBACN+tB,GAAU,EACND,GACA7B,EAAK9pE,EAAI2rE,EAAU3rE,EAAI1gB,KAAK4jC,OAAOvc,EAAMy1C,KAAOqvB,EAAOzrE,GAAKsqE,GAC5DR,EAAK7pE,EAAI0rE,EAAU1rE,EAAI3gB,KAAK4jC,OAAOvc,EAAM01C,KAAOovB,EAAOxrE,GAAKuqE,GAC5DV,EAAK9pE,EAAI0tD,GAAGj/B,MAAMq7C,EAAK9pE,EAAG,EAAG0nE,EAAMlzB,OAAOf,MAAQq2B,EAAKr2B,OACvDq2B,EAAK7pE,EAAIytD,GAAGj/B,MAAMq7C,EAAK7pE,EAAG,EAAGynE,EAAMlzB,OAAOd,OAASo2B,EAAKp2B,SAExDo2B,EAAOqB,EAAQM,EAAQ,CAACzrE,EAAG2G,EAAMy1C,KAAMn8C,EAAG0G,EAAM01C,OAEpD8tB,KACsB,cAAfxjE,EAAMzmB,MAAwBurF,IACrC9kE,EAAMk3C,sBACNiqB,GAAa,EACb6D,EAAY,KACZF,EAAS,KACU,IAAf3B,EAAKr2B,OAA+B,IAAhBq2B,EAAKp2B,QAAiBk4B,IAC1C7B,IACAI,KAEJyB,GAAU,EACVF,EAAoBjkE,WAAWuiE,EAAqB,OAK1DvxB,EAAc,IAAIiV,GAAGmO,YAAY,CACnCrE,OAAQ,SAAS3hB,EAAQx1D,EAAGy7E,GACxB,GAAIgM,EACA,OAEJ,IAAIiE,GAAW,EAEXhZ,EAAWzzE,KAAK6O,IAAI,EAAG,EAAIm8E,GAC3BzkB,EAAiBpN,EAAY0e,UAAU,SAE5B,SAAXthB,IACIgQ,EACAikB,EAAKr2B,MAAQia,GAAGj/B,MAAMq7C,EAAKr2B,MAAQsf,EAAU,EAAG2U,EAAMlzB,OAAOf,MAAQq2B,EAAK9pE,GAE1E8pE,EAAK9pE,EAAI0tD,GAAGj/B,MAAMq7C,EAAK9pE,EAAI+yD,EAAU,EAAG2U,EAAMlzB,OAAOf,MAAQq2B,EAAKr2B,OAEtEs4B,GAAW,GAEA,UAAXl2B,IACIgQ,EACAikB,EAAKr2B,MAAQia,GAAGj/B,MAAMq7C,EAAKr2B,MAAQsf,EAAU,EAAG2U,EAAMlzB,OAAOf,MAAQq2B,EAAK9pE,GAE1E8pE,EAAK9pE,EAAI0tD,GAAGj/B,MAAMq7C,EAAK9pE,EAAI+yD,EAAU,EAAG2U,EAAMlzB,OAAOf,MAAQq2B,EAAKr2B,OAEtEs4B,GAAW,GAEA,OAAXl2B,IACIgQ,EACAikB,EAAKp2B,OAASga,GAAGj/B,MAAMq7C,EAAKp2B,OAASqf,EAAU,EAAG2U,EAAMlzB,OAAOd,OAASo2B,EAAK7pE,GAE7E6pE,EAAK7pE,EAAIytD,GAAGj/B,MAAMq7C,EAAK7pE,EAAI8yD,EAAU,EAAG2U,EAAMlzB,OAAOd,OAASo2B,EAAKp2B,QAEvEq4B,GAAW,GAEA,SAAXl2B,IACIgQ,EACAikB,EAAKp2B,OAASga,GAAGj/B,MAAMq7C,EAAKp2B,OAASqf,EAAU,EAAG2U,EAAMlzB,OAAOd,OAASo2B,EAAK7pE,GAE7E6pE,EAAK7pE,EAAIytD,GAAGj/B,MAAMq7C,EAAK7pE,EAAI8yD,EAAU,EAAG2U,EAAMlzB,OAAOd,OAASo2B,EAAKp2B,QAEvEq4B,GAAW,GAGXA,IACA1rF,EAAEk4D,iBACF4xB,IACAvvB,aAAa8wB,GACbA,EAAoBjkE,WAAWuiE,EAAqB,SAKhEroF,KAAK0mF,MAAQ,WACT,OAAOtnE,GAEXpf,KAAKqqF,MAAQ,WACTjC,IACAC,IACAG,KAEJxoF,KAAKu/D,QAAU,WACXupB,EAAYlzE,MAAM00E,eAAe,SACjCxB,EAAYlzE,MAAM00E,eAAe,UACjCxzB,EAAYyI,UACZyiB,EAAgBziB,WAEpBv/D,KAAK6pF,QAAU,WACX,OAAOA,KAEX7pF,KAAKuqF,QAAU,WACX,OAAOhrF,KAAKC,MAAMD,KAAK8zD,UAAU80B,KAErCnoF,KAAKwqF,gBAAkB,WACnB,OAAOlC,UCpSfmC,GAAiBxtF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHutF,GAAiBztF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHwtF,GAAiB1tF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHytF,GAAiB3tF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCgBnH,SACM0tF,GAAS57E,EAAM6iD,EAAOhjB,EAAIE,EAAID,EAAIE,GACvC,IAAK,IAAI5wB,EAAIywB,EAAIzwB,GAAK0wB,EAAI1wB,IACtB,IAAK,IAAIC,EAAI0wB,EAAI1wB,GAAK2wB,EAAI3wB,IACM,MAAxBrP,EAAKqP,EAAIwzC,EAAQzzC,KAGrBpP,EAAKqP,EAAIwzC,EAAQzzC,GAAK,KAKlC,IAAIysE,GAAIC,GAYL,SACMC,GAAUl5B,EAAOC,EAAQh2D,EAAGohE,EAAIC,GAIrC,OAHA0tB,GAAK/uF,EAAI+1D,EAAQqL,EACjB4tB,GAAKptF,KAAKyO,MAAMrQ,EAAI+1D,GAASsL,EAEzB0tB,GAAK,GAAKC,GAAK,GAAKD,IAAMh5B,GAASi5B,IAAMh5B,EAClC,KAGJg5B,GAAKj5B,EAAQg5B,GAerB,SACMG,GAAYC,EAAQC,EAAWr5B,EAAOC,EAAQq5B,EAAUC,EAAWtvF,GACxE,OAAU,OAANA,GAA+B,MAAjBovF,EAAUpvF,MAKxBmvF,EAAW,EAAJnvF,KAAWqvF,EAAS,IAC3BF,EAAW,EAAJnvF,EAAQ,KAAOqvF,EAAS,IAC/BF,EAAW,EAAJnvF,EAAQ,KAAOqvF,EAAS,IAC/BF,EAAW,EAAJnvF,EAAQ,KAAOqvF,EAAS,IAO/BC,EAAY,GACZ1tF,KAAKghB,IAAIusE,EAAW,EAAJnvF,GAASqvF,EAAS,KAAOC,GACzC1tF,KAAKghB,IAAIusE,EAAW,EAAJnvF,EAAQ,GAAKqvF,EAAS,KAAOC,GAC7C1tF,KAAKghB,IAAIusE,EAAW,EAAJnvF,EAAQ,GAAKqvF,EAAS,KAAOC,GAC7C1tF,KAAKghB,IAAIusE,EAAW,EAAJnvF,EAAQ,GAAKqvF,EAAS,KAAOC,KAT7CF,EAAUpvF,GAAK,KACR,aAyKCuvF,GAAcC,EAASz5B,EAAOC,EAAQ1zC,EAAGC,EAAG+sE,EAAWG,EAAMC,GACzEptE,EAAI1gB,KAAK4jC,MAAMljB,GACfC,EAAI3gB,KAAK4jC,MAAMjjB,GAEf,IAAIgzD,EAAY,IAAIp6C,WAAW,IAAItB,YAAYk8B,EAAQC,IAIvD,OApJD,SACgBm5B,EAAQC,EAAWr5B,EAAOC,EAAQ25B,EAAIC,EAAIN,EAAWG,EAAMC,GAE1E,IA6CI38C,EAAIC,EAAIC,EAAIC,EACZsnC,EAAGqV,EAAI/7C,EAAGg8C,EAAIr/D,EAAGs/D,EAAI9tE,EAAG+tE,EA9CxBX,EAAW,CACXF,EAA2B,GAAnBS,EAAK75B,EAAQ45B,IACrBR,EAA2B,GAAnBS,EAAK75B,EAAQ45B,GAAU,GAC/BR,EAA2B,GAAnBS,EAAK75B,EAAQ45B,GAAU,GAC/BR,EAA2B,GAAnBS,EAAK75B,EAAQ45B,GAAU,IAGnC,GAAID,EAAc,CACd,IAII1vF,EAAG2C,EAJHgkD,EAAI,OACRA,EAAEt8C,KAAKulF,EAAK75B,EAAQ45B,GACpBP,EAAUQ,EAAK75B,EAAQ45B,GAAM,IAGtBhpC,EAAE1mD,QACLD,EAAI2mD,EAAEwF,MAGNxpD,EAAIssF,GAAUl5B,EAAOC,EAAQh2D,GAAG,EAAI,GACpCkvF,GAAYC,EAAQC,EAAWr5B,EAAOC,EAAQq5B,EAAUC,EAAW3sF,IAAMgkD,EAAEt8C,KAAK1H,GAEhFA,EAAIssF,GAAUl5B,EAAOC,EAAQh2D,EAAG,EAAG,GACnCkvF,GAAYC,EAAQC,EAAWr5B,EAAOC,EAAQq5B,EAAUC,EAAW3sF,IAAMgkD,EAAEt8C,KAAK1H,GAEhFA,EAAIssF,GAAUl5B,EAAOC,EAAQh2D,EAAG,GAAG,GACnCkvF,GAAYC,EAAQC,EAAWr5B,EAAOC,EAAQq5B,EAAUC,EAAW3sF,IAAMgkD,EAAEt8C,KAAK1H,GAEhFA,EAAIssF,GAAUl5B,EAAOC,EAAQh2D,EAAG,EAAG,GACnCkvF,GAAYC,EAAQC,EAAWr5B,EAAOC,EAAQq5B,EAAUC,EAAW3sF,IAAMgkD,EAAEt8C,KAAK1H,QAGpF,IAAK,IAAI3C,EAAI,EAAGA,EAAI+1D,EAAQC,EAAQh2D,IAChCkvF,GAAYC,EAAQC,EAAWr5B,EAAOC,EAAQq5B,EAAUC,EAAWtvF,GAM3E,GAAa,IAATyvF,EAAJ,CAUA,IAAK,IAAIntE,EAAI,EAAGA,EAAIyzC,EAAOzzC,IACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIyzC,EAAQzzC,IACS,MAA7B6sE,EAAU7sE,EAAIwzC,EAAQzzC,KAK1BywB,EAAKzwB,EACL0wB,EAAK1wB,EACL2wB,EAAK1wB,EACL2wB,EAAK3wB,EAELi4D,EAAuC,MAAnC4U,EAAW7sE,EAAKwzC,EAAQzzC,EAAI,GAChCutE,EAA4C,MAAvCT,GAAW7sE,EAAI,GAAKwzC,EAAQzzC,EAAI,GACrCwxB,EAAuC,MAAnCs7C,GAAW7sE,EAAI,GAAKwzC,EAAQzzC,GAChCwtE,EAA4C,MAAvCV,GAAW7sE,EAAI,GAAKwzC,EAAQzzC,EAAI,GACrCmO,EAAuC,MAAnC2+D,EAAW7sE,EAAKwzC,EAAQzzC,EAAI,GAChCytE,EAA4C,MAAvCX,GAAW7sE,EAAI,GAAKwzC,EAAQzzC,EAAI,GACrCL,EAAuC,MAAnCmtE,GAAW7sE,EAAI,GAAKwzC,EAAQzzC,GAChC0tE,EAA4C,MAAvCZ,GAAW7sE,EAAI,GAAKwzC,EAAQzzC,EAAI,GAEjCk4D,IACAznC,EAAKzwB,EAAImtE,GAETjV,GAAKqV,GAAM/7C,IACXf,EAAKzwB,EAAImtE,EACTx8C,EAAK1wB,EAAIktE,GAET37C,IACAb,EAAKrxC,KAAK+O,IAAIsiC,EAAI1wB,EAAIktE,IAEtB37C,GAAKg8C,GAAMr/D,IACXwiB,EAAKrxC,KAAK+O,IAAIsiC,EAAI1wB,EAAIktE,GACtBz8C,EAAK1wB,EAAImtE,GAETh/D,IACAuiB,EAAKpxC,KAAK6O,IAAIuiC,EAAI1wB,EAAI,EAAImtE,IAE1Bh/D,GAAKs/D,GAAM9tE,IACX+wB,EAAKpxC,KAAK6O,IAAIuiC,EAAI1wB,EAAI,EAAImtE,GAC1Bv8C,EAAKtxC,KAAK6O,IAAIyiC,EAAI3wB,EAAI,EAAIktE,IAE1BxtE,IACAixB,EAAKtxC,KAAK6O,IAAIyiC,EAAI3wB,EAAI,EAAIktE,IAE1BxtE,GAAK+tE,GAAMxV,IACXznC,EAAKnxC,KAAK+O,IAAIoiC,EAAIzwB,EAAI,EAAImtE,GAC1Bv8C,EAAKtxC,KAAK6O,IAAIyiC,EAAI3wB,EAAI,EAAIktE,KAGzBjV,GAAMqV,GAAO/7C,GAAMg8C,GAAOr/D,GAAMs/D,GAAO9tE,GAAM+tE,IAIlDlB,GACIM,EACAr5B,EACAn0D,KAAK6O,IAAI,EAAGsiC,GACZnxC,KAAK6O,IAAI,EAAGwiC,GACZrxC,KAAK+O,IAAIolD,EAAQ,EAAG/iB,GACpBpxC,KAAK+O,IAAIqlD,EAAS,EAAG9iB,KAIjC,IAAK,IAAIgnB,EAAI,EAAGA,EAAInE,EAAQC,EAAQkE,IACX,MAAjBk1B,EAAUl1B,KACVk1B,EAAUl1B,GAAK,MA8BvB+1B,CAAUT,EAASja,EAAWxf,EAAOC,EAAQ1zC,EAAGC,EAAG+sE,EAAWG,EAAMC,GAE7D,CACHx8E,KAAMqiE,YC1NE2a,GACZ5mB,EACA6mB,GAGA,IAAI,CAAC,OAAQ,UAAW,QAAQ3+E,SAAS2+E,EAAS3tF,MAsS9C,MAAM,IAAIpC,MAAM,iBAtSqC,CACrD,MAAMgwF,EAAYxuF,KAAK4jC,MAAM2qD,EAASC,WAChCva,EAA+B,IAApBsa,EAASjpB,SAAiBtlE,KAAKuvC,GAGhDm4B,EAAI4M,OACAia,EAASrM,UACTxa,EAAI+mB,YAAcF,EAASrM,SAE3BqM,EAASG,WACThnB,EAAIwO,yBAA2B,mBAEnCxO,EAAIgN,QAAQ6Z,EAASjpB,UACjBipB,EAASI,QACTjnB,EAAIC,UAAYyG,GAAGkX,eAAetY,SAASuhB,EAASI,SAC7CJ,EAASK,YAChBlnB,EAAImnB,YAAczgB,GAAGkX,eAAetY,SAASuhB,EAASK,WACtDlnB,EAAI8mB,UAAYA,GAGpB,IAAIp9C,EAAKm9C,EAASn9C,GACdE,EAAKi9C,EAASj9C,GACdwgC,EAAKyc,EAASzc,GACdzH,EAAKkkB,EAASlkB,GAGlB,GAAIkkB,EAASO,YAAa,CACtB,IAAIC,EAAK3gB,GAAGsG,OAAOtjC,EAAIE,EAAIi9C,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KACrDy/C,EAAK5gB,GAAGsG,OAAO5C,EAAIzH,EAAIkkB,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KAErD0/C,EAAY7gB,GAAG8gB,iBAAiBH,EAAIC,GAAM,GAC1CG,EAAgD,GAA7BnvF,KAAK4jC,MAAMqrD,EAAY,IAC1CG,EAAUhhB,GAAGihB,aAAa,CAAC3uE,EAAG0wB,EAAIzwB,EAAG2wB,GAAK,CAAC5wB,EAAGoxD,EAAInxD,EAAG0pD,GAAK8kB,EAAmBF,GACjFnd,EAAKsd,EAAQ1uE,EACb2pD,EAAK+kB,EAAQzuE,GAGRszD,EAAWkb,GAAoB,IAAO,IACnCnvF,KAAK4jC,OAAOqwC,EAAWkb,GAAoB,IAAM,GAAM,EACvDrd,EAAK1gC,EAELi5B,EAAK/4B,GAKjB,IAkDIuoB,EACAC,EAnDAp5C,EAAI0wB,EACJzwB,EAAI2wB,EACJkuB,EAAKsS,EAAK1gC,EACVquB,EAAK4K,EAAK/4B,EAGd,GAAsB,SAAlBi9C,EAAS3tF,MAAmB2tF,EAASe,aAAc,CACnD,IAAIP,EAAK3gB,GAAGsG,OAAO6Z,EAASn9C,GAAIm9C,EAASj9C,GAAIi9C,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KACvEy/C,EAAK5gB,GAAGsG,OAAO6Z,EAASzc,GAAIyc,EAASlkB,GAAIkkB,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KAEvElZ,EAAK04D,EAAGruE,EACR6uE,EAAKR,EAAGpuE,EACR6uE,EAAMR,EAAGtuE,EAAIquE,EAAGruE,EAChB+uE,EAAMT,EAAGruE,EAAIouE,EAAGpuE,EAEhB3gB,KAAKghB,IAAIwuE,GAAOxvF,KAAKghB,IAAIyuE,GACzBA,EAAMzvF,KAAKghB,IAAIwuE,IAAQC,EAAM,GAAI,EAAK,GAEtCD,EAAMxvF,KAAKghB,IAAIyuE,IAAQD,EAAM,GAAI,EAAK,GAE1CR,EAAGtuE,EAAI2V,EAAKm5D,EACZR,EAAGruE,EAAI4uE,EAAKE,EAEZV,EAAK3gB,GAAGsG,OAAOqa,EAAGruE,EAAGquE,EAAGpuE,GAAI4tE,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KAC1Dy/C,EAAK5gB,GAAGsG,OAAOsa,EAAGtuE,EAAGsuE,EAAGruE,GAAI4tE,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KAE1D6B,EAAK29C,EAAGruE,EACR4wB,EAAKy9C,EAAGpuE,EACRmxD,EAAKkd,EAAGtuE,EACR2pD,EAAK2kB,EAAGruE,EAERD,EAAI0wB,EACJzwB,EAAI2wB,EACJkuB,EAAKsS,EAAK1gC,EACVquB,EAAK4K,EAAK/4B,EAkBd,GAdIi9C,EAASmB,aACThvE,GAAK8+C,EACL7+C,GAAK8+C,EACLD,GAAM,EACNC,GAAM,EAENruB,EAAK1wB,EACL4wB,EAAK3wB,EACLmxD,EAAKpxD,EAAI8+C,EACT6K,EAAK1pD,EAAI8+C,GAKS,SAAlB8uB,EAAS3tF,KAAiB,CAG1B,MAAM+uF,EAAM3vF,KAAK4jC,MAAMwN,GACjBw+C,EAAM5vF,KAAK4jC,MAAM0N,GACjBu+C,EAAM7vF,KAAK4jC,MAAMkuC,GACjBge,EAAM9vF,KAAK4jC,MAAMymC,GAGjB0lB,EAAM/vF,KAAKyO,MAAM2iC,GACjB4+C,EAAMhwF,KAAKyO,MAAM6iC,GACjB2+C,EAAMjwF,KAAKyO,MAAMqjE,GACjBoe,EAAMlwF,KAAKyO,MAAM47D,GAEnBmkB,EAAY,GAAM,EAEdoB,IAAQE,GACRj2B,EAAK,CACDn5C,EAAGqvE,EACHpvE,EAAGivE,GAEP91B,EAAK,CACDp5C,EAAGuvE,EACHtvE,EAAGmvE,GAGHC,EAAME,EACNn2B,EAAGp5C,GAAK,EAERm5C,EAAGn5C,GAAK,GAELivE,IAAQE,GACfh2B,EAAK,CACDn5C,EAAGivE,EACHhvE,EAAGqvE,GAEPl2B,EAAK,CACDp5C,EAAGmvE,EACHlvE,EAAGuvE,GAGHF,EAAME,EACNp2B,EAAGn5C,GAAK,EAERk5C,EAAGl5C,GAAK,IAGZk5C,EAAK,CACDn5C,EAAG0wB,EACHzwB,EAAG2wB,GAEPwoB,EAAK,CACDp5C,EAAGoxD,EACHnxD,EAAG0pD,KAKXxQ,EAAK,CACDn5C,EAAGqvE,EACHpvE,EAAGqvE,GAEPl2B,EAAK,CACDp5C,EAAGuvE,EACHtvE,EAAGuvE,GAEHF,IAAQE,GACJH,EAAME,EACNn2B,EAAGp5C,GAAK,EAERm5C,EAAGn5C,GAAK,EAEZm5C,EAAGl5C,GAAK,GACRm5C,EAAGn5C,GAAK,IACDovE,IAAQE,GACXD,EAAME,EACNp2B,EAAGn5C,GAAK,EAERk5C,EAAGl5C,GAAK,EAEZk5C,EAAGn5C,GAAK,GACRo5C,EAAGp5C,GAAK,KAERm5C,EAAGn5C,EAAI0wB,EACPyoB,EAAGl5C,EAAI2wB,EACPwoB,EAAGp5C,EAAIoxD,EACPhY,EAAGn5C,EAAI0pD,IAIfxQ,EAAKuU,GAAGsG,OAAO7a,EAAGn5C,EAAGm5C,EAAGl5C,EAAG4tE,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KACzDuqB,EAAKsU,GAAGsG,OAAO5a,EAAGp5C,EAAGo5C,EAAGn5C,EAAG4tE,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KAEzDm4B,EAAIyoB,YACJzoB,EAAI0oB,OAAOv2B,EAAGn5C,EAAGm5C,EAAGl5C,GACpB+mD,EAAI2oB,OAAOv2B,EAAGp5C,EAAGo5C,EAAGn5C,GACpB+mD,EAAI4oB,cAED,GAAsB,SAAlB/B,EAAS3tF,KAAiB,CAGjC,MAAMmvF,EAAM/vF,KAAKyO,MAAM2iC,GACjB4+C,EAAMhwF,KAAKyO,MAAM6iC,GACjB2+C,EAAMjwF,KAAKyO,MAAMqjE,GACjBoe,EAAMlwF,KAAKyO,MAAM47D,GAEnB4J,EAAW,IAAO,EACdsa,EAASI,SACLv9C,EAAK,GAAM,IACXA,GAAM,GAENE,EAAK,GAAM,IACXA,GAAM,GAENwgC,EAAK,GAAM,IACXA,GAAM,GAENzH,EAAK,GAAM,IACXA,GAAM,GAGVxQ,EAAK,CACDn5C,EAAG0wB,EAAK0gC,EAAKie,EAAME,EACnBtvE,EAAG2wB,EAAK+4B,EAAK2lB,EAAME,GAEvBp2B,EAAK,CACDp5C,EAAG1gB,KAAKuO,MAAM6iC,EAAK0gC,EAAKA,EAAK1gC,GAAMyoB,EAAGn5C,GACtCC,EAAG3gB,KAAKuO,MAAM+iC,EAAK+4B,EAAKA,EAAK/4B,GAAMuoB,EAAGl5C,IAE1Cm5C,EAAGp5C,EAAIm5C,EAAGn5C,EAAIo5C,EAAGp5C,EACjBo5C,EAAGn5C,EAAIk5C,EAAGl5C,EAAIm5C,EAAGn5C,GAGb6tE,EAAY,GAAM,GAClB30B,EAAK,CACDn5C,EAAGqvE,EACHpvE,EAAGqvE,GAEPl2B,EAAK,CACDp5C,EAAGuvE,EACHtvE,EAAGuvE,KAGPr2B,EAAK,CACDn5C,EAAGqvE,EAAM,GACTpvE,EAAGqvE,EAAM,IAEbl2B,EAAK,CACDp5C,EAAGuvE,EAAM,GACTtvE,EAAGuvE,EAAM,MAKrBr2B,EAAK,CACDn5C,EAAG0wB,EACHzwB,EAAG2wB,GAEPwoB,EAAK,CACDp5C,EAAGoxD,EACHnxD,EAAG0pD,IAIXxQ,EAAKuU,GAAGsG,OAAO7a,EAAGn5C,EAAGm5C,EAAGl5C,EAAG4tE,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KACzDuqB,EAAKsU,GAAGsG,OAAO5a,EAAGp5C,EAAGo5C,EAAGn5C,EAAG4tE,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KACzDuqB,EAAGp5C,EAAIo5C,EAAGp5C,EAAIm5C,EAAGn5C,EACjBo5C,EAAGn5C,EAAIm5C,EAAGn5C,EAAIk5C,EAAGl5C,EAEb4tE,EAASI,QACTjnB,EAAIE,SAAS/N,EAAGn5C,EAAGm5C,EAAGl5C,EAAGm5C,EAAGp5C,EAAGo5C,EAAGn5C,GAElC+mD,EAAI6oB,WAAW12B,EAAGn5C,EAAGm5C,EAAGl5C,EAAGm5C,EAAGp5C,EAAGo5C,EAAGn5C,QAIxCk5C,EAAKuU,GAAGsG,OAAOtjC,EAAIE,EAAIi9C,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KACrDuqB,EAAKsU,GAAGsG,OAAO5C,EAAIzH,EAAIkkB,EAASjpB,SAAWtlE,KAAKuvC,GAAK,KACrD7uB,EAAIm5C,EAAGn5C,EACPC,EAAIk5C,EAAGl5C,EACP6+C,EAAK1F,EAAGp5C,EAAIm5C,EAAGn5C,EACf++C,EAAK3F,EAAGn5C,EAAIk5C,EAAGl5C,EAEf+mD,EAAIyoB,YACJzoB,EAAI8oB,QAAQ9vE,EAAI8+C,EAAK,EAAG7+C,EAAI8+C,EAAK,EAAGz/D,KAAKghB,IAAIw+C,EAAK,GAAIx/D,KAAKghB,IAAIy+C,EAAK,GAAI,EAAG,EAAa,EAAVz/D,KAAKuvC,IAC/Eg/C,EAASI,QACTjnB,EAAI+oB,OAEJ/oB,EAAI4oB,SAKZ5oB,EAAIiN,oBCnTI+b,GAAWx7B,EAA2B6G,GAGlD,IAAI40B,EAAwB,KAAd50B,EAAE40B,QAAiB,IAAM50B,EAAE40B,QAKrCC,EAAQxiB,GAAG1+D,GAAG,CACd0nE,IAAK,CACDxjD,SAAU,QACVzW,KAAM,IACNy4C,IAAK,IACLzB,MAAO,WACPmsB,SAAUvkB,EAAEloC,KAAO,KACnBioD,WAAY/f,EAAE+f,WAAa/f,EAAE+f,WAAa,KAAO,aAGrDr6D,EAAM2sD,GAAG1+D,GAAG,CACZga,OAAQknE,EACRxZ,IAAK,CACDl/D,QAAS,eACTyxE,UAAW5tB,EAAE80B,MAAQ90B,EAAE80B,MAAQ,OAC/BC,WAAY/0B,EAAEg1B,KAAOh1B,EAAEg1B,KAAO,aAC9BzQ,SAAUvkB,EAAEloC,KAAO,KACnBm9D,WAAYj1B,EAAEk1B,OAAS,OAAS,SAChCC,UAAWn1B,EAAEo1B,SAAW,SAAW,SACnCrV,WAAY/f,EAAE+f,WAAa/f,EAAE+f,WAAa,KAAO,UAGjDoG,QAAS,IACT2B,cAAe,UAGnBuN,EAAU,GAMd,IAAK,IAAIhzF,EAAI,EAAGA,EAAIuyF,EAAQtyF,OAAQD,IACb,OAAfuyF,EAAQvyF,GAcZgzF,GAAWT,EAAQvyF,GAAGS,QAAQ,KAAM,SAbhC4iB,EAAIxgB,YAAYmtE,GAAG1+D,GAAG,CAClBwhE,QAAS,OACTpwE,YAAaswF,EACbha,IAAK,CACDia,WAAY,UAGpBD,EAAU,GACV3vE,EAAIxgB,YAAYmtE,GAAG1+D,GAAG,CAClBwhE,QAAS,SAMrBzvD,EAAIxgB,YAAYmtE,GAAG1+D,GAAG,CAClBwhE,QAAS,OACTpwE,YAAaswF,EACbha,IAAK,CACDia,WAAY,UAGpB5wF,SAAS0oD,KAAKloD,YAAY2vF,GAI1B,IAAIh0B,EAAS,CACTzrB,GAAI,SACJE,GAAI,SACJD,GAAI,EACJE,GAAI,GAER,IAAK,IAAIgnB,EAAI,EAAGA,EAAI72C,EAAI6vE,SAASjzF,OAAQi6D,IAAK,CAC1C,IAAI5oD,EAAK+R,EAAI6vE,SAASh5B,GACtBsE,EAAOzrB,GAAKnxC,KAAK+O,IAAI6tD,EAAOzrB,GAAIzhC,EAAGmmD,YACnC+G,EAAOvrB,GAAKrxC,KAAK+O,IAAI6tD,EAAOvrB,GAAI3hC,EAAG6hF,WACnC30B,EAAOxrB,GAAKpxC,KAAK6O,IAAI+tD,EAAOxrB,GAAI1hC,EAAGmmD,WAAanmD,EAAGivE,aACnD/hB,EAAOtrB,GAAKtxC,KAAK6O,IAAI+tD,EAAOtrB,GAAI5hC,EAAG6hF,UAAY7hF,EAAGmvE,cAItD,IAAInX,EAAMxS,EAAOC,WAAW,MAC5BuS,EAAI4M,OAEJ,IAAIyc,EAAO,GACPh1B,EAAEo1B,UACFJ,EAAKtoF,KAAK,UAEVszD,EAAEk1B,QACFF,EAAKtoF,KAAK,QAEdsoF,EAAKtoF,KAAKszD,EAAEloC,KAAO,OAASkoC,EAAEg1B,KAAOh1B,EAAEg1B,KAAO,eAC9CrpB,EAAIqpB,KAAOA,EAAK3iF,KAAK,KACrBs5D,EAAIC,UAAY5L,EAAEqpB,MAAQrpB,EAAEqpB,MAAQ,OAEpC,IAAI1kE,EAAIq7C,EAAEr7C,EACNC,EAAIo7C,EAAEp7C,EACM,UAAZo7C,EAAE80B,QACFnwE,IAAMk8C,EAAOxrB,GAAKwrB,EAAOzrB,IAEb,WAAZ4qB,EAAE80B,QACFnwE,KAAOk8C,EAAOxrB,GAAKwrB,EAAOzrB,IAAM,GAEpCu2B,EAAI+M,UAAU1Y,EAAEr7C,EAAGq7C,EAAEp7C,GACrB+mD,EAAIgN,OAAO3Y,EAAEuJ,UAAYvJ,EAAEuJ,SAAW,GACtCoC,EAAI+M,WAAW1Y,EAAEr7C,GAAIq7C,EAAEp7C,GACvB+mD,EAAI+M,UAAU/zD,EAAGC,GAGjB,IAAK,IAAIq4C,EAAI,EAAGA,EAAIv3C,EAAI6vE,SAASjzF,OAAQ26D,IAAK,CAC1C,IAAItpD,EAAK+R,EAAI6vE,SAASt4B,GAGtB0O,EAAI8pB,SAAS9hF,EAAG+hF,UAAW/hF,EAAGmmD,WAAYnmD,EAAG6hF,WAcjD,OAXIx1B,EAAE21B,SACFhqB,EAAI8mB,UAAY,EAChB9mB,EAAI6oB,WAAW,EAAa,KAATx0B,EAAEloC,KAAa+oC,EAAOxrB,GAAIwrB,EAAOtrB,IACpDo2B,EAAIiN,UACJjN,EAAIE,SAAS7L,EAAEr7C,EAAI,EAAGq7C,EAAEp7C,EAAI,EAAG,EAAG,IAElC+mD,EAAIiN,UAGRl0E,SAAS0oD,KAAKjhC,YAAY0oE,GAEnB,CACHlwE,EAAGA,EAAIq7C,EAAEr7C,EACTC,EAAGA,EAAIo7C,EAAEp7C,EAAY,IAATo7C,EAAEloC,KACdsgC,MAAOyI,EAAOxrB,GAAKwrB,EAAOzrB,GAC1BijB,OAAQwI,EAAOtrB,GAAKsrB,EAAOvrB,aC5JnBsgD,GAAYC,EAAqB/J,GAC7C,IAAIjU,EAAexF,GAAGlZ,OAClBl1D,KAAK6O,IAAI,EAAG7O,KAAK4jC,MAAMguD,EAAQz9B,MAAQ0zB,IACvC7nF,KAAK6O,IAAI,EAAG7O,KAAK4jC,MAAMguD,EAAQx9B,OAASyzB,KAExCngB,EAAMkM,EAAaze,WAAW,MAClCuS,EAAI4M,OACAuT,EAAS,IACTngB,EAAI6M,uBAAwB,GAEhC,IAAK,IAAIn2E,EAAI,EAAGA,EAAIwzF,EAAQC,OAAOxzF,OAAQD,IACL,IAA9BwzF,EAAQC,OAAOzzF,GAAG8jF,UAGtBxa,EAAI+mB,YAAcmD,EAAQC,OAAOzzF,GAAG8jF,QACpCxa,EAAIwO,yBAA2B0b,EAAQC,OAAOzzF,GAAG0zF,WAAaF,EAAQC,OAAOzzF,GAAG0zF,WAAa,cAC7FpqB,EAAImM,UAAU+d,EAAQC,OAAOzzF,GAAG2iF,MAAO,EAAG,EAAGnN,EAAazf,MAAOyf,EAAaxf,SAGlF,OADAsT,EAAIiN,UACGf,ECtBXme,GAAiBzyF,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCUtH,MAAMwyF,GAAkB,CACpB,cACA,SACA,WACA,aACA,UACA,SACA,cACA,UACA,aACA,aACA,aACA,YACA,MACA,aACA,QACA,uBCtBYC,GAAkBC,GAC9B,IAAKA,EACD,OAAOpX,GAAK,uBAGhB,MAAMqX,EAEF,CACA,cAAe,sBACfC,OAAU,sBACVC,SAAY,wBACZ,aAAc,0BACdC,QAAW,uBACXC,OAAU,sBACV,cAAe,2BACfC,QAAW,uBACX,aAAc,0BACd,aAAc,0BACd53C,WAAc,0BACd63C,UAAa,yBACbC,IAAO,mBACPC,WAAc,0BACdvN,MAAS,qBACTwN,WAAc,2BAGlB,KAAMV,KAAaC,GACf,MAAM,IAAI3zF,MAAM,sBAEpB,OAAOs8E,GAAKqX,EAAMD,UCxBTW,GA8HTtT,aACI,OAAOl9E,KAAKywF,YAGhBC,QAAS5+B,EAAeC,GACpB/xD,KAAKywF,YAAYjlB,aAAa,QAAS,GAAK1Z,GAC5C9xD,KAAKywF,YAAYjlB,aAAa,SAAU,GAAKzZ,GAC7C/xD,KAAK2wF,QAAQnlB,aAAa,YAAa,aAAgB1Z,EAAM,EAAK,KAAQC,EAAO,EAAK,KAG1F6+B,aAAcl3B,GAMN,MAAOA,IACP15D,KAAK6wF,iBAAiBrlB,aAAa,KAAM,GAAK9R,EAAEr7C,GAChDre,KAAK8wF,iBAAiBtlB,aAAa,KAAM,GAAK9R,EAAEr7C,IAEhD,MAAOq7C,IACP15D,KAAK6wF,iBAAiBrlB,aAAa,KAAM,GAAK9R,EAAEp7C,GAChDte,KAAK8wF,iBAAiBtlB,aAAa,KAAM,GAAK9R,EAAEp7C,IAEhD,WAAYo7C,IACZ15D,KAAK6wF,iBAAiBrlB,aAAa,IAAK,GAAK7tE,KAAK6O,IAAI,EAAGktD,EAAEq3B,SAC3D/wF,KAAK8wF,iBAAiBtlB,aAAa,IAAK,GAAK7tE,KAAK6O,IAAI,EAAGktD,EAAEq3B,OAAS,KAEpE,cAAer3B,IACf15D,KAAK6wF,iBAAiBj7E,MAAMiqE,QAAUnmB,EAAEs3B,UAAY,IAAM,IAC1DhxF,KAAK8wF,iBAAiBl7E,MAAMiqE,QAAUnmB,EAAEs3B,UAAY,IAAM,KAIlEC,mBAAoBv3B,GAchB,GARI,MAAOA,IACP15D,KAAKkxF,iBAAiB1lB,aAAa,KAAM,GAAK9R,EAAEr7C,GAChDre,KAAKmxF,oBAAoB3lB,aAAa,KAAM,GAAK9R,EAAEr7C,IAEnD,MAAOq7C,IACP15D,KAAKkxF,iBAAiB1lB,aAAa,KAAM,GAAK9R,EAAEp7C,GAChDte,KAAKmxF,oBAAoB3lB,aAAa,KAAM,GAAK9R,EAAEp7C,IAEnD,UAAWo7C,EAAG,CACd15D,KAAKkxF,iBAAiB1lB,aAAa,SAAUO,GAAGkX,eAAetY,SAASjR,EAAEqpB,QAC1E,IAAIqO,EAAcrlB,GAAGslB,wBAAwB33B,EAAEqpB,OAAS,wBAA0B,kBAClF/iF,KAAKmxF,oBAAoB3lB,aAAa,SAAU4lB,GAEhD,cAAe13B,IACf15D,KAAKkxF,iBAAiBt7E,MAAMiqE,QAAUnmB,EAAEs3B,UAAY,IAAM,IAC1DhxF,KAAKmxF,oBAAoBv7E,MAAMiqE,QAAUnmB,EAAEs3B,UAAY,IAAM,KAIrEM,cAAe53B,GAIP,aAAcA,IACd15D,KAAKuxF,aAAa/lB,aAAa,YAAa,UAAY9R,EAAEkY,SAAW,KACrE5xE,KAAKwxF,kBAAkB57E,MAAMiqE,QAAUnmB,EAAEkY,SAAW,IAAO,EAAI,IAAM,KAErE,cAAelY,IACf15D,KAAK2wF,QAAQ/6E,MAAMiqE,QAAUnmB,EAAEs3B,UAAY,IAAM,iBAjLrDt3B,GAKA15D,KAAKywF,YAAc1kB,GAAG0lB,UAAU,CAC5BxiB,YAAa,MACbnd,MAAO,GAAK4H,EAAE5H,MACdC,OAAQ,GAAK2H,EAAE3H,SAEnBga,GAAGgJ,IAAI/0E,KAAKywF,YAAa,CACrBl/D,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLiuB,cAAe,OACfR,WAAY,SAIhBhhF,KAAK6wF,iBAAmB9kB,GAAG0lB,UAAU,CACjCxiB,YAAa,SACbziD,EAAG,KACHyhE,OAAQ,kBACR,eAAgB,IAChBG,KAAM,SAEVpuF,KAAK8wF,iBAAmB/kB,GAAG0lB,UAAU,CACjCxiB,YAAa,SACbziD,EAAG,IACHyhE,OAAQ,wBACR,eAAgB,IAChBG,KAAM,SAEVpuF,KAAKywF,YAAYlqC,OAAOvmD,KAAK6wF,iBAAkB7wF,KAAK8wF,kBAGpD9wF,KAAKmxF,oBAAsBplB,GAAG0lB,UAAU,CACpCxiB,YAAa,SACbziD,EAAG,KACHyhE,OAAQ,QACR,eAAgB,KAChBG,KAAM,SAEVpuF,KAAKmxF,oBAAoBv7E,MAAMiqE,QAAU,IACzC7/E,KAAKkxF,iBAAmBnlB,GAAG0lB,UAAU,CACjCxiB,YAAa,SACbziD,EAAG,KACHyhE,OAAQ,QACR,eAAgB,KAChBG,KAAM,SAEVpuF,KAAKkxF,iBAAiBt7E,MAAMiqE,QAAU,IACtC7/E,KAAKywF,YAAYlqC,OAAOvmD,KAAKmxF,oBAAqBnxF,KAAKkxF,kBAIvDlxF,KAAK0xF,YAAc,GACnB1xF,KAAK2wF,QAAU5kB,GAAG0lB,UAAU,CACxBxiB,YAAa,IACbwC,UAAW,aAAgB/X,EAAE5H,MAAM,EAAK,KAAQ4H,EAAE3H,OAAO,EAAK,MAElEga,GAAGgJ,IAAI/0E,KAAK2wF,QAAS,CACjBlK,WAAY,4BACZ5G,QAAS,MAEb7/E,KAAKuxF,aAAexlB,GAAG0lB,UAAU,CAC7BxiB,YAAa,IACbwC,UAAW,eAEfzxE,KAAK2xF,kBAAoB5lB,GAAG0lB,UAAU,CAClCxiB,YAAa,SACbmf,KAAM,kBACNH,OAAQ,OACR2D,GAAI,IACJC,GAAI,IACJrlE,EAAG,GAAKxsB,KAAK0xF,cAEjB1xF,KAAKwxF,kBAAoBzlB,GAAG0lB,UAAU,CAClCxiB,YAAa,SACbmf,KAAM,OACNH,OAAQ,yBACR,eAAgB,IAChB2D,GAAI,IACJC,GAAI,IACJrlE,EAAG,GAAyB,GAAnBxsB,KAAK0xF,cAElB1xF,KAAK8xF,qBAAuB/lB,GAAG0lB,UAAU,CACrCxiB,YAAa,OACbmf,KAAM,OACNH,OAAQ,OACR93B,EAAG,MAA0B,IAAnBn2D,KAAK0xF,YAAoB,MAA0B,IAAnB1xF,KAAK0xF,YAAoB,SAA6B,GAAnB1xF,KAAK0xF,YAAmB,OAEzG1xF,KAAK+xF,qBAAuBhmB,GAAG0lB,UAAU,CACrCxiB,YAAa,OACbmf,KAAM,OACNH,OAAQ,OACR93B,EAAG,MAA0B,IAAnBn2D,KAAK0xF,YAAoB,MAA0B,IAAnB1xF,KAAK0xF,YAAoB,QAA4B,GAAnB1xF,KAAK0xF,YAAmB,OAGxG1xF,KAAKuxF,aAAahrC,OACdvmD,KAAK2xF,kBACL3xF,KAAKwxF,kBACLxxF,KAAK8xF,qBACL9xF,KAAK+xF,sBAET/xF,KAAK2wF,QAAQpqC,OAAOvmD,KAAKuxF,cACzBvxF,KAAKywF,YAAYlqC,OAAOvmD,KAAK2wF,iBCpIrCqB,GAAiB/0F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH80F,GAAiBh1F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH+0F,GAAiBj1F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHg1F,GAAiBl1F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,oBC0BjHi1F,IAAAA,GAAAC,KAAAA,GAAK,KAALD,GACG,KAAJ,GAAA,OADCA,GAAAA,GAEG,KAAJ,GAAA,OAFCA,GAAAA,GAGW,aAAZ,GAAA,eAHCA,GAAAA,GAIG,KAAJ,GAAA,OAJCA,GAAAA,GAKG,KAAJ,GAAA,OALCA,GAAAA,GAMK,OAAN,GAAA,SANCA,GAAAA,GAOO,SAAR,GAAA,WAPCA,GAAAA,GAQG,KAAJ,GAAA,OARCA,GAAAA,GASG,KAAJ,GAAA,OATCA,GAAAA,GAUI,MAAL,GAAA,iBCdYE,GACZ54B,GAMA,MAAMnsB,EAAQmsB,EAAE5H,MAAQ4H,EAAE81B,OAAO,GAAG9Q,MAAM5sB,MACpCA,EAAQvkB,EAAQ,EAAImsB,EAAE81B,OAAO,GAAG9Q,MAAM5sB,MAAQ4H,EAAE5H,MAChDC,EAASxkB,EAAQ,EAAImsB,EAAE81B,OAAO,GAAG9Q,MAAM3sB,OAAS2H,EAAE3H,OAExD,IAAIc,EAASkZ,GAAGlZ,OAAOf,EAAOC,GAC9Bc,EAAOj9C,MAAM6oE,gBAAkB,OAAS1S,GAAGkb,qBAAqB,GAAK,IACrE,IAAI5hB,EAAMxS,EAAOC,WAAW,eAQnBy/B,IACLltB,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAG3/B,EAAOf,MAAOe,EAAOd,QACzC,IAAK,IAAIh2D,EAAI,EAAGA,EAAI29D,EAAE81B,OAAOxzF,OAAQD,IACjCspE,EAAI+mB,YAAc1yB,EAAE81B,OAAOzzF,GAAG8jF,QAC9Bxa,EAAIwO,yBAA2Bna,EAAE81B,OAAOzzF,GAAG0zF,WACvC58B,EAAOf,MAAQ4H,EAAE81B,OAAOzzF,GAAG2iF,MAAM5sB,QACjCuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU9X,EAAE81B,OAAOzzF,GAAG2iF,MAAO,EAAG,EAAG7rB,EAAOf,MAAOe,EAAOd,QAEhEsT,EAAIiN,UAjBRvG,GAAGgJ,IAAIliB,EAAQ,CACXf,MAAO,OACPC,OAAQ,OACRs3B,eAAgB97C,EAAQ,EAAI,YAAc,OAiB9CznB,WAAWysE,EAAQ,GAGnBvyF,KAAKk9E,WAAa,WACd,OAAOrqB,GAGX7yD,KAAKuyF,OAAS,WACVA,YC1CL,SACME,GAAYhhB,GACjB,GAAI9zE,KAAKghB,IAAI8yD,EAAUG,UAAY,IAAO,EACtC,OAGJH,EAAU3f,MAAQn0D,KAAK4jC,MAAMkwC,EAAU3f,OACvC2f,EAAU1f,OAASp0D,KAAK4jC,MAAMkwC,EAAU1f,QAGtC,MAAI8f,EAAYl0E,KAAKghB,IAAI8yD,EAAUG,SAAW,IAAM,KAAQ,EAC9DH,EAAUpzD,GAAMwzD,EAAYJ,EAAU1f,OAAS0f,EAAU3f,OAAS,GAAM,EAAKn0D,KAAK4jC,MAAMkwC,EAAUpzD,GAAK1gB,KAAK4jC,MAAMkwC,EAAUpzD,EAAI,IAAO,GACvIozD,EAAUnzD,GAAMuzD,EAAYJ,EAAU3f,MAAQ2f,EAAU1f,QAAU,GAAM,EAAMp0D,KAAK4jC,MAAMkwC,EAAUnzD,GAAK3gB,KAAK4jC,MAAMkwC,EAAUnzD,EAAI,IAAO,YAGnIo0E,GAAcjhB,GACnB,MAAO,CACHpzD,EAAGozD,EAAUpzD,EACbC,EAAGmzD,EAAUnzD,EACbwzC,MAAO2f,EAAU3f,MACjBC,OAAQ0f,EAAU1f,OAClB6f,SAAUH,EAAUG,UAczB,SACM+gB,GAAkBt0E,EAAWC,EAAWmzD,GAC7C,IAAIia,EAAIC,EACRD,EAAKrtE,EAAIozD,EAAUpzD,EACnBstE,EAAKrtE,EAAImzD,EAAUnzD,EAEnB,MAAM8wD,EAAMrD,GAAGihB,aAAa,CAAC3uE,EAAG,EAAGC,EAAG,GAClC,CAACD,EAAGqtE,EAAIptE,EAAGqtE,IACVla,EAAUG,UAIf,OAHA8Z,EAAKtc,EAAI/wD,EACTstE,EAAKvc,EAAI9wD,EAEF,CACHD,EAAGqtE,EACHptE,EAAGqtE,GASR,SACMiH,GAAav0E,EAAWC,EAAWmzD,GACxC,MAAMrC,EAAMrD,GAAGihB,aAAa,CAAC3uE,EAAG,EAAGC,EAAG,GAClC,CAACD,EAAGA,EAAGC,EAAGA,GACVmzD,EAAUG,UACd,MAAO,CACHvzD,EAAG+wD,EAAI/wD,EAAIozD,EAAUpzD,EACrBC,EAAG8wD,EAAI9wD,EAAImzD,EAAUnzD,GCxF7Bu0E,GAAiB51F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,eDyHzG21F,GAqDDC,eACJ/yF,KAAKgzF,OAAO30E,EAAIre,KAAKyxE,UAAUpzD,EAAIre,KAAKutC,MACxCvtC,KAAKgzF,OAAO10E,EAAIte,KAAKyxE,UAAUnzD,EAAIte,KAAKutC,MACxCvtC,KAAKgzF,OAAOlhC,MAAQ9xD,KAAKyxE,UAAU3f,MAAQ9xD,KAAKutC,MAChDvtC,KAAKgzF,OAAOjhC,OAAS/xD,KAAKyxE,UAAU1f,OAAS/xD,KAAKutC,MAClDvtC,KAAKgzF,OAAOC,QAAUjzF,KAAKizF,QAAQ3yD,KAAK3X,IAC7B,CAACtK,EAAGsK,EAAKtK,EAAIre,KAAKutC,MAAOjvB,EAAGqK,EAAKrK,EAAIte,KAAKutC,UAYjD2lD,WAAYC,EAAYC,GAC5B,IAAKpzF,KAAKqzF,gBACN,MAAO,CAACh1E,EAAG80E,EAAI70E,EAAG80E,GAEtB,IAAIpsB,EACJ,MAAMssB,EAOF,CACAj1E,EAAG,KACHC,EAAG,KACH0oD,KAAM,CACF3oD,EAAG,KACHC,EAAG,OAGX,IAAK,IAAI5f,EAAI,EAAGA,EAAIsB,KAAKuzF,MAAMv3F,OAAQ0C,IACnCsoE,EAAOrpE,KAAKghB,IAAIw0E,EAAKnzF,KAAKuzF,MAAM70F,IAC5BsoE,EAAOhnE,KAAKwzF,YAAcxzF,KAAKutC,QAChB,OAAX+lD,EAAKj1E,GAAc2oD,EAAOssB,EAAKtsB,KAAK3oD,KACpCi1E,EAAKj1E,EAAIre,KAAKuzF,MAAM70F,GACpB40F,EAAKtsB,KAAK3oD,EAAI2oD,GAI1B,IAAK,IAAIhW,EAAI,EAAGA,EAAIhxD,KAAKyzF,MAAMz3F,OAAQg1D,IACnCgW,EAAOrpE,KAAKghB,IAAIy0E,EAAKpzF,KAAKyzF,MAAMziC,IAC5BgW,EAAOhnE,KAAKwzF,YAAcxzF,KAAKutC,QAChB,OAAX+lD,EAAKh1E,GAAc0oD,EAAOssB,EAAKtsB,KAAK1oD,KACpCg1E,EAAKh1E,EAAIte,KAAKyzF,MAAMziC,GACpBsiC,EAAKtsB,KAAK1oD,EAAI0oD,GAK1B,OAAe,OAAXssB,EAAKj1E,GAAyB,OAAXi1E,EAAKh1E,EACjB,CACHD,EAAG80E,EACH70E,EAAG80E,GAGJ,CACH/0E,EAAc,OAAXi1E,EAAKj1E,EAAa80E,EAAKG,EAAKj1E,EAC/BC,EAAc,OAAXg1E,EAAKh1E,EAAa80E,EAAKE,EAAKh1E,GAY/Bo1E,gBAAiBC,EAAqBR,EAAYC,GACtD,IAAKpzF,KAAK4zF,cACN,MAAO,CACHv1E,EAAG80E,EACH70E,EAAG80E,GAGX,MAAMS,EAAO7zF,KAAKyxE,UAAU3f,MAAQ9xD,KAAKyxE,UAAU1f,OAAS,GAAI,EAAK,EACrE,OAAOga,GAAG+nB,mBACN,CAACz1E,EAAGre,KAAKyxE,UAAUpzD,EAAGC,EAAGte,KAAKyxE,UAAUnzD,GACxCs0E,GAAa5yF,KAAK+zF,MAAOF,GAAQ,CAAC,EAAG,GAAGtmF,SAASomF,GAAe,GAAI,GAAK3zF,KAAKyxE,WAC9E,CAACpzD,EAAG80E,EAAI70E,EAAG80E,IAQXY,wBACJh0F,KAAKizF,QAAQ,GAAG50E,GAAMre,KAAKyxE,UAAU3f,MAAQ,EAC7C9xD,KAAKizF,QAAQ,GAAG30E,GAAMte,KAAKyxE,UAAU1f,OAAS,EAE9C/xD,KAAKizF,QAAQ,GAAG50E,EAAKre,KAAKyxE,UAAU3f,MAAQ,EAC5C9xD,KAAKizF,QAAQ,GAAG30E,GAAMte,KAAKyxE,UAAU1f,OAAS,EAE9C/xD,KAAKizF,QAAQ,GAAG50E,EAAKre,KAAKyxE,UAAU3f,MAAQ,EAC5C9xD,KAAKizF,QAAQ,GAAG30E,EAAKte,KAAKyxE,UAAU1f,OAAS,EAE7C/xD,KAAKizF,QAAQ,GAAG50E,GAAMre,KAAKyxE,UAAU3f,MAAQ,EAC7C9xD,KAAKizF,QAAQ,GAAG30E,EAAKte,KAAKyxE,UAAU1f,OAAS,EAWzCkiC,aAAcC,EAAuBC,GACzC,IAAKn0F,KAAK4zF,cACN,OAEJ,MAAMQ,EAAUz2F,KAAKghB,IAAI3e,KAAKyxE,UAAUG,UAAY,IAAO,EACrDC,EAAYl0E,KAAKghB,IAAI3e,KAAKyxE,UAAUG,SAAW,IAAM,KAAQ,EACnE,GAAIuiB,IAAkBD,EAAc,CAChC,MAAMjgB,EAAYt2E,KAAKghB,IAAI3e,KAAKizF,QAAQ,GAAG30E,EAAIte,KAAKizF,QAAQ,GAAG30E,GAC/D,IAAI01D,EAAWh0E,KAAK+zF,MAAQ9f,EACxBmgB,IACApgB,EAAyE,IAA7DnC,EAAY7xE,KAAKyxE,UAAUnzD,EAAI,EAAIte,KAAKyxE,UAAUpzD,EAAI,GAC9D0tD,GAAGsoB,UAAUrgB,GAAYjI,GAAGuoB,YAAYtgB,IAE5Ch0E,KAAKizF,QAAQ,GAAG50E,EAAIre,KAAKizF,QAAQ,GAAG50E,EAAI,IACxC21D,IAAY,GAEhBh0E,KAAKizF,QAAQ,GAAG50E,GAAK21D,EAAW,EAChCh0E,KAAKizF,QAAQ,GAAG50E,GAAK21D,EAAW,EAChCh0E,KAAKizF,QAAQ,GAAG50E,EAAI21D,EAAW,EAC/Bh0E,KAAKizF,QAAQ,GAAG50E,EAAI21D,EAAW,EAEnC,IAAKmgB,GAAiBD,EAAc,CAEhC,IAAIjgB,EADat2E,KAAKghB,IAAI3e,KAAKizF,QAAQ,GAAG50E,EAAIre,KAAKizF,QAAQ,GAAG50E,GACnCre,KAAK+zF,MAC5BK,IACAngB,EAA0E,IAA7DpC,EAAY7xE,KAAKyxE,UAAUpzD,EAAI,EAAIre,KAAKyxE,UAAUnzD,EAAI,GAC/DytD,GAAGsoB,UAAUpgB,GAAalI,GAAGuoB,YAAYrgB,IAE7Cj0E,KAAKizF,QAAQ,GAAG30E,EAAIte,KAAKizF,QAAQ,GAAG30E,EAAI,IACxC21D,IAAa,GAEjBj0E,KAAKizF,QAAQ,GAAG30E,GAAK21D,EAAY,EACjCj0E,KAAKizF,QAAQ,GAAG30E,GAAK21D,EAAY,EACjCj0E,KAAKizF,QAAQ,GAAG30E,EAAI21D,EAAY,EAChCj0E,KAAKizF,QAAQ,GAAG30E,EAAI21D,EAAY,GAShCsgB,4BAGJ,MAAMnlB,EAAMrD,GAAGihB,aACX,CAAC3uE,EAAG,EAAGC,EAAG,GACV,CACID,GAAIre,KAAKizF,QAAQ,GAAG50E,EAAIre,KAAKizF,QAAQ,GAAG50E,GAAK,EAC7CC,GAAIte,KAAKizF,QAAQ,GAAG30E,EAAIte,KAAKizF,QAAQ,GAAG30E,GAAK,GAEjDte,KAAKyxE,UAAUG,UAEnB5xE,KAAKyxE,UAAUpzD,EAAI+wD,EAAI/wD,EAAIre,KAAKyxE,UAAUpzD,EAC1Cre,KAAKyxE,UAAUnzD,EAAI8wD,EAAI9wD,EAAIte,KAAKyxE,UAAUnzD,EAG1Cte,KAAKyxE,UAAU3f,MAAQ9xD,KAAKizF,QAAQ,GAAG50E,EAAIre,KAAKizF,QAAQ,GAAG50E,EAC3Dre,KAAKyxE,UAAU1f,OAAS/xD,KAAKizF,QAAQ,GAAG30E,EAAIte,KAAKizF,QAAQ,GAAG30E,EAG5Dte,KAAKg0F,wBAELh0F,KAAKw0F,YAODA,UAAWC,GACfz0F,KAAK+yF,eAELhnB,GAAGgJ,IAAI/0E,KAAK00F,QAAS,CACjB55E,KAAM9a,KAAKgzF,OAAO30E,EAAI,KACtBk1C,IAAKvzD,KAAKgzF,OAAO10E,EAAI,KACrBq2E,gBAAiB,MACjBljB,UAAW,UAAYzxE,KAAKyxE,UAAUG,SAAW,SAGrD7F,GAAGgJ,IAAI/0E,KAAK40F,SAAU,CAClB9iC,MAAOn0D,KAAKghB,IAAI3e,KAAKgzF,OAAOlhC,OAAS,KACrCC,OAAQp0D,KAAKghB,IAAI3e,KAAKgzF,OAAOjhC,QAAU,KACvCj3C,KAAMnd,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG50E,EAAGre,KAAKgzF,OAAOC,QAAQ,GAAG50E,GAAK,KACrEk1C,IAAK51D,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG30E,EAAGte,KAAKgzF,OAAOC,QAAQ,GAAG30E,GAAK,OAGxEte,KAAKizF,QAAQ,GAAGuB,YAChBx0F,KAAKizF,QAAQ,GAAGuB,YAChBx0F,KAAKizF,QAAQ,GAAGuB,YAChBx0F,KAAKizF,QAAQ,GAAGuB,YAEhBx0F,KAAK60F,MAAM,GAAGL,YACdx0F,KAAK60F,MAAM,GAAGL,YACdx0F,KAAK60F,MAAM,GAAGL,YACdx0F,KAAK60F,MAAM,GAAGL,YAGdx0F,KAAK80F,UAAUz2E,EAAI,EACnBre,KAAK80F,UAAUx2E,GAAM3gB,KAAKghB,IAAI3e,KAAKyxE,UAAU1f,OAAS/xD,KAAKutC,OAAS,EAAK,GACzEvtC,KAAK80F,UAAUN,YACVC,GACGz0F,KAAK0sC,UACL1sC,KAAK0sC,SAASgmD,GAAc1yF,KAAKyxE,YAqiB7CsjB,eACI,OAAOrC,GAAc1yF,KAAKyxE,WAG9BujB,eAAgBh3E,GACZhe,KAAK4zF,gBAAkB51E,EACnBA,GAA8B,IAAzBhe,KAAKyxE,UAAU3f,OAAyC,IAA1B9xD,KAAKyxE,UAAU1f,SAClD/xD,KAAK+zF,MAAQp2F,KAAKghB,IAAI3e,KAAKyxE,UAAU3f,MAAQ9xD,KAAKyxE,UAAU1f,SAIpEkjC,YAAa7/B,GACTp1D,KAAKqzF,kBAAoBj+B,EAG7B8/B,OAAQx7B,GACJ15D,KAAKyxE,UAAUpzD,EAAIq7C,EAAEr7C,EACrBre,KAAKyxE,UAAUnzD,EAAIo7C,EAAEp7C,EACrBte,KAAKw0F,WAAU,GAGnBW,KAAMh4B,EAAYC,GACdp9D,KAAKyxE,UAAUpzD,GAAK8+C,EACpBn9D,KAAKyxE,UAAUnzD,GAAK8+C,EACpBp9D,KAAKw0F,WAAU,GAGnB9D,QAAS9+B,EAAWC,GAChB7xD,KAAKyxE,UAAU3f,MAAQF,EACvB5xD,KAAKyxE,UAAU1f,OAASF,EACpBl0D,KAAKghB,IAAI3e,KAAKyxE,UAAUG,UAAY,IAAO,GAC3C6gB,GAAYzyF,KAAKyxE,WAErBzxE,KAAKg0F,wBACLh0F,KAAKw0F,WAAU,GAGnBY,YAAahtF,GACTpI,KAAKyxE,UAAUG,SAAWxpE,EACtBzK,KAAKghB,IAAI3e,KAAKyxE,UAAUG,UAAY,IAAO,IAC3C6gB,GAAYzyF,KAAKyxE,WACjBzxE,KAAKg0F,yBAETh0F,KAAKw0F,WAAU,GAGnBtX,aACI,OAAOl9E,KAAK84E,OAGhBuc,WACI,OAAOr1F,KAAK+zF,MAGhBx0B,UACIv/D,KAAK82D,YAAYyI,UACjBv/D,KAAKs1F,sBAAsB/1B,UAC3Bv/D,KAAKizF,QAAQ,GAAGjR,gBAAgBziB,UAChCv/D,KAAKizF,QAAQ,GAAGjR,gBAAgBziB,UAChCv/D,KAAKizF,QAAQ,GAAGjR,gBAAgBziB,UAChCv/D,KAAKizF,QAAQ,GAAGjR,gBAAgBziB,UAChCv/D,KAAK60F,MAAM,GAAG7S,gBAAgBziB,UAC9Bv/D,KAAK60F,MAAM,GAAG7S,gBAAgBziB,UAC9Bv/D,KAAK60F,MAAM,GAAG7S,gBAAgBziB,UAC9Bv/D,KAAK60F,MAAM,GAAG7S,gBAAgBziB,UAC9Bv/D,KAAKu1F,qBAAqBh2B,sBA7lB1B9Z,GA5RDzlD,KAOcgzF,OAAS,CACtB30E,EAAG,EACHC,EAAG,EACHwzC,MAAO,EACPC,OAAQ,EACRkhC,QAAS,CAAC,CAAC50E,EAAG,EAAGC,EAAG,KAZrBte,KAccwzF,YAAc,EAd5BxzF,KAqBcw1F,cAAgB,CAAC,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KArBtEx1F,KAsBcy1F,SAAW,GAtBzBz1F,KAuBc01F,SAAW,GAvBzB11F,KA4BcizF,QAQX,GApCHjzF,KAwCc60F,MAIX,GA8PF70F,KAAKyxE,UAAY,CACbpzD,EAAGonC,EAAOpnC,EACVC,EAAGmnC,EAAOnnC,EACVwzC,MAAOrM,EAAOqM,MACdC,OAAQtM,EAAOsM,OACf6f,SAAUnsB,EAAOmsB,UAGrB5xE,KAAK4zF,gBAAkBnuC,EAAOmuC,cAE9B5zF,KAAKuzF,MAAQ9tC,EAAO8tC,MACpBvzF,KAAKyzF,MAAQhuC,EAAOguC,MACpBzzF,KAAK0sC,SAAW+Y,EAAO/Y,SACvB1sC,KAAKutC,MAAQkY,EAAOlY,MACpBvtC,KAAKqzF,iBAAkB,EACvBrzF,KAAK+zF,MAAQ/zF,KAAKyxE,UAAU3f,MAAQ9xD,KAAKyxE,UAAU1f,OAEnD/xD,KAAK84E,OAAS/M,GAAG1+D,GAAG,CAChB2nE,UAAW,oBACXD,IAAK,CACDiM,WAAY,UAGpBhhF,KAAK00F,QAAU3oB,GAAG1+D,GAAG,CACjBga,OAAQrnB,KAAK84E,OACb/D,IAAK,CACDxjD,SAAU,cAIlBvxB,KAAK40F,SAAW7oB,GAAG1+D,GAAG,CAClB0nE,IAAK,CACDxjD,SAAU,WACVysD,OAAQ,OACRrE,UAAW,4EAInB,MAAMgc,EAAmB,CACrBt3E,EAAG,EACHC,EAAG,GAMPte,KAAK82D,YAAc,IAAIiV,GAAGmO,YAAY,IAEtC,IAkQI0b,EAlQAC,EAAe,CACfx3E,EAAG,EACHC,EAAG,GAEPte,KAAKs1F,sBAAwB,IAAIvpB,GAAGsW,gBAAgB,CAChDj0E,OAAQpO,KAAK40F,SACb31B,aAAa,EACbpF,UAAY70C,IAKR,GAJAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,OACNs3F,EAAe,CAACx3E,EAAGre,KAAKyxE,UAAUpzD,EAAGC,EAAGte,KAAKyxE,UAAUnzD,IAExC,gBAAf0G,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CAKzD,IAAIgL,EAJJhnE,KAAKyxE,UAAUpzD,EAAIw3E,EAAax3E,GAAK2G,EAAM4zC,MAAQ5zC,EAAM05C,WAAa1+D,KAAKutC,MAC3EvtC,KAAKyxE,UAAUnzD,EAAIu3E,EAAav3E,GAAK0G,EAAM6zC,MAAQ7zC,EAAM25C,WAAa3+D,KAAKutC,MAI3E,IAAI+lD,EAAY,GAChB,GAAItzF,KAAKqzF,gBAAiB,CACtB,IAAIt3F,EAoBA+5F,EAnBJ,IAAK/5F,EAAI,EAAGA,EAAIiE,KAAKuzF,MAAMv3F,OAAQD,IAC/BirE,EAAOrpE,KAAKghB,IAAI3e,KAAKyxE,UAAUpzD,EAAIre,KAAKuzF,MAAMx3F,IAC1CirE,EAAOhnE,KAAKwzF,YAAcxzF,KAAKutC,SAC1B+lD,EAAKj1E,GAAK2oD,EAAOssB,EAAKyC,SACvBzC,EAAKj1E,EAAIre,KAAKuzF,MAAMx3F,GACpBu3F,EAAKyC,MAAQ/uB,GAIzB,IAAKjrE,EAAI,EAAGA,EAAIiE,KAAKyzF,MAAMz3F,OAAQD,IAC/BirE,EAAOrpE,KAAKghB,IAAI3e,KAAKyxE,UAAUnzD,EAAIte,KAAKyzF,MAAM13F,IAC1CirE,EAAOhnE,KAAKwzF,YAAcxzF,KAAKutC,SAC1B+lD,EAAKh1E,GAAK0oD,EAAOssB,EAAK0C,SACvB1C,EAAKh1E,EAAIte,KAAKyzF,MAAM13F,GACpBu3F,EAAK0C,MAAQhvB,GAMzB,IAAKjrE,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAEpB,IAAI0gB,EACJ,IAFAq5E,EAAKlD,GAAa5yF,KAAKizF,QAAQl3F,GAAGsiB,EAAGre,KAAKizF,QAAQl3F,GAAGuiB,EAAGte,KAAKyxE,WAExDh1D,EAAI,EAAGA,EAAIzc,KAAKuzF,MAAMv3F,OAAQygB,IAC/BuqD,EAAOrpE,KAAKghB,IAAIm3E,EAAGz3E,EAAIre,KAAKuzF,MAAM92E,IAC9BuqD,EAAOhnE,KAAKwzF,YAAcxzF,KAAKutC,SAC1B+lD,EAAKj1E,GAAK2oD,EAAOssB,EAAKyC,SACvBzC,EAAKj1E,EAAIre,KAAKuzF,MAAM92E,IAAMq5E,EAAGz3E,EAAIre,KAAKyxE,UAAUpzD,GAChDi1E,EAAKyC,MAAQ/uB,GAIzB,IAAKvqD,EAAI,EAAGA,EAAIzc,KAAKyzF,MAAMz3F,OAAQygB,IAC/BuqD,EAAOrpE,KAAKghB,IAAIm3E,EAAGx3E,EAAIte,KAAKyzF,MAAMh3E,IAC9BuqD,EAAOhnE,KAAKwzF,YAAcxzF,KAAKutC,SAC1B+lD,EAAKh1E,GAAK0oD,EAAOssB,EAAK0C,SACvB1C,EAAKh1E,EAAIte,KAAKyzF,MAAMh3E,IAAMq5E,EAAGx3E,EAAIte,KAAKyxE,UAAUnzD,GAChDg1E,EAAK0C,MAAQhvB,IAMjC,GAAuC,UAAnChnE,KAAK82D,YAAY2e,cAA2B,CAC5C,IAAIwgB,EAAYlqB,GAAG+nB,mBACf,CAACz1E,EAAG,EAAGC,EAAGu3E,EAAav3E,GACvB,CAACD,EAAG,GAAIC,EAAGu3E,EAAav3E,GACxB,CAACD,EAAGre,KAAKyxE,UAAUpzD,EAAGC,EAAGte,KAAKyxE,UAAUnzD,IACxC0oD,EAAO+E,GAAG/E,KAAKivB,EAAU53E,EAAG43E,EAAU33E,EAAGte,KAAKyxE,UAAUpzD,EAAGre,KAAKyxE,UAAUnzD,GAC9Eg1E,EAAO,GACPA,EAAKj1E,EAAI43E,EAAU53E,EACnBi1E,EAAKh1E,EAAI23E,EAAU33E,EACnBg1E,EAAKyC,MAAQ/uB,EACbssB,EAAK0C,MAAQhvB,EAEbivB,EAAYlqB,GAAG+nB,mBACX,CAACz1E,EAAGw3E,EAAax3E,EAAGC,EAAG,GACvB,CAACD,EAAGw3E,EAAax3E,EAAGC,EAAG,IACvB,CAACD,EAAGre,KAAKyxE,UAAUpzD,EAAGC,EAAGte,KAAKyxE,UAAUnzD,IAC5C0oD,EAAO+E,GAAG/E,KAAKivB,EAAU53E,EAAG43E,EAAU33E,EAAGte,KAAKyxE,UAAUpzD,EAAGre,KAAKyxE,UAAUnzD,GACtE0oD,EAAOssB,EAAKyC,QACZzC,EAAKj1E,EAAI43E,EAAU53E,EACnBi1E,EAAKh1E,EAAI23E,EAAU33E,EACnBg1E,EAAKyC,MAAQ/uB,EACbssB,EAAK0C,MAAQhvB,GAGjBivB,EAAYlqB,GAAG+nB,mBACX,CAACz1E,EAAGw3E,EAAax3E,EAAGC,EAAGu3E,EAAav3E,GACpC,CAACD,EAAGw3E,EAAax3E,EAAI,EAAGC,EAAGu3E,EAAav3E,EAAI,GAC5C,CAACD,EAAGre,KAAKyxE,UAAUpzD,EAAGC,EAAGte,KAAKyxE,UAAUnzD,IAC5C0oD,EAAO+E,GAAG/E,KAAKivB,EAAU53E,EAAG43E,EAAU33E,EAAGte,KAAKyxE,UAAUpzD,EAAGre,KAAKyxE,UAAUnzD,GACtE0oD,EAAOssB,EAAKyC,QACZzC,EAAKj1E,EAAI43E,EAAU53E,EACnBi1E,EAAKh1E,EAAI23E,EAAU33E,EACnBg1E,EAAKyC,MAAQ/uB,EACbssB,EAAK0C,MAAQhvB,GAGjBivB,EAAYlqB,GAAG+nB,mBACX,CAACz1E,EAAGw3E,EAAax3E,EAAGC,EAAGu3E,EAAav3E,GACpC,CAACD,EAAGw3E,EAAax3E,EAAI,EAAGC,EAAGu3E,EAAav3E,EAAI,GAC5C,CAACD,EAAGre,KAAKyxE,UAAUpzD,EAAGC,EAAGte,KAAKyxE,UAAUnzD,IAC5C0oD,EAAO+E,GAAG/E,KAAKivB,EAAU53E,EAAG43E,EAAU33E,EAAGte,KAAKyxE,UAAUpzD,EAAGre,KAAKyxE,UAAUnzD,GACtE0oD,EAAOssB,EAAKyC,QACZzC,EAAKj1E,EAAI43E,EAAU53E,EACnBi1E,EAAKh1E,EAAI23E,EAAU33E,EACnBg1E,EAAKyC,MAAQ/uB,EACbssB,EAAK0C,MAAQhvB,GAGPlkE,MAAVwwF,EAAKj1E,IACLre,KAAKyxE,UAAUpzD,EAAIi1E,EAAKj1E,GAEdvb,MAAVwwF,EAAKh1E,IACLte,KAAKyxE,UAAUnzD,EAAIg1E,EAAKh1E,GAIxB3gB,KAAKghB,IAAI3e,KAAKyxE,UAAUG,UAAY,IAAO,IAC3C6gB,GAAYzyF,KAAKyxE,WACjBzxE,KAAKg0F,yBAGTh0F,KAAKw0F,gBAKjB,IAAK,IAAI79B,EAAI,EAAGA,EAAI,EAAGA,IAAC,CAClB56D,IACE,MAAM04D,EAAIz0D,KAAKizF,QAAQl3F,GAAK,CACxBA,EAAGA,EACHsR,GAAI0+D,GAAG1+D,GAAG,CACN0nE,IAAK,CACDjjB,MAAO9xD,KAAKy1F,SAAW,KACvB1jC,OAAQ/xD,KAAKy1F,SAAW,KACxB/b,WAAY,OAOZ0C,aAAcp8E,KAAKy1F,SAAW,KAC9BlkE,SAAU,WACVooD,UAAW,0BAGnBt7D,EAAG,EACHC,EAAG,EACH43E,WAAY,CACR73E,EAAG,EACHC,EAAG,GAEPk2E,UAAW,KACXxS,gBAAiB,MAErBvtB,EAAE+/B,UAAS,KAIP,MAAM2B,EAAY,CAAC,EAAC,GAAI,GAAK,CAAC,GAAG,GAAK,CAAC,EAAG,GAAI,EAAC,EAAI,IAAI71D,KAAI3X,IACvDA,EAAK,IAAM3oB,KAAKyxE,UAAU3f,MAAQ,EAAI,GAAI,EAC1CnpC,EAAK,IAAM3oB,KAAKyxE,UAAU1f,OAAS,EAAI,GAAI,EACpCppC,KAELytE,EAAaz4F,KAAKghB,IAAI3e,KAAKgzF,OAAOlhC,OAAS,IAAMn0D,KAAKghB,IAAI3e,KAAKgzF,OAAOjhC,QAAU,GAAK,GAAK,EAEhGga,GAAGgJ,IAAItgB,EAAEpnD,GAAI,CACTyN,KAAO9a,KAAKgzF,OAAOC,QAAQx+B,EAAE14D,GAAGsiB,EAAIre,KAAKy1F,SAAW,EAAIU,EAAUp6F,GAAG,GAAKq6F,EAAc,KACxF7iC,IAAMvzD,KAAKgzF,OAAOC,QAAQx+B,EAAE14D,GAAGuiB,EAAIte,KAAKy1F,SAAW,EAAIU,EAAUp6F,GAAG,GAAKq6F,EAAc,OAK3F,IAAI7yB,EAAQwI,GAAG8gB,iBACX,CACIxuE,EAAGre,KAAKyxE,UAAUpzD,EAClBC,EAAGte,KAAKyxE,UAAUnzD,GAEtBs0E,GAAan+B,EAAEp2C,EAAGo2C,EAAEn2C,EAAGte,KAAKyxE,YAC5B,SACGlO,EAAQ,GACXA,GAAS,IAEb,IAAI32D,EAAQjP,KAAK4jC,MAAMgiC,EAAQ,IAAMvjE,KAAKw1F,cAAcx5F,OACxD+vE,GAAGgJ,IAAItgB,EAAEpnD,GAAI,CACT2wE,OAAQh+E,KAAKw1F,cAAc5oF,GAAS,aAI5C6nD,EAAEutB,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CACvCj0E,OAAQpO,KAAKizF,QAAQl3F,GAAGsR,GACxB4xD,aAAa,EACbpF,UAAY70C,IAER,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OACtCh8D,KAAKizF,QAAQl3F,GAAGm6F,WAAatD,GAAa5yF,KAAKizF,QAAQl3F,GAAGsiB,EAAGre,KAAKizF,QAAQl3F,GAAGuiB,EAAGte,KAAKyxE,gBAElF,GAAmB,gBAAfzsD,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CAChEh8D,KAAKizF,QAAQl3F,GAAGm6F,WAAW73E,GAAK2G,EAAMm4C,GAAKn9D,KAAKutC,MAChDvtC,KAAKizF,QAAQl3F,GAAGm6F,WAAW53E,GAAK0G,EAAMo4C,GAAKp9D,KAAKutC,MAEhD,IAAIuoD,EAAK,CACLz3E,EAAGre,KAAKizF,QAAQl3F,GAAGm6F,WAAW73E,EAC9BC,EAAGte,KAAKizF,QAAQl3F,GAAGm6F,WAAW53E,GAElCw3E,EAAK91F,KAAK0zF,gBAAgB33F,EAAG+5F,EAAGz3E,EAAGy3E,EAAGx3E,GACjCte,KAAK4zF,gBACNkC,EAAK91F,KAAKkzF,WAAW4C,EAAGz3E,EAAGy3E,EAAGx3E,IAG9B3gB,KAAKghB,IAAI3e,KAAKyxE,UAAUG,UAAY,IAAO,IAC3CkkB,EAAGz3E,EAAI1gB,KAAK4jC,MAAMu0D,EAAGz3E,GACrBy3E,EAAGx3E,EAAI3gB,KAAK4jC,MAAMu0D,EAAGx3E,IAGzB,MAAM+3E,EAAK1D,GAAiBmD,EAAGz3E,EAAGy3E,EAAGx3E,EAAGte,KAAKyxE,WAEvCtU,EAAKk5B,EAAGh4E,EAAIre,KAAKizF,QAAQl3F,GAAGsiB,EAC5B++C,EAAKi5B,EAAG/3E,EAAIte,KAAKizF,QAAQl3F,GAAGuiB,EAClCte,KAAKizF,QAAQl3F,GAAGsiB,EAAIg4E,EAAGh4E,EACvBre,KAAKizF,QAAQl3F,GAAGuiB,EAAI+3E,EAAG/3E,EAEvB,IAAIg4E,EAAU,GACJ,IAANv6F,EACAu6F,EAAU,CAAC,EAAG,EAAG,GACJ,IAANv6F,EACPu6F,EAAU,CAAC,EAAG,EAAG,GACJ,IAANv6F,EACPu6F,EAAU,CAAC,EAAG,EAAG,GACJ,IAANv6F,IACPu6F,EAAU,CAAC,EAAG,EAAG,IAGrBt2F,KAAKizF,QAAQqD,EAAQ,IAAIj4E,EAAIre,KAAKizF,QAAQl3F,GAAGsiB,EAC7Cre,KAAKizF,QAAQqD,EAAQ,IAAIh4E,EAAIte,KAAKizF,QAAQl3F,GAAGuiB,EACzCte,KAAK82D,YAAY0e,UAAU,WAC3Bx1E,KAAKizF,QAAQqD,EAAQ,IAAIj4E,GAAK8+C,EAC9Bn9D,KAAKizF,QAAQqD,EAAQ,IAAIh4E,GAAK8+C,EAC9Bp9D,KAAKizF,QAAQqD,EAAQ,IAAIj4E,EAAIre,KAAKizF,QAAQqD,EAAQ,IAAIj4E,EACtDre,KAAKizF,QAAQqD,EAAQ,IAAIh4E,EAAIte,KAAKizF,QAAQqD,EAAQ,IAAIh4E,GAG1Dte,KAAKu0F,iCApHD,CA0HjB59B,GAGP32D,KAAKg0F,wBACLh0F,KAAK+yF,eAGL,IAAK,IAAI98B,EAAI,EAAGA,EAAI,EAAGA,IAAC,CAClBl6D,IACEiE,KAAK60F,MAAM94F,GAAK,CACZsR,GAAI0+D,GAAG1+D,GAAG,CACN0nE,IAAK,CACDjjB,MAAO9xD,KAAK01F,SAAW,KACvB3jC,OAAQ/xD,KAAK01F,SAAW,KAOxBnkE,SAAU,cAGlBijE,UAAW,KACXxS,gBAAiB,MAErB,MAAMvtB,EAAIz0D,KAAK60F,MAAM94F,GACrB04D,EAAE+/B,UAAS,KACG,IAANz4F,EACAgwE,GAAGgJ,IAAItgB,EAAEpnD,GAAI,CACTyN,KAAMnd,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG50E,EAAGre,KAAKgzF,OAAOC,QAAQ,GAAG50E,GAAK,KACrEk1C,IAAM51D,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG30E,EAAGte,KAAKgzF,OAAOC,QAAQ,GAAG30E,GAAKte,KAAK01F,SAAY,KACtF5jC,MAAOn0D,KAAKghB,IAAI3e,KAAKgzF,OAAOlhC,OAAS,KACrCC,OAAQ/xD,KAAK01F,SAAW,OAEf,IAAN35F,EACPgwE,GAAGgJ,IAAItgB,EAAEpnD,GAAI,CACTyN,KAAMnd,KAAK6O,IAAIxM,KAAKgzF,OAAOC,QAAQ,GAAG50E,EAAGre,KAAKgzF,OAAOC,QAAQ,GAAG50E,GAAK,KACrEk1C,IAAK51D,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG30E,EAAGte,KAAKgzF,OAAOC,QAAQ,GAAG30E,GAAK,KACpEwzC,MAAO9xD,KAAK01F,SAAW,KACvB3jC,OAAQp0D,KAAKghB,IAAI3e,KAAKgzF,OAAOjhC,QAAU,OAE9B,IAANh2D,EACPgwE,GAAGgJ,IAAItgB,EAAEpnD,GAAI,CACTyN,KAAMnd,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG50E,EAAGre,KAAKgzF,OAAOC,QAAQ,GAAG50E,GAAK,KACrEk1C,IAAK51D,KAAK6O,IAAIxM,KAAKgzF,OAAOC,QAAQ,GAAG30E,EAAEte,KAAKgzF,OAAOC,QAAQ,GAAG30E,GAAK,KACnEwzC,MAAOn0D,KAAKghB,IAAI3e,KAAKgzF,OAAOlhC,OAAS,KACrCC,OAAQ/xD,KAAK01F,SAAW,OAEf,IAAN35F,GACPgwE,GAAGgJ,IAAItgB,EAAEpnD,GAAI,CACTyN,KAAOnd,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG50E,EAAGre,KAAKgzF,OAAOC,QAAQ,GAAG50E,GAAKre,KAAK01F,SAAY,KACvFniC,IAAK51D,KAAK+O,IAAI1M,KAAKgzF,OAAOC,QAAQ,GAAG30E,EAAGte,KAAKgzF,OAAOC,QAAQ,GAAG30E,GAAK,KACpEwzC,MAAO9xD,KAAK01F,SAAW,KACvB3jC,OAAQp0D,KAAKghB,IAAI3e,KAAKgzF,OAAOjhC,QAAU,OAG/C,IAAIwkC,EAAc54F,KAAK4jC,MAAMvhC,KAAKyxE,UAAUG,SAAW,SAChD2kB,EAAc,GACjBA,GAAe,EACnBA,GAAmB,EAAJx6F,EAAQ,EAAIw6F,GAAev2F,KAAKw1F,cAAcx5F,OAC7Dy4D,EAAEpnD,GAAGuI,MAAMooE,OAASh+E,KAAKw1F,cAAce,GAAe,WAI1D,MAAMC,EAAa,CAAC,EAAG,GAAGjpF,SAASxR,GACnC04D,EAAEutB,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CACvCj0E,OAAQpO,KAAK60F,MAAM94F,GAAGsR,GACtB4xD,aAAa,EACbpF,UAAY70C,IAUR,GATAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,SAElC45B,EADAY,EACax2F,KAAKizF,QAAQ,GAAG30E,GAAKte,KAAKizF,QAAQ,GAAG30E,EAErCte,KAAKizF,QAAQ,GAAG50E,GAAKre,KAAKizF,QAAQ,GAAG50E,EA5UtEs3E,EAAiBt3E,EAAI,EACrBs3E,EAAiBr3E,EAAI,GA+UU,gBAAf0G,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAMy6B,EAAM1qB,GAAGihB,aAAa,CAAC3uE,EAAG,EAAGC,EAAG,GAClC,CAACD,EAAG2G,EAAMm4C,GAAKn9D,KAAKutC,MAAOjvB,EAAG0G,EAAMo4C,GAAKp9D,KAAKutC,QAC7CvtC,KAAKyxE,UAAUG,UACpB,IAAI8kB,EAAK,CACLv5B,GAAIs5B,EAAIp4E,EACR++C,GAAIq5B,EAAIn4E,GAER3gB,KAAKghB,IAAI3e,KAAKyxE,UAAUG,UAAY,IAAO,IAC3C8kB,EAAK3qB,GAAG4qB,OAAOhB,EAAkBc,EAAIp4E,EAAGo4E,EAAIn4E,IAGhD,IAAIg4E,EAAU,GACJ,IAANv6F,EACAu6F,EAAU,CAAC,EAAG,EAAG,EAAG,GACP,IAANv6F,EACPu6F,EAAU,CAAC,EAAG,EAAG,EAAG,GACP,IAANv6F,EACPu6F,EAAU,CAAC,EAAG,EAAG,EAAG,GACP,IAANv6F,IACPu6F,EAAU,CAAC,EAAG,EAAG,EAAG,IAGxB,IAAIM,EAAYJ,EAAa,IAAM,IAC/BrgC,EAAIqgC,EAAaE,EAAGt5B,GAAKs5B,EAAGv5B,GAE5By4B,GACA51F,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,EACvCn2D,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,IAEvCn2D,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,EACvCn2D,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,GAEvCn2D,KAAK82D,YAAY0e,UAAU,WACvBogB,GACA51F,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,EACvCn2D,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,IAEvCn2D,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,EACvCn2D,KAAKizF,QAAQqD,EAAQ,IAAIM,IAAczgC,IAI3CqgC,EACAx2F,KAAKi0F,cAAa,GAAO,GAEzBj0F,KAAKi0F,cAAa,GAAM,GAG5Bj0F,KAAKu0F,iCAzHD,CA+HjBt+B,GAGPj2D,KAAK80F,UAAY,CACbznF,GAAI0+D,GAAG1+D,GAAG,CACN0nE,IAAK,CACDiJ,OAAQ,OAASpG,EAAAib,IAAY,gBAC7B/gC,MAAO9xD,KAAKy1F,SAAW,KACvB1jC,OAAQ/xD,KAAKy1F,SAAW,KACxB/b,WAAY,OACZ0C,aAAcp8E,KAAKy1F,SAAW,KAC9BlkE,SAAU,WACVooD,UAAW,0BAGnBt7D,EAAG,EACHC,EAAG,EACHg1E,MAAM,EACNkB,UAAS,KACLzoB,GAAGgJ,IAAI/0E,KAAK80F,UAAUznF,GAAI,CACtByN,KAAO9a,KAAK80F,UAAUz2E,EAAIre,KAAKy1F,SAAW,EAAK,KAC/CliC,IAAMvzD,KAAK80F,UAAUx2E,EAAIte,KAAKy1F,SAAW,EAAK,SAI1D1pB,GAAG1+D,GAAG,CACFga,OAAQrnB,KAAK80F,UAAUznF,GACvB0nE,IAAK,CACDjjB,MAAO,MACPC,OAAQ,OACRj3C,KAAO9a,KAAKy1F,SAAW,EAAI,EAAK,KAChCliC,IAAKvzD,KAAKy1F,SAAW,KACrB/b,WAAY,OACZnoD,SAAU,cAIlBvxB,KAAKu1F,qBAAuB,IAAIxpB,GAAGsW,gBAAgB,CAC/Cj0E,OAAQpO,KAAK80F,UAAUznF,GACvB4xD,aAAa,EACbpF,UAAY70C,IAER,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CAEzD,MAAMzB,EAASv6D,KAAK84E,OAAOte,wBACrB58B,EAAS,CACXvf,EAAGk8C,EAAOz/C,KAAO9a,KAAK84E,OAAOxnB,WAC7BhzC,EAAGi8C,EAAOhH,IAAMvzD,KAAK84E,OAAOvnB,WAE1BukC,EAAK,CAACz3E,GAAI2G,EAAM8zC,QAAUl7B,EAAOvf,GAAKre,KAAKutC,MAAOjvB,GAAI0G,EAAM+zC,QAAUn7B,EAAOtf,GAAKte,KAAKutC,OAEvFnlC,EAAI2jE,GAAG8gB,iBAAiB,CAACxuE,EAAGre,KAAKyxE,UAAUpzD,EAAGC,EAAGte,KAAKyxE,UAAUnzD,GAAIw3E,GAAM,GAChF91F,KAAKyxE,UAAUG,SAAWxpE,EAC1B,MAAMyuF,EAAoC,GAA1Bl5F,KAAK4jC,MAAMn5B,EAAI,IAAM,IACE,UAAnCpI,KAAK82D,YAAY2e,eAEVz1E,KAAKqzF,iBAAmB11F,KAAKghB,IAAIk4E,EAAUzuF,GAAK,KADvDpI,KAAKyxE,UAAUG,SAAWilB,GAI9B72F,KAAKw0F,YAGU,cAAfxvE,EAAMzmB,MACFZ,KAAKghB,IAAI3e,KAAKyxE,UAAUG,UAAY,IAAO,IAC3C6gB,GAAYzyF,KAAKyxE,WACjBzxE,KAAKg0F,wBACLh0F,KAAKw0F,gBAMrB/B,GAAYzyF,KAAKyxE,WACjBzxE,KAAKw0F,WAAU,GACfzoB,GAAGxlB,OAAOvmD,KAAK00F,QAAS,CACpB10F,KAAK40F,SACL50F,KAAK60F,MAAM,GAAGxnF,GACdrN,KAAK60F,MAAM,GAAGxnF,GACdrN,KAAK60F,MAAM,GAAGxnF,GACdrN,KAAK60F,MAAM,GAAGxnF,GACdrN,KAAKizF,QAAQ,GAAG5lF,GAChBrN,KAAKizF,QAAQ,GAAG5lF,GAChBrN,KAAKizF,QAAQ,GAAG5lF,GAChBrN,KAAKizF,QAAQ,GAAG5lF,GAChBrN,KAAK80F,UAAUznF,eE75BXypF,GAAoBrxC,GAehC,IAAIsxC,EAAahrB,GAAGod,QAChB1jC,EAAOuxC,WACPvxC,EAAOwxC,YACPxxC,EAAO86B,aAAe,GACtB96B,EAAO+6B,cAAgB,GACvB,GAEAjzC,EAAQwpD,EAAWjlC,MAAQrM,EAAOuxC,WAElC53E,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDjjB,MAAOrM,EAAO86B,aAAe,KAC7BxuB,OAAQtM,EAAO+6B,cAAgB,KAC/BZ,gBAAiB,UACjBjG,UAAW,sEACXd,SAAU,SACVmI,WAAY,OACZzvD,SAAU,WACV1b,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,gBAGrB/+D,EAAIiiE,cAAgB,WAChB,OAAO,GAGX,IAAI6V,EAAenrB,GAAG1+D,GAAG,CACrB0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOilC,EAAWjlC,MAAQ,KAC1BC,OAAQglC,EAAWhlC,OAAS,QAGpC3yC,EAAIxgB,YAAYs4F,GAEhB,IAAIC,EAAkB1xC,EAAO+pC,OAAOlvD,KAAI3X,IAC7B,CACH+1D,MAAO/1D,EAAK+1D,MACZ+Q,WAAY9mE,EAAK8mE,WACjB5P,QAASl3D,EAAKk3D,YAGtBsX,EAAgBA,EAAgBn7F,OAAS,GAAG0iF,MAAQ3S,GAAGlZ,OACnDtlB,EAAQ,EAAIkY,EAAOuxC,WAAaD,EAAWjlC,MAC3CvkB,EAAQ,EAAIkY,EAAOwxC,YAAcF,EAAWhlC,QAEhD,IAOIqlC,EACAC,EARAC,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOilC,EAAWjlC,MAClBC,OAAQglC,EAAWhlC,OACnBy9B,OAAQ2H,aAMHI,IACL,IAAKH,EACD,OAGJ,IAAI3lB,EAAY2lB,EAAcrC,eAC1BxnD,EAAQ,IACRkkC,EAAUpzD,GAAKkvB,EACfkkC,EAAUnzD,GAAKivB,EACfkkC,EAAU3f,OAASvkB,EACnBkkC,EAAU1f,QAAUxkB,GAGxB,IAAIiqD,EAAaL,EAAgB1xC,EAAOgyC,gBAAgB/Y,MACpDrZ,EAAOmyB,EAAiC1kC,WAAW,MACvDuS,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAGgF,EAAW1lC,MAAO0lC,EAAWzlC,QACjDga,GAAG2rB,+BACCryB,EACA5f,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MACrCjN,EACA,KACA1F,GAAG4rB,mBAAmBlmB,EAAWA,EAAU3f,MAAQulC,EAAcvlC,MAAO2f,EAAU1f,OAASslC,EAActlC,SAE7GsT,EAAIiN,UACJglB,EAAgB/E,SA7BpB2E,EAAat4F,YAAY04F,EAAgBpa,cAgCzC,CACI,IAAI0a,EAAgB,CAChB9lC,MAAOrM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM5sB,MAAQvkB,EAC1DwkB,OAAQtM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM3sB,OAASxkB,IAE5DqqD,EAAc9lC,MAAQilC,EAAWjlC,OAAS8lC,EAAc7lC,OAASglC,EAAWhlC,UAC5E6lC,EAAgB7rB,GAAGod,QACf1jC,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM5sB,MAC3CrM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM3sB,OAC3CglC,EAAWjlC,MACXilC,EAAWhlC,OACX,IAGRslC,EAAgB,CACZh5E,EAAGonC,EAAOuxC,WAAa,EACvB14E,EAAGmnC,EAAOwxC,YAAc,EACxBnlC,MAAOrM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM5sB,MAClDC,OAAQtM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM3sB,QAEvDqlC,EAAgB,IAAItE,GAAc,CAC9Bz0E,EAAGg5E,EAAch5E,EACjBC,EAAG+4E,EAAc/4E,EACjBwzC,MAAOulC,EAAcvlC,MACrBC,OAAQslC,EAActlC,OACtB6f,SAAU,EACVgiB,eAAe,EACfL,MAAO,CAAC,EAAG9tC,EAAOuxC,YAClBvD,MAAO,CAAC,EAAGhuC,EAAOwxC,aAClB1pD,MAAOA,EACPb,SAAW+kC,IACP8lB,OAIZxrB,GAAGgJ,IAAIqiB,EAAcla,aAAc,CAC/B3rD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,MAET2jC,EAAat4F,YAAYw4F,EAAcla,cACvCp3D,WAAWyxE,EAAe,GAK1Bv3F,KAAKm1F,KAAO,SAASh4B,EAAIC,GACrBg6B,EAAcjC,KAAKh4B,EAAIC,IAE3Bp9D,KAAKqqF,MAAQ,WACT,IAAIz4B,EAAInM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM5sB,MAC/CD,EAAIpM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM3sB,OAEnDqlC,EAAc1G,QAAQ9+B,EAAGC,GACzBulC,EAAclC,OAAO,CAAC72E,EAAGuzC,EAAI,EAAGtzC,EAAGuzC,EAAI,IACvCulC,EAAchC,YAAY,GAC1BmC,KAEJv3F,KAAK63F,gBAAkB,WAEnB,IAAIC,EAAM/rB,GAAGod,QACT1jC,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM5sB,MAC3CrM,EAAO+pC,OAAO/pC,EAAOgyC,gBAAgB/Y,MAAM3sB,OAC3CtM,EAAOuxC,WACPvxC,EAAOwxC,YACP,GAGJG,EAAc1G,QAAQoH,EAAIhmC,MAAOgmC,EAAI/lC,QACrCqlC,EAAclC,OAAO,CAAC72E,EAAGy5E,EAAIhmC,MAAQ,EAAGxzC,EAAGw5E,EAAI/lC,OAAS,IACxDqlC,EAAchC,YAAY,GAC1BmC,KAEJv3F,KAAK+3F,mBAAqB,WACtBX,EAAclC,OAAO,CAAC72E,EAAGonC,EAAOuxC,WAAa,EAAG14E,EAAGmnC,EAAOwxC,YAAc,IACxEG,EAAchC,YAAY,GAC1BmC,KAGJv3F,KAAKg4F,kBAAoB,WACrB,QAAKZ,GAGEA,EAAcrC,gBAEzB/0F,KAAKi4F,eAAc,KACf,MAAMxmB,EAAY2lB,EAAcrC,eAChC,OAAOhpB,GAAG4rB,mBAAmBlmB,EAAWA,EAAU3f,MAAQulC,EAAcvlC,MAAO2f,EAAU1f,OAASslC,EAActlC,SAEpH/xD,KAAKk9E,WAAa,WACd,OAAO99D,GAEXpf,KAAKu/D,QAAU,WACX63B,EAAc73B,oBChMN24B,GAASzyC,GACrB,IAAIpnC,EAAIonC,EAAOpnC,EACXC,EAAImnC,EAAOnnC,EACXwzC,EAAQrM,EAAOqM,MACfC,EAAStM,EAAOsM,OAChBxkB,EAAQkY,EAAOlY,MACfb,EAAW+Y,EAAO/Y,SAClByrD,EAAO1yC,EAAO0yC,KACdC,EAAO3yC,EAAO2yC,KACdh5E,EAAMhhB,SAASC,cAAc,OAC7Bg6F,EAAc,CAAC,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAEtDvhC,EAAc,IAAIiV,GAAGmO,YAAY,IAErCnO,GAAGgJ,IAAI31D,EAAK,CACRmS,SAAU,WACVzW,KAAOuD,EAAIkvB,EAAS,KACpBgmB,IAAMj1C,EAAIivB,EAAS,OAGvB,IAAI+qD,EAAUl6F,SAASC,cAAc,OACrC0tE,GAAGgJ,IAAIujB,EAAS,CACZ/mE,SAAU,WACVuuD,OAAQ,kBACR9B,OAAQ,SAEXsa,EAAgB7rD,OAAS,WACtBs/B,GAAGgJ,IAAIujB,EAAS,CACZx9E,KAAOy9E,EAAM,GAAGl6E,EAAIkvB,EAAQ,EAAK,KACjCgmB,IAAMglC,EAAM,GAAGj6E,EAAIivB,EAAQ,EAAK,KAChCukB,OAASymC,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAKkvB,EAAS,KAC7CwkB,QAAUwmC,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,GAAKivB,EAAS,QAGtD,IAAIooD,EAAmB,CACnBt3E,EAAG,EACHC,EAAG,GAEHk6E,EAAyB,IAAIzsB,GAAGsW,gBAAgB,CAChDj0E,OAAQkqF,EACRz+B,UAAW,SAAS70C,GAEhB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CAEzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAE1EgrD,EAAM,GAAGl6E,GAAK8+C,EACdo7B,EAAM,GAAGj6E,GAAK8+C,EACdm7B,EAAM,GAAGl6E,GAAK8+C,EACdo7B,EAAM,GAAGj6E,GAAK8+C,EACdm7B,EAAM,GAAGl6E,GAAK8+C,EACdo7B,EAAM,GAAGj6E,GAAK8+C,EACdm7B,EAAM,GAAGl6E,GAAK8+C,EACdo7B,EAAM,GAAGj6E,GAAK8+C,EAEd3wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAKRC,EAAmBt6F,SAASC,cAAc,OAC9C0tE,GAAGgJ,IAAI2jB,EAAkB,CACrBnnE,SAAU,WACVonE,UAAW,iBACXC,aAAc,mBAEjBF,EAAyBjsD,OAAS,WAC/Bs/B,GAAGgJ,IAAI2jB,EAAkB,CACrB59E,KAAOy9E,EAAM,GAAGl6E,EAAIkvB,EAAS,KAC7BgmB,KAAOglC,EAAM,GAAGj6E,GAAKi6E,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,GAAK,GAAKivB,EAAS,KAC9DukB,OAASymC,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAKkvB,EAAS,KAC7CwkB,QAAUwmC,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,GAAK,EAAIivB,EAAS,QAI1D,IAAIsrD,EAAiBz6F,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAI8jB,EAAgB,CACnBtnE,SAAU,WACV4zD,WAAY,iBACZC,YAAa,mBAEhByT,EAAuBpsD,OAAS,WAC7Bs/B,GAAGgJ,IAAI8jB,EAAgB,CACnB/9E,MAAQy9E,EAAM,GAAGl6E,GAAKk6E,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAK,GAAKkvB,EAAS,KAC/DgmB,IAAMglC,EAAM,GAAGj6E,EAAIivB,EAAS,KAC5BukB,OAASymC,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAK,EAAIkvB,EAAS,KACjDwkB,QAAUwmC,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,GAAKivB,EAAS,QAKtD,MACMurD,EAAc,GAEpB,IAAIP,EAGE,CACF,CAACl6E,EAAG,EAAGC,EAAG,GACV,CAACD,EAAGyzC,EAAOxzC,EAAG,GACd,CAACD,EAAGyzC,EAAOxzC,EAAGyzC,GACd,CAAC1zC,EAAG,EAAGC,EAAGyzC,aAGLgnC,EAAa37B,GAClBm7B,EAAM,GAAGj6E,GAAK8+C,EACdm7B,EAAM,GAAGj6E,EAAI3gB,KAAK6O,IAAI+rF,EAAM,GAAGj6E,EAAI85E,EAAMz6F,KAAK+O,IAAI6rF,EAAM,GAAGj6E,EAAI,EAAGi6E,EAAM,GAAGj6E,IAC3Ei6E,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,WAEjB06E,EAAe77B,GACpBo7B,EAAM,GAAGl6E,GAAK8+C,EACdo7B,EAAM,GAAGl6E,EAAI1gB,KAAK+O,IAAI6rF,EAAM,GAAGl6E,EAAI85E,EAAMx6F,KAAK6O,IAAI+rF,EAAM,GAAGl6E,EAAI,EAAGk6E,EAAM,GAAGl6E,IAC3Ek6E,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,WAEjB46E,EAAgB77B,GACrBm7B,EAAM,GAAGj6E,GAAK8+C,EACdm7B,EAAM,GAAGj6E,EAAI3gB,KAAK+O,IAAI6rF,EAAM,GAAGj6E,EAAI85E,EAAMz6F,KAAK6O,IAAI+rF,EAAM,GAAGj6E,EAAI,EAAGi6E,EAAM,GAAGj6E,IAC3Ei6E,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,WAEjB46E,EAAc/7B,GACnBo7B,EAAM,GAAGl6E,GAAK8+C,EACdo7B,EAAM,GAAGl6E,EAAI1gB,KAAK6O,IAAI+rF,EAAM,GAAGl6E,EAAI85E,EAAMx6F,KAAK+O,IAAI6rF,EAAM,GAAGl6E,EAAI,EAAGk6E,EAAM,GAAGl6E,IAC3Ek6E,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,WAGjBo6E,IACL9C,EAAiBt3E,EAAI,EACrBs3E,EAAiBr3E,EAAI,EACrBouB,EAASqoD,KAMb,IAAIF,EAAQ,GACZ,IAAK,IAAIl+B,EAAI,EAAGA,EAAI,EAAGA,KAAC,SACT56D,GACP84F,EAAM94F,GAAKqC,SAASC,cAAc,OAClC,IAAIo2D,EAAIogC,EAAM94F,GACd04D,EAAE7+C,MAAMk8C,MAAQ2jC,OAChBhhC,EAAE7+C,MAAMm8C,OAAS0jC,OAEjBhhC,EAAE7+C,MAAM2b,SAAW,WACnBkjC,EAAEhoB,OAAS,WACG,IAAN1wC,GACA04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAQurD,EAAe,KACpDrkC,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAQkoD,GAAeqD,EAAe,KAClErkC,EAAE7+C,MAAMk8C,OAAUymC,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAKkvB,EAAQurD,GAAmB,KACxErkC,EAAE7+C,MAAMm8C,OAAU0jC,QACL,IAAN15F,GACP04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAQurD,EAAe,KACpDrkC,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAQurD,EAAe,KACnDrkC,EAAE7+C,MAAMk8C,MAAS2jC,OACjBhhC,EAAE7+C,MAAMm8C,QAAWwmC,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,GAAKivB,EAAQurD,GAAmB,MAC5D,IAAN/8F,GACP04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAQurD,EAAe,KACpDrkC,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAQurD,EAAe,KACnDrkC,EAAE7+C,MAAMk8C,OAAUymC,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAKkvB,EAAQurD,GAAmB,KACxErkC,EAAE7+C,MAAMm8C,OAAU0jC,QACL,IAAN15F,IACP04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAQkoD,GAAeqD,EAAe,KACnErkC,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAQurD,EAAe,KACnDrkC,EAAE7+C,MAAMk8C,MAAS2jC,OACjBhhC,EAAE7+C,MAAMm8C,QAAWwmC,EAAM,GAAGj6E,EAAIi6E,EAAM,GAAGj6E,GAAKivB,EAAQurD,GAAmB,MAE7E,IAAIvC,EAAkB,EAAJx6F,EAAQ,EAC1B04D,EAAE7+C,MAAMooE,OAASqa,EAAY9B,GAAe,WA/BhC,CAkCjB5/B,GAGP,IAAIo5B,EAAS,GACb,IAAK,IAAI95B,EAAI,EAAGA,EAAI,EAAGA,KAAC,SACTl6D,GACPg0F,EAAOh0F,GAAKqC,SAASC,cAAc,OACnC,IAAIo2D,EAAIs7B,EAAOh0F,GACf04D,EAAE7+C,MAAM2b,SAAW,WACnBkjC,EAAE7+C,MAAM8jE,WAAa,OACrBjlB,EAAE7+C,MAAMiqE,QAAU,MAClBprB,EAAEhoB,OAAS,WACG,IAAN1wC,GACA04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAS,KACtCknB,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAQ,IAAQ,KAC5CknB,EAAE7+C,MAAMk8C,OAAUymC,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAKkvB,EAAS,KACtDknB,EAAE7+C,MAAMm8C,OAAS,UACJ,IAANh2D,GACP04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAS,KACtCknB,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAQ,IAAQ,KAC5CknB,EAAE7+C,MAAMk8C,MAAQ,SAChB2C,EAAE7+C,MAAMm8C,OAAS,WACJ,IAANh2D,GACP04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAS,KACtCknB,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAS,KACrCknB,EAAE7+C,MAAMk8C,OAAUymC,EAAM,GAAGl6E,EAAIk6E,EAAM,GAAGl6E,GAAKkvB,EAAS,KACtDknB,EAAE7+C,MAAMm8C,OAAS,UACJ,IAANh2D,IACP04D,EAAE7+C,MAAMkF,KAAQy9E,EAAM,GAAGl6E,EAAIkvB,EAAQ,IAAQ,KAC7CknB,EAAE7+C,MAAM29C,IAAOglC,EAAM,GAAGj6E,EAAIivB,EAAQ,IAAQ,KAC5CknB,EAAE7+C,MAAMk8C,MAAQ,SAChB2C,EAAE7+C,MAAMm8C,OAAS,YA3BT,CA+BjBkE,GAGP,IAAIkjC,EAAuB,IAAIptB,GAAGsW,gBAAgB,CAC9Cj0E,OAAQymF,EAAM,GACd51B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1EwrD,EAAa37B,GACTtG,EAAY0e,UAAU,UACtByjB,GAAiB77B,GAErB3wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAIRW,EAAuB,IAAIrtB,GAAGsW,gBAAgB,CAC9Cj0E,OAAQymF,EAAM,GACd51B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1EyrD,EAAe77B,GACXrG,EAAY0e,UAAU,UACtB0jB,GAAe/7B,GAEnB1wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAIRY,EAAuB,IAAIttB,GAAGsW,gBAAgB,CAC9Cj0E,OAAQymF,EAAM,GACd51B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1E0rD,EAAgB77B,GACZtG,EAAY0e,UAAU,UACtBujB,GAAc37B,GAElB3wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAIRa,EAAuB,IAAIvtB,GAAGsW,gBAAgB,CAC9Cj0E,OAAQymF,EAAM,GACd51B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1E2rD,EAAc/7B,GACVrG,EAAY0e,UAAU,UACtBwjB,GAAgB77B,GAEpB1wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAMRc,EAAc,eAEd,IAAK,IAAIC,EAAI,EAAGA,EAAI,EAAGA,KAAC,SACTz9F,GACPw9F,EAAYx9F,GAAKqC,SAASC,cAAc,OACxC,IAAIo2D,EAAI8kC,EAAYx9F,GACpBgwE,GAAGgJ,IAAItgB,EAAG,CAEN3C,MAAQ2jC,OACR1jC,OAAS0jC,OACTlkE,SAAU,aAEdkjC,EAAE7+C,MAAMooE,OAAS,CAAC,cAAe,eAAejiF,EAAI,GACpD04D,EAAEhoB,OAAS,WACG,IAAN1wC,EACAgwE,GAAGgJ,IAAItgB,EAAG,CACN35C,KAAOy9E,EAAM,GAAGl6E,EAAIkvB,EAAQkoD,GAAeqD,EAAe,KAC1DvlC,IAAMglC,EAAM,GAAGj6E,EAAIivB,EAAQkoD,GAAeqD,EAAe,OAEhD,IAAN/8F,EACPgwE,GAAGgJ,IAAItgB,EAAG,CACN35C,KAAOy9E,EAAM,GAAGl6E,EAAIkvB,EAAQurD,EAAe,KAC3CvlC,IAAMglC,EAAM,GAAGj6E,EAAIivB,EAAQkoD,GAAeqD,EAAe,OAEhD,IAAN/8F,EACPgwE,GAAGgJ,IAAItgB,EAAG,CACN35C,KAAOy9E,EAAM,GAAGl6E,EAAIkvB,EAAQurD,EAAe,KAC3CvlC,IAAMglC,EAAM,GAAGj6E,EAAIivB,EAAQurD,EAAe,OAEjC,IAAN/8F,GACPgwE,GAAGgJ,IAAItgB,EAAG,CACN35C,KAAOy9E,EAAM,GAAGl6E,EAAIkvB,EAAQkoD,GAAeqD,EAAe,KAC1DvlC,IAAMglC,EAAM,GAAGj6E,EAAIivB,EAAQurD,EAAe,QA9BtC,CAkCjBU,MAIX,IAAIC,EAAyB,IAAI1tB,GAAGsW,gBAAgB,CAChDj0E,OAAQmrF,EAAY,GACpBt6B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1E2rD,EAAc/7B,GACd47B,EAAa37B,GACTtG,EAAY0e,UAAU,WACtBwjB,GAAgB77B,GAChB87B,GAAiB77B,IAErB3wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAKRiB,EAAyB,IAAI3tB,GAAGsW,gBAAgB,CAChDj0E,OAAQmrF,EAAY,GACpBt6B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1EyrD,EAAe77B,GACf47B,EAAa37B,GACTtG,EAAY0e,UAAU,WACtB0jB,GAAe/7B,GACf87B,GAAiB77B,IAErB3wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAKRkB,EAAyB,IAAI5tB,GAAGsW,gBAAgB,CAChDj0E,OAAQmrF,EAAY,GACpBt6B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1EyrD,EAAe77B,GACf87B,EAAgB77B,GACZtG,EAAY0e,UAAU,WACtB0jB,GAAe/7B,GACf47B,GAAc37B,IAElB3wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,OAKRmB,EAAyB,IAAI7tB,GAAGsW,gBAAgB,CAChDj0E,OAAQmrF,EAAY,GACpBt6B,aAAa,EACbpF,UAAW,SAAU70C,GAEjB,GADAA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CACzD,MAAOmB,GAAAA,EAAEC,GAAEA,GAAM2O,GAAG4qB,OAAOhB,EAAkB3wE,EAAMm4C,GAAK5vB,EAAOvoB,EAAMo4C,GAAK7vB,GAC1E2rD,EAAc/7B,GACd87B,EAAgB77B,GACZtG,EAAY0e,UAAU,WACtBwjB,GAAgB77B,GAChB47B,GAAc37B,IAElB3wB,IAEe,cAAfznB,EAAMzmB,MACNk6F,gBAQH1D,IAWL,OAVAwD,EAAM,GAAGl6E,GAAKk6E,EAAM,GAAGl6E,EACvBk6E,EAAM,GAAGj6E,GAAKi6E,EAAM,GAAGj6E,EACvBi6E,EAAM,GAAGl6E,GAAKk6E,EAAM,GAAGl6E,EACvBk6E,EAAM,GAAGj6E,GAAKi6E,EAAM,GAAGj6E,EACvBi6E,EAAM,GAAGl6E,GAAKk6E,EAAM,GAAGl6E,EACvBk6E,EAAM,GAAGj6E,GAAKi6E,EAAM,GAAGj6E,EACvBD,GAAKk6E,EAAM,GAAGl6E,EACdC,GAAKi6E,EAAM,GAAGj6E,EACdi6E,EAAM,GAAGl6E,EAAI,EACbk6E,EAAM,GAAGj6E,EAAI,EACN,CACHD,EAAGA,EACHC,EAAGA,EACHwzC,MAAOymC,EAAM,GAAGl6E,EAChB0zC,OAAQwmC,EAAM,GAAGj6E,YA0BhBmuB,IAELooD,EAAM,GAAGpoD,SACTooD,EAAM,GAAGpoD,SACTooD,EAAM,GAAGpoD,SACTooD,EAAM,GAAGpoD,SACT8sD,EAAY,GAAG9sD,SACf8sD,EAAY,GAAG9sD,SACf8sD,EAAY,GAAG9sD,SACf8sD,EAAY,GAAG9sD,SACfsjD,EAAO,GAAGtjD,SACVsjD,EAAO,GAAGtjD,SACVsjD,EAAO,GAAGtjD,SACVsjD,EAAO,GAAGtjD,SACT6rD,EAAgB7rD,SAChBisD,EAAyBjsD,SACzBosD,EAAuBpsD,SArC5BrtB,EAAImnC,OACAwpC,EAAO,GACPA,EAAO,GACPA,EAAO,GACPA,EAAO,GACP2I,EACAG,EACAP,EAEAzD,EAAM,GACNA,EAAM,GACNA,EAAM,GACNA,EAAM,GAEN0E,EAAY,GACZA,EAAY,GACZA,EAAY,GACZA,EAAY,IAuBhB9sD,IAKAzsC,KAAK+0F,aAAeA,EAEpB/0F,KAAK65F,aAAe,SAAUngC,GAC1Br7C,EAAIq7C,EAAEr7C,EACNC,EAAIo7C,EAAEp7C,EACNwzC,EAAQ4H,EAAE5H,MACVC,EAAS2H,EAAE3H,OAEXga,GAAGgJ,IAAI31D,EAAK,CACRtE,KAAOuD,EAAIkvB,EAAS,KACpBgmB,IAAMj1C,EAAIivB,EAAS,OAGvBgrD,EAAM,GAAGl6E,EAAI,EACbk6E,EAAM,GAAGj6E,EAAI,EACbi6E,EAAM,GAAGl6E,EAAIyzC,EACbymC,EAAM,GAAGj6E,EAAI,EACbi6E,EAAM,GAAGl6E,EAAIyzC,EACbymC,EAAM,GAAGj6E,EAAIyzC,EACbwmC,EAAM,GAAGl6E,EAAI,EACbk6E,EAAM,GAAGj6E,EAAIyzC,EAEbtlB,IACAgsD,KAGJz4F,KAAK85F,SAAW,SAAU1kC,GACtB7nB,EAAQ6nB,EACR2W,GAAGgJ,IAAI31D,EAAK,CACRtE,KAAOuD,EAAIkvB,EAAS,KACpBgmB,IAAMj1C,EAAIivB,EAAS,OAEvBd,KAGJzsC,KAAK+5F,WAAa,SAAU/7E,GACpBA,GACA06E,EAAiB9iF,MAAMC,QAAU,QACjCgjF,EAAejjF,MAAMC,QAAU,UAE/B6iF,EAAiB9iF,MAAMC,QAAU,OACjCgjF,EAAejjF,MAAMC,QAAU,SAIvC7V,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAKu/D,QAAU,WACXzI,EAAYyI,UACZi5B,EAAuBj5B,UACvBk6B,EAAuBl6B,UACvBm6B,EAAuBn6B,UACvBo6B,EAAuBp6B,UACvBq6B,EAAuBr6B,UACvB45B,EAAqB55B,UACrB65B,EAAqB75B,UACrB85B,EAAqB95B,UACrB+5B,EAAqB/5B,kBCriB7By6B,GAAiB/8F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH88F,GAAiBh9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH+8F,GAAiBj9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHg9F,GAAiBl9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHi9F,GAAiBn9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHk9F,GAAiBp9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHm9F,GAAiBr9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHo9F,GAAiBt9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHq9F,GAAiBv9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHs9F,GAAiBx9F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,yBC0BtGu9F,GAAaljC,GAEzB,IAAIsmB,EAAY,CAAC,OAAQ,OAAQ,OAAQ,SACrC6c,EAAQ,CACR/iB,EAAA0iB,IACA1iB,EAAA2iB,IACA3iB,EAAA4iB,IACA5iB,EAAA6iB,KAEAG,EAAW,IACRniB,GAAK,uBACLA,GAAK,8BACLA,GAAK,sBACLA,GAAK,qBAERoiB,EAAqB,EACrBrc,GAAW,EACXsc,GAAS,EAGbh1E,YAAW,WACP,IAAK,IAAI/pB,EAAI,EAAGA,EAAI4+F,EAAM3+F,OAAQD,IAAK,EAC1B,IAAIitF,OACVlzE,IAAM6kF,EAAM5+F,MAEpB,KAEH,IAQIg/F,EAEAC,EAAQC,EACRjZ,EAXAkZ,EAAc,QACd97E,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDxjD,SAAU,WACV4pE,SAAU,OAKdhV,GAAa,EAGbpa,GAAGgU,mBACHiC,EAAkB,IAAIjW,GAAGsW,gBAAgB,CACrCj0E,OAAQgR,EACR86C,YAAa,EACbL,UAAW,SAAS70C,GAChB,GAAmB,gBAAfA,EAAMzmB,KAAwB,CAC9B,GAAIu8F,EACA,OAGJC,EAAcj1E,YAAW,WACrBs1E,MACD,KACHjV,GAAa,EACb6U,EAASh2E,EAAM4zC,MACfqiC,EAASj2E,EAAM6zC,WAEZ,GAAmB,gBAAf7zC,EAAMzmB,KACT4nF,IAAe2U,GAAU/uB,GAAG/E,KAAKg0B,EAAQC,EAAQj2E,EAAM4zC,MAAO5zC,EAAM6zC,OAAS,IAC7EI,aAAa8hC,GACbK,UAGD,GAAmB,cAAfp2E,EAAMzmB,KAAsB,CAEnC,GADA06D,aAAa8hC,GACTD,GAAU3U,EAAY,CACtB,IAAI/3E,EAAShQ,SAASi9F,iBAAiBr2E,EAAM4zC,MAAO5zC,EAAM6zC,OAC1D,IAAK,IAAI98D,EAAI,EAAGA,EAAIu/F,EAAet/F,OAAQD,IACvC,GAAIqS,IAAWktF,EAAev/F,GAAGowB,QAAS,CACtCovE,IACA/c,GAAW,EACXqc,EAAqB9+F,EACrBy/F,IACAhkC,EAAE0d,SAAS4I,EAAU+c,IACrB,OAIZ1U,GAAa,OAM7B,IAAIsV,EAAe1vB,GAAG1+D,GAAG,CACrBga,OAAQjI,EACR41D,UAAW,kEACXtG,MAAOksB,EAASC,GAChB5lB,QAAS,SAASv2E,GACd,GAAI8/E,IAAasc,EAIb,OAHAp8F,EAAEk4D,iBACFl4D,EAAEm4D,uBACFukC,IAIJ5c,GAAW,EACXhnB,EAAE0d,SAAS4I,EAAU+c,IACjBC,GACAS,KAGRxmB,IAAK,CACDmJ,QAAS,SACTsD,cAAe,OACfzvB,OAAQ,OACR2tB,UAAW,gBAIfgc,EAAiB3vB,GAAG1+D,GAAG,CACvBga,OAAQo0E,EACR1mB,IAAK,CACD0K,iBAAkB,YAClBkc,mBAAoB,SACpBnc,eAAgB,UAChB1tB,MAAO,mBACPC,OAAQ,OACRyvB,cAAe,OACf3B,QAAS,UAIb+b,EAAc7vB,GAAG1+D,GAAG,CACpBga,OAAQo0E,EACR1mB,IAAK,CACDxjD,SAAU,WACVxW,MAAO,MACP69D,OAAQ,MACR9mB,MAAO,OACPC,OAAQ,OAGRisB,OAAQ,UAERS,gBAAiB,QAAW7G,EAAAikB,IAAe,KAC3Cpc,iBAAkB,YAClBkc,mBAAoB,SACpBnc,eAAgB,OAEpB9Q,MAAO,aACPuG,QAAS,SAASv2E,GACdA,EAAEk4D,iBACFl4D,EAAEm4D,kBACFukC,OAKJjL,EAAUpkB,GAAG1+D,GAAG,CAChB0nE,IAAK,CACDxjD,SAAU,WAEVzW,KAAM,IACNy4C,IAAK,IACLx4C,MAAO,IACP69D,OAAQ,OAcZkjB,GAXyB,IAAI/vB,GAAGsW,gBAAgB,CAChDj0E,OAAQ+hF,EACRxsB,SAAU,EACV9J,UAAW,SAASn7D,GACD,gBAAXA,EAAEH,OACFG,EAAEw9D,sBACFq/B,QAKUxvB,GAAG1+D,GAAG,CACxB2nE,UAAW,wBACXD,IAAK,CACDxjD,SAAU,WACVugC,MAAO,OACPC,OAAS,KAAO+rB,EAAU9hF,OAAS,GAAM,IACzCu3D,IAAK,OACLz4C,KAAM,IACNw+D,OAAQ,IACRoG,UAAW,aACX1B,OAAQ,UACRyI,WAAY,oDACZsV,uBAAwB,MACxBC,wBAAyB,MACzBnjB,SAAU,aAIdyiB,EAAiB,YAEZW,EAAqBviC,GAC1B,IAAI7xD,EAAS,GAETskB,EAAU4/C,GAAG1+D,GAAG,CAChBga,OAAQy0E,EACR9mB,UAAW,uBACXtG,MAAOhV,EAAEgV,MACTqG,IAAK,CACDmJ,QAAS,SACTnsB,OAAS,KAAO+rB,EAAU9hF,OAAS,GAAM,IACzC0jF,UAAW,cAEfzK,QAAS,SAASv2E,GACdA,EAAEk4D,iBACFl4D,EAAEm4D,kBACF6C,EAAEub,QAAQvb,EAAE9sD,MAAO8sD,EAAEz9D,OAG5B4L,EAAeskB,QAAUA,EACjB4/C,GAAG1+D,GAAG,CACXga,OAAQ8E,EACR4oD,IAAK,CACD0J,gBAAiB,QAAW/kB,EAAEglB,MAAQ,KACtCe,iBAAkB,YAClBkc,mBAAoB,SACpBnc,eAAgB,UAChBztB,OAAQ,OACRyvB,cAAe,OACf3B,QAAS,UAajB,OARCh4E,EAAeq0F,KAAO,SAASl+E,GAC5BmO,EAAQvW,MAAMC,QAAUmI,EAAI,QAAU,QAGzCnW,EAAes0F,WAAa,SAASn+E,GAClCmO,EAAQvW,MAAMsoE,QAAUlgE,EAAIk9E,EAAc,UAGvCrzF,WAGFu0F,EAAmBxvF,EAAO3Q,GAC/Bs/F,IAEA/c,GAAW,EACXqc,EAAqBjuF,EAErB4uF,IAEAhkC,EAAE0d,SAAS4I,EAAU+c,IAGzB,IAAK,IAAI5kC,EAAI,EAAGA,EAAI6nB,EAAU9hF,OAAQi6D,IAClCqlC,EAAel1F,KAAK61F,EAAqB,CACrCrvF,MAAOqpD,EACPh6D,GAAI6hF,EAAU7nB,GACdyoB,MAAOic,EAAM1kC,GACbyY,MAAOksB,EAAS3kC,GAChBgf,QAASmnB,cAIRhB,IACL9jB,GAAcC,SAAS,IACvBujB,GAAS,EAET,IAAK,IAAI/+F,EAAI,EAAGA,EAAI+hF,EAAU9hF,OAAQD,IAClCu/F,EAAev/F,GAAGmgG,KAAKrB,IAAuB9+F,GAGlD6/F,EAAYhmF,MAAMC,QAAU,OAC5BuJ,EAAIxJ,MAAM0jE,OAAS,IACnBl7E,SAAS0oD,KAAKloD,YAAYuxF,GAC1B/wE,EAAIxgB,YAAYk9F,YAGXP,IACLjkB,GAAcE,SAAS,IACvBsjB,GAAS,EACTc,EAAYhmF,MAAM00E,eAAe,WACjClrE,EAAIxJ,MAAM00E,eAAe,WACzBlsF,SAAS0oD,KAAKjhC,YAAYsqE,GAE1B/wE,EAAIyG,YAAYi2E,YAGXN,IACLC,EAAa/sB,MAAQksB,EAASC,GAC9Ba,EAAe9lF,MAAM6oE,gBAAkB,QAAWkc,EAAME,GAAsB,KAElFW,IAKAx7F,KAAKm8F,WAAa,SAASn+E,GACvBy9E,EAAa7lF,MAAMsoE,QAAUlgE,EAAIk9E,EAAc,SAC/C,IAAK,IAAIn/F,EAAI,EAAGA,EAAI+hF,EAAU9hF,OAAQD,IAClCu/F,EAAev/F,GAAGogG,WAAWn+E,GAE7BA,GACA49E,EAAYhmF,MAAMk8C,MAAQ,OAC1B8pC,EAAYhmF,MAAMm8C,OAAS,SAE3B6pC,EAAYhmF,MAAMk8C,MAAQ,OAC1B8pC,EAAYhmF,MAAMm8C,OAAS,SAInC/xD,KAAK2mF,UAAY,SAAS0V,GACtB,GAAIve,EAAUvwE,SAAS8uF,GAAY,CAC/B7d,GAAW,EACX,IAAK,IAAIziF,EAAI,EAAGA,EAAI+hF,EAAU9hF,OAAQD,IAClC,GAAI+hF,EAAU/hF,KAAOsgG,EAAW,CAC5BxB,EAAqB9+F,EACrB,MAGRgwE,GAAGkO,aAAawhB,EAAc,kCAC9BD,SAEAhd,GAAW,EACXzS,GAAGyR,gBAAgBie,EAAc,mCAIzCz7F,KAAKs8F,UAAY,WACb,OAAOxe,EAAU+c,IAGrB76F,KAAKk9E,WAAa,WACd,OAAO99D,GC7Vfy8E,GAAiB5+F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHo/F,GAAiBt/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHq/F,GAAiBv/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHs/F,GAAiBx/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHu/F,GAAiBz/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHw/F,GAAiB1/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHy/F,GAAiB3/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH0/F,GAAiB5/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH2/F,GAAiB7/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH4/F,GAAiB9/F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH6/F,GAAiB//F,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH8/F,GAAiBhgG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH+/F,GAAiBjgG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,mBCMtH,IAAIggG,GACAC,YAEKC,KACL,GAAIF,GACA,OAGJA,GAAY,CACR,cAAe,SAEfpN,OAAU,SACVC,SAAY,WACZ,aAAc,aAEdC,QAAW,UACXC,OAAU,SACV,cAAe,cAEfC,QAAW,UACX,aAAc,aACd,aAAc,aAEd53C,WAAc,aACd63C,UAAa,YAEbC,IAAO,MACPC,WAAc,aACdvN,MAAS,QACTwN,WAAc,cAGlB6M,GAAY,GACZ,IAAIvhG,EAAOC,OAAOD,KAAKshG,IACvB,IAAK,IAAIphG,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC7BqhG,GAAUD,GAAUthG,EAAKE,KAAOF,EAAKE,YAI7BuhG,GAAa5tE,GAEzB,OADA2tE,KACOD,GAAU1tE,YAGL6tE,GAAa7tE,GAEzB,OADA2tE,KACOF,GAAUztE,YAQL8tE,GAAQC,GACpB,IAAIl3B,EAAiB,CACjBhoE,KAAM,MACNs0D,OAAQ4qC,EAAO5qC,OACff,MAAO2rC,EAAO3rC,MACdC,OAAQ0rC,EAAO1rC,iBAGV2rC,EAAWC,GACXp3B,EAAOq3B,aACRr3B,EAAOq3B,WAAa,IAEpBr3B,EAAOq3B,WAAWrwF,SAASowF,IAG/Bp3B,EAAOq3B,WAAWx3F,KAAKu3F,YAGlBE,EAAchO,GACnB,IAAIJ,EAAuB6N,GAAazN,GAKxC,OAJKJ,IACDiO,EAAW,cACXjO,EAAa,eAEVA,EAOX,GAJ8B,IAA1BgO,EAAOK,gBACPJ,EAAW,qBAGVD,EAAOxO,SAER,OADA1oB,EAAOlmE,OAAQ,EACRkmE,EAIX,IACIw3B,EAAa,EAyBjB,GADAA,YAvBSC,EAAiBC,GACtB,IAAIp2F,EAAS,EACb,GAAIo2F,EAASpO,UAAW,CACpB,IAAIJ,EAAa6N,GAAaW,EAASpO,WACvC,GAAIJ,GAA6B,gBAAfA,EACd,OAAO,EAGf,IAAK,IAAI1zF,EAAI,EAAGA,EAAIkiG,EAAShP,SAASjzF,OAAQD,IAAK,CAC/C,IAAI4sB,EAAOs1E,EAAShP,SAASlzF,GACzB4sB,EAAKu1E,UAAYv1E,EAAKw1E,aAItBx1E,EAAKsmE,UACLyO,EAAW,SACX71F,GAAUm2F,EAAiBr1E,IAE3B9gB,KAGR,OAAOA,EAEGm2F,CAAiBP,GAC3BM,ErC9FkB,GqCgGlB,OADAx3B,EAAOlmE,OAAQ,EACRkmE,WAKF63B,EAAYC,EAAYC,GAC7B,MAAMC,EAAeF,EAAWvrC,WAAW,MAC3C,IAAI0rC,EAASD,EAAajqB,aAAa,EAAG,EAAG+pB,EAAWvsC,MAAOusC,EAAWtsC,QAC1E,GAAqB,IAAjBusC,EACA,IAAK,IAAIviG,EAAI,EAAGA,EAAIyiG,EAAOvvF,KAAKjT,OAAQD,GAAK,EACzCyiG,EAAOvvF,KAAKlT,EAAI,GAAKyiG,EAAOvvF,KAAKlT,QAGrC,IAAK,IAAIk6D,EAAI,EAAGA,EAAIuoC,EAAOvvF,KAAKjT,OAAQi6D,GAAK,EACzCuoC,EAAOvvF,KAAKgnD,EAAI,GAAK,IAAMuoC,EAAOvvF,KAAKgnD,GAG/CsoC,EAAahqB,aAAaiqB,EAAQ,EAAG,GAqLzC,OAnMAj4B,EAAOipB,OAAS,GA4LhBjpB,EAAOipB,gBA3KEiP,EAAaC,GAOlB,IAQIC,EACAC,EATAttB,EAKE,GACFutB,EAAeH,EAAYI,OAAS,EAAIJ,EAAY7e,QACpDkf,EAAkBlB,EAAca,EAAY7O,WAGxB,gBAApBkP,IACAJ,EAAchtC,GAAa4U,EAAOzU,MAAOyU,EAAOxU,QAChD6sC,EAAWD,EAAY7rC,WAAW,OAKlC4rC,EAAYM,OACZtB,EAAW,QACXU,EAAYM,EAAYM,KAAKnsC,OAAQ6rC,EAAYM,KAAKV,eAI1D,IAAK,IAAIviG,EAAI,EAAGA,EAAI2iG,EAAYzP,SAASjzF,OAAQD,IAAK,CAClD,IAAI4sB,EAAO+1E,EAAYzP,SAASlzF,GAChC,GAAI4sB,EAAKu1E,SACL,SAEJ,GAAIv1E,EAAKw1E,WAAY,CACjBT,EAAW,cACX,SAGJ,IAAIuB,GAAet2E,EAAKsmE,UAAYtmE,EAAKkqC,SAAW6rC,EAAYzP,SAASlzF,EAAI,IAAM2iG,EAAYzP,SAASlzF,EAAI,GAAGmiG,SAK/G,GAJIe,GACAvB,EAAW,YAGX/0E,EAAKsmE,SAAU,CACf,IAAIiQ,EAAWT,EAAa91E,GAE5B,IAAK,IAAIjqB,EAAI,EAAGA,EAAIwgG,EAASljG,OAAQ0C,IAAK,CACtC,IAAIygG,EAAYD,EAASxgG,GACrB0gG,EAAWD,EAAUzgB,MAAM5rB,WAAW,MAG1C,GAAImsC,EAAa,CACb,IAAII,EAAiB1tC,GAAa4U,EAAOzU,MAAOyU,EAAOxU,QACnDutC,EAAcD,EAAevsC,WAAW,MAC5CwsC,EAAY9tB,UAAU2tB,EAAUzgB,MAAO,EAAG,GAE1C,IAAK,IAAI9rD,EAAI72B,EAAI,EAAG62B,EAAI8rE,EAAYzP,SAASjzF,QAAU0iG,EAAYzP,SAASr8D,GAAGsrE,SAAUtrE,IAAK,CAC1F,IAAI2sE,EAAeb,EAAYzP,SAASr8D,GACX,IAAzB2sE,EAAa1f,SAAiB0f,EAAaT,SAG/CQ,EAAYzrB,yBAA2BgqB,EAAc0B,EAAa1P,WAClEyP,EAAYlT,YAAcmT,EAAa1f,QACvCyf,EAAY9tB,UAAU+tB,EAAa1sC,OAAQ0sC,EAAazkF,KAAMykF,EAAahsC,MAG/E6rC,EAASvrB,yBAA2B,cACpCurB,EAAS5tB,UAAU6tB,EAAgB,EAAG,GAMtCX,EAAYM,OACZI,EAASvrB,yBAA6D,IAAlC6qB,EAAYM,KAAKV,aAAqB,iBAAmB,kBAC7Fc,EAAS5tB,UAAUktB,EAAYM,KAAKnsC,OAAQ6rC,EAAYM,KAAKlkF,KAAM4jF,EAAYM,KAAKzrC,MAGpForC,GACAC,EAAS/qB,yBAA2BsrB,EAAU1P,WAC9CmP,EAASxS,YAAc+S,EAAUtf,QACjC+e,EAASptB,UAAU2tB,EAAUzgB,MAAO,EAAG,KAGvCygB,EAAUtf,QAAUsf,EAAUtf,QAAUgf,EACxCvtB,EAAUlrE,KAAK+4F,IAIvB,SAGJ,IAAItsC,EAASlB,GAAa4U,EAAOzU,MAAOyU,EAAOxU,QAC3CsT,EAAMxS,EAAOC,WAAW,MAoB5B,GAnBInqC,EAAKkqC,QACLwS,EAAImM,UAAU7oD,EAAKkqC,OAAQlqC,EAAK7N,KAAM6N,EAAK4qC,KAI3C5qC,EAAK62E,SACL9B,EAAW,gBAIX/0E,EAAKq2E,OACLtB,EAAW,QACXU,EAAYz1E,EAAKq2E,KAAKnsC,OAAQlqC,EAAKq2E,KAAKV,cAExCj5B,EAAIwO,yBAAsD,IAA3BlrD,EAAKq2E,KAAKV,aAAqB,iBAAmB,kBACjFj5B,EAAImM,UAAU7oD,EAAKq2E,KAAKnsC,OAAQlqC,EAAKq2E,KAAKlkF,KAAM6N,EAAKq2E,KAAKzrC,MAI1D0rC,EAAa,CACb,IAAII,EAAiB1tC,GAAahpC,EAAK5N,MAAQ4N,EAAK7N,KAAM6N,EAAKiwD,OAASjwD,EAAK4qC,KACzE+rC,EAAcD,EAAevsC,WAAW,MAC5CwsC,EAAY9tB,UAAU7oD,EAAKkqC,OAAQ,EAAG,GAEtC,IAAK,IAAIn0D,EAAI3C,EAAI,EAAG2C,EAAIggG,EAAYzP,SAASjzF,QAAU0iG,EAAYzP,SAASvwF,GAAGw/F,SAAUx/F,IAAK,CAC1F,IAAI6gG,EAAeb,EAAYzP,SAASvwF,GACX,IAAzB6gG,EAAa1f,SAAiB0f,EAAaT,SAG/CQ,EAAYzrB,yBAA2BgqB,EAAc0B,EAAa1P,WAClEyP,EAAYlT,YAAcmT,EAAa1f,QACvCyf,EAAY9tB,UAAU+tB,EAAa1sC,OAAQ0sC,EAAazkF,KAAO6N,EAAK7N,KAAMykF,EAAahsC,IAAM5qC,EAAK4qC,MAGtG8R,EAAIwO,yBAA2B,cAC/BxO,EAAImM,UAAU6tB,EAAgB12E,EAAK7N,KAAM6N,EAAK4qC,KAI9CmrC,EAAYM,OACZ35B,EAAIwO,yBAA6D,IAAlC6qB,EAAYM,KAAKV,aAAqB,iBAAmB,kBACxFj5B,EAAImM,UAAUktB,EAAYM,KAAKnsC,OAAQ6rC,EAAYM,KAAKlkF,KAAM4jF,EAAYM,KAAKzrC,MAG/EorC,EACIE,EAAe,IACfD,EAAS/qB,yBAA2BgqB,EAAcl1E,EAAKknE,WACvD+O,EAASxS,YAAczjE,EAAKm2E,OAAS,EAAIn2E,EAAKk3D,QAC9C+e,EAASptB,UAAU3e,EAAQ,EAAG,IAIlCye,EAAUlrE,KAAK,CACXoB,KAAMmhB,EAAKnhB,KACXq4E,SAAUl3D,EAAKm2E,OAAS,EAAIn2E,EAAKk3D,SAAWgf,EAC5CpP,WAAYoO,EAAcl1E,EAAKknE,WAC/BnR,MAAO7rB,IAgBnB,OAXI8rC,IACArtB,EAAY,CACR,CACI9pE,KAAMk3F,EAAYl3F,KAClBq4E,QAASgf,EACTpP,WAAYsP,EACZrgB,MAAOigB,KAKZrtB,EAGKmtB,CAAa,CACzBj3F,KAAM,OACNq4E,QAAS,EACTgQ,UAAW,SACXZ,SAAUwO,EAAOxO,WAGd1oB,WAGKk5B,GAAiBC,GAE7B,MAAM73F,EAAqB,CACvBiqD,MAAO4tC,EAAM5tC,MACbC,OAAQ2tC,EAAM3tC,OACdy9B,OAAQ,IAoBZ,OAlBIkQ,EAAMlQ,OACN3nF,EAAO2nF,OAAS3nF,EAAO2nF,OAAO9xF,OAAOgiG,EAAMlQ,OAAOlvD,KAAI3X,IAC3C,CACHnhB,KAAMmhB,EAAKnhB,KACXq4E,QAASl3D,EAAKk3D,QACd4P,WAAY9mE,EAAK8mE,WACjB/Q,MAAO/1D,EAAK+1D,WAKpB72E,EAAO2nF,OAAOppF,KAAK,CACfoB,KAAMixE,GAAK,cACXoH,QAAS,EACT4P,WAAY,cACZ/Q,MAAOghB,EAAM7sC,SAGdhrD,iXC1VX,MAAM83F,KAAyB7/F,OAAO8/F,UACtC,IAAIC,GAAY,kBAGAC,GAAUt4F,GACtBq4F,GAAY,GAAKr4F,EAUlB,SACMu4F,GAAyBC,EAAgBC,EAAiBC,GAE/D,IAwBIC,EAxBAC,GAAc,WAUTC,EAAQC,GACTF,IAGJA,GAAc,EACdF,EAAcI,IAGlB,GAAKX,GAAL,CAQA,IACIQ,EAAargG,OAAO8/F,UAAU5pF,KAAK6pF,GAAW,GAChD,MAAOnhG,GAEL,YADA2hG,EAAQ3hG,EAAE8lC,SAId27D,EAAWI,gBAAkB,SAAU7hG,GACnC,IACayhG,EAAWt4F,OACL24F,kBApDJ,eAoDsC,CAACC,QAAS,OACrDC,YAAY,KAAM,KAAM,CAACC,QAAQ,IACzC,MAAO3vC,GACLqvC,EAAQrvC,EAAExsB,WAGlB27D,EAAWjiG,QAAU,SAAUQ,GAC3B2hG,EAAQ,0BAA4BF,EAAW9/F,QAEnD8/F,EAAWS,UAAY,SAAUliG,GAC7B,IAAImiG,EACAC,EACAC,EAEJ,IAEI,GADAF,EAAcV,EAAWt4F,QACpBg5F,EAAYG,iBAAiBC,SApEvB,gBAyEP,OAFAnhG,OAAO8/F,UAAUsB,eAAerB,SAChCQ,EAAQ,oDAGZS,EAAiBD,EAAYM,YA3ElB,eA2E8C,aACzDJ,EAAWD,EAAeM,YA5Ef,gBA6EXL,EAASn0F,MAAM,MACjB,MAAOy0F,GAEL,YADAhB,EAAQgB,EAAE78D,SAIdq8D,EAAY3iG,QAAU,SAAUQ,GAC5B2hG,EAAQ,mBAAqBQ,EAAYxgG,QAG7C,IACI2/F,EAAee,GACjB,MAAOO,GAEL,YADAjB,EAAQiB,EAAE98D,SAIds8D,EAAeS,WAAa,WA3ExBnB,IAGJA,GAAc,EACdH,KAyEIY,EAAYzrF,SAEhB0rF,EAAe5iG,QAAU,WACrBmiG,EAAQ,sBAAwBS,EAAezgG,cAhEnDylB,YAAW,WACPu6E,EAAQ,6BACT,YAkFKmB,GAAgBvB,EAAiBC,GAC7C,GAAIP,GAAsB,CACtB,IAAI35C,EACJ+5C,IAAyB,SAAUgB,GAC/B/6C,EAAQ+6C,EAASxgG,IAAI,MACtB,WACC0/F,EAAgBj6C,EAAMn+C,WACvB,SAAUy4F,GACTJ,EAAc,mCAAqCI,WAGvDL,EAAgB,eAsBRwB,GAAkBC,EAAmCzB,EAAiBC,GAClFH,IAAyB,SAAUgB,GAC/BA,EAASY,IAAID,MACd,WACCzB,OACD,SAAUK,GACTJ,EAAcI,eAWNsB,GAAM3B,EAAiBC,GACnCH,IAAyB,SAAUgB,GAC/BA,EAASj5D,OAAO,MACjB,WACCm4D,OACD,SAAU5/F,GACT6/F,EAAc7/F,aCtLtBwhG,GAAiB5kG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH2kG,GAAiB7kG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH4kG,GAAiB9kG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH6kG,GAAiB/kG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH8kG,GAAiBhlG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtH+kG,GAAiBjlG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHglG,GAAiBllG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHilG,GAAiBnlG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHklG,GAAiBplG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHmlG,GAAiBrlG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHolG,GAAiBtlG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHqlG,GAAiBvlG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHslG,GAAiBxlG,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCkC/G,MAAMulG,GAAkB,CAC3BC,UAAU,GAEDC,GAET,CACAC,qBAAsB,CAClB1qB,KAAM,CAAC3wE,KAAM,+BAAgCw0D,OAAQ,0BACrDx0D,KAAM,GACNs7F,YAAa,GACbC,OAAO,EACPC,eAAe,EACfC,KAAMrrB,EAAAiqB,IACN7lB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbC,WAAY,CACRjrB,KAAM,CAAC3wE,KAAM,oBAAqBw0D,OAAQ,sBAC1Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAkqB,IACNiB,OAAO,EACPM,iBAAiB,EACjBL,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbG,SAAU,CACNnrB,KAAM,CAAC3wE,KAAM,sBAAuBw0D,OAAQ,iBAC5Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAmqB,IACNgB,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbtP,KAAM,CACF1b,KAAM,CAAC3wE,KAAM,oBAAqBw0D,OAAQ,eAC1Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAoqB,IACNe,OAAO,EACPM,iBAAiB,EACjBL,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbI,gBAAiB,CACbprB,KAAM,CAAC3wE,KAAM,uBAAwBw0D,OAAQ,kBAC7Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAqqB,IACNc,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbK,OAAQ,CACJrrB,KAAM,CAAC3wE,KAAM,gBAAiBw0D,OAAQ,iBACtCx0D,KAAM,GACNy7F,KAAMrrB,EAAAsqB,IACNa,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXynB,WAAW,EACXP,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbO,cAAe,CACXvrB,KAAM,CAAC3wE,KAAM,2BAA4Bw0D,OAAQ,sBACjDx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAuqB,IACNY,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbQ,OAAQ,CACJxrB,KAAM,CAAC3wE,KAAM,sBAAuBw0D,OAAQ,iBAC5Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAwqB,IACNW,OAAO,EACPM,iBAAiB,EACjBL,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEb9wB,OAAQ,CACJ8F,KAAM,CAAC3wE,KAAM,sBAAuBw0D,OAAQ,iBAC5Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAglB,IACNmG,OAAO,EACPM,iBAAiB,EACjBL,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbS,YAAa,CACTzrB,KAAM,CAAC3wE,KAAM,0BAA2Bw0D,OAAQ,qBAChDx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAAyqB,IACNU,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbU,QAAS,CACL1rB,KAAM,CAAC3wE,KAAM,wBAAyBw0D,OAAQ,mBAC9Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAA0qB,IACNS,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEb1xB,UAAW,CACP0G,KAAM,CAAC3wE,KAAM,yBAA0Bw0D,OAAQ,oBAC/Cx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAA2qB,IACNQ,OAAO,EACPM,iBAAiB,EACjBL,eAAe,EACfhnB,WAAW,EACX8nB,SAAS,EACTZ,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEbY,OAAQ,CACJ5rB,KAAM,CAAC3wE,KAAM,6BAA8Bw0D,OAAQ,wBACnDx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAA4qB,IACNO,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,GAEba,cAAe,CACX7rB,KAAM,CAAC3wE,KAAM,4BAA6Bw0D,OAAQ,uBAClDx0D,KAAM,GACNs7F,YAAa,GACbG,KAAMrrB,EAAA6qB,IACNM,OAAO,EACPC,eAAe,EACfhnB,WAAW,EACXknB,UAAW,KACX/jG,MAAO,KACPgkG,SAAS,aAIRc,KACQnoG,OAAOD,KAAK+mG,IACpBviE,SAAQ1X,IACTi6E,GAAUj6E,GAAMnhB,KAAOixE,GAAKmqB,GAAUj6E,GAAMwvD,KAAK3wE,MACjDo7F,GAAUj6E,GAAMm6E,YAAcrqB,GAAKmqB,GAAUj6E,GAAMwvD,KAAKnc,WAGhEioC,KAEA7rB,GAAgBvkC,WAAS,KACrBowD,QClNJ,MAAMC,GAAW,YAGRC,GAAK9lF,EAAGC,EAAG+2C,GAChBr1D,KAAKqe,EAAIA,EAAGre,KAAKse,EAAIA,EAAGte,KAAKq1D,EAAIA,EAGrC8uC,GAAKrjG,UAAUsjG,KAAO,SAAS/lF,EAAGC,GAC9B,OAAOte,KAAKqe,EAAEA,EAAIre,KAAKse,EAAEA,GAO7B,IAAI+lF,GAAQ,CAAC,IAAIF,GAAK,EAAE,EAAE,GAAG,IAAIA,IAAK,EAAG,EAAE,GAAG,IAAIA,GAAK,GAAE,EAAG,GAAG,IAAIA,IAAK,GAAG,EAAG,GAC1E,IAAIA,GAAK,EAAE,EAAE,GAAG,IAAIA,IAAK,EAAG,EAAE,GAAG,IAAIA,GAAK,EAAE,GAAE,GAAI,IAAIA,IAAK,EAAG,GAAE,GAChE,IAAIA,GAAK,EAAE,EAAE,GAAG,IAAIA,GAAK,GAAE,EAAG,GAAG,IAAIA,GAAK,EAAE,GAAE,GAAI,IAAIA,GAAK,GAAE,GAAG,IAEhEG,GAAI,CAAC,IAAI,IAAI,IAAI,GAAG,GAAG,GACvB,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,EAAE,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,GACzE,IAAK,EAAE,IAAI,IAAI,IAAI,IAAI,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,GACzE,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,IAAK,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,GAAG,IACxE,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IACxE,IAAI,IAAI,GAAI,GAAG,GAAG,GAAG,IAAK,EAAE,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAK,GAAG,GAAG,IAAI,IAAI,IACxE,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAK,EAAE,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IACxE,EAAE,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,GACzE,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAK,EAAE,GAAG,IAAI,IAAK,GAAG,IAAI,IAAI,IAAI,IAAI,IAAK,GAAG,IAAI,EAC1E,IAAI,GAAG,GAAG,IAAK,GAAG,GAAG,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAK,IAAI,IAAI,IAAI,IAAI,GAAG,IACxE,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAK,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IACxE,GAAG,IAAI,IAAK,GAAG,IAAI,IAAI,IAAI,IAAI,IAAK,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAK,EAAE,IAAI,IACxE,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,KAEpEC,GAAO,IAAI3yF,MAAM,KACjB4yF,GAAQ,IAAI5yF,MAAM,KAItBsyF,GAAS1zD,KAAO,SAASA,GACjBA,EAAO,GAAKA,EAAO,IAEnBA,GAAQ,QAGZA,EAAO7yC,KAAKyO,MAAMokC,IACP,MACPA,GAAQA,GAAQ,GAGpB,IAAK,IAAIz0C,EAAI,EAAGA,EAAI,IAAKA,IAAK,CAC1B,IAAIgiB,EAEAA,EADI,EAAJhiB,EACIuoG,GAAEvoG,GAAa,IAAPy0C,EAER8zD,GAAEvoG,GAAOy0C,GAAM,EAAK,IAG5B+zD,GAAKxoG,GAAKwoG,GAAKxoG,EAAI,KAAOgiB,EAC1BymF,GAAMzoG,GAAKyoG,GAAMzoG,EAAI,KAAOsoG,GAAMtmF,EAAI,MAI9CmmF,GAAS1zD,KAAK,GASd,IAAIi0D,GAAK,IAAK9mG,KAAKkhB,KAAK,GAAG,GACvB6lF,IAAM,EAAE/mG,KAAKkhB,KAAK,IAAI,EAM1BqlF,GAASS,SAAW,SAASC,EAAKC,GAC9B,IAAIC,EAAIC,EAAIC,EAUR/uC,EAAIgvC,EARJ7vC,GAAKwvC,EAAIC,GAAKJ,GACd1oG,EAAI4B,KAAKyO,MAAMw4F,EAAIxvC,GACnB34C,EAAI9e,KAAKyO,MAAMy4F,EAAIzvC,GACnBvlB,GAAK9zC,EAAE0gB,GAAGioF,GACV51D,EAAK81D,EAAI7oG,EAAE8zC,EACXb,EAAK61D,EAAIpoF,EAAEozB,EAIXf,EAAGE,GACHinB,EAAG,EAAGgvC,EAAG,IAEThvC,EAAG,EAAGgvC,EAAG,GAKb,IAAIl2D,EAAKD,EAAKmnB,EAAKyuC,GACfz1D,EAAKD,EAAKi2D,EAAKP,GACfj1B,EAAK3gC,EAAK,EAAI,EAAI41D,GAClB18B,EAAKh5B,EAAK,EAAI,EAAI01D,GAEtB3oG,GAAK,IACL0gB,GAAK,IACL,IAAIyoF,EAAMV,GAAMzoG,EAAEwoG,GAAK9nF,IACnB0oF,EAAMX,GAAMzoG,EAAEk6D,EAAGsuC,GAAK9nF,EAAEwoF,IACxBG,EAAMZ,GAAMzoG,EAAE,EAAEwoG,GAAK9nF,EAAE,IAEvB4oF,EAAK,GAAMv2D,EAAGA,EAAGE,EAAGA,EACpBq2D,EAAG,EACHP,EAAK,GAELO,GAAMA,EACNP,EAAKO,EAAKA,EAAKH,EAAId,KAAKt1D,EAAIE,IAEhC,IAAI+hB,EAAK,GAAMhiB,EAAGA,EAAGE,EAAGA,EACpB8hB,EAAG,EACHg0C,EAAK,GAELh0C,GAAMA,EACNg0C,EAAKh0C,EAAKA,EAAKo0C,EAAIf,KAAKr1D,EAAIE,IAEhC,IAAIq2D,EAAK,GAAM71B,EAAGA,EAAGzH,EAAGA,EASxB,OARIs9B,EAAG,EACHN,EAAK,GAELM,GAAMA,EACNN,EAAKM,EAAKA,EAAKF,EAAIhB,KAAK30B,EAAIzH,IAIzB,IAAM88B,EAAKC,EAAKC,IAiKpB,MAAMO,GAAQrB,YChTLsB,GAAgB5zC,GAE5B,MAAM6zC,EAAW7zC,EAAI,IACfC,EAAID,EACJiB,EAASkZ,GAAGlZ,OAAOjB,EAAGC,GACtBwT,EAAMxS,EAAOC,WAAW,MACxB0rC,EAASn5B,EAAIqgC,gBAAgB9zC,EAAGC,GACtC,IAAK,IAAIxzC,EAAI,EAAGA,EAAIuzC,EAAGvzC,IACnB,IAAK,IAAIC,EAAI,EAAGA,EAAIuzC,EAAGvzC,IAAK,CACxB,IAAIviB,EAAkB,GAAbuiB,EAAIszC,EAAIvzC,GAGjB,MAAMsnF,EAAQF,EAAkE,IAAvDF,GAAMZ,SAAStmF,EAAI,GAAKonF,EAAUnnF,EAAI,GAAKmnF,GACpE,IAAIG,EAAe,KAAOL,GAAMZ,SAAStmF,EAAI,GAAKsnF,EAAOrnF,EAAI,GAAKqnF,GAAS,GAAK,EAAI,IACpFC,IAAiBL,GAAMZ,SAAStmF,EAAI,GAAKonF,EAAUnnF,EAAI,GAAKmnF,GAAY,GAAK,EAAI,IAGjF,MAAMI,EAAa95B,GAAG/E,KAAKpV,EAAI,EAAGC,EAAI,EAAGxzC,EAAGC,GAK5CsnF,GAJc75B,GAAGj/B,MACb,IAAM+4D,EAAcj0C,EAAI,MAASA,EAAI,IAAM2zC,GAAMZ,SAAStmF,EAAI,GAAKsnF,EAAOrnF,EAAI,GAAKqnF,IACnF,EACA,GAKJC,GADsD,EAArC75B,GAAGj/B,MAAM,EAAI+4D,EAAaj0C,EAAG,EAAG,GAGjD4sC,EAAOvvF,KAAKlT,GAAK,EACjByiG,EAAOvvF,KAAKlT,EAAI,GAAK,EACrByiG,EAAOvvF,KAAKlT,EAAI,GAAK,EACrByiG,EAAOvvF,KAAKlT,EAAI,GAAKgwE,GAAGj/B,MAAM84D,EAAc,EAAG,KAKvD,OADAvgC,EAAIkP,aAAaiqB,EAAQ,EAAG,GACrB3rC,WAIFizC,GAAWpsC,EAActxD,EAAc4V,GAC5C,IAAI+nF,EAAKh6B,GAAGi6B,KAAKl/B,IAAI9oD,EAAG5V,GACpB69F,EAAKl6B,GAAGi6B,KAAKl/B,IAAIpN,EAAGtxD,GACpBypD,EAAIka,GAAGj/B,MAAOi/B,GAAGi6B,KAAK9+B,IAAI++B,EAAGF,GAAMh6B,GAAGi6B,KAAK9+B,IAAI6+B,EAAGA,GAAK,EAAK,GAChE,OAAOh6B,GAAGi6B,KAAKnhE,IAAIknC,GAAGi6B,KAAKl/B,IAAIm/B,EAAIl6B,GAAGi6B,KAAK/+B,IAAI8+B,EAAIl0C,cAIvCq0C,GAAgBt0C,GAE5B,MAAMu0C,EAAQ,IACd,IAAIC,EAAa,EAAI,EACjBC,EAAiB,EAAI,EACzBD,GAAcD,EACdE,GAAkBF,EAClB,MAAM3uC,EAAK,CAACn5C,EAAG8nF,EAAQv0C,EAAGtzC,EAAGszC,EAAKA,EAAIu0C,GAChC1uC,EAAK,CAACp5C,EAAGuzC,EAAKA,EAAIu0C,EAAQ7nF,EAAG6nF,EAAQv0C,GAErCC,EAAID,EACJiB,EAASkZ,GAAGlZ,OAAOjB,EAAGC,GAC5B,IAAIwT,EAAMxS,EAAOC,WAAW,MAC5B,MAAM0rC,EAASn5B,EAAIqgC,gBAAgB9zC,EAAGC,GACtC,IAAK,IAAIxzC,EAAI,EAAGA,EAAIuzC,EAAGvzC,IACnB,IAAK,IAAIC,EAAI,EAAGA,EAAIuzC,EAAGvzC,IAAK,CACxB,MAAMviB,EAAkB,GAAbuiB,EAAIszC,EAAIvzC,GAEnB,IAAIymE,EAAMghB,GAAU,CAACznF,EAAGA,EAAGC,EAAGA,GAAIk5C,EAAIC,GAEtCqtB,EAAM/Y,GAAGj/B,MACL,KAAQg4C,EAhBpBshB,mBAgB2Bx0C,IAf3By0C,mBAe+Cz0C,GAAsB,IACzD,EACA,KAGJ4sC,EAAOvvF,KAAKlT,GAAK,EACjByiG,EAAOvvF,KAAKlT,EAAI,GAAK,EACrByiG,EAAOvvF,KAAKlT,EAAI,GAAK,EACrByiG,EAAOvvF,KAAKlT,EAAI,GAAK+oF,EAK7B,OADAzf,EAAIkP,aAAaiqB,EAAQ,EAAG,GACrB3rC,ECrFJ,MAAMyzC,GAAa,GAC1BA,GAAW,GAAKd,GAAgB,KAChCc,GAAW,GAAKJ,GAAgB,cCkBvBK,GAAM1uC,EAAKnrD,EAAKF,GACrB,OAAOqrD,GAAOnrD,EACRA,EACAmrD,GAAOrrD,EACHA,EACAqrD,ECvBd,MAAM2uC,GAAez6B,GAAGlZ,OAAO,GAAI,IAC7B4zC,GAAYD,GAAa1zC,WAAW,MCuIvC,SACM4zC,GAAOC,EAAsBjtC,GAIlC,MAAMktC,GAFNltC,EAAIqS,GAAG86B,QAAQntC,IAECotC,MAAMt1E,KAChBu1E,EAAKrtC,EAAEotC,MAAM33B,OAAO9wD,EACpB2oF,EAAKttC,EAAEotC,MAAM33B,OAAO7wD,EAU1B,IAAI2oF,EAASvtC,EAAEwtC,GAAG5oF,EAAIqoF,EAAU70C,MAAQ4H,EAAEwtC,GAAG7oF,EAE7C,MAAMuf,EAA6B,GADtB87B,EAAEytC,GAAG7oF,EAAIqoF,EAAU70C,MAAQ4H,EAAEytC,GAAG9oF,EACpB4oF,GAGzB,IAAIG,EAAQ,EACZ,MAAMC,EAAUT,EAAQ,GAAK,KAAO,IAC9BU,EAAU,GAChB,IAAK,IAAIvrG,EAAI,EAAGA,EAAIsrG,EAAStrG,IACzBurG,EAAQvrG,IAAM4B,KAAKC,SAAW,IAAO,MAAQ,GAGjD,MAAM2pG,EAAa5pG,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGgtD,EAAEotC,MAAMt1E,KAAO,IAEpDg2E,EAAK,CAAIC,EAAIC,EAAIC,EAAIC,KAEvB,MAAM5gC,EAAO+E,GAAG/E,KAAK+/B,EAAIC,EAAIW,EAAIC,GAC3BhgC,EAAM,EAAIlO,EAAEotC,MAAMjnB,SAAW,GA9ClBrzE,EA8C2E,GA9CrFqrD,GA8CuCmP,GAAQ4/B,EAAQW,IAAeA,KA9CjE76F,EA8C6E,GA5CvFA,EACAmrD,GAAOrrD,EACHA,EACAqrD,QALCA,EAAKnrD,EAAKF,EAgDjB,GAAY,IAARo7D,EAAJ,CAIA,GAAK++B,EAAU13F,KAAKw4F,EAAK,GAElB,GAAKd,EAAU13F,KAAKy4F,EAAK,GAIzB,CAIH,IAAIG,EAEAA,EADAlB,EAAU13F,KAAKw4F,EAAK,GAAKd,EAAU13F,KAAKy4F,EAAK,GACtC,EAAIf,EAAU13F,KAAKw4F,EAAK,GAAKd,EAAU13F,KAAKy4F,EAAK,IAAM,EAAI9/B,GAE3D++B,EAAU13F,KAAKy4F,EAAK,GAAKf,EAAU13F,KAAKw4F,EAAK,GAAK7/B,EAM7D++B,EAAU13F,KAAKy4F,GAAM/pG,KAAKyO,MAAM2/D,GAAG+7B,IAAInB,EAAU13F,KAAKw4F,GAAKd,EAAU13F,KAAKy4F,EAAK,GAAIG,GAAQP,EAAQF,IACnGT,EAAU13F,KAAKy4F,EAAK,GAAK/pG,KAAKyO,MAAM2/D,GAAG+7B,IAAInB,EAAU13F,KAAKw4F,EAAK,GAAId,EAAU13F,KAAKy4F,EAAK,GAAIG,GAAQP,EAAQF,IAC3GT,EAAU13F,KAAKy4F,EAAK,GAAK/pG,KAAKyO,MAAM2/D,GAAG+7B,IAAInB,EAAU13F,KAAKw4F,EAAK,GAAId,EAAU13F,KAAKy4F,EAAK,GAAIG,GAAQP,EAAQF,IAE3GA,GAASA,EAAQ,GAAKC,OArBtBV,EAAU13F,KAAKy4F,GAAMf,EAAU13F,KAAKw4F,EAAK,GACzCd,EAAU13F,KAAKy4F,EAAK,GAAKf,EAAU13F,KAAKw4F,EAAK,GAC7Cd,EAAU13F,KAAKy4F,EAAK,GAAKf,EAAU13F,KAAKw4F,EAAK,QAsB5C/tC,EAAEotC,MAAMiB,YACTpB,EAAU13F,KAAKy4F,EAAK,GAAK/pG,KAAKyO,MAAM2/D,GAAG+7B,IAAInB,EAAU13F,KAAKw4F,EAAK,GAAId,EAAU13F,KAAKy4F,EAAK,GAAI9/B,GAAO,OAKpGogC,EAAe,EAATtuC,EAAEytC,GAAG9oF,EACX4pF,EAAMD,EAAuB,GAAhBtuC,EAAEloC,KAAKogC,EAAI,GAG9B,GAAI8H,EAAEwtC,GAAG5oF,EAAIo7C,EAAEytC,GAAG7oF,EACd,IAAK,IAAIA,EAAIo7C,EAAEloC,KAAKqgC,EAAI,EAAGq2C,EAAKxuC,EAAEytC,GAAG7oF,EAAIo7C,EAAEloC,KAAKqgC,EAAI,EAAGvzC,GAAK,EAAGA,IAAK4pF,IAAM,CACtE,MAAMC,GAAU7pF,EAAIo7C,EAAEytC,GAAG7oF,GAAKqoF,EAAU70C,MAAQ,EAChD,IAAK,IAAIzzC,EAAI4pF,EAAME,EAAQ14B,EAAKw4B,EAAME,EAASvqE,EAAQ+pE,EAAKjuC,EAAEytC,GAAG9oF,EAAIq7C,EAAEloC,KAAKogC,EAAI,EAAGvzC,GAAK2pF,EAAMG,EAAQ9pF,GAAK,EAAGoxD,GAAM,EAAGk4B,IACnHH,EAAM/3B,EAAIpxD,EAAGspF,EAAIO,QAGtB,GAAIxuC,EAAEwtC,GAAG5oF,EAAIo7C,EAAEytC,GAAG7oF,EACrB,IAAK,IAAI2wB,EAAI,EAAGm5D,EAAK1uC,EAAEytC,GAAG7oF,EAAG2wB,EAAIyqB,EAAEloC,KAAKqgC,EAAG5iB,IAAKm5D,IAAM,CAClD,MAAMD,GAAUl5D,EAAIyqB,EAAEytC,GAAG7oF,GAAKqoF,EAAU70C,MAAQ,EAChD,IAAK,IAAIzzC,EAAI4pF,EAAME,EAAQ14B,EAAKw4B,EAAME,EAASvqE,EAAQ+pE,EAAKjuC,EAAEytC,GAAG9oF,EAAIq7C,EAAEloC,KAAKogC,EAAI,EAAGvzC,GAAK2pF,EAAMG,EAAQ9pF,GAAK,EAAGoxD,GAAM,EAAGk4B,IACnHH,EAAM/3B,EAAIpxD,EAAGspF,EAAIS,QAIzB,GAAI1uC,EAAEwtC,GAAG7oF,EAAIq7C,EAAEytC,GAAG9oF,EACd,IAAK,IAAIC,EAAIo7C,EAAEloC,KAAKqgC,EAAI,EAAG+1C,EAAKluC,EAAEytC,GAAG7oF,EAAIo7C,EAAEloC,KAAKqgC,EAAI,EAAGvzC,GAAK,EAAGA,IAAKspF,IAAM,CACtE,MAAMO,GAAU7pF,EAAIo7C,EAAEytC,GAAG7oF,GAAKqoF,EAAU70C,MAAQ,EAChD,IAAK,IAAIzzC,EAAI4pF,EAAME,EAAQ14B,EAAKw4B,EAAME,EAASvqE,EAAQ+pE,EAAKjuC,EAAEytC,GAAG9oF,EAAIq7C,EAAEloC,KAAKogC,EAAI,EAAGvzC,GAAK2pF,EAAMG,EAAQ9pF,GAAK,EAAGoxD,GAAM,EAAGk4B,IACnHH,EAAM/3B,EAAIpxD,EAAGspF,EAAIC,QAIzB,IAAK,IAAI5/B,EAAI,EAAGqgC,EAAK3uC,EAAEytC,GAAG7oF,EAAG0pD,EAAItO,EAAEloC,KAAKqgC,EAAGmW,IAAKqgC,IAAM,CAClD,MAAMF,GAAUngC,EAAItO,EAAEytC,GAAG7oF,GAAKqoF,EAAU70C,MAAQ,EAChD,IAAK,IAAIzzC,EAAI2pF,EAAMG,EAAQ14B,EAAKu4B,EAAMG,EAASvqE,EAAQ+pE,EAAKjuC,EAAEytC,GAAG9oF,EAAGA,EAAI4pF,EAAME,EAAQ9pF,GAAK,EAAGoxD,GAAM,EAAGk4B,IACnGH,EAAM/3B,EAAIpxD,EAAGspF,EAAIU,IC3O9B,MAAMC,GAAU,qBCAnB,IAAIC,EAEAC,EAEAC,EACAC,EAMAC,EAVAC,EAA8B,IAAIC,GAAGC,eAGvBC,EAAc,EAAGC,EAAiB,MAAQC,EAAiB,EAEzEC,GAAyB,EAAMC,GAA4B,EAC3DC,GAAwB,EAExBC,EADe,EAIfC,EAAY,CAACjrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GACnC+tC,EAAa,CAAClrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GAEpC+I,GAAY,EACZilC,EAAkB,CAAC,EAAG,GAAK,EAAG,GAG9BC,EAAiBrrG,SAASC,cAAc,UAC5CorG,EAAe33C,MAAQ,IACvB23C,EAAe13C,OAAS,IACxB,IAAI23C,EAAgBtrG,SAASC,cAAc,UAC3CqrG,EAAc53C,MAAQ,GACtB43C,EAAc33C,OAAS,GACvB,IAAI43C,EAAgBvrG,SAASC,cAAc,UAC3CsrG,EAAc73C,MAAQ,GACtB63C,EAAc53C,OAAS,GAEvB,IAAI63C,EAAa,KAEbC,EAAkB,EAAVlsG,KAAKuvC,YAER48D,IACL,GA1Be,IA0BXT,GA1B6D,IA0B1BA,EACnC,OAGJ,IAMIhkC,EANA0kC,EAAiB,CACjB,CAACN,EAAgB,KACjB,CAACC,EAAe,IAChB,CAACC,EAAe,KAKpB,IAAK,IAAI5tG,EAAI,EAAGA,EAAIguG,EAAe/tG,OAAQD,IACvCspE,EAAO0kC,EAAehuG,GAAG,GAAW+2D,WAAW,MAE/CuS,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAGuX,EAAehuG,GAAG,GAAIguG,EAAehuG,GAAG,IAE5DspE,EAAIC,UAAY,QAAUmjC,EAAaj8E,EAAI,KAAOi8E,EAAah0C,EAAI,KAAOg0C,EAAazqF,EAAI,KAAOwrF,EAAgBH,GAAkB,IACpIhkC,EAAIE,SAAS,EAAG,EAAGwkC,EAAehuG,GAAG,GAAIguG,EAAehuG,GAAG,IAE3DspE,EAAIwO,yBAA2B,iBAC/BxO,EAAI8M,sBAAwB,OAC5B9M,EAAImM,UAAU80B,GAAW+C,GAAiB,EAAG,EAAGU,EAAehuG,GAAG,GAAIguG,EAAehuG,GAAG,IAExFspE,EAAIiN,UAaT,SACM03B,EAAQ3rF,EAAGC,EAAGkT,EAAMquD,EAAStc,EAAQ0mC,GAC1C,KAAIz4E,GAAQ,GAgBZ,GAZI43E,IACAb,EAAQ10B,yBAA2B,eAGlCo2B,GAAUA,EAAO,KAAOpqB,IACzB0oB,EAAQnc,YAAcvM,GAGrBoqB,GA9EU,IA8ECZ,GA9EiD,IA8EdA,IAC/Cd,EAAQjjC,UAAYojC,GA/ET,IAkFXW,EACAd,EAAQza,YACRya,EAAQ2B,IAAI7rF,EAAGC,EAAGkT,EAAM,EAAGq4E,GAC3BtB,EAAQ4B,YACR5B,EAAQna,YAEL,GAxF0D,IAwFtDib,OACOvmG,IAAVygE,IACAglC,EAAQt2B,OACRs2B,EAAQn2B,UAAU/zD,EAAGC,GACrBiqF,EAAQl2B,OAAO9O,EAAQ,IAAM5lE,KAAKuvC,IAClCq7D,EAAQhjC,UAAU/zC,GAAOA,EAAa,EAAPA,EAAiB,EAAPA,GACzC+2E,EAAQj2B,eAGT,CACHi2B,EAAQt2B,OACRs2B,EAAQn2B,UAAU/zD,EAAGC,GACrB,IAAI8rF,EAAeX,EACfj4E,GAAQ,IAAMA,EAAO,GACrB44E,EAAeV,EACRl4E,GAAQ,KACf44E,EAAeT,GAEnBpB,EAAQh7D,MAAM/b,EAAMA,GA1GQ,IA2GxB63E,GACAd,EAAQl2B,OAAkB,OAATh0D,EAAIC,GAAcurF,GAEvCtB,EAAQ/2B,UAAU44B,GAAc,GAAI,EAAI,EAAG,GAE3C7B,EAAQj2B,oBAIP+3B,EAAahsF,EAAGC,EAAGkT,EAAMgqC,GACX,OAAfouC,IACAA,EAAa,IAAI79B,GAAGu+B,WACpBV,EAAWlhF,IAAI4gF,EAAUjrF,EAAGirF,EAAUhrF,EAAG,GAAG,gBAGhD,IAAIisF,EAAU,YAELC,EAAY5kG,GACjB,IAAI6kG,EAAgB1+B,GAAG+7B,IAAIyB,EAAW/tC,SAAUA,EAAU51D,EAAIiqC,GAC1D66D,EAAezB,GAAkBE,EAA6BsB,EAAgBA,EAAiB,GAC/FE,EAAYhtG,KAAK6O,IAAI,GAAKu8F,GAAeG,EAAyBuB,EAAgB,IACtFF,EAAQnkG,KAAK,CAACR,EAAIyY,EAAGzY,EAAI0Y,EAAGqsF,EAAWD,EAAc9kG,EAAI29D,QAG7D,IASI0mC,EATAW,EAAep5E,EAAOw3E,EAChB,OAAN3qF,EACAurF,EAAW54B,SAAS45B,EAAcJ,GAElCZ,EAAWlhF,IAAIrK,EAAGC,EAAGssF,EAAcJ,GAIvCjC,EAAQt2B,OAER,IAAK,IAAIl2E,EAAI,EAAGA,EAAIwuG,EAAQvuG,OAAQD,IAAK,CACrC,IAAI4sB,EAAO4hF,EAAQxuG,GACnBiuG,EAAQrhF,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIshF,GACrDA,EAASthF,EAEb4/E,EAAQj2B,UAMZtyE,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7B8uC,EAAe,CACXsC,KAAM,CAAC,QAAS,YAChBC,QAAS,IAEbvC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAAC0jD,KAEbX,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACyjD,KAEbV,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACsjD,KAEbP,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACujD,KAEbR,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACwjD,KAEbT,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACgjD,KAEbD,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAAC4jD,KAEbb,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAAC2jD,KAGb1vC,EAAIqS,GAAGj/B,MAAM4sB,EAAG,EAAG,GACnB,IAAIgxC,EAAevB,EAA6BF,EAAiBvvC,EAAIA,EAAKuvC,EACtE0B,EAAYzB,EAAyBvrG,KAAK6O,IAAI,GAAKktD,EAAIqvC,GAAeprG,KAAK6O,IAAI,GAAKu8F,GAExFxkC,GAAY,EACZgkC,EAAQt2B,OACR+3B,EAAQ3rF,EAAGC,EAAGqsF,EAAWD,GACzBnC,EAAQj2B,UAERq2B,EAAkBgC,EAAY3B,EAC9BM,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdgrF,EAAU9tC,SAAW9B,EACrB6vC,EAAW/tC,SAAW9B,EAEtB8uC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,YACRzxB,OAAQ,CAACpnC,EAAGC,EAAGo7C,MAIvB15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,GAC1B,IAAK6K,EACD,OAEJikC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,SACRzxB,OAAQ,CAACpnC,EAAGC,EAAGo7C,KAGnB,IAAI8B,EAAWuQ,GAAGj/B,MAAM4sB,EAAG,EAAG,GAC1BixC,EAAYzB,EAAyBvrG,KAAK6O,IAAI,GAAK88F,EAAU9tC,SAAWutC,GAAeprG,KAAK6O,IAAI,GAAKu8F,GAEzGR,EAAQt2B,OACRo4B,EAAahsF,EAAGC,EAAGqsF,EAAWrB,EAAU9tC,UAMxC+sC,EAAQj2B,UAERg3B,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdirF,EAAW/tC,SAAW8tC,EAAU9tC,SAChC8tC,EAAU9tC,SAAWA,GAGzBx7D,KAAKirG,QAAU,SAAU5sF,EAAGC,GAExB,IAAIqsF,EAAYzB,EAAyBvrG,KAAK6O,IAAI,GAAK88F,EAAU9tC,SAAWutC,GAAeprG,KAAK6O,IAAI,GAAKu8F,GACzGR,EAAQt2B,OACRo4B,EAAa,KAAM,KAAMM,EAAWrB,EAAU9tC,UAC9C+sC,EAAQj2B,UAER/N,GAAY,EAEZqlC,EAAa,KAETpB,IACAA,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACpnC,EAAGC,KAEhBsqF,EAAQxiG,KAAKoiG,GACbA,OAAe1lG,IAIvB9C,KAAKkrG,gBAAkB,SAAUn8D,EAAIE,EAAIwgC,EAAIzH,GAKzC,GAJAshC,EAAUjrF,EAAIoxD,EACd65B,EAAUhrF,EAAI0pD,EACdshC,EAAU9tC,SAAW,EAEjB+I,QAAoBzhE,IAAPisC,EACb,OAGJ,IAIIo8D,EAJA5nC,EAAQwI,GAAG8gB,iBAAiB,CAACxuE,EAAE0wB,EAAIzwB,EAAE2wB,GAAK,CAAC5wB,EAAEoxD,EAAInxD,EAAE0pD,IACnDojC,EAAYztG,KAAKkhB,KAAKlhB,KAAK67B,IAAIi2C,EAAK1gC,EAAI,GAAOpxC,KAAK67B,IAAIwuC,EAAK/4B,EAAI,IACjEo8D,GAAM57B,EAAK1gC,GAAMq8D,EACjBE,GAAMtjC,EAAK/4B,GAAMm8D,EAEjBG,EAAQxC,EAAcC,EAE1B,IADAL,EAAkBI,EAAcC,EAC3BmC,EAAWxC,EAAiBwC,GAAYC,EAAWD,GAAYI,EAChEvB,EAAQj7D,EAAKs8D,EAAKF,EAAUl8D,EAAKq8D,EAAKH,EAAUpC,EAAaE,EAAgB1lC,GAIjF,IAAIioC,EAAe,CACfV,KAAM,CAAC,QAAS,YAChBC,QAAS,IAEbS,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAAC0jD,KAEbqC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACyjD,KAEbsC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACsjD,KAEbyC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACujD,KAEbwC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACwjD,KAEbuC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACgjD,KAEb+C,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAAC4jD,KAEbmC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAAC2jD,KAGboC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAAC1W,EAAIE,EAAIwgC,EAAIzH,KAEzB4gC,EAAQxiG,KAAKolG,IAIjBxrG,KAAKukE,UAAY,WACb,OAAOA,GAGXvkE,KAAKyrG,SAAW,SAAUrjG,GAClBihG,IAAmBjhG,IAGvBihG,EAAiBjhG,EACjB0hG,MAEJ9pG,KAAK4lF,SAAW,SAAUxrD,GAClBquE,IAAiBruE,IAGrBquE,EAAe,CAACj8E,EAAG4N,EAAE5N,EAAGioC,EAAGr6B,EAAEq6B,EAAGz2C,EAAGoc,EAAEpc,GACrC0qF,EAAkB,OAASD,EAAaj8E,EAAI,IAAMi8E,EAAah0C,EAAI,IAAMg0C,EAAazqF,EAAI,IAC1F8rF,MAEJ9pG,KAAK0rG,WAAa,SAAUtxE,GACxBmuE,EAAUnuE,GAEdp6B,KAAK2rG,WAAa,SAAUp1B,GACxBqyB,EAAUryB,GAEdv2E,KAAK0wF,QAAU,SAAUt7B,GACrB2zC,EAAc3zC,GAElBp1D,KAAK4rG,WAAa,SAAUxhC,GACxB6+B,EAAiB7+B,GAErBpqE,KAAK6rG,WAAa,SAAUz2C,GACxB4zC,EAAiB5zC,GAErBp1D,KAAK8rG,aAAe,SAAU9tF,GAC1BkrF,EAAyBlrF,GAE7Bhe,KAAK+rG,gBAAkB,SAAU/tF,GAC7BmrF,EAA4BnrF,GAEhChe,KAAKgsG,aAAe,SAAUhuF,GAC1BorF,EAAwBprF,GAG5Bhe,KAAKisG,WAAa,WACd,OAAOjD,GAEXhpG,KAAKksG,QAAU,WACX,OAAOnD,GAEX/oG,KAAKmsG,WAAa,WACd,OAAOlD,GAEXjpG,KAAKosG,aAAe,SAAUpuF,GAC1B,OAAOorF,qBJ7UHiD,mBAAoB9xC,GACxBv6D,KAAKssG,aAAevgC,GAAGwgC,aAAavsG,KAAKssG,aAAc/xC,GAGnDiyC,gBACJ,OAAO7uG,KAAKuO,KAAKlM,KAAKuoG,QAAQ11C,OAAOf,MA9D5B,KAqEL26C,mBACJ,MAAMC,EAAQ1sG,KAAK0sG,MAAMpsE,KAAI3X,GAAQ,OAChB3oB,KAAK2sG,gBAAgB3sG,KAAKssG,cAClCjsE,SAAO,CAAEusE,EAAWhgG,KACzBggG,IACAF,EAAM9/F,GAAS5M,KAAK0sG,MAAM9/F,OAGlC5M,KAAK6sG,UAAUH,GACf1sG,KAAKssG,aAAe,KAGhBK,gBAAgBpyC,GACpB,MAAMuyC,EAAe9sG,KAAK0sG,MAAMpsE,KAAI3X,IAAQ,IACtCokF,EAAS/sG,KAAKwsG,gBAOpB,IAAK,IAAIzwG,GANTw+D,EAAS,CACLxrB,GAAIpxC,KAAKyO,MAAMmuD,EAAOxrB,GArFjB,KAsFLE,GAAItxC,KAAKyO,MAAMmuD,EAAOtrB,GAtFjB,KAuFLwgC,GAAI9xE,KAAKyO,MAAMmuD,EAAOkV,GAvFjB,KAwFLzH,GAAIrqE,KAAKyO,MAAMmuD,EAAOyN,GAxFjB,OA0FWj5B,GAAIhzC,GAAKw+D,EAAOkV,GAAI1zE,IACpC,IAAK,IAAI2C,EAAI67D,EAAOtrB,GAAIvwC,GAAK67D,EAAOyN,GAAItpE,IACpCouG,EAAapuG,EAAIquG,EAAShxG,IAAK,EAGvC,OAAO+wG,EAQHE,YAAYzyC,GAChB,MAAMwyC,EAAS/sG,KAAKwsG,gBACd3kG,EAA6C,GA4BnD,OA3BqB7H,KAAK2sG,gBAAgBpyC,GAE7Bl6B,SAAO,CAAE4sE,EAAMlxG,KACxB,IAAKkxG,EACD,OAGJ,MAAMC,EAAenxG,EAAIgxG,EAjHpB,IAkHCI,EAlHD,IAkHexvG,KAAKyO,MAAMrQ,EAAIgxG,GAC7BK,EAAYptG,KAAK0sG,MAAM3wG,GAAG+1D,MAC1Bu7C,EAAartG,KAAK0sG,MAAM3wG,GAAGg2D,OAE3Bu7C,EAAe,CACjBv+D,GAAIpxC,KAAK6O,IAAI,EAAG+tD,EAAOxrB,GAAKm+D,GAC5Bj+D,GAAItxC,KAAK6O,IAAI,EAAG+tD,EAAOtrB,GAAKk+D,GAC5B19B,GAAI9xE,KAAK+O,IAAI0gG,EAAY,EAAG7yC,EAAOkV,GAAKy9B,GACxCllC,GAAIrqE,KAAK+O,IAAI2gG,EAAa,EAAG9yC,EAAOyN,GAAKmlC,IAEzCG,EAAav+D,GAAKu+D,EAAa79B,IAAM69B,EAAar+D,GAAKq+D,EAAatlC,IAGxEngE,EAAOzB,KAAK,CACRwG,MAAO7Q,EACPw+D,OAAQ+yC,OAITzlG,EAMH0lG,eAAehzC,GACnB,IAAKA,EACD,OAGJ,MAAMuyC,EAAe9sG,KAAK2sG,gBAAgBpyC,GACpCwyC,EAAS/sG,KAAKwsG,gBAEpBM,EAAazsE,SAAO,CAAE1X,EAAM5sB,KACxB,IAAK4sB,GAAQ3oB,KAAK0sG,MAAM3wG,GAEpB,OAEJ,MAAMsiB,EAAItiB,EAAIgxG,EACRzuF,EAAI3gB,KAAKyO,MAAMrQ,EAAIgxG,GACnBn7C,GAAKj0D,KAAK+O,IA1JX,IA0Je2R,EA1Jf,IA0JwCre,KAAKuoG,QAAQ11C,OAAOf,OAAS,GA1JrE,IA0JqF,EACpFD,GAAKl0D,KAAK+O,IA3JX,IA2Je4R,EA3Jf,IA2JwCte,KAAKuoG,QAAQ11C,OAAOd,QAAU,GA3JtE,IA2JsF,EAIrFy7C,EADYzhC,GAAGlZ,OAAOjB,EAAGC,GACNiB,WAAW,MACpC06C,EAAOh8B,UAAUxxE,KAAKuoG,QAAQ11C,OAhKzB,KAgKkCx0C,EAhKlC,KAgKiDC,GAEtDte,KAAK0sG,MAAM3wG,GAAKyxG,EAAOl5B,aAAa,EAAG,EAAG1iB,EAAGC,MAI7C47C,WAAYpvF,EAAGC,EAAGkT,GAEtBA,EAAO7zB,KAAK6O,IAAI,GAAY,IAAPglB,GACrB,MAAMud,EAAKpxC,KAAK6O,IAAI,EAAG7O,KAAKyO,MAAMiS,EAAImT,IAChCyd,EAAKtxC,KAAK6O,IAAI,EAAG7O,KAAKyO,MAAMkS,EAAIkT,IAChCi+C,EAAK9xE,KAAK+O,IAAI1M,KAAKuoG,QAAQ11C,OAAOf,MAAQ,EAAGn0D,KAAKuO,KAAKmS,EAAImT,IAC3Dw2C,EAAKrqE,KAAK+O,IAAI1M,KAAKuoG,QAAQ11C,OAAOd,OAAS,EAAGp0D,KAAKuO,KAAKoS,EAAIkT,IAClE,GAAIud,EAAK0gC,GAAMxgC,EAAK+4B,EAChB,MAAO,CACHx7C,EAAG,EACHioC,EAAG,EACHz2C,EAAG,EACH5V,EAAG,GAIX,IAAoCslG,EAAhCC,EAAK,EAAGC,EAAK,EAAGC,EAAK,EAAGC,EAAK,EAyBjC,OAvBqB9tG,KAAKgtG,YAAY,IAAEj+D,KAAIE,KAAIwgC,KAAIzH,IACvC3nC,SAAQxiC,IACjB,MAAMi0D,EAAQ9xD,KAAK0sG,MAAM7uG,EAAM+O,OAAOklD,MAChC7iD,EAAOjP,KAAK0sG,MAAM7uG,EAAM+O,OAAOqC,KAC/BsrD,EAAS18D,EAAM08D,OAErB,IAAK,IAAIx+D,EAAIw+D,EAAOtrB,GAAIlzC,GAAKw+D,EAAOyN,GAAIjsE,GAAK,EACzC,IAAK,IAAI2C,EAAI67D,EAAOxrB,GAAIsyD,EAAKtlG,EAAI+1D,EAAQ,EAAgB,EAAZyI,EAAOxrB,GAAQrwC,GAAK67D,EAAOkV,GAAI/wE,GAAK,EAAG2iG,GAAM,GACtFqM,EAAQz+F,EAAKoyF,EAAK,GAClBsM,GAAM1+F,EAAKoyF,GAAMqM,EACjBE,GAAM3+F,EAAKoyF,EAAK,GAAKqM,EACrBG,GAAM5+F,EAAKoyF,EAAK,GAAKqM,EACrBI,GAAMJ,KAKP,IAAPI,IACAH,GAAMG,EACNF,GAAME,EACND,GAAMC,EACNA,EAAKnwG,KAAK+O,IAAI,EAAGohG,IAEd,CACHthF,EAAGmhF,EACHl5C,EAAGm5C,EACH5vF,EAAG6vF,EACHzlG,EAAG0lG,GAIHC,QAAS1vF,EAAWC,EAAWkT,GACnCA,EAAO7zB,KAAK6O,IAAI,GAAKglB,GACrB,IAAIud,EAAKpxC,KAAK6O,IAAI,EAAG7O,KAAKyO,MAAMiS,EAAImT,IAChCyd,EAAKtxC,KAAK6O,IAAI,EAAG7O,KAAKyO,MAAMkS,EAAIkT,IAChCi+C,EAAK9xE,KAAK+O,IAAI1M,KAAKuoG,QAAQ11C,OAAOf,MAAQ,EAAGn0D,KAAKuO,KAAKmS,EAAImT,IAC3Dw2C,EAAKrqE,KAAK+O,IAAI1M,KAAKuoG,QAAQ11C,OAAOd,OAAS,EAAGp0D,KAAKuO,KAAKoS,EAAIkT,IAChE,OAAIud,EAAK0gC,GAAMxgC,EAAK+4B,EACT,KAEJ,IAAEj5B,KAAIE,KAAIwgC,KAAIzH,GAGjBgiC,QAASvkD,GAEb,IAAI2hD,EAAQ,EACZ,MAAMC,EAAU5hD,EAAOj0B,KAAO,GAAK,KAAO,IACpC81E,EAAU,GAChB,IAAK,IAAIrxC,EAAI,EAAGA,EAAIoxC,EAASpxC,IACzBqxC,EAAQrxC,IAAMt4D,KAAKC,SAAW,IAAO,MAAQ,GAIjD,MACMowG,EADY,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACXrwG,KAAKyO,MAAoB,EAAdq5C,EAAOj0B,OACtCy8E,EAAyBD,EAAUA,EAAUA,EAAU,EACvDE,EAAgB,GACtB,GAAIF,EAAS,CACT,IAAIjyG,EAAI,EACR,IAAK,IAAIkgB,EAAI,EAAGA,EAAI+xF,EAAS/xF,IACzB,IAAK,IAAIle,EAAI,EAAGA,EAAIiwG,EAASjwG,IAAKhC,GAAK,EACnCmyG,EAAcnyG,IAAMkgB,EAAI,GAAK+xF,EAC7BE,EAAcnyG,EAAI,IAAMgC,EAAI,GAAKiwG,EAK7C,MAAMG,EAA0C,GAA9BxwG,KAAK67B,IAAIisB,EAAOo6B,QAAS,GAErCuuB,EAAe,EAAID,EACnBE,EAAsBF,EAAYC,EAClCE,EAAc7oD,EAAOj0B,KAAOi0B,EAAOj0B,KACnC+8E,EAAcD,EAAcF,EAAe3oD,EAAOo6B,QAClD2uB,GAAgB,EAAIH,GAAuB5oD,EAAOo6B,QAGlD4uB,EAAezuG,KAAKgtG,YAAY,CAClCj+D,GAAI0W,EAAO1W,GACXE,GAAIwW,EAAOxW,GACXwgC,GAAIhqB,EAAOgqB,GACXzH,GAAIviB,EAAOuiB,KAGT+kC,EAAS/sG,KAAKwsG,gBACpBiC,EAAapuE,SAAQxiC,IACjB,MAAMqvG,EAAervG,EAAM+O,MAAQmgG,EA7Q9B,IA8QCI,EA9QD,IA8QexvG,KAAKyO,MAAMvO,EAAM+O,MAAQmgG,GACvCK,EAAYptG,KAAK0sG,MAAM7uG,EAAM+O,OAAOklD,MACpC7iD,EAAOjP,KAAK0sG,MAAM7uG,EAAM+O,OAAOqC,KAUrC,IAAK,IAAIlT,EAAI8B,EAAM08D,OAAOtrB,GAAIy/D,EAAK3yG,EAAIoxG,EAAc1nD,EAAOnnC,EAAGviB,GAAK8B,EAAM08D,OAAOyN,GAAIjsE,IAAK2yG,IACtF,IACI,IAAIhwG,EAAIb,EAAM08D,OAAOxrB,GACjBsyD,EAAKtlG,EAAIqxG,EAAY,EAAsB,EAAlBvvG,EAAM08D,OAAOxrB,GACtCjhB,EAAKpvB,EAAIwuG,EAAcznD,EAAOpnC,EAClC3f,GAAKb,EAAM08D,OAAOkV,GAClB/wE,IACI2iG,GAAM,EACNvzE,IACN,CAIE,IAAI6gF,EAAS,EACb,GAAIV,EAAgB,CAChB,IAAK,IAAIr7E,EAAI,EAAGA,EAAIs7E,EAAclyG,OAAQ42B,GAAK,EAAG,CAC9C,MAAMo0C,EAAO+E,GAAG6iC,WAAW9gF,EAAKogF,EAAct7E,GAAI87E,EAAKR,EAAct7E,EAAI,IACrEo0C,GAAQsnC,IAGZK,GAAUpI,GAAMiI,EAAexnC,EAAOunC,EAAa,EAAG9oD,EAAOo6B,UAEjE,IAAK8uB,EACD,SAEJA,GAAUV,MACP,CAEH,MAAMjnC,EAAOrpE,KAAK67B,IAAI1L,EAAI,GAAKnwB,KAAK67B,IAAIk1E,EAAI,GAC5C,GAAI1nC,GAAQsnC,EACR,SAEJK,EAASpI,GAAMiI,EAAexnC,EAAOunC,EAAa,EAAG9oD,EAAOo6B,SAGhE,MAAMgvB,EAAY,EAAIF,EAChBG,EAAQ7/F,EAAKoyF,EAAK,GAAK,IAE7B,GAAIrhG,KAAKopG,sBAAuB,CAC5B,MAAM2F,EAAUtpD,EAAOj5B,EAAImiF,EAAY1/F,EAAKoyF,GAAOwN,EAC7CG,EAAUvpD,EAAOgP,EAAIk6C,EAAY1/F,EAAKoyF,EAAK,GAAMwN,EACjDI,EAAUxpD,EAAOznC,EAAI2wF,EAAY1/F,EAAKoyF,EAAK,GAAMwN,EACnDC,IACA7/F,EAAKoyF,GAAM1jG,KAAKyO,MAAM2iG,EAASzH,EAAQF,IACvCn4F,EAAKoyF,EAAK,GAAK1jG,KAAKyO,MAAM4iG,EAAS1H,EAAQF,IAC3Cn4F,EAAKoyF,EAAK,GAAK1jG,KAAKyO,MAAM6iG,EAAS3H,EAAQF,SAE5C,CACH,MAAM2H,EAAUtpD,EAAOj5B,EAAImiF,EAAY1/F,EAAKoyF,GAAMyN,EAAUD,EACtDG,EAAUvpD,EAAOgP,EAAIk6C,EAAY1/F,EAAKoyF,EAAK,GAAKyN,EAAUD,EAC1DI,EAAUxpD,EAAOznC,EAAI2wF,EAAY1/F,EAAKoyF,EAAK,GAAKyN,EAAUD,EAEhE,IAAIK,EAAW,EAAIL,GAAa,EAAIC,GACpC7/F,EAAKoyF,EAAK,GAAK1jG,KAAKyO,MAAMzO,KAAK+O,IAAI,IAAgB,IAAXwiG,GAAkB,IACtDA,IACAjgG,EAAKoyF,GAAM1jG,KAAKyO,MAAM2iG,EAAUG,EAAY5H,EAAQF,IACpDn4F,EAAKoyF,EAAK,GAAK1jG,KAAKyO,MAAM4iG,EAAUE,EAAY5H,EAAQF,IACxDn4F,EAAKoyF,EAAK,GAAK1jG,KAAKyO,MAAM6iG,EAAUC,EAAY5H,EAAQF,KAGhEA,GAASA,EAAQ,GAAKC,MAQ9B8H,YAAa39E,GACjB,OAAOu6C,GAAG+7B,IACE,EAAPt2E,EAAY,EACL,EAAPA,EAAY,EACbu6C,GAAGj/B,OAAOtb,EAAO,KAAQ,IAAW,EAAG,IAIvC64E,aAAchsF,EAAWC,EAAWo7C,EAAW2F,GAInD,IAAIorC,EACAC,EAHJ1qG,KAAKovG,WAAa,GAIlB,IAWIC,EAXA1E,EAAa3qG,KAAKsvG,oBAAuB3xG,KAAK6O,IAAI,EAAGktD,EAAI15D,KAAKwxB,MAAQ7zB,KAAK6O,IAAI,EAAGxM,KAAKwxB,MAEvF+5E,EAAQvrG,KAAKmvG,YAAYxE,GAEzB4E,EAAOlxF,EACPmxF,EAAOlxF,EAQX,GAPU,OAAND,IACAkxF,EAAOvvG,KAAKspG,UAAUjrF,EACtBmxF,EAAOxvG,KAAKspG,UAAUhrF,GAKJ,IAAlBte,KAAKyvG,SACLzvG,KAAK0vG,KAAO1vG,KAAK+iF,MAAMv2D,EACvBxsB,KAAK2vG,KAAO3vG,KAAK+iF,MAAMtuB,EACvBz0D,KAAK4vG,KAAO5vG,KAAK+iF,MAAM/kE,MACpB,CACH,IAAI6xF,EACJ,GAAIxwC,EACAwwC,EAAU,CAACrjF,EAAGxsB,KAAK8vG,YAAYtjF,EAAGioC,EAAGz0D,KAAK8vG,YAAYr7C,EAAGz2C,EAAGhe,KAAK8vG,YAAY9xF,EAAG5V,EAAG,OAChF,CACH,MAAM2nG,EAAY,CAACR,EAAMC,EAAQxvG,KAAKsvG,oBAAuB3xG,KAAK6O,IAAI,GAAKktD,EAAI15D,KAAKwxB,MAAQ7zB,KAAK6O,IAAI,GAAKxM,KAAKwxB,OACzG+oC,EAASv6D,KAAK+tG,QAAQgC,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAClE/vG,KAAKutG,eAAehzC,GACpBs1C,EAAU7vG,KAAKytG,WAAWsC,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAEpEV,EAAc,CAAC7iF,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GAEhCynG,EAAQznG,EAAI,GAAyB,IAApBpI,KAAKgwG,SAAS5nG,GAC/BpI,KAAKgwG,SAASxjF,EAAIqjF,EAAQrjF,EAC1BxsB,KAAKgwG,SAASv7C,EAAIo7C,EAAQp7C,EAC1Bz0D,KAAKgwG,SAAShyF,EAAI6xF,EAAQ7xF,EAC1Bhe,KAAKgwG,SAAS5nG,EAAIynG,EAAQznG,EAC1BinG,EAAY7iF,EAAIxsB,KAAKgwG,SAASxjF,EAC9B6iF,EAAY56C,EAAIz0D,KAAKgwG,SAASv7C,EAC9B46C,EAAYrxF,EAAIhe,KAAKgwG,SAAShyF,EAC9BqxF,EAAYjnG,EAAIpI,KAAKgwG,SAAS5nG,IAGZ,IAAdynG,EAAQznG,IACRynG,EAAQrjF,EAAIxsB,KAAK+iF,MAAMv2D,EACvBqjF,EAAQp7C,EAAIz0D,KAAK+iF,MAAMtuB,EACvBo7C,EAAQ7xF,EAAIhe,KAAK+iF,MAAM/kE,EACvB6xF,EAAQznG,EAAI,EAAIpI,KAAKyvG,UAGzBzvG,KAAKgwG,SAASxjF,EAAIu/C,GAAG+7B,IAAI9nG,KAAKgwG,SAASxjF,EAAGu/C,GAAG+7B,IAAI9nG,KAAKgwG,SAASxjF,EAAGqjF,EAAQrjF,EAAGxsB,KAAKiwG,UAAWJ,EAAQznG,GACrGpI,KAAKgwG,SAASv7C,EAAIsX,GAAG+7B,IAAI9nG,KAAKgwG,SAASv7C,EAAGsX,GAAG+7B,IAAI9nG,KAAKgwG,SAASv7C,EAAGo7C,EAAQp7C,EAAGz0D,KAAKiwG,UAAWJ,EAAQznG,GACrGpI,KAAKgwG,SAAShyF,EAAI+tD,GAAG+7B,IAAI9nG,KAAKgwG,SAAShyF,EAAG+tD,GAAG+7B,IAAI9nG,KAAKgwG,SAAShyF,EAAG6xF,EAAQ7xF,EAAGhe,KAAKiwG,UAAWJ,EAAQznG,GACrGpI,KAAKgwG,SAAS5nG,EAAIzK,KAAK+O,IAAI,EAAG1M,KAAKgwG,SAAS5nG,EAAIynG,EAAQznG,GACxDinG,EAAY7iF,EAAIxsB,KAAKgwG,SAASxjF,EAC9B6iF,EAAY56C,EAAIz0D,KAAKgwG,SAASv7C,EAC9B46C,EAAYrxF,EAAIhe,KAAKgwG,SAAShyF,EAC9BqxF,EAAYjnG,EAAIpI,KAAKgwG,SAAS5nG,GAMtC,MAAM8nG,EAAkBtqG,IACpB,GAAI5F,KAAKyvG,UAAY,GAAKzvG,KAAKgwG,SAAS5nG,GAAK,EACzC,OAEJ,IAAIo9E,EAAS5/E,EAAIiqC,EACjB46D,EAAgBzqG,KAAKupG,WAAW/tC,UAAY,EAAIgqB,GAAU9rB,EAAI8rB,EAC9DklB,EAAgB1qG,KAAKmwG,uBAA2BnwG,KAAK6/E,QAAU4qB,EAAgBA,EAAiBzqG,KAAK6/E,QACrG8qB,EAAa3qG,KAAKsvG,oBAAuB3xG,KAAK6O,IAAI,GAAKi+F,EAAgBzqG,KAAKwxB,MAAQ7zB,KAAK6O,IAAI,GAAKxM,KAAKwxB,MAClF,GAAjBxxB,KAAKyvG,WACLzvG,KAAK0vG,KAAO3jC,GAAG+7B,IAAI9nG,KAAK8vG,YAAYtjF,EAAG6iF,EAAY7iF,EAAGg5D,GACtDxlF,KAAK2vG,KAAO5jC,GAAG+7B,IAAI9nG,KAAK8vG,YAAYr7C,EAAG46C,EAAY56C,EAAG+wB,GACtDxlF,KAAK4vG,KAAO7jC,GAAG+7B,IAAI9nG,KAAK8vG,YAAY9xF,EAAGqxF,EAAYrxF,EAAGwnE,IAEpC,IAAlBxlF,KAAKyvG,UAAyC,IAAvBzvG,KAAK8vG,YAAY1nG,IACxCpI,KAAK0vG,KAAOL,EAAY7iF,EACxBxsB,KAAK2vG,KAAON,EAAY56C,EACxBz0D,KAAK4vG,KAAOP,EAAYrxF,GAE5B,MAAMu8C,EAASv6D,KAAK+tG,QAAQnoG,EAAIyY,EAAGzY,EAAI0Y,EAAGqsF,GACtCpwC,IACAv6D,KAAKqsG,mBAAmB9xC,GACxBv6D,KAAKovG,WAAWhpG,KAAK,CACjBiY,EAAGzY,EAAIyY,EACPC,EAAG1Y,EAAI0Y,EACPkT,KAAMm5E,EACN9qB,QAAS6qB,EACT37D,GAAIwrB,EAAOxrB,GACXE,GAAIsrB,EAAOtrB,GACXwgC,GAAIlV,EAAOkV,GACXzH,GAAIzN,EAAOyN,GACXx7C,EAAGu/C,GAAG+7B,IAAI9nG,KAAK+iF,MAAMv2D,EAAGxsB,KAAK0vG,KAAM1vG,KAAKyvG,UACxCh7C,EAAGsX,GAAG+7B,IAAI9nG,KAAK+iF,MAAMtuB,EAAGz0D,KAAK2vG,KAAM3vG,KAAKyvG,UACxCzxF,EAAG+tD,GAAG+7B,IAAI9nG,KAAK+iF,MAAM/kE,EAAGhe,KAAK4vG,KAAM5vG,KAAKyvG,cAK1C,OAANpxF,EACAre,KAAK4pG,WAAW54B,SAASu6B,EAAO2E,GAEhClwG,KAAK4pG,WAAWlhF,IAAIrK,EAAGC,EAAGitF,EAAO2E,GAGrClwG,KAAKutG,eAAevtG,KAAKssG,cACzBtsG,KAAKovG,WAAW/uE,SAAQ1X,IACpB3oB,KAAKgqG,QAAQrhF,MAEjB3oB,KAAKovG,WAAa,GAElBpvG,KAAK8vG,YAAcT,EAWvB1D,WAAY95C,GACR7xD,KAAK4oG,QAAU/2C,EAGnBq6C,UACI,OAAOlsG,KAAKwxB,KAGhBk/D,QAASt7B,GACLp1D,KAAKwxB,KAAO4jC,EAGhB+2C,aACI,OAAOnsG,KAAK6/E,QAGhB+rB,WAAYxhC,GACRpqE,KAAK6/E,QAAUzV,EAGnBgmC,cACI,OAAOpwG,KAAKyvG,SAGhBY,YAAaryF,GACThe,KAAKyvG,SAAWzxF,EAGpB4nE,SAAUxrD,GACNp6B,KAAK+iF,MAAQhX,GAAG86B,QAAQzsE,GAG5BsxE,WAAYtxE,GACRp6B,KAAKuoG,QAAUnuE,EAGnBk2E,gBAAiBtyF,GACbhe,KAAKsvG,sBAAwBtxF,EAGjCuyF,mBAAoBvyF,GAChBhe,KAAKmwG,yBAA2BnyF,EAGpCouF,eACI,OAAOpsG,KAAKopG,sBAGhB4C,aAAchuF,GACVhe,KAAKopG,wBAA0BprF,EAGnCwmD,eACI,OAAOxkE,KAAKukE,UAGhBisC,aAAcxyF,GACVhe,KAAKywG,YAAczyF,EAGvB6sF,UAAWxsF,EAAWC,EAAWo7C,GAC7B15D,KAAKwrG,aAAe,CAChBV,KAAM,CAAC,QAAS,cAChBC,QAAS,IAIb,MAAM2F,EAAa/yG,KAAKuO,KAAKlM,KAAKuoG,QAAQ11C,OAAOf,MAviBxC,KAuiB4Dn0D,KAAKuO,KAAKlM,KAAKuoG,QAAQ11C,OAAOd,OAviB1F,KAwiBT/xD,KAAK0sG,MAAQ,IAAIiE,OAAOD,GAAYjuG,MAAM,IAAI69B,KAAI3X,GAAQ,OAE1D3oB,KAAKukE,WAAY,EAEjB7K,EAAI/7D,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGgtD,IAC5B,IAAIgxC,EAAgB1qG,KAAKmwG,uBAA2BnwG,KAAK6/E,QAAUnmB,EAAIA,EAAK15D,KAAK6/E,QAC7E8qB,EAAa3qG,KAAKsvG,oBAAuB3xG,KAAK6O,IAAI,GAAKktD,EAAI15D,KAAKwxB,MAAQ7zB,KAAK6O,IAAI,GAAKxM,KAAKwxB,MAC/F,GAAsB,IAAlBxxB,KAAKyvG,SACLzvG,KAAK0vG,KAAO1vG,KAAK+iF,MAAMv2D,EACvBxsB,KAAK2vG,KAAO3vG,KAAK+iF,MAAMtuB,EACvBz0D,KAAK4vG,KAAO5vG,KAAK+iF,MAAM/kE,MACpB,CACHhe,KAAKutG,eAAevtG,KAAK+tG,QAAQ1vF,EAAGC,EAAGqsF,IAEvC,IAAIkF,EAAU7vG,KAAKytG,WACfpvF,EACAC,EACEte,KAAKsvG,oBAAuB3xG,KAAK6O,IAAI,GAAKktD,EAAI15D,KAAKwxB,MAAQ7zB,KAAK6O,IAAI,GAAKxM,KAAKwxB,OAElE,IAAdq+E,EAAQznG,EACRpI,KAAKgwG,SAAW,CACZxjF,EAAGxsB,KAAK+iF,MAAMv2D,EACdioC,EAAGz0D,KAAK+iF,MAAMtuB,EACdz2C,EAAGhe,KAAK+iF,MAAM/kE,EACd5V,EAAG,EAAIpI,KAAKyvG,UAGhBzvG,KAAKgwG,SAAW,CACZxjF,EAAGqjF,EAAQrjF,EACXioC,EAAGo7C,EAAQp7C,EACXz2C,EAAG6xF,EAAQ7xF,EACX5V,EAAGynG,EAAQznG,GAInBpI,KAAK0vG,KAAO1vG,KAAKgwG,SAASxjF,EAC1BxsB,KAAK2vG,KAAO3vG,KAAKgwG,SAASv7C,EAC1Bz0D,KAAK4vG,KAAO5vG,KAAKgwG,SAAShyF,EAQ9B,GALAhe,KAAK8vG,YAAc,CAACtjF,EAAGxsB,KAAK0vG,KAAMj7C,EAAGz0D,KAAK2vG,KAAM3xF,EAAGhe,KAAK4vG,KAAMxnG,EAAGpI,KAAKgwG,SAAS5nG,GAE/EpI,KAAKssG,aAAe,KACpBtsG,KAAKovG,WAAa,GAEdpvG,KAAKyvG,SAAW,GAAKzvG,KAAKgwG,SAAS5nG,EAAI,EAAG,CAC1C,MAAMmyD,EAASv6D,KAAK+tG,QAAQ1vF,EAAGC,EAAGqsF,GAC9BpwC,IACAv6D,KAAKqsG,mBAAmB9xC,GACxBv6D,KAAKovG,WAAWhpG,KAAK,CACjBiY,EAAGA,EACHC,EAAGA,EACHkT,KAAMm5E,EACN9qB,QAAS6qB,EACT37D,GAAIwrB,EAAOxrB,GACXE,GAAIsrB,EAAOtrB,GACXwgC,GAAIlV,EAAOkV,GACXzH,GAAIzN,EAAOyN,GACXx7C,EAAGu/C,GAAG+7B,IAAI9nG,KAAK+iF,MAAMv2D,EAAGxsB,KAAK0vG,KAAM1vG,KAAKyvG,UACxCh7C,EAAGsX,GAAG+7B,IAAI9nG,KAAK+iF,MAAMtuB,EAAGz0D,KAAK2vG,KAAM3vG,KAAKyvG,UACxCzxF,EAAG+tD,GAAG+7B,IAAI9nG,KAAK+iF,MAAM/kE,EAAGhe,KAAK4vG,KAAM5vG,KAAKyvG,aAKpDzvG,KAAKutG,eAAevtG,KAAKssG,cACzBtsG,KAAKovG,WAAW/uE,SAAQ1X,IACpB3oB,KAAKgqG,QAAQrhF,MAEjB3oB,KAAKovG,WAAa,GAElBpvG,KAAK4pG,WAAa,IAAI79B,GAAGu+B,WACzBtqG,KAAK4pG,WAAWlhF,IAAIrK,EAAGC,EAAG,GAAG,eAG7Bte,KAAKspG,UAAUjrF,EAAIA,EACnBre,KAAKspG,UAAUhrF,EAAIA,EACnBte,KAAKspG,UAAU9tC,SAAW9B,EAC1B15D,KAAKupG,WAAax9B,GAAG86B,QAAQ7mG,KAAKspG,WAE9BtpG,KAAKssG,eAAiBtsG,KAAKywG,WAC3BzwG,KAAKysG,mBAIbzB,OAAQ3sF,EAAWC,EAAWo7C,EAAW2F,GAChCr/D,KAAKukE,YAGVvkE,KAAKqqG,aAAahsF,EAAGC,EAAGte,KAAKspG,UAAU9tC,SAAU6D,GAEjDr/D,KAAKupG,WAAax9B,GAAG86B,QAAQ7mG,KAAKspG,WAClCtpG,KAAKspG,UAAUjrF,EAAIA,EACnBre,KAAKspG,UAAUhrF,EAAIA,EACnBte,KAAKspG,UAAU9tC,SAAW9B,EAEtB15D,KAAKssG,eAAiBtsG,KAAKywG,WAC3BzwG,KAAKysG,oBAIbxB,UACQjrG,KAAK4pG,YACL5pG,KAAKqqG,aAAa,KAAM,KAAMrqG,KAAKspG,UAAU9tC,UAAU,GAG3Dx7D,KAAKukE,WAAY,EACjBvkE,KAAK4pG,WAAa,KAEd5pG,KAAKssG,cACLtsG,KAAKysG,mBAGLzsG,KAAKwrG,cAAgBxrG,KAAK4oG,SAAW5oG,KAAK0sG,MAAMhsE,MAAK/X,KAAUA,MAC/D3oB,KAAKwrG,aAAaT,QAAQ3kG,KAAK,CAC3B8wE,OAAQ,YACRzxB,OAAQ,CAACzlD,KAAK0sG,SAElB1sG,KAAK4oG,QAAQxiG,KAAKpG,KAAKwrG,cACvBxrG,KAAKwrG,aAAe,MAExBxrG,KAAK0sG,MAAQ,KAOjBG,UAAWH,GACP,MAAMK,EAAS/sG,KAAKwsG,gBACpBE,EAAMrsE,SAAO,CAAEsmE,EAAW/5F,KACtB,IAAK+5F,EACD,OAEJ,MAAMuG,EAAetgG,EAAQmgG,EA9qBxB,IA+qBCI,EA/qBD,IA+qBexvG,KAAKyO,MAAMQ,EAAQmgG,GACvC/sG,KAAKuoG,QAAQh0B,aAAaoyB,EAAWuG,EAAaC,MAI1DjC,gBAAiBn8D,EAAYE,EAAYwgC,EAAYzH,GAIjD,GAHAhoE,KAAKspG,UAAUjrF,EAAIoxD,EACnBzvE,KAAKspG,UAAUhrF,EAAI0pD,EAEfhoE,KAAKukE,gBAAoBzhE,IAAPisC,EAClB,OAGJ,MAAM2hE,EAAa/yG,KAAKuO,KAAKlM,KAAKuoG,QAAQ11C,OAAOf,MA5rBxC,KA4rB4Dn0D,KAAKuO,KAAKlM,KAAKuoG,QAAQ11C,OAAOd,OA5rB1F,KA6rBT/xD,KAAK0sG,MAAQ,IAAIiE,OAAOD,GAAYjuG,MAAM,IAAI69B,KAAI3X,GAAQ,OAC1D3oB,KAAKssG,aAAe,KACpBtsG,KAAKovG,WAAa,GAElBpvG,KAAKutG,eAAevtG,KAAK+tG,QAAQh/D,EAAIE,EAAItxC,KAAK6O,IAAI,GAAKxM,KAAKwxB,QAC5D,IAAIq+E,EAAU7vG,KAAKytG,WAAW1+D,EAAIE,EAAItxC,KAAK6O,IAAI,GAAKxM,KAAKwxB,OAEvC,IAAdq+E,EAAQznG,EACRpI,KAAKgwG,SAAW,CACZxjF,EAAGxsB,KAAK+iF,MAAMv2D,EACdioC,EAAGz0D,KAAK+iF,MAAMtuB,EACdz2C,EAAGhe,KAAK+iF,MAAM/kE,EACd5V,EAAG,EAAIpI,KAAKyvG,UAGhBzvG,KAAKgwG,SAAW,CACZxjF,EAAGqjF,EAAQrjF,EACXioC,EAAGo7C,EAAQp7C,EACXz2C,EAAG6xF,EAAQ7xF,EACX5V,EAAGynG,EAAQznG,GAInBpI,KAAK0vG,KAAO1vG,KAAK+iF,MAAMv2D,GAAK,EAAIxsB,KAAKgwG,SAAS5nG,IAAMpI,KAAKyvG,SAAWzvG,KAAKgwG,SAASxjF,EAAIxsB,KAAK+iF,MAAMv2D,GAAK,EAAIxsB,KAAKyvG,WAAazvG,KAAKgwG,SAAS5nG,EAC1IpI,KAAK2vG,KAAO3vG,KAAK+iF,MAAMtuB,GAAK,EAAIz0D,KAAKgwG,SAAS5nG,IAAMpI,KAAKyvG,SAAWzvG,KAAKgwG,SAASv7C,EAAIz0D,KAAK+iF,MAAMtuB,GAAK,EAAIz0D,KAAKyvG,WAAazvG,KAAKgwG,SAAS5nG,EAC1IpI,KAAK4vG,KAAO5vG,KAAK+iF,MAAM/kE,GAAK,EAAIhe,KAAKgwG,SAAS5nG,IAAMpI,KAAKyvG,SAAWzvG,KAAKgwG,SAAShyF,EAAIhe,KAAK+iF,MAAM/kE,GAAK,EAAIhe,KAAKyvG,WAAazvG,KAAKgwG,SAAS5nG,EAG1I,MACMsiG,EAAgB1qG,KAAKmwG,uBADjB,EAC4CnwG,KAAK6/E,QADjD,EACoE7/E,KAAK6/E,QAC7E8qB,EAAa3qG,KAAKsvG,oBAAuB3xG,KAAK6O,IAAI,GAF9C,EAEuDxM,KAAKwxB,MAAQ7zB,KAAK6O,IAAI,GAAKxM,KAAKwxB,MAG3F45E,EAAYztG,KAAKkhB,KAAKlhB,KAAK67B,IAAIi2C,EAAK1gC,EAAI,GAAOpxC,KAAK67B,IAAIwuC,EAAK/4B,EAAI,IACjEo8D,GAAM57B,EAAK1gC,GAAMq8D,EACjBE,GAAMtjC,EAAK/4B,GAAMm8D,EACjBG,EAAQvrG,KAAKmvG,YAAYxE,GAC/B,IAAK,IAAIQ,EAAW,EAAGA,GAAYC,EAAWD,GAAYI,EAAO,CAC7D,MAAMhxC,EAASv6D,KAAK+tG,QAAQh/D,EAAKs8D,EAAKF,EAAUl8D,EAAKq8D,EAAKH,EAAUR,GAChEpwC,IACAv6D,KAAKutG,eAAehzC,GACpBv6D,KAAKovG,WAAWhpG,KAAK,CACjBiY,EAAG0wB,EAAKs8D,EAAKF,EACb7sF,EAAG2wB,EAAKq8D,EAAKH,EACb35E,KAAMm5E,EACN9qB,QAAS6qB,EACT37D,GAAIwrB,EAAOxrB,GACXE,GAAIsrB,EAAOtrB,GACXwgC,GAAIlV,EAAOkV,GACXzH,GAAIzN,EAAOyN,GACXx7C,EAAGu/C,GAAG+7B,IAAI9nG,KAAK+iF,MAAMv2D,EAAGxsB,KAAK0vG,KAAM1vG,KAAKyvG,UACxCh7C,EAAGsX,GAAG+7B,IAAI9nG,KAAK+iF,MAAMtuB,EAAGz0D,KAAK2vG,KAAM3vG,KAAKyvG,UACxCzxF,EAAG+tD,GAAG+7B,IAAI9nG,KAAK+iF,MAAM/kE,EAAGhe,KAAK4vG,KAAM5vG,KAAKyvG,aAIpDzvG,KAAKovG,WAAW/uE,SAAQ1X,IACpB3oB,KAAKgqG,QAAQrhF,MAEjB3oB,KAAKovG,WAAa,GAEdpvG,KAAK4oG,SAAW5oG,KAAK0sG,MAAMhsE,MAAK/X,KAAUA,MAC1C3oB,KAAK6sG,UAAU7sG,KAAK0sG,OACpB1sG,KAAKwrG,aAAe,CAChBV,KAAM,CAAC,QAAS,cAChBC,QAAS,CAAC,CACN7zB,OAAQ,YACRzxB,OAAQ,CAACzlD,KAAK0sG,UAGtB1sG,KAAK4oG,QAAQxiG,KAAKpG,KAAKwrG,cACvBxrG,KAAKwrG,aAAe,MAExBxrG,KAAK0sG,MAAQ,mBA7uBd1sG,KAEKywG,WAAqB,EAF1BzwG,KAMKwxB,KAAe,GANpBxxB,KAOK6/E,QAAkB,GAPvB7/E,KAQKyvG,SAAmB,IARxBzvG,KAUKopG,uBAAiC,EAVtCppG,KAWKsvG,qBAA+B,EAXpCtvG,KAYKmwG,wBAAkC,EAZvCnwG,KAcKgwG,SAAkB,CAACxjF,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GAd7CpI,KAeKiwG,SAAmB,IAfxBjwG,KAqBKukE,WAAqB,EArB1BvkE,KAsBKspG,UAA4B,CAACjrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GAtBxDx7D,KAuBKupG,WAA6B,CAAClrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,6BC7C5D,IAAI+sC,EACAE,EAMAmI,EAAOC,EAIPrI,EARAO,EAAc,EAAGE,EAAiB,GAClC6H,EAAkB,GAClBC,EAAe,EAGfxsC,GAAY,EACZ+kC,EAAY,CAACjrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GACnCotC,EAA8B,IAAIC,GAAGC,eAErCkI,EAAc,EAClBhxG,KAAK2rG,WAAa,SAAUp1B,GACxBqyB,EAAUryB,GAEdv2E,KAAKixG,QAAU,SAAU77C,GACrB47C,EAAcngE,SAASukB,IAE3Bp1D,KAAKkxG,QAAU,WACX,OAAOrgE,SAAS,GAAKmgE,IAQzB,IAAIxpC,EAAS,GACT/qC,EAAQ,EACR00E,EAAU,CACV,SAAUC,EAAIC,GACV,OAAOD,GAEX,SAAUA,EAAIC,GACV,IAAIxpG,EAAS,IAAIkkE,GAAG+W,IAAIsuB,EAAG5kF,EAAG4kF,EAAG38C,EAAG28C,EAAGpzF,GAIvC,OAHAnW,EAAO2kB,GAAK6kF,EAAG7kF,EAAI,IACnB3kB,EAAO4sD,GAAK48C,EAAG58C,EAAI,IACnB5sD,EAAOmW,GAAKqzF,EAAGrzF,EAAI,IACZnW,GAEX,SAAUupG,EAAIC,GACV,IAAIxpG,EAAS,IAAIkkE,GAAG+W,IAAIsuB,EAAG5kF,EAAG4kF,EAAG38C,EAAG28C,EAAGpzF,GAIvC,OAHAnW,EAAO2kB,GAAK6kF,EAAG7kF,EAAI,IACnB3kB,EAAO4sD,GAAK48C,EAAG58C,EAAI,IACnB5sD,EAAOmW,GAAKqzF,EAAGrzF,EAAI,IACZnW,IAIf7H,KAAKksG,QAAU,WACX,OAAOnD,EAAc,GAEzB/oG,KAAK4lF,SAAW,SAAUxrD,GACtBquE,EAAeruE,GAEnBp6B,KAAKmsG,WAAa,WACd,OAAOlD,GAEXjpG,KAAK4rG,WAAa,SAAUxhC,GACxB6+B,EAAiB7+B,GAErBpqE,KAAKowG,YAAc,WACf,OAAOU,GAEX9wG,KAAKqwG,YAAc,SAAUryF,GACzB8yF,EAAkB9yF,GAEtBhe,KAAK0wF,QAAU,SAAUt7B,GACrB2zC,EAAkB,EAAJ3zC,GAElBp1D,KAAKsxG,SAAW,WACZ,OAAOP,GAEX/wG,KAAK85F,SAAW,SAAU1kC,GACtB27C,EAAe37C,GAEnBp1D,KAAK0rG,WAAa,SAAUtxE,GACxBmuE,EAAUnuE,GAEdp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGk9C,EAAU9W,GACvC,GAAIA,GAAS4kD,EAAUjrF,EAAG,CACbirF,EAAUjrF,EAAQirF,EAAUhrF,EACrCimD,GAAY,EAEZvkE,KAAKirG,eAEL1mC,GAAY,EACZqsC,EAAQvyF,EACRwyF,EAAQvyF,EACRgrF,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdkqF,EAAe,CACXsC,KAAM,CAAC,QAAS,gBAChBC,QAAS,IAEbvC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACsrD,KAEbvI,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACsjD,EAAc,KAE3BP,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACwjD,KAEbT,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACgjD,KAEbD,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,cACRzxB,OAAQ,CAACqrD,KAEbtI,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,YACRzxB,OAAQ,CAACpnC,EAAGC,EAAGk9C,MAK3Bx7D,KAAKgrG,OAAS,SAAUuG,EAAKC,EAAKh2C,EAAUi2C,GACxC,IAAKltC,GAAcgtC,IAAQjI,EAAUjrF,GAAKmzF,IAAQlI,EAAUhrF,EACxD,OAGJ,IAAI5f,EAAGsf,EAAG5V,EAAGqsD,EACTp2C,EAAIwyB,SAAS0gE,GACbjzF,EAAIuyB,SAAS2gE,GACjBhqC,EAAOphE,KAAK,CAACiY,EAAGC,IAEhB,IAAIoxF,EAAOjH,EAAaj8E,EACpBmjF,EAAOlH,EAAah0C,EACpBm7C,EAAOnH,EAAazqF,EAExB,GAAsB,OAAlByzF,EACA/B,EAAO+B,EAAcjlF,EACrBmjF,EAAO8B,EAAch9C,EACrBm7C,EAAO6B,EAAczzF,OAErB,GAAwB,IAApB8yF,GACIzyF,EAAI,GAAK,GAAKC,EAAI,GAAK,GAAKD,EAAI,EAAIkqF,EAAQ11C,OAAOf,MAAQ,GAAKxzC,EAAI,EAAIiqF,EAAQ11C,OAAOd,OAAS,EAAG,CACnG29C,EAAO,EACPC,EAAO,EACPC,EAAO,EACP,IAAI8B,EAAO/zG,KAAK+O,IAAI67F,EAAQ11C,OAAOf,MAAQ,EAAGn0D,KAAK6O,IAAI,EAAG6R,EAAI,IAC1DszF,EAAOh0G,KAAK+O,IAAI67F,EAAQ11C,OAAOd,OAAS,EAAGp0D,KAAK6O,IAAI,EAAG8R,EAAI,IAC3DszF,EAAOj0G,KAAK+O,IAAI67F,EAAQ11C,OAAOf,MAAQ,EAAGn0D,KAAK6O,IAAI,EAAG6R,EAAI,IAC1DwzF,EAAOl0G,KAAK+O,IAAI67F,EAAQ11C,OAAOd,OAAS,EAAGp0D,KAAK6O,IAAI,EAAG8R,EAAI,IAI/D,GAHAszF,GAAQF,EACRG,GAAQF,EAEJC,EAAO,GAAKC,EAAO,EAAG,CACtB,IAAIx9B,EAAQk0B,EAAQj0B,aAAao9B,EAAMC,EAAMC,EAAMC,GAC/CC,EAAW,EACf,IAAK,IAAI/1G,EAAI,EAAGA,EAAIs4E,EAAMplE,KAAKjT,OAAQD,GAAK,EACxC2zG,GAAQr7B,EAAMplE,KAAKlT,EAAI,GACvB4zG,GAAQt7B,EAAMplE,KAAKlT,EAAI,GACvB6zG,GAAQv7B,EAAMplE,KAAKlT,EAAI,GACvB+1G,IAEJpC,GAAQoC,EACRnC,GAAQmC,EACRlC,GAAQkC,EAGZ,IAAIC,EAAQZ,EAAQ,GAAG,IAAIplC,GAAG+W,IAAI4sB,EAAMC,EAAMC,GAAOnH,GACrDiH,EAAO7+D,SAAS,GAAKk7B,GAAG+7B,IAAIW,EAAaj8E,EAAGulF,EAAMvlF,EAAGskF,IACrDnB,EAAO9+D,SAAS,GAAKk7B,GAAG+7B,IAAIW,EAAah0C,EAAGs9C,EAAMt9C,EAAGq8C,IACrDlB,EAAO/+D,SAAS,GAAKk7B,GAAG+7B,IAAIW,EAAazqF,EAAG+zF,EAAM/zF,EAAG8yF,IAajE,IARAvI,EAAQt2B,OACRs2B,EAAQ/b,YAAc,QAAUkjB,EAAO,KAAOC,EAAO,KAAOC,EAAO,KAAO3G,EAAiB,IAC3FV,EAAQpc,UAAY4c,EAEpBR,EAAQza,YACRya,EAAQxa,OAAO6iB,EAAOC,GACtBtI,EAAQva,OAAO3vE,EAAGC,GAEb5f,EAAI,EAAGA,EAAI8oE,EAAOxrE,OAAQ0C,IAC3Bsf,EAAIwpD,EAAO9oE,GAAG,GAAK8oE,EAAO/qC,GAAO,GACjCr0B,EAAIo/D,EAAO9oE,GAAG,GAAK8oE,EAAO/qC,GAAO,GACjCg4B,EAAIz2C,EAAIA,EAAI5V,EAAIA,EACZqsD,EAAI,IAAOs8C,EAAeA,IApKlCC,IACoE,GAA7DrzG,KAAKy6D,IAAI,aAAez6D,KAAKu6D,IAAkB,UAAd84C,IAAkC,GAmKfv8C,EAAI,IAAOs8C,EAAeA,KAC7ExI,EAAQxa,OAAOvmB,EAAO/qC,GAAO,GAAU,GAAJze,EAAUwpD,EAAO/qC,GAAO,GAAU,GAAJr0B,GACjEmgG,EAAQva,OAAOxmB,EAAO9oE,GAAG,GAAU,GAAJsf,EAAUwpD,EAAO9oE,GAAG,GAAU,GAAJ0J,IAIjEmgG,EAAQta,SACRsa,EAAQj2B,UAGR71C,IACAm0E,EAAQvyF,EACRwyF,EAAQvyF,EACRgrF,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdkqF,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,SACRzxB,OAAQ,CAAC8rD,EAAKC,EAAKh2C,EAAU,CAAChvC,EAAGkjF,EAAMj7C,EAAGk7C,EAAM3xF,EAAG4xF,OAG3D5vG,KAAKirG,QAAU,WACX1mC,GAAY,EACZ9nC,EAAQ,EACR+qC,EAAS,GACLghC,IACAA,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,KAEZmjD,EAAQxiG,KAAKoiG,GACbA,OAAe1lG,IAIvB9C,KAAKkrG,gBAAkB,SAAUn8D,EAAIE,EAAIwgC,EAAIzH,GAIzC,GAHAshC,EAAUjrF,EAAIoxD,EACd65B,EAAUhrF,EAAI0pD,EAEVzD,QAAoBzhE,IAAPisC,EACb,OAIJw5D,EAAQt2B,OACRs2B,EAAQpc,UAAY4c,EAEpB,IAAI2G,EAAOjH,EAAaj8E,EAAGmjF,EAAOlH,EAAah0C,EAAGm7C,EAAOnH,EAAazqF,EACtE,GAAI+wB,EAAK,GAAK,GAAKE,EAAK,GAAK,GAAKF,EAAK,EAAIw5D,EAAQ11C,OAAOf,MAAQ,GAAK7iB,EAAK,EAAIs5D,EAAQ11C,OAAOd,OAAS,EAAG,CACvG29C,EAAO,EACPC,EAAO,EACPC,EAAO,EACP,IAAI8B,EAAO/zG,KAAK+O,IAAI67F,EAAQ11C,OAAOf,MAAQ,EAAGn0D,KAAK6O,IAAI,EAAGuiC,EAAK,IAC3D4iE,EAAOh0G,KAAK+O,IAAI67F,EAAQ11C,OAAOd,OAAS,EAAGp0D,KAAK6O,IAAI,EAAGyiC,EAAK,IAC5D2iE,EAAOj0G,KAAK+O,IAAI67F,EAAQ11C,OAAOf,MAAQ,EAAGn0D,KAAK6O,IAAI,EAAGuiC,EAAK,IAC3D8iE,EAAOl0G,KAAK+O,IAAI67F,EAAQ11C,OAAOd,OAAS,EAAGp0D,KAAK6O,IAAI,EAAGyiC,EAAK,IAGhE,GAFA2iE,GAAQF,EACRG,GAAQF,EACJC,EAAO,GAAKC,EAAO,EAAG,CACtB,IAAIjgD,EAAIj0D,KAAK+O,IAAI85F,GAAa10C,MAAO8/C,GACjC//C,EAAIl0D,KAAK+O,IAAI85F,GAAaz0C,OAAQ8/C,GACtCpL,GAAUx0B,OACVw0B,GAAU5yB,yBAA2B,OACrC4yB,GAAUj1B,UAAU+2B,EAAQ11C,OAAQ6+C,EAAMC,EAAMC,EAAMC,EAAM,EAAG,EAAGjgD,EAAGC,GACrE40C,GAAUn0B,UAEV,IAAI+B,EAAQoyB,GAAUnyB,aAAao9B,EAAMC,EAAMC,EAAMC,GACjDC,EAAW,EACf,IAAK,IAAI/1G,EAAI,EAAGA,EAAIs4E,EAAMplE,KAAKjT,OAAQD,GAAK,EACxC2zG,GAAQr7B,EAAMplE,KAAKlT,EAAI,GACvB4zG,GAAQt7B,EAAMplE,KAAKlT,EAAI,GACvB6zG,GAAQv7B,EAAMplE,KAAKlT,EAAI,GACvB+1G,IAEJpC,GAAQoC,EACRnC,GAAQmC,EACRlC,GAAQkC,GAGhB,IAAIC,EAAQZ,EAAQ,GAAG,IAAIplC,GAAG+W,IAAI4sB,EAAMC,EAAMC,GAAOnH,GACrDiH,EAAO7+D,SAAS,IAAMigE,EAAkBiB,EAAMvlF,EAAIi8E,EAAaj8E,GAAK,EAAIskF,KACxEnB,EAAO9+D,SAAS,IAAMigE,EAAkBiB,EAAMt9C,EAAIg0C,EAAah0C,GAAK,EAAIq8C,KACxElB,EAAO/+D,SAAS,IAAMigE,EAAkBiB,EAAM/zF,EAAIyqF,EAAazqF,GAAK,EAAI8yF,KACxEvI,EAAQ/b,YAAc,QAAUkjB,EAAO,KAAOC,EAAO,KAAOC,EAAO,KAAO3G,EAAiB,IAC3FV,EAAQza,YACRya,EAAQxa,OAAOh/C,EAAIE,GACnBs5D,EAAQva,OAAOve,EAAIzH,GACnBugC,EAAQta,SACRsa,EAAQ/b,YAAc,QAAUkjB,EAAO,KAAOC,EAAO,KAAOC,EAAO,KAAO3G,EAAiB,IAC3FV,EAAQj2B,UAGR,IAAIk5B,EAAe,CACfV,KAAM,CAAC,QAAS,gBAChBC,QAAS,IAEbS,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACsrD,KAEbvF,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACsjD,EAAc,KAE3ByC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACwjD,KAEbuC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACgjD,KAEb+C,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,cACRzxB,OAAQ,CAACqrD,KAGbtF,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAAC1W,EAAIE,EAAIwgC,EAAIzH,KAEzB4gC,EAAQxiG,KAAKolG,IAGjBxrG,KAAKukE,UAAY,WACb,OAAOA,0BI1TX,IAAIgkC,EAEAC,EAEAC,EACAC,EAMAC,EAWAqJ,EArBApJ,EAA8B,IAAIC,GAAGC,eAGvBC,EAAc,GAAKC,EAAiB,GAAKC,EAAiB,EAExEC,GAAyB,EAAMC,GAA4B,EAC3DC,GAAwB,EACxB6I,GAAkB,EAClBC,GAAmB,EAGnB5I,EAAY,CAACjrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GACnC+tC,EAAa,CAAClrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GAEpC+I,GAAY,EACZqlC,EAAa,KAIbuI,GAHQx0G,KAAKuvC,GAGE6+B,GAAGlZ,OAAO,EAAG,IAC5Bu/C,EAAYD,EAAar/C,WAAW,MAEpCu/C,EAAY,CACZ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GAEJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,aAGCC,IACLF,EAAU5f,UAAU,EAAG,EAAG,EAAG,GAC7B4f,EAAU9sC,UAAY2sC,EAAkB,OAASvJ,EACjD,IAAK,IAAI3sG,EAAI,EAAGA,EAAI4B,KAAK6O,IAAI,EAAG7O,KAAK4jC,MAAM0nE,EAAiBoJ,EAAUr2G,SAAUD,IAC5Eq2G,EAAU7sC,SAAS8sC,EAAUt2G,GAAG,GAAIs2G,EAAUt2G,GAAG,GAAI,EAAG,GAE5Di2G,EAAgBzJ,EAAQgK,cAAcJ,EAAc,mBAgC/CK,EAAS1jE,EAAIE,EAAID,EAAIE,EAAIwjE,GAC9BlK,EAAQt2B,OAEJggC,GACA1J,EAAQjjC,UAAY4sC,EAAmBF,EAAgB,OAEnDzJ,EAAQ10B,yBADRu1B,EACmC,cAEA,oBAGvCb,EAAQjjC,UAAY4sC,EAAmBF,EAAgBtJ,EACnDU,IACAb,EAAQ10B,yBAA2B,gBAG3C00B,EAAQnc,YAAc8lB,EAAmB,EAAIjJ,EAE7Cn6D,EAAKnxC,KAAKyO,MAAM0iC,GAChBE,EAAKrxC,KAAKyO,MAAM4iC,GAChBD,EAAKpxC,KAAKyO,MAAM2iC,GAChBE,EAAKtxC,KAAKyO,MAAM6iC,GAEhB,IAAIkuB,EAAKx/D,KAAKghB,IAAIowB,EAAKD,GACnB4jE,EAAK5jE,EAAKC,EAAK,GAAI,EACnBquB,GAAMz/D,KAAKghB,IAAIswB,EAAKD,GACpB2jE,EAAK3jE,EAAKC,EAAK,GAAI,EACnBvyC,EAAMygE,EAAKC,OAEPq1C,EACAA,GAAY,EAEZlK,EAAQhjC,SAASz2B,EAAIE,EAAI,EAAG,GAE5BF,IAAOC,GAAMC,IAAOC,GANf,CAST,IAAIoyD,EAAK,EAAI3kG,EACT2kG,GAAMjkC,IACN1gE,GAAO0gE,EACPtuB,GAAM4jE,GAENrR,GAAMlkC,IACNzgE,GAAOygE,EACPnuB,GAAM2jE,GAIdpK,EAAQj2B,mBAGHsgC,EAAoBp7C,EAAIC,EAAIgZ,EAAIC,GAErC,IAAImiC,EA1EL,SAC8Br7C,EAAIC,EAAIgZ,EAAIC,EAAIlkE,GAC7C,IAAI2pD,EAAI4V,GAAGi6B,KAAKj/B,IAAI,CAChB1oD,EAAGqyD,EAAGryD,EAAIm5C,EAAGn5C,EACbC,EAAGoyD,EAAGpyD,EAAIk5C,EAAGl5C,IAEbw0F,EAAK/mC,GAAGi6B,KAAKj/B,IAAI,CACjB1oD,EAAGo5C,EAAGp5C,EAAIm5C,EAAGn5C,EACbC,EAAGm5C,EAAGn5C,EAAIk5C,EAAGl5C,IAEby0F,EAAKhnC,GAAGi6B,KAAKj/B,IAAI,CACjB1oD,EAAGqyD,EAAGryD,EAAIoyD,EAAGpyD,EACbC,EAAGoyD,EAAGpyD,EAAImyD,EAAGnyD,IAKjB,OAHS3gB,KAAKghB,IAAIotD,GAAGi6B,KAAKziC,MAAMpN,EAAG28C,GAAMn1G,KAAKuvC,IAAMvvC,KAAKuvC,GAChDvvC,KAAKghB,IAAIotD,GAAGi6B,KAAKziC,MAAMpN,EAAG48C,GAAMp1G,KAAKuvC,IAAMvvC,KAAKuvC,GAElDvvC,KAAK6O,IAAIu/D,GAAGi6B,KAAKh/B,KAAK7Q,EAAG28C,GAAK/mC,GAAGi6B,KAAKh/B,KAAK7Q,EAAG48C,IAAOvmG,EAyDtCwmG,CAAwBx7C,EAAIC,EAAIgZ,EAAIC,EAAI,IAE9DlZ,EAAGn5C,EAAI1gB,KAAKyO,MAAMorD,EAAGn5C,GACrBm5C,EAAGl5C,EAAI3gB,KAAKyO,MAAMorD,EAAGl5C,GACrBoyD,EAAGryD,EAAI1gB,KAAKyO,MAAMskE,EAAGryD,GACrBqyD,EAAGpyD,EAAI3gB,KAAKyO,MAAMskE,EAAGpyD,GAErB,IAAI0oD,EAAO+E,GAAG/E,KAAKxP,EAAGn5C,EAAGm5C,EAAGl5C,EAAGoyD,EAAGryD,EAAGqyD,EAAGpyD,GACxC,IAAKu0F,GAAmB7rC,EAAO,EAE3B,YADAwrC,EAASh7C,EAAGn5C,EAAGm5C,EAAGl5C,EAAGoyD,EAAGryD,EAAGqyD,EAAGpyD,GAAG,GAIrC,IAAIrC,EAAIte,KAAK6O,IAAI,EAAG7O,KAAK4jC,MAAMylC,EAAO,IAClC4I,EAAW,GACf,IAAK,IAAI7zE,EAAI,EAAGA,GAAKkgB,EAAGlgB,IAAK,CACzB,IAAI8zC,EAAI9zC,EAAIkgB,EACR7T,EAAIzK,KAAK67B,IAAI,EAAIqW,EAAG,GACpB7xB,EAAI,EAAI6xB,EAAIlyC,KAAK67B,IAAI,EAAIqW,EAAG,GAC5BzV,EAAI,EAAIz8B,KAAK67B,IAAIqW,EAAG,IAAM,EAAIA,GAC9BsmB,EAAIx4D,KAAK67B,IAAIqW,EAAG,GACpB+/B,EAASxpE,KAAK,CACViY,EAAGjW,EAAIovD,EAAGn5C,EAAIL,EAAIy5C,EAAGp5C,EAAI+b,EAAIq2C,EAAGpyD,EAAI83C,EAAIua,EAAGryD,EAC3CC,EAAGlW,EAAIovD,EAAGl5C,EAAIN,EAAIy5C,EAAGn5C,EAAI8b,EAAIq2C,EAAGnyD,EAAI63C,EAAIua,EAAGpyD,IAInD,IAAK,IAAI23C,EAAI,EAAGA,EAAIh6C,EAAGg6C,IACnBu8C,EACI70G,KAAK4jC,MAAMquC,EAAS3Z,GAAG53C,GACvB1gB,KAAK4jC,MAAMquC,EAAS3Z,GAAG33C,GACvB3gB,KAAK4jC,MAAMquC,EAAS3Z,EAAI,GAAG53C,GAC3B1gB,KAAK4jC,MAAMquC,EAAS3Z,EAAI,GAAG33C,IAC3B,YAKH0rF,EAAQ3rF,EAAGC,EAAGkT,EAAMquD,EAAStc,GAClCglC,EAAQt2B,OACJggC,GACA1J,EAAQjjC,UAAY4sC,EAAmBF,EAAgB,OAEnDzJ,EAAQ10B,yBADRu1B,EACmC,cAEA,oBAGvCb,EAAQjjC,UAAY4sC,EAAmBF,EAAgBtJ,EACnDU,IACAb,EAAQ10B,yBAA2B,gBAG3C00B,EAAQnc,YAAc8lB,EAAmB,EAAIryB,EAC7C0oB,EAAQhjC,SACJ5nE,KAAK4jC,MAAMljB,GAAKmT,GAChB7zB,KAAK4jC,MAAMjjB,GAAKkT,GAChB7zB,KAAK4jC,MAAa,EAAP/P,GACX7zB,KAAK4jC,MAAa,EAAP/P,IAEf+2E,EAAQj2B,mBAIH+3B,EAAahsF,EAAGC,EAAGkT,EAAMgqC,YASrBgvC,EAAY5kG,GACjB,IAAI6kG,EAAgB1+B,GAAG+7B,IAAIyB,EAAW/tC,SAAUA,EAAU51D,EAAIiqC,GAC1D66D,EAAezB,GAAkBE,EAA6BsB,EAAgBA,EAAiB,GAC/FE,EAAYhtG,KAAK6O,IAAI,GAAKu8F,GAAeG,EAAyBuB,EAAgB,IACtFT,EAAQpkG,EAAIyY,EAAGzY,EAAI0Y,EAAGqsF,EAAWD,EAAc9kG,EAAI29D,gBAG9C0vC,EAAgBC,GACrBN,EAAoBM,EAAW17C,GAAI07C,EAAWz7C,GAAIy7C,EAAWziC,GAAIyiC,EAAWxiC,IAGhF,GAnBmB,OAAfk5B,IACAA,EAAa,IAAI79B,GAAGu+B,WACpBV,EAAWlhF,IAAI4gF,EAAUjrF,EAAGirF,EAAUhrF,EAAG,GAAG,gBAIhDiqF,EAAQt2B,OAa4B,IAAhCt0E,KAAK4jC,MAAoB,EAAdwnE,GACD,OAAN1qF,EACAurF,EAAW54B,SAAS,EAAG,KAAMiiC,GAE7BrJ,EAAWlhF,IAAIrK,EAAGC,EAAG,EAAG,KAAM20F,OAG/B,CACH,IAAIrI,EAAep5E,EAAOw3E,EAEhB,OAAN3qF,EACAurF,EAAW54B,SAAS45B,EAAcJ,GAElCZ,EAAWlhF,IAAIrK,EAAGC,EAAGssF,EAAcJ,GAI3CjC,EAAQj2B,UAMZtyE,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7B8uC,EAAe,CACXsC,KAAM,CAAC,QAAS,cAChBC,QAAS,IAEbvC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACyjD,KAEbV,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACsjD,KAEbP,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACujD,KAEbR,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACwjD,KAEbT,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACgjD,KAEbD,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAAC2jD,KAEbZ,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,cACRzxB,OAAQ,CAACwsD,KAEbzJ,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACysD,KAGTA,GACAI,IAGJ54C,EAAI/7D,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGgtD,IAC5B,IAAIgxC,EAAevB,EAA6BF,EAAiBvvC,EAAIA,EAAKuvC,EACtE0B,EAAYzB,EAAyBvrG,KAAK6O,IAAI,GAAKktD,EAAIqvC,GAAeprG,KAAK6O,IAAI,GAAKu8F,GAExFxkC,GAAY,EACZylC,EAAQ3rF,EAAGC,EAAGqsF,EAAWD,GACzB/B,EAAkBgC,EAAY3B,EAC9BM,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdgrF,EAAU9tC,SAAW9B,EACrB6vC,EAAax9B,GAAG86B,QAAQyC,GAExBd,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,YACRzxB,OAAQ,CAACpnC,EAAGC,EAAGo7C,MAIvB15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,GAC1B,IAAK6K,EACD,OAEJikC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,SACRzxB,OAAQ,CAACpnC,EAAGC,EAAGo7C,KAMnB,IAAI8B,EAAWuQ,GAAGj/B,MAAM4sB,EAAG,EAAG,GAG9B2wC,EAAahsF,EAAGC,EAFA4qF,EAAyBvrG,KAAK6O,IAAI,GAAK88F,EAAU9tC,SAAWutC,GAAeprG,KAAK6O,IAAI,GAAKu8F,GAE3EO,EAAU9tC,UAExC+tC,EAAax9B,GAAG86B,QAAQyC,GACxBA,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdgrF,EAAU9tC,SAAWA,GAGzBx7D,KAAKirG,QAAU,SAAU5sF,EAAGC,GAGxB+rF,EAAa,KAAM,KADHnB,EAAyBvrG,KAAK6O,IAAI,GAAK88F,EAAU9tC,SAAWutC,GAAeprG,KAAK6O,IAAI,GAAKu8F,GACrEO,EAAU9tC,UAM9C+I,GAAY,EAEZqlC,EAAa,KAETpB,IACAA,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACpnC,EAAGC,KAEhBsqF,EAAQxiG,KAAKoiG,GACbA,OAAe1lG,IAIvB9C,KAAKkrG,gBAAkB,SAAUn8D,EAAIE,EAAIwgC,EAAIzH,GAKzC,GAJAshC,EAAUjrF,EAAIoxD,EACd65B,EAAUhrF,EAAI0pD,EACdshC,EAAU9tC,SAAW,EAEjB+I,QAAoBzhE,IAAPisC,EACb,OAOJ,GAJImjE,GACAI,IAGgC,IAAhC30G,KAAK4jC,MAAoB,EAAdwnE,GACXyJ,EAASzjE,EAAIE,EAAIwgC,EAAIzH,GAAI,OACtB,CACS+D,GAAG8gB,iBAAiB,CAACxuE,EAAG0wB,EAAIzwB,EAAG2wB,GAAK,CAAC5wB,EAAGoxD,EAAInxD,EAAG0pD,IAA3D,IAIImjC,EAHAC,EAAYztG,KAAKkhB,KAAKlhB,KAAK67B,IAAIi2C,EAAK1gC,EAAI,GAAOpxC,KAAK67B,IAAIwuC,EAAK/4B,EAAI,IACjEo8D,GAAM57B,EAAK1gC,GAAMq8D,EACjBE,GAAMtjC,EAAK/4B,GAAMm8D,EAEjBG,EAAQxC,EAAcC,EAE1B,IADAL,EAAkBI,EAAcC,EAC3BmC,EAAWxC,EAAiBwC,GAAYC,EAAWD,GAAYI,EAChEvB,EAAQj7D,EAAKs8D,EAAKF,EAAUl8D,EAAKq8D,EAAKH,EAAUpC,EAAaE,GAIrE,IAAIuC,EAAe,CACfV,KAAM,CAAC,QAAS,cAChBC,QAAS,IAEbS,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACyjD,KAEbsC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACsjD,KAEbyC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACujD,KAEbwC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACwjD,KAEbuC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,WACRzxB,OAAQ,CAACgjD,KAEb+C,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAAC2jD,KAEboC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,cACRzxB,OAAQ,CAACwsD,KAEbzG,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACysD,KAGb1G,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAAC1W,EAAIE,EAAIwgC,EAAIzH,KAEzB4gC,EAAQxiG,KAAKolG,IAIjBxrG,KAAKukE,UAAY,WACb,OAAOA,GAGXvkE,KAAK4lF,SAAW,SAAUxrD,GAClBquE,IAAiBruE,IAGrBquE,EAAeruE,EACfsuE,EAAkB,OAASD,EAAaj8E,EAAI,IAAMi8E,EAAah0C,EAAI,IAAMg0C,EAAazqF,EAAI,MAE9Fhe,KAAK0rG,WAAa,SAAUtxE,GACxBmuE,EAAUnuE,GAEdp6B,KAAK2rG,WAAa,SAAUp1B,GACxBqyB,EAAUryB,GAEdv2E,KAAK0wF,QAAU,SAAUt7B,GACrB2zC,EAAc3zC,GAElBp1D,KAAK4rG,WAAa,SAAUxhC,GACxB6+B,EAAiB7+B,GAErBpqE,KAAK6rG,WAAa,SAAUz2C,GACxB4zC,EAAiB5zC,GAErBp1D,KAAK8rG,aAAe,SAAU9tF,GAC1BkrF,EAAyBlrF,GAE7Bhe,KAAK+rG,gBAAkB,SAAU/tF,GAC7BmrF,EAA4BnrF,GAEhChe,KAAKgsG,aAAe,SAAUhuF,GAC1BorF,EAAwBprF,GAE5Bhe,KAAKmzG,YAAc,SAAUn1F,GACzBi0F,IAAoBj0F,GAExBhe,KAAKozG,aAAe,SAAUp1F,GAC1Bk0F,IAAqBl0F,GAGzBhe,KAAKisG,WAAa,WACd,OAAOjD,GAEXhpG,KAAKksG,QAAU,WACX,OAAOnD,GAEX/oG,KAAKmsG,WAAa,WACd,OAAOlD,GAEXjpG,KAAKosG,aAAe,WAChB,OAAOhD,GAEXppG,KAAKqzG,YAAc,WACf,OAAOpB,GAEXjyG,KAAKszG,aAAe,WAChB,OAAOpB,qBCrcXqB,2BAA4Bl1F,EAAGC,GAC3B,IAAIi8C,EAAS,CAAExrB,GAAI1wB,EAAG4wB,GAAI3wB,EAAGmxD,GAAIpxD,EAAG2pD,GAAI1pD,GACpCte,KAAKwzG,mBACLj5C,EAASwR,GAAGwgC,aACRhyC,EACA,CACIxrB,IAAK1wB,EAAIre,KAAKyzG,WAAW3hD,MACzB7iB,GAAI3wB,EACJmxD,IAAKpxD,EAAIre,KAAKyzG,WAAW3hD,MACzBkW,GAAI1pD,KAIZte,KAAK0zG,mBACLn5C,EAASwR,GAAGwgC,aACRhyC,EACA,CACIxrB,GAAI1wB,EACJ4wB,IAAK3wB,EAAIte,KAAKyzG,WAAW1hD,OACzB0d,GAAIpxD,EACJ2pD,IAAK1pD,EAAIte,KAAKyzG,WAAW1hD,UAIrC,MAAM13B,EAA8B,WAArBr6B,KAAK2zG,YAA2B3zG,KAAK+oG,YAAc,EAAI,EACtExuC,EAAOxrB,GAAKpxC,KAAKyO,MAAMmuD,EAAOxrB,GAAK1U,GACnCkgC,EAAOtrB,GAAKtxC,KAAKyO,MAAMmuD,EAAOtrB,GAAK5U,GACnCkgC,EAAOkV,GAAK9xE,KAAKuO,KAAKquD,EAAOkV,GAAKp1C,GAClCkgC,EAAOyN,GAAKrqE,KAAKuO,KAAKquD,EAAOyN,GAAK3tC,GAElCr6B,KAAK4zG,qBAAuB7nC,GAAGwgC,aAAavsG,KAAK4zG,qBAAsBr5C,GAGnEs5C,YACJ7zG,KAAKuoG,QAAQt2B,OACbjyE,KAAKuoG,QAAQ/V,UAAU,EAAG,EAAGxyF,KAAKuoG,QAAQ11C,OAAOf,MAAO9xD,KAAKuoG,QAAQ11C,OAAOd,QAC5E/xD,KAAKuoG,QAAQ/2B,UAAUxxE,KAAKyzG,WAAY,EAAG,GAE3C,IAAI1wB,EAAQ,IAAI/iF,KAAKyoG,cAgBrB,GAfIzoG,KAAKiyG,iBACLlvB,EAAMv2D,EAAI,IACVu2D,EAAMtuB,EAAI,IACVsuB,EAAM/kE,EAAI,IACNhe,KAAKopG,sBACLppG,KAAKuoG,QAAQ10B,yBAA2B,cAExC7zE,KAAKuoG,QAAQ10B,yBAA2B,mBAGxC7zE,KAAKopG,wBACLppG,KAAKuoG,QAAQ10B,yBAA2B,eAI5C7zE,KAAKstD,KAAM,CAGX,MAAMA,EAAO,IAAIwmD,OACjB9zG,KAAKstD,KAAKjtB,SAAO,CAAE1X,EAAM/b,KACP,IAAVA,EACA0gD,EAAKygC,OAAOplE,EAAKtK,EAAGsK,EAAKrK,GAEzBgvC,EAAK0gC,OAAOrlE,EAAKtK,EAAGsK,EAAKrK,MAIjC,IAAI1I,EAAiCm2D,GAAGkX,eAAepY,UAAU,CAC7Dr+C,EAAGu2D,EAAMv2D,EACTioC,EAAGsuB,EAAMtuB,EACTz2C,EAAG+kE,EAAM/kE,EACT5V,EAAGpI,KAAKipG,iBAEZ,GAAIjpG,KAAK+zG,gBAAiB,CACtB,MAAMC,EAAah0G,KAAKstD,KAAK,GAAGjvC,EAAIre,KAAKstD,KAAKttD,KAAKstD,KAAKtxD,OAAS,GAAGqiB,EAC9D41F,EAAWj0G,KAAKuoG,QAAQlkB,qBAC1B,EAAG2vB,EAAah0G,KAAKk0G,KAAOl0G,KAAKm0G,KACjC,EAAGH,EAAah0G,KAAKm0G,KAAOn0G,KAAKk0G,MAErCD,EAASxvB,aACL,EACA1Y,GAAGkX,eAAepY,UAAU,CACxBr+C,EAAGu2D,EAAMv2D,EACTioC,EAAGsuB,EAAMtuB,EACTz2C,EAAG+kE,EAAM/kE,EACT5V,EAAGpI,KAAKipG,kBAGhBgL,EAASxvB,aACL,EACA1Y,GAAGkX,eAAepY,UAAU,CACxBr+C,EAAGu2D,EAAMv2D,EACTioC,EAAGsuB,EAAMtuB,EACTz2C,EAAG+kE,EAAM/kE,EACT5V,EAAG,KAGXwN,EAAQq+F,EAIa,SAArBj0G,KAAK2zG,YACL3zG,KAAKuoG,QAAQjjC,UAAY1vD,GAGzB5V,KAAKuoG,QAAQpc,UAA+B,EAAnBnsF,KAAK+oG,YAC9B/oG,KAAKuoG,QAAQ6L,SAAW,QACxBp0G,KAAKuoG,QAAQ/b,YAAc52E,GAI/B,MAAMy+F,EAAI,KACmB,SAArBr0G,KAAK2zG,YACL3zG,KAAKuoG,QAAQna,KAAK9gC,GAElBttD,KAAKuoG,QAAQta,OAAO3gC,IAI5B+mD,IACIr0G,KAAKwzG,mBACLxzG,KAAKuoG,QAAQt2B,OACbjyE,KAAKuoG,QAAQn2B,UAAUpyE,KAAKuoG,QAAQ11C,OAAOf,MAAQ,EAAG,GACtD9xD,KAAKuoG,QAAQh7D,OAAM,EAAI,GACvBvtC,KAAKuoG,QAAQn2B,WAAWpyE,KAAKuoG,QAAQ11C,OAAOf,MAAQ,EAAG,GACvDuiD,IACAr0G,KAAKuoG,QAAQj2B,WAEbtyE,KAAK0zG,mBACL1zG,KAAKuoG,QAAQt2B,OACbjyE,KAAKuoG,QAAQn2B,UAAU,EAAGpyE,KAAKuoG,QAAQ11C,OAAOd,OAAS,GACvD/xD,KAAKuoG,QAAQh7D,MAAM,GAAG,GACtBvtC,KAAKuoG,QAAQn2B,UAAU,GAAIpyE,KAAKuoG,QAAQ11C,OAAOd,OAAS,GACxDsiD,IACAr0G,KAAKuoG,QAAQj2B,UACTtyE,KAAKwzG,mBACLxzG,KAAKuoG,QAAQt2B,OACbjyE,KAAKuoG,QAAQn2B,UAAUpyE,KAAKuoG,QAAQ11C,OAAOf,MAAQ,EAAG9xD,KAAKuoG,QAAQ11C,OAAOd,OAAS,GACnF/xD,KAAKuoG,QAAQh7D,OAAM,GAAI,GACvBvtC,KAAKuoG,QAAQn2B,WAAWpyE,KAAKuoG,QAAQ11C,OAAOf,MAAQ,GAAI9xD,KAAKuoG,QAAQ11C,OAAOd,OAAS,GACrFsiD,IACAr0G,KAAKuoG,QAAQj2B,YAKzBtyE,KAAKuoG,QAAQj2B,UAOjBq5B,WAAY95C,GACR7xD,KAAK4oG,QAAU/2C,EAGnBq6C,UACI,MAA4B,WAArBlsG,KAAK2zG,YAA2B3zG,KAAK+oG,YAAc,EAG9DrY,QAASt7B,GACLp1D,KAAK+oG,YAAc3zC,EAGvB+2C,aACI,OAAOnsG,KAAKipG,eAGhB2C,WAAYxhC,GACRpqE,KAAKipG,eAAiB7+B,EAG1Bwb,SAAUxrD,GACNp6B,KAAKyoG,aAAe18B,GAAG86B,QAAQzsE,GAGnCsxE,WAAYtxE,GACRp6B,KAAKuoG,QAAUnuE,EAGnBk6E,QAASjuG,GACLrG,KAAK2zG,YAActtG,EAGvBkuG,UACI,OAAOv0G,KAAK2zG,YAGhBa,WAAYC,GACRz0G,KAAK00G,eAAiB3oC,GAAGj/B,MAAM2nE,EAAS,EAAG,GAG/CE,aACI,OAAO30G,KAAK00G,eAGhBE,aAAc52F,GACVhe,KAAKwzG,mBAAqBx1F,EAG9B62F,eACI,OAAO70G,KAAKwzG,iBAGhBsB,aAAc92F,GACVhe,KAAK0zG,mBAAqB11F,EAG9B+2F,eACI,OAAO/0G,KAAK0zG,iBAGhBsB,YAAah3F,GACThe,KAAK+zG,kBAAoB/1F,EAG7Bi3F,cACI,OAAOj1G,KAAK+zG,gBAGhB3H,eACI,OAAOpsG,KAAKopG,sBAGhB4C,aAAchuF,GACVhe,KAAKopG,wBAA0BprF,EAGnCq1F,cACI,OAAOrzG,KAAKiyG,gBAGhBkB,YAAan1F,GACThe,KAAKiyG,kBAAoBj0F,EAG7BwmD,eACI,OAAOxkE,KAAKukE,UAGhBsmC,UAAWxsF,EAAWC,GAClBte,KAAKukE,WAAY,EACjBvkE,KAAKstD,KAAO,CAAC,GAACjvC,IAAGC,IACjBte,KAAKk0G,KAAO51F,EACZte,KAAKm0G,KAAO71F,EACZte,KAAKyzG,WAAa1nC,GAAGlZ,OAAO7yD,KAAKuoG,QAAQ11C,OAAOf,MAAO9xD,KAAKuoG,QAAQ11C,OAAOd,QAC3E/xD,KAAKyzG,WAAW3gD,WAAW,MAAM0e,UAAUxxE,KAAKuoG,QAAQ11C,OAAQ,EAAG,GACnE7yD,KAAK4zG,qBAAuB,KAC5B5zG,KAAKuzG,2BAA2Bl1F,EAAGC,GAGvC0sF,OAAQ3sF,EAAWC,GACf,IAAKte,KAAKukE,UACN,OAGJ,IAAInzC,EAAM,GAAE/S,IAAGC,GACXte,KAAK00G,eAAiB,IACtBtjF,EAAI/S,IAAM1gB,KAAKC,SAAW,IAAOoC,KAAK00G,eAAiB,GACvDtjF,EAAI9S,IAAM3gB,KAAKC,SAAW,IAAOoC,KAAK00G,eAAiB,IAG3D10G,KAAKk0G,KAAOv2G,KAAK+O,IAAI1M,KAAKk0G,KAAM9iF,EAAI9S,GACpCte,KAAKm0G,KAAOx2G,KAAK6O,IAAIxM,KAAKm0G,KAAM/iF,EAAI9S,GACpCte,KAAKstD,KAAKlnD,KAAKgrB,GACfpxB,KAAKuzG,2BAA2Bl1F,EAAGC,GACnCte,KAAK6zG,YAGT5I,UAGI,GAFAjrG,KAAKukE,WAAY,EACjBvkE,KAAK4zG,qBAAuB7nC,GAAGmpC,aAAal1G,KAAK4zG,qBAAsB5zG,KAAKyzG,WAAW3hD,MAAO9xD,KAAKyzG,WAAW1hD,QAC1G/xD,KAAKstD,KAAKtxD,OAAS,GAAKgE,KAAK4zG,qBAAsB,CACnD,MAAMuB,EAAgBppC,GAAGlZ,OACrB7yD,KAAK4zG,qBAAqBnkC,GAAKzvE,KAAK4zG,qBAAqB7kE,GAAK,EAC9D/uC,KAAK4zG,qBAAqB5rC,GAAKhoE,KAAK4zG,qBAAqB3kE,GAAK,GAE/CkmE,EAAcriD,WAAW,MACjC0e,UAAUxxE,KAAKuoG,QAAQ11C,QAAS7yD,KAAK4zG,qBAAqB7kE,IAAK/uC,KAAK4zG,qBAAqB3kE,IAEpGjvC,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,QAAS,cAChBC,QAAS,CACL,CACI7zB,OAAQ,YACRzxB,OAAQ,CACJ0vD,EACAn1G,KAAK4zG,qBAAqB7kE,GAC1B/uC,KAAK4zG,qBAAqB3kE,QAM9CjvC,KAAKstD,KAAO,KACZttD,KAAKyzG,WAAa,KAGtBjiC,UAAWnF,EAAuBhuD,EAAWC,GACzCte,KAAKuoG,QAAQt2B,OACbjyE,KAAKuoG,QAAQ/V,UAAUn0E,EAAGC,EAAG+tD,EAAGva,MAAOua,EAAGta,QAC1C/xD,KAAKuoG,QAAQ/2B,UAAUnF,EAAIhuD,EAAGC,GAC9Bte,KAAKuoG,QAAQj2B,UAGjB44B,gBAAiBn8D,EAAIE,EAAIwgC,EAAIzH,kBAzU1BhoE,KAIK+oG,YAAsB,IAJ3B/oG,KAKKipG,eAAyB,EAL9BjpG,KAMKopG,uBAAiC,EANtCppG,KAOKiyG,iBAA2B,EAPhCjyG,KAQK2zG,YAA0B,OAR/B3zG,KASK00G,eAAyB,EAT9B10G,KAUKwzG,kBAA4B,EAVjCxzG,KAWK0zG,kBAA4B,EAXjC1zG,KAYK+zG,iBAA2B,EAZhC/zG,KAcKukE,WAAqB,sBJyQ7B8nC,mBAAmB9xC,GACfv6D,KAAKssG,aAAevgC,GAAGwgC,aAAavsG,KAAKssG,aAAc/xC,GAG3Dg5C,2BAA4BxkE,EAAIE,EAAIwgC,EAAIzH,GACpChoE,KAAK4zG,qBAAuB7nC,GAAGwgC,aAC3BvsG,KAAK4zG,qBACL,IAAE7kE,KAAIE,KAAIwgC,KAAIzH,IAOtBulC,iBAEI,MAAMT,EAAe9sG,KAAKo1G,YAAY90E,KAAI3X,IAAQ,IAE5C4xC,EAAoB,GACpBwyC,EAASpvG,KAAKuO,KAAKlM,KAAKq1G,cAAcvjD,MA9RlC,KAgSL9xD,KAAKssG,eAGV/xC,EAAOn0D,KAAK,CACR2oC,GAAIpxC,KAAKyO,MAAMpM,KAAKssG,aAAav9D,GApS3B,KAqSNE,GAAItxC,KAAKyO,MAAMpM,KAAKssG,aAAar9D,GArS3B,KAsSNwgC,GAAI9xE,KAAKyO,MAAMpM,KAAKssG,aAAa78B,GAtS3B,KAuSNzH,GAAIrqE,KAAKyO,MAAMpM,KAAKssG,aAAatkC,GAvS3B,OAySVzN,EAAOl6B,SAAQ1X,IACX,IAAK,IAAI5sB,EAAI4sB,EAAKomB,GAAIhzC,GAAK4sB,EAAK8mD,GAAI1zE,IAChC,IAAK,IAAI2C,EAAIiqB,EAAKsmB,GAAIvwC,GAAKiqB,EAAKq/C,GAAItpE,IAChCouG,EAAapuG,EAAIquG,EAAShxG,IAAK,KAK3C+wG,EAAazsE,SAAO,CAAE1X,EAAM5sB,KACxB,IAAK4sB,GAAQ3oB,KAAKo1G,YAAYr5G,GAE1B,OAEJiE,KAAKo1G,YAAYr5G,IAAK,EACtB,MAAMsiB,EAAItiB,EAAIgxG,EACRzuF,EAAI3gB,KAAKyO,MAAMrQ,EAAIgxG,GACnBn7C,GAAKj0D,KAAK+O,IAzTV,IAyTc2R,EAzTd,IAyTyCre,KAAKq1G,cAAcvjD,OAAS,GAzTrE,IAyTsF,EACtFD,GAAKl0D,KAAK+O,IA1TV,IA0Tc4R,EA1Td,IA0TyCte,KAAKq1G,cAActjD,QAAU,GA1TtE,IA0TuF,EAIvFy7C,EADYzhC,GAAGlZ,OAAOjB,EAAGC,GACNiB,WAAW,MACpC06C,EAAOh8B,UAAUxxE,KAAKuoG,QAAQ11C,OA/TxB,KA+TiCx0C,EA/TjC,KA+TiDC,GAEvD,MAAMrP,EAAOu+F,EAAOl5B,aAAa,EAAG,EAAG1iB,EAAGC,GAE1C,IAAK,IAAIoE,EAAI,EAAGA,EAAIpE,EAAGoE,IACnB,IAAK,IAAIv3D,EAAI,EAAG2iG,EAAKprC,EAAIrE,EAAI,EAAG0vC,EAAwE,IApUtG,IAoUqChjF,EAAgB23C,GAAKj2D,KAAKq1G,cAAcvjD,MApU7E,IAoUqFzzC,GAAoB3f,EAAIkzD,EAAGlzD,IAAK2iG,GAAM,EAAGC,GAAM,EAClIthG,KAAKq1G,cAAcpmG,KAAKqyF,GAAMryF,EAAKA,KAAKoyF,GACxCrhG,KAAKq1G,cAAcpmG,KAAKqyF,EAAK,GAAKryF,EAAKA,KAAKoyF,EAAK,GACjDrhG,KAAKq1G,cAAcpmG,KAAKqyF,EAAK,GAAKryF,EAAKA,KAAKoyF,EAAK,GACjDrhG,KAAKq1G,cAAcpmG,KAAKqyF,EAAK,GAAKryF,EAAKA,KAAKoyF,EAAK,OAcjE0M,QAAS1vF,EAAWC,EAAWkT,EAAcquD,GACzC,IAAK7/E,KAAKgwE,QAKN,YAJAhwE,KAAKgwE,QAAU,CACX3xD,EAAGA,EACHC,EAAGA,IAKXkT,EAAO7zB,KAAK4jC,MAAM/P,GAGlB,MAAMogC,EAAIj0D,KAAK4jC,MAAa,EAAP/P,GACfqgC,EAAIl0D,KAAK4jC,MAAa,EAAP/P,GAEf+oC,EA5UX,SAEC+6C,EACAC,EACArO,EACAC,EACA31E,GAOA,GAAI01E,EAAG7oF,IAAM8oF,EAAG9oF,GAAK6oF,EAAG5oF,IAAM6oF,EAAG7oF,EAC7B,OAAO,KAGX4oF,EAAKn7B,GAAG86B,QAAQK,GAChBC,EAAKp7B,GAAG86B,QAAQM,GAChB31E,EAAOu6C,GAAG86B,QAAQr1E,GAKlB,CACI,IAAI+hC,EAAM,EACNx4C,EAAQ,EACR69D,EAAS,EACT99D,EAAO,EAkCX,GAhCIosF,EAAG7oF,EAAI,IACPvD,GAAQosF,EAAG7oF,GAEX6oF,EAAG5oF,EAAI,IACPi1C,GAAO2zC,EAAG5oF,GAEV6oF,EAAG9oF,EAAI,IACPvD,EAAOnd,KAAK6O,IAAIsO,GAAOqsF,EAAG9oF,IAE1B8oF,EAAG7oF,EAAI,IACPi1C,EAAM51D,KAAK6O,IAAI+mD,GAAM4zC,EAAG7oF,IAExB4oF,EAAG7oF,EAAImT,EAAKogC,EAAI0jD,IAChBv6F,EAAQmsF,EAAG7oF,EAAImT,EAAKogC,EAAI0jD,GAExBpO,EAAG5oF,EAAIkT,EAAKqgC,EAAI0jD,IAChB38B,EAASsuB,EAAG5oF,EAAIkT,EAAKqgC,EAAI0jD,GAEzBpO,EAAG9oF,EAAImT,EAAKogC,EAAI0jD,IAChBv6F,EAAQpd,KAAK6O,IAAIuO,EAAOosF,EAAG9oF,EAAImT,EAAKogC,EAAI0jD,IAExCnO,EAAG7oF,EAAIkT,EAAKqgC,EAAI0jD,IAChB38B,EAASj7E,KAAK6O,IAAIosE,EAAQuuB,EAAG7oF,EAAIkT,EAAKqgC,EAAI0jD,IAG9CrO,EAAG7oF,GAAKvD,EACRqsF,EAAG9oF,GAAKvD,EACRosF,EAAG5oF,GAAKi1C,EACR4zC,EAAG7oF,GAAKi1C,EAER/hC,EAAKogC,EAAIpgC,EAAKogC,EAAI92C,EAAOC,EACzByW,EAAKqgC,EAAIrgC,EAAKqgC,EAAI0B,EAAMqlB,EACpBpnD,EAAKogC,GAAK,GAAKpgC,EAAKqgC,GAAK,EACzB,OAAO,KAIf,MAAO,CACHq1C,GAAI,CACA7oF,EAAG6oF,EAAG7oF,EACNC,EAAG4oF,EAAG5oF,GAEV6oF,GAAI,CACA9oF,EAAG8oF,EAAG9oF,EACNC,EAAG6oF,EAAG7oF,GAEVkT,KAAM,CACFogC,EAAGpgC,EAAKogC,EACRC,EAAGrgC,EAAKqgC,IA8PG2jD,CACXx1G,KAAKq1G,cAAcvjD,MACnB9xD,KAAKq1G,cAActjD,OACnB,CACI1zC,EAAG1gB,KAAK4jC,MAAMvhC,KAAKgwE,QAAQ3xD,EAAImT,GAC/BlT,EAAG3gB,KAAK4jC,MAAMvhC,KAAKgwE,QAAQ1xD,EAAIkT,IAEnC,CACInT,EAAG1gB,KAAK4jC,MAAMljB,EAAImT,GAClBlT,EAAG3gB,KAAK4jC,MAAMjjB,EAAIkT,IAEtB,GACIogC,IACAC,IAIR,GAAI0I,EAAQ,CACR,MAAM9U,EAAwB,CAC1ByhD,GAAI3sC,EAAO2sC,GACXC,GAAI5sC,EAAO4sC,GACX31E,KAAM+oC,EAAO/oC,KACbs1E,MAAO,CACH33B,OAAQ,GAAE9wD,IAAGC,QACbkT,UACAquD,EACAkoB,UAAW/nG,KAAKopG,wBAGxBppG,KAAKqsG,mBAAmB,CACpBt9D,GAAI0W,EAAO0hD,GAAG9oF,EACd4wB,GAAIwW,EAAO0hD,GAAG7oF,EACdmxD,GAAIhqB,EAAO0hD,GAAG9oF,EAAwB,EAApBonC,EAAOqhD,MAAMt1E,KAC/Bw2C,GAAIviB,EAAO0hD,GAAG7oF,EAAwB,EAApBmnC,EAAOqhD,MAAMt1E,OAEnCxxB,KAAKovG,WAAWhpG,KAAKq/C,GAGzBzlD,KAAKgwE,QAAU,CACX3xD,EAAGA,EACHC,EAAGA,GAIX+rF,aAAchsF,EAAWC,EAAWkT,EAAcgqC,GAC9Cx7D,KAAKovG,WAAa,GAEM,OAApBpvG,KAAK4pG,aACL5pG,KAAK4pG,WAAa,IAAI79B,GAAGu+B,WACzBtqG,KAAK4pG,WAAWlhF,IAAI1oB,KAAKspG,UAAUjrF,EAAGre,KAAKspG,UAAUhrF,EAAG,GAAG,gBAG/D,MAAMisF,EAAU,GAEVC,EAAe5kG,IACjB,MAAM6kG,EAAgB1+B,GAAG+7B,IAAI9nG,KAAKupG,WAAW/tC,SAAUA,EAAU51D,EAAIiqC,GAC/D66D,EAAe1qG,KAAKipG,gBAAkBjpG,KAAKmpG,0BAA6BsB,EAAgBA,EAAiB,GACzGE,EAAYhtG,KAAK6O,IAAI,GAAKxM,KAAK+oG,aAAe/oG,KAAKkpG,uBAAyBuB,EAAgB,IAClGF,EAAQnkG,KAAK,CAACR,EAAIyY,EAAGzY,EAAI0Y,EAAGqsF,EAAWD,EAAc9kG,EAAI29D,SAGvDqnC,EAAep5E,EAAOxxB,KAAKgpG,eAAiB,EAQlD,IAAIiB,EAPM,OAAN5rF,EACAre,KAAK4pG,WAAW54B,SAAS45B,EAAcJ,GAEvCxqG,KAAK4pG,WAAWlhF,IAAIrK,EAAGC,EAAGssF,EAAcJ,GAK5C,IAAK,IAAIzuG,EAAI,EAAGA,EAAIwuG,EAAQvuG,OAAQD,IAAK,CACrC,MAAM4sB,EAAO4hF,EAAQxuG,GACrBiE,KAAK+tG,QAAQplF,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAC7CshF,EAASthF,EAGb3oB,KAAKutG,iBAEL,IAAK,IAAI52C,EAAI,EAAGA,EAAI32D,KAAKovG,WAAWpzG,OAAQ26D,IACxC+vC,GAAO1mG,KAAKq1G,cAAer1G,KAAKovG,WAAWz4C,IAUnDk0C,UAAWxsF,EAAWC,EAAWo7C,GAC7B15D,KAAKwrG,aAAe,CAChBV,KAAM,CAAC,QAAS,eAChBC,QAAS,IAGbrxC,EAAIqS,GAAGj/B,MAAM4sB,EAAG,EAAG,GACnB,MAAMgxC,EAAe1qG,KAAKmpG,0BAA6BnpG,KAAKipG,eAAiBvvC,EAAIA,EAAK15D,KAAKipG,eACrF0B,EAAY3qG,KAAKkpG,uBAAyBvrG,KAAK6O,IAAI,GAAKktD,EAAI15D,KAAK+oG,aAAeprG,KAAK6O,IAAI,GAAKxM,KAAK+oG,aAEzG/oG,KAAKgwE,QAAU,KACfhwE,KAAKukE,WAAY,EAEjBvkE,KAAKq1G,cAAgB,IAAII,UAAUz1G,KAAKuoG,QAAQ11C,OAAOf,MAAO9xD,KAAKuoG,QAAQ11C,OAAOd,QAClF,MAAM2+C,EAAa/yG,KAAKuO,KAAKlM,KAAKuoG,QAAQ11C,OAAOf,MA5cvC,KA4c4Dn0D,KAAKuO,KAAKlM,KAAKuoG,QAAQ11C,OAAOd,OA5c1F,KA6cV/xD,KAAKo1G,YAAc,IAAIzE,OAAOD,GAAYjuG,MAAM,IAAI69B,KAAI3X,IAAQ,IAEhE3oB,KAAK+tG,QAAQ1vF,EAAGC,EAAGqsF,EAAWD,GAE9B1qG,KAAK2oG,gBAAkBgC,EAAY3qG,KAAKgpG,eACxChpG,KAAKspG,UAAUjrF,EAAIA,EACnBre,KAAKspG,UAAUhrF,EAAIA,EACnBte,KAAKspG,UAAU9tC,SAAW9B,EAC1B15D,KAAKupG,WAAW/tC,SAAW9B,EAE3B15D,KAAK4zG,qBAAuB,KAGhC5I,OAAQ3sF,EAAWC,EAAWo7C,GAC1B,IAAK15D,KAAKukE,UACN,OAGJvkE,KAAKssG,aAAe,KACpB,MAAM9wC,EAAWuQ,GAAGj/B,MAAM4sB,EAAG,EAAG,GAC1BixC,EAAY3qG,KAAKkpG,uBACnBvrG,KAAK6O,IAAI,GAAKxM,KAAKspG,UAAU9tC,SAAWx7D,KAAK+oG,aAAeprG,KAAK6O,IAAI,GAAKxM,KAAK+oG,aAEnF/oG,KAAKqqG,aAAahsF,EAAGC,EAAGqsF,EAAW3qG,KAAKspG,UAAU9tC,UAG9Cx7D,KAAKssG,eACLtsG,KAAKuoG,QAAQh0B,aACTv0E,KAAKq1G,cACL,EACA,EACAr1G,KAAKssG,aAAav9D,GAClB/uC,KAAKssG,aAAar9D,GAClBjvC,KAAKssG,aAAa78B,GAAKzvE,KAAKssG,aAAav9D,GAAK,EAC9C/uC,KAAKssG,aAAatkC,GAAKhoE,KAAKssG,aAAar9D,GAAK,GAElDjvC,KAAKuzG,2BACDvzG,KAAKssG,aAAav9D,GAClB/uC,KAAKssG,aAAar9D,GAClBjvC,KAAKssG,aAAa78B,GAClBzvE,KAAKssG,aAAatkC,KAI1BhoE,KAAKspG,UAAUjrF,EAAIA,EACnBre,KAAKspG,UAAUhrF,EAAIA,EACnBte,KAAKupG,WAAW/tC,SAAWx7D,KAAKspG,UAAU9tC,SAC1Cx7D,KAAKspG,UAAU9tC,SAAWA,EAG9ByvC,UACIjrG,KAAKssG,aAAe,KACpB,MAAM3B,EAAY3qG,KAAKkpG,uBACnBvrG,KAAK6O,IAAI,GAAKxM,KAAKspG,UAAU9tC,SAAWx7D,KAAK+oG,aAAeprG,KAAK6O,IAAI,GAAKxM,KAAK+oG,aA0BnF,GAzBA/oG,KAAKuoG,QAAQt2B,OACbjyE,KAAKqqG,aAAa,KAAM,KAAMM,EAAW3qG,KAAKspG,UAAU9tC,UACxDx7D,KAAKuoG,QAAQj2B,UAEbtyE,KAAKukE,WAAY,EACjBvkE,KAAK4pG,WAAa,KAEd5pG,KAAKssG,eACLtsG,KAAKuoG,QAAQh0B,aACTv0E,KAAKq1G,cACL,EACA,EACAr1G,KAAKssG,aAAav9D,GAClB/uC,KAAKssG,aAAar9D,GAClBjvC,KAAKssG,aAAa78B,GAAKzvE,KAAKssG,aAAav9D,GAAK,EAC9C/uC,KAAKssG,aAAatkC,GAAKhoE,KAAKssG,aAAar9D,GAAK,GAElDjvC,KAAKuzG,2BACDvzG,KAAKssG,aAAav9D,GAClB/uC,KAAKssG,aAAar9D,GAClBjvC,KAAKssG,aAAa78B,GAClBzvE,KAAKssG,aAAatkC,KAItBhoE,KAAKwrG,cAAgBxrG,KAAK4zG,qBAAsB,CAChD,IAAI8B,EAA2C11G,KAAKq1G,cACpD,KACqC,IAAjCr1G,KAAK4zG,qBAAqB7kE,IACO,IAAjC/uC,KAAK4zG,qBAAqB3kE,IAC1BjvC,KAAK4zG,qBAAqBnkC,IAAMzvE,KAAKuoG,QAAQ11C,OAAOf,MAAQ,GAC5D9xD,KAAK4zG,qBAAqB5rC,IAAMhoE,KAAKuoG,QAAQ11C,OAAOd,OAAS,GAC9D,CAGC,MAAM4jD,EAAY5pC,GAAGlZ,OACjB7yD,KAAK4zG,qBAAqBnkC,GAAKzvE,KAAK4zG,qBAAqB7kE,GAAK,EAC9D/uC,KAAK4zG,qBAAqB5rC,GAAKhoE,KAAK4zG,qBAAqB3kE,GAAK,GAEnD0mE,EAAU7iD,WAAW,MAC7B0e,UAAUxxE,KAAKuoG,QAAQ11C,QAAS7yD,KAAK4zG,qBAAqB7kE,IAAK/uC,KAAK4zG,qBAAqB3kE,IAEhGymE,EAAYC,EAEhB31G,KAAKwrG,aAAaT,QAAQ3kG,KAAK,CAC3B8wE,OAAQ,YACRzxB,OAAQ,CACJiwD,EACA11G,KAAK4zG,qBAAqB7kE,GAC1B/uC,KAAK4zG,qBAAqB3kE,MAGlCjvC,KAAK4oG,QAAQxiG,KAAKpG,KAAKwrG,cACvBxrG,KAAKwrG,kBAAe1oG,EAExB9C,KAAKq1G,cAAgB,KAGzB7jC,UAAWnF,EAAmChuD,EAAWC,GACjD+tD,aAAcopC,UACdz1G,KAAKuoG,QAAQh0B,aAAalI,EAAIhuD,EAAGC,IAEjCte,KAAKuoG,QAAQ/V,UAAUn0E,EAAGC,EAAG+tD,EAAGva,MAAOua,EAAGta,QAC1C/xD,KAAKuoG,QAAQ/2B,UAAUnF,EAAIhuD,EAAGC,IAItC4sF,gBAAiBn8D,EAAYE,EAAYwgC,EAAYzH,IAgCrDxD,eACI,OAAOxkE,KAAKukE,UAGhBqhB,SAAUxrD,GACFp6B,KAAKyoG,aAAaj8E,IAAM4N,EAAE5N,GAAKxsB,KAAKyoG,aAAah0C,IAAMr6B,EAAEq6B,GAAKz0D,KAAKyoG,aAAazqF,IAAMoc,EAAEpc,IAG5Fhe,KAAKyoG,aAAe,CAACj8E,EAAG4N,EAAE5N,EAAGioC,EAAGr6B,EAAEq6B,EAAGz2C,EAAGoc,EAAEpc,GAC1Che,KAAK0oG,gBAAkB38B,GAAGkX,eAAetY,SAAS3qE,KAAKyoG,eAG3DiD,WAAYtxE,GACRp6B,KAAKuoG,QAAUnuE,EAGnBuxE,WAAY95C,GACR7xD,KAAK4oG,QAAU/2C,EAGnB6+B,QAASt7B,GACLp1D,KAAK+oG,YAAc3zC,EAGvBw2C,WAAYxhC,GACRpqE,KAAKipG,eAAiB7+B,EAG1ByhC,WAAYz2C,GACRp1D,KAAKgpG,eAAiB5zC,EAG1B02C,aAAc9tF,GACVhe,KAAKkpG,yBAA2BlrF,EAGpC+tF,gBAAiB/tF,GACbhe,KAAKmpG,4BAA8BnrF,EAGvCguF,aAAchuF,GACVhe,KAAKopG,wBAA0BprF,EAGnCiuF,aACI,OAAOjsG,KAAKgpG,eAGhBkD,UACI,OAAOlsG,KAAK+oG,YAGhBoD,aACI,OAAOnsG,KAAKipG,eAGhBmD,eACI,OAAOpsG,KAAKopG,oCArbbppG,KAGK4oG,QAA8B,IAAIC,GAAGC,eAH1C9oG,KAMKyoG,aAAqB,CAACj8E,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,GAN1Che,KAOK+oG,YAAsB,GAP3B/oG,KAQKgpG,eAAyB,mBAR9BhpG,KASKipG,eAAyB,GAT9BjpG,KAWKkpG,wBAAkC,EAXvClpG,KAYKmpG,2BAAqC,EAZ1CnpG,KAaKopG,uBAAiC,EAbtCppG,KAgBKspG,UAA4B,CAACjrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GAhBxDx7D,KAiBKupG,WAA6B,CAAClrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GAjBzDx7D,KAoBKukE,WAAqB,EApB1BvkE,KAsBK4pG,WAAkB,KAtBvB5pG,KA6BKovG,WAA8B,4BKrRtC,IAAI7G,EAEAC,EAIAx4B,EAIA45B,EATAhB,EAA8B,IAAIC,GAAGC,eAGrCrjC,EAAO,GAAmBmwC,EAAU,EACpC9J,GAAe,EAAMC,GAAkB,EAC9BzC,EAAY,CAACjrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GAC5C+tC,EAAa,CAAClrF,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,GACpCq6C,GAAU,EAGVC,GAAc,EACdC,GAAkB,WAEb/L,EAAQ3rF,EAAGC,EAAGkT,EAAMquD,GAEzB0oB,EAAQt2B,OAGAs2B,EAAQ10B,yBAFZiiC,EACIC,EACmC,kBAEA,cAGJ,kBAEvC,IAAIC,EAAUzN,EAAQ0N,qBAAqBzkF,EAAMA,EAAM,EAAGA,EAAMA,EAAMA,GAClE28E,EAAYxwG,KAAK67B,IAAIqmD,EAAS,GAClCsuB,EAAYxwG,KAAK6O,IAAI,EAAG7O,KAAK+O,KAAK8kB,EAAO,GAAKA,EAAM28E,IACpD,IAAI+H,EAAOv4G,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGmzE,IAC/B6qB,EAAe,EAAIwL,EAAOA,EAAOA,EACrCF,EAAQvxB,aAAa0pB,EAAW,uBAAyBzD,EAAe,KACxEsL,EAAQvxB,aAAa,EAAG,0BACxB8jB,EAAQjjC,UAAY0wC,EACpBzN,EAAQn2B,UAAU/zD,EAAImT,EAAMlT,EAAIkT,GAChC+2E,EAAQhjC,SAAS,EAAG,EAAU,EAAP/zC,EAAiB,EAAPA,GACjC+2E,EAAQj2B,mBAGH+3B,EAAahsF,EAAGC,EAAGo7C,GAExB,IAAI+wC,EACAC,EAFJhxC,EAAI/7D,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGgtD,IAG5B,IAAIixC,EAAamB,EAAgBnuG,KAAK6O,IAAI,GAAKktD,EAAI+L,GAAQ9nE,KAAK6O,IAAI,GAAKi5D,GAErE8lC,EAAQ5tG,KAAK6O,IAAI,EAAG7O,KAAK6O,IAAI,GAAK,EAAIopG,GAAWjL,EAzChC,aA2CZuF,EAAetqG,GACpB,IAAI4/E,EAAS5/E,EAAIiqC,EACjB46D,EAAgBlB,EAAW/tC,UAAY,EAAIgqB,GAAU9rB,EAAI8rB,EACzDklB,EAAgBqB,EAAoB6J,EAAUnL,EAAgBA,EAAiBmL,EAC/EjL,EAAamB,EAAgBnuG,KAAK6O,IAAI,GAAKi+F,EAAgBhlC,GAAQ9nE,KAAK6O,IAAI,GAAKi5D,GAEjFukC,EAAQpkG,EAAIyY,EAAGzY,EAAI0Y,EAAGqsF,EAAWD,GAG3B,OAANrsF,EACAurF,EAAW54B,SAASu6B,EAAO2E,GAE3BtG,EAAWlhF,IAAIrK,EAAGC,EAAGitF,EAAO2E,GAKpClwG,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7B8uC,EAAe,CACXsC,KAAM,CAAC,QAAS,eAChBC,QAAS,IAEbvC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAACsmD,KAEbvD,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACqmD,KAEbtD,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACggB,KAEb+iC,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACmwD,KAEbpN,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,mBACRzxB,OAAQ,CAACswD,KAGbD,EAAc,IAAMvN,EAAQ11C,OAAOjmD,MAEnC8sD,EAAI/7D,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGgtD,IAC5B,IAAIgxC,EAAgBqB,EAAoB6J,EAAUl8C,EAAIA,EAAKk8C,EACvDjL,EAAamB,EAAgBnuG,KAAK6O,IAAI,GAAKktD,EAAI+L,GAAQ9nE,KAAK6O,IAAI,GAAKi5D,GAEzEowC,GAAU,EACNlL,EAAY,GACZX,EAAQ3rF,EAAGC,EAAGqsF,EAAWD,GAE7B16B,EAhGqB,GAgGX26B,EACVrB,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdgrF,EAAU9tC,SAAW9B,EACrB6vC,EAAax9B,GAAG86B,QAAQyC,GAExBM,EAAa,IAAI79B,GAAGu+B,WACpBV,EAAWlhF,IAAIrK,EAAGC,EAAG,GAAG,eAGxBkqF,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,YACRzxB,OAAQ,CAACpnC,EAAGC,EAAGo7C,MAGvB15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,GACrBm8C,IAGLrN,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,SACRzxB,OAAQ,CAACpnC,EAAGC,EAAGo7C,KAGnB2wC,EAAahsF,EAAGC,EAAGgrF,EAAU9tC,UAE7B+tC,EAAax9B,GAAG86B,QAAQyC,GACxBA,EAAUjrF,EAAIA,EACdirF,EAAUhrF,EAAIA,EACdgrF,EAAU9tC,SAAW9B,IAEzB15D,KAAKirG,QAAU,WAEPrB,GACAS,EAAa,KAAM,KAAMf,EAAU9tC,UAGvCq6C,GAAU,EACVjM,OAAa9mG,EAET0lG,IACAA,EAAauC,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,KAEZmjD,EAAQxiG,KAAKoiG,GACbA,OAAe1lG,IAIvB9C,KAAKkrG,gBAAkB,SAAUn8D,EAAIE,EAAIwgC,EAAIzH,GAOzC,GALA8tC,EAAc,IAAMvN,EAAQ11C,OAAOjmD,MAEnC08F,EAAUjrF,EAAIoxD,EACd65B,EAAUhrF,EAAI0pD,EAEV6tC,QAAkB/yG,IAAPisC,EACX,OAGJ,IAGIo8D,EAHAC,EAAYztG,KAAKkhB,KAAKlhB,KAAK67B,IAAIi2C,EAAK1gC,EAAI,GAAOpxC,KAAK67B,IAAIwuC,EAAK/4B,EAAI,IACjEo8D,GAAM57B,EAAK1gC,GAAMq8D,EACjBE,GAAMtjC,EAAK/4B,GAAMm8D,EAEjBG,EAAQ5tG,KAAK6O,IAAI,EAAG7O,KAAK6O,IAAI,GAAK,EAAIopG,GAAWnwC,EAjKhC,IAmKrB,IADAuK,EAAU,EACLm7B,EAAWn7B,EAASm7B,GAAYC,EAAWD,GAAYI,EACxDvB,EAAQj7D,EAAKs8D,EAAKF,EAAUl8D,EAAKq8D,EAAKH,EAAU1lC,EAAMmwC,GAI1D,IAAIpK,EAAe,CACfV,KAAM,CAAC,QAAS,eAChBC,QAAS,IAEbS,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAACsmD,KAEbP,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,eACRzxB,OAAQ,CAACqmD,KAEbN,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,UACRzxB,OAAQ,CAACggB,KAEb+lC,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,aACRzxB,OAAQ,CAACmwD,KAEbpK,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,mBACRzxB,OAAQ,CAACswD,KAGbvK,EAAaT,QAAQ3kG,KAAK,CACtB8wE,OAAQ,kBACRzxB,OAAQ,CAAC1W,EAAIE,EAAIwgC,EAAIzH,KAEzB4gC,EAAQxiG,KAAKolG,IAIjBxrG,KAAKukE,UAAY,WACb,OAAOsxC,GAQX71G,KAAK0rG,WAAa,SAAUtxE,GACxBmuE,EAAUnuE,GAEdp6B,KAAK2rG,WAAa,SAAUp1B,GACxBqyB,EAAUryB,GAEdv2E,KAAK0wF,QAAU,SAAUt7B,GACrBqQ,EAAOrQ,GAEXp1D,KAAK4rG,WAAa,SAAUxhC,GACxBwrC,EAAUxrC,GAEdpqE,KAAK8rG,aAAe,SAAU9tF,GAC1B8tF,EAAe9tF,GAEnBhe,KAAK+rG,gBAAkB,SAAU/tF,GAC7B+tF,EAAkB/tF,GAEtBhe,KAAKm2G,iBAAmB,SAAUn4F,GAC9B+3F,EAAuB,GAAL/3F,GAGtBhe,KAAKksG,QAAU,WACX,OAAOzmC,GAEXzlE,KAAKmsG,WAAa,WACd,OAAOyJ,YCrPfQ,GAAiBn5G,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCa/G,MAAMk5G,GAAc,WACvB,IAAIC,EAA2B,CAC3B53B,MAAO9G,EAAAw+B,IACPG,QAAS99B,GAAK,aACd+9B,WAAY,CACR9pG,IAAK,GACLF,IAAK,IACL8zE,MAAOvU,GAAG8U,qBAAqB,GAAK,IAAK,KAE7C41B,cAAe,CACX/pG,IAAK,EACLF,IAAK,EACL8zE,MAAO,CAAC,CAAC,EAAG,KAAU,CAAC,GAAK,IAAM,CAAC,EAAG,KAE1Co2B,GAAI,MAGJC,EAAa,CACbl+B,GAAK,oBACLA,GAAK,mBACLA,GAAK,yBACLA,GAAK,qBAoOT,OAlOAL,GAAgBvkC,WAAS,KACrByiE,EAAeC,QAAU99B,GAAK,aAC9Bk+B,EAAa,CACTl+B,GAAK,oBACLA,GAAK,mBACLA,GAAK,yBACLA,GAAK,wBAIb69B,EAAeI,GAAK,SAAUl/C,GAC1B,IAIIg/C,EACAC,EALAr3F,EAAMhhB,SAASC,cAAc,OAC7ByoG,EAAQ,IAAIwB,GAAQsO,SACxB9P,EAAM6E,WAAW90B,IACjBrf,EAAEq/C,aAAa/P,EAAMoF,WAIrB,IAAI4K,EAAS,GACTC,EAAe,EACnB,IAAK,IAAI9gD,EAAI,EAAGA,EAAI,EAAGA,KAAC,SACTl6D,GACP,IAAI2xG,EAAQ3hC,GAAG1+D,GAAG,CACdqhE,MAAOioC,EAAW56G,GAClBk5E,QAAO,KACH+hC,EAAWj7G,MAGf82D,EAASkZ,GAAGlZ,OAAO,GAAI,IACvBwS,EAAMxS,EAAOC,WAAW,MAClB,IAAN/2D,GAAiB,IAANA,EACD,IAANA,GACAspE,EAAIyoB,YACJzoB,EAAI6kC,IAAI,GAAI,GAAI,GAAI,EAAG,EAAIvsG,KAAKuvC,IAChCm4B,EAAI8kC,YACJ9kC,EAAI+oB,QAEJ/oB,EAAIE,SAAS,EAAG,EAAG,GAAI,IAEd,IAANxpE,EACPspE,EAAImM,UAAUg0B,GAAgB,IAAK,EAAG,GACzB,IAANzpG,GACPspE,EAAImM,UAAU00B,GAAgB,IAAK,EAAG,GAE1CwH,EAAM93F,MAAM6oE,gBAAkB,OAAS5rB,EAAO6S,UAAU,aAAe,IAEvEoxC,EAAO1wG,KAAKsnG,GA1BI,CA2BlBz3C,YAGGghD,IACL,IAAK,IAAIl7G,EAAI,EAAGA,EAAI+6G,EAAO96G,OAAQD,IAE3B+6G,EAAO/6G,GAAGi5E,UADVj5E,IAAMg7G,EACgB,uBAEA,uBAOzBC,EAAW/6G,GAChB86G,EAAe96G,EACf6qG,EAAM2E,SAASxvG,GACfg7G,IALJA,IAQA,IAAIC,EAAkB,IAAIn6B,GAAS,CAC/B15C,KAAMyjE,EAAMsF,eACZtpD,MAAO21B,GAAK,oBACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMkF,aAAahuF,IAEvBq/D,aAAa,EACb3O,MAAO+J,GAAK,0BACZ1D,IAAK,CACDwK,SAAU,QACV+H,UAAW,WAIf6vB,EAAgB,IAAIprC,GAAG+U,mBAAmB,CAAC,CAAC,EAAG,IAAK,CAAC,EAAG,GAAI,CAAC,GAAI,GAAI,CAAC,GAAI,GAAI,CAAC,GAAI,KAAM,CAAC,IAAK,cAE1F4P,EAAQl/D,GACbs1E,EAAMpW,QAAQl/D,GACds1E,EAAM+E,WAAWluG,KAAK6O,IAAI,EAAG2qG,EAAc7uC,YAAY92C,IAAS,gBAIhEglF,EAAa,IAAIt2B,GAAS,CACtBp9B,MAAO21B,GAAK,cACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeE,WAAW9pG,IAC/BF,IAAK8pG,EAAeE,WAAWhqG,IAC/B8xE,UAAWwoB,EAAMoF,UACjBvrB,WCpIU,GDqIVzL,SAAU,SAAUtvE,GAChB8qF,EAAQ9qF,GACR4xD,EAAEq/C,aAAajxG,IAEnB06E,MAAOg2B,EAAeE,WAAWl2B,MACjCI,WAAY,SAAU3iE,GAElB,OADAA,GAAK,GACG,GACGpgB,KAAK4jC,MAAU,GAAJxjB,GAAU,GAErBpgB,KAAK4jC,MAAMxjB,MAI9B04F,EAAgB,IAAIv2B,GAAS,CACzBp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeG,cAAc/pG,IAClCF,IAAK8pG,EAAeG,cAAcjqG,IAClC8xE,UAAWg4B,EAAeG,cAAcjqG,IACxCm0E,WC1JU,GD2JVzL,SAAU,SAAUtvE,GAChBkhG,EAAM8E,WAAWhmG,GACjB4xD,EAAE4/C,gBAAgBxxG,IAEtB06E,MAAOg2B,EAAeG,cAAcn2B,MACpCI,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAI1B,IAAIs5F,EAAqBl4B,IAAkB,GAAO,SAAUnhE,GACxD8oF,EAAMgF,aAAa9tF,MAEnBs5F,EAAwBn4B,IAAkB,GAAO,SAAUnhE,GAC3D8oF,EAAMiF,gBAAgB/tF,MAG1BoB,EAAImnC,OACAwlB,GAAG1+D,GAAG,CACF0H,QAAS,CACLyhG,EAAWt5B,aACXm6B,GAEJtiC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,SACZW,aAAc,UAGtB/N,GAAG1+D,GAAG,CACF0H,QAAS,CACL0hG,EAAcv5B,aACdo6B,GAEJviC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,aAKxB,IAAIo+B,EAAen5G,SAASC,cAAc,OAC1C,IAAK,IAAItC,EAAI,EAAGA,EAAI+6G,EAAO96G,OAAQD,IAC/Bw7G,EAAa34G,YAAYk4G,EAAO/6G,IAEpCw7G,EAAa3hG,MAAMglE,UAAY,OAC/Bx7D,EAAIxgB,YAAY24G,GAChBA,EAAa34G,YAAYs4G,EAAgBh6B,cAI7C75C,GAEArjC,KAAKw3G,aAAe,SAAU5kF,GACrBk0E,EAAMviC,aACPiyC,EAAWl0B,cAAc1vD,IAGjC5yB,KAAKy3G,aAAe,SAAU7kF,GACrBk0E,EAAMviC,aACPiyC,EAAWj0B,cAAc3vD,IAIjC5yB,KAAKksG,QAAU,WACX,OAAOpF,EAAMoF,WAEjBlsG,KAAK0wF,QAAU,SAASl/D,GACpBk/D,EAAQl/D,GACRglF,EAAW74B,SAASnsD,IAExBxxB,KAAKmsG,WAAa,WACd,OAAOrF,EAAMqF,cAEjBnsG,KAAK4rG,WAAa,SAAS/rB,GACvBinB,EAAM8E,WAAW/rB,GACjB42B,EAAc94B,SAASkC,IAG3B7/E,KAAK4lF,SAAW,SAAUxrD,GACtB0sE,EAAMlhB,SAASxrD,IAEnBp6B,KAAK0rG,WAAa,SAAUtxE,GACxB0sE,EAAM4E,WAAWtxE,IAErBp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7BotC,EAAM+D,UAAUxsF,EAAGC,EAAGo7C,IAE1B15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,GAC1BotC,EAAMkE,OAAO3sF,EAAGC,EAAGo7C,IAEvB15D,KAAKirG,QAAU,SAAU5sF,EAAGC,GACxBwoF,EAAMmE,QAAQ5sF,EAAGC,IAErBte,KAAK03G,SAAW,WACZ,OAAO5Q,GAEX9mG,KAAKukE,UAAY,WACb,OAAOuiC,EAAMviC,aAEjBvkE,KAAKk9E,WAAa,WACd,OAAO99D,IAGRk3F,EAzPgB,UEb3BqB,GAAiB16G,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCY/G,MAAMy6G,GAAgB,WACzB,IAAItB,EAA2B,CAC3B53B,MAAO9G,EAAA+/B,IACPpB,QAAS99B,GAAK,eACd+9B,WAAY,CACR9pG,IAAK,GACLF,IAAK,IACL8zE,MAAOvU,GAAG8U,qBAAqB,GAAK,IAAK,KAE7C41B,cAAe,CACX/pG,IAAK,IACLF,IAAK,GAETkqG,GAAI,MA8KR,OA3KAt+B,GAAgBvkC,WAAS,KACrByiE,EAAeC,QAAU99B,GAAK,kBAGlC69B,EAAeI,GAAK,SAAUl/C,GAC1B,IAKIg/C,EACAC,EANAr3F,EAAMhhB,SAASC,cAAc,OAC7ByoG,EAAQ,IAAIwB,GAAQuP,oBAOfnnB,EAAQl/D,GACbs1E,EAAMpW,QAAQl/D,GAPlBs1E,EAAM6E,WAAW90B,IACjBrf,EAAEq/C,aAAa/P,EAAMoF,sBAUjBsK,EAAa,IAAIt2B,GAAS,CACtBp9B,MAAO21B,GAAK,cACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeE,WAAW9pG,IAC/BF,IAAK8pG,EAAeE,WAAWhqG,IAC/B8xE,UAAW,GACXqC,WFpDU,GEqDVzL,SAAU,SAAUtvE,GAChB8qF,EAAQ9qF,GACR4xD,EAAEq/C,aAAajxG,IAEnB06E,MAAOg2B,EAAeE,WAAWl2B,MACjCI,WAAY,SAAU3iE,GAElB,OADAA,GAAK,EACEpgB,KAAK4jC,MAAMxjB,MAG1B04F,EAAgB,IAAIv2B,GAAS,CACzBp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeG,cAAc/pG,IAClCF,IAAK8pG,EAAeG,cAAcjqG,IAClC8xE,UAAWwoB,EAAMqF,aACjBxrB,WFtEU,GEuEVzL,SAAU,SAAUtvE,GAChBkhG,EAAM8E,WAAWhmG,GACjB4xD,EAAE4/C,gBAAgBxxG,IAEtB86E,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAG1B,IAAI+5F,EAAiB,IAAI53B,GAAS,CAC9Bp9B,MAAO21B,GAAK,kBACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAiC,IAAtBwoB,EAAMsJ,cACjBzvB,WFtFU,GEuFVzL,SAAU,SAAUtvE,GAChBkhG,EAAMuJ,YAAYzqG,EAAM,QAGhCkyG,EAAe56B,aAAatnE,MAAMglE,UAAY,OAE9C,IAAIy8B,EAAqBl4B,IAAkB,GAAO,SAAUnhE,GACxD8oF,EAAMwJ,gBAAgBtyF,MAEtBs5F,EAAwBn4B,IAAkB,GAAO,SAAUnhE,GAC3D8oF,EAAMyJ,mBAAmBvyF,MAGzBk5F,EAAkB,IAAIn6B,GAAS,CAC/B15C,KAAMyjE,EAAMsF,eACZtpD,MAAO21B,GAAK,oBACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMkF,aAAahuF,IAEvBq/D,aAAa,EACb3O,MAAO+J,GAAK,0BACZ1D,IAAK,CACD6F,UAAW,OACX/kE,QAAS,kBAKjBuJ,EAAImnC,OACAwlB,GAAG1+D,GAAG,CACF0H,QAAS,CACLyhG,EAAWt5B,aACXm6B,GAEJtiC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,SACZW,aAAc,UAGtB/N,GAAG1+D,GAAG,CACF0H,QAAS,CACL0hG,EAAcv5B,aACdo6B,GAEJviC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,YAGpB2+B,EAAe56B,aACfg6B,EAAgBh6B,cAIxB75C,GAEArjC,KAAKw3G,aAAe,SAAU5kF,GACrBk0E,EAAMtiC,gBACPgyC,EAAWl0B,cAAc1vD,IAGjC5yB,KAAKy3G,aAAe,SAAU7kF,GACrBk0E,EAAMtiC,gBACPgyC,EAAWj0B,cAAc3vD,IAIjC5yB,KAAKksG,QAAU,WACX,OAAOpF,EAAMoF,WAEjBlsG,KAAK0wF,QAAU,SAASl/D,GACpBk/D,EAAQl/D,GACRglF,EAAW74B,SAASnsD,IAExBxxB,KAAKmsG,WAAa,WACd,OAAOrF,EAAMqF,cAEjBnsG,KAAK4rG,WAAa,SAAS/rB,GACvBinB,EAAM8E,WAAW/rB,GACjB42B,EAAc94B,SAASkC,IAG3B7/E,KAAK4lF,SAAW,SAAUxrD,GACtB0sE,EAAMlhB,SAASxrD,IAEnBp6B,KAAK0rG,WAAa,SAAUtxE,GACxB0sE,EAAM4E,WAAWtxE,IAErBp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7BotC,EAAM+D,UAAUxsF,EAAGC,EAAGo7C,IAE1B15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,EAAG2F,GAC7BynC,EAAMkE,OAAO3sF,EAAGC,EAAGo7C,EAAG2F,IAE1Br/D,KAAKirG,QAAU,WACXnE,EAAMmE,WAEVjrG,KAAK03G,SAAW,WACZ,OAAO5Q,GAEX9mG,KAAKukE,UAAY,WACb,OAAOuiC,EAAMtiC,gBAEjBxkE,KAAKk9E,WAAa,WACd,OAAO99D,IAIRk3F,EA3LkB,UCZ7ByB,GAAiB96G,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCS/G,MAAM66G,GAAkB,WAC3B,IAAI1B,EAA2B,CAC3B53B,MAAO9G,EAAAmgC,IACPxB,QAAS99B,GAAK,iBACd+9B,WAAY,CACR9pG,IAAK,GACLF,IAAK,IAETiqG,cAAe,CACX/pG,IAAK,IACLF,IAAK,GAETkqG,GAAI,MAoJR,OAjJAt+B,GAAgBvkC,WAAS,KACrByiE,EAAeC,QAAU99B,GAAK,oBAGlC69B,EAAeI,GAAK,SAAUh9C,GAC1B,IAII88C,EACAC,EALAr3F,EAAMhhB,SAASC,cAAc,OAC7ByoG,EAAQ,IAAIwB,GAAQ2P,aACxBnR,EAAM6E,WAAW90B,IACjBnd,EAAEm9C,aAAa/P,EAAMoF,sBASjBsK,EAAa,IAAIt2B,GAAS,CACtBp9B,MAAO21B,GAAK,cACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeE,WAAW9pG,IAC/BF,IAAK8pG,EAAeE,WAAWhqG,IAC/B8xE,UAAWwoB,EAAMoF,UACjBvrB,WJ/CU,GIgDVzL,SAAU,SAAUtvE,GAChBkhG,EAAMpW,QAAQ9qF,GACd8zD,EAAEm9C,aAAa/P,EAAMoF,YAEzBxrB,WAAY,SAAU3iE,GAElB,OADAA,GAAK,GACG,GACGpgB,KAAK4jC,MAAU,GAAJxjB,GAAU,GAErBpgB,KAAK4jC,MAAMxjB,MAI9B04F,EAAgB,IAAIv2B,GAAS,CACzBp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeG,cAAc/pG,IAClCF,IAAK8pG,EAAeG,cAAcjqG,IAClC8xE,UAAWwoB,EAAMqF,aACjBxrB,WJpEU,GIqEVzL,SAAU,SAAUtvE,GAChBkhG,EAAM8E,WAAWhmG,GACjB8zD,EAAE09C,gBAAgBxxG,IAEtB86E,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAG1B,IAAIm6F,EAAc,IAAIh4B,GAAS,CAC3Bp9B,MAAO21B,GAAK,kBACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAiC,IAAtBwoB,EAAMsJ,cACjBzvB,WJpFU,GIqFVzL,SAAU,SAAUtvE,GAChBkhG,EAAMuJ,YAAYzqG,EAAM,QAG5BuyG,EAAc,IAAIj4B,GAAS,CAC3Bp9B,MAAO21B,GAAK,uBACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,GACL8xE,UAAWwoB,EAAMwK,WACjB3wB,WJhGU,GIiGVzL,SAAU,SAAUtvE,GAChBkhG,EAAMhN,SAASl0F,MAGvB6wG,EAAcv5B,aAAatnE,MAAMglE,UAAY,OAC7Cs9B,EAAYh7B,aAAatnE,MAAMglE,UAAY,OAC3Cu9B,EAAYj7B,aAAatnE,MAAMglE,UAAY,OAC3Cx7D,EAAIxgB,YAAY43G,EAAWt5B,cAC3B99D,EAAIxgB,YAAY63G,EAAcv5B,cAC9B99D,EAAIxgB,YAAYs5G,EAAYh7B,cAC5B99D,EAAIxgB,YAAYu5G,EAAYj7B,cAGhC75C,GAEArjC,KAAKw3G,aAAe,SAAU5kF,GACrBk0E,EAAMviC,aACPiyC,EAAWl0B,cAAc1vD,IAGjC5yB,KAAKy3G,aAAe,SAAU7kF,GACrBk0E,EAAMviC,aACPiyC,EAAWj0B,cAAc3vD,IAGjC5yB,KAAKksG,QAAU,WACX,OAAOpF,EAAMoF,WAEjBlsG,KAAK0wF,QAAU,SAASl/D,aA1FPA,GACbs1E,EAAMpW,QAAQl/D,GA0Fdk/D,CAAQl/D,GACRglF,EAAW74B,SAASnsD,IAExBxxB,KAAKmsG,WAAa,WACd,OAAOrF,EAAMqF,cAEjBnsG,KAAK4rG,WAAa,SAAS/rB,GACvBinB,EAAM8E,WAAW/rB,GACjB42B,EAAc94B,SAASkC,IAE3B7/E,KAAK4lF,SAAW,SAAUxrD,GACtB0sE,EAAMlhB,SAASxrD,IAEnBp6B,KAAK0rG,WAAa,SAAUtxE,GACxB0sE,EAAM4E,WAAWtxE,IAErBp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGk9C,GAC7BsrC,EAAM+D,UAAUxsF,EAAGC,EAAGk9C,IAE1Bx7D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGk9C,GAC1BsrC,EAAMkE,OAAO3sF,EAAGC,EAAGk9C,EAAU,OAEjCx7D,KAAKirG,QAAU,WACXnE,EAAMmE,WAEVjrG,KAAKkxG,QAAU,WACX,OAAOrgE,SAASi2D,EAAMoK,YAE1BlxG,KAAKixG,QAAU,SAAU77C,GACrB0xC,EAAMmK,QAAQpgE,SAASukB,KAE3Bp1D,KAAK03G,SAAW,WACZ,OAAO5Q,GAEX9mG,KAAKukE,UAAY,WACb,OAAOuiC,EAAMviC,aAEjBvkE,KAAKk9E,WAAa,WACd,OAAO99D,IAIRk3F,EAhKoB,UCT/B8B,GAAiBn7G,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCY/G,MAAMk7G,GAAgB,WACzB,IAAI/B,EAA2B,CAC3B53B,MAAO9G,EAAAwgC,IACP7B,QAAS99B,GAAK,eACd+9B,WAAY,CACR9pG,IAAK,GACLF,IAAK,IACL8zE,MAAOvU,GAAG8U,qBAAqB,GAAK,IAAK,KAE7C41B,cAAe,CACX/pG,IAAK,EACLF,IAAK,EACL8zE,MAAO,CAAC,CAAC,EAAG,KAAU,CAAC,GAAK,IAAM,CAAC,EAAG,KAE1Co2B,GAAI,MAkLR,OA/KAt+B,GAAgBvkC,WAAS,KACrByiE,EAAeC,QAAU99B,GAAK,kBAGlC69B,EAAeI,GAAK,SAAUl/C,GAC1B,IAIIg/C,EACAC,EALAr3F,EAAMhhB,SAASC,cAAc,OAC7ByoG,EAAQ,IAAIwB,GAAQgQ,WACxBxR,EAAM6E,WAAW90B,IACjBrf,EAAEq/C,aAAa/P,EAAMoF,WAIrB,IAAIgL,EAAkB,IAAIn6B,GAAS,CAC/B15C,KAAMyjE,EAAMsF,eACZtpD,MAAO21B,GAAK,oBACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMkF,aAAahuF,IAEvBq/D,aAAa,EACb3O,MAAO+J,GAAK,0BACZ1D,IAAK,CACDgF,YAAa,UAIjBw+B,EAAe,IAAIx7B,GAAS,CAC5B15C,KAAMyjE,EAAMuM,cACZvwD,MAAO21B,GAAK,UACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMqM,YAAYn1F,IAEtB+2D,IAAK,CACDgF,YAAa,UAIjBy+B,EAAe,IAAIz7B,GAAS,CAC5B15C,KAAMyjE,EAAMwM,eACZxwD,MAAO21B,GAAK,sBACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMsM,aAAap1F,MAIvBm5F,EAAgB,IAAIprC,GAAG+U,mBAAmB,CAAC,CAAC,GAAK,KAAO,CAAC,IAAK,cAEzD4P,EAAQl/D,GACbs1E,EAAMpW,QAAQl/D,GACds1E,EAAM+E,WAAWsL,EAAc7uC,YAAY92C,GAAQA,eAInDglF,EAAa,IAAIt2B,GAAS,CACtBp9B,MAAO21B,GAAK,cACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeE,WAAW9pG,IAC/BF,IAAK8pG,EAAeE,WAAWhqG,IAC/B8xE,UAAWwoB,EAAMoF,UACjBvrB,WNvFU,GMwFVzL,SAAU,SAAUtvE,GAEhB8qF,EADA9qF,EAAMjI,KAAK4jC,MAAY,EAAN37B,GAAW,GAE5B4xD,EAAEq/C,aAAajxG,IAEnB06E,MAAOg2B,EAAeE,WAAWl2B,MACjCI,WAAY,SAAU3iE,GAElB,OADAA,GAAK,EACEpgB,KAAK4jC,MAAMxjB,MAG1B04F,EAAgB,IAAIv2B,GAAS,CACzBp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeG,cAAc/pG,IAClCF,IAAK8pG,EAAeG,cAAcjqG,IAClC8xE,UAAWg4B,EAAeG,cAAcjqG,IACxCm0E,WN1GU,GM2GVzL,SAAU,SAAUtvE,GAChBkhG,EAAM8E,WAAWhmG,GACjB4xD,EAAE4/C,gBAAgBxxG,IAEtB06E,MAAOg2B,EAAeG,cAAcn2B,MACpCI,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAI1B,IAAIs5F,EAAqBl4B,IAAkB,GAAO,SAAUnhE,GACxD8oF,EAAMgF,aAAa9tF,MAGvBoB,EAAImnC,OACAwlB,GAAG1+D,GAAG,CACF0H,QAAS,CACLyhG,EAAWt5B,aACXm6B,GAEJtiC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,SACZW,aAAc,UAGtB28B,EAAcv5B,cAGlB,IAAIu7B,EAAY1sC,GAAG1+D,GAAG,CAClBga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACT+kE,UAAW,UAInB69B,EAAU75G,YAAYs4G,EAAgBh6B,cACtCu7B,EAAU75G,YAAY25G,EAAar7B,cACnCu7B,EAAU75G,YAAY45G,EAAat7B,cAGvC75C,GAEArjC,KAAKw3G,aAAe,SAAU5kF,GACrBk0E,EAAMviC,aACPiyC,EAAWl0B,cAAc1vD,IAGjC5yB,KAAKy3G,aAAe,SAAU7kF,GACrBk0E,EAAMviC,aACPiyC,EAAWj0B,cAAc3vD,IAIjC5yB,KAAKksG,QAAU,WACX,OAAOpF,EAAMoF,WAEjBlsG,KAAK0wF,QAAU,SAASl/D,GACpBk/D,EAAQl/D,GACRglF,EAAW74B,SAASnsD,IAExBxxB,KAAKmsG,WAAa,WACd,OAAOrF,EAAMqF,cAEjBnsG,KAAK4rG,WAAa,SAAS/rB,GACvBinB,EAAM8E,WAAW/rB,GACjB42B,EAAc94B,SAASkC,IAG3B7/E,KAAK4lF,SAAW,SAAUxrD,GACtB0sE,EAAMlhB,SAASxrD,IAEnBp6B,KAAK0rG,WAAa,SAAUtxE,GACxB0sE,EAAM4E,WAAWtxE,IAErBp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7BotC,EAAM+D,UAAUxsF,EAAGC,EAAGo7C,IAE1B15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,GAC1BotC,EAAMkE,OAAO3sF,EAAGC,EAAGo7C,IAEvB15D,KAAKirG,QAAU,SAAU5sF,EAAGC,GACxBwoF,EAAMmE,QAAQ5sF,EAAGC,IAErBte,KAAK03G,SAAW,WACZ,OAAO5Q,GAEX9mG,KAAKukE,UAAY,WACb,OAAOuiC,EAAMviC,aAEjBvkE,KAAKk9E,WAAa,WACd,OAAO99D,IAGRk3F,EAhMkB,UCZ7BoC,GAAiBz7G,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCY/G,MAAMw7G,GAAiB,WAC1B,IAAIrC,EAA2B,CAC3B53B,MAAO9G,EAAA8gC,IACPnC,QAAS99B,GAAK,UAAY,OAC1B+9B,WAAY,CACR9pG,IAAK,GACLF,IAAK,IACL8zE,MAAOvU,GAAG8U,qBAAqB,GAAK,IAAK,KAE7C41B,cAAe,CACX/pG,IAAK,IACLF,IAAK,GAETkqG,GAAI,MAuKR,OApKAt+B,GAAgBvkC,WAAS,KACrByiE,EAAeC,QAAU99B,GAAK,UAAY,UAG9C69B,EAAeI,GAAK,SAAUl/C,GAC1B,IAKIg/C,EACAC,EANAr3F,EAAMhhB,SAASC,cAAc,OAC7ByoG,EAAQ,IAAIwB,GAAQsQ,YACxB9R,EAAM6E,WAAW90B,IACjBrf,EAAEq/C,aAAa/P,EAAMoF,WAIrB,IAAI2M,GAAkB,WAEbnoB,EAAQl/D,GACbs1E,EAAMpW,QAAQl/D,eAIdglF,EAAa,IAAIt2B,GAAS,CACtBp9B,MAAO21B,GAAK,cACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeE,WAAW9pG,IAC/BF,IAAK8pG,EAAeE,WAAWhqG,IAC/B8xE,UAAW,GACXqC,WRrDU,GQsDVzL,SAAU,SAAUtvE,GAChB8qF,EAAQ9qF,GACR4xD,EAAEq/C,aAAajxG,IAEnB06E,MAAOg2B,EAAeE,WAAWl2B,MACjCI,WAAY,SAAU3iE,GAElB,OADAA,GAAK,GACG,GACGpgB,KAAK4jC,MAAU,GAAJxjB,GAAU,GAErBpgB,KAAK4jC,MAAMxjB,MAI9B04F,EAAgB,IAAIv2B,GAAS,CACzBp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeG,cAAc/pG,IAClCF,IAAK8pG,EAAeG,cAAcjqG,IAClC8xE,UAAW,EACXqC,WR3EU,GQ4EVzL,SAAU,SAAUtvE,GAChBkhG,EAAM8E,WAAWhmG,GACjB4xD,EAAE4/C,gBAAgBxxG,IAEtB86E,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAI1B,IAAIs5F,EAAqBl4B,IAAkB,GAAO,SAAUnhE,GACxD8oF,EAAMgF,aAAa9tF,MAEnBs5F,EAAwBn4B,IAAkB,GAAO,SAAUnhE,GAC3D8oF,EAAMiF,gBAAgB/tF,MAG1BoB,EAAImnC,OACAwlB,GAAG1+D,GAAG,CACF0H,QAAS,CACLyhG,EAAWt5B,aACXm6B,GAEJtiC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,SACZW,aAAc,UAGtB/N,GAAG1+D,GAAG,CACF0H,QAAS,CACL0hG,EAAcv5B,aACdo6B,GAEJviC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,aAKxB,IAAI2/B,EAAqB,IAAI/7B,GAAS,CAClC15C,MAAM,EACNyf,MAAO21B,GAAK,+BACZ/rC,SAAU,SAAU1uB,GAChB66F,EAAkB76F,EAClB8oF,EAAMqP,iBAAiBn4F,IAE3B+2D,IAAK,CACD6F,UAAW,UAGnBx7D,EAAIxgB,YAAYk6G,EAAmB57B,cAGvC75C,GAMArjC,KAAKw3G,aAAe,SAAU5kF,GACrBk0E,EAAMviC,aACPiyC,EAAWl0B,cAAc1vD,IAGjC5yB,KAAKy3G,aAAe,SAAU7kF,GACrBk0E,EAAMviC,aACPiyC,EAAWj0B,cAAc3vD,IAGjC5yB,KAAKksG,QAAU,WACX,OAAOpF,EAAMoF,WAEjBlsG,KAAK0wF,QAAU,SAASl/D,GACpBk/D,EAAQl/D,GACRglF,EAAW74B,SAASnsD,IAExBxxB,KAAKmsG,WAAa,WACd,OAAOrF,EAAMqF,cAEjBnsG,KAAK4rG,WAAa,SAAS/rB,GACvBinB,EAAM8E,WAAW/rB,GACjB42B,EAAc94B,SAASkC,IAE3B7/E,KAAK4lF,SAAW,SAAUxrD,KAG1Bp6B,KAAK0rG,WAAa,SAAUtxE,GACxB0sE,EAAM4E,WAAWtxE,IAErBp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7BotC,EAAM+D,UAAUxsF,EAAGC,EAAGo7C,IAE1B15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,GAC1BotC,EAAMkE,OAAO3sF,EAAGC,EAAGo7C,IAEvB15D,KAAKirG,QAAU,WACXnE,EAAMmE,WAEVjrG,KAAK03G,SAAW,WACZ,OAAO5Q,GAEX9mG,KAAK+4G,mBAAqB,WACtB,OAAOF,GAEX74G,KAAKukE,UAAY,WACb,OAAOuiC,EAAMviC,aAEjBvkE,KAAKk9E,WAAa,WACd,OAAO99D,IAIRk3F,EApLmB,UCZ9B0C,GAAiB/7G,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCY/G,MAAM87G,GAAiB,WAC1B,IAAI3C,EAA2B,CAC3B53B,MAAO9G,EAAAohC,IACPzC,QAAS99B,GAAK,gBACd+9B,WAAY,CACR9pG,IAAK,GACLF,IAAK,IACL8zE,MAAOvU,GAAG8U,qBAAqB,GAAK,IAAK,KAE7C41B,cAAe,CACX/pG,IAAK,EACLF,IAAK,EACL8zE,MAAO,CAAC,CAAC,EAAG,KAAU,CAAC,GAAK,IAAM,CAAC,EAAG,KAE1Co2B,GAAI,MAyKR,OAtKAt+B,GAAgBvkC,WAAS,KACrByiE,EAAeC,QAAU99B,GAAK,mBAGlC69B,EAAeI,GAAK,SAAUl/C,GAC1B,IAIIg/C,EACAC,EALAr3F,EAAMhhB,SAASC,cAAc,OAC7ByoG,EAAQ,IAAIwB,GAAQ4Q,YACxBpS,EAAM6E,WAAW90B,IACjBrf,EAAEq/C,aAAa/P,EAAMoF,WAIrB,IAAIgL,EAAkB,IAAIn6B,GAAS,CAC/B15C,KAAMyjE,EAAMsF,eACZtpD,MAAO21B,GAAK,oBACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMkF,aAAahuF,IAEvBq/D,aAAa,EACb3O,MAAO+J,GAAK,4BAGZ0+B,EAAgB,IAAIprC,GAAG+U,mBAAmB,CAAC,CAAC,EAAG,IAAK,CAAC,EAAG,GAAI,CAAC,GAAI,GAAI,CAAC,GAAI,GAAI,CAAC,GAAI,KAAM,CAAC,IAAK,cAE1F4P,EAAQl/D,GACbs1E,EAAMpW,QAAQl/D,GACds1E,EAAM+E,WAAWluG,KAAK6O,IAAI,EAAG2qG,EAAc7uC,YAAY92C,IAAS,gBAIhEglF,EAAa,IAAIt2B,GAAS,CACtBp9B,MAAO21B,GAAK,cACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeE,WAAW9pG,IAC/BF,IAAK8pG,EAAeE,WAAWhqG,IAC/B8xE,UAAWwoB,EAAMoF,UACjBvrB,WVjEU,GUkEVzL,SAAU,SAAUtvE,GAChB8qF,EAAQ9qF,GACR4xD,EAAEq/C,aAAajxG,IAEnB06E,MAAOg2B,EAAeE,WAAWl2B,MACjCI,WAAY,SAAU3iE,GAElB,OADAA,GAAK,GACG,GACGpgB,KAAK4jC,MAAU,GAAJxjB,GAAU,GAErBpgB,KAAK4jC,MAAMxjB,MAI9B04F,EAAgB,IAAIv2B,GAAS,CACzBp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeG,cAAc/pG,IAClCF,IAAK8pG,EAAeG,cAAcjqG,IAClC8xE,UAAWwoB,EAAMqF,aACjBxrB,WVvFU,GUwFVzL,SAAU,SAAUtvE,GAChBkhG,EAAM8E,WAAWhmG,GACjB4xD,EAAE4/C,gBAAgBxxG,IAEtB06E,MAAOg2B,EAAeG,cAAcn2B,MACpCI,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAI1B,IAAIs5F,EAAqBl4B,IAAkB,GAAO,SAAUnhE,GACxD8oF,EAAMgF,aAAa9tF,MAEnBs5F,EAAwBn4B,IAAkB,GAAO,SAAUnhE,GAC3D8oF,EAAMiF,gBAAgB/tF,MAG1BoB,EAAImnC,OACAwlB,GAAG1+D,GAAG,CACF0H,QAAS,CACLyhG,EAAWt5B,aACXm6B,GAEJtiC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,SACZW,aAAc,UAGtB/N,GAAG1+D,GAAG,CACF0H,QAAS,CACL0hG,EAAcv5B,aACdo6B,GAEJviC,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,aAKRpN,GAAG1+D,GAAG,CAClBga,OAAQjI,EACR21D,IAAK,CACD6F,UAAW,UAGTr0B,OAAO2wD,EAAgBh6B,cAIrC75C,GAEArjC,KAAKw3G,aAAe,SAAU5kF,GACrBk0E,EAAMtiC,gBACPgyC,EAAWl0B,cAAc1vD,IAGjC5yB,KAAKy3G,aAAe,SAAU7kF,GACrBk0E,EAAMtiC,gBACPgyC,EAAWj0B,cAAc3vD,IAIjC5yB,KAAKksG,QAAU,WACX,OAAOpF,EAAMoF,WAEjBlsG,KAAK0wF,QAAU,SAASl/D,GACpBk/D,EAAQl/D,GACRglF,EAAW74B,SAASnsD,IAExBxxB,KAAKmsG,WAAa,WACd,OAAOrF,EAAMqF,cAEjBnsG,KAAK4rG,WAAa,SAAS/rB,GACvBinB,EAAM8E,WAAW/rB,GACjB42B,EAAc94B,SAASkC,IAG3B7/E,KAAK4lF,SAAW,SAAUxrD,GACtB0sE,EAAMlhB,SAASxrD,IAEnBp6B,KAAK0rG,WAAa,SAAUtxE,GACxB0sE,EAAM4E,WAAWtxE,IAErBp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7BotC,EAAM+D,UAAUxsF,EAAGC,EAAGo7C,IAE1B15D,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,GAC1BotC,EAAMkE,OAAO3sF,EAAGC,EAAGo7C,IAEvB15D,KAAKirG,QAAU,SAAU5sF,EAAGC,GACxBwoF,EAAMmE,WAEVjrG,KAAK03G,SAAW,WACZ,OAAO5Q,GAEX9mG,KAAKukE,UAAY,WACb,OAAOuiC,EAAMtiC,gBAEjBxkE,KAAKk9E,WAAa,WACd,OAAO99D,IAGRk3F,EAvLmB,UCZ9B6C,GAAiBl8G,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,eCEzGi8G,GAIT3sE,SACQzsC,KAAKvD,MACLsvE,GAAGkO,aAAaj6E,KAAKqN,GAAI,yBAEzB0+D,GAAGyR,gBAAgBx9E,KAAKqN,GAAI,yBAoCpC2vE,WACI,OAAOh9E,KAAKvD,MAGhBkhF,SAAU3/D,GACNhe,KAAKvD,QAAUuhB,EACfhe,KAAKysC,SAGTywC,aACI,OAAOl9E,KAAKqN,GAGhBkyD,UACIwM,GAAGiP,UAAUh7E,KAAKqN,gBA5ClBqsD,GAOA15D,KAAKvD,QAAUi9D,EAAEr2B,KACjBrjC,KAAKqN,GAAK0+D,GAAG1+D,GAAG,CACZ0H,QAAS2kD,EAAE5W,MACX4rB,MAAOhV,EAAEgV,MACTsG,UAA+B,iBAAZtb,EAAE5W,MAAsB,gBAAkB,yCAC7DmyB,QAAO,KACHj1E,KAAKvD,OAASuD,KAAKvD,MACnBuD,KAAKysC,SACLitB,EAAEwb,SAASl1E,KAAKvD,QAEpBs4E,IAAK,CACDiJ,OAAQ,aAGO,iBAAZtkB,EAAE5W,OACTipB,GAAGgJ,IAAIrb,EAAE5W,MAAO,CACZjtC,QAAS,QACT2rE,cAAe,SAGvBxhF,KAAKysC,UC9BN,MAAM4sE,GAAgB,WACzB,MAAM/C,EAA2B,CAC7B53B,MAAO9G,EAAAuhC,IACP5C,QAAS99B,GAAK,eACd+9B,WAAY,CACR9pG,IAAK,IACLF,IAAK,GACL8zE,MAAOvU,GAAG8U,qBAAqB,IAAM,GAAI,IACzC6B,YAAY,GAEhB+zB,cAAe,CACX/pG,IAAK,IACLF,IAAK,GAETkqG,GAAI,MAuUR,OApUAt+B,GAAgBvkC,WAAS,KACrByiE,EAAeC,QAAU99B,GAAK,kBAGlC69B,EAAeI,GAAK,SAAUh9C,GAC1B,MAAMt6C,EAAMhhB,SAASC,cAAc,OAC7ByoG,EAAQ,IAAIwB,GAAQgR,WAI1B,IAAI9C,EACAC,WAEK/lB,EAAQl/D,GACbs1E,EAAMpW,QAAQl/D,GAPlBs1E,EAAM6E,WAAW90B,IACjBnd,EAAEm9C,aAAa/P,EAAMoF,sBAUjBsK,EAAa,IAAIt2B,GAAS,CACtBp9B,MAAO21B,GAAK,cACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeE,WAAW9pG,IAC/BF,IAAK8pG,EAAeE,WAAWhqG,IAC/B8xE,UAAWwoB,EAAMoF,UACjBvrB,WbtDU,GauDVP,UAA+B,WAApB0mB,EAAMyN,UACjBr/B,SAAU,SAAUtvE,GAChB8qF,EAAQ9qF,GACR8zD,EAAEm9C,aAAa/P,EAAMoF,YAEzB5rB,MAAOg2B,EAAeE,WAAWl2B,MACjCI,WAAY,SAAU3iE,GAElB,OADAA,GAAK,GACM,EAAKpgB,KAAK4jC,MAAU,GAAJxjB,GAAU,GAAMpgB,KAAK4jC,MAAMxjB,MAG9D04F,EAAgB,IAAIv2B,GAAS,CACzBp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK4pG,EAAeG,cAAc/pG,IAClCF,IAAK8pG,EAAeG,cAAcjqG,IAClC8xE,UAAWwoB,EAAMqF,aACjBxrB,WbzEU,Ga0EVzL,SAAU,SAAUtvE,GAChBkhG,EAAM8E,WAAWhmG,GACjB8zD,EAAE09C,gBAAgBxxG,IAEtB86E,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAI1BguD,GAAGgJ,IAAI0hC,EAAcv5B,aAAc,CAC/BtC,UAAW,SAGf,IAAI29B,EAAe,IAAIx7B,GAAS,CAC5B15C,KAAMyjE,EAAMuM,cACZvwD,MAAO21B,GAAK,UACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMqM,YAAYn1F,IAEtB+2D,IAAK,CACD6F,UAAW,OACXC,WAAY,UAIpB,MAAMq8B,EAAkB,IAAIn6B,GAAS,CACjC15C,KAAMyjE,EAAMsF,eACZtpD,MAAO21B,GAAK,oBACZ/rC,SAAU,SAAU1uB,GAChB8oF,EAAMkF,aAAahuF,IAEvBq/D,aAAa,EACb3O,MAAO+J,GAAK,0BACZ1D,IAAK,CACD6F,UAAW,UAIb69B,EAAY1sC,GAAG1+D,GAAG,CACpB0nE,IAAK,CACDl/D,QAAS,OACT+kE,UAAW,UASb2+B,EAAc,IAAI/xB,GAAQ,CAC5B1J,UAAW,CACP,CACI7hF,GAAI,OACJ6mD,MAAOipB,GAAG0lB,UAAU,CAChBxiB,YAAa,MACbnd,MAAO0nD,KACPznD,OAAQynD,KACRtqC,YAAa,CACT,CACID,YAAa,OACbmf,KAAM,OACNx4E,MAAK,oGACLugD,EAAG,+BAIfuY,MAAO+J,GAAK,qBAEhB,CACIx8E,GAAI,SACJ6mD,MAAOipB,GAAG0lB,UAAU,CAChBxiB,YAAa,MACbnd,MAAO0nD,KACPznD,OAAQynD,KACRtqC,YAAa,CACT,CACID,YAAa,OACbmf,KAAM,OACNH,OAAQ,OACRr4E,MAAK,0HACLugD,EAAG,+BAIfuY,MAAO+J,GAAK,wBAGpBsG,OAAQ+nB,EAAMyN,UACdr/B,SAAWj5E,IACP6qG,EAAMwN,QAAQr4G,GACdq6G,EAAeE,WAAW9zB,WAAiC,SAApBokB,EAAMyN,UAC7CiC,EAAW/zB,cAAc6zB,EAAeE,WAAW9zB,YACnD8zB,EAAW74B,SAASmpB,EAAMoF,WAC1BxyC,EAAEm9C,aAAa/P,EAAMoF,WACrBxyC,EAAE+/C,oBAIJC,EAAgB,IAAIN,GAAU,CAChCt2D,MAAOipB,GAAG0lB,UAAU,CAChBxiB,YAAa,MACbnd,MAAO0nD,KACPznD,OAAQynD,KACRtqC,YAAa,CACT,CACID,YAAa,OACbmf,KAAM,OACNH,OAAQ,OACRr4E,MAAO,oBACPugD,EAAC,uBAIbuY,MAAO+J,GAAK,wBACZp1C,KAAMyjE,EAAM+N,eACZ3/B,SAAWl3D,IACP8oF,EAAM8N,aAAa52F,MAIrB27F,EAAgB,IAAIP,GAAU,CAChCt2D,MAAOipB,GAAG0lB,UAAU,CAChBxiB,YAAa,MACbnd,MAAO0nD,KACPznD,OAAQynD,KACRtqC,YAAa,CACT,CACID,YAAa,OACbmf,KAAM,OACNH,OAAQ,OACRr4E,MAAO,oBACPugD,EAAC,uBAIbuY,MAAO+J,GAAK,wBACZp1C,KAAMyjE,EAAMiO,eACZ7/B,SAAWl3D,IACP8oF,EAAMgO,aAAa92F,MAIrB47F,EAAiB,IAAIR,GAAU,CACjCt2D,MAAOipB,GAAG0lB,UAAU,CAChBxiB,YAAa,MACbnd,MAAO0nD,KACPznD,OAAQynD,KACRtqC,YAAa,CACT,CACID,YAAa,OACbC,YAAa,CACT,CACID,YAAa,iBACbhzE,GAAI,WACJ8yC,GAAI,IACJE,GAAI,IACJwgC,GAAI,IACJzH,GAAI,IACJkH,YAAa,CACT,CACID,YAAa,OACbrxC,OAAQ,KACR,aAAc,iBAElB,CACIqxC,YAAa,OACbrxC,OAAQ,OACR,aAAc,qBAMlC,CACIqxC,YAAa,OACbmf,KAAM,mBACN/vE,EAAG,IACHC,EAAG,IACHwzC,MAAO,KACPC,OAAQ,SAIpB2c,MAAO+J,GAAK,wBACZp1C,KAAMyjE,EAAMmO,cACZ//B,SAAWl3D,IACP8oF,EAAMkO,YAAYh3F,MAI1B+tD,GAAGgJ,IAAI2kC,EAAcx8B,aAAc,CAC/BrC,WAAY,SAEhB,CACI,MAAMwL,EAAS,CACXxL,WAAY,OAEhB9O,GAAGgJ,IAAI4kC,EAAcz8B,aAAcmJ,GACnCta,GAAGgJ,IAAI6kC,EAAe18B,aAAcmJ,GAGxCoyB,EAAUlyD,OACNgzD,EAAYr8B,aACZw8B,EAAcx8B,aACdy8B,EAAcz8B,aACd08B,EAAe18B,cAGnB99D,EAAImnC,OACAiwD,EAAWt5B,aACXu5B,EAAcv5B,aACdu7B,EACA1sC,GAAG1+D,GAAG,CACF0H,QAAS,CACLmiG,EAAgBh6B,aAChBq7B,EAAar7B,cAEjBnI,IAAK,CACDl/D,QAAS,WAMzBwtB,GAEArjC,KAAKw3G,aAAe,SAAU5kF,GACrBk0E,EAAMtiC,gBAAsC,WAApBsiC,EAAMyN,WAC/BiC,EAAWl0B,cAAc1vD,IAGjC5yB,KAAKy3G,aAAe,SAAU7kF,GACrBk0E,EAAMtiC,gBAAsC,WAApBsiC,EAAMyN,WAC/BiC,EAAWj0B,cAAc3vD,IAIjC5yB,KAAKksG,QAAU,WACX,OAAOpF,EAAMoF,WAEjBlsG,KAAK0wF,QAAU,SAASl/D,GACpBk/D,EAAQl/D,GACRglF,EAAW74B,SAASnsD,IAExBxxB,KAAKmsG,WAAa,WACd,OAAOrF,EAAMqF,cAEjBnsG,KAAK4rG,WAAa,SAAS/rB,GACvBinB,EAAM8E,WAAW/rB,GACjB42B,EAAc94B,SAASkC,IAG3B7/E,KAAK4lF,SAAW,SAAUxrD,GACtB0sE,EAAMlhB,SAASxrD,IAEnBp6B,KAAK0rG,WAAa,SAAUtxE,GACxB0sE,EAAM4E,WAAWtxE,IAErBp6B,KAAK6qG,UAAY,SAAUxsF,EAAGC,EAAGo7C,GAC7BotC,EAAM+D,UAAUxsF,EAAGC,IAEvBte,KAAKgrG,OAAS,SAAU3sF,EAAGC,EAAGo7C,EAAG2F,GAC7BynC,EAAMkE,OAAO3sF,EAAGC,IAEpBte,KAAKirG,QAAU,WACXnE,EAAMmE,WAEVjrG,KAAK03G,SAAW,WACZ,OAAO5Q,GAEX9mG,KAAKukE,UAAY,WACb,OAAOuiC,EAAMtiC,gBAEjBxkE,KAAKk9E,WAAa,WACd,OAAO99D,IAIRk3F,EArVkB,GCEhBuD,GAET,CACAC,SAAUzD,GACV0D,WAAYnC,GACZoC,aAAchC,GACdiC,WAAY5B,GACZ6B,WAAYb,GACZc,YAAalB,GACbmB,YAAazB,aCpBD0B,GAAgB99G,EAAK+9G,GACjC,IAAKA,IAAYx6G,OAAO48E,YAAc,KAAO58E,OAAO28E,WAAa,KAE7D,YADA38E,OAAOkW,KAAKzZ,GAIhB,IAYIg+G,EAZA7kG,EAASq2D,GAAG1+D,GAAG,CACfwhE,QAAS,SACT3R,OAAQ,CACJpnD,IAAKvZ,GAETw4E,IAAK,CACDjjB,MAAO,OACPC,OAAQ,UAGZ4qB,EAAU5Q,GAAG1+D,GAAG,IAGfitG,IACDC,EAASxuC,GAAG1+D,GAAG,CACXwhE,QAAS,IACTxnD,OAAQs1D,EACR5nE,QAAS0jE,GAAK,iBACdvb,OAAQ,CACJxd,KAAM,OACNtxC,OAAQ,UAEZ6mE,QAAS,WACLulC,EAAMplG,WAGdM,EAAO+kG,OAAS,WACZ1uC,GAAG2uC,cAAcH,EAAQ,CACrB76D,KAAM,GAAKhqC,EAAOK,cAAc6O,aAM5C,IAAI41F,EAAQ,IAAI7+B,GAAM,CAClBjN,MAAOiO,EACP5nE,QAASW,EACTo8C,MAAO,IACP6oD,aAAa,EACb1+B,QAAO,KACCs+B,GACAxuC,GAAGiP,UAAUu/B,YCxChBK,GASDC,YACJ,IAAK76G,KAAK86G,UACN,OAEJ,IACIC,EADAC,GAAM,IAAI7tC,MAAOe,UAAYluE,KAAK86G,UAEtCE,EAAMr9G,KAAKyO,MAAM4uG,EAAM,IAAO,IAC9BD,EAAStiC,GAAK,wBAAwBj8E,QAAQ,MAAO,GAAKw+G,GACtDA,EAAM,KACNA,EAAMr9G,KAAKyO,MAAM4uG,EAAM,IACvBD,EAAStiC,GAAK,0BAA0Bj8E,QAAQ,MAAO,GAAKw+G,GACxDA,EAAM,KACNA,EAAMr9G,KAAKyO,MAAM4uG,EAAM,IACvBD,EAAStiC,GAAK,yBAAyBj8E,QAAQ,MAAO,GAAKw+G,GACvDA,EAAM,KACND,EAAStiC,GAAK,6BAI1Bz4E,KAAKi7G,MAAMx8G,YAAcs8G,EAGrBG,eACAl7G,KAAK86G,WACL96G,KAAKm7G,QAAQ18G,YAAcg6E,GAAK,0BAChCz4E,KAAKm7G,QAAQC,UAAW,EACxBp7G,KAAKq7G,QAAQD,UAAW,IAExBp7G,KAAKm7G,QAAQ18G,YAAcg6E,GAAK,sBAChCz4E,KAAKm7G,QAAQC,UAAW,EACxBp7G,KAAKq7G,QAAQD,UAAW,GAIxBE,YAAYR,EAAoBS,GACpCv7G,KAAK86G,UAAYA,EACb96G,KAAK86G,WACL/uC,GAAGgJ,IAAIwmC,EAAW,CACd1lG,QAAS,QACT2lG,SAAU,mBACVC,UAAW,mBACXp1B,OAAQ,SACR3M,WAAY,QAAU3N,GAAG2vC,oBAAoB,GAAGh2C,UAAU,aAAe,KACzEiU,UAAW,iBACX6H,cAAe,SAEnBxhF,KAAKgjF,UAAUvO,UAAY,GAC3Bz0E,KAAK66G,YACL76G,KAAKgjF,UAAUz8B,OAAOg1D,EAAWv7G,KAAKi7G,QAEtCj7G,KAAKgjF,UAAUvO,UAAYgE,GAAK,sBAEpCz4E,KAAKk7G,6BAILl7G,KAAKm7G,QAAQ18G,YAAcg6E,GAAK,wBAChCz4E,KAAKm7G,QAAQC,UAAW,EACxBp7G,KAAKq7G,QAAQD,UAAW,QAClB,IAAI79G,SAASJ,IACf2oB,YAAU,IAAO3oB,EAAQ,OAAO,OAEpC,UACU6C,KAAK27G,aAAa/+E,MAAM58B,KAAK47G,cACnC57G,KAAK67G,aAAaxxB,QACpB,MAAO3rF,GACLsB,KAAKk7G,eACLrS,GAAG2R,MAAM,CACLpsG,OAAQpO,KAAK87G,SACbv9G,KAAM,QACNimC,QAAS,IACFi0C,GAAK,sCACDA,GAAK,uCACLA,GAAK,uCACLA,GAAK,yCAEd1sE,KAAK,IACPgwD,QAAS,CAAC,QAEdj2C,YAAU,KACN,MAAM,IAAI3pB,MAAM,gDAAkDuC,KACnE,kBAKPsB,KAAKm7G,QAAQC,UAAW,EACxBp7G,KAAKq7G,QAAQD,UAAW,EACxB,UACUp7G,KAAK27G,aAAa31F,QAC1B,MAAOtnB,GACLsB,KAAKk7G,eACLrS,GAAG2R,MAAM,CACLpsG,OAAQpO,KAAK87G,SACbv9G,KAAM,QACNimC,QAASi0C,GAAK,6BACd1c,QAAS,CAAC,QAEdj2C,YAAU,KACN,MAAM,IAAI3pB,MAAM,gDAAkDuC,KACnE,IAoJXw+E,aACI,OAAOl9E,KAAKyS,QAGhBypF,QAIA6f,oBArJYJ,EACAC,EACAC,EACAC,QAHAH,aAAAA,OACAC,WAAAA,OACAC,aAAAA,OACAC,SAAAA,EAER97G,KAAKyS,QAAUs5D,GAAG1+D,GAAG,CACjB0nE,IAAK,CACDl/D,QAAS,OACTmmG,oBAAqB,UACrBC,iBAAkB,cAClBC,IAAK,MACLC,kBAAmB,mDAK3B,MAAMztC,EAAQ3C,GAAG1+D,GAAG,CAChBga,OAAQrnB,KAAKyS,QACbsC,QAAS0jE,GAAK,gBACd1D,IAAK,CACDqnC,SAAU,QACVvmG,QAAS,OACTwwE,OAAQ,YAKDta,GAAG1+D,GAAG,CACjBga,OAAQqnD,EACR35D,QAAS,IACT25D,MAAO+J,GAAK,sBACZ1D,IAAK,CACDiJ,OAAQ,UACRnD,WAAY,MACZ/oB,MAAO,OACPC,OAAQ,OACRqqB,aAAc,OACdkL,UAAW,SACX7N,WAAY,OACZkV,WAAY,OACZhV,UAAW,wBAEf1E,QAAO,KACHolC,GAAgB,gCAAgC,MAIpDr6G,KAAK27G,aAAaU,WAClBtwC,GAAG1+D,GAAG,CACFga,OAAQrnB,KAAKyS,QACbsC,QAAS,MAAI0jE,GAAG,4BAChB1D,IAAK,CACD6F,UAAW,WAMvB56E,KAAKgjF,UAAYjX,GAAG1+D,GAAG,CACnBga,OAAQrnB,KAAKyS,QACbi8D,MAAO+J,GAAK,4BACZ1D,IAAK,CACDqnC,SAAU,UACVvmG,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChB0B,UAAW,OACXrpD,SAAU,WACVooD,UAAW,uBACXD,WAAY,UACZqJ,MAAO,UACP5E,YAAa,gBAGrBn+E,KAAKi7G,MAAQlvC,GAAG1+D,GAAG,CACf0nE,IAAK,CACDxjD,SAAU,WACVxW,MAAO,IACP69D,OAAQ,IACR9mB,MAAO,OACPw1B,UAAW,SACX5N,WAAY,kBACZqJ,MAAO,OACPu5B,SAAU,UAGlBt8G,KAAKm7G,QAAUpvC,GAAG1+D,GAAG,CACjBga,OAAQrnB,KAAKyS,QACbo8D,QAAS,SACTmG,UAAW,aACXjgE,QAAS0jE,GAAK,sBACd1D,IAAK,CACDqnC,SAAU,SAGdl/C,OAAQ,CACJqgB,UAAU,GAEdtI,QAAO,IAAQj1E,KAAK48B,UAExB58B,KAAKm7G,QAAQ59B,UAAW,EACxBv9E,KAAKq7G,QAAUtvC,GAAG1+D,GAAG,CACjBga,OAAQrnB,KAAKyS,QACbo8D,QAAS,SACTmG,UAAW,aACXjgE,QAAS,aAAe6iE,EAAAgT,IAAiB,mBAAqBnS,GAAK,sBACnE1D,IAAK,CACDqnC,SAAU,SAGdl/C,OAAQ,CACJqgB,UAAU,GAEdtI,QAAO,IAAQj1E,KAAKgmB,UAGxBhmB,KAAK27G,aAAa9nE,UAAU,CACxB0oE,SAAQ,CAAGzB,EAAWS,KAClBv7G,KAAKs7G,YAAYR,EAAWS,MAIpCr2C,aAAW,IAAOllE,KAAK66G,aAAa,gBAGhC,IACI,MAAM2B,QAAmBx8G,KAAK27G,aAAac,OACvCD,EACAx8G,KAAKs7G,YAAYkB,EAAW1B,UAAW0B,EAAWjB,WAElDv7G,KAAKs7G,cAEX,MAAO58G,GACLonB,YAAU,KACN,MAAM,IAAI3pB,MAAM,oDAAsDuC,KACvE,mBCrQHg+G,GAAaC,GACzB,IAAIjuD,EAAQiuD,EAAU9/G,MAAK,2CACvB+/G,EAASC,KAAKnuD,EAAM,IACpBouD,EAAM,IAAIlnF,YAAYgnF,EAAO5gH,QAC7BwgC,EAAO,IAAItF,WAAW4lF,GAC1B,IAAK,IAAI/gH,EAAI,EAAGA,EAAIygC,EAAKxgC,OAAQD,IAC7BygC,EAAKzgC,GAAK6gH,EAAO5rF,WAAWj1B,GAEhC,OAAO,IAAI6xE,KAAK,CAACpxC,GAAO,CAACj+B,KAAQmwD,EAAM,cCDlCquD,GAAU1uC,GACf,OAAO,IAAI9wE,SAAO,CAAoBJ,EAASK,KAC3C,MAAM6uE,EAAK,IAAI2c,MACf,IACI3c,EAAGv2D,IAAMi2D,GAAGixC,eAAe3uC,GAC7B,MAAO3vE,GAEL,YADAlB,EAAO,mBAAqBkB,EAAE8lC,SAGlC6nC,EAAGouC,OAAM,KACLt9G,EAAQkvE,IAEZA,EAAG4wC,QAAU,WACTz/G,EAAO,+BAEX6uE,EAAGnuE,QAAU,WACTV,EAAO,wCAUN0/G,0BAEsB3tB,GAG3B,OAAOD,GAAYC,EAFNxjB,GAAGod,QAAQoG,EAAQz9B,MAAOy9B,EAAQx9B,OA/BrC,IAAA,KAgCUD,MAAQy9B,EAAQz9B,mCAIZy9B,GACxB,MAAO,CACHtzF,GAAI,EACJ6+G,WAAW,IAAI3tC,MAAOe,UACtBqtC,UAAWmB,GAAaQ,GAAiBC,gBAAgB5tB,GAAS7pB,UAAU,cAC5E5T,MAAOy9B,EAAQz9B,MACfC,OAAQw9B,EAAQx9B,OAChBy9B,OAAQD,EAAQC,OAAOlvD,KAAI3X,IACvB,IAAI0lD,EACJ,KAAI1lD,EAAK+1D,iBAAiB0+B,mBAItB,MAAM,IAAIjhH,MAAM,mBAEpB,OALIkyE,EAAOquC,GAAc/zF,EAAK+1D,MAA4BhZ,UAAU,cAK7D,CACHl+D,KAAMmhB,EAAKnhB,KACXq4E,QAASl3D,EAAKk3D,QACd4P,WAAY9mE,EAAK8mE,gBACjBphB,uCAMgBqzB,GAK5B,MAAMnS,EAAsB,CACxBz9B,MAAO4vC,EAAe5vC,MACtBC,OAAQ2vC,EAAe3vC,OACvBy9B,cAAejyF,QAAQmtB,IAAIg3E,EAAelS,OAAOlvD,KAAI+8E,GAASN,GAAUM,EAAMhvC,UACzE/tC,KAAG,CAAEo+C,EAAO3iF,KACF,CACHyL,KAAMk6F,EAAelS,OAAOzzF,GAAGyL,KAC/Bq4E,QAAS6hB,EAAelS,OAAOzzF,GAAG8jF,QAClC4P,WAAYiS,EAAelS,OAAOzzF,GAAG0zF,iBACrC/Q,OAKhB,IAAI68B,EAOJ,OALIA,EADA7Z,EAAe6Z,gBACGwB,GAAUrb,EAAe6Z,WAE/B2B,GAAiBC,gBAAgB5tB,GAG1C,CACHA,QAASA,EACTurB,UAAWpZ,EAAeoZ,UAC1BS,UAAWA,aCtFd+B,GAAU/3G,GACf,OAAO,IAAIhI,SAAO,CAAEJ,EAASK,KACzB+H,EAAKpI,EAASK,aCVtB,IAAI+/G,GCFJC,GAAiBvgH,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,aCkBtHiL,GAAA4V,SAAA5V,GAAAq1G,GAAAz/F,GAAA,oBAeSozF,EAAUhpG,EAAK4V,EAAMoc,GAC5B,IAAI+7B,EAAM,IAAIunD,eACdvnD,EAAIngD,KAAK,MAAO5N,GAChB+tD,EAAIwnD,aAAe,OACnBxnD,EAAIskD,OAAS,WACXmD,EAAOznD,EAAI0nD,SAAU7/F,EAAMoc,IAE7B+7B,EAAIj4D,QAAU,WACZoqB,QAAQjoB,MAAM,4BAEhB81D,EAAI2nD,gBAGGC,EAAa31G,GACpB,IAAI4V,EAAM,IAAI0/F,eAEd1/F,EAAIhI,KAAK,OAAQ5N,GAAjB,GACA,IACE4V,EAAI8/F,OACJ,MAAOE,IACT,OAAqB,KAAdhgG,EAAIm2B,QAA+B,KAAdn2B,EAAIm2B,gBAIzB6c,EAAO5oD,GACd,IACEA,EAAK6hB,cAAc,IAAIuoC,WAAW,UAClC,MAAOp4B,GACP,IAAIpc,EAAM5f,SAAS4rB,YAAY,eAC/BhM,EAAIigG,eAAe,SAAnB,GAAA,EAAwCn+G,OAAQ,EAAG,EAAG,EAAG,GACnC,IADtB,GAAA,GAAA,GAAA,EACsD,EAAG,MACzDsI,EAAK6hB,cAAcjM,QApDnBkgG,EAA4B,iBAAXp+G,QAAuBA,OAAOA,SAAWA,OAC1DA,OAAyB,iBAATC,MAAqBA,KAAKA,OAASA,KACnDA,KAAyB,iBAAXjC,GAAuBA,EAAO4R,SAAW5R,EACvDA,OADO,EAyDPqgH,EAAiBD,EAAQjsD,WAAR,YAAiCxxD,KAAKwxD,UAAUC,YAA3B,cAAuDzxD,KAAKwxD,UAAUC,aAA7B,SAAqDzxD,KAAKwxD,UAAUC,WAEnJ0rD,EAASM,EAAQE,SAEA,iBAAXt+G,QAAuBA,SAAWo+G,EACtC,aAGD,aAAcG,kBAAkBv9G,YAAcq9G,EAC/C,SAAiBngG,EAAMy2C,EAAM5C,GAAM,IAC/B91D,EAAMmiH,EAAQ3+D,KAAO2+D,EAAQI,UAC7B7hG,EAAIre,SAASC,cAAc,KAC/Bo2D,EAAOA,GAAQz2C,EAAKxW,MAAQ,WAE5BiV,EAAE8hG,SAAW9pD,EACbh4C,EAAE+hG,IAAM,WAKY,iBAATxgG,GAETvB,EAAEijC,KAAO1hC,EACLvB,EAAEwyC,SAAWrqC,SAASqqC,OAKxB+B,EAAMv0C,GAJNshG,EAAYthG,EAAEijC,MACV0xD,EAASpzF,EAAMy2C,EAAM5C,GACrBb,EAAMv0C,EAAGA,EAAErO,OAAS,YAM1BqO,EAAEijC,KAAO3jD,EAAI40D,gBAAgB3yC,GAC7B8H,YAAW,WAAc/pB,EAAI80D,gBAAgBp0C,EAAEijC,QAAS,KACxD55B,YAAW,WAAckrC,EAAMv0C,KAAM,KAKvC,qBAAsBw1C,UACtB,SAAiBr/B,EAAM6hC,EAAM5C,GAG7B,GAFA4C,EAAOA,GAAQ7hC,EAAKprB,MAAQ,WAER,iBAATorB,EAUTq/B,UAAUwsD,kBA1GFr2G,EA0GuBwqB,OAzGf,KADF5U,EA0GuB6zC,GAzGR7zC,EAAO,CAAE0gG,SAAO,GACxB,iBAAT1gG,IACdsK,QAAQq2F,KAAK,sDACb3gG,EAAO,CAAE0gG,SAAU1gG,IAKjBA,EAAK0gG,SAAL,6EAA6Fj+G,KAAK2H,EAAK7J,MAClG,IAAIqvE,KAAK,CAAA,SAA8BxlE,GAAO,CAAE7J,KAAM6J,EAAK7J,OAE7D6J,GA8FyCqsD,QAT5C,GAAIspD,EAAYnrF,GACdw+E,EAASx+E,EAAM6hC,EAAM5C,OAChB,CACL,IAAI91D,EAAIqC,SAASC,cAAc,KAC/BtC,EAAE2jD,KAAO9sB,EACT72B,EAAEqS,OAAS,SACX0X,YAAW,WAAckrC,EAAMj1D,UAvGzBqM,EAAM4V,GA+GhB,SAAiBA,EAAMm4C,EAAMz3D,EAAM+1D,GASnC,IANAA,EAAQA,GAASz+C,KAAK,GAAI,aAExBy+C,EAAMr2D,SAASswE,MACfja,EAAMr2D,SAAS0oD,KAAKsoC,UAAY,kBAGd,iBAATpxE,EAAmB,OAAOozF,EAASpzF,EAAMm4C,EAAMz3D,GAThB,IAWtCmzD,EAAsB,6BAAd7zC,EAAKzf,KACbxC,EAAQ,eAAkB0E,KAAKy9G,EAAQU,cAAgBV,EAAQW,OAC/DpiG,EAAW,eAAkBhc,KAAKwxD,UAAUC,WAEhD,IAAKz1C,GAAgBo1C,GAAS91D,GAAaoiH,IAAyC,oBAAfW,WAA4B,CAE/F,IAAI/iG,EAAS,IAAI+iG,WACjB/iG,EAAOgjG,UAAY,WACjB,IAAI32G,EAAM2T,EAAOlU,OACjBO,EAAMqU,EAAcrU,EAAMA,EAAI5L,QAAJ,eAA4B,yBAClDi4D,EAAOA,EAAM7vC,SAAS86B,KAAOt3C,EAC5Bwc,SAAWxc,EAChBqsD,EAAQ,MAEV14C,EAAOijG,cAAchhG,OAChB,CAAA,IACDu4D,EAAM2nC,EAAQ3+D,KAAO2+D,EAAQI,UAC7BvgH,EAAMw4E,EAAI5lB,gBAAgB3yC,GAC1By2C,EAAOA,EAAM7vC,SAAW7mB,EACvB6mB,SAAS86B,KAAO3hD,EACrB02D,EAAQ,KACR3uC,YAAW,WAAcywD,EAAI1lB,gBAAgB9yD,KAAQ,QAK3DmgH,EAAQE,OAASR,EAAOQ,OAASR,EAG/BH,GAAiBG,GAvJnB,mBAAAn2E,QAAAA,OAAAw3E,IAAAx3E,OAAA,GAAAzpB,SAAA,IAAAy/F,GAAAz/F,MAAAA,KAAA5V,GAAA82G,UAAA,UCNaC,GAKDrzF,KAAM7e,EAAwBmyG,GAClC,IAAK,IAAIrjH,EAAI,EAAGA,EAAIiE,KAAKq/G,cAAcrjH,OAAQD,IACvCiE,KAAKq/G,cAActjH,KAAOqjH,GAG9Bp/G,KAAKq/G,cAActjH,GAAGkR,GAqB9BqyG,UAAWv8B,EAAaq8B,GACpBp/G,KAAK8rB,KACD,CACIvtB,KAAM,QACN9B,MAAOsmF,GAEXq8B,GAIRG,SAAU/tF,EAAc4tF,GACpBp/G,KAAK8rB,KACD,CACIvtB,KAAM,OACN9B,MAAO+0B,GAEX4tF,GAIRI,YAAa3/B,EAAiBu/B,GAC1Bp/G,KAAK8rB,KACD,CACIvtB,KAAM,UACN9B,MAAOojF,GAEXu/B,GAIRK,iBAAkBC,EAA6BN,GAC3Cp/G,KAAK8rB,KACD,CACIvtB,KAAM,eACN9B,MAAOijH,GAEXN,GASRx5B,SAAU7C,EAAaq8B,GACnBp/G,KAAK2/G,WAAW58B,GAChB/iF,KAAKs/G,UAAUv8B,EAAOq8B,GAQ1B1uB,QAASl/D,EAAc4tF,GACnBp/G,KAAK4/G,UAAUpuF,GASnBo6E,WAAY/rB,EAAiBu/B,GACzBp/G,KAAK6/G,aAAahgC,GAOtBgG,WACI,OAAO7lF,KAAK8/G,aAGhB5T,UACI,OAAOlsG,KAAK+/G,YAGhB5T,aACI,OAAOnsG,KAAKggH,eAGhBC,kBACI,OAAOjgH,KAAKkgH,oBAOhBrsE,UAAWtuC,GACHvF,KAAKq/G,cAAc9xG,SAAShI,IAGhCvF,KAAKq/G,cAAcj5G,KAAKb,GAG5B6tC,YAAa7tC,GACT,IAAK,IAAIxJ,EAAI,EAAGA,EAAIiE,KAAKq/G,cAAcrjH,OAAQD,IACvCwJ,IAASvF,KAAKq/G,cAActjH,KAC5BiE,KAAKq/G,cAAcn5E,OAAOnqC,EAAG,GAC7BA,iBAtHA4jH,EACAC,EACAC,EACAC,EACAC,EACAC,EACAE,GAER,QARQP,WAAAA,OACAC,UAAAA,OACAC,aAAAA,OACAC,WAAAA,OACAC,UAAAA,OACAC,aAAAA,OACAE,kBAAAA,EAvBTlgH,KAGHq/G,cAA2C,GAsBnCF,GAAoBr4E,SACpB,MAAM,IAAI3qC,MAAM,4CAEpBgjH,GAAoBr4E,SAAW9mC,aCxCvCmgH,GAAiBljH,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBCAtHijH,GAAiBnjH,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SC6E/G,MAAM0rG,GAAK,SAGdP,aACAuR,uBACAsF,kB5FtBQ97E,KAAMuuB,EAAWC,GACrB,IAAKD,IAAMC,GAAK2e,MAAM5e,IAAM4e,MAAM3e,IAAMD,EAAI,GAAKC,EAAI,EACjD,MAAM,IAAI11D,MAAM,8BAEpB6D,KAAK8xD,MAAQF,EACb5xD,KAAK+xD,OAASF,EAGVwuD,aAEJrgH,KAAKsgH,kBAAkBjgF,SAAQ1X,GAAQA,MAGnC43F,gBACJvgH,KAAKwgH,eAAengF,SAAO,CAAE1X,EAAM/b,KAC/B+b,EAAK/b,MAAQA,KAsErB++F,WAAY95C,GACR7xD,KAAK4oG,QAAU/2C,EAQnBw4B,MACI3wB,GAcA,IAAKA,EAAE5H,QAAU4H,EAAE3H,QAAU2H,EAAE5H,MAAQ,GAAK4H,EAAE3H,OAAS,GAAKye,MAAM9W,EAAE5H,QAAU0e,MAAM9W,EAAE3H,QAClF,MAAM,IAAI51D,MAAM,uBAUpB,GAPA6D,KAAK4oG,QAAQvyB,OAAM,GAEnBr2E,KAAK8xD,MAAQ4H,EAAE5H,MACf9xD,KAAK+xD,OAAS2H,EAAE3H,OAEhB/xD,KAAKwgH,eAAet6E,OAAO,EAAGvoC,KAAK6O,IAAI,EAAGxM,KAAKwgH,eAAexkH,OAAS,IAEnE09D,EAAE81B,OACF,IAAK,IAAIzzF,EAAI,EAAGA,EAAI29D,EAAE81B,OAAOxzF,OAAQD,IAAK,CACtC,IAAI4sB,EAAO+wC,EAAE81B,OAAOzzF,GACfiE,KAAKwgH,eAAezkH,IACrBiE,KAAKygH,WAETzgH,KAAKwgH,eAAezkH,GAAGyL,KAAOmhB,EAAKnhB,KACnCxH,KAAKwgH,eAAezkH,GAAG+1D,MAAQ9xD,KAAK8xD,MACpC9xD,KAAKwgH,eAAezkH,GAAGg2D,OAAS/xD,KAAK+xD,OACrC/xD,KAAKwgH,eAAezkH,GAAG0zF,WAAa9mE,EAAK8mE,WAAa9mE,EAAK8mE,WAAa,cACxEzvF,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAAM0e,UAAU7oD,EAAK+1D,MAAO,EAAG,GACjE1+E,KAAK0gH,aAAa3kH,EAAG4sB,EAAKk3D,cAG9B7/E,KAAKwgH,eAAe,GAAGh5G,KAAOkyD,EAAEinD,UAAYjnD,EAAEinD,UAAYloC,GAAK,gBAAkB,KACjFz4E,KAAKwgH,eAAe,GAAG1uD,MAAQ9xD,KAAK8xD,MACpC9xD,KAAKwgH,eAAe,GAAGzuD,OAAS/xD,KAAK+xD,OACrC/xD,KAAKwgH,eAAe,GAAG/wB,WAAa,cACpCzvF,KAAK0gH,aAAa,EAAG,GACjBhnD,EAAEqpB,MACF/iF,KAAK4gH,UAAU,EAAGlnD,EAAEqpB,OACbrpB,EAAEglB,OACT1+E,KAAKwgH,eAAe,GAAG1tD,WAAW,MAAM0e,UAAU9X,EAAEglB,MAAO,EAAG,GAatE,OAVA1+E,KAAKugH,gBAELvgH,KAAK4oG,QAAQvyB,OAAM,GAEnBr2E,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,QACRzxB,OAAQ,CAACiU,KAGN15D,KAAKwgH,eAAexkH,OAAS,EAGxC6kH,sBACI,OAAO7gH,KAAKwgH,eAAexkH,QA9LT,GAiMtB8kH,WACI,OAAO9gH,KAAK8xD,MAGhBivD,YACI,OAAO/gH,KAAK+xD,OAGhBivD,KAAMC,GACF,GACIA,EAAaH,WAAa,GAC1BG,EAAaF,YAAc,GAC3BvwC,MAAMywC,EAAaH,aACnBtwC,MAAMywC,EAAaF,aAEnB,MAAM,IAAI5kH,MAAM,uBAKpB,IAAI+kH,EAAaD,EAAaE,iBAEvBnhH,KAAKwgH,eAAexkH,OAASklH,EAAWllH,QAC3CgE,KAAKohH,YAAYphH,KAAKwgH,eAAexkH,OAAS,GAG9CilH,EAAaH,YAAc9gH,KAAK8xD,OAASmvD,EAAaF,aAAe/gH,KAAK+xD,QAC1E/xD,KAAKqjC,KAAK49E,EAAaH,WAAYG,EAAaF,aAEpD,IAAK,IAAIhlH,EAAI,EAAGA,EAAImlH,EAAWllH,OAAQD,IAC/BA,GAAKiE,KAAKwgH,eAAexkH,OACzBgE,KAAKygH,YAELzgH,KAAKwgH,eAAezkH,GAAG+1D,MAAQ9xD,KAAK8xD,MACpC9xD,KAAKwgH,eAAezkH,GAAGg2D,OAAS/xD,KAAK+xD,QAEzC/xD,KAAK0gH,aAAa3kH,EAAGmlH,EAAWnlH,GAAG8jF,SACnC7/E,KAAKwgH,eAAezkH,GAAGyL,KAAO05G,EAAWnlH,GAAGyL,KAC5CxH,KAAKwgH,eAAezkH,GAAG0zF,WAAayxB,EAAWnlH,GAAG0zF,WAClDzvF,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAAM0e,UAAU0vC,EAAWnlH,GAAGwsG,QAAQ11C,OAAQ,EAAG,GAEvF7yD,KAAKugH,gBAGTc,gBACI,OAAOrhH,KAAKwgH,eAAexkH,OAG/B2nG,OAAQ/xC,EAAWC,EAAWyvD,EAAoC,UAC9D,IAAK1vD,IAAMC,GAAMD,IAAM5xD,KAAK8xD,OAASD,IAAM7xD,KAAK+xD,QAAWye,MAAM5e,IAAM4e,MAAM3e,IAAMD,EAAI,GAAKC,EAAI,EAC5F,OAAO,EAKX,IAAI8gB,EAAMC,EAEV,GALAhhB,EAAIj0D,KAAK6O,IAAIolD,EAAG,GAChBC,EAAIl0D,KAAK6O,IAAIqlD,EAAG,GAIE,cAAdyvD,EAA2B,CAC3B3uC,EAAO5G,GAAGlZ,OAAOjB,EAAGC,GACpB,IAAIuiB,EAAUzB,EAAK7f,WAAW,MAC9BshB,EAAQlC,uBAAwB,EAChC,IAAK,IAAIn2E,EAAI,EAAGA,EAAIiE,KAAKwgH,eAAexkH,OAAQD,IAAK,CAC7CA,EAAI,GACJq4E,EAAQoe,UAAU,EAAG,EAAG5gC,EAAGC,GAE/B,IAAI0vD,EAAcvhH,KAAKwgH,eAAezkH,GACtCq4E,EAAQ5C,UAAU+vC,EAAa,EAAG,EAAG3vD,EAAGC,GACxC0vD,EAAYzvD,MAAQF,EACpB2vD,EAAYxvD,OAASF,EACF0vD,EAAYzuD,WAAW,MAC7B0e,UAAUmB,EAAM,EAAG,QAGjC,CAAA,GAAkB,WAAd2uC,EAOP,MAAM,IAAInlH,MAAM,4BANhBw2E,EAAO5G,GAAGlZ,SACV+f,EAAO7G,GAAGlZ,SACV,IAAK,IAAI92D,EAAI,EAAGA,EAAIiE,KAAKwgH,eAAexkH,OAAQD,IAC5CgwE,GAAGy1C,aAAaxhH,KAAKwgH,eAAezkH,GAAI61D,EAAGC,EAAG8gB,EAAMC,GAQ5D,OAFA5yE,KAAK8xD,MAAQF,EACb5xD,KAAK+xD,OAASF,GACP,EAOX2vD,aAAc9nD,GAQV,MAAMsZ,EAAOr1E,KAAK4jC,MAAMm4B,EAAE5+C,MAAQ9a,KAAK8xD,MAAQn0D,KAAK4jC,MAAMm4B,EAAE3+C,OACtDk4D,EAAOt1E,KAAK4jC,MAAMm4B,EAAEnG,KAAOvzD,KAAK+xD,OAASp0D,KAAK4jC,MAAMm4B,EAAEkf,QACtD6oC,EAAO9jH,KAAK4jC,MAAMm4B,EAAE5+C,MACpB4mG,EAAO/jH,KAAK4jC,MAAMm4B,EAAEnG,KAE1B,GAAIid,MAAMwC,IAASxC,MAAMyC,IAASD,EAAO,GAAKC,EAAO,EACjD,MAAM,IAAI92E,MAAM,+CAGpB,IAAK,IAAIJ,EAAI,EAAGA,EAAIiE,KAAKwgH,eAAexkH,OAAQD,IAAK,CACjD,MAAM4lH,EAAQ51C,GAAGlZ,OAAO7yD,KAAK8xD,MAAO9xD,KAAK+xD,QACzC,IAAIwvD,EAAcvhH,KAAKwgH,eAAezkH,GAClC6lH,EAAW5hH,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MACjD6uD,EAAM7uD,WAAW,MAAM0e,UAAU+vC,EAAa,EAAG,GAEjDvhH,KAAKwgH,eAAezkH,GAAG+1D,MAAQkhB,EAC/BhzE,KAAKwgH,eAAezkH,GAAGg2D,OAASkhB,EAEhC2uC,EAAS3vC,OACC,IAANl2E,GAAW29D,EAAEmoD,YACbD,EAASt8C,UAAYyG,GAAGkX,eAAetY,SAASjR,EAAEmoD,WAClDD,EAASr8C,SAAS,EAAG,EAAGyN,EAAMC,GAC9B2uC,EAASpvB,UAAUivB,EAAMC,EAAM1hH,KAAK8xD,MAAO9xD,KAAK+xD,SAEpD6vD,EAASpwC,UAAUmwC,EAAOF,EAAMC,GAChCE,EAAStvC,UAEbtyE,KAAK8xD,MAAQkhB,EACbhzE,KAAK+xD,OAASkhB,EAOlBwtC,SAAUqB,GACN,GAAI9hH,KAAK6gH,sBACL,OAAO,EAEX,IAAIhuD,EAASkZ,GAAGlZ,OAAO7yD,KAAK8xD,MAAO9xD,KAAK+xD,QAqBxC,OApBCc,EAAe48B,WAAa,mBAEZ3sF,IAAbg/G,GACA9hH,KAAKwgH,eAAexgH,KAAKwgH,eAAexkH,QAAU62D,EAClDivD,EAAWnkH,KAAK6O,IAAI,EAAGxM,KAAKwgH,eAAexkH,OAAS,KAEpDgE,KAAKwgH,eAAet6E,OAAO47E,EAAW,EAAG,EAAGjvD,GAC5CivD,KAGHjvD,EAAerrD,KAAOixE,GAAK,gBAAkB,KAAOz4E,KAAKwgH,eAAexkH,OAASgE,KAAK+hH,eACvF/hH,KAAK4oG,QAAQvyB,OAAM,GACnBr2E,KAAK0gH,aAAaoB,EAAU,GAC5B9hH,KAAK4oG,QAAQvyB,OAAM,GACnBr2E,KAAKugH,gBACLvgH,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,WACRzxB,OAAQ,CAACq8D,EAAW,KAEjBA,EAGXE,eAAgBjmH,GACZ,IAAKiE,KAAKwgH,eAAezkH,IAAMiE,KAAK6gH,sBAChC,OAAO,EAEX,IAAIhuD,EAASkZ,GAAGlZ,OAAO7yD,KAAK8xD,MAAO9xD,KAAK+xD,QAiBxC,OAhBA/xD,KAAKwgH,eAAet6E,OAAOnqC,EAAI,EAAG,EAAG82D,GAEpCA,EAAerrD,KAAOxH,KAAKwgH,eAAezkH,GAAGyL,KAAO,IAAMixE,GAAK,eAC/D5lB,EAAe48B,WAAazvF,KAAKwgH,eAAezkH,GAAG0zF,WACpD58B,EAAOC,WAAW,MAAM0e,UAAUxxE,KAAKwgH,eAAezkH,GAAI,EAAG,GAC7DiE,KAAK4oG,QAAQvyB,OAAM,GACnBr2E,KAAK0gH,aAAa3kH,EAAI,EAAGiE,KAAKwgH,eAAezkH,GAAG8jF,SAChD7/E,KAAK4oG,QAAQvyB,OAAM,GAEnBr2E,KAAKugH,gBAELvgH,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,iBACRzxB,OAAQ,CAAC1pD,KAENA,EAAI,EAGfkmH,gBAAiBlmH,EAAWmmH,GACxB,GAAIliH,KAAKwgH,eAAezkH,GACpB,OAAOiE,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAE7C,GAAIovD,EACA,OAAO,KAEX,MAAM,IAAI/lH,MAAM,kBAAoBJ,EAAI,kBAAoBiE,KAAKwgH,eAAexkH,OAAS,YAG7FolH,YAAarlH,GACT,QAAIiE,KAAKwgH,eAAezkH,KACpBiE,KAAKwgH,eAAet6E,OAAOnqC,EAAG,GAC9BiE,KAAKugH,gBAITvgH,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,cACRzxB,OAAQ,CAAC1pD,KAGN4B,KAAK6O,IAAI,EAAGzQ,EAAI,IAG3BomH,YAAapmH,EAAWyL,GACpB,QAAIxH,KAAKwgH,eAAezkH,KACpBiE,KAAKwgH,eAAezkH,GAAGyL,KAAOA,EAKlCxH,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,cACRzxB,OAAQ,CAAC1pD,EAAGyL,MAGT,GAGXk5G,aAAc3kH,EAAWquE,GAChBpqE,KAAKwgH,eAAezkH,KAGzBquE,EAAIzsE,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAG09D,IAC5BpqE,KAAKwgH,eAAezkH,GAAG8jF,QAAUzV,EAEjCpqE,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,eACRzxB,OAAQ,CAAC1pD,EAAGquE,KAGhBpqE,KAAKqgH,cAGT+B,UAAWrmH,EAAWo6D,GAClB,GAAU,IAANA,GAGAn2D,KAAKwgH,eAAezkH,GAAI,CACxB,MAAMsZ,EAAOrV,KAAKwgH,eAAezkH,GACjCiE,KAAKwgH,eAAet6E,OAAOnqC,EAAG,GAC9B,MAAM4W,EAAchV,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI3Q,EAAIo6D,EAAGn2D,KAAKwgH,eAAexkH,SAQpE,OAPAgE,KAAKwgH,eAAet6E,OAAOvzB,EAAa,EAAG0C,GAC3CrV,KAAKugH,gBACLvgH,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,YACRzxB,OAAQ,CAAC1pD,EAAGo6D,KAETxjD,GAIf0vG,YAAaC,EAA0BC,EAAuB9yB,GAC1D,IACKzvF,KAAKwgH,eAAe8B,KACpBtiH,KAAKwgH,eAAe+B,IACrBD,IAAqBC,EAErB,OAGJ,GAAID,EAAmBC,EAAe,CAClC,IAAIltG,EAAOitG,EACXA,EAAmBC,EACnBA,EAAgBltG,EAGpB,IAAImtG,EAAaxiH,KAAKwgH,eAAe+B,GAAe1iC,QACpD,GAAmB,IAAf2iC,GAAoBA,EAAY,CAChC,IAAIn9C,EAAMrlE,KAAKwgH,eAAe8B,GAAkBxvD,WAAW,MAC3DuS,EAAI4M,OAEe,aAAfwd,GAEA1jB,GAAG02C,4BAA4BziH,KAAKwgH,eAAe+B,IACnDl9C,EAAIwO,yBAA2B,iBAC/BxO,EAAI+mB,YAAco2B,EAClBxiH,KAAKwgH,eAAe8B,GAAkBxvD,WAAW,MAAM0e,UAAUxxE,KAAKwgH,eAAe+B,GAAgB,EAAG,KAIpG9yB,IACApqB,EAAIwO,yBAA2B4b,GAEnCpqB,EAAI+mB,YAAco2B,EAClBxiH,KAAKwgH,eAAe8B,GAAkBxvD,WAAW,MAAM0e,UAAUxxE,KAAKwgH,eAAe+B,GAAgB,EAAG,IAI5Gl9C,EAAIiN,UAIAmd,IACApqB,EAAI4M,OACJ5M,EAAIC,UAAY,mBAChBD,EAAIE,UAAS,UAAY,SAAY,EAAG,GACxCF,EAAIiN,WAaZ,OAVAtyE,KAAKugH,gBACLvgH,KAAK4oG,QAAQvyB,OAAM,GACnBr2E,KAAKohH,YAAYmB,GACjBviH,KAAK4oG,QAAQvyB,OAAM,GACnBr2E,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,cACRzxB,OAAQ,CAAC68D,EAAkBC,EAAe9yB,KAGvC6yB,EAGXjwC,OAAQta,QACGA,EAAM,GACTA,GAAO,IAGX,IADAA,GAAO,KACG,IAAM,GAAa,IAARA,EACjB,OACJ,IAAI1iD,EAAO02D,GAAGlZ,SACF,IAARkF,GAAqB,MAARA,GACb1iD,EAAKy8C,MAAQ9xD,KAAK8xD,MAClBz8C,EAAK08C,OAAS/xD,KAAK+xD,QACJ,KAARgG,GAAsB,MAARA,IACrB1iD,EAAKy8C,MAAQ9xD,KAAK+xD,OAClB18C,EAAK08C,OAAS/xD,KAAK8xD,OAEvB,IAAIuT,EAAMhwD,EAAKy9C,WAAW,MAC1B,IAAK,IAAI/2D,EAAI,EAAGA,EAAIiE,KAAKwgH,eAAexkH,OAAQD,IAC5CspE,EAAImtB,UAAU,EAAG,EAAGn9E,EAAKy8C,MAAOz8C,EAAK08C,QACrCsT,EAAI4M,OACJ5M,EAAI+M,UAAU/8D,EAAKy8C,MAAQ,EAAGz8C,EAAK08C,OAAS,GAC5CsT,EAAIgN,OAAOta,EAAMp6D,KAAKuvC,GAAK,KACf,MAAR6qB,EACAsN,EAAImM,UAAUxxE,KAAKwgH,eAAezkH,IAAKsZ,EAAKy8C,MAAQ,GAAIz8C,EAAK08C,OAAS,GACvD,KAARgG,GAAsB,MAARA,GACrBsN,EAAImM,UAAUxxE,KAAKwgH,eAAezkH,IAAKsZ,EAAK08C,OAAS,GAAI18C,EAAKy8C,MAAQ,GAE1E9xD,KAAKwgH,eAAezkH,GAAG+1D,MAAQz8C,EAAKy8C,MACpC9xD,KAAKwgH,eAAezkH,GAAGg2D,OAAS18C,EAAK08C,OACrC/xD,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAAM0/B,UAAU,EAAG,EAAGxyF,KAAKwgH,eAAezkH,GAAG+1D,MAAO9xD,KAAKwgH,eAAezkH,GAAGg2D,QAC7G/xD,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAAM0e,UAAUn8D,EAAM,EAAG,GAC3DgwD,EAAIiN,UAERtyE,KAAK8xD,MAAQz8C,EAAKy8C,MAClB9xD,KAAK+xD,OAAS18C,EAAK08C,OAGvB8hC,KAAM6uB,EAAuBlsB,EAAqBmsB,GAC9C,IAAKD,IAAiBlsB,EAClB,OAGJ,IAAInhF,EAAO02D,GAAGlZ,OAAO7yD,KAAK8xD,MAAO9xD,KAAK+xD,QACtC18C,EAAKy8C,MAAQ9xD,KAAK8xD,MAClBz8C,EAAK08C,OAAS/xD,KAAK+xD,OACnB,IAAI6wD,EAAUvtG,EAAKy9C,WAAW,MAE9B,IAAK,IAAI/2D,EAAI,EAAGA,EAAIiE,KAAKwgH,eAAexkH,OAAQD,MAEtC4mH,GAA6B,IAAfA,GAAqB5mH,IAAM4mH,KAI/CC,EAAQ3wC,OACR2wC,EAAQpwB,UAAU,EAAG,EAAGn9E,EAAKy8C,MAAOz8C,EAAK08C,QACzC6wD,EAAQxwC,UAAU/8D,EAAKy8C,MAAQ,EAAGz8C,EAAK08C,OAAS,GAChD6wD,EAAQr1E,MAAOm1E,GAAe,EAAK,EAAKlsB,GAAa,EAAK,GAC1DosB,EAAQpxC,UAAUxxE,KAAKwgH,eAAezkH,IAAKsZ,EAAKy8C,MAAQ,GAAIz8C,EAAK08C,OAAS,GAC1E6wD,EAAQtwC,UAERtyE,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAAM0/B,UAAU,EAAG,EAAGxyF,KAAKwgH,eAAezkH,GAAG+1D,MAAO9xD,KAAKwgH,eAAezkH,GAAGg2D,QAC7G/xD,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAAM0e,UAAUn8D,EAAM,EAAG,IAInEurG,UAAW+B,EAAoBE,EAAgBC,GAC3C,IAAIz9C,EAAMrlE,KAAKwgH,eAAemC,GAAY7vD,WAAW,MACrDuS,EAAI4M,OACA6wC,IACAz9C,EAAIwO,yBAA2BivC,GAEnCz9C,EAAIC,UAAY,QAAUu9C,EAASr2F,EAAI,IAAMq2F,EAASpuD,EAAI,IAAMouD,EAAS7kG,EAAI,MAC7EqnD,EAAIE,SAAS,EAAG,EAAGvlE,KAAKwgH,eAAemC,GAAY7wD,MAAO9xD,KAAKwgH,eAAemC,GAAY5wD,QAC1FsT,EAAIiN,UAIJjN,EAAI4M,OACJ5M,EAAIC,UAAY,mBAChBD,EAAIE,UAAS,UAAY,SAAY,EAAG,GACxCF,EAAIiN,UAgCJtyE,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,YACRzxB,OAAQ,CAACk9D,EAAYE,EAAUC,KAIvCC,UACIJ,EACAtkG,EACAC,EACA0kG,EACAnjC,EACAwL,EACA43B,EACAz3B,EACAC,GAEA,GAAIptE,EAAI,GAAKC,EAAI,GAAKD,GAAKre,KAAK8xD,OAASxzC,GAAKte,KAAK+xD,QAAsB,IAAZ8tB,EACzD,OAIJ,GAFAwL,EAAY1tF,KAAK4jC,MAAM8pD,IAEjB,CAAC,QAAS,UAAW,OAAO99E,SAAS01G,GACvC,MAAM,IAAI9mH,MAAM,qBAGpB,IAAI0L,EAEAq7G,EACAC,EACAC,EAEAC,EACAC,EACAC,EAGJ,GAAkB,QAAdN,EAAqB,CAErB,IAAIO,EAA2C,IAA/BxjH,KAAKwgH,eAAexkH,OAAegE,KAAKwgH,eAAe,GAAKxgH,KAAKyjH,kBAAkB,GACnGP,EAASM,EAAU1wD,WAAW,MAC9BqwD,EAAeD,EAAO5uC,aAAa,EAAG,EAAGt0E,KAAK8xD,MAAO9xD,KAAK+xD,QAC1DqxD,EAAUD,EAAal0G,KACvBpH,EAASyjF,GAAc83B,EAASpjH,KAAK8xD,MAAO9xD,KAAK+xD,OAAQ1zC,EAAGC,EAAG+sE,EAAW1tF,KAAK4jC,MAAMiqD,GAAOC,GAE5F+3B,EAAY,KACZN,EAAS,KACTC,EAAe,KACfC,EAAU,KAEVC,EAAYrjH,KAAKwgH,eAAemC,GAAY7vD,WAAW,MACvDwwD,EAAkBD,EAAU/uC,aAAa,EAAG,EAAGt0E,KAAK8xD,MAAO9xD,KAAK+xD,YAE7D,CACH,IAAI2xD,EAAyB,UAAdT,EAAwBN,EAAa,EAAIA,EAExD,GAAIe,GAAY1jH,KAAKwgH,eAAexkH,OAChC,OAGJknH,EAASljH,KAAKwgH,eAAekD,GAAU5wD,WAAW,MAClDqwD,EAAeD,EAAO5uC,aAAa,EAAG,EAAGt0E,KAAK8xD,MAAO9xD,KAAK+xD,QAC1DqxD,EAAUD,EAAal0G,KACvBpH,EAASyjF,GAAc83B,EAASpjH,KAAK8xD,MAAO9xD,KAAK+xD,OAAQ1zC,EAAGC,EAAG+sE,EAAW1tF,KAAK4jC,MAAMiqD,GAAOC,GAExFk3B,IAAee,IACfR,EAAS,KACTC,EAAe,KACfC,EAAU,MAGdC,EAAYV,IAAee,EAAWR,EAASljH,KAAKwgH,eAAemC,GAAY7vD,WAAW,MAC1FwwD,EAAkBX,IAAee,EAAWP,EAAeE,EAAU/uC,aAAa,EAAG,EAAGt0E,KAAK8xD,MAAO9xD,KAAK+xD,QAK7G,GADAwxD,EAAaD,EAAgBr0G,KACb,IAAZ4wE,EACA,IAAK,IAAI9jF,EAAI,EAAGA,EAAIiE,KAAK8xD,MAAQ9xD,KAAK+xD,OAAQh2D,IACnB,MAAnB8L,EAAOoH,KAAKlT,KACZwnH,EAAe,EAAJxnH,GAASinH,EAAIx2F,EACxB+2F,EAAe,EAAJxnH,EAAQ,GAAKinH,EAAIvuD,EAC5B8uD,EAAe,EAAJxnH,EAAQ,GAAKinH,EAAIhlG,EAC5BulG,EAAe,EAAJxnH,EAAQ,GAAK,UAIhC,IAAK,IAAIA,EAAI,EAAGA,EAAIiE,KAAK8xD,MAAQ9xD,KAAK+xD,OAAQh2D,IACnB,MAAnB8L,EAAOoH,KAAKlT,KACZwnH,EAAe,EAAJxnH,GAASgwE,GAAG+7B,IAAIyb,EAAe,EAAJxnH,GAAQinH,EAAIx2F,EAAGqzD,GACrD0jC,EAAe,EAAJxnH,EAAQ,GAAKgwE,GAAG+7B,IAAIyb,EAAe,EAAJxnH,EAAQ,GAAIinH,EAAIvuD,EAAGorB,GAC7D0jC,EAAe,EAAJxnH,EAAQ,GAAKgwE,GAAG+7B,IAAIyb,EAAe,EAAJxnH,EAAQ,GAAIinH,EAAIhlG,EAAG6hE,GAC7D0jC,EAAe,EAAJxnH,EAAQ,GAAKgwE,GAAG+7B,IAAIyb,EAAe,EAAJxnH,EAAQ,GAAI,IAAK8jF,IAIvEwjC,EAAU9uC,aAAa+uC,EAAiB,EAAG,GAG3CtjH,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,eACRzxB,OAAQ,CAACk9D,EAAYW,KAS7BzP,UAAW8O,EAAoBz2B,GAC3BD,GAAUjsF,KAAKwgH,eAAemC,GAAY7vD,WAAW,MAAOo5B,GAC5DlsF,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,YACRzxB,OAAQ,CAACk9D,EAAY52C,GAAG86B,QAAQ3a,MAIxC1X,KAAMmuC,EAAoBjpD,GACtB20B,GAAWruF,KAAKwgH,eAAemC,GAAa52C,GAAG86B,QAAQntC,IACvD15D,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,OACRzxB,OAAQ,CAACk9D,EAAY52C,GAAG86B,QAAQntC,MAIxCiqD,aAAchB,EAAoBhc,GACpB3mG,KAAKwgH,eAAemC,GAAY7vD,WAAW,MACjDyhB,aAAaoyB,EAAW,EAAG,GAC/B3mG,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,eACRzxB,OAAQ,CAACk9D,EAAYhc,KAI7Bid,WAAYjB,GACR,IAAIt9C,EAAMrlE,KAAKwgH,eAAemC,GAAY7vD,WAAW,MACrDuS,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAGxyF,KAAKwgH,eAAemC,GAAY7wD,MAAO9xD,KAAKwgH,eAAemC,GAAY5wD,QAC3FsT,EAAIiN,UAEJtyE,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,aACRzxB,OAAQ,CAACk9D,KAIjBxB,YAMI,OAAOnhH,KAAKwgH,eAAelgF,KAAI3X,IACpB,CACH4/E,QAAS5/E,EAAKmqC,WAAW,MACzB+sB,QAASl3D,EAAKk3D,QACdr4E,KAAMmhB,EAAKnhB,KACXioF,WAAY9mE,EAAK8mE,eAK7Bo0B,gBAMI,OAAO7jH,KAAKwgH,eAAelgF,KAAI3X,IACpB,CACHkqC,OAAQlqC,EACRk3D,QAASl3D,EAAKk3D,QACdr4E,KAAMmhB,EAAKnhB,KACXioF,WAAY9mE,EAAK8mE,eAK7Bq0B,cAAeC,EAA8B7B,GACzC,IAAK,IAAInmH,EAAI,EAAGA,EAAIiE,KAAKwgH,eAAexkH,OAAQD,IAC5C,GAAIiE,KAAKwgH,eAAezkH,KAAOgoH,EAC3B,OAAOhoH,EAGf,IAAKmmH,EACD,MAAM,IAAI/lH,MAAM,uBAAyB6D,KAAKwgH,eAAexkH,OAAS,YAE1E,OAAO,KAGXgoH,SAAUp3G,EAAes1G,GAMrB,GAAIliH,KAAKwgH,eAAe5zG,GACpB,MAAO,CACH27F,QAASvoG,KAAKwgH,eAAe5zG,GAAOkmD,WAAW,MAC/C+sB,QAAS7/E,KAAKwgH,eAAe5zG,GAAOizE,QACpCr4E,KAAMxH,KAAKwgH,eAAe5zG,GAAOpF,KACjCvL,GAAI2Q,GAGZ,IAAKs1G,EACD,MAAM,IAAI/lH,MAAM,kBAAoByQ,EAAQ,kBAAoB5M,KAAKwgH,eAAexkH,OAAS,YAEjG,OAAO,KAGXioH,WAAY5lG,EAAWC,GACnBD,EAAI1gB,KAAKyO,MAAMiS,GACfC,EAAI3gB,KAAKyO,MAAMkS,GACf,IAAI+mD,EAAMrlE,KAAKkkH,WAAWpxD,WAAW,MACrCuS,EAAI4M,OACJ5M,EAAI6M,uBAAwB,EAC5B7M,EAAImtB,UAAU,EAAG,EAAG,EAAG,GACvB,IAAK,IAAIz2F,EAAI,EAAGA,EAAIiE,KAAKwgH,eAAexkH,OAAQD,IAC5CspE,EAAI+mB,YAAcpsF,KAAKwgH,eAAezkH,GAAG8jF,QACzCxa,EAAIwO,yBAA2B7zE,KAAKwgH,eAAezkH,GAAG0zF,WACtDpqB,EAAImM,UAAUxxE,KAAKwgH,eAAezkH,IAAKsiB,GAAIC,GAE/C+mD,EAAIiN,UACJ,IAAIksB,EAASn5B,EAAIiP,aAAa,EAAG,EAAG,EAAG,GACvC,OAAO,IAAIvI,GAAG+W,IAAI0b,EAAOvvF,KAAK,GAAIuvF,EAAOvvF,KAAK,GAAIuvF,EAAOvvF,KAAK,IAGlEw0G,kBAAmBj+B,GACf,OAAO8J,GAAYtvF,KAAK47G,aAAcp2B,GAG1Co2B,aACI,MAAO,CACH9pD,MAAO9xD,KAAK8xD,MACZC,OAAQ/xD,KAAK+xD,OACby9B,OAAQxvF,KAAKwgH,eAAelgF,KAAI+8E,IACrB,CACH71G,KAAM61G,EAAM71G,KACZq4E,QAASw9B,EAAMx9B,QACf4P,WAAY4tB,EAAM5tB,WAClB/Q,MAAO2+B,OAMvB8G,kBAAmB5+G,GACXvF,KAAKsgH,kBAAkB/yG,SAAShI,IAGpCvF,KAAKsgH,kBAAkBl6G,KAAKb,GAGhC6+G,qBAAsB7+G,GAClB,IAAK,IAAIxJ,EAAI,EAAGA,EAAIiE,KAAKsgH,kBAAkBtkH,OAAQD,IAC/C,GAAIiE,KAAKsgH,kBAAkBvkH,KAAOwJ,EAE9B,YADAvF,KAAKsgH,kBAAkBp6E,OAAOnqC,EAAG,GAM7CsoH,WAAY1B,EAAoBlzB,GAC5B,IAAKzvF,KAAKwgH,eAAemC,GACrB,MAAM,IAAIxmH,MAAM,iBAEpB6D,KAAKwgH,eAAemC,GAAYlzB,WAAaA,EAE7CzvF,KAAK4oG,QAAQxiG,KAAK,CACd0kG,KAAM,CAAC,UACP5zB,OAAQ,aACRzxB,OAAQ,CAACk9D,EAAY,GAAKlzB,KAWlC60B,aACI3B,EACA4B,GAIA,IAAKvkH,KAAKwgH,eAAemC,GACrB,MAAM,IAAIxmH,MAAM,iBAEpB6D,KAAKwgH,eAAemC,GAAY4B,aAAeA,cA12B/C9+D,EAiBQs8D,EAAwB,GAqBhC,QArBQA,cAAAA,EAER/hH,KAAKwgH,eAAiB,GACtBxgH,KAAKkkH,WAAan4C,GAAGlZ,OAAO,EAAG,GAC/B7yD,KAAK4oG,QAAU,IAAIxyB,GACf,SAAU3wB,GACVzlD,KAAK8xD,MAAQ,EACb9xD,KAAK+xD,OAAS,GAEV,UAAWtM,GAAU,WAAYA,GACjCzlD,KAAK8xD,MAAQrM,EAAOqM,MACpB9xD,KAAK+xD,OAAStM,EAAOsM,SAErB/xD,KAAK8xD,MAAQ,EACb9xD,KAAK+xD,OAAS,GAGtB/xD,KAAKqjC,KAAKrjC,KAAK8xD,MAAO9xD,KAAK+xD,QAE3B/xD,KAAKsgH,kBAAoB,GAErB,SAAU76D,EACVzlD,KAAKghH,KAAKv7D,EAAOu7D,WACd,GAAI,eAAgBv7D,EAAQ,CAC/B,MAAMy7D,EAAa,GAAGxjH,OAAO+nD,EAAO++D,WAAWh1B,QAG/C,GAFAxvF,KAAKqjC,KAAKoiB,EAAO++D,WAAW1yD,MAAOrM,EAAO++D,WAAWzyD,SAEhDmvD,EAAWllH,OACZ,MAAM,IAAIG,MAAM,yCAGpB,IAAK,IAAIJ,EAAI,EAAGA,EAAImlH,EAAWllH,OAAQD,IAAK,CACxC,GAAImlH,EAAWnlH,GAAG0zF,aAAeE,GAAgBpiF,SAAS2zG,EAAWnlH,GAAG0zF,YACpE,MAAM,IAAItzF,MAAM,sBAAwB+kH,EAAWnlH,GAAG0zF,YAG1DzvF,KAAKygH,WACLzgH,KAAK0gH,aAAa3kH,EAAGmlH,EAAWnlH,GAAG8jF,SACnC7/E,KAAKwgH,eAAezkH,GAAGyL,KAAO05G,EAAWnlH,GAAGyL,KAC5CxH,KAAKwgH,eAAezkH,GAAG0zF,WAAayxB,EAAWnlH,GAAG0zF,WAAayxB,EAAWnlH,GAAG0zF,WAAa,cAC1FzvF,KAAKwgH,eAAezkH,GAAG+2D,WAAW,MAAM0e,UAAU0vC,EAAWnlH,GAAG2iF,MAAO,EAAG,IAGlF1+E,KAAKugH,8B4FxDTjxB,uBAGAkB,2BrFWQi0B,uBAEJ,MAAM58G,EAAS7H,KAAK0kH,qBAWpB,OAVA78G,EAAOwW,EAAIre,KAAK2kH,oBAAoBtmG,EACpCxW,EAAOyW,EAAIte,KAAK2kH,oBAAoBrmG,EACpCzW,EAAO0lC,MAAQvtC,KAAK2kH,oBAAoBp3E,MACxC1lC,EAAO07D,MAAQvjE,KAAK2kH,oBAAoBphD,MAEpC17D,EAAO07D,OAAS5lE,KAAKuvC,GAAK,IAAO,GAAKrlC,EAAO0lC,MAAQ,GAAM,IAC3D1lC,EAAOwW,EAAI1gB,KAAK4jC,MAAM15B,EAAOwW,GAC7BxW,EAAOyW,EAAI3gB,KAAK4jC,MAAM15B,EAAOyW,IAG1BzW,EAGH+8G,uBACJ5kH,KAAK6kH,SAASV,mBAAiB,KAC3BnkH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,cAILn0B,aAAco0B,EAAgBC,GAClC,GAAID,IAAYhlH,KAAKklH,cAAgBD,EACjC,OAEJ,MAAME,EAAUnlH,KAAKklH,YAyBrB,GAxBAllH,KAAKklH,YAAcF,EACnBhlH,KAAK8kH,mBAAoB,EACrB9kH,KAAKklH,cAAgB7yB,GAAM+yB,KAC3BplH,KAAK84E,OAAOljE,MAAMooE,OAAS,YACpBh+E,KAAKklH,cAAgB7yB,GAAMgzB,KAClCrlH,KAAK84E,OAAOljE,MAAMooE,OAAS,OACpBh+E,KAAKklH,cAAgB7yB,GAAMizB,aAClCtlH,KAAK84E,OAAOljE,MAAMooE,OAAS,WACpBh+E,KAAKklH,cAAgB7yB,GAAMkzB,KAClCvlH,KAAK84E,OAAOljE,MAAMooE,OAAS,QAAUpG,EAAAoa,IAAY,qBAC1ChyF,KAAKklH,cAAgB7yB,GAAMmzB,KAClCxlH,KAAK84E,OAAOljE,MAAMooE,OAAS,QAAUpG,EAAAqa,IAAY,kBAC1CjyF,KAAKklH,cAAgB7yB,GAAMozB,OAClCzlH,KAAK84E,OAAOljE,MAAMooE,OAAS,OACpBh+E,KAAKklH,cAAgB7yB,GAAMqzB,SAClC1lH,KAAK84E,OAAOljE,MAAMooE,OAAS,WACpBh+E,KAAKklH,cAAgB7yB,GAAMszB,KAClC3lH,KAAK84E,OAAOljE,MAAMooE,OAAS,QAAUpG,EAAAsa,IAAU,qBACxClyF,KAAKklH,cAAgB7yB,GAAMuzB,KAClC5lH,KAAK84E,OAAOljE,MAAMooE,OAAS,QAAUpG,EAAAua,IAAU,qBACxCnyF,KAAKklH,cAAgB7yB,GAAMwzB,QAClC7lH,KAAK84E,OAAOljE,MAAMooE,OAAS,aAG3B,CAACqU,GAAM+yB,KAAM/yB,GAAMkzB,KAAMlzB,GAAMszB,KAAMtzB,GAAMuzB,KAAMvzB,GAAMwzB,OAAOt4G,SAASvN,KAAK8lH,YAAa,CACzF,MAAMC,EAAY,CAAC1zB,GAAMgzB,KAAMhzB,GAAMizB,cAAc/3G,SAAS43G,GACtDa,EAAgB,CAAC3zB,GAAMgzB,KAAMhzB,GAAMizB,cAAc/3G,SAASvN,KAAKklH,cAChEa,GAAaC,GACdhmH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,QAAS,MAAO,UAEhE4kD,IAAcC,GACdhmH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,UAIpDnhE,KAAKklH,cAAgB7yB,GAAMkzB,MAC3BvlH,KAAKkmH,WAAWj1B,mBAAmB,CAACD,WAAW,IAW/Cm1B,mBAAoBC,EAAiBC,EAAiBC,GAG1D,IAAIC,EAFS5oH,KAAKw1E,KAAKnzE,KAAKwmH,mBAAmBj5E,OAE1B5vC,KAAKghB,IAAIynG,GAC9BG,GAAWH,EAAU,EAAI,GAAI,EAC7BG,EAAU5oH,KAAK4jC,MAAMglF,GACrBA,GAAW5oH,KAAKghB,IAAIynG,GACpB,MAAMK,EAAW9oH,KAAK6O,IA9JZ,MA8J2B7O,KAAK+O,IA7JhC,GA6J+C/O,KAAK67B,IAAI,EAAG+sF,KAGrE,GAAIE,IAAazmH,KAAKwmH,mBAAmBj5E,MACrC,OAAO,EAIX,MAAMm5E,EAAkBD,EAAWzmH,KAAKwmH,mBAAmBj5E,MAC3DvtC,KAAKwmH,mBAAmBj5E,MAAQk5E,EAEhC,IAAI5gD,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,wBAAwB2/C,EAASC,IACvFzgD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAO//C,kBAAkB8/C,IACxE7gD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,yBAAyB2/C,GAAUC,IAEzF,IAAIr3D,EAAS,CAACjvD,KAAKwmH,mBAAmBnoG,EAAGre,KAAKwmH,mBAAmBloG,EAAG,EAAG,GAOvE,OANA2wC,EAAS8c,GAAG46C,OAAO/gD,uBAAuBC,EAAQ5W,GAClDjvD,KAAKwmH,mBAAmBnoG,EAAI4wC,EAAO,GACnCjvD,KAAKwmH,mBAAmBloG,EAAI2wC,EAAO,GAEnCjvD,KAAK4mH,kBAAmB,GAEjB,EAUHC,gBAAiBC,EAAwBC,EAAwBC,GACrE,GAAIF,EAAWvjD,QAAUwjD,EAAWxjD,MAKhC,OAJAujD,EAAWv5E,MAAQw+B,GAAG+7B,IAAIgf,EAAWv5E,MAAOw5E,EAAWx5E,MAAOy5E,GAC9DF,EAAWzoG,EAAI0tD,GAAG+7B,IAAIgf,EAAWzoG,EAAG0oG,EAAW1oG,EAAG2oG,GAClDF,EAAWxoG,EAAIytD,GAAG+7B,IAAIgf,EAAWxoG,EAAGyoG,EAAWzoG,EAAG0oG,QAClDF,EAAWvjD,MAAQwI,GAAG+7B,IAAIgf,EAAWvjD,MAAOwjD,EAAWxjD,MAAOyjD,IAIlE,MAAMp1D,EAAI5xD,KAAK6kH,SAAS/D,WAClBjvD,EAAI7xD,KAAK6kH,SAAS9D,YAGlBkG,EAAajnH,KAAKknH,uBAAuB,CAC3C7oG,EAAGuzC,EAAI,EACPtzC,EAAGuzC,EAAI,GACRi1D,GACGK,EAAannH,KAAKknH,uBAAuB,CAC3C7oG,EAAGuzC,EAAI,EACPtzC,EAAGuzC,EAAI,GACRk1D,GAGHD,EAAWzoG,EAAI0tD,GAAG+7B,IAAImf,EAAW5oG,EAAI8oG,EAAW9oG,EAAG2oG,GACnDF,EAAWxoG,EAAIytD,GAAG+7B,IAAImf,EAAW3oG,EAAI6oG,EAAW7oG,EAAG0oG,GAGnDF,EAAWv5E,MAAQw+B,GAAG+7B,IAAIgf,EAAWv5E,MAAOw5E,EAAWx5E,MAAOy5E,GAC9DF,EAAWvjD,MAAQwI,GAAG+7B,IAAIgf,EAAWvjD,MAAOwjD,EAAWxjD,MAAOyjD,GAG9D,MAAMI,EAAWpnH,KAAKknH,uBAAuB,CACzC7oG,GAAIuzC,EAAI,EACRtzC,GAAIuzC,EAAI,GACTi1D,GACHA,EAAWzoG,EAAI+oG,EAAS/oG,EACxByoG,EAAWxoG,EAAI8oG,EAAS9oG,EAGpBi0E,SACAvyF,KAAKqnH,iBACLrnH,KAAKqnH,gBAAiB,EACtBrnH,KAAKsnH,mBAAmBx1D,MAAQ9xD,KAAKunH,YACrCvnH,KAAKsnH,mBAAmBv1D,OAAS/xD,KAAKwnH,cAE1CxnH,KAAKynH,cAAcznH,KAAK0nH,iBAOpBC,gBAIJ,MAAMC,EAAoB,CACtB,CAAC,EAAG,GACJ,CAAC5nH,KAAKunH,YAAa,GACnB,CAACvnH,KAAKunH,YAAavnH,KAAKwnH,cACxB,CAAC,EAAGxnH,KAAKwnH,eAGPK,EAAM7nH,KAAKykH,uBAGjB,IAAI5+C,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAO//C,kBAAkB,EAAEihD,EAAIt6E,QAC9Es4B,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,sBAAsBkhD,EAAItkD,QAChFsC,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,yBAAyBmhD,EAAIxpG,GAAIwpG,EAAIvpG,IAG3F,IAAK,IAAIviB,EAAI,EAAGA,EAAI6rH,EAAkB5rH,OAAQD,IAAK,CAC/C,IAAI+rH,EAAS,CAACF,EAAkB7rH,GAAG,GAAI6rH,EAAkB7rH,GAAG,GAAI,EAAG,GAGnE,GAFA+rH,EAAS/7C,GAAG46C,OAAO/gD,uBAAuBC,EAAQiiD,KAG5C,GAAKA,EAAO,IAAMA,EAAO,IAAM9nH,KAAK6kH,SAAS/D,YAC3C,GAAKgH,EAAO,IAAMA,EAAO,IAAM9nH,KAAK6kH,SAAS9D,aAGjD,OAAO,EAGf,OAAO,EAGH0G,cAAepiD,GACnB,MAAMzT,EAAI5xD,KAAK6kH,SAAS/D,WAClBjvD,EAAI7xD,KAAK6kH,SAAS9D,YAElB8G,EAAM7nH,KAAKykH,uBAEboD,EAAIt6E,OAAS,GAAoB,IAAds6E,EAAIt6E,OAA6B,IAAds6E,EAAItkD,MAC1C8B,EAAI6M,uBAAwB,GAE5B7M,EAAI6M,uBAAwB,EAC5B7M,EAAI8M,sBAAyB,OAOjC9M,EAAI4M,OACJ,CAUI,GATIjyE,KAAK+nH,WACL1iD,EAAIC,UAAY,mBAChBD,EAAIE,SAAS,EAAG,EAAGvlE,KAAKunH,YAAavnH,KAAKwnH,eAE1CniD,EAAImtB,UAAU,EAAG,EAAGxyF,KAAKunH,YAAavnH,KAAKwnH,cAK3CxnH,KAAK+nH,UAAW,CAChB1iD,EAAI4M,OAEJ5M,EAAI+M,UAAUy1C,EAAIxpG,EAAGwpG,EAAIvpG,GACzB+mD,EAAI93B,MAAMs6E,EAAIt6E,MAAOs6E,EAAIt6E,OACzB83B,EAAIgN,OAAOw1C,EAAItkD,OAEf8B,EAAI6M,uBAAwB,EAG5B,MAAM81C,EAAa,EACnB3iD,EAAI+mB,YAAc,GAClB/mB,EAAImM,UACAxxE,KAAKioH,aACJD,EAAaH,EAAIt6E,OACjBy6E,EAAaH,EAAIt6E,MAClBqkB,EAAiB,EAAbo2D,EAAiBH,EAAIt6E,MACzBskB,EAAiB,EAAbm2D,EAAiBH,EAAIt6E,OAE7B83B,EAAI+mB,YAAc,EAGlB/mB,EAAIwO,yBAA2B,kBAC/BxO,EAAImM,UAAUxxE,KAAKioH,YAAa,EAAG,EAAGr2D,EAAGC,GAEzCwT,EAAIiN,UAORjN,EAAI+M,UAAUy1C,EAAIxpG,EAAGwpG,EAAIvpG,GACzB+mD,EAAI93B,MAAMs6E,EAAIt6E,MAAOs6E,EAAIt6E,OACzB83B,EAAIgN,OAAOw1C,EAAItkD,OAEf,MAAM2kD,EAAWloH,KAAK6kH,SAAShB,gBAC/B,IAAK,IAAI9nH,EAAI,EAAGA,EAAImsH,EAASlsH,OAAQD,IAC7BmsH,EAASnsH,GAAG8jF,QAAU,IACtBxa,EAAI+mB,YAAc87B,EAASnsH,GAAG8jF,QAC9Bxa,EAAIwO,yBAA2Bq0C,EAASnsH,GAAG0zF,WAEvCy4B,EAASnsH,GAAG82D,OAAO0xD,cACfvkH,KAAKmoH,gBAAgBr2D,QAAUo2D,EAASnsH,GAAG82D,OAAOf,OAAS9xD,KAAKmoH,gBAAgBp2D,SAAWm2D,EAASnsH,GAAG82D,OAAOd,QAC9G/xD,KAAKmoH,gBAAgBr2D,MAAQo2D,EAASnsH,GAAG82D,OAAOf,MAChD9xD,KAAKmoH,gBAAgBp2D,OAASm2D,EAASnsH,GAAG82D,OAAOd,QAEjD/xD,KAAKooH,aAAa51B,UAAU,EAAG,EAAGxyF,KAAKmoH,gBAAgBr2D,MAAO9xD,KAAKmoH,gBAAgBp2D,QAEvF/xD,KAAKooH,aAAa52C,UAAU02C,EAASnsH,GAAG82D,OAAQ,EAAG,GACnDq1D,EAASnsH,GAAG82D,OAAO0xD,aAAalQ,KAAKr0G,KAAKooH,cAC1C/iD,EAAImM,UAAUxxE,KAAKmoH,gBAAiB,EAAG,EAAGv2D,EAAGC,IAE7CwT,EAAImM,UAAU02C,EAASnsH,GAAG82D,OAAQ,EAAG,EAAGjB,EAAGC,IAIvDwT,EAAI+mB,YAAc,EAKtB/mB,EAAIiN,UAGA+f,GAAMozB,SAAWzlH,KAAKklH,aAAe7yB,GAAMqzB,WAAa1lH,KAAKklH,YAC7DllH,KAAKkmH,WAAW50B,cAAc,CAC1BN,WAAW,EACXpf,SAAUi2C,EAAItkD,MAAQ5lE,KAAKuvC,GAAK,MAGpCltC,KAAKkmH,WAAW50B,cAAc,CAC1BN,WAAW,IAKfq3B,uBAAwB3uD,GAC5B,MAAMmuD,EAAM7nH,KAAKykH,uBACjB,IAAI5+C,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAO//C,kBAAkB,EAAEihD,EAAIt6E,QAC9Es4B,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,sBAAsBkhD,EAAItkD,QAChFsC,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,yBAAyBmhD,EAAIxpG,GAAIwpG,EAAIvpG,IAE3F,IAAIwpG,EAAS,CAACpuD,EAAEr7C,EAAGq7C,EAAEp7C,EAAG,EAAG,GAG3B,OAFAwpG,EAAS/7C,GAAG46C,OAAO/gD,uBAAuBC,EAAQiiD,GAE3C,CACHzpG,EAAGypG,EAAO,GACVxpG,EAAGwpG,EAAO,IAIVZ,uBAAwBxtD,EAAc8Y,GAC1C,IAAI3M,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,wBAAwB8L,EAAan0D,EAAGm0D,EAAal0D,IAC3GunD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,qBAAqB6L,EAAajP,QACxFsC,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAO//C,kBAAkB4L,EAAajlC,QAErF,IAAIu6E,EAAS,CAACpuD,EAAEr7C,EAAGq7C,EAAEp7C,EAAG,EAAG,GAG3B,OAFAwpG,EAAS/7C,GAAG46C,OAAO/gD,uBAAuBC,EAAQiiD,GAE3C,CACHzpG,EAAGypG,EAAO,GACVxpG,EAAGwpG,EAAO,IAIVQ,aAAcrlD,EAAkBslD,EAA0BC,GAC9D,IAAI52C,EAAsB,IAAX3O,EAAiBtlE,KAAKuvC,GACrC,MAAMu7E,EAAS9qH,KAAKghB,IAAIizD,EAAW22C,GAOnC,OANa5qH,KAAK+O,IAAI+7G,EAAQF,EAAmBE,IAErCD,IACR52C,EAAWj0E,KAAK4jC,MAAMqwC,EAAW22C,GAAoBA,GAGlD32C,EAAW,IAAMj0E,KAAKuvC,GAQzBw7E,iBAAkBzlD,GAOtB,OANAA,GAAuB,EAAItlE,KAAKuvC,IACjBvvC,KAAKuvC,GAChB+1B,GAAY,EAAItlE,KAAKuvC,GACd+1B,GAAYtlE,KAAKuvC,KACxB+1B,GAAY,EAAItlE,KAAKuvC,IAElB+1B,EAGH0lD,sBACJ3oH,KAAK4oH,sBAAwB,KAC7B5oH,KAAK4wF,aAAa5wF,KAAK8lH,YACvB9lH,KAAK+kH,UAAS,GAGVA,SAAU8D,GACd7oH,KAAK8oH,yBAA0B,EAC3BD,IACA7oH,KAAK8kH,mBAAoB,GAIzBiE,aACJjpH,OAAOkpH,uBAAqB,IAAOhpH,KAAK+oH,eACxC,MAAME,EAAWpyC,GAAU1vB,WACrB+hE,EAAWlpH,KAAK8kH,kBAAoBmE,EAGpC7oD,EAAUxF,YAAYr1C,MACtB4jG,EAAkD,IAAjC/oD,EAAUpgE,KAAKopH,gBAAuB,IAC7DppH,KAAKopH,eAAiBhpD,GAElBpgE,KAAK8oH,yBAA2BI,KAChClpH,KAAK8oH,yBAA0B,EAC/B9oH,KAAKqpH,YAAYF,IAIjBE,YAAaF,GAEjB,MAAMF,EAAWpyC,GAAU1vB,WACrB+hE,EAAWlpH,KAAK8kH,kBAAoBmE,GACtCjpH,KAAK2kH,oBAAoBp3E,QAAUvtC,KAAKwmH,mBAAmBj5E,OAC3DvtC,KAAK2kH,oBAAoBtmG,IAAMre,KAAKwmH,mBAAmBnoG,GACvDre,KAAK2kH,oBAAoBrmG,IAAMte,KAAKwmH,mBAAmBloG,EAG3D,IACKte,KAAKspH,qBAEFtpH,KAAK2kH,oBAAoBp3E,QAAUvtC,KAAKwmH,mBAAmBj5E,OAC3D5vC,KAAKghB,IAAI3e,KAAK2kH,oBAAoBp3E,MAAQvtC,KAAKwmH,mBAAmBj5E,OAAS,KAAQvtC,KAAKwmH,mBAAmBj5E,OAG/GvtC,KAAK2kH,oBAAoBp3E,MAAQvtC,KAAKwmH,mBAAmBj5E,MACzDvtC,KAAK2kH,oBAAoBtmG,EAAIre,KAAKwmH,mBAAmBnoG,EACrDre,KAAK2kH,oBAAoBrmG,EAAIte,KAAKwmH,mBAAmBloG,EACrDte,KAAK2kH,oBAAoBphD,MAAQvjE,KAAKwmH,mBAAmBjjD,MACrDvjE,KAAK4mH,mBACL5mH,KAAK4mH,kBAAmB,EACxB5mH,KAAK+nH,UAAY/nH,KAAK2nH,iBAG1B3nH,KAAKkmH,WAAWt1B,aAAa,CAACG,OAAQ/wF,KAAKupH,YAAcvpH,KAAK2kH,oBAAoBp3E,aAC/E,IACFvtC,KAAK2kH,oBAAoBtmG,IAAMre,KAAKwmH,mBAAmBnoG,GAAK1gB,KAAKghB,IAAI3e,KAAK2kH,oBAAoBtmG,EAAIre,KAAKwmH,mBAAmBnoG,GAAK,MAC/Hre,KAAK2kH,oBAAoBrmG,IAAMte,KAAKwmH,mBAAmBloG,GAAK3gB,KAAKghB,IAAI3e,KAAK2kH,oBAAoBrmG,EAAIte,KAAKwmH,mBAAmBloG,GAAK,MAE5Hte,KAAK2kH,oBAAoBp3E,QAAUvtC,KAAKwmH,mBAAmBj5E,OAC3D5vC,KAAKghB,IAAI3e,KAAK2kH,oBAAoBp3E,MAAQvtC,KAAKwmH,mBAAmBj5E,OAAS,KAAQvtC,KAAKwmH,mBAAmBj5E,OAG/GvtC,KAAK2kH,oBAAoBp3E,MAAQvtC,KAAKwmH,mBAAmBj5E,MACzDvtC,KAAK2kH,oBAAoBtmG,EAAIre,KAAKwmH,mBAAmBnoG,EACrDre,KAAK2kH,oBAAoBrmG,EAAIte,KAAKwmH,mBAAmBloG,EACrDte,KAAK2kH,oBAAoBphD,MAAQvjE,KAAKwmH,mBAAmBjjD,MACzDvjE,KAAMspH,oBAAqB,EACvBtpH,KAAK4mH,mBACL5mH,KAAK4mH,kBAAmB,EACxB5mH,KAAK+nH,UAAY/nH,KAAK2nH,iBAG1B3nH,KAAKkmH,WAAWt1B,aAAa,CAACG,OAAQ/wF,KAAKupH,YAAcvpH,KAAK2kH,oBAAoBp3E,YAC/E,CACHvtC,KAAK+kH,WACL,MAAMiC,EAAcrpH,KAAK+O,IAAI,EAvfjB,GAufsCy8G,GAClDnpH,KAAK6mH,gBAAgB7mH,KAAK2kH,oBAAqB3kH,KAAKwmH,mBAAoBQ,GACxEhnH,KAAK+nH,WAAY,EACjB/nH,KAAKkmH,WAAWt1B,aAAa,CAACG,OAAQ/wF,KAAKupH,YAAcvpH,KAAK2kH,oBAAoBp3E,QActF,GAXIvtC,KAAK+sD,SAAW/sD,KAAKklH,aAAe7yB,GAAM+yB,OAASplH,KAAKwpH,cACxDxpH,KAAKkmH,WAAWt1B,aAAa,CACzBvyE,EAAGre,KAAK+sD,QAAQ1uC,EAChBC,EAAGte,KAAK+sD,QAAQzuC,EAChB0yE,WAAW,IAGfhxF,KAAKkmH,WAAWt1B,aAAa,CAACI,WAAW,IAIzCk4B,EAAU,CAEVlpH,KAAK8kH,kBAAoBmE,EACzB,MAAM52G,EAAQuoD,YAAYr1C,MAC1BvlB,KAAKuyF,SACLvyF,KAAKypH,WAAa19C,GAAG+7B,IAAI9nG,KAAKypH,WAAY7uD,YAAYr1C,MAAQlT,EAAO,MAq3B7E6qE,aACI,OAAOl9E,KAAK84E,OAGhB4wC,UAAWC,GACP3pH,KAAK6kH,SAAW8E,EAChB3pH,KAAK4pH,cAAgB,KACrB5pH,KAAK6pH,YAEL7pH,KAAK4kH,uBAEL5kH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,WAQTr0B,QAAS5+B,EAAeC,GACpB,MAAM+3D,EAAW9pH,KAAKunH,YAChBwC,EAAY/pH,KAAKwnH,aAEnB11D,IAAUg4D,GAAY/3D,IAAWg4D,IAIrC/pH,KAAKqnH,gBAAiB,EACtBrnH,KAAKunH,YAAcz1D,EACnB9xD,KAAKwnH,aAAez1D,EAEpB/xD,KAAKkmH,WAAWx1B,QAAQ5+B,EAAOC,GAE/B/xD,KAAKwmH,mBAAmBnoG,IAAMyzC,EAAQg4D,GAAY,EAClD9pH,KAAKwmH,mBAAmBloG,IAAMyzC,EAASg4D,GAAa,EAEpD/pH,KAAK2kH,oBAAoBtmG,EAAIre,KAAKwmH,mBAAmBnoG,EACrDre,KAAK2kH,oBAAoBrmG,EAAIte,KAAKwmH,mBAAmBloG,EAErDte,KAAK+nH,UAAY/nH,KAAK2nH,gBAEtB3nH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,YAGTzQ,QAAS0V,GAEW,SAAZA,IACAhqH,KAAK8lH,WAAazzB,GAAM+yB,KACxBplH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,WAEpC,SAAZ6oD,IACAhqH,KAAK8lH,WAAazzB,GAAMszB,KACxB3lH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,WAEpC,SAAZ6oD,IACAhqH,KAAK8lH,WAAazzB,GAAMuzB,KACxB5lH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,WAEpC,UAAZ6oD,IACAhqH,KAAK8lH,WAAazzB,GAAMwzB,MACxB7lH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,WAEpC,SAAZ6oD,IACAhqH,KAAK8lH,WAAazzB,GAAMgzB,KACxBrlH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,QAAS,MAAO,WAEpD,SAAZ6oD,IACAhqH,KAAK8lH,WAAazzB,GAAMkzB,KACxBvlH,KAAKimH,iBAAiB9kD,yBAAyB,CAAC,WAIxD8oD,WAAYjsG,IAIZksG,cAAeC,GACXnqH,KAAKupH,YAAcY,EAAW,EAE9BnqH,KAAKkmH,WAAWt1B,aAAa,CAACG,OAAQ/wF,KAAKupH,YAAcvpH,KAAK2kH,oBAAoBp3E,QAE7D,OAAjBvtC,KAAK+sD,UACLkM,aAAaj5D,KAAKoqH,wBAElBpqH,KAAKkmH,WAAWt1B,aAAa,CACzBvyE,EAAGre,KAAKunH,YAAc,EACtBjpG,EAAGte,KAAKwnH,aAAe,EACvBx2B,WAAW,IAIfhxF,KAAKoqH,uBAAyBtkG,YAAU,KACf,OAAjB9lB,KAAK+sD,SAGT/sD,KAAKkmH,WAAWt1B,aAAa,CAACI,WAAW,MAC1C,MAIXq5B,WAAYjE,GACHpmH,KAAKmmH,mBAAmBC,EAASpmH,KAAKunH,YAAc,EAAGvnH,KAAKwnH,aAAe,KAIhFxnH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,WAEL/kH,KAAKsqH,aAAa,CACdC,QAAS,CAAC,SACVhnD,MAAOvjE,KAAKwmH,mBAAmBjjD,MAC/Bh2B,MAAOvtC,KAAKwmH,mBAAmBj5E,SAIvCs8E,UAAWW,GACPxqH,KAAKwmH,mBAAmBj5E,MAAQ,EAChCvtC,KAAKwmH,mBAAmBjjD,MAAQ,EAEhCvjE,KAAKwmH,mBAAmBnoG,GAAKre,KAAKunH,YAAcvnH,KAAK6kH,SAAS/D,YAAc,EAC5E9gH,KAAKwmH,mBAAmBloG,GAAKte,KAAKwnH,aAAexnH,KAAK6kH,SAAS9D,aAAe,EAEzEyJ,GAGDxqH,KAAKspH,oBAAqB,EAC1BtpH,KAAK4mH,kBAAmB,GAHxB5mH,KAAK2kH,oBAAsBplH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBAM9DxmH,KAAK+nH,UAAY/nH,KAAK2nH,gBACtB3nH,KAAK+kH,WAEDyF,GACAxqH,KAAKsqH,aAAa,CACdC,QAAS,CAAC,QAAS,SACnBh9E,MAAOvtC,KAAKwmH,mBAAmBj5E,MAC/Bg2B,MAAOvjE,KAAKwmH,mBAAmBjjD,QAK3CknD,UAII,MAAMC,EAAkB,CACpB,CAAC,EAAG,GACJ,CAAC1qH,KAAK6kH,SAAS/D,WAAY,GAC3B,CAAC9gH,KAAK6kH,SAAS/D,WAAY9gH,KAAK6kH,SAAS9D,aACzC,CAAC,EAAG/gH,KAAK6kH,SAAS9D,aAClB,CAAC/gH,KAAK6kH,SAAS/D,WAAa,EAAG9gH,KAAK6kH,SAAS9D,YAAc,IAI/D,IAAIl7C,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,qBAAqB3mE,KAAKwmH,mBAAmBjjD,QAGnG,IAAK,IAAIxnE,EAAI,EAAGA,EAAI2uH,EAAgB1uH,OAAQD,IAAK,CAC7C,IAAI+rH,EAAS,CAAC4C,EAAgB3uH,GAAG,GAAI2uH,EAAgB3uH,GAAG,GAAI,EAAG,GAC/D+rH,EAAS/7C,GAAG46C,OAAO/gD,uBAAuBC,EAAQiiD,GAClD4C,EAAgB3uH,GAAG,GAAK+rH,EAAO,GAC/B4C,EAAgB3uH,GAAG,GAAK+rH,EAAO,GAGnC,MAAM6C,EAAY,CACd77E,GAAI,KACJE,GAAI,KACJD,GAAI,KACJE,GAAI,MAER,IAAK,IAAIgnB,EAAI,EAAGA,EAAIy0D,EAAgB1uH,OAAQi6D,KACnB,OAAjB00D,EAAU77E,IAAe47E,EAAgBz0D,GAAG,GAAK00D,EAAU77E,MAC3D67E,EAAU77E,GAAK47E,EAAgBz0D,GAAG,KAEjB,OAAjB00D,EAAU37E,IAAe07E,EAAgBz0D,GAAG,GAAK00D,EAAU37E,MAC3D27E,EAAU37E,GAAK07E,EAAgBz0D,GAAG,KAEjB,OAAjB00D,EAAU57E,IAAe27E,EAAgBz0D,GAAG,GAAK00D,EAAU57E,MAC3D47E,EAAU57E,GAAK27E,EAAgBz0D,GAAG,KAEjB,OAAjB00D,EAAU17E,IAAey7E,EAAgBz0D,GAAG,GAAK00D,EAAU17E,MAC3D07E,EAAU17E,GAAKy7E,EAAgBz0D,GAAG,IAG1C,MAAM20D,EAAcD,EAAU57E,GAAK47E,EAAU77E,GACvC+7E,EAAeF,EAAU17E,GAAK07E,EAAU37E,GAaxCw2C,EATMzZ,GAAGod,QACXyhC,EACAC,EACA7qH,KAAKunH,YAJO,GAKZvnH,KAAKwnH,aALO,GAMZ,GAIe11D,MAAQ84D,EAG3B5qH,KAAKwmH,mBAAmBnoG,EAAKre,KAAKunH,YAAc,GAAMmD,EAAgB,GAAG,GAAKA,EAAgB,GAAG,IAAMllC,EACvGxlF,KAAKwmH,mBAAmBloG,EAAKte,KAAKwnH,aAAe,GAAMkD,EAAgB,GAAG,GAAKA,EAAgB,GAAG,IAAMllC,EAExGxlF,KAAKwmH,mBAAmBj5E,MAAQi4C,EAChCxlF,KAAKspH,oBAAqB,EAC1BtpH,KAAK4mH,kBAAmB,EACxB5mH,KAAK+kH,WAEL/kH,KAAKsqH,aAAa,CACdC,QAAS,CAAC,QAAS,SACnBh9E,MAAOvtC,KAAKwmH,mBAAmBj5E,MAC/Bg2B,MAAOvjE,KAAKwmH,mBAAmBjjD,QAIvCunD,SAAUl5C,EAAkBm5C,GAExB,MAAMC,EAAY,CACd3sG,EAAGre,KAAKunH,YAAc,EACtBjpG,EAAGte,KAAKwnH,aAAe,GAGrByD,EAAcjrH,KAAKwmH,mBAAmBjjD,MACtCN,EAAW2O,EAAW,IAAMj0E,KAAKuvC,GAEnC69E,EACA/qH,KAAKwmH,mBAAmBjjD,OAASN,EAEjCjjE,KAAKwmH,mBAAmBjjD,MAAQN,EAGpCjjE,KAAKwmH,mBAAmBjjD,MAAQvjE,KAAK0oH,iBACjC1oH,KAAKsoH,aACDtoH,KAAKwmH,mBAAmBjjD,MACxB,GACA,IAKR,IAAIsC,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,wBAAwBskD,EAAU3sG,EAAG2sG,EAAU1sG,IACrGunD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,qBAAqB3mE,KAAKwmH,mBAAmBjjD,MAAQ0nD,IAC3GplD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,yBAAyBskD,EAAU3sG,GAAI2sG,EAAU1sG,IAEvG,IAAI2wC,EAAS,CAACjvD,KAAKwmH,mBAAmBnoG,EAAGre,KAAKwmH,mBAAmBloG,EAAG,EAAG,GACvE2wC,EAAS8c,GAAG46C,OAAO/gD,uBAAuBC,EAAQ5W,GAClDjvD,KAAKwmH,mBAAmBnoG,EAAI4wC,EAAO,GACnCjvD,KAAKwmH,mBAAmBloG,EAAI2wC,EAAO,GAEnCjvD,KAAK2kH,oBAAsBplH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBAC1DxmH,KAAK4mH,kBAAmB,EACxB5mH,KAAK+kH,UAAS,GAQlBmG,cAAeC,EAAYC,GAGvBprH,KAAKwmH,mBAAmBnoG,GAFV,GAEe8sG,EAC7BnrH,KAAKwmH,mBAAmBloG,GAHV,GAGe8sG,EAE7BprH,KAAK4mH,kBAAmB,EACxB5mH,KAAKspH,oBAAqB,EAC1BtpH,KAAK+kH,UAAS,GAGlBvgD,eACI,OAAOxkE,KAAKukE,UAGhB+sC,WACI,OAAOtxG,KAAKwmH,mBAAmBj5E,MAGnC89E,cACI,OAAuC,IAAhCrrH,KAAKwmH,mBAAmBjjD,MAAc5lE,KAAKuvC,GAGtDo+E,cACI,OA/qDU,GAkrDdC,cACI,MAprDU,MAurDdC,eACIxrH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,WAGT0G,iBAAkBptG,EAAkBC,EAAYk9C,GAClC,OAANn9C,GAKCre,KAAK4pH,gBACN5pH,KAAK4pH,cAAgB,CAACvrG,EAAG,EAAGC,EAAG,EAAGk9C,SAAU,IAEhDx7D,KAAK4pH,cAAcvrG,EAAIA,EACvBre,KAAK4pH,cAActrG,EAAIA,EACvBte,KAAK4pH,cAAcpuD,SAAWA,GAT1Bx7D,KAAK4pH,cAAgB,iBAnpCzBlwD,GAcA,MAAM6N,EAAQvnE,KACdA,KAAK84E,OAAS/M,GAAG1+D,GAAG,CAChB0nE,IAAK,CACDxjD,SAAU,WACVzW,KAAM,IACNC,MAAO,IACPw4C,IAAK,IACLqlB,OAAQ,IACRoF,OAAQ,YACRgD,WAAY,OACZ7C,YAAa,gBAGrBn+E,KAAK6kH,SAAWnrD,EAAEmrD,SAClB7kH,KAAKsqH,aAAe5wD,EAAE4wD,aACtBtqH,KAAKsnH,mBAAqBv7C,GAAGlZ,OAAO6G,EAAE5H,MAAO4H,EAAE3H,QAC/C/xD,KAAK0nH,gBAAkB1nH,KAAKsnH,mBAAmBx0D,WAAW,MAC1D9yD,KAAKunH,YAAc7tD,EAAE5H,MACrB9xD,KAAKwnH,aAAe9tD,EAAE3H,OACtB/xD,KAAKmoH,gBAAkBp8C,GAAGlZ,OAAO,EAAG,GACpC7yD,KAAKooH,aAAepoH,KAAKmoH,gBAAgBr1D,WAAW,MACpD9yD,KAAKqnH,gBAAiB,EACtBrnH,KAAK0rH,gBAAkB,KACvB1rH,KAAKwmH,mBAAqB,CACtBnoG,EAAG,EACHC,EAAG,EACHivB,MAAO,EACPg2B,MAAO,GAEXvjE,KAAK2kH,oBAAsB,CACvBtmG,EAAG,EACHC,EAAG,EACHivB,MAAO,EACPg2B,MAAO,GAEXvjE,KAAK0kH,qBAAuB,CACxBrmG,EAAG,KACHC,EAAG,KACHivB,MAAO,KACPg2B,MAAO,MAEXvjE,KAAK2rH,UAAY,CACbttG,EAAG,EACHC,EAAG,GAEPte,KAAKwpH,eAAgB,EACrBxpH,KAAK+nH,WAAY,EACjB/nH,KAAK4mH,kBAAmB,EACxB5mH,KAAKspH,oBAAqB,EAE1BtpH,KAAKkmH,WAAa,IAAI11B,GAAoB,CACtC1+B,MAAO4H,EAAE5H,MACTC,OAAQ2H,EAAE3H,SAGdga,GAAGgJ,IAAI/0E,KAAKsnH,mBAAoB,CAC5BtmC,WAAY,OACZQ,cAAe,SAEnBzV,GAAGkb,qBAAqB,GAAI1qF,IACxByD,KAAKsnH,mBAAmB1xG,MAAM8jE,WAAa,OAASn9E,EAAM,OAE9DyD,KAAK84E,OAAOl6E,YAAYoB,KAAKsnH,oBAC7BtnH,KAAK84E,OAAOl6E,YAAYoB,KAAKkmH,WAAWhpC,cACxCnR,GAAGpmD,iBAAiB3lB,KAAK84E,OAAQ,YAAap6E,IAC1CA,EAAEk4D,kBACK,KAEXmV,GAAGpmD,iBAAiB3lB,KAAK84E,OAAQ,eAAgBp6E,IAC7CA,EAAEk4D,kBACK,KAEXmV,GAAGpmD,iBAAiB3lB,KAAK84E,OAAQ,aAAcp6E,IAC3CA,EAAEk4D,kBACK,KAGX52D,KAAKioH,YAAcl8C,GAAGlZ,OAAO,EAAG,GAEhB7yD,KAAKioH,YAAYn1D,WAAW,MACpCyS,SAAS,EAAG,EAAG,EAAG,GAG1BvlE,KAAK82D,YAAc,IAAIiV,GAAGmO,YAAY,CAClCrE,OAAM,CAAG3hB,EAAQlvC,EAAOm1D,EAAUyxC,KAK9B,GAHe,QAAX13D,GACAlvC,EAAM4xC,kBAENg1D,EAIJ,GAAI5rH,KAAK4oH,sBACL5oH,KAAK4oH,sBAAsBiD,UAAU33D,EAAQlvC,EAAOm1D,EAAUyxC,OAE3D,CAEH,GAAI,CAACv5B,GAAM+yB,KAAM/yB,GAAMkzB,KAAMlzB,GAAMszB,KAAMtzB,GAAMuzB,KAAMvzB,GAAMwzB,OAAOt4G,SAASvN,KAAK8lH,aAA4B,UAAb3rC,EAG3F,OAFAn6E,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBC,eACpD/rH,KAAK4oH,sBAAsBiD,UAAU33D,EAAQlvC,EAAOm1D,EAAUyxC,GAIlE,GAAI,CAACv5B,GAAM+yB,KAAM/yB,GAAMgzB,KAAMhzB,GAAMszB,KAAMtzB,GAAMuzB,KAAMvzB,GAAMwzB,OAAOt4G,SAASvN,KAAK8lH,aAA4B,QAAb3rC,EAG3F,OAFAn6E,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBE,eACpDhsH,KAAK4oH,sBAAsBiD,UAAU33D,EAAQlvC,EAAOm1D,EAAUyxC,GAIlE,GAAI,CAAC,IAAK,WAAWr+G,SAAS4sE,GAG1B,OAFAn6E,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBz5C,YACpDryE,KAAK4oH,sBAAsBiD,UAAU33D,EAAQlvC,EAAOm1D,EAAUyxC,GAIlE,GAAI,MAAQzxC,EAGR,OAFAn6E,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBG,UACpDjsH,KAAK4oH,sBAAsBiD,UAAU33D,EAAQlvC,EAAOm1D,EAAUyxC,KAO1E91C,KAAI,CAAG5hB,EAAQlvC,EAAOwxC,KACdx2D,KAAK4oH,uBACL5oH,KAAK4oH,sBAAsBsD,QAAQh4D,EAAQlvC,EAAOwxC,MAK9Dx2D,KAAK4kH,uBAEL5kH,KAAKklH,YAAc7yB,GAAM+yB,KACzBplH,KAAK8lH,WAAazzB,GAAM+yB,KAExBplH,KAAKypH,WAAa,EAElBzpH,KAAK4pH,cAAgB,KAErB5pH,KAAKmsH,kBAAoB,IAAIpgD,GAAGqgD,WAAWC,kBAAkB,CACzDloD,OAASn/C,IACL,MAAMsnG,EAAS,KACX,MAAMzE,EAAM7nH,KAAKykH,uBACjB,IAAI5+C,EAASkG,GAAG46C,OAAO7gD,cAIvB,OAHAD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAO//C,kBAAkB,EAAEihD,EAAIt6E,QAC9Es4B,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,sBAAsBkhD,EAAItkD,QAChFsC,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,yBAAyBmhD,EAAIxpG,GAAIwpG,EAAIvpG,IACpFunD,GAGX,GAAmB,SAAf7gD,EAAMzmB,OAAoByB,KAAK4pH,cAAe,CAC9C,MAAM/jD,EAASymD,IACf,IAAIxE,EAAS,CAAC9iG,EAAM+pB,GAAI/pB,EAAMiqB,GAAI,EAAG,GAOrC,OANA64E,EAAS/7C,GAAG46C,OAAO/gD,uBAAuBC,EAAQiiD,QAClD9nH,KAAK4pH,cAAgB,CACjBvrG,EAAGypG,EAAO,GACVxpG,EAAGwpG,EAAO,GACVtsD,SAAUx2C,EAAMq/C,YAKxB,GAAI,MAAOr/C,GAAS,OAAQA,EAAO,CAE/B,MAAM6gD,EAASymD,IAEf,GAAI,MAAOtnG,EAAO,CACd,IAAI8iG,EAAS,CAAC9iG,EAAM3G,EAAG2G,EAAM1G,EAAG,EAAG,GACnCwpG,EAAS/7C,GAAG46C,OAAO/gD,uBAAuBC,EAAQiiD,GAClD9iG,EAAM3G,EAAIypG,EAAO,GACjB9iG,EAAM1G,EAAIwpG,EAAO,GAErB,GAAI,OAAQ9iG,EAAO,CACfA,EAAM8pB,GAAK9uC,KAAK4pH,cAAcvrG,EAC9B2G,EAAMgqB,GAAKhvC,KAAK4pH,cAActrG,EAC9B0G,EAAMo/C,UAAYpkE,KAAK4pH,cAAcpuD,SACrC,IAAIssD,EAAS,CAAC9iG,EAAM+pB,GAAI/pB,EAAMiqB,GAAI,EAAG,GACrC64E,EAAS/7C,GAAG46C,OAAO/gD,uBAAuBC,EAAQiiD,GAClD9iG,EAAM+pB,GAAK+4E,EAAO,GAClB9iG,EAAMiqB,GAAK64E,EAAO,GAElB9nH,KAAK4pH,cAAgB,CACjBvrG,EAAG2G,EAAM+pB,GACTzwB,EAAG0G,EAAMiqB,GACTusB,SAAUx2C,EAAMq/C,YAMxB,CAAC,OAAQ,QAAQ92D,SAASyX,EAAMzmB,QAChCyB,KAAK4pH,cAAgB5kG,GAEzB00C,EAAEyK,OAAOn/C,MAIjBhlB,KAAK+sD,QAAU,KACf/sD,KAAKukE,WAAY,EAGjBvkE,KAAK8rH,kBAAoB,CACrBzX,KAAM,CACFx6C,UAAYj0D,IAER5F,KAAK+kH,WACL/kH,KAAK4wF,aAAayB,GAAM+yB,MAExB,MAAMjrC,EAAWn6E,KAAK82D,YAAY2e,cAE5BzwD,EAAa,CACfuoB,MAAOvtC,KAAK2kH,oBAAoBp3E,OAMpC,GAJAvoB,EAAMk/C,eAA8B,UAAbiW,EACvBn1D,EAAMw2C,SAAW51D,EAAI41D,SACrBx2C,EAAMq6C,cAAgBz5D,EAAIy5D,YAET,gBAAbz5D,EAAIrH,KAEJyB,KAAKukE,WAAY,EACjBv/C,EAAMzmB,KAAO,WAEV,CAAA,IAAIqH,EAAIo2D,OAGR,MAAiB,cAAbp2D,EAAIrH,MAEXyB,KAAKukE,WAAY,EACjBv/C,EAAMzmB,KAAO,KAEbyB,KAAKmsH,kBAAkBtoH,QAAQmhB,QAC/BhlB,KAAK2oH,4BAGL,EAXA3jG,EAAMzmB,KAAO,OAcjBymB,EAAM3G,EAAIzY,EAAI60D,KACdz1C,EAAM1G,EAAI1Y,EAAI80D,KAEd16D,KAAKmsH,kBAAkBtoH,QAAQmhB,IAEnC6mG,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,OAGrCM,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,QAI7B43B,KAAM,CACFv0B,UAAY70C,IAKR,GAHAhlB,KAAK+kH,WACL/kH,KAAK4wF,aAAayB,GAAMszB,MAEL,gBAAf3gG,EAAMzmB,KAAwB,CAC9B,MAAMguH,EAAQvsH,KAAKqoH,uBAAuB,CAAChqG,EAAG2G,EAAMy1C,KAAMn8C,EAAG0G,EAAM01C,OACnEhB,EAAE8yD,OAAO7uH,KAAKyO,MAAMmgH,EAAMluG,GAAI1gB,KAAKyO,MAAMmgH,EAAMjuG,SAE5C,GAAmB,cAAf0G,EAAMzmB,KAEb,YADAyB,KAAK2oH,uBAMbkD,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,OAGrCM,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,QAI7Bge,KAAM,CACF3a,UAAY70C,IAKR,GAHAhlB,KAAK+kH,WACL/kH,KAAK4wF,aAAayB,GAAMuzB,MAEL,gBAAf5gG,EAAMzmB,KAAwB,CAC9B,MAAMguH,EAAQvsH,KAAKqoH,uBAAuB,CAAChqG,EAAG2G,EAAMy1C,KAAMn8C,EAAG0G,EAAM01C,OACnEhB,EAAE+yD,OAAO9uH,KAAKyO,MAAMmgH,EAAMluG,GAAI1gB,KAAKyO,MAAMmgH,EAAMjuG,GAAIte,KAAK0kH,qBAAqBnhD,YAE1E,GAAmB,cAAfv+C,EAAMzmB,KAEb,YADAyB,KAAK2oH,uBAMbkD,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,OAGrCM,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,QAI7Bk2D,MAAO,CACH7yD,UAAY70C,IAERhlB,KAAK+kH,WACL/kH,KAAK4wF,aAAayB,GAAMwzB,OACxB,MAAM0G,EAAQvsH,KAAKqoH,uBAAuB,CAAChqG,EAAG2G,EAAMy1C,KAAMn8C,EAAG0G,EAAM01C,OAEhD,gBAAf11C,EAAMzmB,MACNyB,KAAKukE,WAAY,EACjB7K,EAAEizD,QAAQ,OAAQJ,EAAMluG,EAAGkuG,EAAMjuG,EAAGte,KAAK0kH,qBAAqBnhD,QAExC,gBAAfv+C,EAAMzmB,KACbm7D,EAAEizD,QAAQ,OAAQJ,EAAMluG,EAAGkuG,EAAMjuG,EAAGte,KAAK0kH,qBAAqBnhD,OAExC,cAAfv+C,EAAMzmB,OACbyB,KAAKukE,WAAY,EACjB7K,EAAEizD,QAAQ,KAAMJ,EAAMluG,EAAGkuG,EAAMjuG,EAAGte,KAAK0kH,qBAAqBnhD,OAC5DvjE,KAAK2oH,wBAIbkD,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,OAGrCM,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,QAI7Bo2D,KAAM,CACF/yD,UAAY70C,IACRhlB,KAAK4wF,aAAayB,GAAMgzB,MACpB,CAAC,OAAQ,UAAU93G,SAASyX,EAAMg3C,SAClCh8D,KAAK4wF,aAAayB,GAAMizB,cACxBtlH,KAAKwmH,mBAAmBnoG,GAAK2G,EAAMm4C,GACnCn9D,KAAKwmH,mBAAmBloG,GAAK0G,EAAMo4C,GACnCp9D,KAAK2kH,oBAAsBplH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBAC1DxmH,KAAKspH,oBAAqB,EAC1BtpH,KAAK4mH,kBAAmB,EACxB5mH,KAAK+kH,UAAS,IACQ,cAAf//F,EAAMzmB,MACbyB,KAAK2oH,uBAGbkD,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,OAGrCM,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,QAI7Bu1D,UAAW,CACPlyD,UAAY70C,IACRhlB,KAAK4wF,aAAayB,GAAMgzB,MACpB,CAAC,OAAQ,UAAU93G,SAASyX,EAAMg3C,UAClCh8D,KAAK4wF,aAAayB,GAAMizB,cACxBtlH,KAAKwmH,mBAAmBnoG,GAAK2G,EAAMm4C,GACnCn9D,KAAKwmH,mBAAmBloG,GAAK0G,EAAMo4C,GACnCp9D,KAAK2kH,oBAAsBplH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBAC1DxmH,KAAKspH,oBAAqB,EAC1BtpH,KAAK4mH,kBAAmB,EACxB5mH,KAAK+kH,UAAS,KAGtB8G,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,KAChB,UAAbzxC,EACAn6E,KAAK2oH,sBAEL3oH,KAAK4wF,aAAayB,GAAMgzB,OAGhC6G,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,KACrBx2D,KAAK2oH,wBAGbsD,KAAM,CACFpyD,UAAY70C,IAGR,GAFAhlB,KAAK4wF,aAAayB,GAAMmzB,MAEH,SAAjBxgG,EAAMg3C,SAAsBh3C,EAAMq6C,aAA2B,GAAZr6C,EAAMm4C,GAAS,CAEhE,MAAM0vD,EAAU7nG,EAAM4zC,MAAQ5zC,EAAMy1C,KAC9BqyD,EAAU9nG,EAAM6zC,MAAQ7zC,EAAM01C,KAEpC16D,KAAKmmH,mBAAmBnhG,EAAMm4C,GAAK,IAAKn4C,EAAM05C,UAAYmuD,EAAS7nG,EAAM25C,UAAYmuD,GACrF9sH,KAAK2kH,oBAAsBplH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBAC1DxmH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,WAEL/kH,KAAKsqH,aAAa,CACdC,QAAS,CAAC,SACVhnD,MAAOvjE,KAAKwmH,mBAAmBjjD,MAC/Bh2B,MAAOvtC,KAAKwmH,mBAAmBj5E,UAI3Cs+E,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,KAChB,MAAbzxC,EACAn6E,KAAK2oH,sBAEL3oH,KAAK4wF,aAAayB,GAAMmzB,OAGhC0G,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,KACrBx2D,KAAK2oH,wBAGboE,OAAQ,CACJlzD,UAAY70C,IAER,GADAhlB,KAAK4wF,aAAayB,GAAMkzB,MAEnB,CAAC,OAAQ,SAASh4G,SAASyX,EAAMg3C,UAAYh3C,EAAMq6C,aACrC,cAAfr6C,EAAMzmB,KACR,CACE,MAAMguH,EAAQvsH,KAAKqoH,uBAAuB,CAAChqG,EAAG2G,EAAMy1C,KAAMn8C,EAAG0G,EAAM01C,OAC7DsyD,EAAchtH,KAAK6kH,SAASZ,WAAWsI,EAAMluG,EAAGkuG,EAAMjuG,GAC5Do7C,EAAEuzD,OAAOD,EAA4B,cAAfhoG,EAAMzmB,MAC5ByB,KAAKkmH,WAAWj1B,mBAAmB,CAC/B5yE,EAAG2G,EAAMy1C,KACTn8C,EAAG0G,EAAM01C,KACTqoB,MAAOiqC,EACPh8B,UAA0B,cAAfhsE,EAAMzmB,OAGF,cAAfymB,EAAMzmB,MACNyB,KAAK2oH,wBAIjBkD,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,OAGrCM,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,QAI7Bw1D,UAAW,CACPnyD,UAAY70C,IAER,GADAhlB,KAAK4wF,aAAayB,GAAMkzB,MAEnB,CAAC,OAAQ,SAASh4G,SAASyX,EAAMg3C,UAAYh3C,EAAMq6C,aACrC,cAAfr6C,EAAMzmB,KACR,CACE,MAAMguH,EAAQvsH,KAAKqoH,uBAAuB,CAAChqG,EAAG2G,EAAMy1C,KAAMn8C,EAAG0G,EAAM01C,OAC7DsyD,EAAchtH,KAAK6kH,SAASZ,WAAWsI,EAAMluG,EAAGkuG,EAAMjuG,GAC5Do7C,EAAEuzD,OAAOD,EAA4B,cAAfhoG,EAAMzmB,MAC5ByB,KAAKkmH,WAAWj1B,mBAAmB,CAC/B5yE,EAAG2G,EAAMy1C,KACTn8C,EAAG0G,EAAM01C,KACTqoB,MAAOiqC,EACPh8B,UAA0B,cAAfhsE,EAAMzmB,SAI7BstH,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,KAChB,QAAbzxC,EACAn6E,KAAK2oH,sBAEL3oH,KAAK4wF,aAAayB,GAAMkzB,OAGhC2G,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,KACrBx2D,KAAK2oH,wBAGbt2C,OAAQ,CACJxY,UAAY70C,IAGR,GAFAhlB,KAAK4wF,aAA8B,SAAjB5rE,EAAMg3C,OAAoBq2B,GAAMqzB,SAAWrzB,GAAMozB,QAEhD,gBAAfzgG,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OACtCh8D,KAAK0rH,gBAAkBnsH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,0BACnD,GAAqB,SAAjBxhG,EAAMg3C,SAAsBh3C,EAAMq6C,aAAer/D,KAAK0rH,gBAAiB,CAG9E,MAAMmB,EAAU7nG,EAAM4zC,MAAQ5zC,EAAMy1C,KAC9BqyD,EAAU9nG,EAAM6zC,MAAQ7zC,EAAM01C,KAE9BswD,EAAY,CACd3sG,EAAGre,KAAKunH,YAAc,EACtBjpG,EAAGte,KAAKwnH,aAAe,GAGrB0F,EAAgBnhD,GAAGi6B,KAAKziC,MAAMynD,EAAW,CAAC3sG,EAAG2G,EAAM05C,UAAYmuD,EAASvuG,EAAG0G,EAAM25C,UAAYmuD,IAEnG,IAAIK,EADaphD,GAAGi6B,KAAKziC,MAAMynD,EAAW,CAAC3sG,EAAG2G,EAAM4zC,MAAQi0D,EAASvuG,EAAG0G,EAAM6zC,MAAQi0D,IAC3DI,EAG3BltH,KAAKwmH,mBAAqBjnH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAK0rH,kBACzD1rH,KAAKwmH,mBAAmBjjD,OAAS4pD,EAE7BntH,KAAK82D,YAAY0e,UAAU,WAC3Bx1E,KAAKwmH,mBAAmBjjD,MAAQ5lE,KAAK4jC,MAAMvhC,KAAKwmH,mBAAmBjjD,MAAQ5lE,KAAKuvC,GAAK,GAAKvvC,KAAKuvC,GAAK,EACpGigF,EAAYntH,KAAKwmH,mBAAmBjjD,MAAQvjE,KAAK0rH,gBAAgBnoD,OAGrEvjE,KAAKwmH,mBAAmBjjD,MAAQvjE,KAAK0oH,iBAAiB1oH,KAAKwmH,mBAAmBjjD,OAG9E,IAAIsC,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,wBAAwBskD,EAAU3sG,EAAG2sG,EAAU1sG,IAErGunD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,qBAAqBwmD,IAC3EtnD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,yBAAyBskD,EAAU3sG,GAAI2sG,EAAU1sG,IAGvG,IAAI2wC,EAAS,CAACjvD,KAAKwmH,mBAAmBnoG,EAAGre,KAAKwmH,mBAAmBloG,EAAG,EAAG,GACvE2wC,EAAS8c,GAAG46C,OAAO/gD,uBAAuBC,EAAQ5W,GAClDjvD,KAAKwmH,mBAAmBnoG,EAAI4wC,EAAO,GACnCjvD,KAAKwmH,mBAAmBloG,EAAI2wC,EAAO,GAEnCjvD,KAAK2kH,oBAAsBplH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBAE1DxmH,KAAK4mH,kBAAmB,EACxB5mH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,WAEL/kH,KAAKsqH,aAAa,CACdC,QAAS,CAAC,SACVh9E,MAAOvtC,KAAKwmH,mBAAmBj5E,MAC/Bg2B,MAAOvjE,KAAKwmH,mBAAmBjjD,UAK3CsoD,UAAS,CAAG33D,EAAQlvC,EAAOm1D,EAAUyxC,KAC7B,CAAC,IAAK,UAAW,UAAW,SAAU,UAAW,eAAgB,eAAgB,QAAQr+G,SAAS4sE,GAClGn6E,KAAK4wF,aAAayB,GAAMozB,QAExBzlH,KAAK2oH,uBAGbuD,QAAO,CAAGh4D,EAAQlvC,EAAOwxC,KACrB,MAAM2jB,EAAWn6E,KAAK82D,YAAY2e,cAC9B,CAAC,IAAK,UAAW,UAAW,SAAU,UAAW,eAAgB,eAAgB,QAAQloE,SAAS4sE,GAClGn6E,KAAK4wF,aAAayB,GAAMozB,QAExBzlH,KAAK2oH,yBAKrB3oH,KAAK4oH,sBAAwB,KAG7B5oH,KAAKotH,oBAAqB,EAC1BptH,KAAKqtH,YAAc,IAAIthD,GAAGqgD,WAAWkB,YAAY,CAC7CpqD,QAAUl+C,IAEN,GAAmB,SAAfA,EAAMzmB,KAAiB,CAElByB,KAAK0rH,kBACN1rH,KAAK0rH,gBAAkBnsH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBACtDxmH,KAAKotH,mBAAqBptH,KAAKwmH,mBAAmBjjD,OAAS5lE,KAAKuvC,GAAK,IAAO,GAGhFltC,KAAKwmH,mBAAqBjnH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAK0rH,kBAEzD1mG,EAAMuoB,MAAQ5vC,KAAK6O,IApmCrB,MAomCoC7O,KAAK+O,IAnmCzC,GAmmCwD1M,KAAKwmH,mBAAmBj5E,MAAQvoB,EAAMuoB,QAAUvtC,KAAKwmH,mBAAmBj5E,MAE9HvtC,KAAKwmH,mBAAmBj5E,OAASvoB,EAAMuoB,MACvCvtC,KAAKwmH,mBAAmBjjD,OAASv+C,EAAMi+C,SACvCjjE,KAAKwmH,mBAAmBjjD,MAAQvjE,KAAK0oH,iBACjC1oH,KAAKsoH,aACDtoH,KAAKwmH,mBAAmBjjD,MACxB,GACAvjE,KAAKotH,mBAAqB,GAAK,IAGnCptH,KAAKwmH,mBAAmBjjD,OAAS5lE,KAAKuvC,GAAK,IAAO,IAClDltC,KAAKotH,oBAAqB,GAG9BpoG,EAAMi+C,SAAWjjE,KAAKwmH,mBAAmBjjD,MAAQvjE,KAAK0rH,gBAAgBnoD,MAGtE,CACI,IAAIsC,EAASkG,GAAG46C,OAAO7gD,cACvBD,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,wBAAwB1hD,EAAMy1C,KAAMz1C,EAAM01C,OAChGmL,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAO//C,kBAAkB5hD,EAAMuoB,QAC9Es4B,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOhgD,qBAAqB3hD,EAAMi+C,WACjF4C,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,yBAAyB1hD,EAAMy1C,MAAOz1C,EAAM01C,OAClGmL,EAASkG,GAAG46C,OAAO5gD,iBAAiBF,EAAQkG,GAAG46C,OAAOjgD,wBAAwB1hD,EAAMy1C,KAAOz1C,EAAM29C,SAAU39C,EAAM01C,KAAO11C,EAAM49C,WAG9H,IAAI3T,EAAS,CAACjvD,KAAKwmH,mBAAmBnoG,EAAGre,KAAKwmH,mBAAmBloG,EAAG,EAAG,GACvE2wC,EAAS8c,GAAG46C,OAAO/gD,uBAAuBC,EAAQ5W,GAElDjvD,KAAKwmH,mBAAmBnoG,EAAI4wC,EAAO,GACnCjvD,KAAKwmH,mBAAmBloG,EAAI2wC,EAAO,GAIvCjvD,KAAK2kH,oBAAsB54C,GAAG86B,QAAQ7mG,KAAKwmH,oBAG3CxmH,KAAKsqH,aAAa,CACdC,QAAS,CAAC,QAAS,SACnBh9E,MAAOvtC,KAAKwmH,mBAAmBj5E,MAC/Bg2B,MAAOvjE,KAAKwmH,mBAAmBjjD,QAGnCvjE,KAAK+kH,WACL/kH,KAAK4mH,kBAAmB,EACxB5mH,KAAK8kH,mBAAoB,MAGH,QAAf9/F,EAAMzmB,OACbyB,KAAK0rH,gBAAkB,SAOnC,MAAMhrD,EAAW,KACb,IAAI6sD,EAAehuH,KAAKC,MAAMD,KAAK8zD,UAAUrzD,KAAKwmH,qBAClDj/C,EAAMkjD,UAENzqH,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,WAGDwI,EAAahgF,QAAUvtC,KAAKwmH,mBAAmBj5E,OAC/CggF,EAAahqD,QAAUvjE,KAAKwmH,mBAAmBjjD,OAE/CvjE,KAAKsqH,aAAa,CACdC,QAAS,CAAC,QAAS,SACnBhnD,MAAOvjE,KAAKwmH,mBAAmBjjD,MAC/Bh2B,MAAOvtC,KAAKwmH,mBAAmBj5E,SAK3CvtC,KAAKimH,iBAAmB,IAAIl6C,GAAGqgD,WAAWoB,aAAa,aAAE9sD,IACzD1gE,KAAKytH,mBAAqB,IAAI1hD,GAAGqgD,WAAWoB,aAAa,aAAE9sD,IAC3D1gE,KAAKytH,mBAAmBpsD,oBAAoB,CAAC,WAG7CrhE,KAAK0tH,aAAe,IAAI3hD,GAAGqgD,WAAWuB,cAAc,CAChDpsD,QAAS,EACTU,MAAK,KACDvI,EAAEk0D,YAGV5tH,KAAK6tH,eAAiB,IAAI9hD,GAAGqgD,WAAWuB,cAAc,CAClDpsD,QAAS,EACTU,MAAK,KACDvI,EAAEo0D,YAKV9tH,KAAK+tH,kBAAoB,IAAIhiD,GAAGqgD,WAAWA,WAAW,CAClD3sD,SAAU,CACNz/D,KAAK0tH,aACL1tH,KAAK6tH,eACL7tH,KAAKimH,iBACLjmH,KAAKytH,mBACLztH,KAAKqtH,YACL,IAAIthD,GAAGqgD,WAAW4B,kBAClB,IAAIjiD,GAAGqgD,WAAW6B,qBAG1BjuH,KAAK+tH,kBAAkBluD,aAAa76C,IAgBhC,GAdAhlB,KAAK2rH,UAAUttG,EAAI2G,EAAMy1C,KACzBz6D,KAAK2rH,UAAUrtG,EAAI0G,EAAM01C,KACN,cAAf11C,EAAMzmB,MAA8C,UAAtBymB,EAAM42C,aACpC57D,KAAK+sD,QAAU,KACf/sD,KAAK8kH,mBAAoB,EACzB9kH,KAAK+kH,aAEA/kH,KAAK+sD,UACN/sD,KAAK+sD,QAAU,CAAE1uC,EAAG,EAAGC,EAAG,IAE9Bte,KAAK+sD,QAAQ1uC,EAAI2G,EAAMy1C,KACvBz6D,KAAK+sD,QAAQzuC,EAAI0G,EAAM01C,MAGvB16D,KAAK4oH,sBACL5oH,KAAK4oH,sBAAsB/uD,UAAU70C,OAElC,CAEH,IAAIm1D,EAAWn6E,KAAK82D,YAAY2e,cAE5Bz1E,KAAK8lH,aAAezzB,GAAM+yB,KAEtB,CAAC,GAAI,QAAS,QAAQ73G,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,QAClFh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBzX,KACpDr0G,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,UAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBiB,OACpD/sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,WAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBc,KACpD5sH,KAAK4oH,sBAAsB/uD,UAAU70C,KAErChlB,KAAK4wF,aAAayB,GAAM+yB,MACxBplH,KAAK+kH,YAGF/kH,KAAK8lH,aAAezzB,GAAMgzB,KAEd,gBAAfrgG,EAAMzmB,MAA0B,CAAC,OAAQ,UAAUgP,SAASyX,EAAMg3C,SAClEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBc,KACpD5sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,UAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBiB,OACpD/sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAErChlB,KAAK4wF,aAAayB,GAAMgzB,MAGrBrlH,KAAK8lH,aAAezzB,GAAMkzB,KAEd,gBAAfvgG,EAAMzmB,MAA0B,CAAC,OAAQ,SAASgP,SAASyX,EAAMg3C,SACjEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBiB,OACpD/sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,WAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBc,KACpD5sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAErChlB,KAAK4wF,aAAayB,GAAMkzB,MAGrBvlH,KAAK8lH,aAAezzB,GAAMszB,KAEd,gBAAf3gG,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,QACtCh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkB19B,KACpDpuF,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,UAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBiB,OACpD/sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,WAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBc,KACpD5sH,KAAK4oH,sBAAsB/uD,UAAU70C,KAErChlB,KAAK4wF,aAAayB,GAAMszB,MACxB3lH,KAAK+kH,YAGF/kH,KAAK8lH,aAAezzB,GAAMuzB,KAEd,gBAAf5gG,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,QACtCh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBt3C,KACpDx0E,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,UAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBiB,OACpD/sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,WAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBc,KACpD5sH,KAAK4oH,sBAAsB/uD,UAAU70C,KAErChlB,KAAK4wF,aAAayB,GAAMuzB,MACxB5lH,KAAK+kH,YAGF/kH,KAAK8lH,aAAezzB,GAAMwzB,QAE7B,CAAC,GAAI,QAAS,QAAQt4G,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,QAClFh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBY,MACpD1sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,UAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBiB,OACpD/sH,KAAK4oH,sBAAsB/uD,UAAU70C,IAC9B,CAAC,IAAIzX,SAAS4sE,IAA4B,gBAAfn1D,EAAMzmB,MAA2C,WAAjBymB,EAAMg3C,QACxEh8D,KAAK4oH,sBAAwB5oH,KAAK8rH,kBAAkBc,KACpD5sH,KAAK4oH,sBAAsB/uD,UAAU70C,KAErChlB,KAAK4wF,aAAayB,GAAMwzB,OACxB7lH,KAAK+kH,iBAWrBh5C,GAAGpmD,iBAAiB3lB,KAAK84E,OAAQ,SAAU9zD,IACvCA,EAAM4xC,oBAIV9wC,YAAU,KACN9lB,KAAKgiF,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CAC1Cj0E,OAAQpO,KAAK84E,OACb7Z,aAAa,EACbpF,UAAYn7D,IACR,GAAe,gBAAXA,EAAEH,MAAuC,WAAbG,EAAEs9D,OAC9B,IACIt9D,EAAEw9D,sBACJ,MAAOlL,IAMbhxD,KAAK+tH,kBAAkBnuD,QAAQlhE,IAEnCq7D,QAAUM,IAEN,GAAIr6D,KAAKukE,UACL,OAGJvkE,KAAK+kH,WACS/kH,KAAKmmH,oBACd9rD,EAAW1B,QAAU34D,KAAK82D,YAAY0e,UAAU,SAAW,EAAI,GAChEnb,EAAWI,KACXJ,EAAWK,OAGX16D,KAAKsqH,aAAa,CACdC,QAAS,CAAC,SACVhnD,MAAOvjE,KAAKwmH,mBAAmBjjD,MAC/Bh2B,MAAOvtC,KAAKwmH,mBAAmBj5E,QAKvCvtC,KAAK8kH,mBAAoB,GAI7B7qD,aAAeqF,IACNA,GACIt/D,KAAKukE,YACNvkE,KAAK+sD,QAAU,KACf/sD,KAAK8kH,mBAAoB,IAIrC5qD,YAAa,MAElB,GAEHl6D,KAAKupH,YAAc,EAEnBvpH,KAAK8oH,yBAA0B,EAM/B9oH,KAAK8kH,mBAAoB,EACzB9kH,KAAKopH,eAAiBxuD,YAAYr1C,MAElCzlB,OAAOkpH,uBAAqB,IAAOhpH,KAAK+oH,eAExC/oH,KAAK6pH,8BqFz0CTv3B,mBAGAoQ,aACAE,yBCjFQsrB,aACJ,OAAIluH,KAAKmuH,WAGTnuH,KAAKmuH,UAAW,EAChBroG,YAAU,KACN9lB,KAAKmuH,UAAW,IACjB,IACI,GAkBX33C,OACI,IAAKx2E,KAAKkuH,aACN,OAAO,EAGX,IAAKr3C,GAAUF,UACX,OAAO,EAEX,MAAMo0B,EAA2Bl0B,GAAUL,OAC3CK,GAAUR,OAAM,GAChB,MAAM+3C,EAAwBpuH,KAAKquH,eAC7BC,EAActuH,KAAKuuH,cAAczN,WAAjCwN,EAAgDtuH,KAAKuuH,cAAcxN,YACzE/gH,KAAKuuH,cAAcvN,KAAKoN,EAAUv7D,QAClC,IAAI8vD,EAAayL,EAAU/iD,MAC3BrrE,KAAKwuH,mBAAmBxuH,KAAKuuH,cAActM,gBAAgBU,IAC3D,MAAM8L,EAAe,GACrB,IAAK,IAAIC,KAAK7lB,GAAG4lB,QACT5lB,GAAG4lB,QAAQ9tH,eAAe+tH,KAC1BD,EAAQC,GAAK,IAAI7lB,GAAG4lB,QAAQC,GAC5BD,EAAQC,GAAGhjB,WAAW1rG,KAAK2uH,uBAGnCF,EAAQxW,aAAahH,QAAQmd,EAAUK,QAAQxW,aAAa/G,WAC5D,IAAK,IAAIn1G,EAAI,EAAGA,EAAIgvG,EAAQ/uG,OAAQD,IAAC,CAC/BA,IACE,GAA2B,UAAvBgvG,EAAQhvG,GAAG+uG,KAAK,GAAgB,CAChC,MAAM9sF,EAAIywG,EAAQ1jB,EAAQhvG,GAAG+uG,KAAK,IAClC,GAAIC,EAAQhvG,GAAGgvG,QACX,IAAK,IAAIrsG,EAAI,EAAGA,EAAIqsG,EAAQhvG,GAAGgvG,QAAQ/uG,OAAQ0C,IAAK,CAChD,MAAMg7D,EAAIqxC,EAAQhvG,GAAGgvG,QAAQrsG,GAAG+mD,OAChCznC,EAAE+sF,EAAQhvG,GAAGgvG,QAAQrsG,GAAGw4E,QAAQ/3E,MAAM6e,EAAG07C,OAE1C,CACH,MAAMA,EAAIqxC,EAAQhvG,GAAG0pD,OACrBznC,EAAE+sF,EAAQhvG,GAAGm7E,QAAQ/3E,MAAM6e,EAAG07C,SAE/B,GAA2B,WAAvBqxC,EAAQhvG,GAAG+uG,KAAK,GAAiB,CACxC,MAAMpxC,EAAIqxC,EAAQhvG,GAAG0pD,OACfxpD,EAAK+D,KAAKuuH,cAAcxjB,EAAQhvG,GAAGm7E,QAAQ/3E,MAAMa,KAAKuuH,cAAe70D,GAC3E,GAAkB,iBAAPz9D,EAAiB,CACxB0mH,EAAa1mH,EACb+D,KAAKwuH,mBAAmBxuH,KAAKuuH,cAActM,gBAAgBU,IAC3D,IAAK,IAAI3kG,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW1rG,KAAK2uH,4BAIpC,GAA2B,WAAvB5jB,EAAQhvG,GAAG+uG,KAAK,GAAiB,CACxC,MAAMpxC,EAAI,CAAC,CACP6uC,QAASvoG,KAAK2uH,qBACd97D,OAAQ7yD,KAAKuuH,cACb7oH,MAAOqlG,EAAQhvG,GAAG0pD,OAAO,GAAG//C,MAC5BkjG,QAAS,IAAIC,GAAGC,iBAEpBD,GAAG+lB,UAAU7jB,EAAQhvG,GAAG+uG,KAAK,IAAIC,EAAQhvG,GAAGm7E,QAAQ/3E,MAAM,KAAMu6D,QAE7D,GAA2B,SAAvBqxC,EAAQhvG,GAAG+uG,KAAK,IAAuC,eAAtBC,EAAQhvG,GAAGm7E,OAAyB,CAC5EyrC,EAAa5X,EAAQhvG,GAAG0pD,OAAO,GAC/BzlD,KAAKwuH,mBAAmBxuH,KAAKuuH,cAActM,gBAAgBlX,EAAQhvG,GAAG0pD,OAAO,KAC7E,IAAK,IAAIznC,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW1rG,KAAK2uH,2BAGhC,GAA2B,SAAvB5jB,EAAQhvG,GAAG+uG,KAAK,IAAuC,gBAAtBC,EAAQhvG,GAAGm7E,OAA0B,CAC7E,MAAMj7E,EAAK+D,KAAKuuH,cAAc9N,WAC9B,GAAkB,iBAAPxkH,EAAiB,CACxB0mH,EAAa1mH,EACT8uG,EAAQhvG,GAAG0pD,OAAO,IAClBzlD,KAAKuuH,cAAcpM,YAAYQ,EAAY5X,EAAQhvG,GAAG0pD,OAAO,IAEjEzlD,KAAKwuH,mBAAmBxuH,KAAKuuH,cAActM,gBAAgBU,IAC3D,IAAK,IAAI3kG,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW1rG,KAAK2uH,sBAIvC3uH,KAAK2uH,qBAAqBn9C,UAAUu5B,EAAQhvG,GAAG0pD,OAAO,GAAI,EAAG,KAxDpC,CA0D9B1pD,GAaP,OAXIuyH,IAActuH,KAAKuuH,cAAczN,YAAcwN,IAActuH,KAAKuuH,cAAcxN,cAChF/gH,KAAK6uH,kBAAkBhF,YACvB7pH,KAAK8uH,OAAOriF,OAAOzsC,KAAK6uH,kBAAkBvd,WAAYtxG,KAAK6uH,kBAAkBxD,gBAEjFrrH,KAAK+uH,aAAatiF,OAAOk2E,GACzB3iH,KAAKgvH,aAAaC,SAASjvH,KAAKuuH,cAAcvK,SAASrB,IACvD3iH,KAAKkvH,WAAWlV,aAAa/I,QAAQwd,EAAQxW,aAAa/G,WAC1DlxG,KAAKmvH,kBAAkBzjB,WAAW1rG,KAAK2uH,sBACvC3uH,KAAK6uH,kBAAkBpD,iBAAiB,MAExC50C,GAAUR,OAAM,IACT,EAGXI,OACI,IAAKz2E,KAAKkuH,aACN,OAAO,EAGX,IAAKr3C,GAAUH,UACX,OAAO,EAEX,MAAMq0B,EAAUl0B,GAAUJ,OAC1BI,GAAUR,OAAM,GAChB,MAAMi4C,EAActuH,KAAKuuH,cAAczN,WAAjCwN,EAAgDtuH,KAAKuuH,cAAcxN,YACzE,IAAI4B,EACJ,MAAM8L,EAAe,GACrB,IAAK,IAAIW,KAAKvmB,GAAG4lB,QACT5lB,GAAG4lB,QAAQ9tH,eAAeyuH,KAC1BX,EAAQW,GAAK,IAAIvmB,GAAG4lB,QAAQW,GAC5BX,EAAQW,GAAG1jB,WAAW1rG,KAAK2uH,uBAGnCF,EAAQxW,aAAahH,QAAQjxG,KAAKkvH,WAAWlV,aAAa9I,WAC1D,IAAK,IAAIn1G,EAAI,EAAGA,EAAIgvG,EAAQ/uG,OAAQD,IAAC,CAC/BA,IACE,GAA2B,UAAvBgvG,EAAQhvG,GAAG+uG,KAAK,GAAgB,CAChC,MAAM9sF,EAAIywG,EAAQ1jB,EAAQhvG,GAAG+uG,KAAK,IAClC,GAAIC,EAAQhvG,GAAGgvG,QACX,IAAK,IAAIrsG,EAAI,EAAGA,EAAIqsG,EAAQhvG,GAAGgvG,QAAQ/uG,OAAQ0C,IAAK,CAChD,MAAMg7D,EAAIqxC,EAAQhvG,GAAGgvG,QAAQrsG,GAAG+mD,OAChCznC,EAAE+sF,EAAQhvG,GAAGgvG,QAAQrsG,GAAGw4E,QAAQ/3E,MAAM6e,EAAG07C,OAE1C,CACH,MAAMA,EAAIqxC,EAAQhvG,GAAG0pD,OACrBznC,EAAE+sF,EAAQhvG,GAAGm7E,QAAQ/3E,MAAM6e,EAAG07C,SAE/B,GAA2B,WAAvBqxC,EAAQhvG,GAAG+uG,KAAK,GAAiB,CACxC,MAAMpxC,EAAIqxC,EAAQhvG,GAAG0pD,OACfxpD,EAAK+D,KAAKuuH,cAAcxjB,EAAQhvG,GAAGm7E,QAAQ/3E,MAAMa,KAAKuuH,cAAe70D,GAC3E,GAAkB,iBAAPz9D,EAAiB,CACxB0mH,EAAa1mH,EACb+D,KAAKwuH,mBAAmBxuH,KAAKuuH,cAActM,gBAAgBU,IAC3D,IAAK,IAAI3kG,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW1rG,KAAK2uH,4BAIpC,GAA2B,WAAvB5jB,EAAQhvG,GAAG+uG,KAAK,GAAiB,CACxC,MAAMpxC,EAAI,CAAC,CACP6uC,QAASvoG,KAAK2uH,qBACd97D,OAAQ7yD,KAAKuuH,cACb7oH,MAAOqlG,EAAQhvG,GAAG0pD,OAAO,GAAG//C,MAC5BkjG,QAAS,IAAIC,GAAGC,iBAEpBD,GAAG+lB,UAAU7jB,EAAQhvG,GAAG+uG,KAAK,IAAIC,EAAQhvG,GAAGm7E,QAAQ/3E,MAAM,KAAMu6D,QAE7D,GAA2B,SAAvBqxC,EAAQhvG,GAAG+uG,KAAK,IAAuC,eAAtBC,EAAQhvG,GAAGm7E,OAAyB,CAC5EyrC,EAAa5X,EAAQhvG,GAAG0pD,OAAO,GAC/BzlD,KAAKwuH,mBAAmBxuH,KAAKuuH,cAActM,gBAAgBlX,EAAQhvG,GAAG0pD,OAAO,KAC7E,IAAK,IAAIznC,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW1rG,KAAK2uH,2BAGhC,GAA2B,SAAvB5jB,EAAQhvG,GAAG+uG,KAAK,IAAuC,gBAAtBC,EAAQhvG,GAAGm7E,OAA0B,CAC7E,MAAMj7E,EAAK+D,KAAKuuH,cAAc9N,WAC9B,GAAkB,iBAAPxkH,EAAiB,CACxB0mH,EAAa1mH,EACT8uG,EAAQhvG,GAAG0pD,OAAO,IAClBzlD,KAAKuuH,cAAcpM,YAAYQ,EAAY5X,EAAQhvG,GAAG0pD,OAAO,IAEjEzlD,KAAKwuH,mBAAmBxuH,KAAKuuH,cAActM,gBAAgBU,IAC3D,IAAK,IAAI3kG,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW1rG,KAAK2uH,sBAIvC3uH,KAAK2uH,qBAAqBn9C,UAAUu5B,EAAQhvG,GAAG0pD,OAAO,GAAI,EAAG,KAxDpC,CA0D9B1pD,GAGHuyH,IAActuH,KAAKuuH,cAAczN,YAAcwN,IAActuH,KAAKuuH,cAAcxN,cAChF/gH,KAAK6uH,kBAAkBhF,YACvB7pH,KAAK8uH,OAAOriF,OAAOzsC,KAAK6uH,kBAAkBvd,WAAYtxG,KAAK6uH,kBAAkBxD,gBAEjF,MAAMgE,EAAoBrvH,KAAKuuH,cAAczK,cAAc9jH,KAAK2uH,qBAAqB97D,QAQrF,OAPA7yD,KAAK+uH,aAAatiF,OAAO4iF,GACzBrvH,KAAKgvH,aAAaC,SAASjvH,KAAKuuH,cAAcvK,SAASqL,IACvDrvH,KAAKkvH,WAAWlV,aAAa/I,QAAQwd,EAAQxW,aAAa/G,WAC1DlxG,KAAKmvH,kBAAkBzjB,WAAW1rG,KAAK2uH,sBACvC3uH,KAAK6uH,kBAAkBpD,iBAAiB,MACxC50C,GAAUR,OAAM,IAET,EAGXi5C,QAASC,GAGL,GAAIA,GAAYA,EAASl4C,aAAc,CACnC,MAAM+2C,EAAwBpuH,KAAKquH,eAE7BI,EAAUL,EAAUK,QACpB1jB,EAAU,CAACwkB,EAASl4C,cAC1B,IAAIm4C,EAAuBpB,EAAUv7D,OAAOovD,gBAAgBmM,EAAU/iD,OACtE,MAAMxY,EAASu7D,EAAUv7D,OACzB,IAAI8vD,EAAayL,EAAU/iD,OACzBtvE,IACE,GAA2B,UAAvBgvG,EAwDL,GAxDgBD,KAAK,GAAgB,CAChC,IAAI9sF,EAAIywG,EAAQ1jB,EAuDrB,GAvDgCD,KAAK,IAChC,GAAIC,EAsDT,GAtDoBA,QACX,IAAK,IAAIrsG,EAAI,EAAGA,EAAIqsG,EAqD7B,GArDwCA,QAAQ/uG,OAAQ0C,IAAK,CAChD,MAAMg7D,EAAIqxC,EAoDvB,GApDkCA,QAAQrsG,GAAG+mD,OAChCznC,EAAE+sF,EAmDf,GAnD0BA,QAAQrsG,GAAGw4E,QAAQ/3E,MAAM6e,EAAG07C,OAE1C,CACH,MAAMA,EAAIqxC,EAgDnB,GAhD8BtlD,OACrBznC,EAAE+sF,EA+CX,GA/CsB7zB,QAAQ/3E,MAAM6e,EAAG07C,SAE/B,GAA2B,WAAvBqxC,EA6CZ,GA7CuBD,KAAK,GAAiB,CACxC,MAAMpxC,EAAIqxC,EA4Cf,GA5C0BtlD,OACfxpD,EAAK42D,EAAOk4C,EA2CvB,GA3CkC7zB,QAAQ/3E,MAAM0zD,EAAQ6G,GACnD,GAAkB,iBAAPz9D,EAAiB,CACxB0mH,EAAa1mH,EACbuzH,EAAuB38D,EAAOovD,gBAAgBU,GAC9C,IAAK,IAAI3kG,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW8jB,SAI/B,GAA2B,WAAvBzkB,EAiCZ,GAjCuBD,KAAK,GAAiB,CACxC,MAAMpxC,EAAI,CAAC,CACP6uC,QAASinB,EACT38D,OAAQA,EACRntD,MAAOqlG,EA6BhB,GA7B2BtlD,OAAO,GAAG//C,MAC5BkjG,QAAS,IAAIC,GAAGC,iBAEpBD,GAAG+lB,UAAU7jB,EA0BlB,GA1B6BD,KAAK,IAAIC,EA0BtC,GA1BiD7zB,QAAQ/3E,MAAM,KAAMu6D,QAE7D,GAA2B,SAAvBqxC,EAwBZ,GAxBuBD,KAAK,IAAuC,eAAtBC,EAwB7C,GAxBwD7zB,OAAyB,CAC5EyrC,EAAa5X,EAuBlB,GAvB6BtlD,OAAO,GAC/B+pE,EAAuB38D,EAAOovD,gBAAgBlX,EAsBnD,GAtB8DtlD,OAAO,IAChE,IAAK,IAAIznC,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW8jB,QAG3B,GAA2B,SAAvBzkB,EAgBZ,GAhBuBD,KAAK,IAAuC,gBAAtBC,EAgB7C,GAhBwD7zB,OAA0B,CAC7E,MAAMj7E,EAAK42D,EAAO4tD,WAClB,GAAkB,iBAAPxkH,EAAiB,CACxB0mH,EAAa1mH,EACT8uG,EAYb,GAZwBtlD,OAAO,IAClBzlD,KAAKuuH,cAAcpM,YAAYQ,EAAY5X,EAWxD,GAXmEtlD,OAAO,IAEjE+pE,EAAuB38D,EAAOovD,gBAAgBU,GAC9C,IAAK,IAAI3kG,KAAKywG,EACNA,EAAQ9tH,eAAeqd,IACvBywG,EAAQzwG,GAAG0tF,WAAW8jB,GAIlCA,EAAqBh+C,UAAUu5B,EAEpC,GAF+CtlD,OAAO,GAAI,EAAG,QAGhE2oE,EAAU/iD,MAAQs3C,eAlRduM,EACAF,EACAD,EACAD,EACAD,EACAR,EACAE,EACAI,EACAH,EACAW,QATAD,WAAAA,OACAF,aAAAA,OACAD,aAAAA,OACAD,OAAAA,OACAD,kBAAAA,OACAR,aAAAA,OACAE,YAAAA,OACAI,mBAAAA,OACAH,mBAAAA,OACAW,gBAAAA,EA/BTnvH,KAEKmuH,UAAW,eD6FnB9/B,iBACA/C,sBhG1FsB5xB,GAEtB,IAAI+1D,EAAOC,EAAOC,EAElB3vH,KAAK61E,OAAS,SAASx3D,EAAGC,EAAG2kD,GACzBwsD,EAAQpxG,EACRqxG,EAAQpxG,EACRqxG,EAAe1sD,GAGnBjjE,KAAK4vH,OAAS,SAASvxG,EAAGC,GACtBo7C,EAAEizD,SAAQ,EAAO8C,EAAOC,EAAOrxG,EAAGC,EAAGqxG,IAGzC3vH,KAAK81E,KAAO,SAASz3D,EAAGC,GACpBo7C,EAAEizD,SAAQ,EAAM8C,EAAOC,EAAOrxG,EAAGC,EAAGqxG,egG6ExC1jC,OAGA4jC,aACA/vB,aACAgwB,0CPrFqBvgC,SACX,IAAIhyF,SAAO,CAAEJ,EAASK,KACxBikG,GAAkBlS,EAASpyF,EAASK,2BAKxC,aAAa8/G,GAAU9b,gCAIjB8b,GAAU1b,IAKZ91E,KAAKgvF,EAAoBS,GAC7Bv7G,KAAK2rE,UAAUtrC,SAAQ1X,IACnBA,EAAK4zF,SAASzB,EAAWS,MAIzBwU,kBACJlkD,GAAapa,QAAQ,qBAAsB,IAAK,IAAI0b,MAAOe,wBAiC3D,IAAIwzB,EAUA75F,EATJ,IACI65F,QAAuB1hG,KAAKgwH,eAC9B,MAAOtxH,GAEL,MADAsB,KAAKiwH,iBAAkB,EACjB,IAAI9zH,MAAM,YAEpB,IAAKulG,EACD,OAAO,KAGX,IACI75F,QAAeq1G,GAAiBgT,mBAAmBxuB,GACrD,MAAO1wC,GACL,MAAM,IAAI70D,MAAM,gBAEpB,OAAO0L,cAGC0nF,GACR,IACI,MAAMmS,EAAiBwb,GAAiBiT,qBAAqB5gC,SACvDvvF,KAAKowH,cAAc1uB,GAC3B,MAAOhjG,GAEL,MADAsB,KAAKiwH,iBAAkB,EACjB,IAAI9zH,MAAM,YAEpB,CAEI,MAAMulG,QAAuB1hG,KAAKgwH,eAClC,IAAIxT,EAAa,KACjB,IACIA,QAAmBU,GAAiBgT,mBAAmBxuB,GACzD,MAAOhjG,GAIL,YAHMsB,KAAKqwH,gBACXrwH,KAAK+vH,kBACLjqG,YAAU,IAAO9lB,KAAK8rB,QAAQ,GACxB,IAAI3vB,MAAM,gBAEpB6D,KAAK+vH,kBACLjqG,YAAU,IAAO9lB,KAAK8rB,KAAK0wF,EAAW1B,UAAW0B,EAAWjB,YAAY,wBAKtEv7G,KAAKqwH,gBACXrwH,KAAK+vH,kBACLjqG,YAAU,IAAO9lB,KAAK8rB,QAAQ,GAGlC+nB,UAAU+f,GACF5zD,KAAK2rE,UAAUp+D,SAASqmD,IAG5B5zD,KAAK2rE,UAAUvlE,KAAKwtD,GAGxBxgB,YAAYwgB,GACR,IAAK,IAAI73D,EAAI,EAAGA,EAAIiE,KAAK2rE,UAAU3vE,OAAQD,IACvC,GAAI63D,IAAa5zD,KAAK2rE,UAAU5vE,GAE5B,YADAiE,KAAK2rE,UAAUzlC,OAAOnqC,EAAG,GAMrCsgH,WACI,OAAOr8G,KAAKiwH,8BAhIbjwH,KAEK2rE,UAAqC,GAF1C3rE,KAGKiwH,iBAA2B,EA+B/BnwH,OAAO6lB,iBAAiB,WAAYjnB,IAChC,GAAc,uBAAVA,EAAEsH,KAA0D,IAA1BhG,KAAK2rE,UAAU3vE,OAGrD,eAEQ,MAAMwgH,QAAmBx8G,KAAKy8G,OAC1BD,EACAx8G,KAAK8rB,KAAK0wF,EAAW1B,UAAW0B,EAAWjB,WAE3Cv7G,KAAK8rB,WAGf,MAAOu1E,GACa,aAAdA,EAAE78D,UACFxkC,KAAKiwH,iBAAkB,oCC1DvC,OANK1S,KACDA,SAAkBtgH,EAAA,SAClB8uE,GAAGukD,MAAMxkG,KAAK,CACVvtB,KAAM,kBAGPg/G,yBQKPtrC,OACI,MAAM1K,EAAQvnE,cAKLuwH,EAAU19D,EAAQ29D,EAAUC,GACjC,IAAI/hE,EAAQmE,EAAO6S,UAAU+qD,GAAU5zH,MAAK,2CAC5CyrB,QAAQqR,IAAI+0B,EAAM,IACnBgiE,SAAShiE,EAAM,IACf6vD,WAGH,GAVAh3C,EAAMs0C,aAAaxxB,QAUW,QAA1B9iB,EAAMopD,gBAA2B,CACjC,IAAIC,EAAY,MACZH,EAAW,YAEXI,GADW9kD,GAAGwB,UAAYvtE,KAAK8wH,aAClBvpD,EAAMgnD,cAAc9K,kBAAkB,IAWvD,IACI8M,EAAUM,EAAYL,EAAUC,GAClC,MAAOpwH,GACL,IAAIgsE,EAAK,IAAI2c,MACb3c,EAAGva,MAAQyV,EAAMgnD,cAAczN,WAC/Bz0C,EAAGta,OAASwV,EAAMgnD,cAAcxN,YAChC10C,EAAGv2D,IAAM+6G,EAAWnrD,UAAU+qD,GAC9B5nB,GAAGkoB,aAAaxpD,EAAMu0C,SAAUzvC,SAEjC,GAA8B,WAA1B9E,EAAMopD,gBAA8B,CAC3C,IAAIC,EAAY,MACZH,EAAW,YACXO,EAAWjlD,GAAGwB,UAAYvtE,KAAK8wH,aAC/B5I,EAAW3gD,EAAMgnD,cAAc1K,gBACnC,IAAK,IAAI9nH,EAAI,EAAGA,EAAImsH,EAASlsH,OAAQD,IAAK,CACtC,IAAI4sB,EAAOu/F,EAASnsH,GAChBk1H,EAAW,CACXD,EACA,KACC,IAAMj1H,EAAI,IAAIuxE,SAAS,EAAG,KAC3B,IACA3kD,EAAKnhB,KACL,IACAopH,GAEJL,EAAU5nG,EAAKkqC,OAAQo+D,EAASllH,KAAK,IAAK0kH,SAE3C,GAA8B,QAA1BlpD,EAAMopD,gBAA2B,CAExC,IAAIzI,EAAW3gD,EAAMgnD,cAAc1K,gBAE/BqN,EAAY,CACZp/D,MAAOyV,EAAMgnD,cAAczN,WAC3B/uD,OAAQwV,EAAMgnD,cAAcxN,YAC5B9xB,SAAU,GACVp8B,OAAQ0U,EAAMgnD,cAAc9K,kBAAkB,IAElD,IAAK,IAAI1nH,EAAI,EAAGA,EAAImsH,EAASlsH,OAAQD,IAAK,CACtC,IAAI4sB,EAAOu/F,EAASnsH,GACpBm1H,EAAUjiC,SAAS7oF,KAAK,CACpBoB,KAAMmhB,EAAKnhB,KACXq4E,QAASl3D,EAAKk3D,QACdhtB,OAAQlqC,EAAKkqC,OACbg9B,UAAWgZ,GAAGsoB,IAAIC,aAAazoG,EAAK8mE,YACpC30E,KAAM,EACNy4C,IAAK,IAIbs1C,GAAGwoB,YAAYj0H,MAAMk0H,IACjB,IAAIj3F,EAASi3F,EAAUC,eAAeL,GAClC7iD,EAAO,IAAIT,KAAK,CAACvzC,GAAS,CAAE97B,KAAM,6BACtCk/G,GAAAW,OAAO/vC,EAAMtC,GAAGwB,UAAYvtE,KAAK8wH,aAAe,WACjDzxH,OAAK,KACJktE,MAAM,qDAzFNsvC,EACAC,EACA6U,EACApC,EACAuC,QAJAjV,aAAAA,OACAC,SAAAA,OACA6U,cAAAA,OACApC,YAAAA,OACAuC,aAAAA,4BFuGZ9wC,YACAjD,SACAU,UACAC,eACAa,kBACAK,mBG1EA5B,WACI,IAAK,IAAIjhF,EAAI,EAAGA,EAAIiE,KAAKwxH,OAAOx1H,OAAQD,IACpC,GAAIiE,KAAKwxH,OAAOz1H,GAAGkhF,QACf,OAAOj9E,KAAKwxH,OAAOz1H,GAAGU,MAG9B,OAAO,KAGXygF,aACI,OAAOl9E,KAAKqN,eAjDJqsD,GALT15D,KAGHwxH,OAA6B,GAWzBxxH,KAAKqN,GAAK0+D,GAAG1+D,GAAG,CACZ2nE,UAAW,aAGftb,EAAEv7C,MAAMkiB,SAAQ1X,IACZ,IAAIm6B,EAAQipB,GAAG1+D,GAAG,CACdwhE,QAAS,UAETnpE,EAAQqmE,GAAG1+D,GAAG,CACdwhE,QAAS,QACTxnD,OAAQy7B,EACRoa,OAAQ,CACJ11D,KAAMkyD,EAAElyD,KACR/K,MAAOksB,EAAKlsB,MACZ8B,KAAM,WAGVm7D,EAAE+3D,aACF/rH,EAAM8lE,aAAa,oBAAqB,QAExC9R,EAAEr2B,OAAS1a,EAAKlsB,QAChBiJ,EAAMu3E,SAAU,GAEpBn6B,EAAMyD,OAAO59B,EAAKm6B,OAClB9iD,KAAKqN,GAAGk5C,OAAOzD,GACf9iD,KAAKwxH,OAAOprH,KAAKV,0BHiFzBy5E,YACAe,kBACA0C,iB5GtGyB,SAAUlpB,GAEnC,MAAM6N,EAAQvnE,KACd,IAAI0xH,EAAe,SAAS7pH,KAC5B,MAAMuX,EAAMhhB,SAASC,cAAc,OACnC+gB,EAAIxJ,MAAM2b,SAAW,WACrBnS,EAAI41D,UAAY,cAChB,MAAM28C,EAAY5lD,GAAG1+D,GAAG,CACpB0nE,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,YAGdrnB,EAAQ4H,EAAE5H,MAChB,IAAI8/D,EAAWl4D,EAAEk4D,SACjB,MAAM7/D,EAAS2H,EAAE3H,OACXutD,EAAY5lD,EAAEuzD,OAEpB,IAAI4E,EAAkB,CAClBrlG,EAAGqkB,SAAS6oB,EAAEo4D,WAAWtlG,EAAG,IAC5BioC,EAAG5jB,SAAS6oB,EAAEo4D,WAAWr9D,EAAG,IAC5Bz2C,EAAG6yB,SAAS6oB,EAAEo4D,WAAW9zG,EAAG,KAE5B+zG,EAAkBhmD,GAAGkX,eAAe5Y,MAAM3Q,EAAEo4D,YAC5CE,EAAoB,CAACxlG,EAAG,IAAKioC,EAAG,IAAKz2C,EAAG,KACxCi0G,EAAoBlmD,GAAGkX,eAAe/Z,UAAU8oD,GAEpD,MAAME,EAAYnmD,GAAG1+D,GAAG,IAClB8kH,GAAQ,IAAIC,WAAYC,gBAAgB,wkBAAykB,iBAAiB/5C,gBACloBg6C,EAAWH,EAAcI,eAAe,YAC9CxmD,GAAG2uC,cAAc4X,EAAS,CACtB,aAAc,SAElBvmD,GAAGgJ,IAAIo9C,EAAO,CACVrgE,MAAOA,EAAQ,KACfC,OAAQ6/D,EAAW,OAEvBM,EAAUtzH,YAAYuzH,GAEtB,MAAMK,EAAOp0H,SAASC,cAAc,OACpC0tE,GAAGgJ,IAAIy9C,EAAM,CACTjhG,SAAU,WACVwgC,OAAQA,EAAS,OAErB,MAAM0gE,EAAar0H,SAASC,cAAc,OACpCq0H,EAAWt0H,SAASC,cAAc,gBAI/Bs0H,EAAiBC,GAElBb,EADU,IAAVa,EAAIx9D,EACc,IAAI2W,GAAGwY,IAAIwtC,EAAgBlgE,EAAG+gE,EAAIx9D,EAAGw9D,EAAI70G,GAEzC,IAAIguD,GAAGwY,IAAIquC,EAAI/gE,EAAG+gE,EAAIx9D,EAAGw9D,EAAI70G,YAuC9C80G,IACL,MAAM7P,EAAMj3C,GAAGkX,eAAe9Y,MAAM,IAAI4B,GAAGwY,IAAIwtC,EAAgBlgE,EAAG,IAAK,MACvEka,GAAG2uC,cAAc4X,EAAS,CACtB,aAAc,IAAMvmD,GAAGkX,eAAe1Y,YAAYy4C,cAIjD/9B,IAEL,MAAMnqE,EAAOi3G,EAAgB38D,EAAI,IAAMtD,EAAQ,EACzCyB,GAAO,EAAIw+D,EAAgBh0G,EAAI,KAAO6zG,EAAW,EACvD7lD,GAAGgJ,IAAIgQ,EAAW,CACdjqE,KAAMA,EAAO,KACby4C,IAAKA,EAAM,gBAIVu/D,IACLL,EAAW78G,MAAMgqE,gBAAkB,OAASiyC,EAAgBrlG,EAAI,IAAMqlG,EAAgBp9D,EAAI,IAAMo9D,EAAgB7zG,EAAI,IAEhH+tD,GAAGslB,wBAAwBwgC,IAC3B9lD,GAAGgJ,IAAIg+C,EAAc,CACjBxyF,OAAQ,cAEZwrC,GAAGgJ,IAAIi+C,EAAW,CACdzyF,OAAQ,gBAGZwrC,GAAGgJ,IAAIg+C,EAAc,CACjBxyF,OAAQ,KAEZwrC,GAAGgJ,IAAIi+C,EAAW,CACdzyF,OAAQ,MAMpBsyF,IACAzzG,EAAIxJ,MAAMk8C,MAAQA,EAAQ,KAC1B1yC,EAAIiiE,cAAgB,WAChB,OAAO,GAGX,MAAM4xC,EAAc70H,SAASC,cAAc,OAC3C0tE,GAAGgJ,IAAIk+C,EAAa,CAChBnhE,MAAOA,EAAQ,KACfC,OAAQ6/D,EAAS,EAAI,KACrB/4C,SAAU,SACVhjE,QAAS,QACT0b,SAAU,WACVysD,OAAQ,YACRrE,UAAW,iCAGf,MAAMoL,EAAY3mF,SAASC,cAAc,OACzC0tE,GAAGgJ,IAAIgQ,EAAW,CACdjzB,MAAO,OACPC,OAAQ,OACRqqB,aAAc,MACd7qD,SAAU,WACViwD,cAAe,OACf7H,UAAW,iDAGfs5C,EAAYr0H,YAAYszH,GACxBe,EAAYr0H,YAAYmmF,GACxBE,IACA7lE,EAAIxgB,YAAYq0H,GAChB7zG,EAAIxgB,YAAY4zH,GAChBb,EAAU/yH,YAAY6zH,GACtB1mD,GAAGgJ,IAAI09C,EAAY,CACf58G,QAAS,OACTqjE,eAAgB,gBAChBpnB,MAAiB,IAATC,EAAgB,KACxBA,OAAQA,EAAS,KAEjB4nB,UAAW,+BACXwE,YAAa,eAGjBpS,GAAGgJ,IAAIy9C,EAAM,CACT35C,SAAU,SACVtnD,SAAU,WACVugC,MAAOA,EAAQ,KACfC,OAAQA,EAAO,EAAI,KACnBisB,OAAQ,YACRrE,UAAW,+BACXiB,UAAW,MACXd,aAAc,QAIlB/N,GAAGgJ,IAAI29C,EAAU,CACb5gE,MAAO,MACPC,OAAQA,EAAO,EAAI,KACnB2nB,WAAY,OACZyL,WAAY,iBACZ5zD,SAAU,WACVgiC,IAAK,IACLz4C,KAAM+1B,SAAS,IAAMkhF,EAAgBlgE,EAAI,IAAMC,EAAQ,IAAM,OAIjE,MAAMuzB,EAAa,CACfxzB,EAAG,EACHuD,EAAG,EACHr3C,EAAG,GAEP,IAAIwnE,EACAG,EAGJ,MAAMqtC,EAAehnD,GAAG1+D,GAAG,CACvBqhE,MAAO+J,GAAK,cAAgB,SAC5BzD,UAAW,8BACXD,IAAK,CACDjjB,MAAO,OACPC,OAAQ,OACR0sB,gBAAiB,OAAS7G,EAAAoM,IAAgB,IAC1CvE,iBAAmB,YACnBD,eAAgB,MAChBmc,mBAAoB,YAG5B,IAAIu3B,GAAY,EAGhBH,EAAax4C,QAAU,YACD,IAAd24C,GACAnnD,GAAGyR,gBAAgBu1C,EAAc,qCACjChnD,GAAGkO,aAAa84C,EAAc,sCAC9BG,GAAY,EACZxB,GAAa,KAEbA,GAAa,GACbnqD,EAAM4rD,gBAGsB,IAAIpnD,GAAGsW,gBAAgB,CACvDj0E,OAAQ2kH,EACR94D,aAAc,SAASqF,GACf4zD,IAGA5zD,EACAyM,GAAGkO,aAAa84C,EAAc,qCAE9BhnD,GAAGyR,gBAAgBu1C,EAAc,yCAI7CN,EAAW7zH,YAAYm0H,GAGvB,MAAMC,EAAYjnD,GAAG1+D,GAAG,CACpB0H,QAAS,IACTigE,UAAW,8BACXtG,MAAO+J,GAAK,sBACZ1D,IAAK,CACDhjB,OAAQ,OACRD,MAAOC,EAAS,KAChB0nB,WAAY1nB,EAAS,KACrBksB,SAAoB,IAATlsB,EAAiB,MAEhCkjB,QAAS,WACL2N,GAAe,CACXG,MAAO,IAAIhX,GAAG+W,IAAI+uC,EAAgBrlG,EAAGqlG,EAAgBp9D,EAAGo9D,EAAgB7zG,GACxEi+D,QAAS,SAASrR,GACTA,IAGLrD,EAAMqe,SAAShb,GACf00C,EAAU,IAAIvzC,GAAG+W,IAAI+uC,EAAgBrlG,EAAGqlG,EAAgBp9D,EAAGo9D,EAAgB7zG,WAK1D,IAAI+tD,GAAGsW,gBAAgB,CACpDj0E,OAAQ4kH,EACR/4D,aAAc,SAASqF,GACfA,EACAyM,GAAGkO,aAAa+4C,EAAW,qCAE3BjnD,GAAGyR,gBAAgBw1C,EAAW,wCAI1CP,EAAW7zH,YAAYo0H,GAEvBF,IAGAhtG,YAAW,qBApOUstG,GACjB,MAAM/mD,EAAK,IAAI2c,MACfjd,GAAGgJ,IAAI1I,EAAI,CACP96C,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACL19C,QAAS,OACT2rE,cAAe,SAEnB,MAAM6xC,EAAKtnD,GAAGlZ,OAAOf,EAAOC,GACtBsT,EAAMguD,EAAGvgE,WAAW,MACpB+xB,EAAQxf,EAAIgf,qBAAqB,EAAG,EAAGvyB,EAAO,GACpD,IAAK,IAAI/1D,EAAI,EAAGA,EAAI,EAAGA,GAAK,IAAM,CAC9B,MAAM+oF,EAAM/Y,GAAGkX,eAAe9Y,MAAM,IAAI4B,GAAGwY,IAAQ,IAAJxoF,EAAS,IAAK,MAC7D,IAAIyuE,EAAM35B,SAAS,GAAKi0C,EAAIt4D,GAAIpqB,SAAS,IACrCqoE,EAAM55B,SAAS,GAAKi0C,EAAIrwB,GAAIryD,SAAS,IACrCsoE,EAAM75B,SAAS,GAAKi0C,EAAI9mE,GAAI5b,SAAS,IACvB,IAAdooE,EAAGxuE,SACHwuE,EAAK,IAAMA,GACG,IAAdC,EAAGzuE,SACHyuE,EAAK,IAAMA,GACG,IAAdC,EAAG1uE,SACH0uE,EAAK,IAAMA,GACfma,EAAMJ,aAAa1oF,EAAG,IAAMyuE,EAAKC,EAAKC,GAE1CrF,EAAIC,UAAYuf,EAChBxf,EAAIE,SAAS,EAAG,EAAGzT,EAAOC,GAE1BqhE,EAASx0H,YAAYytE,GACrBA,EAAGxX,IAAM,MACTwX,EAAGv2D,IAAMu9G,EAAG3tD,UAAU,aACtB2G,EAAGz2D,MAAMC,QAAU,QAsMnBy9G,CAAYd,GACZA,EAAK5zH,YAAY8zH,GACjBntC,EAAoB,IAAIxZ,GAAGsW,gBAAgB,CACvCj0E,OAAQ8jH,EACRh4D,YAAa,EACb+E,aAAa,EACbpF,UAAW,SAAS70C,GAwBhB,GAvBmB,gBAAfA,EAAMzmB,OACNwtE,GAAGgJ,IAAIk+C,EAAa,CAChBt5C,UAAW,mCACXL,OAAQ,MAGS,SAAjBt0D,EAAMg3C,QAENqpB,EAAWjwB,EAAIpwC,EAAMy1C,KAAO3I,EAAQ,IACpCuzB,EAAWtnE,EAAI,IAAMiH,EAAM01C,KAAOk3D,EAAW,IAE7CG,EAAkB,IAAIhmD,GAAGwY,IAAIwtC,EAAgBlgE,EAAGwzB,EAAWjwB,EAAGiwB,EAAWtnE,GACzE8zG,EAAkB9lD,GAAGkX,eAAe9Y,MAAM4nD,GAE1C9sC,IACA6tC,IACAxT,EAAUvzC,GAAGkX,eAAe9Y,MAAM4nD,MAElC1sC,EAAWjwB,EAAI28D,EAAgB38D,EAC/BiwB,EAAWtnE,EAAIg0G,EAAgBh0G,IAIpB,gBAAfiH,EAAMzmB,MAA0B,CAAC,OAAQ,SAASgP,SAASyX,EAAMg3C,QAAS,CAE1E,IAAIwpB,EAAS,EACQ,UAAjBxgE,EAAMg3C,SACNwpB,EAAS,IAGbH,EAAWjwB,GAAKpwC,EAAMm4C,GAAKrL,EAAQ,IAAM0zB,EACzCH,EAAWtnE,GAAKiH,EAAMo4C,GAAKw0D,EAAW,IAAMpsC,EAE5CusC,EAAkB,IAAIhmD,GAAGwY,IAAIwtC,EAAgBlgE,EAAGwzB,EAAWjwB,EAAGiwB,EAAWtnE,GACzE8zG,EAAkB9lD,GAAGkX,eAAe9Y,MAAM4nD,GAC1C9sC,IACA6tC,IACAxT,EAAUvzC,GAAGkX,eAAe9Y,MAAM4nD,IAInB,cAAf/sG,EAAMzmB,MACNwtE,GAAGgJ,IAAIk+C,EAAa,CAChBt5C,UAAW,+BACXL,OAAQ,SAMxBoM,EAAmB,IAAI3Z,GAAGsW,gBAAgB,CACtCj0E,OAAQokH,EACRt4D,YAAa,EACb+E,aAAa,EACbpF,UAAW,SAAS70C,GAsBhB,GApBmB,gBAAfA,EAAMzmB,OACNwtE,GAAGgJ,IAAIy9C,EAAM,CACT74C,UAAW,wCAGM,SAAjB30D,EAAMg3C,QAENqpB,EAAWxzB,EAAI7sC,EAAMy1C,KAAO3I,EAAQ,OAEpCigE,EAAkB,IAAIhmD,GAAGwY,IAAIc,EAAWxzB,EAAGkgE,EAAgB38D,EAAG28D,EAAgBh0G,GAC9E8zG,EAAkB9lD,GAAGkX,eAAe9Y,MAAM4nD,GAC1CW,EAAS98G,MAAMkF,KAAQnd,KAAK4jC,MAAMwwF,EAAgBlgE,EAAI,OAASC,GAAS,EAAK,KAC7E+gE,IACAC,IACAxT,EAAUvzC,GAAGkX,eAAe9Y,MAAM4nD,KAElC1sC,EAAWxzB,EAAIkgE,EAAgBlgE,GAIpB,gBAAf7sC,EAAMzmB,MAA0B,CAAC,OAAQ,SAASgP,SAASyX,EAAMg3C,QAAS,CAE1E,MAAMrD,EAASh7D,KAAKghB,IAAIqG,EAAM6zC,MAAQ7zC,EAAM25C,WACtC6mB,EAASxF,GAAwBrnB,EAAyB,UAAjB3zC,EAAMg3C,QAErDqpB,EAAWxzB,GAAK7sC,EAAMm4C,GAAKrL,EAAQ,OAAS0zB,EAEvB,UAAjBxgE,EAAMg3C,SACNqpB,EAAWxzB,EAAIwzB,EAAWxzB,EAAI,OAC1BwzB,EAAWxzB,EAAI,IACfwzB,EAAWxzB,GAAK,SAGxBwzB,EAAWxzB,EAAIl0D,KAAK+O,IAAI,OAAQ24E,EAAWxzB,GAC3CkgE,EAAkB,IAAIhmD,GAAGwY,IAAIc,EAAWxzB,EAAGkgE,EAAgB38D,EAAG28D,EAAgBh0G,GAC9E8zG,EAAkB9lD,GAAGkX,eAAe9Y,MAAM4nD,GAC1CW,EAAS98G,MAAMkF,KAAQnd,KAAK4jC,MAAMwwF,EAAgBlgE,EAAI,OAASC,GAAS,EAAK,KAC7E+gE,IACAC,IACAxT,EAAUvzC,GAAGkX,eAAe9Y,MAAM4nD,IAInB,cAAf/sG,EAAMzmB,MACNwtE,GAAGgJ,IAAIy9C,EAAM,CACT74C,UAAW,sCAK5B,GAKH,MAAM45C,EAAoBxnD,GAAG1+D,GAAG,CAC5Bga,OAAQsqG,EACRjjD,MAAO+J,GAAK,mBAAqB,OACjC1D,IAAK,CACDiJ,OAAQ,UACRnD,WAAY,MACZ/oB,MAAO,OACPC,OAAQ,OACR4nB,UAAW,qCACXwE,YAAa,cAEjBlJ,QAAS,SAASv2E,GACdA,EAAEk4D,iBACF48D,gBAGCC,IACLF,EAAkB39G,MAAMgqE,gBAAkB7T,GAAGkX,eAAetY,SAASqnD,YAEhEwB,IAEL,IAAIt/C,EAAW+9C,EACfA,EAAoBF,EACpBY,EAAiBz+C,GAEjBA,EAAM89C,EACNA,EAAoBH,EACpBA,EAAkB39C,EAElBw+C,EAAS98G,MAAMkF,KAAO+1B,SAAS,IAAMkhF,EAAgBlgE,EAAI,IAAMC,EAAQ,IAAM,KAC7E+gE,IACA5tC,IACA6tC,IACAW,IAEAnU,EAAU,IAAIvzC,GAAG+W,IAAI+uC,EAAgBrlG,EAAGqlG,EAAgBp9D,EAAGo9D,EAAgB7zG,IAE/Ey1G,IAMAzzH,KAAK4lF,SAAW,SAAUxrD,GACtBy3F,EAAkB,CAACrlG,EAAGqkB,SAASzW,EAAE5N,EAAG,IAAKioC,EAAG5jB,SAASzW,EAAEq6B,EAAG,IAAKz2C,EAAG6yB,SAASzW,EAAEpc,EAAG,KAChF20G,EAAiB5mD,GAAGkX,eAAe5Y,MAAMjwC,IACzCs4F,EAAS98G,MAAMkF,KAAO+1B,SAAS,IAAMkhF,EAAgBlgE,EAAI,IAAMC,EAAQ,IAAM,KAC7E+gE,IACA5tC,IACA6tC,KAGJ9yH,KAAK6lF,SAAW,WACZ,OAAO,IAAI9Z,GAAG+W,IAAI+uC,EAAgBrlG,EAAGqlG,EAAgBp9D,EAAGo9D,EAAgB7zG,IAG5Ehe,KAAK0zH,gBAAkB,WACnB,OAAO,IAAI3nD,GAAG+W,IAAIkvC,EAAkBxlG,EAAGwlG,EAAkBv9D,EAAGu9D,EAAkBh0G,IAGlFhe,KAAK2zH,gBAAkB,SAAUpuH,GAC7BmsH,EAAensH,GAGnBvF,KAAKmzH,YAAc,WACVD,IAGLA,GAAY,EACZnnD,GAAGyR,gBAAgBu1C,EAAc,wCAGrC/yH,KAAKimC,OAAS,SAAUvnC,GAChBA,GACA0gB,EAAIxJ,MAAM4rE,cAAgB,GAC1BpiE,EAAIxJ,MAAMiqE,QAAU,IACpB8xC,EAAU/7G,MAAM4rE,cAAgB,GAChCmwC,EAAU/7G,MAAMiqE,QAAU,MAE1BzgE,EAAIxJ,MAAM4rE,cAAgB,OAC1BpiE,EAAIxJ,MAAMiqE,QAAU,MACpB8xC,EAAU/7G,MAAM4rE,cAAgB,OAChCmwC,EAAU/7G,MAAMiqE,QAAU,QAIlC7/E,KAAK4zH,UAAY,SAAU/hE,IACvBA,EAAIhhB,SAAS,IAAKghB,EAAa,EAATE,EAAa,GAAI,OAC7B6/D,IAGVA,EAAW//D,EACXka,GAAGgJ,IAAIo9C,EAAO,CACVrgE,MAAOA,EAAQ,KACfC,OAAQ6/D,EAAW,OAEvBqB,EAAYr9G,MAAMm8C,OAAS6/D,EAAW,KACtC3sC,MAGJjlF,KAAKwzH,WAAa,WACdA,KAGJxzH,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAK6zH,iBAAmB,WACpB,OAAOlC,uB4GzZX1tC,eACA6B,gBACAc,WACAY,aACA4xB,uBI3GQ0a,gBACC9zH,KAAKqN,KAGVyY,YAAU,QAAS,KACE,SAAjB9lB,KAAK+zH,QACL/zH,KAAKqN,GAAGuI,MAAMkF,KAAO,QAErB9a,KAAKqN,GAAGuI,MAAM00E,eAAe,SAI7BjnD,OACJrjC,KAAKqN,GAAK0+D,GAAG1+D,GAAG,CACZ2nE,UAAW,qBACXC,QAASlJ,GAAGyO,cAGZx6E,KAAKg0H,SACLh0H,KAAKqN,GAAGuI,MAAMk8C,MAAQ,QAG1B9xD,KAAK8zH,gBAEL9zH,KAAKo9E,QAAUrR,GAAG1+D,GAAG,CACjB2nE,UAAW,sBAIfh1E,KAAKi0H,QAAU,IAAIjrC,MACnBhpF,KAAKi0H,QAAQn+G,IAAM8hE,EAAAqQ,IACnBlc,GAAGgJ,IAAI/0E,KAAKi0H,QAAS,CACjBC,cAAe,SACfpiE,MAAO,OACPC,OAAQ,OACR8oB,WAAY,MACZuB,aAAc,SAGlBp8E,KAAKm0H,aAAe/1H,SAASC,cAAc,OAC3C2B,KAAKm0H,aAAav+G,MAAMC,QAAU,eAElC7V,KAAKo9E,QAAQx+E,YAAYoB,KAAKm0H,cAC9Bn0H,KAAKo9E,QAAQx+E,YAAYoB,KAAKi0H,SAC9Bj0H,KAAKqN,GAAGzO,YAAYoB,KAAKo9E,SACzBh/E,SAAS0oD,KAAKloD,YAAYoB,KAAKqN,IAC/BrN,KAAKqN,GAAGuI,MAAMC,QAAU,OAU5Bu+G,QAAQp2G,GACJhe,KAAKg0H,SAAWh2G,EAEXhe,KAAKqN,KAINrN,KAAKg0H,QACLh0H,KAAKqN,GAAGuI,MAAMk8C,MAAQ,OACtB9xD,KAAKqN,GAAGuI,MAAMkF,KAAO,KAErB9a,KAAKqN,GAAGuI,MAAM00E,eAAe,SAC7BtqF,KAAKqN,GAAGuI,MAAMkF,KAAwB,SAAjB9a,KAAK+zH,QAAqB,QAAU,KAIjEM,WAAWpqH,GACPjK,KAAK+zH,QAAU9pH,EACfjK,KAAK8zH,gBAGTQ,IAAI1oD,EAAoE2oD,GAEhE3oD,GAAsB,iBAARA,EAEG,cAAbA,EAAIrtE,MACJyB,KAAKi0H,QAAQr+G,MAAMC,QAAU,eAC7B7V,KAAKi0H,QAAQr+G,MAAM67D,UAAY,UAAY7F,EAAIgG,SAAW,OAEtDhG,EAAIgG,SAAW,IAAO,EACtB5xE,KAAKi0H,QAAQr+G,MAAM+jE,UAAY,2CAE/B35E,KAAKi0H,QAAQr+G,MAAM+jE,UAAY,GAGnC35E,KAAKm0H,aAAa1/C,UAAY92E,KAAK4jC,MAAkB,IAAZqqC,EAAIr+B,OAAe,KAI5DvtC,KAAKi0H,QAAQr+G,MAAMC,QAAU,OAKX,iBAAR+1D,IACd5rE,KAAKi0H,QAAQr+G,MAAMC,QAAU,OAC7B7V,KAAKm0H,aAAa1/C,UAAY7I,GAG9B2oD,IACAv0H,KAAKo9E,QAAQxnE,MAAM4+G,UAAY,GAC/B1uG,YAAU,IACA9lB,KAAKo9E,QAAQxnE,MAAM4+G,UAAY,mCACrC,IAEAx0H,KAAKy0H,UACLx7D,aAAaj5D,KAAKy0H,UAEtBz0H,KAAKy0H,SAAW30H,OAAOgmB,YAAU,IACvB9lB,KAAKo9E,QAAQxnE,MAAM4+G,UAAY,IACrC,MAMJx0H,KAAK4kE,SACL3L,aAAaj5D,KAAK4kE,SAElB5kE,KAAK00H,UACLz7D,aAAaj5D,KAAK00H,UAEtB10H,KAAKqN,GAAGuI,MAAMgmE,cAAgB24C,EAAU,gBAAkB,YAC1Dv0H,KAAKqN,GAAGuI,MAAMiqE,QAAU,IACxB7/E,KAAK4kE,QAAU9kE,OAAOgmB,YAAU,KAC5B9lB,KAAKqN,GAAGuI,MAAMiqE,QAAU,IACxB7/E,KAAKqN,GAAGuI,MAAMgmE,cAAgB,aAC9B57E,KAAK00H,SAAW50H,OAAOgmB,YAAU,KAC7B9lB,KAAKqN,GAAGuI,MAAMC,QAAU,OACxB7V,KAAK00H,SAAW,IACjB,KACH10H,KAAK4kE,QAAU,IAChB,MACH5kE,KAAKqN,GAAGuI,MAAMC,QAAU,qBAtFxB7V,KAAKqjC,kBJ0DT6kD,iBACA4K,uBACAgE,WACAoB,yBKpHyBx+B,GASzB,IACIi7D,EADAv1G,EAAM2sD,GAAG1+D,GAAG,IAEZ2jF,GAAY,EAChB,MAEM4jC,EAAkB,IACxB,IAUIC,EAVAC,GAAiB,EACjBC,EAAgB,CAChBjjE,MAAO,EACPC,OAAQ,GAERijE,EAAkBjpD,GAAGlZ,SACrBoiE,EAAqBD,EAAgBliE,WAAW,MAEhDoiE,EAAiB,EACjBC,GAAuB,EAGvBpB,EAAU,QAIVqB,EAAmBrpD,GAAG1+D,GAAG,CACzB0nE,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZpnB,OAAQA,OACRgxB,MAAO,UAGXsyC,EAAkBtpD,GAAG1+D,GAAG,CACxB0nE,IAAK,CAEDugD,SAAUvjE,OACVA,OAAQA,OACRl8C,QAAS,OACTqjE,eAAgB,SAChBC,WAAY,YAGhBtmB,EAASkZ,GAAGlZ,OApCGd,GAAAA,IAqCfoiB,EAAYthB,EAAOC,WAAW,MAClCD,EAAO6b,MAAQ+J,GAAK,uBACpB1M,GAAGgJ,IAAIliB,EAAQ,CACX8mB,UAAW,oBACXwE,YAAa,eAEjB,IAAIo3C,EAAcxpD,GAAG1+D,GAAG,CACpB0nE,IAAK,CAEDomB,SAAU,IACVve,YAAa,OACbqB,SAAU,OACVpF,SAAU,SACVtnD,SAAU,cAGdikG,EAAczpD,GAAG1+D,GAAG,CACpB0H,QAAS,GACTggE,IAAK,CACDwK,SAAU,OACVyP,WAAY,YAGhBymC,EAAa1pD,GAAG1+D,GAAG,CACnB0nE,IAAK,CACD0J,gBAAiB,gFACjBltD,SAAU,WACVxW,MAAO,IACPw4C,IAAK,IACLzB,MAAO,OACPC,OAAQ,UAGZ2jE,EAAc3pD,GAAG1+D,GAAG,CACpB0nE,IAAK,CAEDxjD,SAAU,WACVzW,KAAM,OACNy4C,IAAK,IACLzB,MAAO,OACPC,OAAQ,UAGZ2H,EAAEub,UACFlJ,GAAGpmD,iBAAiB+vG,EAAY,SAAS,WACrCh8D,EAAEub,aAENlJ,GAAGpmD,iBAAiBktC,EAAO,SAAS,WAChC6G,EAAEub,cAGV,IAAI0gD,EAAY5pD,GAAG1+D,GAAG,CAClB0H,QAAS0jE,GAAK,WAAa,WAC3B1D,IAAK,CACDugD,SAAU,OACVr3C,SAAU,OACVqJ,UAAW,SACX5N,WAAY,UACZqJ,MAAO,UAIf,MAAM6yC,EAAqB7pD,GAAG1+D,GAAG,CAC7B4nE,QAASlJ,GAAGyO,YACZzF,IAAK,CACDyM,cAAe,OACf9H,WAAY,OACZnoD,SAAU,WACVxW,MAAO,QACPw4C,IAAK,OACLusB,OAAQ,iBACRnG,UAAW,8BACX8M,WAAY,4BACZzF,WAAY,OACZnrE,QAAS,QACTggH,mBAAoB,OACpB13C,YAAa,gBAGrB,IAAI23C,EAAc/pD,GAAGlZ,OAAO+hE,EAAiBA,GAC7CgB,EAAmBrvE,OAAOuvE,GAC1B,IAAIC,EAAiBD,EAAYhjE,WAAW,MAC5CiZ,GAAGgJ,IAAI+gD,EAAa,CAChBjgH,QAAS,UAGbuJ,EAAIxgB,YAAYw2H,GAChBA,EAAiBx2H,YAAYy2H,GAC7BA,EAAgBz2H,YAAYi0D,GAC5BuiE,EAAiBx2H,YAAY22H,GAC7BA,EAAY32H,YAAY42H,GACxBD,EAAY32H,YAAY62H,GACxBF,EAAY32H,YAAY82H,GACxBN,EAAiBx2H,YAAY+2H,GAG7B,IAAIK,EAAgCf,EAAmB1iB,cAAcxmC,GAAG2vC,oBAAoB,GAAI,UAC5Fua,EAA4B9hD,EAAUo+B,cAAcxmC,GAAG2vC,oBAAoB,GAAI,mBAM1Ewa,IACkB,IAAnBhB,IAIJA,IAEA/gD,EAAUlC,OACVkC,EAAUiY,YAAczuF,KAAK67B,KA3IT,GA2IgC07F,GA3IhC,GA2ImE,GACvF/gD,EAAU3C,UAAUwjD,EAAiB,EAAG,GACxC7gD,EAAU7B,UAEN4iD,EAAiB,GACjBlM,sBAAsBkN,aAIrB7hB,EAAK5Q,GAEV,IAAKzS,EACD,OAGJwkC,EAAY/2H,YAAck2H,EAASntH,KACnCmuH,EAAUlhD,UAAYgE,GAAK,WAAa,OAAS96E,KAAK4jC,MAAyB,IAAnBozF,EAAS90C,SAAiB,IAEtF,IAAI0hC,EAAcoT,EAASpsB,QAAQ11C,OAEnC,GAAI0uD,EAAYzvD,QAAUijE,EAAcjjE,OAASyvD,EAAYxvD,SAAWgjE,EAAchjE,OAAQ,CAC1F,IAAIokE,EAAmBpqD,GAAGod,QAAQo4B,EAAYzvD,MAAOyvD,EAAYxvD,OAzKtDA,GAAAA,GAyKsF,GACjGc,EAAOf,MAAQn0D,KAAK4jC,MAAM40F,EAAiBrkE,OAC3Ce,EAAOd,OAASp0D,KAAK4jC,MAAM40F,EAAiBpkE,QAE5C0xC,GAAY,EAGhBuxB,EAAgBljE,MAAQe,EAAOf,MAC/BkjE,EAAgBjjE,OAASc,EAAOd,OAEhCkjE,EAAmBhjD,OACnBgjD,EAAmB/iD,uBAAwB,EAC3C+iD,EAAmB3vD,UAAY0wD,EAC/Bf,EAAmB1vD,SAAS,EAAG,EAAGyvD,EAAgBljE,MAAOkjE,EAAgBjjE,QACzEkjE,EAAmBzjD,UAAU+vC,EAAa,EAAG,EAAGyT,EAAgBljE,MAAOkjE,EAAgBjjE,QACvFkjE,EAAmB3iD,UAEfmxB,GACAyxB,EAAiB,EACjB/gD,EAAUlC,OACVkC,EAAU3C,UAAUwjD,EAAiB,EAAG,GACxC7gD,EAAU7B,YAGV4iD,EAxLgB,GAyLhBgB,KAIJE,IAEAtB,EAAiBj+C,GAAU1vB,WAC3B4tE,EAAcjjE,MAAQyvD,EAAYzvD,MAClCijE,EAAchjE,OAASwvD,EAAYxvD,gBAG9BtlB,IACL4nE,GAAK,YAuBA+hB,IAEL,IAAKjB,IAAyBR,EAC1B,OAGJ,IAAIpT,EAAcoT,EAASpsB,QAAQ11C,OAE/BsjE,EAAmBpqD,GAAGod,QAAQo4B,EAAYzvD,MAAOyvD,EAAYxvD,OAAQ6iE,EAAiBA,EAAiB,GAC3GkB,EAAYhkE,MAAQn0D,KAAK4jC,MAAM40F,EAAiBrkE,OAChDgkE,EAAY/jE,OAASp0D,KAAK4jC,MAAM40F,EAAiBpkE,QACjDgkE,EAAe9jD,OACX6jD,EAAYhkE,MAAQyvD,EAAYzvD,MAChCikE,EAAe7jD,uBAAwB,GAEvC6jD,EAAe7jD,uBAAwB,EACvC6jD,EAAe5jD,sBAAwB,QAE3C4jD,EAAezwD,UAAY2wD,EAC3BF,EAAexwD,SAAS,EAAG,EAAGuwD,EAAYhkE,MAAOgkE,EAAY/jE,QAC7DgkE,EAAevkD,UAAU+vC,EAAa,EAAG,EAAGuU,EAAYhkE,MAAOgkE,EAAY/jE,QAC3EgkE,EAAezjD,UAEf,MAAM/X,EAASn7C,EAAIo7C,wBACnBuR,GAAGgJ,IAAI6gD,EAAoB,CACvBriE,IAAK51D,KAAK6O,IAAI,GAAK+tD,EAAOhH,IAAMxB,GAAa+jE,EAAY/jE,OAAS,GAAM,gBAKvEskE,IACL,IACI38D,EAAEoiD,SAASj2F,YAAY+vG,GACzB,MAAMl3H,KArDZwmE,aAAY,WAER,IAAKyvD,EACD,OAGe99C,GAAU1vB,aACR2tE,IAKrBH,EAAS90C,QAAU80C,EAASpsB,QAAQ11C,OAAOgtB,QAE3Cw0B,GAAK,MAEN,KAmEmB,IAAItoC,GAAGsW,gBAAgB,CACzCj0E,OAAQykD,EACRoH,aAAc,SAASj8C,aA3BFA,GACjBm3G,IAAyBn3G,IAI7Bi7C,aAAa47D,GACbM,EAAuBn3G,EAEnBA,EACA62G,EAA8B/uG,YAAW,WACrCswG,IACAR,EAAmBhgH,MAAMiqE,QAAU,IACnCnmB,EAAEoiD,SAASl9G,YAAYg3H,GACvB9vG,YAAW,WACP8vG,EAAmBhgH,MAAMiqE,QAAU,MACpC,MACJ,MAGH+1C,EAAmBhgH,MAAMiqE,QAAU,IACnCg1C,EAA8B/uG,WAAWuwG,EAAmBC,OAQ5DC,CAAgBv4G,MAQxBhe,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAKw2H,aAAe,SAASx4G,GACzB,GAAIgzE,IAAchzE,EACd,OAEJgzE,EAAYhzE,EACZo3G,EAAiBx/G,MAAMC,QAAUm7E,EAAY,OAAS,OACtD5xE,EAAIxJ,MAAMkkE,aAAekX,EAAY,GAAK,OAE1C,IAAIylC,EAAe5/C,GAAU1vB,WACzBnpC,GAAK82G,IAAmB2B,GACxBhqF,KAKRzsC,KAAKivH,SAAW,SAASyH,GACrB/B,EAAW+B,EACXjqF,KAGJzsC,KAAKq0H,WAAa,SAASsC,GACvB5C,EAAU,GAAK4C,EAEC,SAAZ5C,EACAhoD,GAAGgJ,IAAI6gD,EAAoB,CACvB96G,KAAM,QACNC,MAAO,KAGXgxD,GAAGgJ,IAAI6gD,EAAoB,CACvB96G,KAAM,GACNC,MAAO,2CC7We67G,GAClC,IAAIC,EAAQ9qD,GAAG1+D,GAAG,CACd0H,QAAS0jE,GAAK,uBAAyB,OAASA,GAAK,wBAErDr5D,EAAM2sD,GAAG1+D,GAAG,CACZ0H,QAAS8hH,EACT7hD,UAAW,wBACXD,IAAK,CACD8K,QAAS,IACTtsB,IAAK,WAOTu0C,EAAMnqG,KAAK+O,IAAI,EAAGkqH,EAAkB,GACpCE,EAAO,CAAC,EAAE,EAAE,GACZC,EAAO,CAAC,GAAG,EAAE,GACbjyC,EAAM,CACNnnF,KAAK4jC,MAAMwqC,GAAG+7B,IAAIgvB,EAAK,GAAIC,EAAK,GAAIjvB,IACpCnqG,KAAK4jC,MAAMwqC,GAAG+7B,IAAIgvB,EAAK,GAAIC,EAAK,GAAIjvB,IACpCnqG,KAAK4jC,MAAMwqC,GAAG+7B,IAAIgvB,EAAK,GAAIC,EAAK,GAAIjvB,KAExC+uB,EAAMjhH,MAAM8jE,WAAa,QAAUoL,EAAI,GAAK,IAAMA,EAAI,GAAK,IAAMA,EAAI,GAAK,SAE1E1mF,SAAS0oD,KAAKloD,YAAYwgB,GAC1B0G,YAAW,WACP1G,EAAIxJ,MAAMiqE,QAAU,IACpBzgE,EAAIxJ,MAAM29C,IAAM,SACjB,IACHztC,YAAW,WACP1G,EAAIxJ,MAAMiqE,QAAU,MACrBm3C,MACHlxG,YAAW,WACP1nB,SAAS0oD,KAAKjhC,YAAYzG,KAC3B43G,4BC3BqBvxE,GACxB,IAAIqyC,EAAM/rB,GAAGod,QAAQ1jC,EAAOi5B,MAAM5sB,MAAOrM,EAAOi5B,MAAM3sB,OAAQtM,EAAOqM,MAAOrM,EAAOsM,OAAQ,GACvFH,EAAI/gB,SAAS,GAAKinD,EAAIhmC,OACtBD,EAAIhhB,SAAS,GAAKinD,EAAI/lC,QAEtBc,EAASkZ,GAAGlZ,OAAOjB,EAAGC,GAE1BgB,EAAOC,WAAW,MAAM0e,UAAU/rB,EAAOi5B,MAAO,EAAG,EAAG9sB,EAAGC,GACzDka,GAAGgJ,IAAIliB,EAAQ,CACXh9C,QAAS,QACT8jE,UAAW,mBAGf35E,KAAKk9E,WAAa,WACd,OAAOrqB,4BCrBgB6G,GAG3B,IAAIof,EAAS/M,GAAG1+D,GAAG,CACf0H,QAAS,iBACTggE,IAAK,CACDkiD,WAAY,QACZ1lG,SAAU,QACVzW,KAAM,IACNy4C,IAAK,IACLzB,MAAO,OACPC,OAAQ,OACR2nB,WAAY,wBACZqJ,MAAO,OACPm0C,WAAY,eACZ5vC,UAAW,SACXrJ,SAAU,UAGdwJ,EAAY1b,GAAG1+D,GAAG,CAClB0nE,IAAK,CACD6F,UAAa,OACb/kE,QAAW,OACXqjE,eAAkB,YAGtBi+C,EAAc,CACdrlE,MAAO,QACPosB,QAAS,OACTmI,OAAQ,OAERjK,aAAc,OACd0D,OAAQ,kBACRpG,WAAY,UACZiV,WAAY,QAEZyoC,EAAgBrrD,GAAG1+D,GAAG,CACtB0H,QAAS,WACTggE,IAAKoiD,IAELE,EAAgBtrD,GAAG1+D,GAAG,CACtB0H,QAAS,eACTggE,IAAKoiD,IAGTr+C,EAAOl6E,YAAY6oF,GACnBA,EAAU7oF,YAAYw4H,GACtB3vC,EAAU7oF,YAAYy4H,GAGtB,IAAIC,EAAc,EACdC,EAAqB,EACrBC,EAAqB,WAEhBj4D,IACL+3D,EAAc,EACdC,EAAqB,EACrBC,EAAqB,EACrB,IACI99D,EAAEtrD,OAAOyX,YAAYizD,GACvB,MAAOp6E,cAGJ+4H,EAAezyG,GACpB,IACI,OAAQA,EAAM0yG,aAAaC,MAAMpqH,SAAS,cAC5C,MAAM7O,IAGR,OAAO,WAGFk5H,IACL,IAAIj+C,EAAY,oBACZ49C,EAAqB,GACrBH,EAAcxhH,MAAM+jE,UAAYA,EAChC09C,EAAczhH,MAAM+jE,UAAY,IACzB69C,EAAqB,GAC5BJ,EAAcxhH,MAAM+jE,UAAY,GAChC09C,EAAczhH,MAAM+jE,UAAYA,IAEhCy9C,EAAcxhH,MAAM+jE,UAAY,GAChC09C,EAAczhH,MAAM+jE,UAAY,IAIxC5N,GAAGpmD,iBAAiByxG,EAAc,aAAa,WAC3CG,IACAK,OAEJ7rD,GAAGpmD,iBAAiByxG,EAAc,aAAa,WAC3CG,IACAK,OAEJ7rD,GAAGpmD,iBAAiB0xG,EAAc,aAAa,WAC3CG,IACAI,OAEJ7rD,GAAGpmD,iBAAiB0xG,EAAc,aAAa,WAC3CG,IACAI,OA0DJ7rD,GAAGpmD,iBAAiB7lB,OAAO,qBAtDLklB,GACbyyG,EAAezyG,KAGpBA,EAAM6xC,kBACN7xC,EAAM4xC,qBAiD2C,GACrDmV,GAAGpmD,iBAAiB7lB,OAAO,sBAhDJklB,GACd00C,EAAEm+D,eAAkBJ,EAAezyG,KAGpB,IAAhBsyG,GACA59D,EAAEtrD,OAAOxP,YAAYk6E,GAEzBw+C,QAyCmD,GACvDvrD,GAAGpmD,iBAAiB7lB,OAAO,sBAvCJklB,GACdyyG,EAAezyG,IAA0B,IAAhBsyG,IAG9BA,EAAc35H,KAAK6O,IAAI,EAAG8qH,EAAc,GACpB,IAAhBA,GACA59D,EAAEtrD,OAAOyX,YAAYizD,OAiC0B,GACvD/M,GAAGpmD,iBAAiB7lB,OAAO,iBA9BTklB,GACd,IAAKyyG,EAAezyG,IAA8C,IAApCA,EAAM0yG,aAAa/oD,MAAM3yE,OAEnD,YADAujE,IAGJv6C,EAAM6xC,kBACN7xC,EAAM4xC,iBAEN,IAAIkhE,EAAY,UACZP,EAAqB,EACrBO,EAAY,QACLN,EAAqB,IAC5BM,EAAY,SAGhBp+D,EAAEq+D,OAAO/yG,EAAM0yG,aAAa/oD,MAAOmpD,GAG/BR,EAAc,GACd59D,EAAEtrD,OAAOyX,YAAYizD,GAEzBw+C,EAAc,EACdC,EAAqB,EACrBC,EAAqB,EACrBI,OAMyC,GAG7C7rD,GAAGpmD,iBAAiBmzD,EAAQ,eAAe,WACvCvZ,OAEc,IAAIwM,GAAGmO,YAAY,CACjCrE,OAAQ,SAAS3hB,GACTojE,EAAc,GAAgB,QAAXpjE,GACnBqL,kCCrKZ7F,GAMA,MAAMs+D,EACK,IADLA,EAEQ,GAFRA,EAGO,GAHPA,EAIY,GAGlB,IAAIhnC,GAAY,EAChB,MAAM5xE,EAAM2sD,GAAG1+D,GAAG,CACd0nE,IAAK,CACDxjD,SAAU,WACVzW,KAAM,QACNy4C,IAAK,QACLmmB,WAAY,qBACZ7jE,QAAS,OACTiqE,OAAQ,iBACRnG,UAAW,2BACXwE,YAAa,gBAGf85C,EAAY,CACdl1C,MAAO,KACPvxD,KAAM,KACNquD,QAAS,MAOPq4C,EAAc,IAAIj0C,GAAmB,CACvCnyB,MAAOkmE,EACPtzC,SAAUszC,EACVpzC,QAASozC,EACTj1C,MAAOrpB,EAAEy+D,oBAAoBtyC,WAC7Bn5C,SAAU,SAAUk+B,GAChBwtD,EAAgBxiH,MAAMgqE,gBAAkB,OAAShV,EAAOp+C,EAAI,IAAMo+C,EAAOnW,EAAI,IAAMmW,EAAO5sD,EAAI,IAC9F07C,EAAEy+D,oBAAoBvyC,SAAShb,EAAQytD,MAGzCD,EAAkBrsD,GAAG1+D,GAAG,CAC1B0nE,IAAK,CACDjjB,MAAOkmE,EAAgB,KACvBjmE,OAAQimE,EAAkB,KAC1Bx2C,cAAe,UAGvB,CACI,MAAM82C,EAAe5+D,EAAEy+D,oBAAoBtyC,WAC3CuyC,EAAgBxiH,MAAMgqE,gBAAkB,OAAS04C,EAAa9rG,EAAI,IAAM8rG,EAAa7jE,EAAI,IAAM6jE,EAAat6G,EAAI,aAO3Gu6G,EAAY3tD,GACjBstD,EAAYtyC,SAAShb,GACrBwtD,EAAgBxiH,MAAMgqE,gBAAkB,OAAShV,EAAOp+C,EAAI,IAAMo+C,EAAOnW,EAAI,IAAMmW,EAAO5sD,EAAI,IANlGoB,EAAIxgB,YAAYw5H,GAChBh5G,EAAIxgB,YAAYs5H,EAAYh7C,cAc5B,MAAMs5B,EAAa,IAAIt2B,GAAS,CAC5Bp9B,MAAO21B,GAAK,cACZ3mB,MAAOkmE,EACPjmE,OAAQimE,EACRtrH,IAAK,EACLF,IAAK,IACL8xE,UAAW,GACX5V,WAAY,IACZiY,WAAY,IAAO,GACnBzL,SAAU,SAASn3D,GACf27C,EAAEy+D,oBAAoBznC,QAAQ3yE,IAElC2iE,WAAY,SAAS3iE,GACjB,OAAQ,EAAJA,EAAQ,GACDpgB,KAAK4jC,MAAM,GAAAxjB,GAAc,GAE7BpgB,KAAK4jC,MAAU,EAAJxjB,MAG1BguD,GAAGgJ,IAAIyhC,EAAWt5B,aAAc,CAC5BtC,UAAW,QAEfx7D,EAAIxgB,YAAY43G,EAAWt5B,cAE3B,MAAMu5B,EAAgB,IAAIv2B,GAAS,CAC/Bp9B,MAAO21B,GAAK,WACZ3mB,MAAOkmE,EACPjmE,OAAQimE,EACRtrH,IAAK,EACLF,IAAK,EACL8xE,UAAW,EACX5V,WAAY,IACZiY,WAAY,IAAO,GACnBzL,SAAU,SAASn3D,GACf27C,EAAEy+D,oBAAoBvsB,WAAW7tF,IAErC2iE,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAG1BguD,GAAGgJ,IAAI0hC,EAAcv5B,aAAc,CAC/BmJ,OAAQ,UAEZjnE,EAAIxgB,YAAY63G,EAAcv5B,cAM9B,MAAMm7C,EAAmB,SAASrzG,GACX,UAAfA,EAAMzmB,OACDyyF,EAGDunC,EAAYvzG,EAAMvoB,OAFlBw7H,EAAUl1C,MAAQ/9D,EAAMvoB,OAKb,SAAfuoB,EAAMzmB,OACDyyF,EAGDwlB,EAAW74B,SAAS34D,EAAMvoB,OAF1Bw7H,EAAUzmG,KAAOxM,EAAMvoB,OAKZ,YAAfuoB,EAAMzmB,OACDyyF,EAGDylB,EAAc94B,SAAS34D,EAAMvoB,OAF7Bw7H,EAAUp4C,QAAU76D,EAAMvoB,OAKf,iBAAfuoB,EAAMzmB,OACNi4G,EAAW/pE,OAAOznB,EAAMvoB,MAAM+5G,YAC9BC,EAAchqE,OAAOznB,EAAMvoB,MAAMg6G,iBAGzC/8C,EAAEy+D,oBAAoBtkF,UAAUwkF,GAChC,CACI,MAAM3Y,EAAehmD,EAAEy+D,oBAAoBlY,kBAC3CzJ,EAAW/pE,OAAOizE,EAAalJ,YAC/BC,EAAchqE,OAAOizE,EAAajJ,eAClCD,EAAW74B,SAASjkB,EAAEy+D,oBAAoBjsB,WAC1CuK,EAAc94B,SAASjkB,EAAEy+D,oBAAoBhsB,uBAGxCqsB,IACLp5G,EAAIxJ,MAAMC,QAAUm7E,EAAY,QAAU,OACtCA,GAAaynC,IACbr5G,EAAIxJ,MAAMkF,KAAQ29G,EAASp6G,EAAI1gB,KAAK4jC,MAAMy2F,EAAgB,GAAM,KAChE54G,EAAIxJ,MAAM29C,IAAOklE,EAASn6G,EAAI3gB,KAAK4jC,MAAMy2F,EAAqC,EAAlBA,EAAsB,GAAM,MAIhG,IAAIS,EAAW,KACf1sD,GAAGpmD,iBAAiBvnB,SAAU,eAAe,SAAS4mB,GAClDyzG,EAAW,CACPp6G,EAAG2G,EAAM4zC,MACTt6C,EAAG0G,EAAM6zC,UAGjB,IAAImD,EAA4B59D,SAASm0H,eAAe,QACxDv2D,MAAAA,GAAAA,EAAQr2C,iBAAiB,cAAc,SAAqBX,GAExDA,EAAM4xC,iBACNo6B,GAAY,EAEY,OAApBinC,EAAUl1C,QACVw1C,EAAYN,EAAUl1C,OACtBk1C,EAAUl1C,MAAQ,MAEC,OAAnBk1C,EAAUzmG,OACVglF,EAAW74B,SAASs6C,EAAUzmG,MAC9BymG,EAAUzmG,KAAO,MAEK,OAAtBymG,EAAUp4C,UACV42B,EAAc94B,SAASs6C,EAAUp4C,SACjCo4C,EAAUp4C,QAAU,MAGxB24C,OAELx8D,MAAAA,GAAAA,EAAQr2C,iBAAiB,YAAY,SAAqBX,GAEzDgsE,GAAY,EACZknC,EAAYp8G,MACZ08G,OAKAx4H,KAAKk9E,WAAa,WACd,OAAO99D,6BC1LiBo4C,GAC5B,IAAIp4C,EAAMhhB,SAASC,cAAc,gBAQxBq6H,EAAah/D,GAClB,IAAIwkB,EAAU,GAAKxkB,EAAEi/D,aAAej/D,EAAEi/D,aAAe,GACjD9wH,EAASkkE,GAAG1+D,GAAG,CACf2nE,UAAW,mCACXtG,MAAOhV,EAAEgV,MACTuG,QAASvb,EAAEub,QACXF,IAAK,CACDmJ,QAASxkB,EAAEk/D,QAAU16C,EAAU,OAAS,MAG5C7R,EAAKN,GAAG1+D,GAAG,CACX0nE,IAAK,CACD0J,gBAAiB,QAAW/kB,EAAEglB,MAAQ,KACtCe,iBAAkB,YAClBkc,mBAAoB,SACpBnc,eAAgB9lB,EAAEk/D,QAAU,UAAY,GAExC7mE,OAAQ,UAehB,OAZAsa,EAAGz2D,MAAM4rE,cAAgB,OACzB35E,EAAOjJ,YAAYytE,GAClBxkE,EAAem6E,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CACrDj0E,OAAQvG,EACRoyD,aAAc,SAASqF,GACfA,EACAyM,GAAGkO,aAAapyE,EAAQ,8BAExBkkE,GAAGyR,gBAAgB31E,EAAQ,iCAIhCA,EAvCXkkE,GAAGgJ,IAAI31D,EAAK,CACR2yC,OAAQ,OAERl8C,QAAS,OACT4oE,gBAAiB,uFAsCrB,IAAIo6C,EAAaH,EAAa,CAC1BhqD,MAAO+J,GAAK,QACZiG,MAAOlnB,EAAEshE,QAAUthE,EAAEshE,QAAUlhD,EAAAoiB,IAC/B4+B,SAAS,IAEbC,EAAWjjH,MAAMk8C,MAAQ,OACzB+mE,EAAWjjH,MAAMwvE,YAAc,+BAC/B,IAAI2zC,EAAYL,EAAa,CACzBzjD,QAASzd,EAAEwhE,MACXtqD,MAAO+J,GAAK,YACZiG,MAAO9G,EAAAqiB,IACP0+B,aAAc,EACdC,SAAS,IAETK,EAAeP,EAAa,CAC5BzjD,QAASzd,EAAE0hE,SACXxqD,MAAO+J,GAAK,eACZiG,MAAO9G,EAAAsiB,IACPy+B,aAAc,EACdC,SAAS,IAETO,EAAaT,EAAa,CAC1BzjD,QAASzd,EAAE4hE,OACX1qD,MAAO+J,GAAK,aACZiG,MAAO9G,EAAAuiB,IACPw+B,aAAc,EACdC,SAAS,IAIT7sD,GAAGstD,iBACWX,EAAa,CACvBzjD,QAASzd,EAAE8hE,QACX5qD,MAAO+J,GAAK,cACZiG,MAAO9G,EAAAwiB,IACPw+B,SAAS,IAGAF,EAAa,CAC1BzjD,QAASzd,EAAE+hE,OACX7qD,MAAO+J,GAAK,QACZiG,MAAO9G,EAAAyiB,IACPu+B,SAAS,IAGbx5G,EAAIxgB,YAAYi6H,GAChBz5G,EAAIxgB,YAAYm6H,GAChB35G,EAAIxgB,YAAYq6H,GAChB75G,EAAIxgB,YAAYu6H,GAKhBn5H,KAAKk9E,WAAa,WACd,OAAO99D,iBVcXs7E,6BWjH6BljC,GAC7B,IAAIp4C,EAAMhhB,SAASC,cAAc,OACjC0tE,GAAGgJ,IAAI31D,EAAK,CACR2yC,OAAQ,OAERl8C,QAAS,OACT4oE,gBAAiB,uFAGrB,IAAI+6C,EAAmB,gBAEd7yC,EAAU0V,EAAWo9B,GACtBD,IAAqBn9B,IAIzBm9B,EAAmBn9B,EAEnBq9B,EAAa/yC,UAAU6yC,GACE,SAArBA,EACAztD,GAAGkO,aAAa0/C,EAAY,kCAE5B5tD,GAAGyR,gBAAgBm8C,EAAY,kCAG/BF,GACAjiE,EAAEoiE,WAAWJ,aAIZd,EAAah/D,GAElB,IAAIwhC,EAAcxhC,EAAEmgE,UAAY,QAAU,QAEtChyH,EAASkkE,GAAG1+D,GAAG,CACf2nE,UAAW,mCAEXC,QAASvb,EAAEub,QACXF,IAAK,CACDmJ,QAASxkB,EAAEk/D,QAAU,SAAW,MAGpCvsD,EAAKN,GAAG1+D,GAAG,CACX0nE,IAAK,CACD0J,gBAAiB,QAAW/kB,EAAEglB,MAAQ,KACtCe,iBAAkB,YAClBkc,mBAAoB,SACpBnc,eAAgB9lB,EAAEk/D,QAAU,UAAY,GAExC7mE,OAAQ,OACR0f,UAAW/X,EAAEogE,SAAW,eAAiB,GACzCt4C,cAAe,OACf3B,QAASnmB,EAAEmgE,UAAY,OAAS,OAiBxC,OAdAhyH,EAAOjJ,YAAYytE,GAClBxkE,EAAem6E,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CACrDj0E,OAAQvG,EACRoyD,aAAc,SAASqF,GACfA,EACAyM,GAAGkO,aAAapyE,EAAQ,8BAExBkkE,GAAGyR,gBAAgB31E,EAAQ,iCAItCA,EAAes0F,WAAa,SAASn+E,GAClCnW,EAAO+N,MAAMsoE,QAAUxkB,EAAEk/D,QAAW56G,EAAIk9E,EAAc,SAAY,IAE/DrzF,WAIFkyH,EAAqBrgE,GAE1B,IAAI7xD,EAASzJ,SAASC,cAAc,OACpC0tE,GAAGgJ,IAAIltE,EAAQ,CACXszF,SAAU,IACV5pE,SAAU,aAGd,IAAIyoG,EAAMjuD,GAAG0lB,UAAU,CACnBxiB,YAAa,MACbnd,MAAO,OACPC,OAAQ,OACRkoE,QAAS,cACTC,oBAAqB,SAEzBnuD,GAAGgJ,IAAIilD,EAAK,CACRzoG,SAAU,WACVzW,KAAM,IACNy4C,IAAK,MAGT,IAII4mE,EAAOpuD,GAAG0lB,UAAW,CACrBxiB,YAAa,OACbC,YAAa,CACT,CACID,YAAa,SACbhzE,GAAI,cACJ6yC,GAAI,OACJE,GAAI,OACJ8iB,MAAO,OACPC,OAAQ,OACRmd,YAAa,CACT,CACID,YAAa,iBACbmrD,GAAI,cACJC,aAAc,KACdxyH,OAAQ,QACT,CACConE,YAAa,WACbqrD,GAAI,IACJC,GAAI,KACL,CACCtrD,YAAa,cACburD,IAAK,cACLC,SAAU,aACVC,GAAI,KACJC,GAAI,IACJ9yH,OAAQ,cAGZ,CACIonE,YAAa,UACb,cAAe,OACf,gBAAiB,OAClB,CACCA,YAAa,cACburD,IAAK,aACLC,SAAU,MACX,CACCxrD,YAAa,cACburD,IAAK,gBACLC,SAAU,OACV5yH,OAAQ,eAGZ,CACIonE,YAAa,iBACbmrD,GAAI,cACJC,aAAc,KACdxyH,OAAQ,SACT,CACConE,YAAa,WACbqrD,GAAI,IACJC,GAAI,KACL,CACCtrD,YAAa,cACburD,IAAK,cACLC,SAAU,aACVC,GAAI,KACJC,GAAI,IACJ9yH,OAAQ,cAGZ,CACIonE,YAAa,UACb,cAAe,OACf,gBAAiB,OAClB,CACCA,YAAa,cACburD,IAAK,aACLC,SAAU,MACX,CACCxrD,YAAa,cACburD,IAAK,cACLC,SAAU,aAQ1BG,EAAkB7uD,GAAG0lB,UAAU,CAC/BxiB,YAAa,OACb,gBAAiB,qBACjB9Y,EAAG,uBACHi4B,KAAM,gBACNysC,MAAO,kCAEXD,EAAgBrgD,QAAU,WACtB7gB,EAAEohE,SACF/uD,GAAGyR,gBAAgBo9C,EAAiB,wCAGxC,IAAIG,EAAmBhvD,GAAG0lB,UAAU,CAChCxiB,YAAa,OACb,gBAAiB,qBACjB9Y,EAAG,2BACHi4B,KAAM,gBACNysC,MAAO,kCAEXE,EAAiBxgD,QAAU,WACvB7gB,EAAEshE,UACFjvD,GAAGyR,gBAAgBu9C,EAAkB,wCAIxClzH,EAAeozH,oBAAsB,IAAIlvD,GAAGsW,gBAAgB,CACzDj0E,OAAQwsH,EACR3gE,aAAc,SAASqF,GACfA,EACAyM,GAAGkO,aAAa2gD,EAAiB,uCAEjC7uD,GAAGyR,gBAAgBo9C,EAAiB,0CAI/C/yH,EAAeqzH,qBAAuB,IAAInvD,GAAGsW,gBAAgB,CAC1Dj0E,OAAQ2sH,EACR9gE,aAAc,SAASqF,GACfA,EACAyM,GAAGkO,aAAa8gD,EAAkB,uCAElChvD,GAAGyR,gBAAgBu9C,EAAkB,0CAMjDf,EAAIp7H,YAAYu7H,GAChBH,EAAIp7H,YAAYg8H,GAChBZ,EAAIp7H,YAAYm8H,GAChBlzH,EAAOjJ,YAAYo7H,GAGnB,IAAImB,EAASpvD,GAAG1+D,GAAG,CACf0nE,IAAK,CACD0J,gBAAiB,QAAW/kB,EAAE0hE,UAAY,KAC1C37C,iBAAkB,YAClBD,eAAgB,UAChB1tB,MAAO,OACPC,OAAQ,OACRxgC,SAAU,WACVzW,KAAM,OACNy4C,IAAK,MAELiuB,cAAe,UAGvB35E,EAAOjJ,YAAYu8H,GAGnB,IAAIE,EAAUtvD,GAAG1+D,GAAG,CAChB0nE,IAAK,CACD0J,gBAAiB,SAAY/kB,EAAE4hE,WAAa5hE,EAAE4hE,WAAa5hE,EAAE0hE,WAAa,KAC1E37C,iBAAkB,YAClBD,eAAgB,UAChB1tB,MAAO,OACPC,OAAQ,OACRxgC,SAAU,WACVxW,MAAO,OACP69D,OAAQ,MACRnH,UAAW/X,EAAE4hE,WAAa,GAAK,eAC/B95C,cAAe,UA4BvB,OAzBA35E,EAAOjJ,YAAYy8H,GAMlBxzH,EAAe0zH,iBAAmB,SAASv9G,GACpCA,GACA+tD,GAAGyR,gBAAgBo9C,EAAiB,iCACpC7uD,GAAGyR,gBAAgB29C,EAAQ,mCAE3BpvD,GAAGkO,aAAa2gD,EAAiB,iCACjC7uD,GAAGkO,aAAakhD,EAAQ,mCAG/BtzH,EAAe2zH,kBAAoB,SAASx9G,GACrCA,GACA+tD,GAAGyR,gBAAgBu9C,EAAkB,iCACrChvD,GAAGyR,gBAAgB69C,EAAS,mCAE5BtvD,GAAGkO,aAAa8gD,EAAkB,iCAClChvD,GAAGkO,aAAaohD,EAAS,mCAI1BxzH,EAuHX,IAAI6xH,EAAe,IAAIh/B,GAAa,CAChCxlB,SAAU,SAASmnB,GACf1V,EAAU0V,GAAW,MAG7Bj9E,EAAIxgB,YAAY86H,EAAax8C,cAE7B,IAAIy8C,EAAajB,EAAa,CAC1BzjD,QAAS,WACL0R,EAAU,QAAQ,IAEtBjI,MAAO9G,EAAA2kB,IACPq8B,SAAS,EACTiB,WAAW,IAEfF,EAAW/jH,MAAMwvE,YAAc,+BAC/Bu0C,EAAWjrD,MAAQ+J,GAAK,aACxBr5D,EAAIxgB,YAAY+6H,GAEhB,IAAI8B,EAAmB1B,EAAqB,CACxCe,OAAQtjE,EAAEkkE,SACVV,QAASxjE,EAAEmkE,UACXP,UAAWxjD,EAAA4kB,IACX8+B,WAAY1jD,EAAA6kB,MAEhBg/B,EAAiB/sD,MAAQ+J,GAAK,aAC9Br5D,EAAIxgB,YAAY68H,GAEhB,IAAIG,EAAelD,EAAa,CAC5BzjD,QAASzd,EAAEkkE,SACXh9C,MAAO9G,EAAA4kB,IACPo8B,SAAS,IAEbgD,EAAaltD,MAAQ+J,GAAK,WAC1Br5D,EAAIxgB,YAAYg9H,GAEhB,IAAIC,EAAgBnD,EAAa,CAC7BzjD,QAASzd,EAAEmkE,UACXj9C,MAAO9G,EAAA6kB,IACPm8B,SAAS,IAEbiD,EAAcntD,MAAQ+J,GAAK,YAC3Br5D,EAAIxgB,YAAYi9H,GAEhB,IAAIC,EAAkB/B,EAAqB,CACvCe,OAAQtjE,EAAEo2D,OACVoN,QAASxjE,EAAEs2D,OACXsN,UAAWxjD,EAAA8kB,IACX4+B,WAAY,OAEhBQ,EAAgBptD,MAAQ+J,GAAK,kBAC5BqjD,EAAwBP,kBAAiB,GACzCO,EAAwBN,mBAAkB,GAC3Cp8G,EAAIxgB,YAAYk9H,GAEhB,IAAIC,EAAarD,EAAa,CAC1BzjD,QAASzd,EAAEo2D,OACXlvC,MAAO9G,EAAA8kB,IACPk8B,SAAS,IAEbmD,EAAWrtD,MAAQ+J,GAAK,QACxB1M,GAAGkO,aAAa8hD,EAAY,iCAC5B38G,EAAIxgB,YAAYm9H,GAEhB,IAAIC,EAAatD,EAAa,CAC1BzjD,QAASzd,EAAEs2D,OACXpvC,MAAO9G,EAAA8kB,IACPk8B,SAAS,EACTkB,UAAU,IAEdkC,EAAWttD,MAAQ+J,GAAK,QACxB1M,GAAGkO,aAAa+hD,EAAY,iCAC5B58G,EAAIxgB,YAAYo9H,GAEhBJ,EAAahmH,MAAMC,QAAU,OAC7BgmH,EAAcjmH,MAAMC,QAAU,OAC9BkmH,EAAWnmH,MAAMC,QAAU,OAC3BmmH,EAAWpmH,MAAMC,QAAU,OAQ3B7V,KAAKk9E,WAAa,WACd,OAAO99D,GAEXpf,KAAKm8F,WAAa,SAASn+E,GACvB+tD,GAAGgJ,IAAI31D,EAAK,CACR2yC,OAAQ/zC,EAAI,OAAS,SAGzB07G,EAAav9B,WAAWn+E,GACvB27G,EAAmBx9B,WAAWn+E,GAC9B49G,EAAqBz/B,WAAWn+E,GAChC69G,EAAsB1/B,WAAWn+E,GACjC+9G,EAAmB5/B,WAAWn+E,GAC9Bg+G,EAAmB7/B,WAAWn+E,GAE3BA,GACAy9G,EAAiB7lH,MAAMC,QAAU,OACjCimH,EAAgBlmH,MAAMC,QAAU,OAChC+lH,EAAahmH,MAAMC,QAAU,QAC7BgmH,EAAcjmH,MAAMC,QAAU,QAC9BkmH,EAAWnmH,MAAMC,QAAU,QAC3BmmH,EAAWpmH,MAAMC,QAAU,UAE3B4lH,EAAiB7lH,MAAMC,QAAU,QACjCimH,EAAgBlmH,MAAMC,QAAU,QAChC+lH,EAAahmH,MAAMC,QAAU,OAC7BgmH,EAAcjmH,MAAMC,QAAU,OAC9BkmH,EAAWnmH,MAAMC,QAAU,OAC3BmmH,EAAWpmH,MAAMC,QAAU,SAKnC7V,KAAKi8H,gBAAkB,SAASj+G,GACxBA,EACA+tD,GAAGyR,gBAAgBo+C,EAAc,iCAEjC7vD,GAAGkO,aAAa2hD,EAAc,iCAEjCH,EAAyBF,iBAAiBv9G,IAE/Che,KAAKk8H,iBAAmB,SAASl+G,GACzBA,EACA+tD,GAAGyR,gBAAgBq+C,EAAe,iCAElC9vD,GAAGkO,aAAa4hD,EAAe,iCAElCJ,EAAyBD,kBAAkBx9G,IAEhDhe,KAAKm8H,cAAgB,SAASn+G,GACtBA,EACA+tD,GAAGyR,gBAAgBu+C,EAAY,iCAE/BhwD,GAAGkO,aAAa8hD,EAAY,iCAE/BD,EAAwBP,iBAAiBv9G,IAE9Che,KAAKo8H,cAAgB,SAASp+G,GACtBA,EACA+tD,GAAGyR,gBAAgBw+C,EAAY,iCAE/BjwD,GAAGkO,aAAa+hD,EAAY,iCAE/BF,EAAwBN,kBAAkBx9G,IAE/Che,KAAK2mF,UAAY,SAAS0V,GACtB1V,EAAU0V,IAEdr8F,KAAKs8F,UAAY,WACb,OAAOk9B,oCCjkBwB9/D,GAEnC,IAAIt6C,EAAM2sD,GAAG1+D,GAAG,CACZwhE,QAAS,QACT95D,QAAS0jE,GAAK,cAAgB,SAC9B/J,MAAO+J,GAAK,oBACZ1D,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZ8E,SAAU,OACV8E,MAAO,qBAIXs5C,EAAiB,IAAI3+C,GAAO,CAC5BI,UAAW,CACP,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,MAEVQ,UAAW5kB,EAAEmL,UACbqQ,SAAU,SAAStvE,GACf8zD,EAAE4iE,SAASzrF,SAASjrC,OAG5BwZ,EAAIxgB,YAAYy9H,EAAen/C,cAET,IAAInR,GAAGsW,gBAAgB,CACzCj0E,OAAQgR,EACR26C,QAAS,SAASr7D,GACd29H,EAAex+C,cAAcn/E,EAAEi6D,WAMvC34D,KAAKk9E,WAAa,WACd,OAAO99D,oBC5BQs6C,GACnB,IAAI6N,EAAQvnE,KAERof,EAAM2sD,GAAG1+D,GAAG,CACZ2nE,UAAW,SACXD,IAAK,CACDhjB,OAAQA,UAIZwqE,EAAS,GACTC,EAAe,KAEnB,MACMC,EAAa1wD,GAAG1+D,GAAG,CACrB0nE,IAAK,CACDjjB,MAAO4qE,OACP3qE,OAAQ2qE,OACRj+C,gBAAe,QAAU7G,EAAA+kB,QACzBnd,eAAgB,QAChBjuD,SAAU,WACVxW,MAAK,QACL69D,OAAQ,IACR4I,cAAe,UAGjBm7C,EAAY5wD,GAAG1+D,GAAG,CACpB0nE,IAAK,CACDjjB,MAAO4qE,OACP3qE,OAAQ2qE,OACRj+C,gBAAe,QAAU7G,EAAA+kB,QACzBnd,eAAgB,QAChBjuD,SAAU,WACVzW,KAAI,QACJ89D,OAAQ,IACRnH,UAAW,cACX+P,cAAe,mBAIdo7C,EAAUC,EAASl1C,EAAWm1C,GACnC,IAAIj1H,EAAc,CACd5L,GAAI4gI,EAAQ5gI,GACZ+0F,YAAW,cAAe6rC,IAAUA,EAAQ7rC,UAC5C+rC,OAAQF,EAAQE,OAChB9gD,QAAS4gD,EAAQ5gD,QACjBxvC,OAAQ,SAASuwF,GACbC,EAAOjoD,UAAYgoD,IAAiBn1H,EAAUi1H,EAAY,wCAA0C,+BAAkC,aACtIG,EAAOrnH,MAAMC,QAAUhO,EAAOmpF,UAAY,QAAU,SAGxDisC,EAASlxD,GAAG1+D,GAAG,CACf0H,QAAS,UAAW8nH,EAAUA,EAAQ/5E,MAAQ,GAC9C4rB,MAAO,UAAWmuD,EAAUA,EAAQnuD,WAAQ5rE,EAC5CkyE,UAAW2S,IAAc9/E,EAAO5L,GAAM6gI,EAAY,wCAA0C,+BAAkC,aAC9H/nD,IAAK,CACD0E,WAAY1nB,OACZl8C,QAAShO,EAAOmpF,UAAY,QAAU,OACtC1X,OAAQ,KAEZrE,QAAS,WACDunD,IAAiB30H,GAGrB0/D,EAAMvxD,KAAKnO,EAAO5L,OAG1B4L,EAAOuX,IAAM69G,EACT,UAAWJ,GACX9wD,GAAGgJ,IAAIkoD,EAAQ,CACXx+C,gBAAiB,QAAWo+C,EAAQn+C,MAAQ,KAC5Cc,eAAiBztB,SAGrB,QAAS8qE,GACT9wD,GAAGgJ,IAAIkoD,EAAQJ,EAAQ9nD,KAE3B31D,EAAIxgB,YAAYq+H,GAEM,IAAIlxD,GAAGsW,gBAAgB,CACzCj0E,OAAQ6uH,EACRhjE,aAAc,SAASqF,GACfA,EACAyM,GAAGkO,aAAagjD,EAAQ,oBAExBlxD,GAAGyR,gBAAgBy/C,EAAQ,uBAavC,OARIt1C,IAAc9/E,EAAO5L,IACrB4L,EAAOk1H,SACPl1H,EAAOuX,IAAIxgB,YAAY69H,GACvB50H,EAAOuX,IAAIxgB,YAAY+9H,IAEvB90H,EAAOo0E,UAGJp0E,EAGX,IAAK,IAAI8uD,EAAI,EAAGA,EAAI+C,EAAE6iE,OAAOvgI,OAAQ26D,IACjC4lE,EAAOn2H,KAAKw2H,EAAUljE,EAAE6iE,OAAO5lE,GAAI+C,EAAEiuB,UAAWjuB,EAAEojE,YAGtD,IAAK,IAAI7mE,EAAI,EAAGA,EAAIsmE,EAAOvgI,OAAQi6D,IAC3BsmE,EAAOtmE,GAAGh6D,KAAOy9D,EAAEiuB,YACnB60C,EAAeD,EAAOtmE,IAG9B,GAAqB,OAAjBumE,EACA,KAAM,6BAGD/vF,IACL,IAAK,IAAI1wC,EAAI,EAAGA,EAAIwgI,EAAOvgI,OAAQD,IAC/BwgI,EAAOxgI,GAAG0wC,OAAO+vF,GAKzBx8H,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAKgW,KAAO,SAASknH,GACjB,IAAK,IAAInhI,EAAI,EAAGA,EAAIwgI,EAAOvgI,OAAQD,IAC/B,GAAIwgI,EAAOxgI,GAAGE,KAAOihI,EAAO,CACxB,GAAIV,IAAiBD,EAAOxgI,GACxB,OAQJ,OANAygI,EAAavgD,UACbugD,EAAeD,EAAOxgI,GACtBygI,EAAaO,SACbP,EAAap9G,IAAIxgB,YAAY69H,GAC7BD,EAAap9G,IAAIxgB,YAAY+9H,QAC7BlwF,IAIR,KAAM,+BAGVzsC,KAAKm9H,eAAiB,WAClB,MAAO,GAAKX,EAAavgI,IAG7B+D,KAAKw2H,aAAe,SAAS0G,EAAOlsC,GAChC,IAAK,IAAIj1F,EAAI,EAAGA,EAAIwgI,EAAOvgI,OAAQD,IAC/B,GAAIwgI,EAAOxgI,GAAGE,KAAOihI,EAGjB,OAFAX,EAAOxgI,GAAGi1F,YAAcA,OACxBvkD,IAIR,KAAM,oECvKqBitB,GAC/B,IAAIohC,GAAS,EACTsiC,EAAe,iBAEV3wF,IAEDw2D,EAAKrtF,MAAM67D,UADM,SAAjB2rD,EACuBtiC,EAAS,iBAAmB,GAE5BA,EAAS,GAAK,iBAI7C,IAAI17E,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDjjB,MAAO,OACPC,OAAQ,OACR2nB,WAAY,UACZqJ,MAAO,OACPxxD,SAAU,WACVgiC,IAAK,IACL+zB,UAAW,SACX7N,WAAY,OACZuE,OAAQ,UACRgD,WAAY,OACZ9C,QAAS,MACTwB,UAAW,cAGfhR,MAAO+J,GAAK,qBACZxD,QAAS,SAASv2E,GACdA,EAAEk4D,iBACFkkC,GAAUA,EACVruD,IACAitB,EAAEwb,YAENj5E,GAAG,WAGHgnG,EAAOl3B,GAAG1+D,GAAG,CACbga,OAAQjI,EACR21D,IAAK,CACD0J,gBAAe,OAAS7G,EAAAilB,OACxB/qC,MAAO,OACPC,OAAQ,OACRytB,eAAgB,UAChBC,iBAAkB,YAClBkc,mBAAoB,SACpB3a,WAAY,UAGpB5hE,EAAIiiE,cAAgB,WAChB,OAAO,GAIXrhF,KAAK86F,OAAS,WACV,OAAOA,GAOX96F,KAAKq9H,aAAe,SAASC,GACzBF,EAAeE,EACf7wF,KAGJzsC,KAAKk9E,WAAa,WACd,OAAO99D,qBdiEXw7F,sBehIAv3E,gBA0Bak6F,EAAe7+H,GACpBA,EAAEk4D,iBACFl4D,EAAE8+H,YAAc,GA3BS,OAAzBx9H,KAAKy9H,kBAGTz9H,KAAKy9H,gBAAkBz9H,KAAK4oG,QAAQhyB,kBAEhC52E,KAAK09H,cACLx4D,aAAW,KACP,GAAiC,YAA7B9mE,SAASu/H,gBACT,OAGJ,IAEI3mD,EAAeh3E,KAAK4oG,QAAQhyB,kBAE5BgnD,EAAcjgI,KAAKghB,IAAIq4D,EAAeh3E,KAAKy9H,iBAE3Cz9H,KAAK69H,oBANiB,KAM4BjjE,YAAYr1C,OAAUq4G,GAAe,KACvF59H,KAAKqqF,OAAM,GACXwe,GAAGi1B,sBAAsB99H,KAAK42H,sBAEnC,KASP52H,KAAK4oG,QAAQtyB,aAAW,KACpB,IAAIU,EAAeh3E,KAAK4oG,QAAQhyB,kBAC5B52E,KAAKy9H,kBAAoBzmD,EACzBjL,GAAGwJ,iBAAiBz1E,OAAQ,iBAAkBy9H,GAE9CxxD,GAAGwJ,iBAAiBz1E,OAAQ,iBAAkB,SAIlDE,KAAK+9H,aACL3/H,SAASunB,iBAAiB,oBAAkB,KACxC,GAAiC,YAA7BvnB,SAASu/H,gBACTv/H,SAASswE,MAAQ1uE,KAAK0uE,MACtB5J,cAAc9kE,KAAKg+H,qBAChB,CACH,IAAIhnD,EAAeh3E,KAAK4oG,QAAQhyB,kBAChC,GAAI52E,KAAKy9H,kBAAoBzmD,EAAc,CACvC54E,SAASswE,MAAQ+J,GAAK,WAAa,MAAQz4E,KAAK0uE,MAChD,IAAIzkE,EAAQ,EACZjK,KAAKg+H,gBAAkB94D,aAAW,KAC9Bj7D,GAASA,EAAQ,GAAK,EAElB7L,SAASswE,MADC,IAAVzkE,EACiBwuE,GAAK,WAAa,MAAKz4E,KAAO0uE,MAE9B+J,GAAK,WAAa,MAAQz4E,KAAK0uE,QAErD,YAOvB2b,MAAO4zC,GAC0B,OAAzBj+H,KAAKy9H,kBAGJQ,IACDj+H,KAAK42H,gBAAkB,GAE3B52H,KAAK69H,oBAAsBjjE,YAAYr1C,MACvCvlB,KAAKy9H,gBAAkBz9H,KAAK4oG,QAAQhyB,kBACpC7K,GAAGwJ,iBAAiBz1E,OAAQ,iBAAkB,mBA/EtC8oG,EACA80B,EACAK,EACArvD,EAAgB,eAHhBk6B,QAAAA,OACA80B,aAAAA,OACAK,YAAAA,OACArvD,MAAAA,EAVT1uE,KACKy9H,gBAA0B,KAD/Bz9H,KAEK42H,gBAA0B,4BCU1BnqF,SACAzsC,KAAKk+H,UAAUC,aAAen+H,KAAKk+H,UAAU1hD,aAAe,GACvDx8E,KAAKo+H,aACNp+H,KAAKq+H,MAAMzoH,MAAMC,QAAuC,IAA7B7V,KAAKk+H,UAAU3sE,UAAkB,OAAS,SAEpEvxD,KAAKs+H,eACNt+H,KAAKu+H,QAAQ3oH,MAAMC,QACf7V,KAAKk+H,UAAU3sE,UAAYvxD,KAAKk+H,UAAU1hD,aAAe,GAAKx8E,KAAKk+H,UAAUC,aACzE,OAAS,WAIrBn+H,KAAKq+H,MAAMzoH,MAAMC,QAAU,OAC3B7V,KAAKu+H,QAAQ3oH,MAAMC,QAAU,QA4FrCi+G,cAAeC,GACXhoD,GAAGgJ,IAAI/0E,KAAKq+H,MAAO,CACfvjH,KAAkB,SAAZi5G,EAAqB,IAAM,KACjCh5G,MAAmB,UAAZg5G,EAAsB,IAAM,OAEvChoD,GAAGgJ,IAAI/0E,KAAKu+H,QAAS,CACjBzjH,KAAkB,SAAZi5G,EAAqB,IAAM,KACjCh5G,MAAmB,UAAZg5G,EAAsB,IAAM,mBA9F/Br6D,GACR15D,KAAKk+H,UAAYxkE,EAAEwkE,UACnBl+H,KAAKq+H,MAAQtyD,GAAG1+D,GAAG,CACfga,OAAQrnB,KAAKk+H,UACbxvD,MAAO+J,GAAK,UACZzD,UAAW,cACXD,IAAK,CACDxhB,IAAK,IACLke,UAAW,oBAGnBzxE,KAAKu+H,QAAUxyD,GAAG1+D,GAAG,CACjBga,OAAQrnB,KAAKk+H,UACbxvD,MAAO+J,GAAK,UACZzD,UAAW,cACXD,IAAK,CACD6D,OAAQ,OAGhB54E,KAAK8zH,cAAcp6D,EAAEq6D,SAEF,IAAIhoD,GAAGsW,gBAAgB,CACtCj0E,OAAQpO,KAAKq+H,MACbxkE,UAAYn7D,IACO,gBAAXA,EAAEH,OACFyB,KAAKo+H,WAAal5D,aAAW,KACzBllE,KAAKk+H,UAAUM,SAAS,GAAG,IAC3Bx+H,KAAKysC,WACN,KAEQ,cAAX/tC,EAAEH,OACFumE,cAAc9kE,KAAKo+H,YACnBt4G,YAAU,KACN9lB,KAAKo+H,WAAa,KAClBp+H,KAAKysC,WACN,MAGXstB,QAAUr7D,IACNsB,KAAKk+H,UAAUM,SAAS,EAAG,GAAK9/H,EAAEi6D,QAClC34D,KAAKysC,YAGQ,IAAIs/B,GAAGsW,gBAAgB,CACxCj0E,OAAQpO,KAAKu+H,QACb1kE,UAAYn7D,IACO,gBAAXA,EAAEH,OACFyB,KAAKs+H,aAAep5D,aAAW,KAC3BllE,KAAKk+H,UAAUM,SAAS,EAAG,IAC3Bx+H,KAAKysC,WACN,KAEQ,cAAX/tC,EAAEH,OACFumE,cAAc9kE,KAAKs+H,cACnBx4G,YAAU,KACN9lB,KAAKs+H,aAAe,KACpBt+H,KAAKysC,WACN,MAGXstB,QAAUr7D,IACNsB,KAAKk+H,UAAUM,SAAS,EAAG,GAAK9/H,EAAEi6D,QAClC34D,KAAKysC,YAIbzsC,KAAKysC,SAEY,IAAI5lB,kBAAgB,IAAO7mB,KAAKysC,WACxC/kB,QACL1nB,KAAKk+H,UACL,CACIh4E,YAAY,EACZu4E,WAAW,EACXC,SAAS,IAGjB5+H,OAAO6lB,iBAAiB,UAAQ,IAAQ3lB,KAAKysC,WAG7C6qC,GAAczjC,WAAW91B,IAErB/d,KAAKq+H,MAAMzoH,MAAMiqE,QAAU9hE,GAAK,EAAI,IAAM,GAC1C/d,KAAKu+H,QAAQ3oH,MAAMiqE,QAAU9hE,GAAK,EAAI,IAAM,sBhBiCpDu5D,SACAoB,SACAiD,yBiBzJyBt0D,EAAQq3D,GACjC,IAAIigD,EAASC,EAAgBC,EAAU/rF,EAAQgsF,EAAWC,EAAgBC,EAAYC,EAClFzqD,EAAM0qD,EAASC,EAAYC,EAC/BT,EAAU,GACVS,EAAc,GACdR,EAAiB,aAEjB9rF,GAAS,EACTgsF,GAAY,EACZD,EAAWzgI,SAASC,cAAc,OAClC0tE,GAAGgJ,IAAI8pD,EAAU,CACb/sE,MAAQ,UAGZitE,EAAiB3gI,SAASC,cAAc,OACxC2gI,EAAa,IAAIh2C,MACjBg2C,EAAWlpH,IAAM4oE,EAAM5oE,IAEvBipH,EAAengI,YAAYogI,GAC3BD,EAAengI,YAAY8/E,GAE3B3S,GAAGgJ,IAAIgqD,EAAgB,CACnBjtE,MAAQ,QACRC,OAAS,QACT6oB,UAAY+jD,OACZ9jD,WAAa8jD,OACbptG,SAAU,WACVsnD,SAAU,SACVc,UAAW,oCACXmG,OAAQ,mCACR2G,WAAY,2BAEhB1a,GAAGgJ,IAAI2J,EAAO,CACVntD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLzB,MAAQ,QACRC,OAAS,QACT8tB,QAAS,MAEbo/C,EAAY,CACRntE,MAAQ,IACRC,OAAS,IAAc2sB,EAAM5sB,MAAS4sB,EAAM3sB,QAE5CktE,EAAUltE,OAAU,MACpBktE,EAAUltE,OAAU,IACpBktE,EAAUntE,MAASmtE,EAAUltE,OAAS2sB,EAAM3sB,OAAU2sB,EAAM5sB,OAEhEia,GAAGgJ,IAAIiqD,EAAY,CACfztG,SAAU,WACVgiC,IAAM,OACNz4C,KAAO,QACPg3C,MAAOmtE,EAAUntE,MAAQ,KACzBC,OAAQktE,EAAUltE,OAAS,KAC3B8oB,YAAcokD,EAAUntE,MAAQ,EAAK,KACrC8oB,WAAaqkD,EAAUltE,OAAS,EAAK,gBAGhCyiE,IACD1hF,IAGJgsF,GAAaA,EACTA,EACA/yD,GAAGgJ,IAAIgqD,EAAgB,CACnBj/C,OAAQ,+BAGZ/T,GAAGgJ,IAAIgqD,EAAgB,CACnBj/C,OAAQ,qCAGhBh6D,WAAW0uG,EAAW,MAG1BA,GAEAhgD,EAAOp2E,SAASC,cAAc,OAC9Bm2E,EAAKC,UAAY,qDACjBD,EAAK6qD,aAAe,WAChB,OAAO,GAEXtzD,GAAGgJ,IAAIP,EAAM,CACTyJ,SAAW0gD,SACX57C,MAAO,OACP7E,QAAS,OACToJ,UAAW,WAGfu3C,EAASjgI,YAAYmgI,GACrBF,EAASjgI,YAAY41E,GAErB0qD,GAAU,EACVxgD,EAAM2gD,aAAe,WACjBtzD,GAAGgJ,IAAIgqD,EAAgB,CACnBplD,UAAW,oCAEfulD,GAAU,EACVC,EAAar5G,YAAW,WACpBo5G,GAAU,EACVnzD,GAAGgJ,IAAIgqD,EAAgB,CACnBplD,UAAW,sCAEhB,OAEP+E,EAAM4gD,YAAc,WAChBvzD,GAAGgJ,IAAIgqD,EAAgB,CACnBplD,UAAW,oCAEfulD,GAAU,EACVjmE,aAAakmE,IAEjBzgD,EAAM6gD,WAAa,WACfxzD,GAAGgJ,IAAIgqD,EAAgB,CACnBplD,UAAW,oCAEfulD,GAAU,EACVjmE,aAAakmE,IAGjBzmD,GAAM,CACFtqE,OAAQiZ,EACRmd,QAAS,oBACTplB,IAAKy/G,EACL9iE,QAAS,CAAC,SACVrvB,SAAU,SAAU7kC,GAChBirC,GAAS,+BClHWzrB,EAAQwpG,EAAY2O,EAAcv9E,EAAQw9E,GACtE,MAAMrgH,EAAMhhB,SAASC,cAAc,OAC7BypF,EAAUhoF,OAAO28E,WAAa,KAAO38E,OAAO48E,YAAc,IAEhE,IAAIgjD,EAAa3zD,GAAG1+D,GAAG,CACnB0H,QAAS0jE,GAAK,qBACd1D,IAAK,CACDuS,UAAW,YAGnBloE,EAAIxgB,YAAY8gI,GAGhB,IAAIC,EAAW,IAAIz3C,GAAS,CACxBp2B,MAAOg2B,EAAU,IAAM,IACvB/1B,OAAQ+1B,EAAU,IAAM,IACxBj1B,OAAQg+D,aAUH+O,IACL,MAAMC,EAASF,EAASn1C,kBAAkB9kB,UAAU,aACpD5/C,YAAUxnB,iBACN,IACI,MAAM2Q,QAAa83C,MAAM84E,GACnBxxD,QAAap/D,EAAKo/D,aACjBpc,UAAU6tE,UAAkB3qH,MAAM,CACrC,IAAI4qH,cAAc,EACb1xD,EAAK9vE,MAAO8vE,MAGrBvoD,YAAW,WACPm8B,EAAOqyE,IAAI77C,GAAK,oBAAoB,KACrC,KACL,MAAO/7E,GACL4rB,QAAQjoB,MAAM3D,EAAI8K,KAAM9K,EAAI8nC,YAEjC,GAzBPunC,GAAGgJ,IAAI4qD,EAASj5C,QAAS,CACrB9L,UAAW,OACXC,WAAY,QACZ8d,UAAW,iBACXC,aAAc,mBAElBx5E,EAAIxgB,YAAY+gI,EAASj5C,SAsBzB,IASIjL,EATA3kB,EAAc,IAAIiV,GAAGmO,YAAY,CACjCrE,OAAQ,SAAS3hB,EAAQ8rE,EAAU7lD,GACd,WAAbA,IACAylD,IACAnkD,iBAMHhlB,IACLglB,IAEJ1P,GAAGpmD,iBAAiB7lB,OAAQ,OAAQ22D,GACpCiiB,GAAM,CACFtqE,OAAQiZ,EACRmd,QAAS,OAASi7F,EAAQ,GAAMhnD,GAAK,4BAA4BA,GAAK,yBAAqB,GAASA,GAAK,0BAA4B,OACrIr5D,IAAKA,EACLxJ,MAAOkyE,EAAU,GAAK,CAClBh2B,MAAO,SAEXiK,QAAS0jE,EAAW,CAAChnD,GAAK,qBAAsBA,GAAK,qBAAsB,UAAY,CAACA,GAAK,qBAAsB,UACnH2C,UAAW,CAAC3C,GAAK,sBACjB/rC,SAAU,SAAU7kC,GAChB,GAAIA,IAAW4wE,GAAK,qBAChBmnD,SACG,GAAI/3H,IAAW4wE,GAAK,qBAAsB,CAC7C,IAAIwnD,EAAUN,EAASp1C,UACvBi1C,EAAa,CACT1kH,KAAMnd,KAAK4jC,OAAO0+F,EAAQ5hH,GAC1BtD,MAAOpd,KAAK4jC,MAAM0+F,EAAQ5hH,EAAI4hH,EAAQnuE,MAAQ++D,EAAW/+D,OACzDyB,IAAK51D,KAAK4jC,OAAO0+F,EAAQ3hH,GACzBs6D,OAAQj7E,KAAK4jC,MAAM0+F,EAAQ3hH,EAAI2hH,EAAQluE,OAAS8+D,EAAW9+D,UAGnEga,GAAGjY,oBAAoBh0D,OAAQ,OAAQ22D,GACvCkpE,EAASpgE,UACTzI,EAAYyI,WAEhBic,aAAc/C,GAAK,qBACnBgD,UAAW,SAAUl2E,GACjBk2E,EAAYl2E,uCC9FpBkgD,GAWA,IAAIrmC,EAAMhhB,SAASC,cAAc,OAEjC,GADA0tE,GAAGm0D,cAAc9gH,EAAKq5D,GAAK,gCACvBhzB,EAAOo/D,SAAShE,sBAAuB,CACvC,IAAIsf,EAASp0D,GAAG1+D,GAAG,CACf0H,QAAS0jE,GAAK,iCACd1D,IAAK,CACD2E,WAAY,OACZwE,QAAS,OACTtD,UAAW,MACXd,aAAc,MACdgG,OAAQ,oBACR1D,aAAc,SAGtBh9D,EAAIxgB,YAAYuhI,GAEpB,IAAIr4C,EAAUhoF,OAAO28E,WAAa,IAE9B/B,EAAc3O,GAAG1+D,GAAG,CACpB0nE,IAAK,CACDl/D,QAAS,UAGbuqH,EAAkBr0D,GAAG1+D,GAAG,CACxBwhE,QAAS,SACT95D,QAAS,MACTggE,IAAK,CACDgF,YAAa,QAEjB9E,QAAS,WACLorD,EAAoBh2C,WAGxBi2C,EAAav0D,GAAG1+D,GAAG,CACnBwhE,QAAS,SACT95D,QAAS0jE,GAAK,uBACd1D,IAAK,CACDgF,YAAa,QAEjB9E,QAAS,WACLorD,EAAoBxoC,qBAGxB0oC,EAAYx0D,GAAG1+D,GAAG,CAClBwhE,QAAS,SACT95D,QAAS0jE,GAAK,UACd1D,IAAK,CACDgF,YAAa,QAEjB9E,QAAS,WACLorD,EAAoBtoC,wBAG5Brd,EAAY97E,YAAYwhI,GACxB1lD,EAAY97E,YAAY0hI,GACxB5lD,EAAY97E,YAAY2hI,GACxBnhH,EAAIxgB,YAAY87E,GAIhB,IAAI8U,EAA0B,GAC9B,CACI,IAAIgxC,EAAmB/6E,EAAOo/D,SAAS1D,YACvC,IAAK,IAAIplH,EAAI,EAAGA,EAAIykI,EAAiBxkI,OAAQD,IACzCyzF,EAAOppF,KAAK,CACRs4E,MAAO8hD,EAAiBzkI,GAAGwsG,QAAQ11C,OACnCgtB,QAAS2gD,EAAiBzkI,GAAG8jF,QAC7B4P,WAAY+wC,EAAiBzkI,GAAG0zF,aAI5CD,EAAOppF,KAAK,CACRs4E,MAAOj5B,EAAOg7E,YACd5gD,QAAS,EACT4P,WAAY,gBAIhB,IAAI4wC,EAAsB,IAAIvpC,GAAoB,CAC9CvW,aAAcuH,EAAU,IAAM,IAC9BtH,cAAesH,EAAU,IAAM,IAC/BkP,WAAYvxC,EAAOo/D,SAAS5C,gBAAgB,GAAGpvD,OAAOf,MACtDmlC,YAAaxxC,EAAOo/D,SAAS5C,gBAAgB,GAAGpvD,OAAOd,OACvDy9B,OAAQA,EACRiI,eAAgBjI,EAAOxzF,OAAS,aAQ3Bm5F,EAAK92E,EAAGC,GACb+hH,EAAoBlrC,KAAK92E,EAAGC,GAPhCytD,GAAGgJ,IAAIsrD,EAAoBnjD,aAAc,CACrCtC,UAAW,OACXC,WAAY,UAEhBz7D,EAAIxgB,YAAYyhI,EAAoBnjD,cAMpC,IAAIpmB,EAAc,IAAIiV,GAAGmO,YAAY,CACjCrE,OAAQ,SAAS3hB,GACE,SAAXA,GACAihC,GAAK,EAAI,GAEE,UAAXjhC,GACAihC,EAAK,EAAG,GAEG,OAAXjhC,GACAihC,EAAK,GAAG,GAEG,SAAXjhC,GACAihC,EAAK,EAAG,MAKpBzc,GAAM,CACFtqE,OAAQq3C,EAAOr3C,OACfo2B,QAAO,MAAQi0C,GAAK,+BACpBr5D,IAAKA,EACLxJ,MAAOkyE,EAAU,KAAO,CACpBh2B,MAAO,SAEXiK,QAAS,CAAC,KAAM,UAChByf,aAAc,KACd9uC,SAAU,SAASg0F,GACf5pE,EAAYyI,UACZ8gE,EAAoB9gE,UACpBwM,GAAGiP,UAAUolD,GACbr0D,GAAGiP,UAAUslD,GACbv0D,GAAGiP,UAAUulD,GACK,OAAdG,EACAj7E,EAAO/Y,SAAS2zF,EAAoBroC,oBAAqBqoC,EAAoBpoC,kBAE7ExyC,EAAO/Y,uCCjIQgtB,GAE3B,IAAIinE,EAAejnE,EAAEinE,aACjBC,EAAiBlnE,EAAEknE,eACnBC,EAAgBnnE,EAAEmnE,cAClBC,EAAcpnE,EAAEonE,YAChBC,EAAernE,EAAEqnE,aACjBC,EAAiBtnE,EAAEsnE,eACnBC,EAAkBvnE,EAAEunE,gBACpBC,EAAYxnE,EAAEwnE,UACdC,EAAWznE,EAAEynE,kBAGRC,EAAgBC,EAAQC,EAAQxvE,EAAOC,EAAQmsB,GACpD,OAAOnS,GAAGod,QAAQk4C,EAAQC,EAAQ3jI,KAAK+O,IAAIm0H,EAAe/uE,EAAQosB,GAAUvgF,KAAK+O,IAAIm0H,EAAe9uE,EAASmsB,GAAU,GAG3H,IAAIqjD,EAAWnjI,SAASC,cAAc,OAClCmjI,EAAepjI,SAASC,cAAc,OACtCojI,EAAgBrjI,SAASC,cAAc,OACvCqjI,EAAatjI,SAASC,cAAc,SACpCsjI,EAAYvjI,SAASC,cAAc,OACnCujI,EAAcxjI,SAASC,cAAc,SACrCwjI,EAAazjI,SAASC,cAAc,OACxCmjI,EAAa5rH,MAAM2b,SAAW,WAC9BiwG,EAAa5rH,MAAMk8C,MAAQ,QAC3B0vE,EAAa5rH,MAAMm8C,OAAS,OAC5ByvE,EAAa5rH,MAAM6jE,WAAa,OAChCgoD,EAAc7rH,MAAMk8C,MAAQ,QAC5B2vE,EAAc7rH,MAAMm8C,OAAS,OAC7B0vE,EAAc7rH,MAAM6jE,WAAa,OAEjCkoD,EAAUvyC,UAAY3W,GAAK,UAC3BkpD,EAAU/rH,MAAMmtE,MAAQ,OACxB4+C,EAAU/rH,MAAMqoE,SAAW,OAC3B0jD,EAAU/rH,MAAMilE,WAAa,MAC7B8mD,EAAU/rH,MAAM2pE,SAAW,QAE3BsiD,EAAWzyC,UAAY3W,GAAK,UAC5BopD,EAAWjsH,MAAMmtE,MAAQ,OACzB8+C,EAAWjsH,MAAMqoE,SAAW,OAC5B4jD,EAAWjsH,MAAMilE,WAAa,MAC9BgnD,EAAWjsH,MAAM2pE,SAAW,QAE5BmiD,EAAWl2D,aAAa,oBAAqB,QAC7Co2D,EAAYp2D,aAAa,oBAAqB,QAE9Ck2D,EAAWnjI,KAAO,SAClBmjI,EAAWh1H,IAAM,IACjBg1H,EAAWl1H,IAAMq0H,EACjBa,EAAW9rH,MAAM2pE,SAAW,QAC5BmiD,EAAW9rH,MAAMk8C,MAAQ,OAEzB8vE,EAAYrjI,KAAO,SACnBqjI,EAAYl1H,IAAM,IAClBk1H,EAAYp1H,IAAMq0H,EAClBe,EAAYhsH,MAAM2pE,SAAW,QAC7BqiD,EAAYhsH,MAAMk8C,MAAQ,OAC1B4vE,EAAWjlI,MAAQqkI,EACnBc,EAAYnlI,MAAQskI,EACpBW,EAAWnnD,QAAU,WAChBv6E,KAAaqrE,QACdy2D,KAEJF,EAAYrnD,QAAU,WACjBv6E,KAAaqrE,QACdy2D,KAEJN,EAAa5iI,YAAY+iI,GACzBH,EAAa5iI,YAAY8iI,GACzB31D,GAAGm0D,cAAcsB,EAAc/oD,GAAK,SAAW,MAC/CgpD,EAAc7iI,YAAYijI,GAC1BJ,EAAc7iI,YAAYgjI,GAC1B71D,GAAGm0D,cAAcuB,EAAehpD,GAAK,UAAY,MACjD,IAAIspD,EAAe3jI,SAASC,cAAc,OAC1C0jI,EAAansH,MAAMglE,UAAY,MAC/BmnD,EAAansH,MAAMmtE,MAAQ,OAE3B,IAAIi/C,EAAkB5jI,SAASC,cAAc,OAEzC4jI,EAAe7jI,SAASC,cAAc,UAC1C2jI,EAAgBpsH,MAAMkkE,aAAe,OACrC,IAAIooD,EAAmB9jI,SAASC,cAAc,UAC1C8jI,EAAkB/jI,SAASC,cAAc,UACzC+jI,EAAqBhkI,SAASC,cAAc,UAC5CgkI,EAAoBjkI,SAASC,cAAc,UAC3CikI,EAAoBlkI,SAASC,cAAc,UAE/C6jI,EAAiBzjI,YAAcg6E,GAAK,eACpCwpD,EAAaxjI,YAAcg6E,GAAK,WAChC6pD,EAAkB7jI,YAAcg6E,GAAK,gBACrC2pD,EAAmB3jI,YAAcg6E,GAAK,iBACtC4pD,EAAkB5jI,YAAcg6E,GAAK,gBACrC0pD,EAAgB1jI,YAAcg6E,GAAK,cAEnCypD,EAAiBtsH,MAAMmkE,YAAc,MACrCkoD,EAAarsH,MAAMmkE,YAAc,MACjCuoD,EAAkB1sH,MAAMmkE,YAAc,MACtCqoD,EAAmBxsH,MAAMglE,UAAY,MACrCwnD,EAAmBxsH,MAAMmkE,YAAc,MACvCsoD,EAAkBzsH,MAAMglE,UAAY,MACpCynD,EAAkBzsH,MAAMmkE,YAAc,MAEtCioD,EAAgBpjI,YAAYsjI,GAC5BF,EAAgBpjI,YAAYqjI,GAC5BD,EAAgBpjI,YAAY0jI,GAC5BN,EAAgBpjI,YAAYujI,GAC5BH,EAAgBpjI,YAAYwjI,GAC5BJ,EAAgBpjI,YAAYyjI,GAI5BH,EAAiB3nD,QAAU,WACvBmnD,EAAWjlI,MAAQqkI,EACnBc,EAAYnlI,MAAQskI,EACpBe,KAEJG,EAAa1nD,QAAU,WACnBmnD,EAAWjlI,MAAQukI,EACnBY,EAAYnlI,MAAQwkI,EACpBa,KAEJQ,EAAkB/nD,QAAU,WACxBmnD,EAAWjlI,MAAQukI,EAAiB,IACpCY,EAAYnlI,MAAQwkI,EAAkB,IACtCa,KAEJK,EAAgB5nD,QAAU,WACtB,IAAIy9C,EAAUoJ,EAAgB,EAAG,EAAGJ,EAAgBC,EAlBlC,IAmBlBS,EAAWjlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQlmE,OAC3C8vE,EAAYnlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQjmE,QAC5C+vE,KAEJM,EAAmB7nD,QAAU,WACzB,IAAIy9C,EAAUoJ,EAAgB,EAAG,EAAGJ,EAAgBC,EAxBlC,IAyBlBS,EAAWjlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQlmE,OAC3C8vE,EAAYnlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQjmE,QAC5C+vE,KAEJO,EAAkB9nD,QAAU,WACxB,IAAIy9C,EAAUoJ,EAAgB,EAAG,EAAGJ,EAAgBC,EA9BlC,IA+BlBS,EAAWjlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQlmE,OAC3C8vE,EAAYnlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQjmE,QAC5C+vE,KAGJ,IAAI7iD,EAAS,IAAIvB,GAAO,CACpBU,aAAa,EACbN,UAAW,CACP,CAAC,SAAUrF,GAAK,eAChB,CAAC,OAAQA,GAAK,aAAe,SAC7B,CAAC,MAAO,OACR,CAAC,MAAO,OACR,CAAC,MAAO,OACR,CAAC,QAASA,GAAK,iBAAmB,SAChC,CAAD,OAAQ,QACT,CAAC,MAAO,OACR,CAAC,MAAO,OACR,CAAC,MAAO,OACR,CAAC,uBAAwB,SAE7BvD,SAAU,SAAStvE,GACf,GAAY,WAARA,EACA87H,EAAWjlI,MAAQ,GAAKqD,OAAOowF,OAAOp+B,MACtC8vE,EAAYnlI,MAAQ,GAAKqD,OAAOowF,OAAOn+B,YACpC,GAAY,UAARnsD,EAAiB,CACxB,IAAIoyH,EAAUoJ,EAAgBzjI,KAAKkhB,KAAK,GAAI,EAAGmiH,EAAgBC,EAxDrD,IAyDVS,EAAWjlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQlmE,OAC3C8vE,EAAYnlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQjmE,YACzC,CACH,IAAItvD,EAAQmD,EAAInD,MAAM,KAClBu1H,EAAUoJ,EAAgBt9C,WAAWrhF,EAAM,IAAKqhF,WAAWrhF,EAAM,IAAKu+H,EAAgBC,EA7DhF,IA8DVS,EAAWjlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQlmE,OAC3C8vE,EAAYnlI,MAAQ,GAAKkB,KAAK4jC,MAAMy2F,EAAQjmE,QAEhD+vE,IACA7iD,EAAOtB,SAAS,SAGxB73D,YAAU,KAENm5D,EAAOtB,SAAS,QACjB,GACH5R,GAAGgJ,IAAIkK,EAAO/B,aAAc,CACxBprB,MAAO,SAEXkwE,EAAgBpjI,YAAYqgF,EAAO/B,cAInC,IAAIqlD,EAAiB,CAAC/1G,EAAG,IAAKioC,EAAG,IAAKz2C,EAAG,IAAK5V,EAAG,GAE7Co6H,EAAkB,CAClB,CAACh2G,EAAG,IAAKioC,EAAG,IAAKz2C,EAAG,IAAK5V,EAAG,GAC5B,CAACokB,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GACtB,CAACokB,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,IAE1Bo6H,EAAgBp8H,KAAK,CACjBomB,EAAGm0G,EAAan0G,EAChBioC,EAAGksE,EAAalsE,EAChBz2C,EAAG2iH,EAAa3iH,EAChB5V,EAAG,IAEPo6H,EAAgBp8H,KAAK,CACjBomB,EAAGo0G,EAAep0G,EAClBioC,EAAGmsE,EAAensE,EAClBz2C,EAAG4iH,EAAe5iH,EAClB5V,EAAG,IAGP,IAAIq6H,EAAe,IAAI77C,GAAa,CAChCE,SAAU07C,EACVttD,SAAU,SAASpK,GACfy3D,EAAiBz3D,EACjB43D,EAAQ9sH,MAAMgqE,gBAAkB,QAAU9U,EAAQt+C,EAAI,IAAMs+C,EAAQrW,EAAI,IAAMqW,EAAQ9sD,EAAI,KAAO8sD,EAAQ1iE,EAAI,OAIjH6gF,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBvJ,UAAW,aACX5tB,MAAO,QACPC,OAAQ,QACRl8C,QAAS,QACT+pE,gBAAiB,UACjB1B,QAAS,OACTtD,UAAW,OACXjB,UAAW,sEACXkB,WAAY,QACZsD,YAAa,eAEjB,IAAIukD,EAAUtkI,SAASC,cAAc,OACrC0tE,GAAGgJ,IAAI2tD,EAAS,CACZ5wE,MAAO,QACPC,OAAQ,QACR6tB,gBAAiB,OACjB/E,WAAY,OACZd,YAAa,OACbgJ,MAAO,OACP9E,SAAU,OACV0Q,WAAY,OACZrH,UAAW,SACX4sC,cAAe,SACfr+G,QAAS,QACTgjE,SAAU,SACVc,UAAW,gCAEf,IAAIgpD,EAAcvkI,SAASC,cAAc,OACzCskI,EAAY/sH,MAAMC,QAAU,aAC5B8sH,EAAY/sH,MAAMs+G,cAAgB,SAClCyO,EAAY/jI,YAAY8jI,GACxBz5C,EAAerqF,YAAY+jI,GAC3B,IAAI11B,EAAOlhC,GAAGm0D,cAAcwC,EAAS,IAErCz1B,EAAKr3F,MAAMC,QAAU,aACrBo3F,EAAKr3F,MAAMs+G,cAAgB,SAC3B,IAAI0O,EAAQ/xF,SAAS6wF,EAAWjlI,OAC5BomI,EAAQhyF,SAAS+wF,EAAYnlI,gBAExBqlI,IACLJ,EAAWjlI,MAAQ,GAAKkB,KAAK+O,IAAIm0H,EAAehwF,SAAS6wF,EAAWjlI,QACpEmlI,EAAYnlI,MAAQ,GAAKkB,KAAK+O,IAAIm0H,EAAehwF,SAAS+wF,EAAYnlI,QAYtE,IAAIm1D,EAAI/gB,SAAS6wF,EAAWjlI,OACxBo1D,EAAIhhB,SAAS+wF,EAAYnlI,QACzBm1D,EAAI,GAAKA,EAAIivE,GAAiBhvE,EAAI,GAAKA,EAAIgvE,KACvCjvE,EAAIivE,EACJjvE,EAAIivE,EACChvE,EAAIgvE,IACThvE,EAAIgvE,GAERa,EAAWjlI,MAAQ,GAAKm1D,EACxBgwE,EAAYnlI,MAAQ,GAAKo1D,GAI7B,IAAIixE,EAAe,CACf,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,GAAI,GAAI,CAAC,EAAG,IACb,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,MAAO,GAAI,CAAC,EAAG,QAEhBC,EAAah3D,GAAG3wD,OAAOw2C,EAAGC,GAC1BmxE,EAAe,KACfC,EAAkB,KACtB,IAAK,IAAIlnI,EAAI,EAAGA,EAAI+mI,EAAa9mI,OAAQD,KAC3B,IAANA,GAAW4B,KAAKghB,IAAImkH,EAAa/mI,GAAG,GAAK+mI,EAAa/mI,GAAG,GAAKgnI,EAAW,GAAKA,EAAW,IAAME,KAC/FD,EAAeF,EAAa/mI,GAC5BknI,EAAkBtlI,KAAKghB,IAAImkH,EAAa/mI,GAAG,GAAK+mI,EAAa/mI,GAAG,GAAKgnI,EAAW,GAAKA,EAAW,KAKpGhB,EAAa3yC,UADb6zC,EAAkB,GAAKA,EAAkB,KAChBxqD,GAAK,aAAe,MAAQuqD,EAAa,GAAK,IAAMA,EAAa,GAEjEvqD,GAAK,aAAe,KAAOsqD,EAAW,GAAK,IAAMA,EAAW,GAGzFH,EAAQhxE,EACRixE,EAAQhxE,EACR,IAAIqxE,EAAQtxE,EACRvR,WArDShR,EAAGtxB,GACZ,IAAIolH,EAAI9zF,EAAG/tC,EAAIyc,SACF,CACT,KAAMolH,GAAK7hI,GACP,OAAOA,EACX,KAAMA,GAAK6hI,GACP,OAAOA,GA+CXC,CAAIxxE,EAAGC,GACfD,GAAKvR,EACLwR,GAAKxR,EACLuR,GAAK,IACLC,GAAK,IACDD,EAAI,MACJC,GAAI,IAAMD,EACVA,EAAI,KAEJC,EAAI,MACJD,GAAI,IAAMC,EACVA,EAAI,KAIR6wE,EAAQ9sH,MAAMk8C,MAAQF,EAAI,KAC1B8wE,EAAQ9sH,MAAMm8C,OAASF,EAAI,KAC3Bka,GAAGkb,qBAAqBp2C,SAAS,GAAY+gB,EAAIsxE,EAAV,KAAoB,SAAU3mI,GACjE0sF,EAAerzE,MAAM8jE,WAAa,OAASn9E,EAAM,OAIzDmlI,EAAWvkD,SAAW,YACO,KAArBukD,EAAWjlI,OAAgBo0C,SAAS6wF,EAAWjlI,OAAS,KACxDilI,EAAWjlI,MAAQ,KAEvBqlI,KAEJJ,EAAW2B,QAAU,WACjBvB,KAEJF,EAAYzkD,SAAW,YACO,KAAtBykD,EAAYnlI,OAAgBqnF,WAAW89C,EAAYnlI,OAAS,KAC5DmlI,EAAYnlI,MAAQ,KAExBqlI,KAEJF,EAAYyB,QAAU,WAClBvB,KAEJA,IAEAP,EAAS3iI,YAAYojI,GACrB,IAAIsB,EAAYv3D,GAAG1+D,GAAG,CAClBga,OAAQk6G,EACRxsD,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,cAGhBoqD,EAAgBx3D,GAAG1+D,GAAG,CACtBga,OAAQi8G,IAEZC,EAAc3kI,YAAY4iI,GAC1B+B,EAAc3kI,YAAY6iI,GAC1B8B,EAAc3kI,YAAYmjI,GAC1BuB,EAAU1kI,YAAY6jI,EAAavlD,cAEnCqkD,EAAS3iI,YAAYqqF,GAErBvQ,GAAM,CACFtqE,OAAQhQ,SAAS0oD,KACjBtiB,QAAO,MAAQi0C,GAAK,mBACpBr5D,IAAKmiH,EACLxlE,QAAS,CAAC,KAAM,UAChBrvB,SAAU,SAAU7kC,GAChB65H,EAAWnnD,QAAU,KACrBqnD,EAAYrnD,QAAU,KACtB2nD,EAAiB3nD,QAAU,KAC3B0nD,EAAa1nD,QAAU,KACvB+nD,EAAkB/nD,QAAU,KAC5B4nD,EAAgB5nD,QAAU,KAC1B6nD,EAAmB7nD,QAAU,KAC7B8nD,EAAkB9nD,QAAU,KAC5BmnD,EAAWvkD,SAAW,KACtBukD,EAAW2B,QAAU,KACrBzB,EAAYzkD,SAAW,KACvBykD,EAAYyB,QAAU,KACtBpkD,EAAO1f,UACPkjE,EAAaljE,UAEE,WAAX13D,GAAuBgpC,SAAS6wF,EAAWjlI,QAAU,GAAKo0C,SAAS+wF,EAAYnlI,QAAU,GAAK+zE,MAAM3/B,SAAS6wF,EAAWjlI,SAAW+zE,MAAM3/B,SAAS+wF,EAAYnlI,QAC9J0kI,IAGJD,EAAUrwF,SAAS6wF,EAAWjlI,OAAQo0C,SAAS+wF,EAAYnlI,OAAQ8lI,IAEvE/mD,aAAc,gCC5XlB9hB,GAkBA,IAAIt6C,EAAM2sD,GAAG1+D,GAAG,IAEZm2H,EAAe1jI,OAAO28E,WAAa,IACnCgnD,EAAgB3jI,OAAO48E,YAAc,IASrC5qB,EAAQ0xE,EAAe,IAAM,IAC7BzxE,EAASyxE,EAAgBC,EAAgB,IAAM,IAAQA,EAAgB,IAAM,IAC7El2F,EAAQ,EAER26E,EAAWxuD,EAAEmrD,SAAShB,gBACtB6f,EAAa33D,GAAGlZ,OAAO6G,EAAEmrD,SAAS/D,WAAYpnD,EAAEmrD,SAAS9D,aACzD4iB,EAAUD,EAAW5wE,WAAW,MAChC8wE,EAAe73D,GAAGlZ,OAAOf,EAAOC,GAChCsxD,EAAYugB,EAAa9wE,WAAW,MACpC+wE,EAAe93D,GAAGlZ,OAAOf,EAAOC,GAChC+xE,EAAYD,EAAa/wE,WAAW,MACpCixE,EAAgBh4D,GAAGlZ,OAAOf,EAAOC,GACjCiyE,EAAaD,EAAcjxE,WAAW,MAC1CiZ,GAAGgJ,IAAIgvD,EAAe,CAClBluH,QAAS,UAEb,IAAIozE,EAAiBld,GAAG1+D,GAAG,CACvBga,OAAQjI,EACR21D,IAAK,CACDxjD,SAAU,WACVugC,MAAOA,EAAQ,KACf+oB,WAAY,QACZmD,OAAQ,OACRG,YAAa,aACb8lD,YAAa,QAEjBhvD,QAAS,WACLivD,EAAU74D,WAGlBU,GAAG1+D,GAAG,CACFga,OAAQ4hE,EACRlU,IAAK,CACDxjD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLx4C,MAAO,IACP69D,OAAQ,IACRe,UAAW,sEACX6H,cAAe,UAGvByH,EAAerqF,YAAYmlI,GAC3B,IAAII,EAAiBH,EAAWzxB,cAAcxmC,GAAG2vC,oBAAoB,GAAI,UACrEuM,EAAcl8C,GAAGlZ,OAAO,EAAG,YAMtB0kC,IAKLosC,EAAQnxC,UAAU,EAAG,EAAGkxC,EAAW5xE,MAAO4xE,EAAW3xE,QACrD,IAAIqyE,EAAY,IACT1qE,EAAEqpB,MACL36E,EAAGquG,EAAcz5B,YAEjBziB,EAAS8zB,GAAWq1C,EAAY,CAChCrlH,EAAGq7C,EAAEr7C,EACLC,EAAGo7C,EAAEp7C,EACLgwE,QAAS41C,EAAUznI,MACnB+xF,MAAO61C,EAAernD,WACtB8R,SAAUw1C,EAAatnD,WACvB4R,OAAQ21C,EAAWvnD,WACnBxrD,KAAMsyD,WAAW0gD,EAAU/nI,OAC3BiyF,KAAM+1C,EAAWznD,WACjB+F,MAAOhX,GAAGkX,eAAepY,UAAUu5D,GACnCnhE,SAAUvJ,EAAEuJ,WAMhB1I,EAAOzI,MAAQn0D,KAAK6O,IAAI+tD,EAAOzI,MAAO,GACtCyI,EAAOxI,OAASp0D,KAAK6O,IAAI+tD,EAAOxI,OAAQ,GACxC,IAAI2yE,EAAY34D,GAAGsG,OAAO9X,EAAOl8C,EAAGk8C,EAAOj8C,GAAIo7C,EAAEuJ,SAAWtlE,KAAKuvC,GAAK,KAClEy3F,EAAY54D,GAAGsG,OAAO9X,EAAOzI,MAAOyI,EAAOxI,QAAS2H,EAAEuJ,SAAWtlE,KAAKuvC,GAAK,KAC3Em5E,EAAU3sD,EAAEr7C,EAAIqmH,EAAUrmH,EAAIsmH,EAAUtmH,EAAI,EAC5CioG,EAAU5sD,EAAEp7C,EAAIomH,EAAUpmH,EAAIqmH,EAAUrmH,EAAI,EAG5CsmH,EAAY74D,GAAGod,QAAQ5uB,EAAOzI,MAAOyI,EAAOxI,OAAQD,EAD1C,IAC2DC,EAD3D,KAEdxkB,EAAQ5vC,KAAK+O,IAAI,EAAGk4H,EAAU9yE,MAAQyI,EAAOzI,OAC7CvkB,EAAQ5vC,KAAK+O,IAAI,EAAG6gC,EAAQ5vC,KAAK67B,IAAI,EAAGqrG,IAIxCxhB,EAAUpxC,OAEN1kC,GAAS,EACT81E,EAAUnxC,uBAAwB,GAElCmxC,EAAUnxC,uBAAwB,EAClCmxC,EAAUlxC,sBAAyB5kC,GAAS,EAAI,MAAQ,UAG5D81E,EAAU7wB,UAAU,EAAG,EAAGuxC,EAAcjyE,MAAOiyE,EAAchyE,QAC7DsxD,EAAUjxC,UAAUtgB,EAAQ,EAAGC,EAAS,GACxCsxD,EAAU91E,MAAMA,EAAOA,GACvB81E,EAAUhxC,OAAO3Y,EAAEuJ,UACnBogD,EAAU7xC,UAAU02C,EAASxuD,EAAEipD,YAAY9vD,QAASwzD,GAAUC,GAC9DjD,EAAU7xC,UAAUkyD,GAAard,GAAUC,GAC3CjD,EAAU/wC,UAIVwxD,EAAU7xD,OAEV6xD,EAAUx+D,UAAY,mBACtBw+D,EAAUv+D,SAAS,EAAG,EAAGzT,EAAOC,GAEhC,CACI+xE,EAAU7xD,OAEV6xD,EAAU1xD,UAAUtgB,EAAQ,EAAGC,EAAS,GACxC+xE,EAAUv2F,MAAMA,EAAOA,GACvBu2F,EAAUzxD,OAAO3Y,EAAEuJ,UAEnB6gE,EAAU5xD,uBAAwB,EAGlC,IAAI81C,EAAa,EAAIz6E,EACrBu2F,EAAU13C,YAAc,GACxB03C,EAAUtyD,UAAUy2C,GAAc5B,EAAU2B,GAAa1B,EAAU0B,EAAY0b,EAAW5xE,MAAqB,EAAbk2D,EAAgB0b,EAAW3xE,OAAsB,EAAbi2D,GACtI8b,EAAU13C,YAAc,EAGxB03C,EAAUjwD,yBAA2B,kBACrCiwD,EAAUtyD,UAAUy2C,GAAc5B,GAAUC,EAASod,EAAW5xE,MAAO4xE,EAAW3xE,QAElF+xE,EAAUxxD,UAKN/kC,GAAS,EACTu2F,EAAU5xD,uBAAwB,GAElC4xD,EAAU5xD,uBAAwB,EAClC4xD,EAAU3xD,sBAAyB5kC,GAAS,EAAI,MAAQ,UAI5Du2F,EAAU7xD,OACV6xD,EAAU1xD,UAAUtgB,EAAQ,EAAGC,EAAS,GACxC+xE,EAAUv2F,MAAMA,EAAOA,GACvBu2F,EAAUzxD,OAAO3Y,EAAEuJ,UACnB,IAAK,IAAIlnE,EAAI,EAAGA,EAAI29D,EAAEipD,WAAY5mH,IAC1BmsH,EAASnsH,GAAG8jF,QAAU,IACtBikD,EAAU13C,YAAc87B,EAASnsH,GAAG8jF,QACpCikD,EAAUjwD,yBAA2Bq0C,EAASnsH,GAAG0zF,WACjDq0C,EAAUtyD,UAAU02C,EAASnsH,GAAG82D,QAASwzD,GAAUC,IAG3Dwd,EAAUxxD,UAGVwxD,EAAU13C,YAAc87B,EAASxuD,EAAEipD,YAAY9iC,QAC/CikD,EAAUjwD,yBAA2Bq0C,EAASxuD,EAAEipD,YAAYlzB,WAC5Dq0C,EAAUtyD,UAAUoyD,EAAc,EAAG,GAGrCE,EAAU7xD,OACV6xD,EAAU1xD,UAAUtgB,EAAQ,EAAGC,EAAS,GACxC+xE,EAAUv2F,MAAMA,EAAOA,GACvBu2F,EAAUzxD,OAAO3Y,EAAEuJ,UACnB,IAAK,IAAIhN,EAAIyD,EAAEipD,WAAa,EAAG1sD,EAAIiyD,EAASlsH,OAAQi6D,IAC5CiyD,EAASjyD,GAAG4pB,QAAU,IACtBikD,EAAU13C,YAAc87B,EAASjyD,GAAG4pB,QACpCikD,EAAUjwD,yBAA2Bq0C,EAASjyD,GAAGw5B,WACjDq0C,EAAUtyD,UAAU02C,EAASjyD,GAAGpD,QAASwzD,GAAUC,IAG3Dwd,EAAUxxD,UAIdwxD,EAAUxxD,UAKV0xD,EAAW/xD,OACX+xD,EAAW1+D,UAAY6+D,EACvBH,EAAWz+D,SAAS,EAAG,EAAGw+D,EAAcjyE,MAAOiyE,EAAchyE,QAC7DiyE,EAAWxyD,UAAUqyD,EAAc,EAAG,GACtCG,EAAW1xD,UAGX0xD,EAAW/xD,OACX+xD,EAAWnwD,yBAA2B,aACtCmwD,EAAWx3C,YAAc,OACzBw3C,EAAW73C,UAAY,EAGvB63C,EAAW91C,WACPvwF,KAAK4jC,MAAMuwB,EAAQ,EAAKyI,EAAOzI,MAAQ,EAAKvkB,GAC5C5vC,KAAK4jC,MAAMwwB,EAAS,EAAKwI,EAAOxI,OAAS,EAAKxkB,GAC9C5vC,KAAK4jC,MAAMg5B,EAAOzI,MAAQvkB,GAC1B5vC,KAAK4jC,MAAMg5B,EAAOxI,OAASxkB,IAE/By2F,EAAW1xD,mBAIN6iB,EAAK92E,EAAGC,GACb,IAAIyuE,EAAUhhB,GAAGsG,OAAOh0D,EAAGC,GAAIo7C,EAAEuJ,SAAWtlE,KAAKuvC,GAAK,KACtDwsB,EAAEr7C,GAAK0uE,EAAQ1uE,EAAIkvB,EACnBmsB,EAAEp7C,GAAKyuE,EAAQzuE,EAAIivB,EACnBgqD,IAtKU0wB,EAAYn1D,WAAW,MAC7ByS,SAAS,EAAG,EAAG,EAAG,GAwK1B,IAAIu/D,EAAyB,IAAI/4D,GAAGsW,gBAAgB,CAChDj0E,OAAQ21H,EACRpgE,SAAU,EACV9J,UAAW,SAASn7D,GACD,gBAAXA,EAAEH,MAA0BG,EAAEs9D,SAC9Bt9D,EAAEw9D,sBACFi5B,GAAMz2F,EAAEy+D,IAAKz+D,EAAE0+D,MAGvBrD,QAAS,SAASr7D,GACdqmI,GAAermI,EAAEi6D,WAIzB,MAAM2hB,EAAgBt1D,IAClBA,EAAM4xC,kBAEVmV,GAAGpmD,iBAAiBo+G,EAAe,QAASzpD,GAI5C,IAAInU,EAAO4F,GAAG1+D,GAAG,CACbga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,SACZyB,UAAW,UAGfoqD,EAAgBj5D,GAAG1+D,GAAG,CACtBga,OAAQjI,EACR21D,IAAKyuD,EAAe,GAAK,CACrB3tH,QAAS,OACTsjE,WAAY,SACZD,eAAgB,mBAGpB9S,EAAO2F,GAAG1+D,GAAG,CACbga,OAAQ29G,EACRjwD,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZyB,UAAW,SAGfvU,EAAO0F,GAAG1+D,GAAG,CACbga,OAAQ29G,EACRjwD,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZD,eAAgB,gBAChB0B,UAAW,MACX9oB,MAAO0xE,EAAe,GAAK,WAQ/BhB,EAAkB,CAClB,CAACh2G,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GACtB,CAACokB,EAAG,IAAKioC,EAAG,IAAKz2C,EAAG,IAAK5V,EAAG,IAEhCo6H,EAAgB95E,QAAQ,CACpBl8B,EAAGktC,EAAEknE,eAAep0G,EACpBioC,EAAGiF,EAAEknE,eAAensE,EACpBz2C,EAAG07C,EAAEknE,eAAe5iH,EACpB5V,EAAG,IAEPo6H,EAAgB95E,QAAQ,CACpBl8B,EAAGktC,EAAEqpB,MAAMv2D,EACXioC,EAAGiF,EAAEqpB,MAAMtuB,EACXz2C,EAAG07C,EAAEqpB,MAAM/kE,EACX5V,EAAG,IAGP,IAAIq6H,EAAe,IAAI77C,GAAa,CAChCE,SAAU07C,EACVr7C,aAAc,EACdjS,SAAU,SAASpK,GACfpR,EAAEqpB,MAAQjY,EACVysB,OAGRkrC,EAAavlD,aAAaxO,MAAQ+J,GAAK,cACvCgqD,EAAavlD,aAAatnE,MAAMilE,WAAa,OAC7C1U,EAAKvnE,YAAY6jI,EAAavlD,cAG9B,IAAI2nD,EAAU,WACLE,EAAc5uE,GACnB0uE,EAAUlnI,KAAK+O,IAAI,EAAG/O,KAAK6O,KAAI,EAAIq4H,EAAU1uE,IAC7CohC,IACA0tC,EAAU7pB,UAAY8pB,EAAQ,GAC9BC,EAAW/pB,UAAY8pB,GAAQ,YAE1BA,EAAQ/uE,GACb,OAAO0uE,IAAYlnI,KAAK+O,IAAI,EAAG/O,KAAK6O,KAAI,EAAIq4H,EAAU1uE,IAG1D,IA8DIivE,EACAX,EACAY,EAhEAC,EAAcv5D,GAAG1+D,GAAG,CACpBga,OAAQ8+C,EACR4O,IAAK,KAKLkwD,EAAYl5D,GAAG1+D,GAAG,CAClBga,OAAQi+G,EACRvwH,QAAO,yBAA2B6iE,EAAA4kB,QAClC9tB,MAAO+J,GAAK,WACZ5J,QAAS,SACToG,QAAS,WACL8vD,EAAc,IAElBhwD,IAAK,CACD4Z,WAAY,UAGhBw2C,EAAap5D,GAAG1+D,GAAG,CACnBga,OAAQi+G,EACRvwH,QAAO,yBAA2B6iE,EAAA6kB,QAClC/tB,MAAO+J,GAAK,YACZ5J,QAAS,SACToG,QAAS,WACL8vD,GAAc,IAElBhwD,IAAK,CACD4Z,WAAY,OACZ9T,WAAY,SAOhB2pD,EAAYz4D,GAAG1+D,GAAG,CAClBga,OAAQ++C,EACRyI,QAAS,QACTH,MAAO+J,GAAK,aACZvb,OAAQ,CACJ3+D,KAAM,SACNmO,IAAK,EACLF,IAAK,IACL/P,MAAOi9D,EAAEloC,MAEbujD,IAAK,CACDjjB,MAAO,QAEXojB,SAAU,WACNsvD,EAAU/nI,MAAQ,GAAKkB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAOmkC,SAAS2zF,EAAU/nI,SACtE86F,OAGJguC,EAAsB,IAAIx5D,GAAGsW,gBAAgB,CAC7Cj0E,OAAQo2H,EACRzqE,QAAS,SAASr7D,GACd8lI,EAAU/nI,MAAQ,GAAKkB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,IAAMmkC,SAAS2zF,EAAU/nI,OAASiC,EAAEi6D,SAChF4+B,OAQJ6tC,EAAcr5D,GAAG1+D,GAAG,CAChB0nE,IAAK,CACDkJ,SAAU,OACVpD,WAAY,UAGpB4pD,EAAa,IAAI/mD,GAAO,CACpBU,aAAa,EACbN,UAAW,CACP,CAAC,aAAc,cACf,CAAC,QAAS,SACV,CAAC,YAAa,aACd,CAAC,UAAW,WACZ,CAAC,UAAW,YAEhBQ,UAAW5kB,EAAEg1B,KACbxZ,SAAU,SAAStvE,GACf2xF,OAIR6tC,EAAYxmI,YAAY6lI,EAAWvnD,cACnC9W,EAAKxnE,YAAYwmI,GAEjBC,EAAsB,IAAIt5D,GAAGsW,gBAAgB,CACzCj0E,OAAQq2H,EAAWvnD,aACnBnjB,QAAS,SAASr7D,GACd+lI,EAAW5mD,cAAcn/E,EAAEi6D,WASvC,IAAI0rE,EAAiB,IAAIzlD,GAAe,CACpCd,UAAW,CACP,CACI7hF,GAAI,OACJyyE,MAAO+J,GAAK,aACZiG,MAAO9G,EAAAklB,KAEX,CACI7gG,GAAI,SACJyyE,MAAO+J,GAAK,eACZiG,MAAO9G,EAAAmlB,KAEX,CACI9gG,GAAI,QACJyyE,MAAO+J,GAAK,cACZiG,MAAO9G,EAAAolB,MAGfje,OAAQrlB,EAAE80B,MACVtZ,SAAU,SAASj5E,GACfs7F,OAGRlxB,EAAKznE,YAAYylI,EAAennD,cAEhC,IAAIonD,EAAe,IAAI/lD,GAAY,CAC/BG,MAAO9G,EAAAqlB,IACPvuB,MAAO+J,GAAK,eACZ6F,UAAW5kB,EAAEo1B,SACb5Z,SAAU,SAASl3D,GACfu5E,OAGRlxB,EAAKznE,YAAY0lI,EAAapnD,cAE9B,IAAIqnD,EAAa,IAAIhmD,GAAY,CAC7BG,MAAO9G,EAAAslB,IACPxuB,MAAO+J,GAAK,aACZ6F,UAAW5kB,EAAEk1B,OACb1Z,SAAU,SAASl3D,GACfu5E,OAGRlxB,EAAKznE,YAAY2lI,EAAWrnD,cAI5B,IAAIu5B,EAAgB,IAAIv2B,GAAS,CAC7Bp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,EACL8xE,UAAW5kB,EAAEmmB,QACbnX,WAAY,IACZiY,WAAY,IAAO,GACnBzL,SAAU,SAASn3D,GACfw5E,KAEJ7W,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAG1BsoD,EAAKznE,YAAY63G,EAAcv5B,cAI/B,IAwBIzB,EAxBAyoD,EAAYn4D,GAAG1+D,GAAG,CAClBga,OAAQjI,EACRyvD,QAAS,WACT3R,OAAQ,CACJsoE,YAAa/sD,GAAK,oBAClB,oBAAqB,QAEzB1D,IAAK,CACDia,WAAY,SACZnW,SAAU,OACV/mB,MAAO,OACPC,OAAQ,OACR4xC,OAAQ,WACR/oB,UAAW,QAEf1F,SAAU,WACNqiB,OAGR2sC,EAAUv+G,iBAAiB,QAAS4xE,GACpCzxE,YAAW,WACPo+G,EAAU74D,QACV64D,EAAUjlD,YAGd,IAAInoB,EAAc,IAAIiV,GAAGmO,YAAY,CACjCrE,OAAQ,SAAS3hB,EAAQx1D,EAAGy7E,GACpBpO,GAAGsJ,gBAAe,KAGP,SAAXnhB,GACAihC,GAAK,EAAI,GAEE,UAAXjhC,GACAihC,EAAK,EAAG,GAEG,OAAXjhC,GACAihC,EAAK,GAAG,GAEG,SAAXjhC,GACAihC,EAAK,EAAG,gBAMXswC,IACL3lI,OAAOy7E,SAAS,EAAG,GAEvBz7E,OAAO6lB,iBAAiB,SAAU8/G,GAGlC/sD,GAAM,CACFtqE,OAAQhQ,SAAS0oD,KACjBtiB,QAAO,MAAQi0C,GAAK,oBACpBr5D,IAAKA,EACL28C,QAAS,CAAC,KAAM,UAChBnmD,MAAO4tH,EAAe,GAAK,CACvB1xE,MAAO,SAEXplB,SAAU,SAAS9mC,GACf9F,OAAOg0D,oBAAoB,SAAU2xE,GACrCX,EAAuBvlE,UACvBgmE,EAAoBhmE,UACpB8lE,EAAoB9lE,UACpBwM,GAAGjY,oBAAoBiwE,EAAe,QAASzpD,GAC/CxjB,EAAYyI,UACA,OAAR35D,GACA8zD,EAAEwnE,UAAU,CACR7iH,EAAGq7C,EAAEr7C,EACLC,EAAGo7C,EAAEp7C,EACLgwE,QAAS41C,EAAUznI,MACnB+xF,MAAO61C,EAAernD,WACtB8R,SAAUw1C,EAAatnD,WACvB4R,OAAQ21C,EAAWvnD,WACnB+F,MAAOrpB,EAAEqpB,MACTvxD,KAAMgzG,EAAU/nI,MAChBiyF,KAAM+1C,EAAWznD,WACjB6C,QAAS42B,EAAcz5B,cAInCvC,WAAW,EACXe,aAAc,KACdnC,kBAAkB,EAClBoC,UAAW,SAAUl2E,GACjBk2E,EAAYl2E,KAIpBgyF,oCC5mBkC79B,GAClC,MAAMt6C,EAAM2sD,GAAG1+D,GAAG,IAEZy6E,EAAUhoF,OAAO28E,WAAa,KAAO38E,OAAO48E,YAAc,IAC1D9mE,EAAQkyE,EAAU,GAAK,CAAEh2B,MAAO,SACtC,IAAI4zE,EACJ,MAAM/F,EAAW,IAAIz3C,GAAS,CAC1Bp2B,MAAOg2B,EAAU,IAAM,IACvB/1B,OAAQ+1B,EAAU,IAAM,IACxBj1B,OAAQ6G,EAAEglB,MAAM7rB,OAChBk2B,WAAW,EACX7T,SAAU,SAASpjB,EAAOC,GACjB2zE,GAGLC,EAAiB7zE,EAAOC,eAqBvB4zE,EAAiB/zE,EAAWC,GACjC,MAAMimC,EAAM/rB,GAAGod,QAAQv3B,EAAGC,EAAG6H,EAAEksE,QAASlsE,EAAEksE,SAEtC9tC,EAAIhmC,MAAQF,GACZ8zE,EAAajxD,UAAS,4BAA+B7iB,OAAOC,cAAYl0D,KAAE4jC,MAAKu2D,EAAMhmC,YAAcn0D,KAAE4jC,MAAKu2D,EAAM/lC,UAChH2zE,EAAah3D,MAAQ+J,GAAK,sBAE1BitD,EAAajxD,UAAS,GAAM7iB,OAAOC,IACnC6zE,EAAah3D,MAAQ,IA1B7B3C,GAAGgJ,IAAI4qD,EAASj5C,QAAS,CACrB7L,WAAY,QACZ8d,UAAW,iBACXC,aAAc,mBAElB+mC,EAASj5C,QAAQhY,MAAQ+J,GAAK,qBAC9Br5D,EAAIxgB,YAAY+gI,EAASj5C,SAGzBg/C,EAAe35D,GAAG1+D,GAAG,CACjBga,OAAQjI,EACR21D,IAAK,CACD6F,UAAW,OACX0M,UAAW,SACXvE,MAAO,OACPtJ,WAAY,UAcpBksD,EAAiBjsE,EAAEglB,MAAM5sB,MAAO4H,EAAEglB,MAAM3sB,QAGxC,IAmBI8zE,EAnBAC,GAAY,EAoBhB,GAAqB,QAAjBpsE,EAAEglB,MAAMngF,KAAgB,CACxB,MAAMwnI,EAAY,CACdrsD,WAAY,sBACZwE,QAAS,OACTtD,UAAW,MACXd,aAAc,MACdgG,OAAQ,oBACR1D,aAAc,OAElB,GAAI1iB,EAAEglB,MAAM8Q,QAUR,GATAq2C,EAAkB,IAAI9oD,GAAS,CAC3B15C,KAAMyiG,EACNhjF,MAAO21B,GAAK,kBACZ/rC,SAAU,SAAS1uB,GACf8nH,EAAY9nH,KAGpBoB,EAAIxgB,YAAYinI,EAAgB3oD,cAE5BxjB,EAAEglB,MAAMkf,WAAY,CACpB,MAAMuiC,EAASp0D,GAAG1+D,GAAG,CACjB0H,QAAS0jE,GAAK,8BACd1D,IAAKgxD,IAET5F,EAAOvhI,YAAYmtE,GAAG1+D,GAAG,CACrBwhE,QAAS,IACT95D,QAAS,UACTkgE,QAAS,qBA9CH+wD,GAClB,IAAIC,EAAa,GACbC,EAAa,CACblnC,KAAQ,yCACRd,SAAY,uDACZ1uE,MAAS,+CACT2uE,WAAc,mCACd,eAAgB,+BAChB,eAAgB,+BAChB,aAAc,gCACd,mBAAoB,6DAExB,IAAK,IAAIpiG,EAAI,EAAGA,EAAIiqI,EAAchqI,OAAQD,IACtCkqI,EAAW7/H,KAAK,KAAO8/H,EAAWF,EAAcjqI,KAEpDwwE,MAAM05D,EAAWl6H,KAAK,OAgCNo6H,CAAazsE,EAAEglB,MAAMkf,gBAG7Bx+E,EAAIxgB,YAAYuhI,QAEjB,CACH,MAAMA,EAASp0D,GAAG1+D,GAAG,CACjB0H,QAAS0jE,GAAK,0BACd1D,IAAKgxD,IAET3mH,EAAIxgB,YAAYuhI,IAwCxBznD,GAAM,CACFtqE,OAAQsrD,EAAEtrD,OACVo2B,QAAO,MAAQi0C,GAAK,sBACpBr5D,IAAKA,QACLxJ,EACAmmD,QAAS,CAAC0c,GAAK,uBAAwBA,GAAK,uBAAwB,UACpE/rC,kBA1Cc7kC,GACd,MAAM0gF,EAAeo3C,EAASn1C,kBACxB47C,EAAWzG,EAASp1C,UAC1Bo1C,EAASpgE,UACLsmE,GACAA,EAAgBtmE,UAGhB13D,IAAW4wE,GAAK,uBAChB/e,EAAEhtB,SAAS,CACPnuC,KAAM,WACNmgF,MAAO6J,IAGJ1gF,IAAW4wE,GAAK,uBACF,QAAjB/e,EAAEglB,MAAMngF,MACJunI,IACApsE,EAAEglB,MAAM8Q,OAAS,MAErB91B,EAAEhtB,SAAS,CACPnuC,KAAM,eACNmgF,MAAOhlB,EAAEglB,MACT2nD,QAASD,KAEW,UAAjB1sE,EAAEglB,MAAMngF,MACfm7D,EAAEhtB,SAAS,CACPnuC,KAAM,WACNmgF,MAAO6J,IAIf7uB,EAAEhtB,SAAS,CACPnuC,KAAM,YAWdk8E,UAAW,8BtBvBf4/B,wBuBxFwBwK,EAAoB/I,EAAUD,EAA4ByqB,GAClF,IAAKA,EACD,MAAM,IAAInqI,MAAM,qBAGpB,IAAIoqI,EAAanoI,SAASC,cAAc,SACxCkoI,EAAWhoI,KAAO,OAClBgoI,EAAW9pI,MAAQg8E,GAAK,yBACxB,IAAI+tD,EAAmBz6D,GAAG1+D,GAAG,CACzBwhE,QAAS,WACT3R,OAAQ,CACJupE,KAAM,GAEV1xD,IAAK,CACDjjB,MAAO,OACP0pD,SAAU,UAIdkrB,EAAatoI,SAASC,cAAc,OACxCqoI,EAAWjoI,YAAcg6E,GAAK,eAAiB,IAC/C,IAAIkuD,EAAmB56D,GAAG1+D,GAAG,CACzB0H,QAAS0jE,GAAK,kBAAoB,IAClC1D,IAAK,CACD6F,UAAW,UAIfgsD,EAAMxoI,SAASC,cAAc,OACjCuoI,EAAInyD,UAAS,kFAAqFgE,GAAK,qBAAqBA,GAAK,kBAEjI,MAAMouD,EAAY,IAAIh+B,GAAGi+B,UAAU,CAC/Bt/H,KAAM,WACN67B,KAAM,OACNllB,MAAO,CACH,CAAE2kC,MAAO,MAAOrmD,MAAO,QACvB,CAAEqmD,MAAO,MAAOrmD,MAAO,QAE3Bg1H,aAAa,IAEjB1lD,GAAGgJ,IAAI8xD,EAAU3pD,aAAc,CAC3BpD,aAAc,SAIlB,IAAIitD,EAAS3oI,SAASC,cAAc,OAChC2oI,EAAW5oI,SAASC,cAAc,OACtC2oI,EAAShyD,UAAY,YACrBgyD,EAASvoI,YAAcg6E,GAAK,sBAC5BsuD,EAAOxgF,OACHygF,EACAH,EAAU3pD,aACVwpD,EACAH,EACAI,EACAH,EACAI,GAEJ/9B,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRt3E,QAAO,MAAQi0C,GAAK,sBACpBl6E,KAAM,SACN6gB,IAAK2nH,EACLhrE,QAAS,CAAC0c,GAAK,iBAAkB,UACjC+C,aAAc/C,GAAK,iBACnB2C,UAAW,CAAC3C,GAAK,kBACjBgC,UAAWhC,GAAK,iBAChB/rC,SAAQpuC,eAAkBsH,GACtB,GAAIA,IAAQ6yE,GAAK,kBAA4B,QAAR7yE,GAAyB,OAARA,EAClD,IACI,MAAMiC,uBAvIJgrD,EAAQ6b,EAAOjnE,EAAalJ,EAAsB+nI,GACpE,IAAIW,EAAMvqB,GAAa7pD,EAAO6S,UAAU,SAAWnnE,IAE/CqzD,EAAI9xD,OAAOkW,OACX8sC,EAAQ8O,EAAExzD,SAASC,cAAc,OACjC6oI,EAAMt1E,EAAExzD,SAASC,cAAc,OACnC6oI,EAAIpxH,IAAM8hE,EAAA4lC,IACV16D,EAAMlkD,YAAYsoI,GAClBn7D,GAAGgJ,IAAImyD,EAAK,CACR3mG,OAAQ,cAEZqxB,EAAExzD,SAAS0oD,KAAKlxC,MAAMgqE,gBAAkB,UACxChuB,EAAExzD,SAAS0oD,KAAKlxC,MAAM6oE,gBAAkB,2CACxC7sB,EAAExzD,SAAS0oD,KAAKlxC,MAAM6pE,iBAAmB,YACzC,IAqBIo+B,EArBAspB,EAAYv1E,EAAExzD,SAASC,cAAc,OACzC8oI,EAAUvxH,MAAMglE,UAAY,OAC5B93B,EAAMlkD,YAAYuoI,GAClBA,EAAU1oI,YAAcg6E,GAAK,oBAE7B7mB,EAAExzD,SAAS0oD,KAAKloD,YAAYkkD,GAC5BipB,GAAGgJ,IAAIjyB,EAAO,CACV+3B,WAAY,OACZd,YAAa,OACba,UAAW,QACX6T,WAAY,oBACZxQ,SAAU,OACVqJ,UAAW,SACXb,WAAY,2BACZ5G,QAAS,IACTkD,MAAO,SAEXj9D,YAAW,WACPg9B,EAAMltC,MAAMiqE,QAAU,MACvB,IAGH,IACI,MAAMunD,EAAW,IAAIC,SACrBD,EAAS7gF,OAAO,QAASmoB,GACzB04D,EAAS7gF,OAAO,cAAe9+C,GAC/B2/H,EAAS7gF,OAAO,QAAS0gF,GACzBppB,QAAiB92D,MAAM,gCAAkC,CACrDzjD,OAAQ,OACRujD,QAAS,CACLygF,cAAe,aAAehB,GAElCx/E,KAAMsgF,IAGZ,MAAO1oI,GAEL,MADAkzD,EAAEx8C,QACI,IAAIjZ,MAAMuC,GAEpB,IAAKm/G,EAAS9yF,GAEV,MADA6mC,EAAEx8C,QACI,IAAIjZ,MAEd,IAAI8S,SAAc4uG,EAAS0pB,QAAQt4H,KAInC,OAFA2iD,EAAEhtC,SAAS86B,KAAQzwC,EAAau4H,KAAKhrI,QAAO,cAAgB,IAErDyS,EA0E8Bw4H,CACjB5iB,EAASpB,kBAAkB,GAC3B8iB,EAAW9pI,MACX+pI,EAAiB/pI,MACjBoqI,EAAU7pD,WACVspD,GAGJz9B,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRv9G,KAAM,KACNimC,QAAO,OAASi0C,GAAK,6BAA6BA,GAAK,mGAAmG5wE,EAAO6/H,uCAAuC7/H,EAAO6/H,yBAC/M3rE,QAAS,CAAC,QAEd8/C,EAAaxxB,QAEf,MAAM3rF,GACJmqG,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRv9G,KAAM,QACNimC,QAASi0C,GAAK,iBACd1c,QAAS,CAAC,6BCjJXrC,GACnB,IAAIt6C,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDsR,OAAQ,UAGZ2K,GAAY,EACZzjD,EAAQmsB,EAAEnsB,MACVqkC,EAAWlY,EAAEkY,SAEbzL,EAAO4F,GAAG1+D,GAAG,CACb0nE,IAAK,CACD+E,aAAc,OACdjkE,QAAS,UAGbuwD,EAAO2F,GAAG1+D,GAAG,CACb0nE,IAAK,CACDl/D,QAAS,OACTikE,aAAc,UAGlBzT,EAAO0F,GAAG1+D,GAAG,CACb0nE,IAAK,CACDl/D,QAAS,UAGjBuJ,EAAImnC,OAAO4f,EAAMC,EAAMC,GAGvB,IAAIshE,EAAU57D,GAAG1+D,GAAG,CAChB0nE,IAAK,CACDjjB,MAAO,OACPkvB,WAAY,UAGpB7a,EAAKvnE,YAAY+oI,GAEjB,IAAI1T,EAAU,IAAIjrC,MAClBirC,EAAQn+G,IAAM8hE,EAAAqQ,IACdlc,GAAGgJ,IAAIk/C,EAAS,CACZC,cAAe,SACfpiE,MAAO,OACPC,OAAQ,OACRgoB,YAAa,MACbqC,aAAc,OACd1C,WAAY,kBACZsH,WAAY,SAEhB7a,EAAKvnE,YAAYq1H,GAEjB,IAAI2T,EAAU77D,GAAG1+D,GAAG,CAChB0nE,IAAK,CACDiM,WAAY,mBAMXv0C,IACLk7F,EAAQlzD,UAAY92E,KAAK4jC,MAAc,IAARgM,GAAe,IAC9Cq6F,EAAQnzD,UAAa92E,KAAK4jC,MAAMqwC,GAAY,IAG3CqiD,EAAOr+G,MAAM67D,UAAY,UAAYG,EAAW,OAE7CqiD,EAAQr+G,MAAM+jE,UADd/H,EAAW,IAAO,EACQ,qEAEA,GAZlCzL,EAAKvnE,YAAYgpI,GAejBn7F,IAGA,IAAIo7F,EAAc97D,GAAG1+D,GAAG,CACpBwhE,QAAS,SACT95D,QAAS0jE,GAAK,cACdxD,QAASvb,EAAEouE,UAEf/7D,GAAGg8D,gBAAgBF,GAEnB,IAAIG,EAAYj8D,GAAG1+D,GAAG,CAClBwhE,QAAS,SACT95D,QAAS0jE,GAAK,YACd1D,IAAK,CACD8F,WAAY,QAEhB5F,QAASvb,EAAEuuE,QAEfl8D,GAAGg8D,gBAAgBC,GACnB5hE,EAAK7f,OAAOshF,EAAaG,GAEzB,IAAIE,EAAmBn8D,GAAG1+D,GAAG,CACzBwhE,QAAS,SACT95D,QAAS,yBAA2B6iE,EAAAglB,IAAY,mDAChD3nB,QAAS,WACLvb,EAAEyuE,eAAc,IAAK,MAG7Bp8D,GAAGg8D,gBAAgBG,GAEnB,IAAIE,EAAmBr8D,GAAG1+D,GAAG,CACzBwhE,QAAS,SACT95D,QAAS,KACTggE,IAAK,CACD8F,WAAY,QAEhB5F,QAAS,WACLvb,EAAEyuE,cAAc,MAGxBp8D,GAAGg8D,gBAAgBK,GAEnB,IAAIC,EAAoBt8D,GAAG1+D,GAAG,CAC1BwhE,QAAS,SACT95D,QAAS,yBAA2B6iE,EAAAglB,IAAY,mBAChD7nB,IAAK,CACD8F,WAAY,QAEhB5F,QAAS,WACLvb,EAAEyuE,cAAc,IAAI,MAG5Bp8D,GAAGg8D,gBAAgBM,GACnBhiE,EAAK9f,OAAO2hF,EAAkBE,EAAkBC,GAKhDroI,KAAKk9E,WAAa,WACd,OAAO99D,GAEXpf,KAAKw2H,aAAe,SAAS8R,GACzBt3C,IAAcs3C,EACdlpH,EAAIxJ,MAAMC,QAAUm7E,EAAY,QAAU,OACtCA,GACAvkD,KAGRzsC,KAAKysC,OAAS,SAAS87F,EAAQ37C,GAC3Br/C,EAAQg7F,EACR32D,EAAWgb,EACPoE,GACAvkD,sBCpJWitB,GACnB,IAAIt6C,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDsR,OAAQ,UAGZ2K,GAAY,EAEZw3C,EAAWz8D,GAAG1+D,GAAG,CACjBga,OAAQjI,EACR21D,IAAK,CACD+E,aAAc,UAIlB28B,EAAgB,IAAIv2B,GAAS,CAC7Bp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,EACL8xE,UAAW,EACXpJ,SAAU,SAAUtvE,KAEpB86E,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAG1BqB,EAAIxgB,YAAY63G,EAAcv5B,cAE9B,IAAIurD,EAAkB,IAAIvoD,GAAS,CAC/Bp9B,MAAO21B,GAAK,oBACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAW,GACXpJ,SAAU,SAAUtvE,KAEpB86E,WAAY,SAAS3iE,GACjB,OAAOpgB,KAAK4jC,MAAMxjB,EAAI,IAAM,QAGpCguD,GAAGgJ,IAAI0zD,EAAgBvrD,aAAc,CACjCtC,UAAW,SAEfx7D,EAAIxgB,YAAY6pI,EAAgBvrD,cAEhC,IAQIkoD,EACAsD,EA0BAC,EACAC,EApCAC,EAAY98D,GAAG1+D,GAAG,CAClBga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACT+kE,UAAW,UAMnBwqD,EAAcr5D,GAAG1+D,GAAG,CAChB0H,QAAS0jE,GAAK,iBAAmB,SACjC/J,MAAO+J,GAAK,uBACZ1D,IAAK,CACDkJ,SAAU,UAGlByqD,EAAa,IAAIhrD,GAAO,CACpBI,UAAW,CACP,CAAC,MAAOrF,GAAK,sBACb,CAAC,UAAWA,GAAK,yBACjB,CAAC,QAASA,GAAK,yBAEnB6F,UAAW,MACXpJ,SAAU,SAAStvE,OAEG,IAAImmE,GAAGsW,gBAAgB,CAC7Cj0E,OAAQs6H,EAAWxrD,aACnBnjB,QAAS,SAASr7D,GACdgqI,EAAW7qD,cAAcn/E,EAAEi6D,WAGnCysE,EAAYxmI,YAAY8pI,EAAWxrD,cACnC2rD,EAAUjqI,YAAYwmI,GAItBuD,EAAc58D,GAAG1+D,GAAG,CAChB0H,QAAS0jE,GAAK,eAAiB,SAC/B/J,MAAO+J,GAAK,qBACZ1D,IAAK,CACDkJ,SAAU,OACVpD,WAAY,UAGpB+tD,EAAa,IAAIlrD,GAAO,CACpBI,UAAW,CACP,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,MAEVQ,UAAW,IACXpJ,SAAU,SAAStvE,OAEG,IAAImmE,GAAGsW,gBAAgB,CAC7Cj0E,OAAQw6H,EAAW1rD,aACnBnjB,QAAS,SAASr7D,GACdkqI,EAAW/qD,cAAcn/E,EAAEi6D,WAGnCgwE,EAAY/pI,YAAYgqI,EAAW1rD,cACnC2rD,EAAUjqI,YAAY+pI,GAGtB,IAAIl9C,GAAe,EACfq9C,EAAmB,IAAI/rD,GAAS,CAChC15C,MAAM,EACNyf,MAAO21B,GAAK,qBACZ/J,MAAO+J,GAAK,2BACZ/rC,SAAU,SAAU1uB,GAChBytE,EAAeztE,GAEnB+2D,IAAK,CACD6F,UAAW,OACXmuD,aAAc,MACdlzH,QAAS,kBAGjBuJ,EAAIxgB,YAAYkqI,EAAiB5rD,cAOjCl9E,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAKw2H,aAAe,SAAS8R,GACzBt3C,IAAcs3C,EACdlpH,EAAIxJ,MAAMC,QAAUm7E,EAAY,QAAU,OACtCA,IACAw3C,EAAS5pI,YAAY86D,EAAEw+D,YAAYh7C,cACnCsrD,EAAS5pI,YAAY86D,EAAEw+D,YAAYrE,sBAI3C7zH,KAAKgpI,aAAe,WAChB,OAAOP,EAAgBzrD,YAG3Bh9E,KAAKmsG,WAAa,WACd,OAAOsK,EAAcz5B,YAMzBh9E,KAAKipI,UAAY,WACb,OAAOP,EAAW1rD,YAGtBh9E,KAAKkpI,QAAU,WACX,OAAOr4F,SAAS+3F,EAAW5rD,WAAY,KAG3Ch9E,KAAKmpI,cAAgB,WACjB,OAAO19C,oBC9KQ/xB,GACnB,IAAIt6C,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDsR,OAAQ,UAGZ2K,GAAY,EAEZw3C,EAAWz8D,GAAG1+D,GAAG,CACjBga,OAAQjI,EACR21D,IAAK,CACD+E,aAAc,UAIX/N,GAAG1+D,GAAG,CACbga,OAAQjI,EACRrK,QAAS0jE,GAAK,sBAMlBz4E,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAKw2H,aAAe,SAAS8R,GACzBt3C,IAAcs3C,EACdlpH,EAAIxJ,MAAMC,QAAUm7E,EAAY,QAAU,OACtCA,IACAw3C,EAAS5pI,YAAY86D,EAAEw+D,YAAYh7C,cACnCsrD,EAAS5pI,YAAY86D,EAAEw+D,YAAYrE,wCC7BvBn6D,GACpB,IAgBIgzD,EACArmH,EAjBA+Y,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDsR,OAAQ,UAGZ2K,GAAY,EAEZw3C,EAAWz8D,GAAG1+D,GAAG,CACjBga,OAAQjI,EACR21D,IAAK,CACD+E,aAAc,UAUlBsvD,EAAoBr9D,GAAG0lB,UAAU,CACjCxiB,YAAa,OACb5wD,EAAG,IACHyzC,MAAO,OAEPu3E,EAAgBt9D,GAAG0lB,UAAU,CAC7BxiB,YAAa,MACbnd,MAAO,KACPC,OAAQ,OAEZs3E,EAAczqI,YAAYwqI,GAC1Br9D,GAAGgJ,IAAIs0D,EAAe,CAClBxzH,QAAS,UAGb,IAAIyzH,EAAoBv9D,GAAG0lB,UAAU,CACjCxiB,YAAa,OACb5wD,EAAG,IACHyzC,MAAO,OAEPy3E,EAAgBx9D,GAAG0lB,UAAU,CAC7BxiB,YAAa,MACbnd,MAAO,KACPC,OAAQ,OAEZw3E,EAAc3qI,YAAY0qI,GAC1Bv9D,GAAGgJ,IAAIw0D,EAAe,CAClB1zH,QAAS,UAIb,IAAI2zH,EAA0Bz9D,GAAG0lB,UAAU,CACvCxiB,YAAa,UACb2iB,GAAI,OACJC,GAAI,OACJ79D,GAAI,QAEJy1G,EAAmB19D,GAAG0lB,UAAU,CAChCxiB,YAAa,MACbnd,MAAO,KACPC,OAAQ,OAEZ03E,EAAiB7qI,YAAY4qI,GAC7Bz9D,GAAGgJ,IAAI00D,EAAkB,CACrB5zH,QAAS,UAGb,IAAI6zH,EAA0B39D,GAAG0lB,UAAU,CACvCxiB,YAAa,UACb2iB,GAAI,OACJC,GAAI,OACJ79D,GAAI,QAEJ21G,EAAmB59D,GAAG0lB,UAAU,CAChCxiB,YAAa,MACbnd,MAAO,KACPC,OAAQ,OAEZ43E,EAAiB/qI,YAAY8qI,GAC7B39D,GAAGgJ,IAAI40D,EAAkB,CACrB9zH,QAAS,UAIb,IAAI+zH,EAAc79D,GAAG0lB,UAAU,CAC3BxiB,YAAa,OACblgC,GAAI,IACJ0gC,GAAI,OAEJo6D,EAAU99D,GAAG0lB,UAAU,CACvBxiB,YAAa,MACbnd,MAAO,KACPC,OAAQ,gBAOH+3E,IACL,IAAIC,EAAch+D,GAAGj/B,MAAMnvC,KAAK4jC,MAAMyoG,EAAgBhtD,WAAa,IAAK,EAAG,IAAM,KAIjFjR,GAAGgJ,IAAIq0D,EAAmB,CAAEh7C,KAAM,OAAQH,OAAQ,QAAS87C,YAAaA,IACxEh+D,GAAGgJ,IAAIu0D,EAAmB,CAAEl7C,KAAM,QAASH,OAAQ,SAEnDliB,GAAGgJ,IAAIy0D,EAAyB,CAAEp7C,KAAM,OAAQH,OAAQ,QAAS87C,YAAaA,IAC9Eh+D,GAAGgJ,IAAI20D,EAAyB,CAAEt7C,KAAM,QAASH,OAAQ,SAEzDliB,GAAGgJ,IACC60D,EACA,CAAEx7C,KAAM,OAAQH,OAAQ,QAAS87C,YAAaA,IAG7CE,EAAoBjtD,YACrBosD,EAAkB59D,aAAa,IAAK,KACpC49D,EAAkB59D,aAAa,SAAU,MACzC89D,EAAkB99D,aAAa,IAAK,KACpC89D,EAAkB99D,aAAa,SAAU,MAEzCg+D,EAAwBh+D,aAAa,KAAM,OAC3Ck+D,EAAwBl+D,aAAa,KAAM,SAE3C49D,EAAkB59D,aAAa,IAAK,QACpC49D,EAAkB59D,aAAa,SAAU,sBACzC89D,EAAkB99D,aAAa,IAAK,QACpC89D,EAAkB99D,aAAa,SAAU,sBAEzCg+D,EAAwBh+D,aAAa,KAAM,IAAM0+D,KAAkBC,OACnET,EAAwBl+D,aAAa,KAAM,IAAM0+D,KAAkBC,QAGlEC,EAAmBptD,YACpB4sD,EAAYp+D,aAAa,KAAM,MAC/Bo+D,EAAYp+D,aAAa,KAAM,OAE/Bo+D,EAAYp+D,aAAa,KAAM,QAC/Bo+D,EAAYp+D,aAAa,KAAM,SA5CvCq+D,EAAQjrI,YAAYgrI,GACpB79D,GAAGgJ,IAAI80D,EAAS,CACZh0H,QAAS,UA8Cb,IAAIswD,EAAO4F,GAAG1+D,GAAG,CACbga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,gBAChBC,WAAY,WAIhBkxD,EAAe,IAAI7iD,GAAQ,CAC3B1J,UAAW,CACP,CACI7hF,GAAI,cACJ6mD,MAAOumF,EACP36D,MAAO+J,GAAK,cAAgB,IAAMA,GAAK,iBAE3C,CACIx8E,GAAI,iBACJ6mD,MAAO2mF,EACP/6D,MAAO+J,GAAK,iBAAmB,IAAMA,GAAK,iBAE9C,CACIx8E,GAAI,OACJ6mD,MAAO+mF,EACPn7D,MAAO+J,GAAK,eAEhB,CACIx8E,GAAI,YACJ6mD,MAAOymF,EACP76D,MAAO+J,GAAK,cAAgB,IAAMA,GAAK,eAE3C,CACIx8E,GAAI,eACJ6mD,MAAO6mF,EACPj7D,MAAO+J,GAAK,iBAAmB,IAAMA,GAAK,gBAGlDsG,OAAQ,OACR7J,SAAU,SAASj5E,GACf,IAAIwG,EAAQxG,EAAGwG,MAAM,KACrBiqH,EAAQjqH,EAAM,GACd4D,EAAO5D,EAAM,GAEbspE,GAAGgJ,IAAIk1D,EAAY/sD,aAAc,CAC7BrnE,QAAmB,SAAV62G,EAAmB,OAAS,OAEzC3gD,GAAGgJ,IAAIq1D,EAAWltD,aAAc,CAC5BrnE,QAAmB,SAAV62G,EAAmB,KAAO,SAEvC3gD,GAAGgJ,IAAIi1D,EAAgB9sD,aAAc,CACjCrnE,QAAoB,SAAV62G,GAA6B,SAATrmH,EAAmB,OAAS,QAGlE2hF,cAAc,IAElBqiD,EAAantD,aAAatnE,MAAMk8C,MAAQ,QACxCqU,EAAKvnE,YAAYyrI,EAAantD,cAE9B,IAAIq7B,EAAe,IAAIx7B,GAAS,CAC5B15C,MAAM,EACNyf,MAAO21B,GAAK,UACZ/rC,SAAU,SAAS1uB,GACf8rH,OAGR3jE,EAAKvnE,YAAY25G,EAAar7B,cAE9B,IAAI8sD,EAAkB,IAAI9pD,GAAS,CAC/Bp9B,MAAO21B,GAAK,oBACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAW,EACXgC,MAAO,YACPpL,SAAU,SAAUtvE,GAChBkkI,KAEJppD,WAAY,SAAU3iE,GAClB,OAAOpgB,KAAK4jC,MAAMxjB,MAG1BguD,GAAGgJ,IAAIi1D,EAAgB9sD,aAAc,CACjCtC,UAAW,SAEfx7D,EAAIxgB,YAAYorI,EAAgB9sD,cAEhC,IAAIu5B,EAAgB,IAAIv2B,GAAS,CAC7Bp9B,MAAO21B,GAAK,WACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,EACL8xE,UAAW,EACXpJ,SAAU,SAAUtvE,KAEpB86E,WAAY,SAAU3iE,GAClB,OAAOpgB,KAAK4jC,MAAU,IAAJxjB,MAG1BguD,GAAGgJ,IAAI0hC,EAAcv5B,aAAc,CAC/BtC,UAAW,SAEfx7D,EAAIxgB,YAAY63G,EAAcv5B,cAE9B,IAAI9W,EAAO2F,GAAG1+D,GAAG,CACbga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZyB,UAAW,UAIf0vD,EAAiB,IAAIvtD,GAAS,CAC9B15C,MAAM,EACNyf,MAAO21B,GAAK,kBACZ/rC,SAAU,SAAS1uB,KACnB+2D,IAAK,CACDjjB,MAAO,MACPioB,YAAa,UAGrB3T,EAAKxnE,YAAY0rI,EAAeptD,cAEhC,IAAI+sD,EAAc,IAAIltD,GAAS,CAC3B15C,MAAM,EACNyf,MAAO21B,GAAK,eACZ/rC,SAAU,SAAS1uB,GACf8rH,KAEJ/0D,IAAK,CACDomB,SAAU,OAGlB/0B,EAAKxnE,YAAYqrI,EAAY/sD,cAE7B,IAAIktD,EAAa,IAAIrtD,GAAS,CAC1B15C,MAAM,EACNyf,MAAO21B,GAAK,cACZ/J,MAAO+J,GAAK,oBACZ/rC,SAAU,SAAS1uB,GACf8rH,KAEJ/0D,IAAK,CACDomB,SAAU,OAGlB/0B,EAAKxnE,YAAYwrI,EAAWltD,cAI5B4sD,IAIA9pI,KAAKk9E,WAAa,WACd,OAAO99D,GAGXpf,KAAKw2H,aAAe,SAAS8R,GACzBt3C,IAAcs3C,EACdlpH,EAAIxJ,MAAMC,QAAUm7E,EAAY,QAAU,OACtCA,IACAw3C,EAAS5pI,YAAY86D,EAAEw+D,YAAYh7C,cACnCsrD,EAAS5pI,YAAY86D,EAAEw+D,YAAYrE,sBAK3C7zH,KAAKuqI,SAAW,WACZ,OAAO7d,GAGX1sH,KAAKu0G,QAAU,WACX,OAAOluG,GAGXrG,KAAKqzG,YAAc,WACf,OAAQkF,EAAqBv7B,YAGjCh9E,KAAKmsG,WAAa,WACd,OAAOsK,EAAcz5B,YAGzBh9E,KAAKwqI,aAAe,WAChB,OAAOR,EAAgBhtD,YAG3Bh9E,KAAKyqI,cAAgB,WACjB,OAAQH,EAAuBttD,YAGnCh9E,KAAK0qI,WAAa,WACd,OAAQT,EAAoBjtD,YAGhCh9E,KAAK2qI,UAAY,WACb,OAAQP,EAAmBptD,2BCjH/B4tD,WAGA1tD,aACI,OAAOl9E,KAAKof,IAGhBo3G,aAAaxlC,GACLA,GACAhxF,KAAK4qI,UAIbC,gBACI7qI,KAAKi5H,aAAa5+C,oBA/NlByhC,EACAH,EACAC,EACQkvB,EACRC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAxvB,QARQivB,WAAAA,EAUR,MAAMvjE,EAAQvnE,KACdA,KAAKof,IAAMhhB,SAASC,cAAc,OAgMlCynB,YA9LmB,KACf,IAAIwlH,EAAWltI,SAASC,cAAc,OAClC06H,EAAY36H,SAASC,cAAc,UACnC86H,EAAa/6H,SAASC,cAAc,UAIxC06H,EAAUnjH,MAAM2pE,SAAW,OAC3BxT,GAAGgJ,IAAIokD,EAAY,CAEf55C,SAAU,OACVv5D,MAAO,SAIX+yG,EAAUx7C,UAAW,EACrB47C,EAAW57C,UAAW,EAGtBw7C,EAAUtkD,UAAS,aAAgBmD,EAAAqiB,gCAAwCxhB,GAAK,cAChF0gD,EAAW1kD,UAAS,aAAgBmD,EAAAuiB,gCAAsC1hB,GAAK,eAC/EsgD,EAAU/jD,UAAY,aACtBmkD,EAAWnkD,UAAY,aAGvBh1E,KAAKi5H,aAAe76H,SAASC,cAAc,SAC3C2B,KAAKi5H,aAAa17C,UAAW,EAC7Bv9E,KAAKi5H,aAAa16H,KAAO,OACzByB,KAAKi5H,aAAasS,UAAW,EAC7BvrI,KAAKi5H,aAAauS,OAAS,QAC1BxrI,KAAKi5H,aAAqBznG,KAAO,KAClCxxB,KAAKi5H,aAAax6H,YAAc,SAChC,IAoDIgtI,EACAC,EArDAC,EAAqB3rI,KAAKi5H,yBAG1B0S,EAAgBvtI,SAASC,cAAc,OACvCstI,EAAc32D,UAAY,aAC1B22D,EAAc/1H,MAAM2b,SAAW,WAC/Bo6G,EAAc/1H,MAAMooE,OAAS,UAC7B2tD,EAAc/1H,MAAM2pE,SAAW,OAE/B,IAAIqsD,EAAYxtI,SAASC,cAAc,OACvCutI,EAAUh2H,MAAMk8C,MAAQ,QACxB85E,EAAUh2H,MAAMm8C,OAAS,OACzB65E,EAAUh2H,MAAMijE,SAAW,SAC3B+yD,EAAUh2H,MAAMooE,OAAS,UACzB4tD,EAAUh2H,MAAM2b,SAAW,WAE3Bo6G,EAAc/sI,YAAYgtI,GAC1BA,EAAUhtI,YAAY2oE,EAAM0xD,cAE5B,IAAI4S,EAAmBztI,SAASC,cAAc,UAC9CwtI,EAAiBp3D,UAAY,4CAA8CmD,EAAAsiB,IAAY,iBAAmBzhB,GAAK,eAC/GozD,EAAiBtuD,UAAW,EAE5BxR,GAAGgJ,IAAI82D,EAAkB,CAErB/5E,MAAO,QACPj8C,QAAS,MACT0b,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLyqB,OAAQ,YAEZjS,GAAGgJ,IAAIxN,EAAM0xD,aAAc,CACvBpjH,QAAS,SAEb81H,EAAc/sI,YAAYitI,GAE1BA,EAAiBtxD,QAAU,WACvBhT,EAAM0xD,aAAa5+C,SAI3ByxD,GAEA9rI,KAAKi5H,aAAa97C,SAAW,SAAUz+E,GACnCssI,EAAazjE,EAAM0xD,aAAatqD,MAAO,WACvCpH,EAAM0xD,aAAax8H,MAAQ,IAS3BgvI,EAAoB1/D,GAAG1+D,GAAG,CACtB0nE,IAAK,CACDl/D,QAAQ,OACRooE,SAAU,OACVpD,WAAY,OACZD,UAAW,OACX2E,SAAU,OACVztB,MAAO,mBACPC,OAAQ,UAGhB25E,EAAmB,IAAI7iC,GAAGkjC,OAAO,CAC7BjuD,UAAW,CACP,CAAC,MAAOrF,GAAK,kBACb,CAAC,MAAOA,GAAK,kBACb,CAAC,SAAUA,GAAK,sBAEpB6F,UAAWwsD,EACX51D,SAAU,SAAStvE,GAEfmlI,EADAD,EAAallI,GAEbqlI,OAGRl/D,GAAGgJ,IAAI22D,EAAiBxuD,aAAc,CAClCprB,MAAO,QACPC,OAAQ,SAEZ05E,EAAkB7sI,YAAY8sI,EAAiBxuD,cAMnD67C,EAAUx+C,QAAU2wD,EACpB/R,EAAW5+C,QAAU,WACjB0wD,KAKJ,IAAIe,EAAW5tI,SAASC,cAAc,gBAW7B4tI,IACL,IAAI5+H,EAAKjP,SAASC,cAAc,OAC5B6tI,EAAU9tI,SAASC,cAAc,OACjC8tI,EAAO/tI,SAASC,cAAc,OAclC,OAbAgP,EAAGzO,YAAYstI,GACf7+H,EAAGzO,YAAYutI,GACfpgE,GAAGgJ,IAAIm3D,EAAS,CACZlmH,MAAO,SAEX+lD,GAAGgJ,IAAIo3D,EAAM,CACTt2H,QAAQ,OACRglE,WAAY,OACZd,YAAa,OACba,UAAW,OACXge,aAAc,4BACd5yE,MAAO,SAEJ3Y,EA3BX2+H,EAASvtI,YAAc,MAAKg6E,GAAG,oBAC/B1M,GAAGgJ,IAAIi3D,EAAU,CACb1kD,UAAW,SACX1M,UAAW,OACXlB,WAAY,qBACZwE,QAAS,UACT6E,MAAO,mBACP9E,SAAU,SAuBd1W,EAAM6kE,mBAAqB,IAAIxxB,GAAiBe,EAAcC,EAAYC,EAAcC,GACxF/vC,GAAGgJ,IAAIxN,EAAM6kE,mBAAmBlvD,aAAc,CAE1CrnE,QAAQ,OACRwwE,OAAQ,SAKZta,GAAGxlB,OAAO+kF,EAAU,CAChBU,EACAjT,EACA4S,EACA5/D,GAAG1+D,GAAG,CAAC0nE,IAAK,CAAC/uD,MAAO,UAEpBmzG,EACAsS,EACA1/D,GAAG1+D,GAAG,CAAC0nE,IAAK,CAAC/uD,MAAO,UAGpB+lD,GAAG1+D,GAAG,CAAC0nE,IAAK,CAAC/uD,MAAO,UAEpBimH,IACA1kE,EAAM6kE,mBAAmBlvD,aACzB+uD,MAIJjsI,KAAKof,IAAIxgB,YAAY0sI,KAGC,qBClNtBjoG,OACJ,MAAMkkC,EAAQvnE,KACd,IAAIqsI,EAAWtgE,GAAGsgE,WACdC,EAAUzjC,GAAG+lB,UACb7yD,EAAU,GAMd,GAJAgQ,GAAGukD,MAAMxkG,KAAK,CACVvtB,KAAM,kBAGLsqG,GAAG0jC,gBAAgB5pC,SACpB,MAAM,IAAIxmG,MAAM,+BAGXu8H,EAAa8T,EAAWC,GAC7B,IAAIzwE,EAAS59D,SAASC,cAAc,UAChCykG,EAAc2pC,EAAUD,GAAW1pC,YAAc2pC,EAAUD,GAAW1pC,YAAc2pC,EAAUD,GAAWhlI,KACzG6kE,EAAK,oCAAsCogE,EAAUD,GAAWvpC,KAAO,kBA4G3E,OA3GAjnC,EAAOyY,UAAYpI,EAAKy2B,EACxB9mC,EAAOgZ,UAAY,aACnBjJ,GAAGgJ,IAAI/Y,EAAQ,CACXyd,WAAY,OACZwE,SAAU,SAEdjiB,EAAOuhB,UAAW,EAClBvhB,EAAOue,QAAU,WAsBb,GAAM,UAAWkyD,EAAUD,GAyB3B,GAAIC,EAAUD,GAAW/oC,UACrBznC,EAAOvF,OACPi2E,EAAY,MACZnlE,EAAMolE,cAAcrY,IAAI,IAAMmY,EAAUD,GAAWhlI,KAAO,KAAOixE,GAAK,mBAAmB,OACtF,CACH,IAgBIgD,EAhBAu2C,EAAoBzqD,EAAMqlE,cAAclZ,kBACxCmZ,EAAeJ,EAAUD,GAAWtpC,UAAU,CAC9CqF,QAAShhC,EAAMonD,qBACf97D,OAAQ0U,EAAMgnD,cACd/S,SAAUj0C,EAAMulE,qBAChBrxB,UAAWl0C,EAAMulE,qBACjBC,gBAAiB,CAACvgH,EAAG+6C,EAAMylE,kBAAkBxgH,EAAGioC,EAAG8S,EAAMylE,kBAAkBv4E,EAAGz2C,EAAGupD,EAAMylE,kBAAkBhvH,GACzGivH,kBAAmB,CAACzgH,EAAGwlG,EAAkBxlG,EAAGioC,EAAGu9D,EAAkBv9D,EAAGz2C,EAAGg0G,EAAkBh0G,KAG7F,IAAK6uH,EACD,OAMJA,EAAa3sC,cAAgB,SAASxhG,GAClConB,YAAW,WAEP,MADAymD,MAAM,mCACA7tE,IACP,GACH+8E,KAIJ,IAAI7lE,EAAoB,GACpB,UAAWi3H,IACXj3H,EAAMk8C,MAAQ+6E,EAAa/6E,MAAQ,MAGvC+2C,GAAG2R,MAAM,CACLpsG,OAAQm5D,EAAMu0C,SACdt3E,QAAS,MAAQioG,EAAUD,GAAWhlI,KAAO,OAC7C4X,IAAKytH,EAAap6H,QAClBmD,MAAOA,EACPmmD,QAAS,CAAC,KAAM,UAChByf,aAAc,KACd9uC,SAAU,SAAS7kC,aAxFHA,EAAQglI,GAC5B,GAAc,UAAVhlI,EAIA,YAHIglI,EAAattE,SACbstE,EAAattE,WAIrB,IAAI75D,EACJ,IACIA,EAAQmnI,EAAaK,WACvB,MAAOxuI,GACL,MAAyD,IAArDA,EAAE8lC,QAAQh3B,QAAQ,+BACZ,oDAAsDi/H,EAAUD,GAAWhlI,KAE3E9I,EAGdguI,EAAYhnI,GAwEJynI,CAAetlI,EAAQglI,IAE3BpxD,UAAW,SAAUl2E,GACjBk2E,EAAYl2E,UAvEpBgnE,MAAM,yCAIDmgE,EAAYhnI,IAOI,IANF+mI,EAAUD,GAAWrtI,MAAM,CAC1CopG,QAAShhC,EAAMonD,qBACf97D,OAAQ0U,EAAMgnD,cACd3lB,QAAS/xB,GACTnxE,MAAOA,KAGP6mE,MAAM,mCAEiC,IAAvCkgE,EAAUD,GAAWxpC,eACrBz7B,EAAM6lE,gBAAgB7lE,EAAMgnD,cAAcvK,SAASz8C,EAAMwnD,aAAase,iBAEnC,IAAnCZ,EAAUD,GAAWxwD,YACrBzU,EAAMsnD,kBAAkBhF,YACxBtiD,EAAMunD,OAAOriF,OAAO86B,EAAMsnD,kBAAkBvd,WAAY/pC,EAAMsnD,kBAAkBxD,gBAEpF9jD,EAAMwnD,aAAatiF,WAuD3BsvB,EAAQA,EAAQ//D,QAAUggE,EACnBA,WAGFsxE,EAAqBd,EAAWC,GACrC,IAAKA,EAAUD,GAAWzpC,QAAU0pC,EAAUD,GAAW1oC,QACrD,OAEJ,GAAI2oC,EAAUD,GAAW1oC,SAAiC,gCAAtB7xC,UAAUs7E,QAC1C,OAEJ,IAAIzqC,EAAc2pC,EAAUD,GAAW1pC,YAAc2pC,EAAUD,GAAW1pC,YAAc2pC,EAAUD,GAAWhlI,KACzGw0D,EAAS59D,SAASC,cAAc,UAChCguE,EAAK,sCAAwCogE,EAAUD,GAAWvpC,KAAO,OACzEz7F,EAAOilI,EAAUD,GAAWhlI,KAOhC,OANIA,EAAKxL,OAAS,KACdwL,EAAO,iCAAmCs7F,EAAc,WAE5D9mC,EAAOyY,UAAYpI,EAAK7kE,EACxBw0D,EAAOgZ,UAAY,aACnBhZ,EAAOo/C,UAAW,EACXp/C,WAGFwxE,EAASC,EAAUhB,EAAWrZ,GACnC,IAAK,IAAIoZ,KAAaC,GACdA,EAAU9rI,eAAe6rI,IAAeiB,EAASlgI,SAASi/H,KAG1DjlE,EAAM+yC,UAAYmyB,EAAUD,GAAWrpC,UAGtCspC,EAAUD,GAAWzpC,OAASspC,GAC3BI,EAAUD,GAAWnpC,kBACpBopC,EAAUD,GAAWzpC,QAAUspC,KAC/BI,EAAUD,GAAW1oC,SAAgC,+BAArB7xC,UAAUs7E,SAE/Cna,EAASx0H,YAAY85H,EAAa8T,EAAWC,KAG7CrZ,EAASx0H,YAAY0uI,EAAqBd,EAAWC,IACrDA,EAAUD,QAAa1pI,KAKnC,IAAI4qI,EAAS,CACT,aACA,OACA,gBACA,SACA,SACA,aAEAC,EAAS,GACb,IAAK,IAAIC,KAAatB,EACdA,EAAQ3rI,eAAeitI,IAAcF,EAAOngI,SAASqgI,IAGzDD,EAAOvnI,KAAKwnI,GAGhBJ,EAASE,EAAQpB,EAAS/kE,EAAMnoD,KAChC,IAAIyuH,EAAOzvI,SAASC,cAAc,OAMlC,GALAwvI,EAAK74D,UAAY,SACjBzN,EAAMnoD,IAAIxgB,YAAYivI,GACtBL,EAASG,EAAQrB,EAAS/kE,EAAMnoD,MAG3BitH,EAAU,CACX,IAAIyB,EAAY/hE,GAAGm0D,cAAc34D,EAAMnoD,IAAK,0DAC5C0uH,EAAUl4H,MAAMywE,OAAS,OACzBta,GAAGgJ,IAAI+4D,EAAW,CACd7vD,SAAU,OACV8E,MAAO,OACPrJ,WAAY,OACZwE,QAAS,OACT9B,aAAc,OACdkL,UAAW,WAInBtnF,KAAK+tI,QAAS,EAGlB7wD,aACI,OAAOl9E,KAAKof,IAGhB88E,OACSl8F,KAAK+tI,QACN/tI,KAAKqjC,OAETrjC,KAAKof,IAAIxJ,MAAMC,QAAU,QAG7BkmG,OACI/7G,KAAKof,IAAIxJ,MAAMC,QAAU,mBA7OjBimG,EACA8wB,EACA7d,EACAqe,EACAve,EACAC,EACAke,EACAF,EACAve,EACAI,EACArU,EACAqyB,QAXA7wB,SAAAA,OACA8wB,cAAAA,OACA7d,aAAAA,OACAqe,gBAAAA,OACAve,kBAAAA,OACAC,OAAAA,OACAke,gBAAAA,OACAF,mBAAAA,OACAve,YAAAA,OACAI,mBAAAA,OACArU,QAAAA,OACAqyB,cAAAA,EAjBT3sI,KAGK+tI,QAAS,EAgBb/tI,KAAKof,IAAMhhB,SAASC,cAAc,2BC8HtC6+E,aACI,OAAOl9E,KAAKqN,eAzIZ2gI,EACAC,GAOA,MAAM/1D,EAAWE,GAAgBG,cAEjCv4E,KAAKqN,GAAK0+D,GAAG1+D,GAAG,CACZ0H,QAAO,KACjB0jE,GAAK,yBAAyBP,EAAS1wE,SAAS0wE,EAASt6D,sBAE/Cm3D,IAAK,CACDsR,OAAQ,UAIhB,MAAM6nD,EAAuBniE,GAAG1+D,GAAG,CAC/B0H,QAAS0jE,GAAK,+BAAiC,QAC/C1D,IAAK,CACD6F,UAAW,UAGblvE,EAA8B,CAChC,CAAC,OAAQ+sE,GAAK,UAChB/6E,OACEm6E,GAAUv3C,KAAI3X,GACH,CAACA,EAAK/K,KAAM+K,EAAKnhB,KAAI,KAAQmhB,EAAK/K,YAG3CuwH,EAAiB,IAAItlC,GAAGkjC,OAAO,CACjCztD,UAAWzS,GAAara,QxJjDL,mBwJiDgCqa,GAAara,QxJjD7C,mBwJiDwE,OAC3FssB,UAAWpyE,EACXwpE,SAAWtvE,IACK,SAARA,EACAimE,GAAana,WxJrDF,mBwJuDXma,GAAapa,QxJvDF,kBwJuD2B7rD,GAE1CwoI,EAAax4H,MAAMC,QAAU,WAG/Bu4H,EAAeriE,GAAG1+D,GAAG,CACvB0H,QAAS0jE,GAAK,4BACd1D,IAAK,CACDl/D,QAAS,OACT+kE,UAAW,SA2DnB,GAvDAszD,EAAqB3nF,OACjB4nF,EAAejxD,aACfkxD,GAGJpuI,KAAKqN,GAAGk5C,OAAO2nF,GAGfniE,GAAG1+D,GAAG,CACFwhE,QAAS,SACTxnD,OAAQrnB,KAAKqN,GACb0H,QAAS,oCAAsC6iE,EAAAwoC,IAAY,2CAA6C3nC,GAAK,wBAC7GxD,QAAO,IAAQ+4D,IACfj5D,IAAK,CACD6F,UAAW,QAEf1d,OAAQ,CACJqgB,SAAU,QAMlBv9E,KAAKqN,GAAGk5C,OAAOwlB,GAAG1+D,GAAG,CAAC2nE,UAAW,SAAUD,IAAK,CAACsR,OAAQ,aAgCrD4nD,IACAjuI,KAAKqN,GAAGk5C,OAAO0nF,IACVA,EAAYx5D,WAAW,CACH1I,GAAG1+D,GAAG,CACvBga,OAAQ4mH,EACRl5D,IAAK,CACFuS,UAAW,YAGL/gC,OACTwlB,GAAG1+D,GAAG,CACF0H,QAAO,kEAAoE6iE,EAAAuoC,2FAxChFp0C,GAAG1+D,GAAG,CACTwhE,QAAS,IACT95D,QAAS0jE,GAAK,YACdxD,QAAO,KACHh4E,EAAA,SAAqBG,MAAKyK,IACtB,IAAI8zE,GAAM,CACNjN,MAAO3C,GAAG1+D,GAAG,CACT0H,QAAS0jE,GAAK,cAElB1jE,QAASg3D,GAAG1+D,GAAG,CACX0H,QAASg3D,GAAG1+D,GAAG,CACX0H,QAASlN,EAAOwmI,SAAS7xI,QAAO,MAAQ,QACxCu4E,IAAK,CACDmJ,QAAS,UAGjBnJ,IAAK,CACDhjB,OAAQ,OACRu8E,UAAW,YAGnBx8E,MAAO,IACP6oD,aAAa,WAyBjC76G,OAAO6lB,iBAAiB,WAAYjnB,IxJ7Ib,oBwJ8IfA,EAAEsH,KAGNmoI,EAAexwD,SACX9R,GAAara,QxJlJE,mBwJkJyBqa,GAAara,QxJlJtC,mBwJkJiE,qCC/HjE+8E,EAAoBC,EAAQC,GACvD,IAKIC,EALA7pB,EAAqB0pB,EACrBI,EAAa,GAKbC,EAAaJ,EACbza,EAAU,QAGV8a,EAAgB9iE,GAAG1+D,GAAG,CACtB4nE,QAASlJ,GAAGyO,YACZzF,IAAK,CACDxjD,SAAU,WACVxW,MAAO,QACPw4C,IAAK,QACLmmB,WAAY,OACZC,UAAW,8BACX6H,cAAe,OACftD,QAAS,IACT4B,OAAQ,iBACR2G,WAAY,wBACZzF,WAAY,OACZ7C,YAAa,gBAGrBpS,GAAGkb,qBAAqB,GAAG,SAAS1qF,GAChCsyI,EAAcj5H,MAAM6oE,gBAAkB,OAASliF,EAAM,OAEzD,IAKIuyI,EAAmBC,EALnBC,EAAmB5wI,SAASC,cAAc,UAC9C2wI,EAAiBp5H,MAAMC,QAAU,QACjCm5H,EAAiBl9E,MAAQ,IACzBk9E,EAAiBj9E,OAAS,IAC1B88E,EAAcjwI,YAAYowI,GAE1B,IAAIC,GAAuB,EAGvBzO,EAAmB3b,EAAS1D,YAC5B+tB,EAAoB1O,EAAiBxkI,OAAS,EAC9CmzI,EAAM/wI,SAASC,cAAc,OACjC8wI,EAAIv5H,MAAMmkE,YAAc,OACxBo1D,EAAIv5H,MAAMkkE,aAAe,OACzBq1D,EAAIv5H,MAAMilE,WAAa,OACvBs0D,EAAIv5H,MAAMglE,UAAY,OACtBu0D,EAAIv5H,MAAMooE,OAAS,UAEnB,IAAIoxD,EAAUhxI,SAASC,cAAc,gBAQ5B8jH,EAAY9E,GACjB,IAAIj+F,EAAMhhB,SAASC,cAAc,OAE7BykD,EAAQipB,GAAG1+D,GAAG,CACd0H,QAAS0jE,GAAK,sBAAwB,IACtC1D,IAAK,CACDgF,YAAa,SAIrB,MAAMs1D,EAAMtjE,GAAG1+D,GAAG,CACd0nE,IAAK,CACDl/D,QAAS,UAGjB,IAAInQ,EAAQtH,SAASC,cAAc,SACnCqH,EAAMjJ,MAAQooH,EAASb,SAAS3G,GAAO71G,KACvC9B,EAAM8lE,aAAa,oBAAqB,QACxC,MAAM8jE,EAAWvjE,GAAG1+D,GAAG,CACnBwhE,QAAS,SACT95D,QAAS,aAAe6iE,EAAAgT,IAAiB,kBACzClc,MAAO+J,GAAK,uBACZ1D,IAAK,CACD8F,WAAY,QAEhB5F,QAAO,KACHvvE,EAAMjJ,MAAQ,GACdiJ,EAAM2lE,WAGRkkE,EAAc,CAChB92D,GAAK,wBACLA,GAAK,wBACLA,GAAK,uBACLA,GAAK,cACLA,GAAK,6BAEH+2D,EAAiB,GACjBppE,EAAO2F,GAAG1+D,GAAG,CACf0nE,IAAK,CACDl/D,QAAS,OACT8kE,SAAU,OACVC,UAAW,MACXC,WAAY,UAGpB00D,EAAYlvG,SAAQ1X,IAChB,MAAM2yD,EAAMvP,GAAG1+D,GAAG,CACdga,OAAQ++C,EACRyI,QAAS,SACT95D,QAAS4T,EACTssD,QAAO,KACHvvE,EAAMjJ,MAAQ6+E,EAAI78E,aAEtBs2E,IAAK,CACDsR,OAAQ,iBAGhBmpD,EAAeppI,KAAKk1E,MAGxBl8D,EAAIxgB,YAAYkkD,GAChBA,EAAMyD,OAAO8oF,EAAKjpE,GAClBipE,EAAI9oF,OAAO7gD,EAAO4pI,GAElBxpH,YAAW,WACPpgB,EAAM2lE,QACN3lE,EAAMu5E,WACP,IAEHvG,GAAM,CACFtqE,OAAQqgI,EACRjqG,QAAO,MAAQi0C,GAAK,6BACpBr5D,IAAKA,EACL28C,QAAS,CAAC0c,GAAK,iBAAkB,UACjC2C,UAAW,CAAC3C,GAAK,kBACjB/rC,SAAU,SAAU9mC,GAMhB,GALAmmE,GAAGiP,UAAUs0D,GACbE,EAAenvG,SAAQ1X,IACnBojD,GAAGiP,UAAUryD,MAEjB6mH,EAAetpG,OAAO,EAAGspG,EAAexzI,QACpC4J,IAAQ6yE,GAAK,iBAAkB,CAC/B,GAAI/yE,EAAMjJ,QAAUooH,EAASb,SAAS3G,GAAO71G,KACzC,OAEJq9G,EAAS1C,YAAY9E,EAAO33G,EAAMjJ,OAClCgzI,IACA54D,GAAUR,OAAM,GAChBu4D,EAAWvxB,GACXxmC,GAAUR,OAAM,KAGxBmF,aAAc/C,GAAK,mBApG3B1M,GAAGgJ,IAAIq6D,EAAS,CACZt9E,MAAOA,QACPvgC,SAAU,aAuGd,IAAIm+G,EAAc3jE,GAAG1+D,GAAG,IAEvB8hI,EAAYQ,eAAiB,aAC7BR,EAAYS,cAAgB,aAC7B,IAoQIxK,EACAsD,EArQAmH,EAAYzxI,SAASC,cAAc,UACnCyxI,EAAe1xI,SAASC,cAAc,UACtC0xI,EAAW3xI,SAASC,cAAc,UAClC2xI,EAAY5xI,SAASC,cAAc,UACnC4xI,EAAY7xI,SAASC,cAAc,mBAmT9BoxI,aAEIS,EAAiBtjI,GACtB,IAAI+zG,EAAYkE,EAASb,SAASp3G,GAAOpF,KACrCq4E,EAAU2gD,EAAiB5zH,GAAOizE,QAClCswD,EAAc3P,EAAiB5zH,GAAO27F,QAAQ11C,OAE9CwqD,EAAQj/G,SAASC,cAAc,OACnCg/G,EAAMroC,UAAY,WAClB25D,EAAW/hI,GAASywG,EACnBA,EAAc+yB,KAAwC,IAA/B5P,EAAiBxkI,OAAS,GAAkB,GAAR4Q,EAC5Dm/D,GAAGgJ,IAAIsoC,EAAO,CACVvrD,MAAO,QACPC,OAAQ,OACR6tB,gBAAiB,sBACjBE,OAAQ,iBACRvuD,SAAU,WACVzW,KAAM,OACNy4C,IAAM8pD,EAAc+yB,KAAO,KAC3B3pD,WAAY,kBACZrK,aAAc,MACdsD,UAAW,eAEf,IAAI2wD,EAAajyI,SAASC,cAAc,OACxC0tE,GAAGgJ,IAAIs7D,EAAY,CACf9+G,SAAU,aAGd,IAAI++G,EAAalyI,SAASC,cAAc,OACxC0tE,GAAGgJ,IAAIu7D,EAAY,CACfx+E,MAAO,QACPC,OAAQ,SAEZ,IAsEIw+E,EAtEAC,EAAapyI,SAASC,cAAc,OACxCg/G,EAAMz+G,YAAYyxI,GAClBA,EAAWzxI,YAAY0xI,GACvBD,EAAWzxI,YAAY4xI,GAEtBnzB,EAAcozB,KAAO7jI,EAGtB,CACI,IAAI8jI,EAAkB3kE,GAAGod,QAAQgnD,EAAYr+E,MAAOq+E,EAAYp+E,OAAQ,GAAI,GAAI,GAC5E4+E,EAAStzB,EAAcszB,MAAQ5kE,GAAGlZ,OAAO69E,EAAgB5+E,MAAO4+E,EAAgB3+E,QAEhF6+E,EAAMD,EAAM79E,WAAW,MAC3B89E,EAAI3+D,OACA0+D,EAAM7+E,MAAQq+E,EAAYr+E,QAC1B8+E,EAAI1+D,uBAAwB,GAEhC0+D,EAAIp/D,UAAU2+D,EAAa,EAAG,EAAGQ,EAAM7+E,MAAO6+E,EAAM5+E,QACpD6+E,EAAIt+D,UACJvG,GAAGgJ,IAAKsoC,EAAcszB,MAAO,CACzBp/G,SAAU,WACVzW,MAAQ,GAAMuiG,EAAcszB,MAAM7+E,OAAS,EAAK,KAChDyB,KAAO,GAAM8pD,EAAcszB,MAAM5+E,QAAU,EAAK,KAChDosB,YAAa,eAEjBpS,GAAGkb,qBAAqB,GAAG,SAAS1qF,GAChCo0I,EAAM/6H,MAAM6oE,gBAAkB,OAASliF,EAAM,OAMhD8gH,EAAcv6D,MAAQ1kD,SAASC,cAAc,OAC7Cg/G,EAAcwzB,MAAQlwB,EACtBtD,EAAcv6D,MAAMyD,OAAQ82D,EAAcwzB,OAE3C9kE,GAAGgJ,IAAKsoC,EAAcv6D,MAAO,CACzBvxB,SAAU,WACVzW,KAAM,OACNy4C,IAAK,MACL0qB,SAAU,OACVnsB,MAAO,QACPC,OAAQ,OACR8mB,SAAU,SACVkK,MAAO,OACPiM,WAAY,WAGfquB,EAAcv6D,MAAMguF,WAAa,WAC9B3uB,EAAa9E,EAAcozB,OAK9BpzB,EAAc0zB,aAAe3yI,SAASC,cAAc,OACpDg/G,EAAcx9B,QAAUA,EACxBw9B,EAAc0zB,aAAaxqF,OAAO1V,SAAS,GAA+B,IAAxBwsE,EAAcx9B,SAAkB,KAEnF9T,GAAGgJ,IAAKsoC,EAAc0zB,aAAc,CAChCx/G,SAAU,WACVzW,KAAM,QACNy4C,IAAK,MACL0qB,SAAU,OACVqJ,UAAW,QACXx1B,MAAO,OACPixB,MAAO,OACP0D,WAAY,2BAKpB,IAAIgwB,EAAgB,IAAI3wB,GAAY,CAChCziD,KAAOg6E,EAAcx9B,QACrB/tB,MAAO,IACPs0B,UAAW,GACX15C,SAAU,SAASskG,EAAazqD,EAAS0qD,GACrC,OAAI1qD,GACAgqD,EAAa1rB,EAASb,SAAU3G,EAAcozB,MAAM5wD,aACpDhJ,GAAUR,OAAM,IAGhB46D,GACAp6D,GAAUR,OAAM,QACZk6D,IAAeS,GACfnsB,EAASnE,aAAcrD,EAAcozB,KAAMO,MAIlD3zB,EAAc0zB,aAAat8D,UAAY92E,KAAK4jC,MAAoB,IAAdyvG,GAAqB,SACxEnsB,EAASnE,aAAcrD,EAAcozB,KAAMO,OAGnDjlE,GAAGgJ,IAAI0hC,EAAc/vB,QAAS,CAC1Bn1D,SAAU,WACVzW,KAAM,OACNy4C,IAAK,SAER8pD,EAAc5G,cAAgBA,EAG/B1qC,GAAGwJ,iBAAkB8nC,EAAcszB,MAAO,iBAAiB,SAAUjyI,GACjE,GAAkB,IAAdA,EAAEq9D,WAAmBr9D,EAAEk9D,aAAiC,UAAlBl9D,EAAEk9D,aACxC,OAGJ,IAAI80E,EAAkB3kE,GAAGod,QAAQgnD,EAAYr+E,MAAOq+E,EAAYp+E,OAAQ,IAAK,IAAK,GAE9Ei9E,EAAiBl9E,QAAU4+E,EAAgB5+E,OAASk9E,EAAiBj9E,SAAW2+E,EAAgB3+E,SAChGi9E,EAAiBl9E,MAAQ4+E,EAAgB5+E,MACzCk9E,EAAiBj9E,OAAS2+E,EAAgB3+E,QAE9C,IAAIsT,EAAM2pE,EAAiBl8E,WAAW,MACtCuS,EAAI4M,OACA+8D,EAAiBl9E,MAAQq+E,EAAYr+E,QACrCuT,EAAI6M,uBAAwB,GAEhC7M,EAAI8M,sBAAwB,OAC5B9M,EAAImtB,UAAU,EAAG,EAAGw8C,EAAiBl9E,MAAOk9E,EAAiBj9E,QAC7DsT,EAAImM,UAAU2+D,EAAa,EAAG,EAAGnB,EAAiBl9E,MAAOk9E,EAAiBj9E,QAC1EsT,EAAIiN,UACJvG,GAAGgJ,IAAI85D,EAAe,CAClBt7E,IAAM70D,EAAEq6D,QAAUi2E,EAAiBj9E,OAAS,EAAK,KACjD8tB,QAAS,OAEgB,IAAzBovD,IACA7wI,SAAS0oD,KAAKloD,YAAYiwI,GAC1BI,GAAuB,GAE3Bh2E,aAAa81E,GACbA,EAAsBjpH,YAAW,WAC7BimD,GAAGgJ,IAAI85D,EAAe,CAClBhvD,QAAS,QAEd,IACH5mB,aAAa61E,MAEjB/iE,GAAGwJ,iBAAkB8nC,EAAcszB,MAAO,gBAAgB,WACtD13E,aAAa81E,GACbhjE,GAAGgJ,IAAI85D,EAAe,CAClBhvD,QAAS,MAEb5mB,aAAa61E,GACbA,EAAoBhpH,YAAW,WACtBmpH,IAGL7wI,SAAS0oD,KAAKjhC,YAAYgpH,GAC1BI,GAAuB,KACxB,QAGPqB,EAAW1xI,YAAay+G,EAAcszB,OACtCL,EAAW1xI,YAAay+G,EAAcv6D,OACtCwtF,EAAW1xI,YAAay+G,EAAc0zB,cACtCT,EAAW1xI,YAAY63G,EAAc/vB,SACrC,IAAIwqD,GAAY,EACZC,GAAiB,EA2DpB9zB,EAAcr7B,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CACpDj0E,OAAQkiI,EACRp2E,YAAa,EACbL,mBA3DsB70C,GACtB,GAAmB,gBAAfA,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OACtC+P,GAAGgJ,IAAIsoC,EAAO,CACV52B,WAAY,gCAGhB42B,EAAMznG,MAAM0jE,OAAS,IACrB83D,EAAW/zB,EAAcozB,KACzBU,GAAiB,EACX9zB,EAAcg0B,aAChBF,GAAiB,EAChBhC,EAAYmC,cAAej0B,EAAcozB,OAE9CS,GAAY,OAET,GAAmB,gBAAflsH,EAAMzmB,MAA2C,SAAjBymB,EAAMg3C,OAAmB,CAE5Dk1E,IACAA,GAAY,EACZnlE,GAAGgJ,IAAIsoC,EAAO,CACV1jC,UAAW,iCAGlB0jC,EAAc+yB,MAAQprH,EAAMo4C,GAC7B,IAAI1B,EAAY/9D,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAqC,IAAhC8zH,EAAiBxkI,OAAS,GAAYqhH,EAAc+yB,OAC1F/yB,EAAMznG,MAAM29C,IAAMmI,EAAY,cAoERz/D,EAAIs1I,GAEtC,IADAA,EAAU5zI,KAAK+O,IAAI8zH,EAAiBxkI,OAAS,EAAG2B,KAAK6O,IAAI,EAAG+kI,OAC5CH,EACZ,OAEJ,IAAK,IAAIr1I,EAAI,EAAGA,EAAIykI,EAAiBxkI,OAAQD,IAAK,CAC9C,GAAI4yI,EAAW5yI,GAAG00I,OAASx0I,EACvB,SAEJ,IAAIu1I,EAAO7C,EAAW5yI,GAAG00I,KACrB9B,EAAW5yI,GAAG00I,KAAOx0I,GACrBu1I,IAEAA,GAAQD,GACRC,IAEJ7C,EAAW5yI,GAAGq0I,KAAI,IAAmC5P,EAAiBxkI,OAASw1I,EAAO,GACtF7C,EAAW5yI,GAAG6Z,MAAM29C,IAAMo7E,EAAW5yI,GAAGq0I,KAAO,KAEnDgB,EAAUG,EAtFEE,CAA8Bp0B,EAAcozB,KAAMiB,EAAWr0B,EAAc+yB,OAG/E,GAAmB,cAAfprH,EAAMzmB,KAAsB,CAC5BwtE,GAAGgJ,IAAIsoC,EAAO,CACV52B,WAAY,oBAEhB3gE,YAAW,WACPimD,GAAGgJ,IAAIsoC,EAAO,CACV1jC,UAAW,OAEhB,IACF0jC,EAAc+yB,KAAOzyI,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAqC,IAAhC8zH,EAAiBxkI,OAAS,GAAYqhH,EAAc+yB,OAEhG/yB,EAAMznG,MAAM0jE,OAAS,GACrB,IAAIq4D,EAAUD,EAAWr0B,EAAc+yB,MACnCwB,EAAWv0B,EAAcozB,eAyE/BoB,EAAcC,GACxB,GAAIthE,MAAMqhE,IAAiBrhE,MAAMshE,GAC7B,KAAM,8BAEV,IAAK,IAAI/1I,EAAI,EAAGA,EAAIykI,EAAiBxkI,OAAQD,KAAC,SAC/BA,GACP,IAAIy1I,EAAO7C,EAAW5yI,GAAG00I,KACrB9B,EAAW5yI,GAAG00I,OAASoB,EACvBL,EAAOM,GAEHnD,EAAW5yI,GAAG00I,KAAOoB,GACrBL,IACAA,GAAQM,GACRN,KAER7C,EAAW5yI,GAAG00I,KAAOe,EACrB7C,EAAW5yI,GAAGq0I,KAAI,IAAmC5P,EAAiBxkI,OAASw1I,EAAO,GACtF7C,EAAW5yI,GAAG6Z,MAAM29C,IAAMo7E,EAAW5yI,GAAGq0I,KAAO,KAbT,CAcxCr0I,GAEN,GAAI81I,IAAiBC,EACjB,OAEJjtB,EAASzC,UAAU8sB,EAAmB4C,EAAeD,GACrDrR,EAAmB3b,EAAS1D,YAC5B+tB,EAAoB4C,EACpB/B,EAAS30B,SAAiC,IAAtB8zB,EAlGR/5C,CAAMkoB,EAAcozB,KAAMkB,GACtBC,GAAWD,IACX96D,GAAUR,OAAM,GAChBu4D,EAAWM,GACXr4D,GAAUR,OAAM,IAEhBu7D,IAAYD,GAAWR,GACvBvC,EAAWM,GAEfiC,GAAiB,MAUzBzB,EAAY9wI,YAAYy+G,OA7P5BqxB,EAAkB73D,GAAU1vB,WA+P5BwnF,EAAa,GACNe,EAAYqC,YAAY,CAC3B,IAAIC,EAAQtC,EAAYqC,WACvBC,EAAchwD,gBAAgBziB,UAC9ByyE,EAAcv7B,cAAcl3C,UAC7BmwE,EAAY7pH,YAAYmsH,GAE5B,IAAK,IAAIj2I,EAAI,EAAGA,EAAIykI,EAAiBxkI,OAAQD,IACzCm0I,EAAiBn0I,GAEpBozI,EAAYmC,cAAcpC,GAoG3BQ,EAAY95H,MAAMm8C,OAA8B,GAApB48E,EAAW3yI,OAAe,cA3FjD01I,EAAUh4E,GACf,IAAI7xD,EAASgpC,SAAS,IAAO6oB,EAAC,GAAmC,KAGjE,OAFA7xD,EAASlK,KAAK+O,IAAI8zH,EAAiBxkI,OAAS,EAAG2B,KAAK6O,IAAI,EAAG3E,IAC3DA,EAAS24H,EAAiBxkI,OAAS6L,EAAS,EACrCA,EA5UXsnI,EAAIvwI,uBA3PA,IAAIqzI,EAAM7zI,SAASC,cAAc,OAyPjC,OADAynB,uBAtPIimD,GAAGg8D,gBAAgB8H,GACnB9jE,GAAGg8D,gBAAgB+H,GACnB/jE,GAAGg8D,gBAAgBgI,GACnBhkE,GAAGg8D,gBAAgBiI,GACnBjkE,GAAGg8D,gBAAgBkI,GAEnBJ,EAAUj6H,MAAM2pE,SAAW,OAC3BuwD,EAAal6H,MAAM2pE,SAAW,OAC9BwwD,EAASn6H,MAAM2pE,SAAW,OAC1BywD,EAAUp6H,MAAM2pE,SAAW,OAC3B0wD,EAAUr6H,MAAM2pE,SAAW,OAE3BswD,EAAUnhE,MAAQ+J,GAAK,cACvBq3D,EAAaphE,MAAQ+J,GAAK,oBAC1Bu3D,EAAUthE,MAAQ+J,GAAK,iBACvBs3D,EAASrhE,MAAQ+J,GAAK,gBACtBw3D,EAAUvhE,MAAQ+J,GAAK,uBAEvBo3D,EAAUj6H,MAAMgnE,YAAc,MAC9BizD,EAAUj6H,MAAMmzH,aAAe,MAE/BiH,EAAUp6H,MAAMgnE,YAAc,MAC9BozD,EAAUp6H,MAAMmzH,aAAe,MAE/B+G,EAAal6H,MAAMgnE,YAAc,MACjCkzD,EAAal6H,MAAMmzH,aAAe,MAElCgH,EAASn6H,MAAMgnE,YAAc,MAC7BmzD,EAASn6H,MAAMmzH,aAAe,MAE9BkH,EAAUr6H,MAAMm8C,OAAS,OACzBk+E,EAAUr6H,MAAM6jE,WAAa,OAE7Bo2D,EAAUp7D,UAAY,aAAemD,EAAA6S,IAAc,kBACnDqlD,EAAar7D,UAAY,aAAemD,EAAA8S,IAAoB,kBAC5DqlD,EAASt7D,UAAY,aAAemD,EAAA+S,IAAgB,kBACpDqlD,EAAUv7D,UAAY,aAAemD,EAAAgT,IAAiB,kBACtDqlD,EAAUx7D,UAAY,aAAemD,EAAA8X,IAAiB,kBACtDmgD,EAAUj6H,MAAMmkE,YAAc,MAC9Bi2D,EAAUp6H,MAAMmkE,YAAc,MAC9B+1D,EAAal6H,MAAMmkE,YAAc,MACjCg2D,EAASn6H,MAAMmkE,YAAc,MAC7Bk4D,EAAIrzI,YAAYixI,GAChBoC,EAAIrzI,YAAYoxI,GAChBiC,EAAIrzI,YAAYkxI,GAChBmC,EAAIrzI,YAAYmxI,GAChBkC,EAAIrzI,YAAYqxI,GAChBgC,EAAIrzI,YAAYmtE,GAAG1+D,GAAG,CAClB0nE,IAAK,CACD/uD,MAAO,WAIf,IAAIksH,EAAY9zI,SAASC,cAAc,OACvC6zI,EAAUt8H,MAAMoQ,MAAQ,OACxBksH,EAAUt8H,MAAMm8C,OAAS,OACzBkgF,EAAIrzI,YAAYszI,GAGhBrC,EAAUt1D,QAAU,YAC6B,IAAzCsqC,EAASpE,SAASyuB,KAGtB1O,EAAmB3b,EAAS1D,Y3H/NlB,K2HiONqf,EAAiBxkI,SACjB6zI,EAAUz0B,UAAW,EACrB00B,EAAa10B,UAAW,GAE5B40B,EAAU50B,UAAW,EACrB8zB,GAAwC,EACxCO,IACA54D,GAAUR,OAAM,GAChBu4D,EAAWM,GACXr4D,GAAUR,OAAM,KAEpBy5D,EAAav1D,QAAU,YACgC,IAA/CsqC,EAAS7C,eAAektB,KAG5B1O,EAAmB3b,EAAS1D,Y3HhPlB,K2HiPNqf,EAAiBxkI,SACjB6zI,EAAUz0B,UAAW,EACrB00B,EAAa10B,UAAW,GAE5B40B,EAAU50B,UAAW,EACrB8zB,IACAO,IACA54D,GAAUR,OAAM,GAChBu4D,EAAWM,GACXr4D,GAAUR,OAAM,KAEpB25D,EAAUz1D,QAAU,WACZo0D,EAAW3yI,QAAU,IAIzB6oH,EAASzD,YAAY8tB,GACjBA,EAAoB,GACpBA,IAEJ1O,EAAmB3b,EAAS1D,YAC5BsuB,IACA54D,GAAUR,OAAM,GAChBu4D,EAAWM,GACXr4D,GAAUR,OAAM,GACgB,IAA5BmqD,EAAiBxkI,SACjBg0I,EAAU50B,UAAW,GAErBolB,EAAiBxkI,O3H7QX,K2H8QN6zI,EAAUz0B,UAAW,EACrB00B,EAAa10B,UAAW,KAGhC20B,EAASx1D,QAAU,WACX20D,GAAqB,YAIJx1E,GACjB,IAAIt6C,EAAMhhB,SAASC,cAAc,OACjC+gB,EAAIq1D,UAAYgE,GAAK,4BAErB,IAAI/sE,EAAU,IAAI87E,GAAQ,CACtB1J,UAAW,CACP,CAAC7hF,GAAIy9D,EAAE+1B,WAAY3sC,MAAO8sC,GAAkBl2B,EAAE+1B,aAC9C,CAACxzF,GAAI,YAAa6mD,MAAO,aACzB,CAAC7mD,GAAI,aAAc6mD,MAAO,cAC1B,CAAC7mD,GAAI,cAAe6mD,MAAO,eAC3B,CAAC7mD,GAAI,iBAAkB6mD,MAAO,kBAC9B,CAAC7mD,GAAI,kBAAmB6mD,MAAO,mBAC/B,CAAC7mD,GAAI,mBAAoB6mD,MAAO,oBAChC,CAAC7mD,GAAI,MAAO6mD,MAAO,QAEvBi8B,OAAQrlB,EAAE+1B,WACVva,SAAU,SAASj5E,GACfwwC,KAEJq7C,SAAS,IAEbp8E,EAAQwxE,aAAatnE,MAAMglE,UAAY,MACvCx7D,EAAIxgB,YAAY8M,EAAQwxE,cAExB,IAAIwlD,EAAUtkI,SAASC,cAAc,UACrCqkI,EAAQh0D,MAAQ+J,GAAK,WACrB,IAAI05D,EAAS/zI,SAASC,cAAc,OACpC8zI,EAAO19D,UAAY,QACnB09D,EAAOv8H,MAAMoQ,MAAQ,OACrB5G,EAAIxgB,YAAYuzI,GAChB/yH,EAAIxgB,YAAY8jI,GAChB,IAAIgO,EAAkB3kE,GAAGod,QAAQzvB,EAAE04E,UAAUtgF,MAAO4H,EAAE04E,UAAUrgF,OAAQ,IAAK,IAAK,GAClF2wE,EAAQ5wE,MAAQ4+E,EAAgB5+E,MAChC4wE,EAAQ3wE,OAAS2+E,EAAgB3+E,OACjCga,GAAGgJ,IAAI2tD,EAAS,CACZ7sH,QAAS,QACTglE,WAAY,OACZd,YAAa,OACboE,YAAa,eAEjBukD,EAAQ9sH,MAAM+jE,UAAY,0BAC1B5N,GAAGkb,qBAAqB,GAAG,SAAS1qF,GAChCmmI,EAAQ9sH,MAAM6oE,gBAAkB,OAASliF,EAAM,OAGnD,IAAI81I,EAActmE,GAAG0nC,WAAWivB,YAIvBj2F,IACL,IAAI44B,EAAMq9D,EAAQ5vE,WAAW,MAC7BuS,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAGkwC,EAAQ5wE,MAAO4wE,EAAQ3wE,QACvC2wE,EAAQ5wE,MAAQ4H,EAAE04E,UAAUtgF,QAC5BuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU9X,EAAE44E,aAAc,EAAG,EAAG5P,EAAQ5wE,MAAO4wE,EAAQ3wE,QAEhC,aAAvBrmD,EAAQsxE,YACR3X,EAAIwO,yBAA2B,iBAC/BxO,EAAI+mB,YAAc1yB,EAAE8oD,WACpBn9C,EAAImM,UAAU6gE,EAAa,EAAG,EAAG3P,EAAQ5wE,MAAO4wE,EAAQ3wE,UAExDsT,EAAIwO,yBAA2BnoE,EAAQsxE,WACvC3X,EAAI+mB,YAAc1yB,EAAE8oD,WACpBn9C,EAAImM,UAAU9X,EAAE04E,UAAW,EAAG,EAAG1P,EAAQ5wE,MAAO4wE,EAAQ3wE,SAE5DsT,EAAIiN,UArBR+/D,EAAYv/E,WAAW,MAAM0e,UAAU9X,EAAE04E,UAAW,EAAG,EAAGC,EAAYvgF,MAAOugF,EAAYtgF,QACzFga,GAAG02C,4BAA4B4vB,GAuB/B5lG,IAGA,IAAIqqB,EAAc,IAAIiV,GAAGmO,YAAY,CACjCrE,OAAQ,SAAS3hB,GACE,UAAXA,GACAxoD,EAAQmM,OAEG,SAAXq8C,GACAxoD,EAAQg8B,cAKpBgxC,GAAM,CACFtqE,OAAQqgI,EACRjqG,QAAO,MAAQi0C,GAAK,kCACpBr5D,IAAKA,EACL28C,QAAS,CAAC,KAAM,UAChByf,aAAc,KACd9uC,SAAU,SAAU9mC,GAChBkxD,EAAYyI,UACZ7zD,EAAQ6zD,UACI,OAAR35D,GACA8zD,EAAEhtB,SAAShhC,EAAQsxE,eAKnCu1D,CAAY,CACRH,UAAW5R,EAAiB0O,GAAmB3mC,QAAQ11C,OACvDy/E,aAAc9R,EAAiB0O,EAAoB,GAAG3mC,QAAQ11C,OAC9D2vD,WAAYqC,EAASb,SAASkrB,GAAmBrvD,QACjD4P,WAAY+wC,EAAiB0O,GAAmBz/C,WAChD/iD,SAAU,SAAUrmC,GAChBw+G,EAASxC,YAAY6sB,EAAmBA,EAAoB,EAAG7oI,GAC/Dm6H,EAAmB3b,EAAS1D,YAC5B+tB,IACgC,IAA5B1O,EAAiBxkI,SACjBg0I,EAAU50B,UAAW,GAErBolB,EAAiBxkI,O3HtYnB,K2HuYE6zI,EAAUz0B,UAAW,EACrB00B,EAAa10B,UAAW,GAE5Bq0B,IACA54D,GAAUR,OAAM,GAChBu4D,EAAWM,GACXr4D,GAAUR,OAAM,OAK5B45D,EAAU11D,QAAU,WAChB4nC,EAAY+sB,MAGF,GACX+C,EAEKO,IAKZpN,EAAcr5D,GAAG1+D,GAAG,CAChB0H,QAAS0jE,GAAK,mBAAqB,SACnC1D,IAAK,CACDkJ,SAAU,UAIlByqD,EAAa,IAAIhrD,GAAO,CACpBI,UAAW,CACP,cACA,KACA,SACA,WACA,aACA,KACA,UACA,SACA,cACA,KACA,UACA,aACA,aACA,KACA,aACA,YACA,KACA,MACA,aACA,QACA,cACFx9C,KAAK3X,GACIA,EAAO,CAACA,EAAMinE,GAAkBjnE,IAAS,OAEpDusD,SAAU,SAAStvE,GACfi/G,EAASR,WAAW6qB,EAAmBtpI,GACtCupI,EAAY1iG,OAAOyiG,IAExBn6D,IAAK,CACD+E,aAAc,UAItBsrD,EAAYxmI,YAAY8pI,EAAWxrD,cACnCiyD,EAAIvwI,YAAYwmI,GAoRpBgK,EAAQxwI,YAAY8wI,GACpBP,EAAIvwI,YAAYwwI,GAUhB,IAAIgC,EAAU,EAwJd,OA/F2BlsE,aAAY,WACnC,GAA0B,UAAtBiqE,EAAIv5H,MAAMC,QACV,OAGJ,IAAI48H,EAAe57D,GAAU1vB,WAC7B,GAAIsrF,IAAiB/D,EAArB,CAGAA,EAAkB+D,EAElB,IAAK,IAAI12I,EAAI,EAAGA,EAAI4yI,EAAW3yI,OAAQD,IACnC,GAAImzI,IAAsBP,EAAW5yI,GAAG00I,MAAQjQ,EAAiBmO,EAAW5yI,GAAG00I,MAAO,CAClF,IAAIprE,EAAMspE,EAAW5yI,GAAG40I,MAAM79E,WAAW,MACzCuS,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAGntB,EAAIxS,OAAOf,MAAOuT,EAAIxS,OAAOd,QAC7CyuE,EAAiBmO,EAAW5yI,GAAG00I,MAAMloC,QAAQ11C,OAAOf,MAAQ68E,EAAW5yI,GAAG40I,MAAM7+E,QAChFuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAUgvD,EAAiBmO,EAAW5yI,GAAG00I,MAAMloC,QAAQ11C,OAAQ,EAAG,EAAG87E,EAAW5yI,GAAG40I,MAAM7+E,MAAO68E,EAAW5yI,GAAG40I,MAAM5+E,QACxHsT,EAAIiN,cAIb,GAQF68D,EAAY1iG,OAAS,SAAUimG,GAC5BlS,EAAmB3b,EAAS1D,aACxBuxB,GAAiD,IAAzBA,KACxBxD,EAAoBwD,GAExB1C,EAAU50B,SAAuC,IAA5BolB,EAAiBxkI,O3Ht0BpB,K2Hu0BdwkI,EAAiBxkI,QACjB6zI,EAAUz0B,UAAW,EACrB00B,EAAa10B,UAAW,IAExBy0B,EAAUz0B,UAAW,EACrB00B,EAAa10B,UAAW,GAE5Bt1F,YAAW,WACP2pH,MACD,IAENN,EAAY9B,YAAc,WACvB,OAAO6B,GAEVC,EAAYmC,cAAgB,SAAUqB,GACnC,GAAIA,EAAY,GAAKA,EAAYhE,EAAW3yI,OAAS,EACjD,KAAM,qBAAuB22I,EAAY,uBAAyBhE,EAAW3yI,OAEjFkzI,EAAoByD,EACpBjK,EAAW/qD,SAAS6iD,EAAiB0O,GAAmBz/C,YACxD,IAAK,IAAI1zF,EAAI,EAAGA,EAAI4yI,EAAW3yI,OAAQD,IAC/BmzI,IAAsBP,EAAW5yI,GAAG00I,MACpC9B,EAAW5yI,GAAG6Z,MAAMgqE,gBAAkB,sBACtC+uD,EAAW5yI,GAAG+mD,MAAMltC,MAAMmtE,MAAQ,OAClC4rD,EAAW5yI,GAAG6Z,MAAM+jE,UAAY,GAChCg1D,EAAW5yI,GAAG6Z,MAAMkqE,OAAS,0CAC7B6uD,EAAW5yI,GAAG06G,cAAc9vB,WAAU,GACtCgoD,EAAW5yI,GAAGs1I,YAAa,IAE3B1C,EAAW5yI,GAAG6Z,MAAMgqE,gBAAkB,sBACtC+uD,EAAW5yI,GAAG+mD,MAAMltC,MAAMmtE,MAAQ,OAClC4rD,EAAW5yI,GAAG6Z,MAAM+jE,UAAY,GAChCg1D,EAAW5yI,GAAG6Z,MAAMkqE,OAAS,+BAC7B6uD,EAAW5yI,GAAG06G,cAAc9vB,WAAU,GACtCgoD,EAAW5yI,GAAGs1I,YAAa,GAGnCtB,EAAS30B,SAAiC,IAAtB8zB,GAEvBC,EAAY9a,WAAa,SAASsC,GAC/B5C,EAAU,GAAK4C,EAEC,SAAZ5C,EACAhoD,GAAGgJ,IAAI85D,EAAe,CAClB/zH,KAAM,QACNC,MAAO,KAGXgxD,GAAGgJ,IAAI85D,EAAe,CAClB/zH,KAAM,GACNC,MAAO,WAKnB00H,IAEON,a/B5uBPt4D,kBACAT,UgC/JSw8D,GAyFT11D,aACI,OAAOl9E,KAAKqN,eAvFJmqD,GACR,IAAIp4C,EAAMhhB,SAASC,cAAc,gBASxBq6H,EAAah/D,GAClB,IAAIwkB,EAAU,GAAKxkB,EAAEi/D,aAAej/D,EAAEi/D,aAAe,GACjD9wH,EAASkkE,GAAG1+D,GAAG,CACf2nE,UAAW,mCACXtG,MAAOhV,EAAEgV,MACTuG,QAASvb,EAAEub,QACXF,IAAK,CACDmJ,QAASxkB,EAAE3kD,QAAU,GAAM2kD,EAAEk/D,QAAU16C,EAAU,OAAS,MAGlE,GAAIxkB,EAAE3kD,QACFlN,EAAOjJ,YAAY86D,EAAE3kD,aAClB,CACH,IAAIs3D,EAAKN,GAAG1+D,GAAG,CACX0nE,IAAK,CACD0J,gBAAiB,QAAW/kB,EAAEglB,MAAQ,KACtCe,iBAAkB,YAClBkc,mBAAoB,SACpBnc,eAAgB9lB,EAAEk/D,QAAU,UAAY,GAExC7mE,OAAQ,UAGhBsa,EAAGz2D,MAAM4rE,cAAgB,OACzB35E,EAAOjJ,YAAYytE,GAYvB,OAVCxkE,EAAem6E,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CACrDj0E,OAAQvG,EACRoyD,aAAc,SAASqF,GACfA,EACAyM,GAAGkO,aAAapyE,EAAQ,8BAExBkkE,GAAGyR,gBAAgB31E,EAAQ,iCAIhCA,EA5CX7H,KAAKqN,GAAK+R,EACV2sD,GAAGgJ,IAAI31D,EAAK,CACR2yC,OAAQ,OAERl8C,QAAS,OACT4oE,gBAAiB,uFA0CrB,IAAIo0D,EAAena,EAAa,CAC5BzjD,QAASzd,EAAEs7E,SACXpkE,MAAO+J,GAAK,gBACZ1jE,QAASg3D,GAAG1+D,GAAG,CACX0H,QAAS0jE,GAAK,UACdzD,UAAW,+BACXD,IAAK,CACDl/D,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBpnB,MAAO,OACPC,OAAQ,UAGhB6mE,SAAS,IAEbia,EAAaj9H,MAAMk8C,MAAQ,OAE3B,IAAIihF,EAAara,EAAa,CAC1BzjD,QAASzd,EAAE+hE,OACX7qD,MAAO+J,GAAK,QACZiG,MAAO9G,EAAAyiB,IACPu+B,SAAS,IAGToa,EAAkBta,EAAa,CAC/BzjD,QAASzd,EAAEw2E,YACXt/D,MAAO+J,GAAK,wBACZiG,MAAO9G,EAAAwoC,IACPwY,SAAS,IAGbx5G,EAAIxgB,YAAYi0I,GAChBzzH,EAAIxgB,YAAYo0I,GAChB5zH,EAAIxgB,YAAYm0I,ICxGjB,MCQME,GAAM,WACnB,IAAIj2I,EAAe,GA0InB,IAAIk2I,WAEKpmG,EAAMqmG,EAAI12I,EAAO22I,GACtB,OAAOz1I,KAAK6O,IAAI2mI,EAAIx1I,KAAK+O,IAAIjQ,EAAO22I,aAG/BC,EAAYC,GACjB,MAAO,CACH7/G,EAAG6/G,EACHC,eAAgB,SAAS9gI,GAErBygI,EAAKlzI,KAAKyzB,EAAE0/B,GACZnzD,KAAKyzB,EAAE8/G,eAAe9gI,IAE1B8sD,QAAS,WAEL2zE,EAAKlzI,KAAKyzB,EAAE0/B,GACZnzD,KAAKyzB,EAAE8rC,qBAKVi0E,EAAQ/gI,GACb,OAAO4gI,EAAYI,EAAQC,YAAYjhI,aAGlCkhI,EAAW7hF,EAAOC,GACvB,IAAIxzD,EAAO20I,EAAGU,cAMd,GAAIV,EAAGW,aAAa,sBAAwBX,EAAGW,aAAa,4BAA6B,CACrF,IAAIC,EAAc,IAAIL,EAAQ,IAAK,IAAKP,EAAGa,KAAMb,EAAGc,OACpD,IAEIF,EAAYG,QAAO,WAAa11I,EAAO20I,EAAGc,SAC5C,MAAOt1I,IAETo1I,EAAYv0E,UAGZv/D,KAAKyzB,EAAE6/G,SAAStzI,KAAKyzB,EAAE6/G,QAAQ/zE,UAC/Bv/D,KAAKyzB,EAAEygH,cAAcl0I,KAAKyzB,EAAEygH,aAAa30E,UAC7Cv/D,KAAK8xD,MAAQA,EACb9xD,KAAK+xD,OAASA,EACd/xD,KAAKyzB,EAAE6/G,QAAU,IAAIG,EAAQ3hF,EAAOC,EAAQmhF,EAAGa,KAAMx1I,GACrDyB,KAAKyzB,EAAEygH,aAAe,IAAIT,EAAQ3hF,EAAOC,EAAQmhF,EAAGa,KAAMx1I,GAC1DyB,KAAKyzB,EAAE0gH,aAAen0I,KAAKyzB,EAAE0gH,cAAgB,IAAIV,EAAQ,EAAG,EAAGP,EAAGa,KAAMx1I,GACxEyB,KAAKyzB,EAAE2gH,cAAgBp0I,KAAKyzB,EAAE2gH,eAAiB,IAAIC,EAAO,KAAM,uLAM7D,iBACHr0I,KAAKyzB,EAAE6gH,eAAgB,EAOzB,SACOjgC,EAAKi/B,EAASxhF,EAAOC,GAU1B,OATK/xD,KAAKyzB,EAAE6gH,eAAiBhB,EAAQ7/G,EAAEq+B,OAAS9xD,KAAK8xD,OAASwhF,EAAQ7/G,EAAEs+B,QAAU/xD,KAAK+xD,QACnF4hF,EAAW5yI,KAAKf,KAAM8xD,GAAgBwhF,EAAQ7/G,EAAEq+B,MAAOC,GAAkBuhF,EAAQ7/G,EAAEs+B,QAGvFuhF,EAAQ7/G,EAAE8gH,MACVv0I,KAAKyzB,EAAE6/G,QAAQW,QAAO,WAClBI,EAAOG,mBAAmBC,cAGvBz0I,cAGFysC,IAGL,OAFAzsC,KAAKyzB,EAAE6/G,QAAQiB,MACfv0I,KAAKyzB,EAAE2gH,cAAcK,WACdz0I,cAGF00I,EAAaC,EAAQC,EAAUC,EAAWC,IAC9CD,GAAa70I,KAAKyzB,EAAE6/G,SAASiB,MAC9Bv0I,KAAKyzB,EAAEygH,aAAaD,QAAO,WACvBU,EAAOC,SAASA,GAAUH,cAE9Bz0I,KAAKyzB,EAAEygH,aAAaa,SAASD,GAAc90I,KAAKyzB,EAAE6/G,kBAG7C92I,EAAQw4I,GAGb,OAFAA,EAAK9oE,WAAWC,aAAansE,KAAMg1I,GACnCA,EAAK9oE,WAAWrmD,YAAYmvH,GACrBh1I,cAGFi1I,IACL,IAAI3B,EAAU,IAAIG,EAAQzzI,KAAKyzB,EAAE6/G,QAAQxhF,MAAO9xD,KAAKyzB,EAAE6/G,QAAQvhF,OAAQmhF,EAAGa,KAAMb,EAAGU,eAKnF,OAJA5zI,KAAKyzB,EAAE6/G,QAAQiB,MACfjB,EAAQW,QAAO,WACXI,EAAOG,mBAAmBC,cAEvBpB,EAAYC,GAMrB,SACO4B,IACL,IAAItjF,EAAI5xD,KAAKyzB,EAAE6/G,QAAQxhF,MACnBD,EAAI7xD,KAAKyzB,EAAE6/G,QAAQvhF,OACnB31C,EAAQ,IAAI8a,WAAW06B,EAAIC,EAAI,GAInC,OAHA7xD,KAAKyzB,EAAE6/G,QAAQW,QAAO,WAClBf,EAAGiC,WAAW,EAAG,EAAGvjF,EAAGC,EAAGqhF,EAAGa,KAAMb,EAAGU,cAAex3H,MAElDA,WAGFmQ,EAAKhnB,GACV,OAAO,WAKH,OAHA2tI,EAAKlzI,KAAKyzB,EAAE0/B,GAGL5tD,EAAKpG,MAAMa,KAAMZ,qBA+DvBg2I,EAAgBtmG,EAAIE,EAAID,EAAIE,EAAIwgC,EAAIzH,EAAIqtE,EAAIC,GACjD,IAAIC,EAAMxmG,EAAK0gC,EACX+lE,EAAMvmG,EAAK+4B,EACXytE,EAAMJ,EAAK5lE,EACXimE,EAAMJ,EAAKttE,EACX2tE,EAAM7mG,EAAKC,EAAK0gC,EAAK4lE,EACrBO,EAAM5mG,EAAKC,EAAK+4B,EAAKstE,EACrBO,EAAMN,EAAIG,EAAMD,EAAID,EACpBptI,GAAKutI,EAAID,EAAMD,EAAIG,GAAOC,EAC1B73H,GAAKu3H,EAAIK,EAAMD,EAAIH,GAAOK,EAC9B,MAAO,CACH9mG,EAAKD,EAAK1mC,EAAE2mC,EAAIE,EAAKD,EAAK5mC,EAAE6mC,EAAI7mC,EAChCitI,EAAKvmG,EAAK9wB,EAAEq3H,EAAIC,EAAKtmG,EAAKhxB,EAAEs3H,EAAIt3H,EAChC8wB,EAAIE,EAAI,YAIP8mG,EAAW/3I,GAChB,IAAIqK,EAAIrK,EAAE,GAAIigB,EAAIjgB,EAAE,GAAIq8B,EAAIr8B,EAAE,GAC1Bo4D,EAAIp4D,EAAE,GAAIW,EAAIX,EAAE,GAAI60B,EAAI70B,EAAE,GAC1B02D,EAAI12D,EAAE,GAAI8zD,EAAI9zD,EAAE,GAAIhC,EAAIgC,EAAE,GAC1B83I,EAAMztI,EAAE1J,EAAE3C,EAAIqM,EAAEwqB,EAAEi/B,EAAI7zC,EAAEm4C,EAAEp6D,EAAIiiB,EAAE4U,EAAE6hC,EAAIr6B,EAAE+7B,EAAEtE,EAAIz3B,EAAE17B,EAAE+1D,EACtD,MAAO,EACF/1D,EAAE3C,EAAI62B,EAAEi/B,GAAKgkF,GAAMz7G,EAAEy3B,EAAI7zC,EAAEjiB,GAAK85I,GAAM73H,EAAE4U,EAAIwH,EAAE17B,GAAKm3I,GACnDjjH,EAAE6hC,EAAI0B,EAAEp6D,GAAK85I,GAAMztI,EAAErM,EAAIq+B,EAAEq6B,GAAKohF,GAAMz7G,EAAE+7B,EAAI/tD,EAAEwqB,GAAKijH,GACnD1/E,EAAEtE,EAAInzD,EAAE+1D,GAAKohF,GAAM73H,EAAEy2C,EAAIrsD,EAAEypD,GAAKgkF,GAAMztI,EAAE1J,EAAIsf,EAAEm4C,GAAK0/E,wBA9QjDE,KAiCT,IACW33I,SAASC,cAAc,UAAUy0D,WAAW,sBACrD,MAAOp0D,IAIT,IAAKw0I,IAAmF,IAA5EA,EAAW8C,yBAAyBxoI,QAAQ,4BACtD,OAIF,IAAIyoI,EACAC,YAxHmC/iF,GAErC,IAAKA,EAAG0gF,aAAa,qBACnB,OAAO,EAIT,IAAIsC,EAAchjF,EAAGijF,oBACjBC,EAAcljF,EAAGmjF,gBACrBnjF,EAAGojF,YAAYpjF,EAAGqjF,WAAYH,GAC9BljF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAGujF,mBAAoBvjF,EAAGwjF,SAC1DxjF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAGyjF,mBAAoBzjF,EAAGwjF,SAC1DxjF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAG0jF,eAAgB1jF,EAAG2jF,eACtD3jF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAG4jF,eAAgB5jF,EAAG2jF,eACtD3jF,EAAG6jF,WAAW7jF,EAAGqjF,WAAY,EAAGrjF,EAAG4gF,KAAM,EAAG,EAAG,EAAG5gF,EAAG4gF,KAAM5gF,EAAGygF,cAAe,MAC7EzgF,EAAG8jF,gBAAgB9jF,EAAG+jF,YAAaf,GACnChjF,EAAGgkF,qBAAqBhkF,EAAG+jF,YAAa/jF,EAAGikF,kBAAmBjkF,EAAGqjF,WAAYH,EAAa,GAG1F,IAMIgB,EAAelkF,EAAGmjF,gBACtBnjF,EAAGojF,YAAYpjF,EAAGqjF,WAAYa,GAC9BlkF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAGujF,mBAAoBvjF,EAAGmkF,QAC1DnkF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAGyjF,mBAAoBzjF,EAAGmkF,QAC1DnkF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAG0jF,eAAgB1jF,EAAG2jF,eACtD3jF,EAAGsjF,cAActjF,EAAGqjF,WAAYrjF,EAAG4jF,eAAgB5jF,EAAG2jF,eACtD3jF,EAAG6jF,WAAW7jF,EAAGqjF,WAAY,EAAGrjF,EAAG4gF,KAAM,EAAG,EAAG,EAAG5gF,EAAG4gF,KAAM5gF,EAAG6gF,MAAO,IAAIz8G,aAZ9D,CACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,KAWX,IAAIggH,EAAUpkF,EAAGqkF,gBACbC,EAAetkF,EAAGukF,aAAavkF,EAAGwkF,eAClCC,EAAiBzkF,EAAGukF,aAAavkF,EAAG0kF,iBACxC1kF,EAAG2kF,aAAaL,EAAc,2GAM9BtkF,EAAG2kF,aAAaF,EAAgB,uHAMhCzkF,EAAG4kF,cAAcN,GACjBtkF,EAAG4kF,cAAcH,GACjBzkF,EAAG6kF,aAAaT,EAASE,GACzBtkF,EAAG6kF,aAAaT,EAASK,GACzBzkF,EAAG8kF,YAAYV,GAGf,IAAIl9G,EAAS84B,EAAG+kF,eAChB/kF,EAAGglF,WAAWhlF,EAAGilF,aAAc/9G,GAC/B84B,EAAGklF,WAAWllF,EAAGilF,aAAc,IAAI7gH,aAAa,CAAC,EAAG,IAAK47B,EAAGmlF,aAC5DnlF,EAAGolF,wBAAwB,GAC3BplF,EAAGqlF,oBAAoB,EAAG,EAAGrlF,EAAG6gF,OAAO,EAAO,EAAG,GAGjD,IAAIxsC,EAAQ,IAAItwE,WAAW,GAQ3B,OAPAi8B,EAAGslF,WAAWlB,GACdpkF,EAAGulF,SAAS,EAAG,EAAG,EAAG,GACrBvlF,EAAGojF,YAAYpjF,EAAGqjF,WAAYa,GAC9BlkF,EAAGwlF,WAAWxlF,EAAGylF,OAAQ,EAAG,GAC5BzlF,EAAGgiF,WAAW,EAAG,EAAG,EAAG,EAAGhiF,EAAG4gF,KAAM5gF,EAAGygF,cAAepsC,GAGjC,MAAbA,EAAM,IAA2B,MAAbA,EAAM,IAkD/BqxC,CAA8B3F,KAChC+C,EAAkB6C,sBAAsBh4I,UAAU+yI,aAClDqC,EAA4B4C,sBAAsBh4I,UAAUk1I,uBAC5D8C,sBAAsBh4I,UAAU+yI,sBAhCZrsI,GACpB,MAAgB,6BAATA,QAb+B,KADN2rD,EAeHnzD,MAdtB+4I,4BACLj9I,OAAOwE,eAAe6yD,EAAI,6BAA8B,CACtD3xD,YAAY,EACZG,cAAc,EACdC,UAAU,EACVnF,MAAO,IAAIs5I,IAGR5iF,EAAG4lF,4BAON9C,EAAgBl1I,KAAKf,KAAMwH,OAhBC2rD,GA8ChC2lF,sBAAsBh4I,UAAUk1I,kCAzBhC,IAAIgD,EAAa9C,EAA0Bn1I,KAAKf,MAIhD,OAHuD,IAAnDg5I,EAAWxrI,QAAQ,6BACrBwrI,EAAW5yI,KAAK,4BAEX4yI,OA6JXh8I,EAAQ61D,OAAS,WACb,IAAIA,EAAcz0D,SAASC,cAAc,UACzC,IACI60I,EAAKrgF,EAAOC,WAAW,qBAAsB,CAAEC,oBAAoB,IACrE,MAAOr0D,GACLw0I,EAAK,KAET,IAAKA,EACD,KAAM,sCA4CV,OA1CArgF,EAAOp/B,EAAI,CACP0/B,GAAI+/E,EACJoB,eAAe,EACfhB,QAAS,KACTY,aAAc,KACdE,cAAe,MAInBvhF,EAAOygF,QAAU/mH,EAAKinH,GACtB3gF,EAAOwhD,KAAO9nF,EAAK8nF,GACnBxhD,EAAOpmB,OAASlgB,EAAKkgB,GACrBomB,EAAOr2D,QAAU+vB,EAAK/vB,GACtBq2D,EAAOoiF,SAAW1oH,EAAK0oH,GACvBpiF,EAAOqiF,cAAgB3oH,EAAK2oH,GAG5BriF,EAAOomF,mBAAqB1sH,EAAK0sH,GACjCpmF,EAAOqmF,kBAAoB3sH,EAAK2sH,GAChCrmF,EAAOsmF,cAAgB5sH,EAAK4sH,GAC5BtmF,EAAOumF,cAAgB7sH,EAAK6sH,GAC5BvmF,EAAOwmF,aAAe9sH,EAAK8sH,GAC3BxmF,EAAOymF,YAAc/sH,EAAK+sH,GAC1BzmF,EAAO0mF,YAAchtH,EAAKgtH,GAC1B1mF,EAAO2mF,WAAajtH,EAAKitH,GACzB3mF,EAAO4mF,WAAaltH,EAAKktH,GACzB5mF,EAAO6mF,UAAYntH,EAAKmtH,GACxB7mF,EAAO8mF,UAAYptH,EAAKotH,GACxB9mF,EAAO+mF,SAAWrtH,EAAKqtH,GACvB/mF,EAAOgnF,SAAWttH,EAAKstH,GACvBhnF,EAAOinF,SAAWvtH,EAAKutH,GACvBjnF,EAAOknF,MAAQxtH,EAAKwtH,GACpBlnF,EAAOmnF,QAAUztH,EAAKytH,GACtBnnF,EAAOonF,OAAS1tH,EAAK0tH,GACrBpnF,EAAOqnF,MAAQ3tH,EAAK2tH,GACpBrnF,EAAOsnF,IAAM5tH,EAAK4tH,GAClBtnF,EAAOunF,SAAW7tH,EAAK6tH,GACvBvnF,EAAOwnF,SAAW9tH,EAAK8tH,GACvBxnF,EAAOynF,MAAQ/tH,EAAK+tH,GACpBznF,EAAO2wC,OAASj3E,EAAKi3E,GACrB3wC,EAAOgxC,QAAUt3E,EAAKs3E,GAEfhxC,GAEX71D,EAAQu9I,kBAAoBA,EAiD5B,IAAIlG,EAAU,oBAKDmG,EAASvtI,GACd,MAA8C,mBAAvCnR,OAAOgF,UAAUsB,SAASrB,KAAKkM,YAGjCwtI,EAAcl8I,EAAMiI,EAAQk0I,GACjC,IAAI/F,EAASzB,EAAGwE,aAAan5I,GAG7B,GAFA20I,EAAG4E,aAAanD,EAAQnuI,GACxB0sI,EAAG6E,cAAcpD,IACZzB,EAAGyH,mBAAmBhG,EAAQzB,EAAG0H,gBAClC,KAAM,kBAAoBF,EAAU,MAAQxH,EAAG2H,iBAAiBlG,GAEpE,OAAOA,EAGX,IAiBImG,EAAiB,cACZC,EAAqBC,GAC1B,IAAIC,EAAS/H,EAAGgI,yBAAyBhI,EAAG2E,gBAAiBmD,GAC7D,OAAkB,OAAXC,GAAwC,IAArBA,EAAOE,mBAG5BC,EAAOC,EAAeC,EAAiBZ,GAa5C,GAZA16I,KAAKu7I,gBAAkB,KACvBv7I,KAAKw7I,kBAAoB,KACzBx7I,KAAKu3I,QAAUrE,EAAGsE,gBAClB6D,EAAeA,GA3BO,gMA4BtBC,EAAiBA,GAnBO,qIAoBD,OAAnBR,IACAA,EAAiBC,EAAqB7H,EAAGuI,YAAc,QAAWV,EAAqB7H,EAAGwI,cAAgB,UAAY,QAE1HJ,EAAiB,aAAeR,EAAiB,UAAYQ,EAC7DpI,EAAG8E,aAAah4I,KAAKu3I,QAASkD,EAAcvH,EAAGyE,cAAe0D,EAAcX,EAAU,aACtFxH,EAAG8E,aAAah4I,KAAKu3I,QAASkD,EAAcvH,EAAG2E,gBAAiByD,EAAgBZ,EAAU,eAC1FxH,EAAG+E,YAAYj4I,KAAKu3I,UACfrE,EAAGyI,oBAAoB37I,KAAKu3I,QAASrE,EAAG0I,aACzC,KAAM,eAAiB1I,EAAG2I,kBAAkB77I,KAAKu3I,SAsFzD,OAlFA6D,EAAOt6I,UAAUy+D,QAAU,WACvB2zE,EAAG4I,cAAc97I,KAAKu3I,SACtBv3I,KAAKu3I,QAAU,MAGnB6D,EAAOt6I,UAAU8zI,SAAW,SAASA,GAEjC,IAAK,IAAIptI,KADT0rI,EAAGuF,WAAWz4I,KAAKu3I,SACF3C,EAAU,CACvB,IAAKA,EAASj0I,eAAe6G,GAAO,SACpC,IAAIod,EAAWsuH,EAAG6I,mBAAmB/7I,KAAKu3I,QAAS/vI,GACnD,GAAiB,OAAbod,EAAmB,SACvB,IAAInoB,EAAQm4I,EAASptI,GACrB,GAvESyF,EAuEGxQ,EAtE8B,kBAAvCX,OAAOgF,UAAUsB,SAASrB,KAAKkM,GAuE9B,OAAQxQ,EAAMT,QACV,KAAK,EAAGk3I,EAAG8I,WAAWp3H,EAAU,IAAI2S,aAAa96B,IAAS,MAC1D,KAAK,EAAGy2I,EAAG+I,WAAWr3H,EAAU,IAAI2S,aAAa96B,IAAS,MAC1D,KAAK,EAAGy2I,EAAGgJ,WAAWt3H,EAAU,IAAI2S,aAAa96B,IAAS,MAC1D,KAAK,EAAGy2I,EAAGiJ,WAAWv3H,EAAU,IAAI2S,aAAa96B,IAAS,MAC1D,KAAK,EAAGy2I,EAAGkJ,iBAAiBx3H,GAAU,EAAO,IAAI2S,aAAa96B,IAAS,MACvE,KAAK,GAAIy2I,EAAGmJ,iBAAiBz3H,GAAU,EAAO,IAAI2S,aAAa96B,IAAS,cAC/D,KAAM,qCAAuC+K,EAAO,eAAiB/K,EAAMT,WAErF,CAAA,IAAIw+I,EAAS/9I,GAGhB,KAAM,6BAA+B+K,EAAO,uBAAyB/K,GAAS,aAAa2F,WAF3F8wI,EAAGoJ,UAAU13H,EAAUnoB,QAlFlBwQ,EAwFb,OAAOjN,MAKXo7I,EAAOt6I,UAAUy7I,SAAW,SAASA,GAEjC,IAAK,IAAI/0I,KADT0rI,EAAGuF,WAAWz4I,KAAKu3I,SACFgF,EACRA,EAAS57I,eAAe6G,IAC7B0rI,EAAGsJ,UAAUtJ,EAAG6I,mBAAmB/7I,KAAKu3I,QAAS/vI,GAAO+0I,EAAS/0I,IAGrE,OAAOxH,MAGXo7I,EAAOt6I,UAAU2zI,SAAW,SAAS35H,EAAMy4C,EAAKx4C,EAAO69D,GACnD,IAAI91E,EACA41I,EAAWxF,EAAGuJ,aAAavJ,EAAGwJ,UAClCnpF,EAAMA,IAAQzwD,GAAaywD,EAAMmlF,EAAS,IAAMA,EAAS,GAAK,EAC9D59H,EAAOA,IAAShY,GAAagY,EAAO49H,EAAS,IAAMA,EAAS,GAAK,EACjE39H,EAAQA,IAAUjY,GAAaiY,EAAQ29H,EAAS,IAAMA,EAAS,GAAK,EACpE9/D,EAASA,IAAW91E,GAAa81E,EAAS8/D,EAAS,IAAMA,EAAS,GAAK,EAChD,MAAnBxF,EAAGyJ,eACHzJ,EAAGyJ,aAAezJ,EAAGgF,gBAEzBhF,EAAGiF,WAAWjF,EAAGkF,aAAclF,EAAGyJ,cAClCzJ,EAAGmF,WAAWnF,EAAGkF,aAAc,IAAI7gH,aAAa,CAAEzc,EAAMy4C,EAAKz4C,EAAM89D,EAAQ79D,EAAOw4C,EAAKx4C,EAAO69D,IAAWs6D,EAAG0J,aACnF,MAArB1J,EAAG2J,iBACH3J,EAAG2J,eAAiB3J,EAAGgF,eACvBhF,EAAGiF,WAAWjF,EAAGkF,aAAclF,EAAG2J,gBAClC3J,EAAGmF,WAAWnF,EAAGkF,aAAc,IAAI7gH,aAAa,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAAM27G,EAAG0J,cAExD,MAAxB58I,KAAKu7I,kBACLv7I,KAAKu7I,gBAAkBrI,EAAG4J,kBAAkB98I,KAAKu3I,QAAS,UAC1DrE,EAAGqF,wBAAwBv4I,KAAKu7I,kBAEN,MAA1Bv7I,KAAKw7I,oBACLx7I,KAAKw7I,kBAAoBtI,EAAG4J,kBAAkB98I,KAAKu3I,QAAS,aAC5DrE,EAAGqF,wBAAwBv4I,KAAKw7I,oBAEpCtI,EAAGuF,WAAWz4I,KAAKu3I,SACnBrE,EAAGiF,WAAWjF,EAAGkF,aAAclF,EAAGyJ,cAClCzJ,EAAGsF,oBAAoBx4I,KAAKu7I,gBAAiB,EAAGrI,EAAGc,OAAO,EAAO,EAAG,GACpEd,EAAGiF,WAAWjF,EAAGkF,aAAclF,EAAG2J,gBAClC3J,EAAGsF,oBAAoBx4I,KAAKw7I,kBAAmB,EAAGtI,EAAGc,OAAO,EAAO,EAAG,GACtEd,EAAGyF,WAAWzF,EAAG6J,eAAgB,EAAG,IAGxC3B,EAAO5G,iBAAmB,WAEtB,OADAtB,EAAG8J,cAAgB9J,EAAG8J,eAAiB,IAAI5B,EACpClI,EAAG8J,eAGP5B,EA9IG,YAoJLt6D,EAAmBtZ,GACxB,IAAIvrD,EAAIurD,EAAOxrE,OACfgE,KAAK8nE,GAAK,GACV9nE,KAAK+nE,GAAK,GACV/nE,KAAKqvC,EAAI,GACTrvC,KAAKgoE,GAAK,GAEVR,EAAOlqD,MAAK,SAASlV,EAAG4V,GACpB,OAAO5V,EAAE,GAAK4V,EAAE,MAEpB,IAAK,IAAIjiB,EAAI,EAAGA,EAAIkgB,EAAGlgB,IACnBiE,KAAK8nE,GAAG1hE,KAAKohE,EAAOzrE,GAAG,IACvBiE,KAAK+nE,GAAG3hE,KAAKohE,EAAOzrE,GAAG,IAG3BiE,KAAKqvC,EAAE,GAAK,EACZrvC,KAAKgoE,GAAG,GAAK,EAEb,IAASjsE,EAAI,EAAGA,EAAIkgB,EAAI,IAAKlgB,EAAG,CAG5B,IAAIksE,EAAKjoE,KAAK8nE,GAAG/rE,EAAI,GAAKiE,KAAK8nE,GAAG/rE,EAAI,GAClCmsE,GAAOloE,KAAK8nE,GAAG/rE,GAAKiE,KAAK8nE,GAAG/rE,EAAI,IAAMksE,EACtCvO,EAAIwO,EAAMloE,KAAKgoE,GAAGjsE,EAAI,GAAK,EAE/BiE,KAAKgoE,GAAGjsE,IAAMmsE,EAAM,GAAOxO,EAE3B,IAAIyO,GACCnoE,KAAK+nE,GAAGhsE,EAAI,GAAKiE,KAAK+nE,GAAGhsE,KAAOiE,KAAK8nE,GAAG/rE,EAAI,GAAKiE,KAAK8nE,GAAG/rE,KACzDiE,KAAK+nE,GAAGhsE,GAAKiE,KAAK+nE,GAAGhsE,EAAI,KAAOiE,KAAK8nE,GAAG/rE,GAAKiE,KAAK8nE,GAAG/rE,EAAI,IAE9DiE,KAAKqvC,EAAEtzC,IAAM,EAAMosE,EAAQF,EAAKC,EAAMloE,KAAKqvC,EAAEtzC,EAAI,IAAM29D,EAG3D15D,KAAKgoE,GAAG/rD,EAAI,GAAK,EAGjB,IAASlgB,EAAIkgB,EAAI,EAAGlgB,GAAK,IAAKA,EAC1BiE,KAAKgoE,GAAGjsE,GAAKiE,KAAKgoE,GAAGjsE,GAAKiE,KAAKgoE,GAAGjsE,EAAI,GAAKiE,KAAKqvC,EAAEtzC,GAI1D+kF,EAAmBhgF,UAAUwnE,YAAc,SAASjqD,GAChD,IACIkqD,EAAM,EACNC,EAFIxoE,KAAK+nE,GAAG/rE,OAEF,OAOPwsE,EAAMD,EAAM,GAAG,CAClB,IAAIxsD,EAAKysD,EAAMD,GAAQ,EAEnBvoE,KAAK8nE,GAAG/rD,GAAKsC,EACbmqD,EAAMzsD,EAENwsD,EAAMxsD,EAId,IAAI81C,EAAI7xD,KAAK8nE,GAAGU,GAAOxoE,KAAK8nE,GAAGS,GAC3BngE,GAAKpI,KAAK8nE,GAAGU,GAAOnqD,GAAKwzC,EACzB7zC,GAAKK,EAAIre,KAAK8nE,GAAGS,IAAQ1W,EAG7B,OAAOzpD,EAAIpI,KAAK+nE,GAAGQ,GAAOvqD,EAAIhe,KAAK+nE,GAAGS,KAChCpgE,EAAIA,EAAIA,EAAIA,GAAKpI,KAAKgoE,GAAGO,IAAQvqD,EAAIA,EAAIA,EAAIA,GAAKhe,KAAKgoE,GAAGQ,KAAS3W,EAAIA,GAAK,GAItF,IAAI4hF,EAAW,oBAOFwJ,EAAQnrF,EAAOC,EAAQkpF,EAAQ18I,GACpCyB,KAAKmzD,GAAK+/E,EACVlzI,KAAK/D,GAAKi3I,EAAGoD,gBACbt2I,KAAK8xD,MAAQA,EACb9xD,KAAK+xD,OAASA,EACd/xD,KAAKi7I,OAASA,EACdj7I,KAAKzB,KAAOA,EAEZ20I,EAAGqD,YAAYrD,EAAGsD,WAAYx2I,KAAK/D,IACnCi3I,EAAGuD,cAAcvD,EAAGsD,WAAYtD,EAAGwD,mBAAoBxD,EAAGoE,QAC1DpE,EAAGuD,cAAcvD,EAAGsD,WAAYtD,EAAG0D,mBAAoB1D,EAAGoE,QAC1DpE,EAAGuD,cAAcvD,EAAGsD,WAAYtD,EAAG2D,eAAgB3D,EAAG4D,eACtD5D,EAAGuD,cAAcvD,EAAGsD,WAAYtD,EAAG6D,eAAgB7D,EAAG4D,eAClDhlF,GAASC,GAAQmhF,EAAG8D,WAAW9D,EAAGsD,WAAY,EAAGx2I,KAAKi7I,OAAQnpF,EAAOC,EAAQ,EAAG/xD,KAAKi7I,OAAQj7I,KAAKzB,KAAM,MAnBhH0+I,EAAQvJ,YAAc,SAASjhI,GAC3B,IAAI6gI,EAAU,IAAI2J,EAAQ,EAAG,EAAG/J,EAAGa,KAAMb,EAAGU,eAE5C,OADAN,EAAQC,eAAe9gI,GAChB6gI,GAmBX2J,EAAQn8I,UAAUyyI,eAAiB,SAAS9gI,GACxCzS,KAAK8xD,MAAQr/C,EAAQq/C,OAASr/C,EAAQyqI,WACtCl9I,KAAK+xD,OAASt/C,EAAQs/C,QAAUt/C,EAAQ0qI,YACxCjK,EAAGqD,YAAYrD,EAAGsD,WAAYx2I,KAAK/D,IACnCi3I,EAAG8D,WAAW9D,EAAGsD,WAAY,EAAGx2I,KAAKi7I,OAAQj7I,KAAKi7I,OAAQj7I,KAAKzB,KAAMkU,IAGzEwqI,EAAQn8I,UAAUs8I,cAAgB,SAAStrF,EAAOC,EAAQ9iD,GACtDjP,KAAK8xD,MAAQA,EACb9xD,KAAK+xD,OAASA,EACd/xD,KAAKi7I,OAAS/H,EAAGa,KACjB/zI,KAAKzB,KAAO20I,EAAGU,cACfV,EAAGqD,YAAYrD,EAAGsD,WAAYx2I,KAAK/D,IACnCi3I,EAAG8D,WAAW9D,EAAGsD,WAAY,EAAGtD,EAAGa,KAAMjiF,EAAOC,EAAQ,EAAGmhF,EAAGa,KAAM/zI,KAAKzB,KAAM,IAAI24B,WAAWjoB,KAGlGguI,EAAQn8I,UAAUy+D,QAAU,WACxB2zE,EAAGmK,cAAcr9I,KAAK/D,IACtB+D,KAAK/D,GAAK,MAGdghJ,EAAQn8I,UAAUyzI,IAAM,SAAS+I,GAC7BpK,EAAGqK,cAAcrK,EAAGsK,UAAYF,GAAQ,IACxCpK,EAAGqD,YAAYrD,EAAGsD,WAAYx2I,KAAK/D,KAGvCghJ,EAAQn8I,UAAU28I,MAAQ,SAASH,GAC/BpK,EAAGqK,cAAcrK,EAAGsK,UAAYF,GAAQ,IACxCpK,EAAGqD,YAAYrD,EAAGsD,WAAY,OAGlCyG,EAAQn8I,UAAU48I,aAAe,SAAS5rF,EAAOC,EAAQkpF,EAAQ18I,GAE7D,GAAwB,GAApBa,UAAUpD,OAAa,CACvB,IAAIs3I,EAAUl0I,UAAU,GACxB0yD,EAAQwhF,EAAQxhF,MAChBC,EAASuhF,EAAQvhF,OACjBkpF,EAAS3H,EAAQ2H,OACjB18I,EAAO+0I,EAAQ/0I,KAIfuzD,GAAS9xD,KAAK8xD,OAASC,GAAU/xD,KAAK+xD,QAAUkpF,GAAUj7I,KAAKi7I,QAAU18I,GAAQyB,KAAKzB,OACtFyB,KAAK8xD,MAAQA,EACb9xD,KAAK+xD,OAASA,EACd/xD,KAAKi7I,OAASA,EACdj7I,KAAKzB,KAAOA,EACZ20I,EAAGqD,YAAYrD,EAAGsD,WAAYx2I,KAAK/D,IACnCi3I,EAAG8D,WAAW9D,EAAGsD,WAAY,EAAGx2I,KAAKi7I,OAAQnpF,EAAOC,EAAQ,EAAG/xD,KAAKi7I,OAAQj7I,KAAKzB,KAAM,QAI/F0+I,EAAQn8I,UAAUmzI,OAAS,SAASvnG,GAKhC,GAHAwmG,EAAGiD,YAAcjD,EAAGiD,aAAejD,EAAGkD,oBACtClD,EAAG+D,gBAAgB/D,EAAGgE,YAAahE,EAAGiD,aACtCjD,EAAGiE,qBAAqBjE,EAAGgE,YAAahE,EAAGkE,kBAAmBlE,EAAGsD,WAAYx2I,KAAK/D,GAAI,GAClFi3I,EAAGyK,uBAAuBzK,EAAGgE,eAAiBhE,EAAG0K,qBACjD,MAAM,IAAIzhJ,MAAM,0BAEpB+2I,EAAGwF,SAAS,EAAG,EAAG14I,KAAK8xD,MAAO9xD,KAAK+xD,QAGnCrlB,IAGAwmG,EAAG+D,gBAAgB/D,EAAGgE,YAAa,OAGvC,IAAIrkF,EAAS,cAEJgrF,EAAUvK,GACD,MAAVzgF,IAAgBA,EAASz0D,SAASC,cAAc,WACpDw0D,EAAOf,MAAQwhF,EAAQxhF,MACvBe,EAAOd,OAASuhF,EAAQvhF,OACxB,IAAI33B,EAAIy4B,EAAOC,WAAW,MAE1B,OADA14B,EAAEo4D,UAAU,EAAG,EAAG3/B,EAAOf,MAAOe,EAAOd,QAChC33B,EAmCX,OAhCA6iH,EAAQn8I,UAAUg9I,gBAAkB,SAASpxG,GAMzC,OALAA,EAASmxG,EAAU79I,OACnBA,KAAKi7I,OAAS/H,EAAGa,KACjB/zI,KAAKzB,KAAO20I,EAAGU,cACfV,EAAGqD,YAAYrD,EAAGsD,WAAYx2I,KAAK/D,IACnCi3I,EAAG8D,WAAW9D,EAAGsD,WAAY,EAAGtD,EAAGa,KAAMb,EAAGa,KAAMb,EAAGU,cAAe/gF,GAC7D7yD,MAGXi9I,EAAQn8I,UAAUi9I,QAAU,SAASr/D,GACjC1+E,KAAKu0I,MACLF,EAAOG,mBAAmBC,WAC1B,IAAIjjH,EAAOxxB,KAAK8xD,MAAQ9xD,KAAK+xD,OAAS,EAClCisF,EAAS,IAAI9mH,WAAW1F,GACxB4I,EAAIyjH,EAAU79I,MACdiP,EAAOmrB,EAAEsrE,gBAAgB1lG,KAAK8xD,MAAO9xD,KAAK+xD,QAC9CmhF,EAAGiC,WAAW,EAAG,EAAGn1I,KAAK8xD,MAAO9xD,KAAK+xD,OAAQmhF,EAAGa,KAAMb,EAAGU,cAAeoK,GACxE,IAAK,IAAIjiJ,EAAI,EAAGA,EAAIy1B,EAAMz1B,IACtBkT,EAAKA,KAAKlT,GAAKiiJ,EAAOjiJ,GAE1Bq+B,EAAEm6C,aAAatlE,EAAM,EAAG,GACxByvE,EAAM5oE,IAAM+8C,EAAO6S,aAGvBu3E,EAAQn8I,UAAUi0I,SAAW,SAASkJ,GAClC,IAAI5oI,EACJA,EAAO4oI,EAAMhiJ,GAAIgiJ,EAAMhiJ,GAAK+D,KAAK/D,GAAI+D,KAAK/D,GAAKoZ,EAC/CA,EAAO4oI,EAAMnsF,MAAOmsF,EAAMnsF,MAAQ9xD,KAAK8xD,MAAO9xD,KAAK8xD,MAAQz8C,EAC3DA,EAAO4oI,EAAMlsF,OAAQksF,EAAMlsF,OAAS/xD,KAAK+xD,OAAQ/xD,KAAK+xD,OAAS18C,EAC/DA,EAAO4oI,EAAMhD,OAAQgD,EAAMhD,OAASj7I,KAAKi7I,OAAQj7I,KAAKi7I,OAAS5lI,GAG5D4nI,EAvII,YA2INiB,EAAWtJ,EAAUuJ,GAC1B,OAAO,IAAI9J,EAAO,KAAMO,EAAW,qJAM3BuJ,EAAO,yTAOX,QAIR,IAAIC,EAAmB,2MAapB,SACMnF,EAAmBoF,EAAYC,GAuBpC,OAtBApL,EAAG+F,mBAAqB/F,EAAG+F,oBAAsB,IAAI5E,EAAO,KAAM,gfAe/D,sBAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAG+F,mBAAoB,CAC3CoF,WAAYvxG,GAAM,EAAIuxG,EAAY,GAClCC,SAAUxxG,GAAM,EAAIwxG,EAAU,KAG3Bt+I,cAIFu6I,EAAkB/yE,GACvB,IAAI+2E,EAAe,IAAIz9D,EAAmBtZ,GACtCprD,EAAQ,GACZ,IAAK,IAAIrgB,EAAI,EAAGA,EAAI,IAAKA,IACrBqgB,EAAMhW,KAAK0mC,EAAM,EAAGnvC,KAAKyO,MAA0C,IAApCmyI,EAAaj2E,YAAYvsE,EAAI,MAAa,MAE7E,OAAOqgB,EAqBR,SACM69H,EAAOuE,EAAKC,EAAOC,GAExBF,EAAMjE,EAAkBiE,GACA,GAApBp/I,UAAUpD,OACVyiJ,EAAQC,EAAOF,GAEfC,EAAQlE,EAAkBkE,GAC1BC,EAAOnE,EAAkBmE,IAE7B,IAAItiI,EAAQ,GACZ,IAAK,IAAIrgB,EAAI,EAAGA,EAAI,IAAKA,IACrBqgB,EAAM8pB,OAAO9pB,EAAMpgB,OAAQ,EAAGwiJ,EAAIziJ,GAAI0iJ,EAAM1iJ,GAAI2iJ,EAAK3iJ,GAAI,KAuB7D,OArBAiE,KAAKyzB,EAAE0gH,aAAaiJ,cAAc,IAAK,EAAGhhI,GAC1Cpc,KAAKyzB,EAAE0gH,aAAaI,IAAI,GAExBrB,EAAG+G,OAAS/G,EAAG+G,QAAU,IAAI5F,EAAO,KAAM,4XAWvC,UAEHnB,EAAG+G,OAAOsC,SAAS,CACfj8G,IAAK,IAETo0G,EAAa3zI,KAAKf,KAAMkzI,EAAG+G,OAAQ,IAE5Bj6I,KAWR,SACMg6I,EAAQ9/G,GAEbg5G,EAAG8G,QAAU9G,EAAG8G,SAAW,IAAI3F,EAAO,KAAM,gyBAqBzC,WAGH,IAAK,IAAIt4I,EAAI,EAAGA,EAAI,EAAGA,IACnB24I,EAAa3zI,KAAKf,KAAMkzI,EAAG8G,QAAS,CAChC9/G,SAAUv8B,KAAK6O,IAAI,EAAG0tB,GACtBykH,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAInC,OAAO/xD,KAeR,SACMm5I,EAAc9oD,EAAKC,GAqCxB,OApCA4iD,EAAGiG,cAAgBjG,EAAGiG,eAAiB,IAAI9E,EAAO,KAAM,klCA6BrD,iBAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGiG,cAAe,CACtC9oD,IAAKvjD,GAAM,EAAIujD,EAAK,GACpBC,WAAYxjD,GAAM,EAAIwjD,EAAY,KAG/BtwF,KAQR,SACM+5I,EAAM6E,GAwBX,OAvBA1L,EAAG6G,MAAQ7G,EAAG6G,OAAS,IAAI1F,EAAO,KAAM,ifAiBrC,SAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAG6G,MAAO,CAC9B6E,OAAQ9xG,EAAM,EAAG8xG,EAAQ,KAGtB5+I,KAQR,SACMs6I,EAAMsE,GAuBX,OAtBA1L,EAAGoH,MAAQpH,EAAGoH,OAAS,IAAIjG,EAAO,KAAM,spBAgBrC,SAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGoH,MAAO,CAC9BsE,OAAQ9xG,EAAM,EAAG8xG,EAAQ,KAGtB5+I,KAUR,SACMs5I,EAAYvoD,EAAQ8tD,GAgCzB,OA/BA3L,EAAGoG,YAAcpG,EAAGoG,aAAe,IAAIjF,EAAO,KAAM,uZAWjD,eAGHr0I,KAAKyzB,EAAE0gH,aAAauJ,aAAa19I,KAAKyzB,EAAE6/G,SACxCtzI,KAAKyzB,EAAE6/G,QAAQiB,MACfv0I,KAAKyzB,EAAE0gH,aAAaF,QAAO,WACvBI,EAAOG,mBAAmBC,cAI9Bz0I,KAAKyzB,EAAE0gH,aAAaI,IAAI,GACxBv0I,KAAKq5I,aAAatoD,GAClBmiD,EAAGoG,YAAYiD,SAAS,CACpBuC,gBAAiB,IAErBpK,EAAa3zI,KAAKf,KAAMkzI,EAAGoG,YAAa,CACpCuF,SAAUA,IAEd7+I,KAAKyzB,EAAE0gH,aAAasJ,MAAM,GAEnBz9I,KAQR,SACMq6I,EAASuE,GAmBd,OAlBA1L,EAAGmH,SAAWnH,EAAGmH,UAAY,IAAIhG,EAAO,KAAM,mcAY3C,YAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGmH,SAAU,CACjCuE,OAAQ9xG,GAAM,EAAI8xG,EAAQ,KAGvB5+I,KASR,SACMo6I,EAAS5oH,EAAMotH,GAqBpB,OApBA1L,EAAGkH,SAAWlH,EAAGkH,UAAY,IAAI/F,EAAO,KAAM,uZAa3C,YAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGkH,SAAU,CACjC5oH,KAAMsb,EAAM,EAAGtb,EAAM,GACrBotH,OAAQ9xG,EAAM,EAAG8xG,EAAQ,KAGtB5+I,KAmBR,SACM65I,EAAS9oD,EAAQstD,EAAY96E,GAMlC2vE,EAAG6L,gBAAkB7L,EAAG6L,iBAAmB,IAAI1K,EAAO,KAAM,0QASzD,mBAEH,IAAI9tG,EAAS,mMAOL63G,EAAmB,sgBAgB3BlL,EAAG8L,UAAY9L,EAAG8L,WAAa,IAAI3K,EAAO,KAAM9tG,EAAS,+EAItD,aACH2sG,EAAG+L,UAAY/L,EAAG+L,WAAa,IAAI5K,EAAO,KAAM9tG,EAAS,wGAItD,aACH2sG,EAAGgM,UAAYhM,EAAGgM,WAAa,IAAI7K,EAAO,KAAM9tG,EAAS,8KAKtD,aAAag2G,SAAS,CAAE/I,SAAU,IAGrC,IAAIpjE,EAAM,GACV,IAAK,IAAIr0E,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAIqM,EAAIm7D,EAAQxnE,EAAI4B,KAAKuvC,GAAK,EAAI,EAClCkjC,EAAIhqE,KAAK,CAAC2qF,EAASpzF,KAAKy6D,IAAIhwD,GAAKpI,KAAK8xD,MAAOi/B,EAASpzF,KAAKu6D,IAAI9vD,GAAKpI,KAAK+xD,SAE7E,IAAIotF,EAAQxhJ,KAAK67B,IAAI,GAAIsT,GAAM,EAAIuxG,EAAY,IA2B/C,OAxBA3J,EAAa3zI,KAAKf,KAAMkzI,EAAG6L,gBAAiB,CACxCI,MAAOA,IAIXn/I,KAAKyzB,EAAE0gH,aAAauJ,aAAa19I,KAAKyzB,EAAE6/G,SACxCoB,EAAa3zI,KAAKf,KAAMkzI,EAAG8L,UAAW,CAClCI,OAAQhvE,EAAI,IACbpwE,KAAKyzB,EAAE6/G,QAAStzI,KAAKyzB,EAAE0gH,cAC1BO,EAAa3zI,KAAKf,KAAMkzI,EAAG+L,UAAW,CAClCG,OAAQhvE,EAAI,GACZivE,OAAQjvE,EAAI,IACbpwE,KAAKyzB,EAAE0gH,aAAcn0I,KAAKyzB,EAAE0gH,cAG/BO,EAAa3zI,KAAKf,KAAMkzI,EAAG8L,UAAW,CAClCI,OAAQhvE,EAAI,KAEhBpwE,KAAKyzB,EAAE0gH,aAAaI,IAAI,GACxBG,EAAa3zI,KAAKf,KAAMkzI,EAAGgM,UAAW,CAClCC,MAAO,EAAIA,EACXC,OAAQhvE,EAAI,KAGTpwE,KAoBR,SACM05I,EAAU1+C,EAAQC,EAAQqkD,EAAMC,EAAMC,EAAYC,GACvDvM,EAAGwG,UAAYxG,EAAGwG,WAAa,IAAIrF,EAAO,KAAM,6PASxC+J,EAAmB,qoCA2BxB,aAEH,IAAI9jB,EAAKglB,EAAOtkD,EACZu/B,EAAKglB,EAAOtkD,EACZ9kC,EAAIx4D,KAAKkhB,KAAKy7G,EAAKA,EAAKC,EAAKA,GAkBjC,OAjBAma,EAAa3zI,KAAKf,KAAMkzI,EAAGwG,UAAW,CAClC8F,WAAYA,EACZC,eAAgBA,EAChBptI,MAAO,CAAC2oF,EAAQC,GAChBn/E,IAAK,CAACwjI,EAAMC,GACZ59F,MAAO,CAAC24E,EAAKnkE,EAAGokE,EAAKpkE,GACrBwoF,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAE/B2iF,EAAa3zI,KAAKf,KAAMkzI,EAAGwG,UAAW,CAClC8F,WAAYA,EACZC,eAAgBA,EAChBptI,MAAO,CAAC2oF,EAAQC,GAChBn/E,IAAK,CAACwjI,EAAMC,GACZ59F,MAAO,EAAE44E,EAAKpkE,EAAGmkE,EAAKnkE,GACtBwoF,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAUR,SACMq5I,EAAatoD,GAuClB,OAtCAmiD,EAAGmG,aAAenG,EAAGmG,cAAgB,IAAIhF,EAAO,KAAM,sGAI9C+J,EAAmB,06BAyBxB,gBAEH1J,EAAa3zI,KAAKf,KAAMkzI,EAAGmG,aAAc,CACrC13F,MAAO,CAACovC,EAAS/wF,KAAK8xD,MAAO,KAEjC4iF,EAAa3zI,KAAKf,KAAMkzI,EAAGmG,aAAc,CACrC13F,MAAO,CAAC,EAAGovC,EAAS/wF,KAAK+xD,UAGtB/xD,KAWR,SACM85I,EAASzzB,EAASC,EAASu4B,GAyChC,OAxCA3L,EAAG4G,SAAW5G,EAAG4G,UAAY,IAAIzF,EAAO,KAAM,mKAMtC+J,EAAmB,mgCA0BxB,YAEH1J,EAAa3zI,KAAKf,KAAMkzI,EAAG4G,SAAU,CACjC3qE,OAAQ,CAACk3C,EAASC,GAClBu4B,SAAUA,EACVF,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAaR,SACMo5I,EAAc/yB,EAASC,EAAS/iD,EAAO/xC,GAqC5C,OApCA0hH,EAAGkG,cAAgBlG,EAAGkG,eAAiB,IAAI/E,EAAO,KAAM,w+BA2BrD,iBAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGkG,cAAe,CACtCjqE,OAAQ,CAACk3C,EAASC,GAClB/iD,MAAOA,EACPh2B,MAAO5vC,KAAKuvC,GAAK1b,EACjBmtH,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAYR,SACM25I,EAAUtzB,EAASC,EAAS/iD,EAAO/xC,GAiCxC,OAhCA0hH,EAAGyG,UAAYzG,EAAGyG,WAAa,IAAItF,EAAO,KAAM,yuBAuB7C,aAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGyG,UAAW,CAClCxqE,OAAQ,CAACk3C,EAASC,GAClB/iD,MAAOA,EACPh2B,MAAO5vC,KAAKuvC,GAAK1b,EACjBmtH,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KASR,SACM45I,EAAS7oD,GAiEd,OAhEAmiD,EAAGwM,UAAYxM,EAAGwM,WAAa,IAAIrL,EAAO,KAAM,sGAIxC+J,EAAmB,k6BAuBxB,aACHlL,EAAGyM,UAAYzM,EAAGyM,WAAa,IAAItL,EAAO,KAAM,sGAIxC+J,EAAmB,g7BAuBxB,aAEH1J,EAAa3zI,KAAKf,KAAMkzI,EAAGwM,UAAW,CAClC/9F,MAAO,CAACovC,EAAS/wF,KAAK8xD,MAAO,KAEjC4iF,EAAa3zI,KAAKf,KAAMkzI,EAAGyM,UAAW,CAClCh+F,MAAO,CAAC,EAAGovC,EAAS/wF,KAAK+xD,UAGtB/xD,KAWR,SACMk5I,EAAkB7yB,EAASC,EAAS/4E,GAiDzC,OAhDA2lG,EAAGgG,kBAAoBhG,EAAGgG,mBAAqB,IAAI7E,EAAO,KAAM,g5CAwC7D,qBAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGgG,kBAAmB,CAC1C/pE,OAAQ,CAACk3C,EAASC,GAClB/4E,MAAOA,EACPoxG,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAaR,SACMm6I,EAAI0E,GAmCT,OAlCA3L,EAAGiH,IAAMjH,EAAGiH,KAAO,IAAI9F,EAAO,KAAM,mlCA2BjC,OAEHK,EAAa3zI,KAAKf,KAAMkzI,EAAGiH,IAAK,CAC5B0E,SAAUA,EAAWA,EAAWA,EAAWA,EAAWA,EACtDF,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAWR,SACMy5I,EAAWpzB,EAASC,EAASv1B,EAAQ8tD,GA0B1C,OAzBA3L,EAAGuG,WAAavG,EAAGuG,YAAcyE,EAAW,+FAIzC,kcAcHxJ,EAAa3zI,KAAKf,KAAMkzI,EAAGuG,WAAY,CACnC1oD,OAAQA,EACR8tD,SAAU/xG,GAAM,EAAI+xG,EAAU,GAC9B1vE,OAAQ,CAACk3C,EAASC,GAClBq4B,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAkBR,SACMw5I,EAAW3zE,EAAQ+5E,EAASC,GAejC,GAdA3M,EAAGsG,WAAatG,EAAGsG,YAAc0E,EAAW,wEAGzC,2NAWkB,IAHrBr4E,EAASj0D,MAAM9Q,UAAUpD,OAAOyB,MAAM,GAAI0mE,IAG/B7pE,OACP6pE,EAAS,CACLA,EAAO,GAAIA,EAAO,GAAI,EACtBA,EAAO,GAAIA,EAAO,GAAI,EACtB,EAAG,EAAG,QAEP,GAAqB,GAAjBA,EAAO7pE,OACd,KAAM,uCASV,OANA04I,EAAa3zI,KAAKf,KAAMkzI,EAAGsG,WAAY,CACnC3zE,OAAQ+5E,EAAU9J,EAAWjwE,GAAUA,EACvC84E,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,QAC3B8tF,gBAAmC,EAAlBA,IAGd7/I,KAaR,SACMu5I,EAAYtvC,EAAQ61C,GACzB,IAAI13I,EAAIgtI,EAAgBj2I,MAAM,KAAM2gJ,GAChC9hI,EAAIo3H,EAAgBj2I,MAAM,KAAM8qG,GAChC7vE,WAh6CUhyB,EAAG4V,GACjB,MAAO,CACH5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAC/B5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,GAAK5V,EAAE,GAAG4V,EAAE,IAs5C3BgyE,CAAS8lD,EAAW1tI,GAAI4V,GAChC,OAAOhe,KAAKw5I,WAAWp/G,GAYxB,SACM8/G,EAAM7zB,EAASC,EAASv1B,EAAQxtB,GA4BrC,OA3BA2vE,EAAGgH,MAAQhH,EAAGgH,OAASgE,EAAW,4FAI/B,ibAgBHxJ,EAAa3zI,KAAKf,KAAMkzI,EAAGgH,MAAO,CAC9BnpD,OAAQA,EACR5hB,OAAQ,CAACk3C,EAASC,GAClB/iD,MAAOA,EACPo7E,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAMR,SACMwjG,IAgBL,OAfA0vC,EAAG1vC,OAAS0vC,EAAG1vC,QAAU,IAAI6wC,EAAO,KAAM,kPAS3C,UAECK,EAAa3zI,KAAKf,KAAMkzI,EAAG1vC,OAAQ,CAC/Bm7C,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAQR,SACM6jG,EAAQjO,EAAYmqD,GAwBzB,OAvBA7M,EAAGrvC,QAAUqvC,EAAGrvC,SAAW,IAAIwwC,EAAO,KAAM,0cAe7C,WAECK,EAAa3zI,KAAKf,KAAMkzI,EAAGrvC,QAAS,CAChCjO,WAAYA,EAAa,EAAI,EAC7Bp5F,QAASujJ,EAAc,CAACA,EAAYvzH,EAAI,IAAKuzH,EAAYtrF,EAAI,IAAKsrF,EAAY/hI,EAAI,IAAK+hI,EAAY33I,GAAK,CAAC,EAAE,EAAE,EAAE,GAC/Gu2I,QAAS,CAAC3+I,KAAK8xD,MAAO9xD,KAAK+xD,UAGxB/xD,KAIX,OAAOhD,EA52DY,GCPnB,IAAIgjJ,GAAW,KACf,IACIA,GAAW/M,GAAGpgF,SAChB,MAAOn0D,aAGOuhJ,KACZ,IAAKD,IAAYA,GAASvsH,EAAE0/B,GAAG+sF,gBAC3B,IACIF,GAAW/M,GAAGpgF,SAChB,MAAOn0D,IAGb,OAAOshJ,GCPJ,MAAMG,GAAuB,CAChCj9C,UAAUz9C,GAEN,IAAIrmC,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAITmpF,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OACpB,IAAK01C,IAAY11C,EACb,OAAO,EAGX,IAAI28B,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ,IAAK,IAAK,GACxEH,EAAI/gB,SAAS,GAAKinD,EAAIhmC,OAAQD,EAAIhhB,SAAS,GAAKinD,EAAI/lC,QAEpDsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACAouE,EAAWvuF,MAAQy2C,EAAQ11C,OAAOf,QAClCuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAuHR,OAFAxsD,uBA/GI,IAAIu4H,EAAa,EAAGC,EAAW,EAC/Bl/H,EAAIq1D,UAAYgE,GAAK,sCAAwC,aAE7D,IAAI6nE,EAAWL,KACf,IAAKK,EACD,OAEJ,IAAIhN,EAAUgN,EAAShN,QAAQ+M,GAC/BC,EAASjsC,KAAKi/B,GAAS7mG,SAEvB,IAAI8zG,EAAmB,IAAIrgE,GAAS,CAChCp9B,MAAO21B,GAAK,qCACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAA8B,IAAlB+/D,EAAa,GACzB19D,WH3DU,GG4DVzL,SAAU,SAAUtvE,GAChBy4I,EAAaz4I,EAAM,GAAK,EACxB06I,EAASjsC,KAAKi/B,GAAS2F,mBAAmBoF,EAAYC,GAAU7xG,SAChE6qD,EAAgB/E,YAGpBiuD,EAAiB,IAAItgE,GAAS,CAC9Bp9B,MAAO21B,GAAK,mCACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAA4B,IAAhBggE,EAAW,GACvB39D,WHzEU,GG0EVzL,SAAU,SAAUtvE,GAChB04I,EAAW14I,EAAM,GAAK,EACtB06I,EAASjsC,KAAKi/B,GAAS2F,mBAAmBoF,EAAYC,GAAU7xG,SAChE6qD,EAAgB/E,YAGxBguD,EAAiBrjE,aAAatnE,MAAMkkE,aAAe,OACnD16D,EAAIxgB,YAAY2hJ,EAAiBrjE,cACjC99D,EAAIxgB,YAAY4hJ,EAAetjE,cAI/B,IAAI+L,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIp7F,EAAI,EAAGA,EAAIyzF,EAAOxzF,OAAQD,IAC/Bo7F,EAAgB/wF,KAAK,CACjBs4E,MAAO3iF,IAAMqkJ,EAAqBE,EAAW9wD,EAAOzzF,GAAGwsG,QAAQ11C,OAC/DgtB,QAAS2P,EAAOzzF,GAAG8jF,QACnB4P,WAAYD,EAAOzzF,GAAG0zF,aAIlC,IAAI6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+gB,GACrBG,OAAQlhB,SAAS,GAAKghB,GACtB29B,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+gB,GAAK,KAC1BG,OAAQlhB,SAAS,GAAKghB,GAAK,QAGnC4uF,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAE3BrhI,EAAIxgB,YAAYqqF,GAEhB,IACIq3D,EAASjsC,KAAKi/B,GAAS2F,mBAAmBoF,EAAYC,GAAU7xG,SAChE6qD,EAAgB/E,SAClB,MAAM7zF,GACH0gB,EAAY8gF,cAAcxhG,GAG/BmJ,EAAO03D,QAAO,KACVghF,EAAiBhhF,UACjBihF,EAAejhF,UACf+zE,EAAQ/zE,WAEZ13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACH8+E,WAAYA,EACZC,SAAUA,MAKC,GAEhBz2I,GAGX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjB81C,EAAa54F,EAAO//C,MAAM24I,WAC1BC,EAAW74F,EAAO//C,MAAM44I,SACxB11C,EAAUnjD,EAAOmjD,QACrB,IAAKL,GAA0B,OAAf81C,GAAoC,OAAbC,IAAsB11C,EACzD,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAcvC,OAbAytF,EAASjsC,KAAKi/B,GAAS2F,mBAAmBoF,EAAYC,GAAU7xG,SAChE87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,wBACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAIf,ICjLFg7I,GAAa,CAEtBx9C,UAAUz9C,GACN,MAAMoN,EAASpN,EAAOoN,OACtB,IAAKA,EACD,OAAO,EACX,MAAMwtF,EAAat0E,GAAGlZ,SACtB,CACI,IAAIilC,EAAM/rB,GAAGod,QAAQt2B,EAAOiuD,WAAYjuD,EAAOkuD,YAAa,IAAK,IAAK,GAClEnvD,EAAI/gB,SAAS,GAAKinD,EAAIhmC,OAAQD,EAAIhhB,SAAS,GAAKinD,EAAI/lC,QACpD4uF,EAAgB/uF,EAAIiB,EAAOiuD,WAC/Bu/B,EAAWvuF,MAAQF,EACnByuF,EAAWtuF,OAASF,EACpBwuF,EAAWzqI,MAAMC,QAAU,QAC3BwqI,EAAWvtF,WAAW,MAAM0e,UAAU3e,EAAO4wD,kBAAkBk9B,GAAgB,EAAG,EAAG/uF,EAAGC,GAG5F,MAAMzyC,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CAChB4K,QAAS2M,GAEbA,EAAIq1D,UAAYgE,GAAK,2BAA6B,aAClD,IAAI39D,EAAO,EAAGC,EAAQ,EAAGw4C,EAAM,EAAGqlB,EAAS,EACvCgoE,GAAc,EAAOC,GAAe,EAAOC,GAAa,EAAOC,GAAgB,EACnF,MAAMvlC,EAAW/1D,EAAO+1D,SAAUC,EAAYh2D,EAAOg2D,UACrD,IAAIluE,EAMJ,MAAMyzG,EAAYj1E,GAAG1+D,GAAG,CACpB0nE,IAAK,CAAC0E,WAAY,OAAQ1nB,OAAQ,UAEhCkvF,EAAYl1E,GAAG1+D,GAAG,CACpB0nE,IAAK,CAAC0E,WAAY,OAAQ1nB,OAAQ,UAEtC3yC,EAAIxgB,YAAYoiJ,GAChB5hI,EAAIxgB,YAAYqiJ,GAEhB,MAAMC,EAAYzjE,GAAM,CACpBp6C,KAAM,EACN9kC,KAAM,SACNmO,KAAMmmD,EAAOiuD,WACbt0G,IAAKgvG,EACLzmC,IAAK,CAACjjB,MAAO,OAAQioB,YAAa,QAClCrtC,SAAU,SAAS3uB,GACf6iI,GAAc,EACdO,OAGFC,EAAa3jE,GAAM,CACrBp6C,KAAM,EACN9kC,KAAM,SACNmO,KAAMmmD,EAAOiuD,WACbt0G,IAAKgvG,EACLzmC,IAAK,CAACjjB,MAAO,QACbplB,SAAU,SAAS3uB,GACf8iI,GAAe,EACfM,OAGFE,EAAW5jE,GAAM,CACnBp6C,KAAM,EACN9kC,KAAM,SACNmO,KAAMmmD,EAAOkuD,YACbv0G,IAAKivG,EACL1mC,IAAK,CAACjjB,MAAO,OAAQioB,YAAa,QAClCrtC,SAAU,SAAS3uB,GACf+iI,GAAa,EACbK,OAGFG,EAAc7jE,GAAM,CACtBp6C,KAAM,EACN9kC,KAAM,SACNmO,KAAMmmD,EAAOkuD,YACbv0G,IAAKivG,EACL1mC,IAAK,CAACjjB,MAAO,QACbplB,SAAU,SAAS3uB,GACfgjI,GAAgB,EAChBI,OAIFI,EAAa,CACf1rI,QAAS,eACTi8C,MAAO,iBAeFqvF,IACLrmI,EAAO+1B,SAASqwG,EAAUzkJ,OAC1Bse,EAAQ81B,SAASuwG,EAAW3kJ,OAC5B82D,EAAM1iB,SAASwwG,EAAS5kJ,OACxBm8E,EAAS/nC,SAASywG,EAAY7kJ,OAC9B,IAAIu3E,EAAWnhB,EAAOiuD,WAAahmG,EAAOC,EACtCk5D,EAAYphB,EAAOkuD,YAAcxtD,EAAMqlB,EAEvC5E,GAAY,IACR4sE,IACA9lI,GAAQ+3C,EAAOiuD,WAAa/lG,EAAQ,EACpCmmI,EAAUzkJ,MAAQ,GAAKqe,GAEvB+lI,IACA9lI,GAAS83C,EAAOiuD,WAAahmG,EAAO,EACpCsmI,EAAW3kJ,MAAQ,GAAKse,GAE5Bi5D,EAAW,GAEXA,EAAWwnC,IACPolC,IACA9lI,GAAQ+3C,EAAOiuD,WAAa/lG,EAAQygG,EACpC0lC,EAAUzkJ,MAAQ,GAAKqe,GAEvB+lI,IACA9lI,GAAS83C,EAAOiuD,WAAahmG,EAAO0gG,EACpC4lC,EAAW3kJ,MAAQ,GAAKse,GAE5Bi5D,EAAWwnC,GAEXvnC,GAAa,IACT6sE,IACAvtF,GAAOV,EAAOkuD,YAAcnoC,EAAS,EACrCyoE,EAAS5kJ,MAAQ,GAAK82D,GAEtBwtF,IACAnoE,GAAU/lB,EAAOkuD,YAAcxtD,EAAM,EACrC+tF,EAAY7kJ,MAAQ,GAAKm8E,GAE7B3E,EAAY,GAEZA,EAAYwnC,IACRqlC,IACAvtF,GAAOV,EAAOkuD,YAAcnoC,EAAS6iC,EACrC4lC,EAAS5kJ,MAAQ,GAAK82D,GAEtBwtF,IACAnoE,GAAU/lB,EAAOkuD,YAAcxtD,EAAMkoD,EACrC6lC,EAAY7kJ,MAAQ,GAAKm8E,GAE7B3E,EAAYwnC,GAEhB+lC,EAAQ3nD,aAAa,CACjBx7E,GAAIvD,EACJwD,GAAIi1C,EACJzB,MAAOkiB,EACPjiB,OAAQkiB,IAIZ2sE,GAAc,EACdC,GAAe,EACfC,GAAa,EACbC,GAAgB,EA5EpBC,EAAUz6F,OACNwlB,GAAG1+D,GAAG,CAAC0H,QAAS0jE,GAAK,oBAAsB,IAAK1D,IAAKwsE,IACrDL,EACAn1E,GAAG1+D,GAAG,CAAC0H,QAAS0jE,GAAK,qBAAuB,IAAK1D,IAAKwsE,IACtDH,GAEJH,EAAU16F,OACNwlB,GAAG1+D,GAAG,CAAC0H,QAAS0jE,GAAK,mBAAqB,IAAK1D,IAAKwsE,IACpDF,EACAt1E,GAAG1+D,GAAG,CAAC0H,QAAS0jE,GAAK,sBAAwB,IAAK1D,IAAKwsE,IACvDD,GAqEJ,IAAIG,GAAkB,EAClBC,EAAsB,IAAI3kE,GAAS,CACnC15C,MAAM,EACNyf,MAAO21B,GAAK,2BACZ6E,UAAU,EACV5wC,SAAU,SAAS1uB,GACfyjI,EAAkBzjI,EAClBwjI,EAAQznD,WAAW0nD,MAG3BriI,EAAIxgB,YAAYmtE,GAAG1+D,GAAG,CAClB0nE,IAAK,CACD/uD,MAAO,WAIf,IAAI27H,EAAkB,CAACn1H,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GAC5C,MAAMo6H,EAAkB,CACpB,CAACh2G,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GACtB,CAACokB,EAAG,IAAKioC,EAAG,IAAKz2C,EAAG,IAAK5V,EAAG,GAC5B,CAACokB,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,IAE1Bo6H,EAAgBp8H,KAAK,CACjBomB,EAAGi5B,EAAOsnF,gBAAgBvgH,EAC1BioC,EAAGhP,EAAOsnF,gBAAgBt4E,EAC1Bz2C,EAAGynC,EAAOsnF,gBAAgB/uH,EAC1B5V,EAAG,IAEPo6H,EAAgBp8H,KAAK,CACjBomB,EAAGi5B,EAAOwnF,kBAAkBzgH,EAC5BioC,EAAGhP,EAAOwnF,kBAAkBx4E,EAC5Bz2C,EAAGynC,EAAOwnF,kBAAkBjvH,EAC5B5V,EAAG,IAGP,MAAMq6H,EAAe,IAAI77C,GAAa,CAClC9jC,MAAO21B,GAAK,oBACZqO,SAAU07C,EACVttD,SAAU,SAASpK,GACf62E,EAAkB72E,WA8GRA,GAEd,IAAIsmB,EACc,IAAdtmB,EAAQ1iE,GACRgpF,EAAc,kBACdwwD,EAAehsI,MAAM8jE,WAAa,GAClC2mE,EAAWzqI,MAAM8jE,WAAa,KAE9B0X,EAAetmB,EAAQt+C,EAAIs+C,EAAQrW,EAAIqW,EAAQ9sD,EAAI,MAAe,wBAA0B,kBAC5F4jI,EAAehsI,MAAM8jE,WAAa3N,GAAGkX,eAAetY,SAASG,GAE7DiB,GAAGkb,qBAAqBp2C,SAAS,GAAM,GAAKtD,IAAS,SAAUhxC,GAC3D8jJ,EAAWzqI,MAAM8jE,WAAa,OAASn9E,EAAM,QAGrD8jJ,EAAWzqI,MAAM+jE,UAAY,eAAiByX,EA5H1CywD,CAAS/2E,MAKXg3E,EAAU/1E,GAAG1+D,GAAG,CAClB0nE,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,4BAUfzsC,EAAOglC,GACZ,MAAMqmB,EAAM/rB,GAAGod,QAAQ1X,EAAU3f,MAAO2f,EAAU1f,OAAQ,IAAK,IAAK,GACpExkB,EAAQuqD,EAAIhmC,MAAQ2f,EAAU3f,MAE9B,MAAMl0B,EAASmuC,GAAGg2E,aAAa,IAAK,IAAKjqD,EAAIhmC,MAAOgmC,EAAI/lC,QAExDsuF,EAAWzqI,MAAMk8C,MAAQe,EAAOiuD,WAAavzE,EAAQ,KACrD8yG,EAAWzqI,MAAMm8C,OAASc,EAAOkuD,YAAcxzE,EAAQ,KAEvDy0G,EAAcpsI,MAAMkF,KAAQ8iB,EAAOvf,EAAIozD,EAAUpzD,EAAIkvB,EAAS,KAC9Dy0G,EAAcpsI,MAAM29C,IAAO31B,EAAOtf,EAAImzD,EAAUnzD,EAAIivB,EAAS,KAE7DzyB,EAAO+1B,SAAS,IAAM4gC,EAAUpzD,GAChCk1C,EAAM1iB,SAAS,IAAM4gC,EAAUnzD,GAC/BvD,EAAQ81B,SAAS,IAAM4gC,EAAUpzD,EAAIozD,EAAU3f,MAAQe,EAAOiuD,aAC9DloC,EAAS/nC,SAAS,IAAM4gC,EAAUnzD,EAAImzD,EAAU1f,OAASc,EAAOkuD,cAChEmgC,EAAUzkJ,MAAQ,GAAKqe,EACvBumI,EAAS5kJ,MAAQ,GAAK82D,EACtB6tF,EAAW3kJ,MAAQ,GAAKse,EACxBumI,EAAY7kJ,MAAQ,GAAKm8E,EAEzB7M,GAAGkb,qBAAqBp2C,SAAS,GAAM,GAAKtD,IAAS,SAAUhxC,GAC3D0sF,EAAerzE,MAAM8jE,WAAa,OAASn9E,EAAM,IACvB,IAAtBolJ,EAAgBv5I,IAChBi4I,EAAWzqI,MAAM8jE,WAAa,OAASn9E,EAAM,QAGrD0sF,EAAerzE,MAAM+lF,mBAAsB/9D,EAAOvf,EAAK,MAASuf,EAAOtf,EAAK,KAE5EkjI,EAAQ1nD,SAASvsD,GApCrBnuB,EAAIxgB,YAAYkjJ,GAChBA,EAAQljJ,YAAY8iJ,EAAoBxkE,cACxC4kE,EAAQljJ,YAAY6jI,EAAavlD,cAqCjC,MAAM+L,EAAiBld,GAAG1+D,GAAG,CACzB0nE,IAAK,CACDjjB,MAAO,QACP8oB,UAAW,OACXC,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBruD,SAAU,WACVooD,UAAW,sEACXd,SAAU,SACVmI,WAAY,OACZ7C,YAAa,aACb8lD,YAAa,UAGrBh7C,EAAe5H,cAAgB,WAC3B,OAAO,GAEX,MAAMugE,EAAiB71E,GAAG1+D,GAAG,CACzB0nE,IAAK,CACDxjD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLqlB,OAAQ,IACR79D,MAAO,OAGfkuE,EAAerqF,YAAYgjJ,GAE3B,MAAMI,EAAgB5jJ,SAASC,cAAc,OAC7C2jJ,EAAcpsI,MAAM2b,SAAW,WAC/BywH,EAAcpsI,MAAMkF,KAAO,MAC3BknI,EAAcpsI,MAAM29C,IAAM,MAC1B01B,EAAerqF,YAAYojJ,GAGLj2E,GAAGm0D,cAAc8hB,EAAe,IACxCpjJ,YAAYyhJ,GAG1BA,EAAWzqI,MAAM+jE,UAAY,8BAC7B0mE,EAAWzqI,MAAM2b,SAAW,WAC5B8uH,EAAWzqI,MAAMkF,KAAO,MACxBulI,EAAWzqI,MAAM29C,IAAM,MAEvBn0C,EAAIxgB,YAAYqqF,GAChB,MAAMu4D,EAAU,IAAItpD,GAAQ,CACxB75E,EAAG,EACHC,EAAG,EACHwzC,MAAOe,EAAOiuD,WACd/uD,OAAQc,EAAOkuD,YACfxzE,MAAOA,EACPb,SAAUD,EACV0rD,KAAMqjB,EACNpjB,KAAMqjB,IAqCV,OAnCAhvE,EAAO+0G,EAAQzsD,gBACfitD,EAAcpjJ,YAAY4iJ,EAAQtkE,cAoBlCr1E,EAAO03D,QAAO,KACViiF,EAAQjiF,UACRmiF,EAAoBniF,WAExB13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACHzkD,KAAMA,EACNC,MAAOA,EACPw4C,IAAKA,EACLqlB,OAAQA,EACRipC,UAAiC,IAAtB8/B,EAAgBv5I,EAAU,KAAOu5I,IAG7C95I,GAGX1I,MAAMsmD,GACF,MAAMoN,EAASpN,EAAOoN,OAChB+1C,EAAUnjD,EAAOmjD,QACvB,SAAK/1C,IAAW+1C,GAAWp4B,MAAM/qB,EAAO//C,MAAMoV,OAAS01D,MAAM/qB,EAAO//C,MAAMqV,QAAUy1D,MAAM/qB,EAAO//C,MAAM6tD,MAAQid,MAAM/qB,EAAO//C,MAAMkzE,WAGlIgwB,EAAQvyB,OAAM,GACdxjB,EAAO2uD,aAAa/7D,EAAO//C,OAC3BkjG,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,cACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAOnG,KAAKC,MAAMD,KAAK8zD,UAAU5N,EAAO//C,aAGzC,KCjXFu8I,GAAW,CAEpB/+C,UAAUz9C,GAEN,IAAI8iD,EAAU9iD,EAAO8iD,QACjB25C,EAASz8F,EAAOoN,OACpB,IAAK01C,IAAY25C,EACb,OAAO,EAGX,IAAI1yD,EAAS0yD,EAAO/gC,YAChBi/B,EAAqB8B,EAAOp+B,cAAcvb,EAAQ11C,QAElDsvF,EAAMp2E,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ,IAAK,IAAK,GACxEH,EAAI/gB,SAAS,GAAKsxG,EAAIrwF,OAAQD,EAAIhhB,SAAS,GAAKsxG,EAAIpwF,QAEpDsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACAouE,EAAWvuF,MAAQy2C,EAAQ11C,OAAOf,QAClCuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAGR,IAIIglB,EAJA63C,EAAM/wI,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS08H,GAuWb,OAFArpH,uBA/V4ByiF,EAAQ11C,OAAOf,MAGvCq9E,EAAI16D,UAAYgE,GAAK,6BAA+B,aAEpD,IAAI2pE,EAAS,CACT51H,EAAG,CAAC,CAAC,EAAG,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAG,IAChDioC,EAAG,CAAC,CAAC,EAAG,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAG,IAChDz2C,EAAG,CAAC,CAAC,EAAG,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAG,KAGhDsiI,EAAWL,KACf,IAAKK,EACD,OAEJ,IAcI+B,EAdA/O,EAAUgN,EAAShN,QAAQ+M,GAC/BC,EAASjsC,KAAKi/B,GAAS7mG,SAsQvB,IAAI/mC,EAAQ,aAvPSg0D,GACjB,IAAIt6C,EAAMhhB,SAASC,cAAc,OACjC+gB,EAAIiiE,cAAgB,WAChB,OAAO,GAEXjiE,EAAIxJ,MAAM2b,SAAW,WACrBnS,EAAIxJ,MAAMkkE,aAAe,OACzB,IAAIzzE,EAAO,MACP4zI,EAASvgF,EAAEugF,OACfoI,EAAc,IAAI76D,GAAS,CACvB1J,UAAW,CACP,CACI7hF,GAAI,MACJ6mD,MAAO21B,GAAK,sBAEhB,CACIx8E,GAAI,MACJ6mD,MAAO21B,GAAK,QAEhB,CACIx8E,GAAI,QACJ6mD,MAAO21B,GAAK,UAEhB,CACIx8E,GAAI,OACJ6mD,MAAO21B,GAAK,UAGpBkP,UAAW,MACXzS,SAAU,SAASj5E,GACfoK,EAAOpK,EACM,QAAToK,IACA4zI,EAAS,CACLztH,EAAG,CAAC,CAAC,EAAG,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAG,IAChDioC,EAAG,CAAC,CAAC,EAAG,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAG,IAChDz2C,EAAG,CAAC,CAAC,EAAG,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAI,EAAG,EAAI,GAAI,CAAC,EAAG,MAGxD,IAAIsiE,EAAQ25D,EAAOztH,EACN,UAATnmB,IACAi6E,EAAQ25D,EAAOxlF,GAEN,SAATpuD,IACAi6E,EAAQ25D,EAAOj8H,GAElBskI,EAAWptD,OAAO,EAAGqtD,EAAQjiE,EAAM,GAAG,GAAKiiE,GAC3C/qF,EAAW09B,OAAO5U,EAAM,GAAG,GAAKkiE,EAAOD,EAAQjiE,EAAM,GAAG,GAAKiiE,GAC7D9qF,EAAWy9B,OAAO5U,EAAM,GAAG,GAAKkiE,EAAOD,EAAQjiE,EAAM,GAAG,GAAKiiE,GAC7D9xE,EAAWykB,OAAOstD,EAAOD,EAAQjiE,EAAM,GAAG,GAAKiiE,GAEhDE,OAGRrjI,EAAIxgB,YAAYyjJ,EAAYnlE,cAE5B,IAAIwlE,EAAYtkJ,SAASC,cAAc,OACvC0tE,GAAGgJ,IAAI2tE,EAAW,CACdnxH,SAAU,WACVqpD,UAAW,OACXuD,YAAa,eAEjB/+D,EAAIxgB,YAAY8jJ,GAEhB,IAAIF,EAAQ,IAAKD,EAAQ,IACrB1vF,EAASz0D,SAASC,cAAc,UACpCw0D,EAAOf,MAAQ0wF,EACf3vF,EAAOd,OAASwwF,EAChBx2E,GAAGgJ,IAAIliB,EAAQ,CACX6mB,WAAY,UACZC,UAAW,8BAEf,IAAItU,EAAMxS,EAAOC,WAAW,eASnBglC,EAAI/5E,GACT,OAAOpgB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAGqR,aAG1B4kI,EAAYtkI,EAAGC,EAAGouB,EAAUk2G,GACjC,IACIC,EAAYvkI,EAAGwkI,EAAYzkI,EAC3B47B,EAAQ77C,SAASC,cAAc,OA4DnC,OA3DA0tE,GAAGgJ,IAAI96B,EAAO,CACV1oB,SAAU,WACVzW,KAAOuD,EAAIo3E,EAAgB,KAC3BliC,IAAMj1C,EAAIm3E,EAAgB,KAC1B3jC,MAAO2jC,OACP1jC,OAAQ0jC,OACR/b,WAAY,OACZsE,OAAQ,OACR5B,aAAcqZ,OACd9b,UAAW,uBACXqH,WAAY,OACZijD,YAAa,SAUhBhqF,EAAc+nC,gBAAkB,IAAIjW,GAAGsW,gBAAgB,CACpDj0E,OAAQ6rC,EACRigB,YAAa,EACbL,UAAW,SAAS70C,GAChBA,EAAMk3C,sBACa,gBAAfl3C,EAAMzmB,OACNukJ,EAAYzkI,EACZwkI,EAAYvkI,GAEK,SAAjB0G,EAAMg3C,QAAoC,gBAAfh3C,EAAMzmB,OAC5BqkJ,IACDE,GAAa99H,EAAMm4C,IAEvB9+C,EAAI1gB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI81I,EAAOM,IAChCD,GAAa79H,EAAMo4C,GACnB9+C,EAAI3gB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI61I,EAAOM,IArBxC92E,GAAGgJ,IAAI96B,EAAO,CACVn/B,KAAOuD,EAAIo3E,EAAgB,KAC3BliC,IAAMj1C,EAAIm3E,EAAgB,OAqBtB/oD,EAAS,CACLruB,EAAGA,EACHC,EAAGA,QAMnBokI,EAAU9jJ,YAAYq7C,GAErBA,EAAci7C,OAAS,SAAU6tD,EAAMC,GAGpCH,EADAvkI,EAAI0kI,EAEJF,EAHAzkI,EAAI0kI,EAIJh3E,GAAGgJ,IAAI96B,EAAO,CACVn/B,KAAOuD,EAAIo3E,EAAgB,KAC3BliC,IAAMj1C,EAAIm3E,EAAgB,QAI3Bx7C,WAGFgpG,EAAclnJ,EAAGsiB,EAAGC,GACZ,QAATjY,IACA4zI,EAAOztH,EAAEzwB,GAAK,CAAC+7F,EAAIz5E,EAAImkI,GAAQ1qD,EAAI,EAAIx5E,EAAIikI,IAC3CtI,EAAOxlF,EAAE14D,GAAK,CAAC+7F,EAAIz5E,EAAImkI,GAAQ1qD,EAAI,EAAIx5E,EAAIikI,IAC3CtI,EAAOj8H,EAAEjiB,GAAK,CAAC+7F,EAAIz5E,EAAImkI,GAAQ1qD,EAAI,EAAIx5E,EAAIikI,KAElC,QAATl8I,IACA4zI,EAAOztH,EAAEzwB,GAAK,CAAC+7F,EAAIz5E,EAAImkI,GAAQ1qD,EAAI,EAAIx5E,EAAIikI,KAElC,UAATl8I,IACA4zI,EAAOxlF,EAAE14D,GAAK,CAAC+7F,EAAIz5E,EAAImkI,GAAQ1qD,EAAI,EAAIx5E,EAAIikI,KAElC,SAATl8I,IACA4zI,EAAOj8H,EAAEjiB,GAAK,CAAC+7F,EAAIz5E,EAAImkI,GAAQ1qD,EAAI,EAAIx5E,EAAIikI,KA3FnDG,EAAU9jJ,YAAYi0D,GA+FtB,IAAIyvF,EAAKK,EAAY,EAAGJ,GAAO,SAAU38I,GACrCq9I,EAAc,EAAGr9I,EAAIyY,EAAGzY,EAAI0Y,GAC5BmkI,OACD,GACCjrF,EAAKmrF,EAAYH,EAAQ,EAAGD,EAAQ,EAAI,GAAG,SAAU38I,GACrDq9I,EAAc,EAAGr9I,EAAIyY,EAAGzY,EAAI0Y,GAC5BmkI,OAEAhrF,EAAKkrF,EAAYH,EAAQ,EAAI,EAAGD,EAAQ,GAAG,SAAU38I,GACrDq9I,EAAc,EAAGr9I,EAAIyY,EAAGzY,EAAI0Y,GAC5BmkI,OAEAhyE,EAAKkyE,EAAYH,EAAO,GAAG,SAAU58I,GACrCq9I,EAAc,EAAGr9I,EAAIyY,EAAGzY,EAAI0Y,GAC5BmkI,OACD,YAGMA,IACL5vF,EAAOf,MAAQe,EAAOf,MACtBuT,EAAMxS,EAAOC,WAAW,MAExB,IAAIowF,EAAY,CACZ12H,EAAG,GACHioC,EAAG,GACHz2C,EAAG,IAEP,IAAK,IAAI24C,EAAI,EAAGA,EAAIsjF,EAAOztH,EAAExwB,OAAQ26D,IACjCusF,EAAU12H,EAAEpmB,KAAK6zI,EAAOztH,EAAEmqC,IAC1BusF,EAAUzuF,EAAEruD,KAAK6zI,EAAOxlF,EAAEkC,IAC1BusF,EAAUllI,EAAE5X,KAAK6zI,EAAOj8H,EAAE24C,aAGrBwsF,EAAU7iE,GACfjb,EAAIyoB,YACJ,IAAIs1D,EAAS,IAAIr3E,GAAG+U,mBAAmBR,GACvC,IAAK,IAAIvkF,EAAI,EAAGA,EAAI,IAAKA,IAAK,CAC1B,IAAIuiB,EAAI8kI,EAAO96E,YAAYvsE,EAAI,KAC/BuiB,EAAI3gB,KAAK6O,IAAI,EAAG7O,KAAK+O,IAAI,EAAG4R,IAElB,IAANviB,EACAspE,EAAI0oB,OAAOhyF,EAAI,IAAMymJ,EAAOD,EAAQjkI,EAAIikI,GAExCl9E,EAAI2oB,OAAOjyF,EAAI,IAAMymJ,EAAOD,EAAQjkI,EAAIikI,GAGhDl9E,EAAI4oB,SAGR5oB,EAAI4M,OACS,QAAT5rE,GACAg/D,EAAImnB,YAAc,QAClB22D,EAAUD,EAAU12H,KAEpB64C,EAAI+mB,YAAc,GAClB/mB,EAAImnB,YAAc,MAClB22D,EAAUD,EAAU12H,GACpB64C,EAAImnB,YAAc,QAClB22D,EAAUD,EAAUzuF,GACpB4Q,EAAImnB,YAAc,OAClB22D,EAAUD,EAAUllI,IAExBqnD,EAAIiN,UACJ5Y,EAAEhtB,SAASw2G,GAGfT,IAGAziJ,KAAKqjJ,OAAS,WACV,OAAOjkI,GAEXpf,KAAKu/D,QAAU,WACV+iF,EAAWtgE,gBAAgBziB,UAC3B/H,EAAWwqB,gBAAgBziB,UAC3B9H,EAAWuqB,gBAAgBziB,UAC3BkR,EAAWuR,gBAAgBziB,WAIxB,CAAgB,CACxB06E,OAAQmI,EACR11G,SAAU,SAAU9mC,GAChBw8I,EAASx8I,aAtQb,IACI06I,EAASjsC,KAAKi/B,GAAS2G,OAAOmI,EAAO51H,EAAG41H,EAAO3tF,EAAG2tF,EAAOpkI,GAAGyuB,SACxD6qD,GACAA,EAAgB/E,SAEtB,MAAM7zF,GACHywI,EAAYjvC,cAAcxhG,IAiQ3B4kJ,MAKRnU,EAAIvwI,YAAY8G,EAAM29I,UAItB,IAAIp6D,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIlhC,EAAI,EAAGA,EAAIu5B,EAAOxzF,OAAQi6D,IAC/BkhC,EAAgB/wF,KAAK,CACjBs4E,MAAOzoB,IAAMmqF,EAAqBE,EAAW9wD,EAAOv5B,GAAGsyC,QAAQ11C,OAC/DgtB,QAAS2P,EAAOv5B,GAAG4pB,QACnB4P,WAAYD,EAAOv5B,GAAGw5B,aAIlC6H,EAAkB,IAAIhF,GAAgB,CAClCxgC,MAAOjhB,SAAS,GAAK+gB,GACrBG,OAAQlhB,SAAS,GAAKghB,GACtB29B,OAAQ2H,IAGZ,IAAIspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+gB,GAAK,KAC1BG,OAAQlhB,SAAS,GAAKghB,GAAK,QAGnC4uF,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAG3BtR,EAAIvwI,YAAYqqF,GAEhBphF,EAAO03D,QAAO,KACV75D,EAAM65D,UACN+zE,EAAQ/zE,UACR8iF,EAAY9iF,WAEhB13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACH06E,OAAQmI,MAKG,GAEhBv6I,GAGX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjB0xC,EAASx0F,EAAO//C,MAAMu0I,OACtBrxC,EAAUnjD,EAAOmjD,QACrB,IAAKL,GAAsB,OAAX0xC,IAAoBrxC,EAChC,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAcvC,OAbAytF,EAASjsC,KAAKi/B,GAAS2G,OAAOA,EAAOztH,EAAGytH,EAAOxlF,EAAGwlF,EAAOj8H,GAAGyuB,SAC5D87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,YACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAIf,WCvaf69I,GAAiBtmJ,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCQ/G,MAAMqmJ,GAAO,CAEhBtgD,UAAUz9C,GACN,IAAI8iD,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OACpB,IAAK01C,IAAY11C,EACb,OAAO,EAGX,IAAI28B,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ,IAAK,IAAK,GACxEH,EAAI/gB,SAAS,GAAKinD,EAAIhmC,OAAQD,EAAIhhB,SAAS,GAAKinD,EAAI/lC,QAEpD3yC,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAETsjG,GAAe,EACflsB,GAAa,EACbitD,GAAe,EACnBrkI,EAAIq1D,UAAYgE,GAAK,2BAA6B,aAGlD,IAAIirE,EAAqB,IAAI3mE,GAAS,CAClC15C,KAAMq/E,EACN5/D,MAAO21B,GAAK,0BAA4B,KACtC6E,UAAQ,EACV5wC,SAAU,SAAS3uB,GACf2kG,EAAe3kG,EACfw5E,KAEJxiB,IAAK,CACD+E,aAAc,UAGlB6pE,EAAmB,IAAI5mE,GAAS,CAChC15C,KAAMmzD,EACN1zC,MAAO21B,GAAK,wBAA0B,KACtC6E,UAAU,EACV5wC,SAAU,SAAS3uB,GACfy4E,EAAaz4E,EACbw5E,KAEJxiB,IAAK,CACD+E,aAAc,UAGtB16D,EAAIxgB,YAAY8kJ,EAAmBxmE,cACnC99D,EAAIxgB,YAAY+kJ,EAAiBzmE,cAMjC,IAAI0mE,EAAWxlJ,SAASC,cAAc,OACtC0tE,GAAGwJ,iBAAiBquE,EAAU,iBAAiB,WAC3C,OAAO,KAEXA,EAASnlJ,YAAcg6E,GAAK,qBAC5BmrE,EAAShuI,MAAMk8C,MAAQ,QACvB8xF,EAAShuI,MAAMm8C,OAAS,OACxB6xF,EAAShuI,MAAMqhH,WAAa,OAC5B2sB,EAAShuI,MAAM0xE,UAAY,SAC3Bs8D,EAAShuI,MAAM2pE,SAAW,OAC1BqkE,EAAShuI,MAAMiuI,cAAgB,MAC/BD,EAAShuI,MAAMkuI,oBAAsB,OACrCF,EAAShuI,MAAM+jE,UAAY,qCAC3BiqE,EAAShuI,MAAM8jE,WAAa,OAAS9B,EAAA2rE,IAAe,wBACpDK,EAAShuI,MAAM4pE,eAAiB,KAChCokE,EAAShuI,MAAMgqE,gBAAkB,UAEjC,IAAImkE,EAAW3lJ,SAASC,cAAc,OACtC0tE,GAAGwJ,iBAAiBwuE,EAAU,iBAAiB,WAC3C,OAAO,KAEXA,EAAStlJ,YAAcg6E,GAAK,qBAC5BsrE,EAASnuI,MAAMk8C,MAAQ,QACvBiyF,EAASnuI,MAAMm8C,OAAS,OACxBgyF,EAASnuI,MAAMqhH,WAAa,OAC5B8sB,EAASnuI,MAAM0xE,UAAY,SAC3By8D,EAASnuI,MAAM2pE,SAAW,OAC1BwkE,EAASnuI,MAAMiuI,cAAgB,MAC/BE,EAASnuI,MAAMouI,qBAAuB,OACtCD,EAASnuI,MAAMooE,OAAS,UACxB+lE,EAASnuI,MAAMgqE,gBAAkB,qBACjCmkE,EAASnuI,MAAM4pE,eAAiB,KAEhCzT,GAAGwJ,iBAAiBquE,EAAU,iBAAiB,YACtB,IAAjBH,IACAG,EAAShuI,MAAMgqE,gBAAkB,WAEzC7T,GAAGwJ,iBAAiBquE,EAAU,gBAAgB,YACrB,IAAjBH,IACAG,EAAShuI,MAAMgqE,gBAAkB,yBAEzC7T,GAAGwJ,iBAAiBwuE,EAAU,iBAAiB,YACtB,IAAjBN,IACAM,EAASnuI,MAAMgqE,gBAAkB,WAEzC7T,GAAGwJ,iBAAiBwuE,EAAU,gBAAgB,YACrB,IAAjBN,IACAM,EAASnuI,MAAMgqE,gBAAkB,yBAGzCgkE,EAASrpE,QAAU,WACfkpE,GAAe,EAEfM,EAASnuI,MAAM8jE,WAAa,GAC5BqqE,EAASnuI,MAAMgqE,gBAAkB,qBACjCmkE,EAASnuI,MAAM+jE,UAAY,GAC3BoqE,EAASnuI,MAAMooE,OAAS,UAExB4lE,EAAShuI,MAAM8jE,WAAa,OAAS9B,EAAA2rE,IAAe,wBACpDK,EAAShuI,MAAM4pE,eAAiB,KAChCokE,EAAShuI,MAAMgqE,gBAAkB,UACjCgkE,EAAShuI,MAAMooE,OAAS,UACxB4lE,EAAShuI,MAAM+jE,UAAY,qCAE3B4d,KAEJwsD,EAASxpE,QAAU,WACfkpE,GAAe,EAEfG,EAAShuI,MAAM8jE,WAAa,GAC5BkqE,EAAShuI,MAAMgqE,gBAAkB,qBACjCgkE,EAAShuI,MAAM+jE,UAAY,GAC3BiqE,EAAShuI,MAAMooE,OAAS,UAExB+lE,EAASnuI,MAAM8jE,WAAa,OAAS9B,EAAA2rE,IAAe,wBACpDQ,EAASnuI,MAAM4pE,eAAiB,KAChCukE,EAASnuI,MAAMgqE,gBAAkB,UACjCmkE,EAASnuI,MAAMooE,OAAS,UACxB+lE,EAASnuI,MAAM+jE,UAAY,qCAE3B4d,KAGJ,IAAI0sD,EAAgB7lJ,SAASC,cAAc,OAC3C4lJ,EAAcrlJ,YAAYglJ,GAC1BK,EAAcrlJ,YAAYmlJ,GAC1B3kI,EAAIxgB,YAAYqlJ,GAGhB,IAAIh7D,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAI+lE,EAA8B,CAC9BxlE,MAAO3S,GAAGlZ,OAAOl1D,KAAK4jC,MAAMqwB,GAAIj0D,KAAK4jC,MAAMswB,IAC3CguB,QAAS,EACT4P,WAAY,eAEZ6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOn0D,KAAK4jC,MAAMqwB,GAClBG,OAAQp0D,KAAK4jC,MAAMswB,GACnB29B,OAAQ,CAAC00D,KAGTzD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+gB,GAAK,KAC1BG,OAAQlhB,SAAS,GAAKghB,GAAK,iBAM1B0lC,IACL,IAAIlyB,EAAO6+E,EAAaxlE,MAA4B5rB,WAAW,MAC/DuS,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAG0xD,EAAaxlE,MAAM5sB,MAAOoyF,EAAaxlE,MAAM3sB,QAE7D0xF,IACI/gC,IACAr9C,EAAI+M,UAAU8xE,EAAaxlE,MAAM5sB,MAAO,GACxCuT,EAAI93B,OAAM,EAAI,IAEdipD,IACAnxB,EAAI+M,UAAU,EAAG8xE,EAAaxlE,MAAM3sB,QACpCsT,EAAI93B,MAAM,GAAG,KAIrB,IAAK,IAAIxxC,EAAI,EAAGA,EAAIyzF,EAAOxzF,OAAQD,IAC/BspE,EAAI4M,OACCwxE,GAAgBrD,IAAuBrkJ,IACpC2mH,IACAr9C,EAAI+M,UAAU8xE,EAAaxlE,MAAM5sB,MAAO,GACxCuT,EAAI93B,OAAM,EAAI,IAEdipD,IACAnxB,EAAI+M,UAAU,EAAG8xE,EAAaxlE,MAAM3sB,QACpCsT,EAAI93B,MAAM,GAAG,KAGjB83B,EAAIxS,OAAOf,MAAQ09B,EAAOzzF,GAAGwsG,QAAQ11C,OAAOf,QAC5CuT,EAAI6M,uBAAwB,GAEhC7M,EAAI+mB,YAAcoD,EAAOzzF,GAAG8jF,QAC5Bxa,EAAIwO,yBAA2B2b,EAAOzzF,GAAG0zF,WACzCpqB,EAAImM,UAAUge,EAAOzzF,GAAGwsG,QAAQ11C,OAAQ,EAAG,EAAGqxF,EAAaxlE,MAAM5sB,MAAOoyF,EAAaxlE,MAAM3sB,QAC3FsT,EAAIiN,UAERglB,EAAgB/E,SAChBltB,EAAIiN,UAkBR,OA1DAmuE,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAyC3B36H,WAAWyxE,EAAe,GAG1Bn4E,EAAIxgB,YAAYqqF,GAChBphF,EAAO03D,QAAO,KACVmkF,EAAmBnkF,UACnBokF,EAAiBpkF,WAErB13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACH4kF,WAAYzhC,EACZ0hC,SAAU5tD,EACV6tD,WAAYZ,IAGb57I,GAGX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OAChB+1C,EAAUnjD,EAAOmjD,QACjBu7C,EAAa1+F,EAAO//C,MAAMy+I,WAC1BC,EAAW3+F,EAAO//C,MAAM0+I,SACxBC,EAAa5+F,EAAO//C,MAAM2+I,WAC9B,SAAK97C,GAAY11C,GAAW+1C,KAI5BA,EAAQvyB,OAAM,GACdxjB,EAAOghC,KAAKswD,EAAYC,EAAUC,EAAa,KAAOxxF,EAAOixD,cAAcvb,EAAQ11C,SACnF+1C,EAAQvyB,OAAM,GAEduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,QACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,KCxQF4+I,GAAkB,CAE3BphD,UAAUz9C,GAEN,IAAI8iD,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OACpB,IAAK01C,IAAY11C,EACb,OAAO,EAGX,IAAI28B,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAO,IAAK,IAAM,GACxEH,EAAI/gB,SAAS,GAAKinD,EAAIhmC,OAAQD,EAAIhhB,SAAS,GAAKinD,EAAI/lC,QAEpDsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACAouE,EAAWvuF,MAAQy2C,EAAQ11C,OAAOf,QAClCuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAGR,IAAIlzD,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAoHb,OADA0G,uBA/GI,IAAIuqE,EAAM,EAAGk0D,EAAa,EAC1BnlI,EAAIq1D,UAAYgE,GAAK,8BAAgC,aAErD,IAAI6nE,EAAWL,KACf,IAAKK,EACD,OAEJ,IAAIhN,EAAUgN,EAAShN,QAAQ+M,GAC/BC,EAASjsC,KAAKi/B,GAAS7mG,SAEvB,IAAI+3G,EAAY,IAAItkE,GAAS,CACzBp9B,MAAO21B,GAAK,sBACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,KAAK,IACLF,IAAK,IACL8xE,UAAiB,IAAN+R,EACX1P,WRzDU,GQ0DVzL,SAAU,SAAUtvE,GAChByqF,EAAMzqF,EAAM,IACZ06I,EAASjsC,KAAKi/B,GAAS6F,cAAc9oD,EAAKk0D,GAAY93G,SACtD6qD,EAAgB/E,YAGpBkyD,EAAmB,IAAIvkE,GAAS,CAChCp9B,MAAO21B,GAAK,6BACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAA8B,IAAlBimE,EAAa,GACzB5jE,WRvEU,GQwEVzL,SAAU,SAAUtvE,GAChB2+I,EAAa3+I,EAAM,GAAK,EACxB06I,EAASjsC,KAAKi/B,GAAS6F,cAAc9oD,EAAKk0D,GAAY93G,SACtD6qD,EAAgB/E,YAGxBiyD,EAAUtnE,aAAatnE,MAAMkkE,aAAe,OAC5C16D,EAAIxgB,YAAY4lJ,EAAUtnE,cAC1B99D,EAAIxgB,YAAY6lJ,EAAiBvnE,cAGjC,IAAI+L,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIp7F,EAAI,EAAGA,EAAIyzF,EAAOxzF,OAAQD,IAC/Bo7F,EAAgB/wF,KAAK,CACjBs4E,MAAO3iF,IAAMqkJ,EAAqBE,EAAW9wD,EAAOzzF,GAAGwsG,QAAQ11C,OAC/DgtB,QAAS2P,EAAOzzF,GAAG8jF,QACnB4P,WAAYD,EAAOzzF,GAAG0zF,aAIlC,IAAI6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+gB,GACrBG,OAAQlhB,SAAS,GAAKghB,GACtB29B,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+gB,GAAK,KAC1BG,OAAQlhB,SAAS,GAAKghB,GAAK,QAGnC4uF,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAG3BrhI,EAAIxgB,YAAYqqF,GAEhB,IACIq3D,EAASjsC,KAAKi/B,GAAS6F,cAAc9oD,EAAKk0D,GAAY93G,SACtD6qD,EAAgB/E,SAClB,MAAM7zF,GACH0gB,EAAY8gF,cAAcxhG,GAG/BmJ,EAAO03D,QAAO,KACVilF,EAAUjlF,UACVklF,EAAiBllF,UACjB+zE,EAAQ/zE,WAEZ13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACH8wB,IAAKA,EACLk0D,WAAYA,MAKD,GAChB18I,GAGX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjBlY,EAAM5qC,EAAO//C,MAAM2qF,IACnBuY,EAAUnjD,EAAOmjD,QACjB27C,EAAa9+F,EAAO//C,MAAM6+I,WAC9B,IAAKh8C,GAAmB,OAARlY,GAA+B,OAAfk0D,IAAwB37C,EACpD,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAavC,OAZAytF,EAASjsC,KAAKi/B,GAAS6F,cAAc9oD,EAAKk0D,GAAY93G,SACtD87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,mBACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,IClLFg/I,GAAS,CAElBvlJ,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjBK,EAAUnjD,EAAOmjD,QACrB,IAAKL,IAAYK,EACb,OAAO,EAEXA,EAAQvyB,OAAM,GAEd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAcvC,OAbAytF,EAASjsC,KAAKi/B,GAAS9vC,SAAS/2D,SAChC87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UAERqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,UACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,ICvBFi/I,GAAgB,CAEzBzhD,UAAUz9C,GACN,IAAI8iD,EAAU9iD,EAAO8iD,QACjB25C,EAASz8F,EAAOoN,OACpB,IAAK01C,IAAY25C,EACb,OAAO,EAGX,IAAIp6D,EAAUhoF,OAAO28E,WAAa,IAC9B+S,EAAS0yD,EAAO/gC,YAChBi/B,EAAqB8B,EAAOp+B,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ+1B,EAAU,IAAM,IAAKA,EAAU,IAAM,IAAK,GACxG88D,EAAW/zG,SAAS,GAAKinD,EAAIhmC,OAAQ+yF,EAAWh0G,SAAS,GAAKinD,EAAI/lC,QAClEH,EAAIj0D,KAAK+O,IAAIk4I,EAAUr8C,EAAQ11C,OAAOf,OACtCD,EAAIl0D,KAAK+O,IAAIm4I,EAAUt8C,EAAQ11C,OAAOd,QAEtCsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACArgB,EAAI22C,EAAQ11C,OAAOf,QACnBuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAER,IAAIwyE,EAAuBF,EAAWr8C,EAAQ11C,OAAOf,MAEjDq9E,EAAM/wI,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS08H,GAERrnD,IACDjgF,EAAOiqD,MAAQ,KAGnB,IAAIizF,EAAqB,GAkUzB,OAFAj/H,uBA7TIqpH,EAAI16D,UAAYgE,GAAK,kCAAoC,aAEzD,IAAI6nE,EAAWL,KACf,IAAKK,EACD,OAEJ,IAEIv6C,EAAIi/C,EAAIC,EAAIC,EACZp3C,EAAID,EAAIs3C,EAAIC,EAHZ9R,EAAUgN,EAAShN,QAAQ+M,YAItB5zG,IACL,IACI6zG,EAASjsC,KAAKi/B,GAASiG,YACnB,CAACxzC,EAAG1nF,EAAG0nF,EAAGznF,EAAG0mI,EAAG3mI,EAAG2mI,EAAG1mI,EAAG2mI,EAAG5mI,EAAG4mI,EAAG3mI,EAAG4mI,EAAG7mI,EAAG6mI,EAAG5mI,GAAGgiB,KAAG,CAAE3X,EAAM5sB,IACpDA,EAAI,GAAM,EACH4sB,EAAOi8H,EAAWhzF,EAElBjpC,EAAOk8H,EAAWhzF,IAGjC,CAACi8C,EAAGzvF,EAAGyvF,EAAGxvF,EAAGuvF,EAAGxvF,EAAGwvF,EAAGvvF,EAAG6mI,EAAG9mI,EAAG8mI,EAAG7mI,EAAG8mI,EAAG/mI,EAAG+mI,EAAG9mI,GAAGgiB,KAAG,CAAE3X,EAAM5sB,IACpDA,EAAI,GAAM,EACH4sB,EAAOi8H,EAAWhzF,EAElBjpC,EAAOk8H,EAAWhzF,KAGnCplB,SACF6qD,EAAgB/E,SAClB,MAAM7zF,GACHywI,EAAYjvC,cAAcxhG,aAI1B2mJ,EAAIhnI,EAAGC,EAAGouB,GACf,IACIttB,EAAMhhB,SAASC,cAAc,OAChC+gB,EAAYf,EAAIA,EAChBe,EAAYd,EAAIA,EACjBytD,GAAGgJ,IAAI31D,EAAK,CACR0yC,MAAOwzF,OACPvzF,OAAQuzF,OACR1lE,gBAAiB,OACjBjG,UAAW,uBACXyC,aAAckpE,OACd/zH,SAAU,WACVysD,OAAQ,OACRljE,KAAQsE,EAAYf,EAAIinI,EAAe,KACvC/xF,IAAOn0C,EAAYd,EAAIgnI,EAAe,KACtCtkE,WAAY,OACZijD,YAAa,SAGjB,IAAIjiD,EAAkB,IAAIjW,GAAGsW,gBAAgB,CACzCj0E,OAAQgR,EACR86C,YAAa,EACbL,UAAW,SAAS70C,GAChBA,EAAMk3C,sBACe,SAAjBl3C,EAAMg3C,QAAoC,gBAAfh3C,EAAMzmB,OAChC6gB,EAAYf,GAAK2G,EAAMm4C,GACvB/9C,EAAYd,GAAK0G,EAAMo4C,GACxBh+C,EAAIxJ,MAAMkF,KAASsE,EAAYf,EAAIinI,EAAe,KAClDlmI,EAAIxJ,MAAM29C,IAAQn0C,EAAYd,EAAIgnI,EAAe,KAC7C54G,GACAA,IAEJD,QAWZ,OAPCrtB,EAAY4hG,KAAO,SAAUtnD,GACzBt6C,EAAYf,EAAIq7C,EAAEr7C,EAClBe,EAAYd,EAAIo7C,EAAEp7C,EACnBc,EAAIxJ,MAAMkF,KAASsE,EAAYf,EAAIinI,EAAe,KAClDlmI,EAAIxJ,MAAM29C,IAAQn0C,EAAYd,EAAIgnI,EAAe,MAErDP,EAAmB3+I,KAAK47E,GACjB5iE,WAGFmmI,IACLz3C,EAAGkT,KAAKjb,GACR8H,EAAGmT,KAAKgkC,GACRG,EAAGnkC,KAAKikC,GACRG,EAAGpkC,KAAKkkC,GA7EZ5E,EAASjsC,KAAKi/B,GAAS7mG,SAgFvBs5D,EAAKs/C,EAAI,EAAG,EAAGE,GACfP,EAAKK,EAAIT,EAAU,EAAGW,GACtBN,EAAKI,EAAIT,EAAUC,EAAUU,GAC7BL,EAAKG,EAAI,EAAGR,EAAUU,GACtBz3C,EAAKu3C,EAAI,EAAG,GACZx3C,EAAKw3C,EAAIT,EAAU,GACnBO,EAAKE,EAAIT,EAAUC,GACnBO,EAAKC,EAAI,EAAGR,GAEZ,IAAI56C,GAAS,EACTu7C,EAAepnJ,SAASC,cAAc,OAC1C0tE,GAAGwJ,iBAAiBiwE,EAAc,iBAAiB,WAC/C,OAAO,KAEXA,EAAa/mJ,YAAcg6E,GAAK,6BAChC+sE,EAAa5vI,MAAMk8C,MAAQ,QAC3B0zF,EAAa5vI,MAAMm8C,OAAS,OAC5ByzF,EAAa5vI,MAAMilE,WAAaiN,EAAU,IAAM,QAChD09D,EAAa5vI,MAAMqhH,WAAa,OAChCuuB,EAAa5vI,MAAM0xE,UAAY,SAC/Bk+D,EAAa5vI,MAAM2pE,SAAW,OAC9BimE,EAAa5vI,MAAMiuI,cAAgB,MACnC2B,EAAa5vI,MAAMkuI,oBAAsB,OACzC0B,EAAa5vI,MAAMooE,OAAS,UAC5BwnE,EAAa5vI,MAAMgqE,gBAAkB,qBACrC4lE,EAAa5vI,MAAM4pE,eAAiB,KAEpC,IAAIimE,EAAcrnJ,SAASC,cAAc,OACzC0tE,GAAGwJ,iBAAiBkwE,EAAa,iBAAiB,WAC9C,OAAO,KAEXA,EAAYhnJ,YAAcg6E,GAAK,4BAC/BgtE,EAAY7vI,MAAMk8C,MAAQ,QAC1B2zF,EAAY7vI,MAAMm8C,OAAS,OAC3B0zF,EAAY7vI,MAAMqhH,WAAa,OAC/BwuB,EAAY7vI,MAAM0xE,UAAY,SAC9Bm+D,EAAY7vI,MAAM2pE,SAAW,OAC7BkmE,EAAY7vI,MAAMiuI,cAAgB,MAClC4B,EAAY7vI,MAAMouI,qBAAuB,OACzCyB,EAAY7vI,MAAM+jE,UAAY,qCAC9B8rE,EAAY7vI,MAAM8jE,WAAa,OAAS9B,EAAA2rE,IAAe,wBACvDkC,EAAY7vI,MAAM4pE,eAAiB,KACnCimE,EAAY7vI,MAAMgqE,gBAAkB,UAGpC7T,GAAGwJ,iBAAiBiwE,EAAc,iBAAiB,YAChC,IAAXv7C,IACAu7C,EAAa5vI,MAAMgqE,gBAAkB,WAE7C7T,GAAGwJ,iBAAiBiwE,EAAc,gBAAgB,YAC/B,IAAXv7C,IACAu7C,EAAa5vI,MAAMgqE,gBAAkB,yBAE7C7T,GAAGwJ,iBAAiBkwE,EAAa,iBAAiB,YAC/B,IAAXx7C,IACAw7C,EAAY7vI,MAAMgqE,gBAAkB,WAE5C7T,GAAGwJ,iBAAiBkwE,EAAa,gBAAgB,YAC9B,IAAXx7C,IACAw7C,EAAY7vI,MAAMgqE,gBAAkB,yBAG5C4lE,EAAajrE,QAAU,WAEnBirE,EAAa5vI,MAAM8jE,WAAa,OAAS9B,EAAA2rE,IAAe,wBACxDiC,EAAa5vI,MAAM4pE,eAAiB,KACpCgmE,EAAa5vI,MAAMgqE,gBAAkB,UACrC4lE,EAAa5vI,MAAM+jE,UAAY,qCAC/B6rE,EAAa5vI,MAAMooE,OAAS,UAE5BynE,EAAY7vI,MAAM8jE,WAAa,GAC/B+rE,EAAY7vI,MAAMgqE,gBAAkB,qBACpC6lE,EAAY7vI,MAAM+jE,UAAY,GAC9B8rE,EAAY7vI,MAAMooE,OAAS,UAE3B8vB,EAAGl4F,MAAMC,QAAU,OACnBg4F,EAAGj4F,MAAMC,QAAU,OACnBsvI,EAAGvvI,MAAMC,QAAU,OACnBuvI,EAAGxvI,MAAMC,QAAU,OAEnBkwF,EAAGnwF,MAAMC,QAAU,QACnBmvI,EAAGpvI,MAAMC,QAAU,QACnBovI,EAAGrvI,MAAMC,QAAU,QACnBqvI,EAAGtvI,MAAMC,QAAU,QACnBkwF,EAAGib,KAAKlT,GACRk3C,EAAGhkC,KAAKnT,GACRo3C,EAAGjkC,KAAKmkC,GACRD,EAAGlkC,KAAKokC,GACRn7C,GAAS,EACTx9D,KAEJg5G,EAAYlrE,QAAU,WAClB0vB,GAAS,EAETw7C,EAAY7vI,MAAM8jE,WAAa,OAAS9B,EAAA2rE,IAAe,wBACvDkC,EAAY7vI,MAAM4pE,eAAiB,KACnCimE,EAAY7vI,MAAMgqE,gBAAkB,UACpC6lE,EAAY7vI,MAAM+jE,UAAY,qCAC9B8rE,EAAY7vI,MAAMooE,OAAS,UAE3BwnE,EAAa5vI,MAAM8jE,WAAa,GAChC8rE,EAAa5vI,MAAMgqE,gBAAkB,qBACrC4lE,EAAa5vI,MAAM+jE,UAAY,GAC/B6rE,EAAa5vI,MAAMooE,OAAS,UAE5B+nB,EAAGnwF,MAAMC,QAAU,OACnBmvI,EAAGpvI,MAAMC,QAAU,OACnBovI,EAAGrvI,MAAMC,QAAU,OACnBqvI,EAAGtvI,MAAMC,QAAU,OAEnBi4F,EAAGl4F,MAAMC,QAAU,QACnBg4F,EAAGj4F,MAAMC,QAAU,QACnBsvI,EAAGvvI,MAAMC,QAAU,QACnBuvI,EAAGxvI,MAAMC,QAAU,QACnBi4F,EAAGkT,KAAKjb,GACR8H,EAAGmT,KAAKgkC,GACRG,EAAGnkC,KAAKikC,GACRG,EAAGpkC,KAAKkkC,IAGZ,IAAIjB,EAAgB7lJ,SAASC,cAAc,OAC3C4lJ,EAAcrlJ,YAAY4mJ,GAC1BvB,EAAcrlJ,YAAY6mJ,GAC1BtW,EAAIvwI,YAAYqlJ,GAGhB,IAAIh7D,EAAiB7qF,SAASC,cAAc,OAC5C4qF,EAAe5H,cAAgB,WAC3B,OAAO,GAEXtV,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAOg2B,EAAU,QAAU,QAC3BjN,WAAY,QACZ9oB,OAAQ+1B,EAAU,QAAU,QAC5BlI,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIlhC,EAAI,EAAGA,EAAIu5B,EAAOxzF,OAAQi6D,IAAK,CACpC,IAAIpD,EAASoD,IAAMmqF,EAAqBE,EAAW9wD,EAAOv5B,GAAGsyC,QAAQ11C,OACrEskC,EAAgB/wF,KAAK,CACjBs4E,MAAO7rB,EACPgtB,QAAS2P,EAAOv5B,GAAG4pB,QACnB4P,WAAYD,EAAOv5B,GAAGw5B,aAIlC,IAAI6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+zG,GACrB7yF,OAAQlhB,SAAS,GAAKg0G,GACtBr1D,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+zG,GAAY,KACjC7yF,OAAQlhB,SAAS,GAAKg0G,GAAY,QAG1CpE,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAE3BA,EAAoB7hJ,YAAYkvG,GAChC2yC,EAAoB7hJ,YAAYivG,GAChC4yC,EAAoB7hJ,YAAYumJ,GAChC1E,EAAoB7hJ,YAAYwmJ,GAEhCr/C,EAAGnwF,MAAMC,QAAU,OACnBmvI,EAAGpvI,MAAMC,QAAU,OACnBovI,EAAGrvI,MAAMC,QAAU,OACnBqvI,EAAGtvI,MAAMC,QAAU,OACnB4qI,EAAoB7hJ,YAAYmnG,GAChC06C,EAAoB7hJ,YAAYomJ,GAChCvE,EAAoB7hJ,YAAYqmJ,GAChCxE,EAAoB7hJ,YAAYsmJ,GAGhC/V,EAAIvwI,YAAYqqF,GAChBx8C,IACA5kC,EAAO03D,QAAO,KACV,IAAK,IAAIxjE,EAAI,EAAGA,EAAIgpJ,EAAmB/oJ,OAAQD,IAC3CgpJ,EAAmBhpJ,GAAGwjE,UAE1B+zE,EAAQ/zE,WAEZ13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACH0qC,OAAQ,CACJlE,EAAG1nF,EAAIymI,EACP/+C,EAAGznF,EAAIwmI,EAEPE,EAAG3mI,EAAIymI,EACPE,EAAG1mI,EAAIwmI,EAEPG,EAAG5mI,EAAIymI,EACPG,EAAG3mI,EAAIwmI,EAEPI,EAAG7mI,EAAIymI,EACPI,EAAG5mI,EAAIwmI,GAEXhF,MAAO,CACHhyC,EAAGzvF,EAAIymI,EACPh3C,EAAGxvF,EAAIwmI,EAEPj3C,EAAGxvF,EAAIymI,EACPj3C,EAAGvvF,EAAIwmI,EAEPK,EAAG9mI,EAAIymI,EACPK,EAAG7mI,EAAIwmI,EAEPM,EAAG/mI,EAAIymI,EACPM,EAAG9mI,EAAIwmI,OAMA,GAEhBj9I,GAGX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjBK,EAAUnjD,EAAOmjD,QACjBqB,EAASxkD,EAAO//C,MAAMukG,OACtB61C,EAAQr6F,EAAO//C,MAAMo6I,MACzB,KAAKv3C,GAAY0B,GAAW61C,GAAUl3C,GAClC,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAC/B01C,EAAQ11C,OAAOf,MACfy2C,EAAQ11C,OAAOd,OAavB,OAZAuuF,EAASjsC,KAAKi/B,GAASiG,YAAYtvC,EAAQ61C,GAAOrzG,SAClD87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,iBACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,WC9YfggJ,GAAiBzoJ,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SCQ/G,MAAMwoJ,GAAS,CAElBziD,UAAUz9C,GAEN,IAAIoN,EAASpN,EAAOoN,OACpB,IAAKA,EACD,OAAO,EAEX,IAAIsvF,EAAMp2E,GAAGod,QAASt2B,EAAOiuD,WAAYjuD,EAAOkuD,YAAa,IAAK,IAAI,GAClEnvD,EAAI/gB,SAAS,GAAKsxG,EAAIrwF,OAAQD,EAAIhhB,SAAS,GAAKsxG,EAAIpwF,QAEpD4uF,EAAgB/uF,EAAIiB,EAAOiuD,WAC3Bu/B,EAAaxtF,EAAO4wD,kBAAkB,GAGtCrkG,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAET40D,EAAWnhB,EAAOiuD,WAAY7sC,EAAYphB,EAAOkuD,YAErD3hG,EAAIq1D,UAAYgE,GAAK,6BAA+B,aAGpD,IAAI+iC,EAAW/1D,EAAO+1D,SAAUC,EAAYh2D,EAAOg2D,UAE/C+lB,EAAez1D,GAAG1+D,GAAG,CACrB0nE,IAAK,CACDjjB,MAAO,QACPC,OAAQ,OACR0nB,WAAY,UAGhBgoD,EAAgB11D,GAAG1+D,GAAG,CACtB0nE,IAAK,CACDjjB,MAAO,QACPC,OAAQ,OACR0nB,WAAY,UAGhBioD,EAAa31D,GAAG1+D,GAAG,CACnBwhE,QAAS,QACTkG,IAAK,CACDwK,SAAU,QACVztB,MAAO,QAEXoL,OAAQ,CACJ3+D,KAAM,SACNmO,IAAK,IACLF,IAAK,GAAKgvG,EACV/+G,MAAO,GAAKo2D,EAAOiuD,cAGvB8gB,EAAc71D,GAAG1+D,GAAG,CACpBwhE,QAAS,QACTkG,IAAK,CACDwK,SAAU,QACVztB,MAAO,QAEXoL,OAAQ,CACJ3+D,KAAM,SACNmO,IAAK,IACLF,IAAK,GAAKivG,EACVh/G,MAAO,GAAKo2D,EAAOkuD,eAG3B2gB,EAAWnnD,QAAU,WAChBv6E,KAAaqrE,QACd6oB,GAAe,EACfznD,KAEJm1F,EAAYrnD,QAAU,WACjBv6E,KAAaqrE,QACd8oB,GAAgB,EAChB1nD,KAEJi1F,EAAWvkD,SAAW,WAClB+W,GAAe,EACfznD,KAEJm1F,EAAYzkD,SAAW,WACnBgX,GAAgB,EAChB1nD,KAEJ+0F,EAAaj7E,OAAOkyB,GAAK,SAAW,KAAMipD,GAC1CD,EAAcl7E,OAAOkyB,GAAK,UAAY,KAAMmpD,GAC5C,IAAIgkB,EAAe75E,GAAG1+D,GAAG,CACrB0nE,IAAK,CACD2E,WAAY,OAAS9B,EAAA8tE,IAAe,wBACpClmE,eAAgB,eAGxBomE,EAAar/F,OAAOi7E,EAAcC,GAClCriH,EAAIxgB,YAAYgnJ,GAGhB,IAAIzxD,GAAgB,EAAOD,GAAe,EACtCH,EAAQlhC,EAAOiuD,WAAajuD,EAAOkuD,YAcvC,IAAIntB,GAAgB,EAChBiyD,EAAoB,IAAI9oE,GAAS,CACjC15C,MAAM,EACNyf,MAAO21B,GAAK,yBACZ6E,UAAU,EACV5wC,SAAU,SAAS1uB,GACf41E,EAAgB51E,EAjBhB41E,GACA8tC,EAAWjlI,MAAQ,GAAKo2D,EAAOiuD,WAC/B8gB,EAAYnlI,MAAQ,GAAKo2D,EAAOkuD,YAChC6kC,EAAahwI,MAAM8jE,WAAa,OAAS9B,EAAA8tE,IAAe,wBACxDE,EAAahwI,MAAM4pE,eAAiB,YACpC/yC,KAEAm5G,EAAahwI,MAAM8jE,WAAa,MAcxCt6D,EAAIxgB,YAAYmtE,GAAG1+D,GAAG,CAClB0nE,IAAK,CACD/uD,MAAO,WAKf,IAAI8/H,EAAkB,IAAIpoE,GAAO,CAC7BU,aAAa,EACbN,UAAW,CACP,CAAC,SAAUrF,GAAK,qBAChB,CAAC,YAAaA,GAAK,yBAEvB/J,MAAO+J,GAAK,qBACZ6F,UAAW,SACXpJ,SAAU,WACNzoC,OAIJs5G,EAAmBh6E,GAAG1+D,GAAG,CACzBga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,mBAGxB6sE,EAAiBnnJ,YAAYinJ,EAAkB3oE,cAC/C6oE,EAAiBnnJ,YAAYknJ,EAAgB5oE,cAE7C,IAAI6mD,EAAgBh4D,GAAGlZ,OAAOjB,EAAGC,GACjCkyE,EAAcnuH,MAAMyzE,eAAiB,YAGrC,IAAI26C,EAAaD,EAAcjxE,WAAW,eA6BjCrmB,IACL,GAAiC,IAA5Bi1F,EAAWjlI,MAAMT,QAAgBk4F,GAA+C,IAA7B0tC,EAAYnlI,MAAMT,QAAgBm4F,EAGtF,OAFAA,GAAgB,OAChBD,GAAe,GAKnB,GAFAwtC,EAAWjlI,MAAQ,GAAKkB,KAAK6O,IAAI,EAAGqkC,SAAS6wF,EAAWjlI,QACxDmlI,EAAYnlI,MAAQ,GAAKkB,KAAK6O,IAAI,EAAGqkC,SAAS+wF,EAAYnlI,QACtDm3F,IACIO,IACAutC,EAAWjlI,MAAQ,GAAKo0C,SAAS,GAAMA,SAAS+wF,EAAYnlI,OAASs3F,IAErEG,IACA0tC,EAAYnlI,MAAQ,GAAKo0C,SAAS,GAAMA,SAAS6wF,EAAWjlI,OAASs3F,IAGrEljD,SAAS6wF,EAAWjlI,OAAS++G,GAAY3qE,SAAS+wF,EAAYnlI,OAASg/G,GAAW,CAClF,IAAI3jB,EAAM/rB,GAAGod,QAAQt4C,SAAS6wF,EAAWjlI,OAAQo0C,SAAS+wF,EAAYnlI,OAAQ++G,EAAUC,EAAW,GACnGimB,EAAWjlI,MAAQ,GAAKo0C,SAAS,GAAKinD,EAAIhmC,OAC1C8vE,EAAYnlI,MAAQ,GAAKo0C,SAAS,GAAKinD,EAAI/lC,QAI/ClhB,SAAS6wF,EAAWjlI,OAAS++G,IAC7BkmB,EAAWjlI,MAAQ,GAAK++G,GAExB3qE,SAAS+wF,EAAYnlI,OAASg/G,IAC9BmmB,EAAYnlI,MAAQ,GAAKg/G,GAG7BtnB,GAAgB,EAChBD,GAAe,EAEflgB,EAAWnjC,SAAS6wF,EAAWjlI,OAC/Bw3E,EAAYpjC,SAAS+wF,EAAYnlI,OAEjC,IAAIimI,EAAU32D,GAAGod,QAAQnV,EAAUC,EAAW,IAAK,IAAK,GACpD+xE,EAAWn1G,SAAS,GAAK6xF,EAAQ5wE,OAAQm0F,EAAWp1G,SAAS,GAAK6xF,EAAQ3wE,QAC9E4uF,EAAgBqF,EAAWhyE,EAE3B,IAAIp2C,EAASmuC,GAAGg2E,aAAa,IAAK,IAAKiE,EAAUC,GAjEd,WAA/BH,EAAgB9oE,YAChB+mD,EAAcnuH,MAAMyzE,eAAiBs3D,EAAgB,EAAI,YAAc,GAEvE5c,EAAcjyE,MAAQe,EAAOiuD,WAC7BijB,EAAchyE,OAASc,EAAOkuD,YAE9BijB,EAAW/xD,OACX+xD,EAAW7xD,sBAAwB,OACnC6xD,EAAWxyD,UAAU6uE,EAAY,EAAG,GACpCt0E,GAAGy1C,aAAauiB,EAAe/vD,EAAUC,GACzC+vD,EAAW1xD,YAGXyxD,EAAcnuH,MAAMyzE,eAAiB,YAErC06C,EAAcjyE,MAAQkiB,EACtB+vD,EAAchyE,OAASkiB,EACvB+vD,EAAW/xD,OACX+xD,EAAW9xD,uBAAwB,EACnC8xD,EAAWxyD,UAAU6uE,EAAY,EAAG,EAAGtc,EAAcjyE,MAAOiyE,EAAchyE,QAC1EiyE,EAAW1xD,WAiDfyxD,EAAcnuH,MAAMk8C,MAAQn0D,KAAK6O,IAAI,EAAGw5I,GAAY,KACpDjiB,EAAcnuH,MAAMm8C,OAASp0D,KAAK6O,IAAI,EAAGy5I,GAAY,KACrDC,EAActwI,MAAMkF,KAAO8iB,EAAOvf,EAAI,KACtC6nI,EAActwI,MAAM29C,IAAM31B,EAAOtf,EAAI,KACrC4nI,EAActwI,MAAMk8C,MAAQn0D,KAAK6O,IAAI,EAAGw5I,GAAY,KACpDE,EAActwI,MAAMm8C,OAASp0D,KAAK6O,IAAI,EAAGy5I,GAAY,KAGzD,IAAIh9D,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACRl8C,QAAS,QACT+pE,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXpoD,SAAU,WACVyvD,WAAY,OACZ7C,YAAa,eAIjB,IAAI+nE,EAAgBn6E,GAAGm0D,cAAcj3C,EAAgB,IA0BrD,OAzBAi9D,EAActnJ,YAAYmlI,GAC1BmiB,EAActwI,MAAMk8C,MAAQF,EAAI,KAChCs0F,EAActwI,MAAMm8C,OAASF,EAAI,KACjCq0F,EAActwI,MAAM2b,SAAW,WAC/B20H,EAActwI,MAAMijE,SAAW,SAC/BqtE,EAActwI,MAAM+jE,UAAY,0BAChCusE,EAActwI,MAAMijE,SAAW,SAC/B9M,GAAGkb,qBAAqB,GAAG,SAAU1qF,GACjC0sF,EAAerzE,MAAM8jE,WAAa,OAASn9E,EAAM,OAGrD6iB,EAAIxgB,YAAYqqF,GAChBx8C,IAEA5kC,EAAO03D,QAAO,KACVsmF,EAAkBtmF,WAEtB13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACHzN,MAAOkiB,EACPjiB,OAAQkiB,EACRqtC,UAAWwkC,EAAgB9oE,aAG5Bn1E,GAGX1I,MAAMsmD,GACF,IAAIoN,EAASpN,EAAOoN,OAChB+1C,EAAUnjD,EAAOmjD,QACjB92C,EAAQrM,EAAO//C,MAAMosD,MACrBC,EAAStM,EAAO//C,MAAMqsD,OACtBuvD,EAAY77D,EAAO//C,MAAM47G,UAC7B,SAAKzuD,IAAW+1C,KAGhBA,EAAQvyB,OAAM,GACdxjB,EAAO8wC,OAAO7xC,EAAOC,EAAQuvD,GAC7B1Y,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,UACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,KC/SFygJ,GAAS,CAElBjjD,UAAUz9C,GACN,IAAIoN,EAASpN,EAAOoN,OACpB,IAAKA,EACD,OAAO,EAEX,IAAIsvF,EAAMp2E,GAAGod,QAAQt2B,EAAOiuD,WAAYjuD,EAAOkuD,YAAa,IAAK,IAAK,GAClEnvD,EAAI/gB,SAAS,GAAKsxG,EAAIrwF,OAAQD,EAAIhhB,SAAS,GAAKsxG,EAAIpwF,QAEpD4uF,EAAgB/uF,EAAIiB,EAAOiuD,WAC3Bu/B,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9BwuF,EAAWzqI,MAAMC,QAAU,QAC3BwqI,EAAWvtF,WAAW,MAAM0e,UAAU3e,EAAO4wD,kBAAkBk9B,GAAgB,EAAG,EAAG/uF,EAAGC,GAGxF,IAAIzyC,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAET24C,EAAM,EACV34C,EAAIq1D,UAAYgE,GAAK,6BAA+B,sBAI3ChsC,IAKL,GAJCy5G,EAActwI,MAAcwwI,gBAAkB,UAAYruF,EAAM,OAChEmuF,EAActwI,MAAcywI,aAAe,UAAYtuF,EAAM,OAC7DmuF,EAActwI,MAAc0wI,WAAa,UAAYvuF,EAAM,OAC3DmuF,EAActwI,MAAc2wI,YAAc,UAAYxuF,EAAM,OACjC,KAAxBp6D,KAAKghB,IAAIo5C,EAAM,KAAa,CAE5B,IAAI+/B,EAAM/rB,GAAGod,QAAQt3B,EAAGD,EAAG,IAAK,IAAK,GACjCrkB,EAAQsD,SAAS,GAAKinD,EAAI/lC,QAAUH,EACvCs0F,EAActwI,MAAcwwI,gBAAkB,UAAYruF,EAAM,cAAgBxqB,EAAQ,IACxF24G,EAActwI,MAAcywI,aAAe,UAAYtuF,EAAM,cAAgBxqB,EAAQ,IACrF24G,EAActwI,MAAc0wI,WAAa,UAAYvuF,EAAM,cAAgBxqB,EAAQ,IACnF24G,EAActwI,MAAc2wI,YAAc,UAAYxuF,EAAM,cAAgBxqB,EAAQ,KAI7F,IAAIi5G,EAAUpoJ,SAASC,cAAc,UACrCmoJ,EAAQ/xE,UAAY,8CACjB,IAACgyE,EAAWroJ,SAASC,cAAc,UACtCooJ,EAAShyE,UAAY,8CACrBgyE,EAAS7wI,MAAMmkE,YAAc,MAG7BysE,EAAQjsE,QAAU,WACdxiB,GAAO,GACPtrB,KAEJg6G,EAASlsE,QAAU,WACfxiB,GAAO,GACPtrB,KAGJrtB,EAAIxgB,YAAY6nJ,GAChBrnI,EAAIxgB,YAAY4nJ,GAEhB,IAAIv9D,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACRl8C,QAAS,QACT+pE,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZ7C,YAAa,eAGjB,IAAIwkD,EAAcvkI,SAASC,cAAc,OACzCskI,EAAY/sH,MAAMC,QAAU,aAC5B8sH,EAAY/sH,MAAMs+G,cAAgB,SAClC,IAAIgyB,EAAgBn6E,GAAGm0D,cAAcyC,EAAa,IAsBlD,OArBAujB,EAActnJ,YAAYyhJ,GAC1Bp3D,EAAerqF,YAAY+jI,GAC3BujB,EAActwI,MAAMk8C,MAAQF,EAAI,KAChCs0F,EAActwI,MAAMm8C,OAASF,EAAI,KACjCq0F,EAActwI,MAAMilE,WAAa,OACjCqrE,EAActwI,MAAMmkE,YAAc,OAClCmsE,EAActwI,MAAM+jE,UAAY,0BAChCusE,EAActwI,MAAMijE,SAAW,SAC/B9M,GAAGkb,qBAAqB,GAAG,SAAU1qF,GACjC2pJ,EAActwI,MAAM8jE,WAAa,OAASn9E,EAAM,OAEpD2pJ,EAActwI,MAAM6wE,WAAa,oBAEjCrnE,EAAIxgB,YAAYqqF,GAChBx8C,IAEA5kC,EAAOqlI,SAAW,WACd,MAAO,CACHn1E,IAAKA,IAGNlwD,GAGX1I,MAAMsmD,GACF,IAAIoN,EAASpN,EAAOoN,OAChB+1C,EAAUnjD,EAAOmjD,QACjB7wC,EAAMtS,EAAO//C,MAAMqyD,IACvB,SAAKlF,IAAW+1C,KAEhBA,EAAQvyB,OAAM,GACdxjB,EAAOwf,OAAOta,GACd6wC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,UACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,KCnHFghJ,GAAc,CAEvBxjD,UAAUz9C,GACN,IAAI8iD,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OACpB,IAAK01C,IAAY11C,EACb,OAAO,EAGX,IAAI28B,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ,IAAK,IAAK,GACxE6yF,EAAW/zG,SAAS,GAAKinD,EAAIhmC,OAAQ+yF,EAAWh0G,SAAS,GAAKinD,EAAI/lC,QAClEH,EAAIj0D,KAAK+O,IAAIk4I,EAAUr8C,EAAQ11C,OAAOf,OACtCD,EAAIl0D,KAAK+O,IAAIm4I,EAAUt8C,EAAQ11C,OAAOd,QAEtCsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACArgB,EAAI22C,EAAQ11C,OAAOf,QACnBuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAER,IAAIquE,EAAgB/uF,EAAI22C,EAAQ11C,OAAOf,MACnCgzF,EAAuBF,EAAWr8C,EAAQ11C,OAAOf,MAEjDq9E,EAAM/wI,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS08H,GAGT4V,EAAqB,GA+KzB,OAHAj/H,uBAzKI,IAAI2wC,EAAO,GAAIw9C,EAAW,IAC1Bk7B,EAAI16D,UAAYgE,GAAK,iCAAmC,aAExD,IAAI6nE,EAAWL,KACf,IAAKK,EACD,OAEJ,IAEIqG,EAAIC,EAFJtT,EAAUgN,EAAShN,QAAQ+M,YAGtB5zG,IACL,IACI6zG,EAASjsC,KAAKi/B,GAASoG,UACnBiN,EAAGtoI,EAAIymI,EAAuBnE,EAC9BgG,EAAGroI,EAAIwmI,EAAuBnE,EAC9BiG,EAAGvoI,EAAIymI,EAAuBnE,EAC9BiG,EAAGtoI,EAAIwmI,EAAuBnE,EAC9BlqF,EAAOkqF,EACP1sC,EAAW0sC,GACbl0G,SACF6qD,EAAgB/E,SAClB,MAAM7zF,GACHywI,EAAYjvC,cAAcxhG,aAI1B2mJ,EAAIhnI,EAAGC,GACZ,IACIc,EAAM2sD,GAAG1+D,GAAG,CACZ0nE,IAAK,CACDjjB,MAAOwzF,OACPvzF,OAAQuzF,OACR1lE,gBAAiB,OACjBjG,UAAW,uBACXyC,aAAckpE,OACd/zH,SAAU,WACVysD,OAAQ,OACRljE,KAAOuD,EAAIinI,EAAe,KAC1B/xF,IAAMj1C,EAAIgnI,EAAe,KACzBtkE,WAAY,OACZijD,YAAa,UAGpB7kH,EAAYf,EAAIA,EAChBe,EAAYd,EAAIA,EACjB,IAAI0jE,EAAkB,IAAIjW,GAAGsW,gBAAgB,CACzCj0E,OAAQgR,EACR86C,YAAa,EACbL,UAAW,SAAS70C,GAChBA,EAAMk3C,sBACe,SAAjBl3C,EAAMg3C,QAAoC,gBAAfh3C,EAAMzmB,OAChC6gB,EAAYf,GAAK2G,EAAMm4C,GACvB/9C,EAAYd,GAAK0G,EAAMo4C,GACxBh+C,EAAIxJ,MAAMkF,KAASsE,EAAYf,EAAIinI,EAAe,KAClDlmI,EAAIxJ,MAAM29C,IAAQn0C,EAAYd,EAAIgnI,EAAe,KACjD74G,QAKZ,OADAs4G,EAAmB3+I,KAAK47E,GACjB5iE,EApDXkhI,EAASjsC,KAAKi/B,GAAS7mG,SAuDvBk6G,EAAKtB,EAAIx0G,SAAS,GAAM+zG,EAAW,GAAK/zG,SAAS,GAAMg0G,EAAW,IAClE+B,EAAKvB,EAAIx0G,SAAS,IAAM+zG,EAAWA,EAAW,IAAK/zG,SAAS,IAAMg0G,EAAWA,EAAW,KAExF,IAAIgC,EAAa,IAAI3mE,GAAS,CAC1Bp9B,MAAO21B,GAAK,0BACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAW7nB,EACXkqB,WdtHU,GcuHVzL,SAAU,SAAUtvE,GAChB6wD,EAAO7wD,EACP6mC,OAGRo6G,EAAW3pE,aAAatnE,MAAMkkE,aAAe,OAC7Cq1D,EAAIvwI,YAAYioJ,EAAW3pE,cAC3B,IAAI4pE,EAAiB,IAAI5mE,GAAS,CAC9Bp9B,MAAO21B,GAAK,8BACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAW21B,EACXtzB,WdrIU,GcsIVzL,SAAU,SAAUtvE,GAChBquG,EAAWruG,EACX6mC,OAGR0iG,EAAIvwI,YAAYkoJ,EAAe5pE,cAG/B,IAAI+L,EAAiB7qF,SAASC,cAAc,OAC5C4qF,EAAe5H,cAAgB,WAC3B,OAAO,GAEXtV,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIlhC,EAAI,EAAGA,EAAIu5B,EAAOxzF,OAAQi6D,IAC/BkhC,EAAgB/wF,KAAK,CACjBs4E,MAAOzoB,IAAMmqF,EAAqBE,EAAW9wD,EAAOv5B,GAAGsyC,QAAQ11C,OAC/DgtB,QAAS2P,EAAOv5B,GAAG4pB,QACnB4P,WAAYD,EAAOv5B,GAAGw5B,aAIlC,IAAI6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+zG,GACrB7yF,OAAQlhB,SAAS,GAAKg0G,GACtBr1D,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+zG,GAAY,KACjC7yF,OAAQlhB,SAAS,GAAKg0G,GAAY,QAG1CpE,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAE3BA,EAAoB7hJ,YAAY+nJ,GAChClG,EAAoB7hJ,YAAYgoJ,GAGhCzX,EAAIvwI,YAAYqqF,GAChBx8C,IACA5kC,EAAO03D,QAAO,KACV,IAAK,IAAIxjE,EAAI,EAAGA,EAAIgpJ,EAAmB/oJ,OAAQD,IAC3CgpJ,EAAmBhpJ,GAAGwjE,UAE1BsnF,EAAWtnF,UACXunF,EAAevnF,UACf+zE,EAAQ/zE,WAEZ13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACHn3D,EAAG,CAACiW,EAAGsoI,EAAGtoI,EAAIymI,EAAsBxmI,EAAGqoI,EAAGroI,EAAIwmI,GAC9C9mI,EAAG,CAACK,EAAGuoI,EAAGvoI,EAAIymI,EAAsBxmI,EAAGsoI,EAAGtoI,EAAIwmI,GAC9CruF,KAAMA,EACNw9C,SAAUA,MAKC,GAGhBpsG,GAGX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjBK,EAAUnjD,EAAOmjD,QACjBxgG,EAAIq9C,EAAO//C,MAAM0C,EACjB4V,EAAIynC,EAAO//C,MAAMsY,EACjBy4C,EAAOhR,EAAO//C,MAAM+wD,KACpBw9C,EAAWxuD,EAAO//C,MAAMuuG,SAC5B,IAAK1L,IAAYK,EACb,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAavC,OAZAytF,EAASjsC,KAAKi/B,GAASoG,UAAUtxI,EAAEiW,EAAGjW,EAAEkW,EAAGN,EAAEK,EAAGL,EAAEM,EAAGm4C,EAAMw9C,GAAUxnE,SACrE87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,eACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,IC1OFqhJ,GAAY,CAErB7jD,UAAUz9C,GACN,IAAI1pD,EACAwsG,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OACpB,IAAK01C,IAAY11C,EACb,OAAO,EAGX,IAQIukC,EARAtP,EAAUhoF,OAAO28E,WAAa,IAC9B+S,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ+1B,EAAU,IAAM,IAAKA,EAAU,IAAM,IAAK,GACxG88D,EAAW/zG,SAAS,GAAKinD,EAAIhmC,OAAQ+yF,EAAWh0G,SAAS,GAAKinD,EAAI/lC,QAClEH,EAAIj0D,KAAK+O,IAAIk4I,EAAUr8C,EAAQ11C,OAAOf,OACtCD,EAAIl0D,KAAK+O,IAAIm4I,EAAUt8C,EAAQ11C,OAAOd,QAEtC+yF,EAAuBF,EAAWr8C,EAAQ11C,OAAOf,MAGjD64D,EAKA,CAAEtsG,EAAG,EAAGC,EAAG,EAAGwzC,MAAO,EAAGC,OAAQ,GACpC,CACI,IAAIi1F,EAAkB,CAClBj4G,GAAI,KACJE,GAAI,KACJwgC,GAAI,KACJzH,GAAI,MAEJqM,EAAQk0B,EAAQj0B,aAAa,EAAG,EAAGi0B,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAE5E,GAAIsiB,EAAMplE,KAAK,GAAK,GAAKolE,EAAMplE,KAAKolE,EAAMplE,KAAKjT,OAAS,GAAK,EACzDgrJ,EAAWj4G,GAAK,EAChBi4G,EAAW/3G,GAAK,EAChB+3G,EAAWv3E,GAAK84B,EAAQ11C,OAAOf,MAAQ,EACvCk1F,EAAWh/E,GAAKugC,EAAQ11C,OAAOd,OAAS,OAExC,IAAKh2D,EAAI,EAAGA,EAAIs4E,EAAMplE,KAAKjT,OAAQD,GAAK,EACpC,GAAIs4E,EAAMplE,KAAKlT,GAAK,EAAI,CACpB,IAAIsiB,GAAMtiB,EAAI,GAAK,EAAMwsG,EAAQ11C,OAAOf,MACpCxzC,EAAI3gB,KAAKyO,OAAOrQ,EAAI,GAAK,EAAIwsG,EAAQ11C,OAAOf,QAC5Ck1F,EAAWj4G,GAAK1wB,GAAuB,OAAlB2oI,EAAWj4G,MAChCi4G,EAAWj4G,GAAK1wB,GAEE,OAAlB2oI,EAAW/3G,KACX+3G,EAAW/3G,GAAK3wB,IAEhB0oI,EAAWv3E,GAAKpxD,GAAuB,OAAlB2oI,EAAWv3E,MAChCu3E,EAAWv3E,GAAKpxD,IAEhB2oI,EAAWh/E,GAAK1pD,GAAuB,OAAlB0oI,EAAWh/E,MAChCg/E,EAAWh/E,GAAK1pD,GAKhC,GAAsB,OAAlB0oI,EAAWj4G,IAAiC,OAAlBi4G,EAAW/3G,GAErC,OADAs9B,MAAMkM,GAAK,4BACJ,EAEXkyC,EAAUtsG,EAAI2oI,EAAWj4G,GACzB47E,EAAUrsG,EAAI0oI,EAAW/3G,GACzB07E,EAAU74D,MAAQk1F,EAAWv3E,GAAKu3E,EAAWj4G,GAAK,EAClD47E,EAAU54D,OAASi1F,EAAWh/E,GAAKg/E,EAAW/3G,GAAK,EAGvD,MAAMooD,EAAgB,CAClBh5E,EAAGssG,EAAUtsG,EAAIssG,EAAU74D,MAAQ,EACnCxzC,EAAGqsG,EAAUrsG,EAAIqsG,EAAU54D,OAAS,EACpCD,MAAO64D,EAAU74D,MACjBC,OAAQ44D,EAAU54D,OAClB6f,SAAU,GAKd,IAAIxyD,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAER0oE,IACDjgF,EAAOiqD,MAAQ,KAEnB1yC,EAAIq1D,UAAYgE,GAAK,gCAErB,IAAI3hB,EAAc,IAAIiV,GAAGmO,YAAY,CACjCrE,OAAQ,SAAS3hB,GACT6X,GAAGsJ,gBAAe,KAIP,SAAXnhB,IACA6Q,EAAOtoE,MAAQ,IAAMqnF,WAAW/e,EAAOtoE,OAAS,GAChDwqJ,KAEW,UAAX/yF,IACA6Q,EAAOtoE,MAAQ,IAAMqnF,WAAW/e,EAAOtoE,OAAS,GAChDwqJ,KAEW,OAAX/yF,IACA8Q,EAAOvoE,MAAQ,IAAMqnF,WAAW9e,EAAOvoE,OAAS,GAChDwqJ,KAEW,SAAX/yF,IACA8Q,EAAOvoE,MAAQ,IAAMqnF,WAAW9e,EAAOvoE,OAAS,GAChDwqJ,SAMRC,EAAc9oJ,SAASC,cAAc,OACrC8oJ,EAAe/oJ,SAASC,cAAc,OACtC+oJ,EAAahpJ,SAASC,cAAc,OACpC2mE,EAAS5mE,SAASC,cAAc,SAChC0mE,EAAS3mE,SAASC,cAAc,SAChCgpJ,EAASjpJ,SAASC,cAAc,SAoDpC,GAnDA6oJ,EAAYtxI,MAAMk8C,MAAQ,QAC1Bo1F,EAAYtxI,MAAMm8C,OAAS,OAC3Bo1F,EAAavxI,MAAMk8C,MAAQ,QAC3Bq1F,EAAavxI,MAAMm8C,OAAS,OAC5Bo1F,EAAavxI,MAAMC,QAAU,eAC7BqxI,EAAYtxI,MAAMC,QAAU,eAC5BuxI,EAAWxxI,MAAMC,QAAU,eAC3BuxI,EAAWxxI,MAAMk8C,MAAQ,QACzBs1F,EAAWxxI,MAAMm8C,OAAS,OAC1BiT,EAAOzmE,KAAO,SACdwmE,EAAOxmE,KAAO,SACd8oJ,EAAO9oJ,KAAO,SACdwmE,EAAOnvD,MAAMk8C,MAAQ,OACrBkT,EAAOpvD,MAAMk8C,MAAQ,OACrBu1F,EAAOzxI,MAAMk8C,MAAQ,OACrBkT,EAAOvoE,MAAQ,IACfsoE,EAAOtoE,MAAQ,IACf4qJ,EAAO5qJ,MAAQ,IACfuoE,EAAOuV,QAAU,WACZv6E,KAAaqrE,QACd47E,KAEJliF,EAAOwV,QAAU,WACZv6E,KAAaqrE,QACd47E,KAEJI,EAAO9sE,QAAU,WACZv6E,KAAaqrE,QACd47E,KAEJjiF,EAAOmY,SAAW,WACd8pE,KAEJliF,EAAOoY,SAAW,WACd8pE,KAEJI,EAAOlqE,SAAW,WACd8pE,KAEJjiF,EAAOq+D,QAAU,WACb4jB,KAEJliF,EAAOs+D,QAAU,WACb4jB,KAEJI,EAAOhkB,QAAU,WACb4jB,KAEJC,EAAY3gG,OAAO,MAAOwe,GAC1BoiF,EAAa5gG,OAAO,MAAOye,GAC3BoiF,EAAW7gG,OAAOkyB,GAAK,6BAA+B,KAAM4uE,IACvDv/D,EAAS,CACO/b,GAAG1+D,GAAG,CACnBga,OAAQjI,EACR21D,IAAK,CACD6F,UAAW,UAGVr0B,OAAO2gG,EAAaC,EAAcC,GAI/C,MAAME,EAAe,CACjBzsE,WAAY,OACZD,UAAW,QAET2sE,EAAYx7E,GAAG1+D,GAAI,CACrBga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACT8kE,SAAU,OACVE,WAAY,WAGH9O,GAAG1+D,GAAI,CACpBga,OAAQkgI,EACR14E,QAAS,SACT95D,QAAS0jE,GAAK,yBAA2B,KACzCxD,QAAO,KACH,MAAMplC,EAAIunD,EAAcrC,eACxBqC,EAAc1G,SAAS7gD,EAAEiiB,MAAOjiB,EAAEkiB,SAEtCgjB,IAAKuyE,IAEQv7E,GAAG1+D,GAAI,CACpBga,OAAQkgI,EACR14E,QAAS,SACT95D,QAAS0jE,GAAK,yBAA2B,KACzCxD,QAAO,KACH,MAAMplC,EAAIunD,EAAcrC,eACxBqC,EAAc1G,QAAQ7gD,EAAEiiB,OAAQjiB,EAAEkiB,SAEtCgjB,IAAKuyE,IAEev7E,GAAG1+D,GAAI,CAC3Bga,OAAQkgI,EACR14E,QAAS,SACT95D,QAAS,OACRkgE,QAAM,KACH,MAAMplC,EAAIunD,EAAcrC,eACxBllD,EAAE+hC,UAAY,GACd/hC,EAAE+hC,UAAY,IACdwlB,EAAchC,YAAYvlD,EAAE+hC,UAC5By1E,EAAO5qJ,MAAQ,GAAKkB,KAAK4jC,MAAMsO,EAAE+hC,UACjC2lB,KAEJxiB,IAAKuyE,IAEgBv7E,GAAG1+D,GAAI,CAC5Bga,OAAQkgI,EACR14E,QAAS,SACT95D,QAAS,OACTkgE,QAAO,KACH,MAAMplC,EAAIunD,EAAcrC,eACxBllD,EAAE+hC,UAAY,GACd/hC,EAAE+hC,UAAY,IACdwlB,EAAchC,YAAYvlD,EAAE+hC,UAC5By1E,EAAO5qJ,MAAQ,GAAKkB,KAAK4jC,MAAMsO,EAAE+hC,UACjC2lB,KAEJxiB,IAAKuyE,IAEcv7E,GAAG1+D,GAAI,CAC1Bga,OAAQkgI,EACR14E,QAAS,SACT95D,QAAS,KACTkgE,QAAO,KACH,MAAMplC,EAAIunD,EAAcrC,eACpB8wD,EAAkB7oE,WAClBoa,EAAc1G,QAAQ0G,EAAc/B,WAAaxlD,EAAEkiB,OAAS,EAAc,EAAXliB,EAAEkiB,QAEjEqlC,EAAc1G,QAAkB,EAAV7gD,EAAEiiB,MAAsB,EAAXjiB,EAAEkiB,SAG7CgjB,IAAKuyE,IAEYv7E,GAAG1+D,GAAI,CACxBga,OAAQkgI,EACR14E,QAAS,SACT95D,QAAS,OACTkgE,QAAO,KACH,MAAMplC,EAAIunD,EAAcrC,eACxBqC,EAAc1G,QAAQ/yF,KAAK4jC,MAAMsO,EAAEiiB,MAAQ,GAAIn0D,KAAK4jC,MAAMsO,EAAEkiB,OAAS,KAEzEgjB,IAAKuyE,IAESv7E,GAAG1+D,GAAI,CACrBga,OAAQkgI,EACR14E,QAAS,SACT95D,QAAS0jE,GAAK,UACdxD,QAAO,KACH,MAAMplC,EAAIunD,EAAcrC,eACxBqC,EAAclC,OAAO,CAAE72E,EAAGkqF,EAAQ11C,OAAOf,MAAQ,EAAGxzC,EAAGiqF,EAAQ11C,OAAOd,OAAS,IAC/EqlC,EAAchC,YAAYvlD,EAAE+hC,UAC5B2lB,KAEJxiB,IAAKuyE,IAOT,IAAI1zD,GAAgB,EAChBiyD,EAAoB,IAAI9oE,GAAS,CACjC15C,MAAM,EACNyf,MAAO21B,GAAK,8BACZ/J,MAAO+J,GAAK,yBACZ6E,UAAU,EACV5wC,SAAU,SAAS1uB,GACf41E,EAAgB51E,EAChBo5E,EAAcpC,eAAepB,IAEjC7e,IAAK,CACDl/D,QAAS,kBAGb2xI,GAAa,EACbC,EAAmB,IAAI1qE,GAAS,CAChC15C,MAAM,EACNyf,MAAO21B,GAAK,yBACZ/J,MAAO+J,GAAK,+BACZ6E,UAAU,EACV5wC,SAAU,SAAS1uB,GACfwpI,EAAaxpI,EACbo5E,EAAcnC,YAAYuyD,IAE9BzyE,IAAK,CACDl/D,QAAS,eACTglE,WAAY,UAGpB,MAAM6sE,EAAkB37E,GAAG1+D,GAAG,IAC9Bq6I,EAAgBnhG,OAAOs/F,EAAkB3oE,aAAcuqE,EAAiBvqE,cAExE99D,EAAIxgB,YAAYmtE,GAAG1+D,GAAG,CAClB0nE,IAAK,CACD/uD,MAAO,OACP+rC,OAAQ,WAIhB,MAAM41F,EAAY57E,GAAG1+D,GAAG,CACpBga,OAAQjI,EACR21D,IAAK,CACDl/D,QAAS,OACTqjE,eAAgB,mBAIxB,IAAI4sE,EAAkB,IAAIpoE,GAAO,CAC7BU,aAAa,EACbN,UAAW,CACP,CAAC,SAAUrF,GAAK,qBAChB,CAAC,YAAaA,GAAK,yBAEvB6F,UAAW,SACX5P,MAAO+J,GAAK,qBACZvD,SAAU,WACNqiB,GAAc,MAGtBowD,EAAUphG,OAAOmhG,EAAiB5B,EAAgB5oE,cAGlD,IAAI+L,EAAiB7qF,SAASC,cAAc,OAC5C4qF,EAAe5H,cAAgB,WAC3B,OAAO,GAEXtV,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAOg2B,EAAU,QAAU,QAC3BjN,WAAY,QACZ9oB,OAAQ+1B,EAAU,QAAU,QAC5BlI,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIlhC,EAAI,EAAGA,EAAIu5B,EAAOxzF,OAAQi6D,IAAK,CACpC,IAAIpD,EACJ,GAAIoD,IAAMmqF,EAAoB,CAC1BvtF,EAASkZ,GAAGlZ,OAAOhiB,SAAS,GAAK+gB,GAAI/gB,SAAS,GAAKghB,IACzCgB,EAAOC,WAAW,MACxB0e,UAAUge,EAAOv5B,GAAGsyC,QAAQ11C,OAAQ,EAAG,EAAGA,EAAOf,MAAOe,EAAOd,aAEnEc,EAAS28B,EAAOv5B,GAAGsyC,QAAQ11C,OAE/BskC,EAAgB/wF,KAAK,CACjBs4E,MAAO7rB,EACPgtB,QAAS2P,EAAOv5B,GAAG4pB,QACnB4P,WAAYD,EAAOv5B,GAAGw5B,aAIlC,IAiBIm4D,EAjBAtwD,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+zG,GACrB7yF,OAAQlhB,SAAS,GAAKg0G,GACtBr1D,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+zG,GAAY,KACjC7yF,OAAQlhB,SAAS,GAAKg0G,GAAY,iBAOjCttD,EAAc0tB,GAAmB,GACtC,IAAK7tB,EACD,OAEJ,IAAI2vD,EAAY3vD,EAAcrC,eAC9B,GAAIx1F,KAAK8zD,UAAU0zF,KAAea,IAA0B3iC,EACxD,OAEJ2iC,EAAwBroJ,KAAK8zD,UAAU0zF,GACnCjC,EAAuB,IACvBiC,EAAU1oI,GAAKymI,EACfiC,EAAUzoI,GAAKwmI,EACfiC,EAAUj1F,OAASgzF,EACnBiC,EAAUh1F,QAAU+yF,GAExB,IAAI+C,EAAuB1wD,EAAgBipD,GAAoB1hE,MAC3DrZ,EAAMwiF,EAAqB/0F,WAAW,MAC1CuS,EAAI4M,OACJ5M,EAAImtB,UAAU,EAAG,EAAGq1D,EAAqB/1F,MAAO+1F,EAAqB91F,QACrEga,GAAG2rB,+BACCryB,EACAmqB,EAAO4wD,GAAoB73C,QAAQ11C,OACnCk0F,EACAp8B,EAC+B,cAA/Bm7B,EAAgB9oE,YAChBjR,GAAG4rB,mBAAmBovD,EAAWA,EAAUj1F,MAAQulC,EAAcvlC,MAAOi1F,EAAUh1F,OAASslC,EAActlC,SAE7GsT,EAAIiN,UACJglB,EAAgB/E,kBA2BX00D,IACL7vD,EAAclC,OAAO,CACjB72E,EAAGwyB,SAASk0B,EAAOtoE,OAAS46F,EAAch5E,EAC1CC,EAAGuyB,SAASm0B,EAAOvoE,OAAS46F,EAAc/4E,IAE9C84E,EAAchC,YAAYvkD,SAASw2G,EAAO5qJ,QAC1C86F,IAuBJ,OAxFAkpD,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAkC3BrpD,EAAgB,IAAItE,GAAc,CAC9Bz0E,EAAGg5E,EAAch5E,EACjBC,EAAG+4E,EAAc/4E,EACjBwzC,MAAOulC,EAAcvlC,MACrBC,OAAQslC,EAActlC,OACtB6f,SAAUylB,EAAczlB,SACxBgiB,eAAe,EACfL,MAAO,CAAC,EAAGgV,EAAQ11C,OAAOf,OAC1B2hC,MAAO,CAAC,EAAG8U,EAAQ11C,OAAOd,QAC1BrlB,SAAU,SAAUmD,GAChBk1B,EAAOtoE,MAAQ,GAAKkB,KAAK4jC,MAAMsO,EAAExxB,EAAIg5E,EAAch5E,GACnD2mD,EAAOvoE,MAAQ,GAAKkB,KAAK4jC,MAAMsO,EAAEvxB,EAAI+4E,EAAc/4E,GACnD+oI,EAAO5qJ,MAAQ,GAAKkB,KAAK4jC,MAAMsO,EAAE+hC,UACjC2lB,KAEJhqD,MAAOu3G,IAEX/4E,GAAGgJ,IAAIqiB,EAAcla,aAAc,CAC/B3rD,SAAU,WACVzW,KAAM,IACNy4C,IAAK,MAETktF,EAAoB7hJ,YAAYw4F,EAAcla,cAW9Cqa,IAEAn4E,EAAIxgB,YAAYqqF,GAChBphF,EAAO03D,QAAO,KACVzI,EAAYyI,UACZ63B,EAAc73B,UACdsmF,EAAkBtmF,UAClBkoF,EAAiBloF,WAErB13D,EAAOqlI,SAAW,WACd,MAAM6Z,EAAY3vD,EAAcrC,eAChC,IAAIrvF,EAAQ,WACRqhJ,EACAxsF,OAAQowD,EACRm9B,YAA4C,cAA/BhC,EAAgB9oE,YACzBjR,GAAG4rB,mBAAmBovD,EAAWA,EAAUj1F,MAAQulC,EAAcvlC,MAAOi1F,EAAUh1F,OAASslC,EAActlC,SAGjH,OADAlqD,EAAO03D,UACAhgE,KAAKC,MAAMD,KAAK8zD,UAAU3tD,KAE9BmC,GAGX1I,MAAMsmD,GACF,MAAM8iD,EAAU9iD,EAAO8iD,QACjBK,EAAUnjD,EAAOmjD,QACvB,IAAKL,IAAYK,EACb,OAAO,EAEXA,EAAQvyB,OAAM,GAEd,MAAM3wE,EAA+B+/C,EAAO//C,MAE5C,IAAI+tG,EAAa1nC,GAAG0nC,WAAWlL,EAAQ11C,QAgBvC,OAfA01C,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dga,GAAG2rB,+BACC6Q,EACAkL,EACA/tG,EAAM+rE,UACN/rE,EAAM60D,OACN70D,EAAMoiJ,aAGVl/C,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,aACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,OAAC//C,OAEP,IC3gBFqiJ,GAAS,CAElB7kD,UAAUz9C,GACN,IAAIoN,EAASpN,EAAOoN,OAChB01C,EAAU9iD,EAAO8iD,QACrB,IAAK11C,IAAW01C,EACZ,OAAO,EAGX,IAAI/Y,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ,IAAK,IAAK,GACxE6yF,EAAW/zG,SAAS,GAAKinD,EAAIhmC,OAAQ+yF,EAAWh0G,SAAS,GAAKinD,EAAI/lC,QAClEH,EAAIj0D,KAAK+O,IAAIk4I,EAAUr8C,EAAQ11C,OAAOf,OACtCD,EAAIl0D,KAAK+O,IAAIm4I,EAAUt8C,EAAQ11C,OAAOd,QAEtCsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACArgB,EAAI22C,EAAQ11C,OAAOf,QACnBuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAER,IAAIquE,EAAgB/uF,EAAI22C,EAAQ11C,OAAOf,MAEnC1yC,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAmGb,OAFA0G,uBA5FI,IAAIirE,EAAS,GACb3xE,EAAIq1D,UAAYgE,GAAK,oCAAsC,aAE3D,IAAI6nE,EAAWL,KACf,IAAKK,EACD,OAEJ,IAAIhN,EAAUgN,EAAShN,QAAQ+M,GAC/BC,EAASjsC,KAAKi/B,GAAS7mG,SAEvB,IAAIu7G,EAAe,IAAI9nE,GAAS,CAC5Bp9B,MAAO21B,GAAK,UACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAWyS,EACXpQ,WhB5DU,GgB6DVzL,SAAU,SAAUtvE,GAChBmrF,EAASnrF,EACT06I,EAASjsC,KAAKi/B,GAAS+F,aAAatoD,EAAS4vD,GAAel0G,SAC5D6qD,EAAgB/E,YAGxBnzE,EAAIxgB,YAAYopJ,EAAa9qE,cAG7B,IAAI+L,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIp7F,EAAI,EAAGA,EAAIyzF,EAAOxzF,OAAQD,IAC/Bo7F,EAAgB/wF,KAAK,CACjBs4E,MAAO3iF,IAAMqkJ,EAAqBE,EAAW9wD,EAAOzzF,GAAGwsG,QAAQ11C,OAC/DgtB,QAAS2P,EAAOzzF,GAAG8jF,QACnB4P,WAAYD,EAAOzzF,GAAG0zF,aAIlC,IAAI6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+zG,GACrB7yF,OAAQlhB,SAAS,GAAKg0G,GACtBr1D,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+zG,GAAY,KACjC7yF,OAAQlhB,SAAS,GAAKg0G,GAAY,QAG1CpE,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAE3BrhI,EAAIxgB,YAAYqqF,GAEhB,IACIq3D,EAASjsC,KAAKi/B,GAAS+F,aAAatoD,EAAS4vD,GAAel0G,SAC5D6qD,EAAgB/E,SAClB,MAAM7zF,GACH0gB,EAAY8gF,cAAcxhG,GAG/BmJ,EAAO03D,QAAO,KACV+zE,EAAQ/zE,UACRyoF,EAAazoF,WAEjB13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACHwxB,OAAQA,MAKG,GAEhBlpF,GAGX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjBK,EAAUnjD,EAAOmjD,QACjB7X,EAAStrC,EAAO//C,MAAMqrF,OAC1B,IAAKwX,IAAYxX,IAAW6X,EACxB,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAavC,OAZAytF,EAASjsC,KAAKi/B,GAAS+F,aAAatoD,GAAQtkD,SAC5C87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,UACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,IC7JFuiJ,GAAgB,CAEzB/kD,UAAUz9C,GACN,IAAI8iD,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OACpB,IAAK01C,IAAY11C,EACb,OAAO,EAGX,IAAI28B,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ,IAAK,IAAK,GACxE6yF,EAAW/zG,SAAS,GAAKinD,EAAIhmC,OAAQ+yF,EAAWh0G,SAAS,GAAKinD,EAAI/lC,QAClEH,EAAIj0D,KAAK+O,IAAIk4I,EAAUr8C,EAAQ11C,OAAOf,OACtCD,EAAIl0D,KAAK+O,IAAIm4I,EAAUt8C,EAAQ11C,OAAOd,QAEtCsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACArgB,EAAI22C,EAAQ11C,OAAOf,QACnBuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAER,IAAIquE,EAAgB/uF,EAAI22C,EAAQ11C,OAAOf,MAEnC1yC,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAuHb,OAFA0G,uBAjHI,IAAIirE,EAAS,EAAG8tD,EAAW,IAC3Bz/H,EAAIq1D,UAAYgE,GAAK,mCAAqC,aAE1D,IAAI6nE,EAAWL,KACf,IAAKK,EACD,OAEJ,IAAIhN,EAAUgN,EAAShN,QAAQ+M,GAC/BC,EAASjsC,KAAKi/B,GAAS7mG,SAEvB,IAAIu7G,EAAe,IAAI9nE,GAAS,CAC5Bp9B,MAAO21B,GAAK,UACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,IACL8xE,UAAW,EACXqC,WjB3DU,GiB4DVzL,SAAU,SAAUtvE,GAChBmrF,EAASnrF,EACT06I,EAASjsC,KAAKi/B,GAASgG,YAAYvoD,EAAS4vD,EAAe9B,GAAUpyG,SACrE6qD,EAAgB/E,UAEpBjS,MAAO,CAAC,CAAC,EAAG,GAAI,CAAC,GAAK,GAAI,CAAC,GAAK,IAAK,CAAC,EAAG,QAEzC4nE,EAAiB,IAAIhoE,GAAS,CAC9Bp9B,MAAO21B,GAAK,gCACZ3mB,MAAO,IACPC,OAAQ,GACRrlD,IAAK,EACLF,IAAK,GACL8xE,UAAW,IACXqC,WjB1EU,GiB2EVzL,SAAU,SAAUtvE,GAChBi5I,EAAWj5I,EAAM,GACjB06I,EAASjsC,KAAKi/B,GAASgG,YAAYvoD,EAAS4vD,EAAe9B,GAAUpyG,SACrE6qD,EAAgB/E,UAEpBjS,MAAO,CAAC,CAAC,EAAG,GAAI,CAAC,GAAK,GAAI,CAAC,GAAK,IAAK,CAAC,EAAG,OAE7C0nE,EAAa9qE,aAAatnE,MAAMkkE,aAAe,OAC/C16D,EAAIxgB,YAAYopJ,EAAa9qE,cAC7B99D,EAAIxgB,YAAYspJ,EAAehrE,cAG/B,IAAI+L,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIp7F,EAAI,EAAGA,EAAIyzF,EAAOxzF,OAAQD,IAC/Bo7F,EAAgB/wF,KAAK,CACjBs4E,MAAO3iF,IAAMqkJ,EAAqBE,EAAW9wD,EAAOzzF,GAAGwsG,QAAQ11C,OAC/DgtB,QAAS2P,EAAOzzF,GAAG8jF,QACnB4P,WAAYD,EAAOzzF,GAAG0zF,aAIlC,IAAI6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+zG,GACrB7yF,OAAQlhB,SAAS,GAAKg0G,GACtBr1D,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+zG,GAAY,KACjC7yF,OAAQlhB,SAAS,GAAKg0G,GAAY,QAG1CpE,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAG3BrhI,EAAIxgB,YAAYqqF,GAEhB,IACIq3D,EAASjsC,KAAKi/B,GAASgG,YAAYvoD,EAAS4vD,EAAe9B,GAAUpyG,SACrE6qD,EAAgB/E,SAClB,MAAM7zF,GACH0gB,EAAY8gF,cAAcxhG,GAG/BmJ,EAAO03D,QAAO,KACVyoF,EAAazoF,UACb2oF,EAAe3oF,UACf+zE,EAAQ/zE,WAEZ13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACHwxB,OAAQA,EACR8tD,SAAUA,MAKC,GAEhBh3I,GAIX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjBK,EAAUnjD,EAAOmjD,QACjB7X,EAAStrC,EAAO//C,MAAMqrF,OACtB8tD,EAAWp5F,EAAO//C,MAAMm5I,SAC5B,IAAKt2C,GAAsB,OAAXxX,GAAgC,OAAb8tD,IAAsBj2C,EACrD,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAavC,OAZAytF,EAASjsC,KAAKi/B,GAASgG,YAAYvoD,EAAQ8tD,GAAUpyG,SACrD87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,iBACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,ICnLFyiJ,GAAU,CAEnBjlD,UAAUz9C,GACN,IAAI8iD,EAAU9iD,EAAO8iD,QACjB11C,EAASpN,EAAOoN,OACpB,IAAK01C,IAAY11C,EACb,OAAO,EAGX,IAAI28B,EAAS38B,EAAOsuD,YAChBi/B,EAAqBvtF,EAAOixD,cAAcvb,EAAQ11C,QAElDilC,EAAM/rB,GAAGod,QAAQof,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,OAAQ,IAAK,IAAK,GACxEH,EAAI/gB,SAAS,GAAKinD,EAAIhmC,OAAQD,EAAIhhB,SAAS,GAAKinD,EAAI/lC,QAEpDsuF,EAAat0E,GAAGlZ,OAAOjB,EAAGC,GAC9B,CACI,MAAMwT,EAAMg7E,EAAWvtF,WAAW,MAClCuS,EAAI4M,OACAouE,EAAWvuF,MAAQy2C,EAAQ11C,OAAOf,QAClCuT,EAAI6M,uBAAwB,GAEhC7M,EAAImM,UAAU+2B,EAAQ11C,OAAQ,EAAG,EAAGjB,EAAGC,GACvCwT,EAAIiN,UAGR,IAAIlzD,EAAMhhB,SAASC,cAAc,OAC7BwJ,EAAc,CACd4K,QAAS2M,GAoJb,OAFA0G,uBA7II1G,EAAIxgB,YAAYmtE,GAAG1+D,GAAG,CAClB0H,QAAS0jE,GAAK,+BACd1D,IAAK,CACD+E,aAAc,UAItB,IAAIwmE,EAAWL,KACf,IAAKK,EACD,OAEJ,IAAIhN,EAAUgN,EAAShN,QAAQ+M,YAGtB9oD,IACL+oD,EAASjsC,KAAKi/B,GAASzvC,QAAqB,uBAAbukD,EAAmCzG,GAAiBl1G,SACnF6qD,EAAgB/E,SAJpB+tD,EAASjsC,KAAKi/B,GAAS7mG,SAQvB,IAAI27G,EAAW,qBACXC,EAAgB,IAAI7gE,GAAQ,CAC5B1J,UAAW,CACP,CACI7hF,GAAI,qBACJ6mD,MAAO21B,GAAK,iCAEhB,CACIx8E,GAAI,YACJ6mD,MAAO21B,GAAK,yBAGpBkP,UAAWygE,EACXlzE,SAAU,SAASj5E,GACfmsJ,EAAWnsJ,EACXs7F,OAGRn4E,EAAIxgB,YAAYypJ,EAAcnrE,cAG9B,IAAIykE,EAAkB,CAACn1H,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GACxCo6H,EAAkB,CAClB,KACA,CAACh2G,EAAG,EAAGioC,EAAG,EAAGz2C,EAAG,EAAG5V,EAAG,GACtB,CAACokB,EAAG,IAAKioC,EAAG,IAAKz2C,EAAG,IAAK5V,EAAG,IAEhCo6H,EAAgBp8H,KAAK,CACjBomB,EAAGi5B,EAAOsnF,gBAAgBvgH,EAC1BioC,EAAGhP,EAAOsnF,gBAAgBt4E,EAC1Bz2C,EAAGynC,EAAOsnF,gBAAgB/uH,EAC1B5V,EAAG,IAEPo6H,EAAgBp8H,KAAK,CACjBomB,EAAGi5B,EAAOwnF,kBAAkBzgH,EAC5BioC,EAAGhP,EAAOwnF,kBAAkBx4E,EAC5Bz2C,EAAGynC,EAAOwnF,kBAAkBjvH,EAC5B5V,EAAG,IAGP,IAAIq6H,EAAe,IAAI77C,GAAa,CAChC9jC,MAAO21B,GAAK,2BACZqO,SAAU07C,EACVr7C,aAAc,EACdjS,SAAU,SAASpK,GACf62E,EAAkB72E,EAClBysB,OAGRkrC,EAAavlD,aAAatnE,MAAMglE,UAAY,OAC5Cx7D,EAAIxgB,YAAY6jI,EAAavlD,cAG7B,IAAI+L,EAAiB7qF,SAASC,cAAc,OAC5C0tE,GAAGgJ,IAAIkU,EAAgB,CACnBn3B,MAAO,QACP+oB,WAAY,QACZ9oB,OAAQ,QACR6tB,gBAAiB,UACjBhF,UAAW,OACXjB,UAAW,sEACXd,SAAU,SACVtnD,SAAU,WACVyvD,WAAY,OACZnrE,QAAS,OACTsjE,WAAY,SACZD,eAAgB,SAChBiF,YAAa,eAGjB,IAAIgZ,EAAmC,GAEnC,IAAK,IAAIp7F,EAAI,EAAGA,EAAIyzF,EAAOxzF,OAAQD,IAC/Bo7F,EAAgB/wF,KAAK,CACjBs4E,MAAO3iF,IAAMqkJ,EAAqBE,EAAW9wD,EAAOzzF,GAAGwsG,QAAQ11C,OAC/DgtB,QAAS2P,EAAOzzF,GAAG8jF,QACnB4P,WAAYD,EAAOzzF,GAAG0zF,aAIlC,IAAI6H,EAAkB,IAAIhF,GAAgB,CACtCxgC,MAAOjhB,SAAS,GAAK+gB,GACrBG,OAAQlhB,SAAS,GAAKghB,GACtB29B,OAAQ2H,IAGRspD,EAAsB10E,GAAG1+D,GAAG,CAC5B0nE,IAAK,CACDxjD,SAAU,WACVooD,UAAW,0BACX7nB,MAAOjhB,SAAS,GAAK+gB,GAAK,KAC1BG,OAAQlhB,SAAS,GAAKghB,GAAK,QAGnC4uF,EAAoB7hJ,YAAY04F,EAAgBpa,cAChD+L,EAAerqF,YAAY6hJ,GAG3BrhI,EAAIxgB,YAAYqqF,GAEhBnjE,YAAW,WACP,IACIyxE,IACF,MAAM74F,GACH0gB,EAAY8gF,cAAcxhG,MAEhC,GAEHmJ,EAAO03D,QAAO,KACV+zE,EAAQ/zE,UACR8oF,EAAc9oF,WAElB13D,EAAOqlI,SAAW,WAEd,OADArlI,EAAO03D,UACA,CACH6oF,SAAUA,EACVzG,gBAAiBA,MAKN,GAEhB95I,GAIX1I,MAAMsmD,GACF,IAAI8iD,EAAU9iD,EAAO8iD,QACjBK,EAAUnjD,EAAOmjD,QACjBw/C,EAAW3iG,EAAO//C,MAAM0iJ,SACxBzG,EAAkBl8F,EAAO//C,MAAMi8I,gBACnC,IAAKp5C,IAAY6/C,IAAax/C,EAC1B,OAAO,EACXA,EAAQvyB,OAAM,GACd,IAAIiqE,EAAWL,KACf,IAAKK,EACD,OAAO,EAEX,IAAIhN,EAAUgN,EAAShN,QAAQ/qC,EAAQ11C,QAavC,OAZAytF,EAASjsC,KAAKi/B,GAASzvC,QAAqB,uBAAbukD,EAAmCzG,GAAiBl1G,SACnF87D,EAAQ/V,UAAU,EAAG,EAAG+V,EAAQ11C,OAAOf,MAAOy2C,EAAQ11C,OAAOd,QAC7Dw2C,EAAQ/2B,UAAU8uE,EAAU,EAAG,GAC/BhN,EAAQ/zE,UACRqpC,EAAQvyB,OAAM,GACduyB,EAAQxiG,KAAK,CACT0kG,KAAM,CAAC,SAAU,WACjB5zB,OAAQ,QACRzxB,OAAQ,CAAC,CACL//C,MAAO+/C,EAAO//C,WAGf,ICrMf,IAAI4iJ,YACKC,GAAaC,EAAQC,GACtBA,EAAUvlD,YACVslD,EAAOtlD,UAAYulD,EAAUvlD,WAEjCslD,EAAOrpJ,MAAQspJ,EAAUtpJ,aCrB7BupJ,GAAiBzrJ,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,gBDyBxFm9G,YEmCdquC,GAAMC,EAA6BC,GAG/C,IAAIC,EAAkBnrJ,KAAK+O,IAAI,KAAM/O,KAAK6O,IAAI,KAAM7O,KAAK6O,IAAI1M,OAAOowF,OAAOp+B,MAAOhyD,OAAOowF,OAAOn+B,UAE5FgiE,EAA6B80B,EAASE,MAAQ,OAAUl9E,GAAara,QAAQ,WAAaqa,GAAara,QAAQ,WAAa,OAChI,MAAMs/D,EAAgB+3B,EAASz1F,KAAOy1F,EAASz1F,IAAI09D,aAAgB+3B,EAASz1F,IAAI09D,aAAe,SACzFnV,EAAektC,EAASltC,aAC9B,IAAIG,EAAW19G,SAASC,cAAc,OACtCy9G,EAAS9mC,UAAY,wBACrB,IAAIg0E,EAAkBrrJ,KAAK6O,IAAI,EAAG1M,OAAO28E,YACrCwsE,EAAmBtrJ,KAAK6O,IAAI,EAAG1M,OAAO48E,aAC1C,MAAMwsE,EAAY,IAClB,IAAIpe,EAAyB,MACzBjmB,EAAqB,IAAIhc,GAAGsgD,SAC5BP,EAAW,CACPpkC,WAAYokC,GACZ,CACA92F,MAAOn0D,KAAK+O,IAAIo8I,EAAiBhpJ,OAAO28E,WAdxB,IAcyDusE,EAAUA,EAAUE,GAC7Fn3F,OAAQp0D,KAAK+O,IAAIo8I,EAAiBG,IACnCJ,EAASE,OAAQ,EAAK,GAC7BlkC,EAASlZ,WAAW90B,IACpB,IACIuyE,EADAh7B,EAAwB,cAOnBi7B,EAAmBj0F,GACxB,OAAS,GAALA,EACO,GAEF,GAALA,EACO,IAEF,GAALA,EACO,KAEF,GAALA,EACO,MAEF,GAALA,EACO,OAEJA,EApBNyzF,EAAShtC,eACVgtC,EAAShtC,aAAe,CAACx4E,KAAI,OAAYgnD,MAAK,SAuBlD,IAAIi/D,GAAe,EAEfV,EACAA,EAAW,MAEX/xE,GAAUR,OAAM,GAChBwuC,EAASpE,WACToE,EAASjE,UAAU,EAAG,CAAEp0F,EAAG,IAAKioC,EAAG,IAAKz2C,EAAG,MAC3C64D,GAAUR,OAAM,IAEpB+3C,EAAY,CACRv7D,OAAQ,IAAIg2C,GAAGsgD,SAAS,CAACnoC,KAAM6D,GAAWgkC,EAASE,OAAQ,EAAK,GAChE19E,MAAOw5C,EAASxD,gBAAkB,EAClCoN,QAAS,IAEb,IAAK,IAAIzwG,KAAK6qF,GAAG4lB,QACT5lB,GAAG4lB,QAAQ9tH,eAAeqd,KAC1BowG,EAAUK,QAAQzwG,GAAK,IAAI6qF,GAAG4lB,QAAQzwG,GAClCowG,EAAUv7D,QACVu7D,EAAUK,QAAQzwG,GAAG0tF,WAAW0iB,EAAUv7D,OAAOovD,gBAAgBmM,EAAU/iD,SAMvF,IACIk+E,EAAcC,EADd7oB,EAAe,IAAI50D,GAAG+W,IAAI,EAAG,EAAG,GAEhC2mE,EAAuB,EACvBC,EAAkB7kC,EAAS5C,gBAAgB4C,EAASxD,gBAAkB,YAEjEsoC,EAAY/jJ,GACjBuyH,EAAoB5Y,SAAS35G,GACzBipH,GACAA,EAAkB3E,cAAoB,EAANtkH,GAIxC,MAAMuyH,EAAsB,IAAItvB,GAAG+gD,qBAC9B7mE,IACG6pD,EAAchnD,SAAS7C,GACvBwmE,EAAa3jE,SAAS7C,GACtB49C,EAAe50D,GAAG86B,QAAQ9jB,MAE7BvxD,IACG+3H,EAAa74D,QAAQl/D,GACrBq9F,EAAkB3E,cAAqB,EAAP14F,MAEnCquD,IACG0pE,EAAa39C,WAAW/rB,MAC3B,IACK+sD,EAAc/mD,iBACdqpC,EAAWs6B,GAAgBt9C,gBAC3BgjB,EAAWs6B,GAAgBr9C,oBAEtB,CACHqK,WAAY3N,GAAGghD,UAAUL,GAAgBhzC,WACzCC,cAAe5N,GAAGghD,UAAUL,GAAgB/yC,kBAKxD,IAAIqzC,EAAgB,IAAI/9E,GAAGqgD,WAAW29B,cAAc,CAChDllF,UAAWwkF,EAAmB,KAE9BW,EAAgB,IAAIj+E,GAAGqgD,WAAW69B,cAElCC,EAAiB,IAAIn+E,GAAGqgD,WAAWA,WAAW,CAC9C3sD,SAAU,CACNuqF,EACAF,KAIRI,EAAerqF,aAAY,SAAS76C,GACb,SAAfA,EAAMzmB,OACN2/H,EAAUtoH,MAAM4rE,cAAgB,OAChC+nE,EAAa1+C,UAAU7lF,EAAM3G,EAAG2G,EAAM1G,EAAG0G,EAAMw2C,UAC/CqzD,EAAkBrD,gBAEH,SAAfxmG,EAAMzmB,OACNgrJ,EAAav+C,OAAOhmF,EAAM3G,EAAG2G,EAAM1G,EAAG0G,EAAMw2C,UAAU,EAAOx2C,EAAMq6C,aACnEwvD,EAAkBpD,iBAAiBzmG,EAAM3G,EAAG2G,EAAM1G,EAAG0G,EAAMw2C,UAC3DqzD,EAAkBrD,gBAEH,OAAfxmG,EAAMzmB,OACN2/H,EAAUtoH,MAAM4rE,cAAgB,GAChC+nE,EAAat+C,UACb4jB,EAAkBrD,gBAEH,SAAfxmG,EAAMzmB,OACNgrJ,EAAa7xC,WAAWxM,gBAAgBlmF,EAAM8pB,GAAI9pB,EAAMgqB,GAAIhqB,EAAM+pB,GAAI/pB,EAAMiqB,IAC5E4/E,EAAkBrD,mBAI1B,IAAI2+B,EAAmB,CACnB34H,KAAM,GACNg9D,MAAO,OACPI,QAAQ,EACRE,UAAU,EACVJ,KAAM,aACN7O,QAAS,GAGb,MAAMgvC,EAAuC,IAAIhmB,GAAGuhD,kBAAkB,CAClEvlC,SAAUA,EACV/yD,MAAOn0D,KAAK6O,IAAI,EAAGw8I,EAAUE,GAC7Bn3F,OAAQk3F,EACR9kF,OAAQ+lF,EAAetqF,QACvBqtD,OAAQ,SAASriD,EAAQy/E,GACrBlyB,EAAoBvyC,SAAShb,GACzBy/E,IACAzd,EAAczZ,cACdtE,EAAkBva,QAAQg2C,GAAiBhuD,eAGnDkwB,OAAQ,SAAS+9B,EAASC,GACtB,IAAI7nC,EAAakC,EAASf,cAAc4lC,EAAgB72F,QACxDgyD,EAAS9B,UAAUJ,EAAY4nC,EAASC,EAAS5d,EAAc/mD,WAAY4kE,GAAOt+C,aAAcs+C,GAAOzhB,eAAgByhB,GAAOxhB,YAAawhB,GAAOvhB,UAAWuhB,GAAOthB,iBACpKta,EAAkBrD,gBAEtBiB,OAAQ,SAAS89B,EAASC,EAASvnF,GAC3B4lC,GAAG6hD,cAAcnqJ,MAAQ,GAI7BsoG,GAAG8hD,eAAe,CACd9lC,SAAUA,EACVlC,WAAYkC,EAASf,cAAc4lC,EAAgB72F,QACnDx0C,EAAGksI,EACHjsI,EAAGksI,EACHvnF,SAAUA,EACV8f,MAAO6pD,EAAc/mD,WACrB+6C,eAAgBgM,EAAclZ,kBAC9BliG,KAAM24H,EAAiB34H,KACvBg9D,MAAO27D,EAAiB37D,MACxBI,OAAQu7D,EAAiBv7D,OACzBE,SAAUq7D,EAAiBr7D,SAC3BJ,KAAMy7D,EAAiBz7D,KACvB7O,QAASsqE,EAAiBtqE,QAC1BqhD,UAAW,SAASt7H,GAEhB,IAAIw+H,EAAYx+H,EAAIm9E,MACpBqhD,EAAUh8H,EAAIxC,EAAIi6E,QAElBsqE,EAAiB34H,KAAO5rB,EAAI4rB,KAC5B24H,EAAiB37D,MAAQ5oF,EAAI4oF,MAC7B27D,EAAiBv7D,OAAShpF,EAAIgpF,OAC9Bu7D,EAAiBr7D,SAAWlpF,EAAIkpF,SAChCq7D,EAAiBz7D,KAAO9oF,EAAI8oF,KAC5By7D,EAAiBtqE,QAAUj6E,EAAIi6E,QAE/B,IAAI8iC,EAAakC,EAASf,cAAc4lC,EAAgB72F,QACxDgyD,EAASrwC,KAAKmuC,EAAY,CACtBr0B,QAAS1oF,EAAI0oF,QACbjwE,EAAGzY,EAAIyY,EACPC,EAAG1Y,EAAI0Y,EACPkT,KAAM5rB,EAAI4rB,KACVk9D,KAAM9oF,EAAI8oF,KACVF,MAAO5oF,EAAI4oF,MACXI,OAAQhpF,EAAIgpF,OACZE,SAAUlpF,EAAIkpF,SACd7rB,SAAUA,EACV8f,MAAOhX,GAAGkX,eAAepY,UAAUu5D,KAEvCvV,EAAkBrD,mBAK9BmB,QAAS,SAAS3vD,EAASutF,EAASC,EAASvnF,GACzB,SAAZjG,GACA4tF,GAAU/0E,OAAO00E,EAASC,EAASvnF,GAEvB,SAAZjG,GACA4tF,GAAUh7B,OAAO26B,EAASC,GAEd,OAAZxtF,GACA4tF,GAAU90E,KAAKy0E,EAASC,IAIhClgC,aAAc,SAASugC,GAEfA,EAActgC,QAAQh9G,SAAS,UAC/Bo/H,EAAcrY,IAAI,CACd/1H,KAAM,YACNgvC,MAAOs9G,EAAct9G,MACrBqkC,SAAgC,IAAtBi5E,EAActnF,MAAc5lE,KAAKuvC,KAInDo9G,GAAiBruB,gBAAgB4uB,EAAct9G,QAAUshF,EAAkBvD,eAC3Eg/B,GAAiBpuB,iBAAiB2uB,EAAct9G,QAAUshF,EAAkBtD,eAE5EuD,GAAOriF,OAAOo+G,EAAct9G,MAA6B,IAAtBs9G,EAActnF,MAAc5lE,KAAKuvC,KAExE0gF,OAAQ,WACA/2C,GAAUF,WACNm0E,GAAgBt0E,QAChBm2D,EAAcrY,IAAI77C,GAAK,SAAS,IAI5Cq1C,OAAQ,WACAj3C,GAAUH,WACNo0E,GAAgBr0E,QAChBk2D,EAAcrY,IAAI77C,GAAK,SAAS,MAMlD,IAAIsyE,EAA6B3sJ,SAASm0H,eAAe,SACxDw4B,MAAAA,GAAAA,EAASplI,iBAAiB,cAAc,SAAqBX,GAC5DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,KACAC,GAAYj1I,KAAK,eAE/B,IAAIk1I,EAA6B9sJ,SAASm0H,eAAe,SACxD24B,MAAAA,GAAAA,EAASvlI,iBAAiB,cAAc,SAAqBX,GAC5DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,KACAC,GAAYj1I,KAAK,kBAE/B,IAAIm1I,EAA6B/sJ,SAASm0H,eAAe,SACxD44B,MAAAA,GAAAA,EAASxlI,iBAAiB,cAAc,SAAqBX,GAC5DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,KACAC,GAAYj1I,KAAK,iBAE/B,IAAIo1I,EAA6BhtJ,SAASm0H,eAAe,SACxD64B,MAAAA,GAAAA,EAASzlI,iBAAiB,cAAc,SAAqBX,GAC5DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,KACAC,GAAYj1I,KAAK,iBAE/B,IAAIq1I,EAA6BjtJ,SAASm0H,eAAe,SACxD84B,MAAAA,GAAAA,EAAS1lI,iBAAiB,cAAc,SAAqBX,GAC5DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,KACAC,GAAYj1I,KAAK,kBAE/B,IAAIs1I,EAA6BltJ,SAASm0H,eAAe,SACxD+4B,MAAAA,GAAAA,EAAS3lI,iBAAiB,cAAc,SAAqBX,GAC5DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,KACAC,GAAYj1I,KAAK,mBAE/B,IAAIu1I,EAA6BntJ,SAASm0H,eAAe,SACxDg5B,MAAAA,GAAAA,EAAS5lI,iBAAiB,cAAc,SAAqBX,GAC5DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,KACAC,GAAYj1I,KAAK,iBAE/B,IAAIw1I,EAA6BptJ,SAASm0H,eAAe,SACzDi5B,MAAAA,GAAAA,EAAS7lI,iBAAiB,cAAc,SAAqBX,GAC3DA,EAAM4xC,iBACNi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,QAEH,IAAIS,EAA6BrtJ,SAASm0H,eAAe,SACzDk5B,MAAAA,GAAAA,EAAS9lI,iBAAiB,cAAc,SAAqBX,GAC1DA,EAAM4xC,iBACNi4D,EAAkBva,QAAQ,SAC1Bg2C,GAAiB3jE,UAAU,SAC3ByiE,EAAWpzI,KAAK,SAChBg1I,QAEJ,IAAIU,EAA8BttJ,SAASm0H,eAAe,UAC1Dm5B,MAAAA,GAAAA,EAAU/lI,iBAAiB,cAAc,SAAqBX,GAC1DA,EAAM4xC,iBACMi4D,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3ByiE,EAAWpzI,KAAK,QAChBg1I,QAEhB,IAAIW,EAA8BvtJ,SAASm0H,eAAe,UAC1Do5B,MAAAA,GAAAA,EAAUhmI,iBAAiB,cAAc,SAAqBX,GAC1DA,EAAM4xC,4BAGF,IAAI4J,GAAU,EACd,UACUm7C,EAAa/+E,MAAMioF,EAASjJ,cACpC,MAAOl9G,GACL8hE,GAAU,EACV16C,YAAU,KACN,MAAM,IAAI3pB,MAAM,uDAAyDuC,KAC1E,GACHiuI,EAAcrY,IAAI,KAAI77C,GAAG,wBAA0B,GAEnDjY,IACAqoF,EAAShtC,aAAaxxB,QACtBsiD,EAAcrY,IAAI77C,GAAK,wBAAwB,WAI3D,IAAImzE,EAA8BxtJ,SAASm0H,eAAe,UAanD,SACMs5B,EACLC,EAMAt7B,EACAsH,YAYSi0B,EAAqBj6F,EAAOC,GACjC,IAAIH,EAAI/gB,SAASihB,GACbD,EAAIhhB,SAASkhB,GAWjB,OAVIH,EAAIk3F,IACJj3F,GAAIi3F,EAAkBl3F,EACtBA,EAAIk3F,GAEJj3F,EAAIi3F,IACJl3F,GAAIk3F,EAAkBj3F,EACtBA,EAAIi3F,GAERl3F,EAAI/gB,SAAS,GAAK+gB,GAClBC,EAAIhhB,SAAS,GAAKghB,GACX,CACHC,MAAOF,EACPG,OAAQF,YAIPm6F,EAAcn5F,GACnB,IAAIo5F,EAAoBF,EAAqBl5F,EAAOf,MAAOe,EAAOd,QAG9DsuF,EAAat0E,GAAGlZ,OAAOA,EAAOf,MAAOe,EAAOd,QAC5BsuF,EAAWvtF,WAAW,MAC5B0e,UAAU3e,EAAQ,EAAG,GAEnCkZ,GAAGy1C,aAAa6+B,EAAY4L,EAAkBn6F,MAAOm6F,EAAkBl6F,QAEvE8yD,EAASx6B,MAAM,CACXv4B,MAAOm6F,EAAkBn6F,MACzBC,OAAQk6F,EAAkBl6F,OAC1B2sB,MAAO2hE,EACP1/B,UAAW6P,IAGfzB,GAAatiF,OAAO,GACpB2gG,GAAgBvoB,EAASb,SAAS,IAClC6K,EAAkBhF,YAClBiF,GAAOriF,OAAOoiF,EAAkBvd,WAAYud,EAAkBxD,eAE9Di+B,GAAe,EAOhB,SACM4C,EAAiBC,EAAyBC,YAGtCjkE,EAAKy7C,EAAcyoB,EAAYhmB,GACpCgmB,EAAWv6F,MAAQu6F,EAAWv6F,MAC9Bu6F,EAAWv5F,WAAW,MAAM0e,UAAUoyD,GAAeyC,EAAQhoH,GAAIgoH,EAAQ/nH,GACzEslH,EAAa9xE,MAAQu0E,EAAQv0E,MAC7B8xE,EAAa7xE,OAASs0E,EAAQt0E,OAC9B6xE,EAAa9wE,WAAW,MAAM0e,UAAU66E,EAAY,EAAG,GAE3D,GAAID,IAAYA,EAAQt6F,QAAUq6F,EAAgBr6F,OAAQs6F,EAAQr6F,SAAWo6F,EAAgBp6F,QAAS,CAClG,IAAIs6F,EAAatgF,GAAGlZ,OAAOu5F,EAAQt6F,MAAOs6F,EAAQr6F,QAOlD,GANAo6F,EAAgBr6F,MAAQs6F,EAAQt6F,MAChCq6F,EAAgBp6F,OAASq6F,EAAQr6F,OAE5Bo6F,EAAgB38D,QACjBrH,EAAKgkE,EAAgBt5F,OAAQw5F,EAAYD,GAEzCD,EAAgB38D,OAChB,IAAK,IAAIzzF,EAAI,EAAGA,EAAIowJ,EAAgB38D,OAAOxzF,OAAQD,IAAK,CAEpDosF,EADWgkE,EAAgB38D,OAAOzzF,GACxB2iF,MAAO2tE,EAAYD,IAMzC,IAaIzpC,EAbAspC,EAAoBF,EAAqBI,EAAgBr6F,MAAOq6F,EAAgBp6F,QAMpF,GALAo6F,EAAgBr6F,MAAQm6F,EAAkBn6F,MAC1Cq6F,EAAgBp6F,OAASk6F,EAAkBl6F,OACtCo6F,EAAgB38D,QACjBzjB,GAAGy1C,aAAa2qC,EAAgBt5F,OAAQs5F,EAAgBr6F,MAAOq6F,EAAgBp6F,QAE/Eo6F,EAAgB38D,OAChB,IAAK,IAAIzzF,EAAI,EAAGA,EAAIowJ,EAAgB38D,OAAOxzF,OAAQD,IAAK,CACpD,IAAI4sB,EAAOwjI,EAAgB38D,OAAOzzF,GAClCgwE,GAAGy1C,aAAa74F,EAAK+1D,MAAOytE,EAAgBr6F,MAAOq6F,EAAgBp6F,QAMvE4wD,EADAwpC,EAAgB38D,OACHq1B,EAASx6B,MAAM,CACxBv4B,MAAOq6F,EAAgBr6F,MACvBC,OAAQo6F,EAAgBp6F,OACxBy9B,OAAQ28D,EAAgB38D,SAGfq1B,EAASx6B,MAAM,CACxBv4B,MAAOq6F,EAAgBr6F,MACvBC,OAAQo6F,EAAgBp6F,OACxB2sB,MAAOytE,EAAgBt5F,SAG/Bk8D,GAAatiF,OAAOk2E,GACpByqB,GAAgBvoB,EAASb,SAASrB,IAClCkM,EAAkBhF,YAClBiF,GAAOriF,OAAOoiF,EAAkBvd,WAAYud,EAAkBxD,eAE9Di+B,GAAe,WAGVgD,EAAcz5F,GACnBg2C,GAAG0jD,wBAAwB,CACvBn+I,OAAQ0tG,EACR+I,SAAUA,EACV4b,YAAa5tE,EACbnmB,SAAU,SAAS8lC,EAAcs1E,GAC7B,IAAKt1E,EACD,OAGJqE,GAAUR,OAAM,GAChBwuC,EAASpE,WACT,IACI+rC,EADS3nC,EAAS1D,YACQnlH,OAAS,EACnCw0H,GACA3L,EAAS1C,YAAYqqC,EAAkBh8B,GAE3C,IAAIi8B,EAAqB5nC,EAAS5C,gBAAgBuqC,GAClDzgF,GAAG2rB,+BAA+B+0D,EAAoB55F,EAAQ2f,EAAc,KAAMs1E,GAClF1a,GAAgBvoB,EAASb,SAASwoC,IAClCz9B,GAAatiF,OAAO+/G,GAEpB31E,GAAUR,OAAM,GAEhBQ,GAAUzwE,KAAK,CACX0kG,KAAM,CAAC,QACP5zB,OAAQ,cACRzxB,OAAQ,CAACsmB,GAAG0nC,WAAWg5C,EAAmB55F,QAAS29D,SApJ9Ds7B,GAAiBt7E,MAAMs7E,EAAch6F,QAAU0e,MAAMs7E,EAAc/5F,SAAW+5F,EAAch6F,OAAS,GAAKg6F,EAAc/5F,QAAU,EACnI82C,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRv9G,KAAM,QACNimC,QAASi0C,GAAK,sBACd1c,QAAS,CAAC,SAsJA,YAAd+7D,GAA4BA,GAC5BjvB,GAAG6jD,sBAAsB,CACrBhuE,MAAOotE,EACP19I,OAAQ0tG,EACR8pB,QAASkjB,EACTp8G,SAAU,SAASzY,GACE,aAAbA,EAAI11B,KACJytJ,EAAc/3H,EAAIyqD,OACE,iBAAbzqD,EAAI11B,KACX2tJ,EAAiBj4H,EAAIyqD,MAAOzqD,EAAIoyG,SACZ,aAAbpyG,EAAI11B,KACX+tJ,EAAcr4H,EAAIyqD,OACXzqD,EAAI11B,QAOT,UAAdu5H,GACAw0B,EAAcR,EAAcj5F,QAEd,UAAdilE,IAC2B,QAAvBg0B,EAAcvtJ,KACd2tJ,EAAiBJ,GAEjBE,EAAcF,EAAcj5F,mBAyF/B85F,EAAiBh+E,EAAOmpD,YAEpB80B,IACL/jD,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRv9G,KAAM,UACNimC,QAASi0C,GAAK,0BAA4B,eAC1C1c,QAAS,CAAC,QAIlB,IAAI8wF,GAAqB,EACzB,IAAK,IAAWtiG,EAAPxuD,EAAI,EAASwuD,EAAOokB,EAAM5yE,GAAIA,IAAK,CACxC,IAAI60H,EAAYrmE,EAAK/iD,KAAK/E,MAAM,KAChCmuH,EAAYA,EAAUA,EAAU50H,OAAS,GAAGgT,cAC1B,QAAd4hH,EAAmB,SAET1S,GACN,IAEI4uC,EAAgB,KAEpB,GAAI5uC,EAAE1sF,MAHa,WAUf,YANAq3E,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRv9G,KAAM,QACNimC,QAAS,8CACTu3B,QAAS,CAAC,QAKlB,IAEIgxF,EAFAC,EAAgC,IAAjBr+E,EAAM3yE,QAAgBkiH,EAAE1sF,MAdrB,SAelBy7H,GAAe,EAGfD,GACAnkD,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRt3E,QAASi0C,GAAK,kBACd/rC,SAAU,SAAU7kC,GAChBolJ,GAAe,EACfF,EAAc,MAElBtxE,UAAW,SAAU7oD,GACjBm6H,EAAcn6H,KAM1B,IAAIs6H,EAAS,IAAIpuC,WACjBouC,EAAOzyC,OAAS,SAAU0yC,GAEtBtkD,GAAGwoB,YAAYj0H,MAAK,SAASk0H,GAEzB,IAAI07B,GAAiBC,EAIrB,IACI,IAAIG,EAUJ,GAPAA,EAAM97B,EAAU+7B,QACXF,EAAa/+I,OAAOvG,OACrB,CACIylJ,oBAAoB,EACpBC,eAAe,EACfC,wBAAwB,IAE5BJ,EAAIt7F,MAAQg7F,GAAiBM,EAAIr7F,OAAS+6F,EAe1C,OAdIC,GACAA,SAEJlkD,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRv9G,KAAM,QAENimC,QAASi0C,GAAK,wBAAwBj8E,QAAO,OAAS,QAChD,eACAi8E,GAAK,mBAAqB,KAAO20E,EAAIt7F,MAAQ,MAAQs7F,EAAIr7F,OAFtD0mB,sBAKT1c,QAAS,CAAC,QAOlBqxF,EAAM,KAEN,IACIA,EAAM97B,EAAU+7B,QAASF,EAAa/+I,OAAOvG,QAC/C,MAAOnJ,IAGT,GAAI0uJ,EAAK,CAEL,IAAIK,EAAe5kD,GAAGsoB,IAAIk8B,QAAQD,GAEhB,UAAdt1B,GAAyB21B,EAAaptJ,OACtCusJ,IAGAG,GACAA,IAEJlB,EAAsB4B,EAAcvvC,EAAE12G,KAAMswH,QAE5Cs1B,EAAM97B,EAAU+7B,QAASF,EAAa/+I,OAAOvG,OAAgB,CAAEylJ,oBAAoB,EAAMC,eAAe,IACtF,UAAdz1B,GACA80B,IAGAG,GACAA,IAEJlB,EAAsB,CAClBttJ,KAAM,MACNuzD,MAAOs7F,EAAIt7F,MACXC,OAAQq7F,EAAIr7F,OACZc,OAAQu6F,EAAIv6F,OACZxyD,OAAO,GACR69G,EAAE12G,KAAMswH,GAIjB,MAAOp5H,GACDquJ,GACAA,IAEJlkD,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRv9G,KAAM,QACNimC,QAAS,kCACTu3B,QAAS,CAAC,YAGnB18D,OAAK,KACJ0tJ,IACAxgF,MAAM,yCAId2gF,EAAOQ,kBAAkBxvC,GAnIV,CAoIhB3zD,GAEIA,EAAKhsD,KAAK1B,MAAM,WAAS,SACrB+1B,GACP9yB,OAAOy/C,IAAMz/C,OAAOy/C,KAAOz/C,OAAOw+G,UAClC,IAAI/hH,EAAMuD,OAAOy/C,IAAIoR,gBAAgB/9B,GACjCy5C,EAAK,IAAI2c,MACb3c,EAAGv2D,IAAMvZ,EACTwvE,GAAG4hF,UAAUthF,GAAI,WACbw/E,EAAsB,CAClBttJ,KAAM,QACNuzD,MAAOua,EAAGva,MACVC,OAAQsa,EAAGta,OACXc,OAAQwZ,GACTz5C,EAAEprB,KAAMswH,MAZa,CAc7BvtE,GAEHsiG,GAAqB,EAGzBA,GACAhkD,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRt3E,QAASi0C,GAAK,2BACdl6E,KAAM,QACNw9D,QAAS,CAAC,QAld1B6vF,MAAAA,GAAAA,EAAUjmI,iBAAiB,cAAc,SAAqBX,GAC1DA,EAAM4xC,iBACNk0F,GAAgBt0E,UAqdXqyE,EAASE,QACV,IAAIlgD,GAAG+kD,eAAe,CAClBx/I,OAAQhQ,SAAS0oD,KACjBixE,OAAQ,SAASppD,EAAOmpD,GAChBjvB,GAAG6hD,cAAcnqJ,MAAQ,GAG7BosJ,EAAiBh+E,EAAOmpD,IAE5BD,YAAa,WACT,OAAkC,IAA3BhvB,GAAG6hD,cAAcnqJ,SAIhCwrE,GAAGpmD,iBAAiB7lB,OAAQ,kBAnRfkxD,GACT63C,GAAG6hD,cAAcnqJ,MAAQ,IAgC7BywD,EAAE6F,kBACF7F,EAAE4F,iBAEE5F,EAAE68F,cAAcl/E,MAAM,YA/BgBm/E,EAAYphH,GAClB,GAA5BohH,EAAWD,eACc,mBAAbnhH,GACRA,OAAS5pC,GAIjB,IAAIqb,EAAQ2vI,EAAWD,cAAc1vI,MAErC,GAAarb,MAATqb,EACyB,mBAAbuuB,GACRA,OAAS5pC,QAGb,IAAK,IAAI/G,EAAI,EAAGA,EAAIoiB,EAAMniB,OAAQD,IAAK,CACnC,IAAsC,GAAlCoiB,EAAMpiB,GAAGwC,KAAKiP,QAAQ,SACtB,SAEJ,IAAI6gE,EAAOlwD,EAAMpiB,GAAGgyJ,YAEK,mBAAbrhH,GACRA,EAAS2hC,IAWrB2/E,CAAiCh9F,GAAG,SAAUi9F,GAE1C,GAAIA,EAAW,CACX,IAAIhnB,EAAM,IAAIj+C,MACdi+C,EAAIxsB,OAAS,WACToxC,EAAsB,CAClBttJ,KAAM,QACNuzD,MAAOm1E,EAAIn1E,MACXC,OAAQk1E,EAAIl1E,OACZc,OAAQo0E,GACT,KAAM,YAEb,IAAIinB,EAASpuJ,OAAOy/C,KAAOz/C,OAAOw+G,UAClC2oB,EAAInxH,IAAMo4I,EAAOv9F,gBAAgBs9F,OAGlCj9F,EAAE68F,cAAc1vI,MAAM,IAC7B6yC,EAAE68F,cAAc1vI,MAAM,GAAGgwI,aAAY,SAASC,GAE1C,IADAA,EAAWA,EAASt5H,QACPj4B,MAAK,WAAa,CAE3B,IAAIoqI,EAAM,IAAIj+C,MACdi+C,EAAIxsB,OAAS,WACToxC,EAAsB,CAClBttJ,KAAM,QACNuzD,MAAOm1E,EAAIn1E,MACXC,OAAQk1E,EAAIl1E,OACZc,OAAQo0E,GACT,KAAM,YAEbA,EAAI/oI,QAAU,SAAUQ,GACpB4pB,QAAQqR,IAAI,gBAAiBj7B,IAEjCuoI,EAAIonB,YAAc,YAClBpnB,EAAInxH,IAAMs4I,OAEP,GAAIA,EAASvxJ,MAAK,uCAAyC,CAE9D,IAAI+tE,EAASmB,GAAGkX,eAAelY,SAASqjF,EAAS5xJ,QAAQ,IAAK,KAC9D27H,EAAoBvyC,SAAShb,WAuMK,IAGlD,MAAMskD,EAAkB,GAGxB,IAAK,IAAIR,KAAK7lB,GAAGghD,UACb,GAAIhhD,GAAGghD,UAAUlpJ,eAAe+tH,GAAI,CAChC,IAAI4/B,EAAK,IAAIzlD,GAAGghD,UAAUn7B,GAAGhY,GAAG,CAC5BG,aAAc8yC,EACdvyC,gBAAiB,SAASv3B,GACtBs4C,EAAoB3Y,YAAY3/B,IAEpC45B,eAAc,KACV0e,EAAoB1Y,iBAAiB,CACjCjJ,WAAY3N,GAAGghD,UAAUL,GAAgBhzC,WACzCC,cAAe5N,GAAGghD,UAAUL,GAAgB/yC,mBAIxDyY,EAAWR,GAAK4/B,EAChBA,EAAGpxE,aAAatnE,MAAMsoE,QAAU,OAKxCnS,GAAGgJ,IAAI+mC,EAAU,CACbvqF,SAAU,WACVzW,KAAM,IACNy4C,IAAK,IACLx4C,MAAO,IACP69D,OAAQ,MAGZ,IAAI+zD,EAAgB,IAAI9jC,GAAG0lD,cAE3B,MAAMrwB,EAAYnyD,GAAG1+D,GAAG,IAClBmhJ,EAAiBziF,GAAG1+D,GAAG,CACzBga,OAAQ62G,IAEZA,EAAU78C,cAAgB,WACtB,OAAO,GAEX68C,EAAU3jD,QAAUxO,GAAGyO,YAGvB,IA4GIi0E,EA2BAC,EAvIAC,EAAqB,IAAI9lD,GAAG+lD,mBAAmB,CAC/C15E,SAAU,WACN25E,gBAGCA,IAGD7F,EA14BgB,KA24BhB2F,EAAmBzxE,aAAatnE,MAAMC,QAAU,QAEhD84I,EAAmBtxB,aAAatJ,GAC5B46B,EAAmB7zD,UACH,SAAZi5B,GACAhoD,GAAGgJ,IAAI45E,EAAmBzxE,aAAc,CACpCpiE,KAAM,QACNC,MAAO,KAEXgxD,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,YAGVixD,GAAGgJ,IAAI45E,EAAmBzxE,aAAc,CACpCpiE,KAAM,GACNC,MAAO,UAEXgxD,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,OAGdojH,EAAUtoH,MAAMC,QAAU,QAC1Bg5G,EAAkBn+B,QAAQ/yF,KAAK6O,IAAI,EAAGw8I,EAAUE,GAAYD,GAC5Dtc,EAAcvY,SAAQ,KAGN,SAAZL,GACAhoD,GAAGgJ,IAAI45E,EAAmBzxE,aAAc,CACpCpiE,KAAM,IACNC,MAAO,KAEXgxD,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,QAGVixD,GAAGgJ,IAAI45E,EAAmBzxE,aAAc,CACpCpiE,KAAM,GACNC,MAAO,MAEXgxD,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,OAGdojH,EAAUtoH,MAAMC,QAAU,OAC1Bg5G,EAAkBn+B,QAAQ/yF,KAAK6O,IAAI,EAAGw8I,GAAUC,GAChDtc,EAAcvY,SAAQ,MAK1Bu6B,EAAmBzxE,aAAatnE,MAAMC,QAAU,OAChC,SAAZk+G,EACAhoD,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,UAGVixD,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,MAGdojH,EAAUtoH,MAAMC,QAAU,QAC1Bg5G,EAAkBn+B,QAAQ/yF,KAAK6O,IAAI,EAAGw8I,EAAUE,GAAYD,GAC5Dtc,EAAcvY,SAAQ,aAMrB06B,IACW,SAAZ/6B,GACAhoD,GAAGgJ,IAAImpD,EAAW,CACdpjH,KAAM,IACNC,MAAO,GACPoqE,WAAY,OACZC,YAAa,iCAEjBrZ,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,YAGVixD,GAAGgJ,IAAImpD,EAAW,CACdpjH,KAAM,GACNC,MAAO,IACPoqE,WAAY,+BACZC,YAAa,SAEjBrZ,GAAGgJ,IAAI85C,EAAkB3xC,aAAc,CACnCpiE,KAAM,OAGd6xH,EAActY,WAAWN,GACzB/E,GAAaqF,WAAW,GAAKN,GAC7BhF,GAAasF,WAAW,GAAKN,GAC7B86B,IACAE,GAAkBj7B,cAAcC,GA5BpC86B,IAkCA/oI,YAAW,WACP2oI,EAAmB,IAAI5lD,GAAGmmD,iBAAiB,CACvCn3B,YAAa,WACT,OAAkC,IAA3BhvB,GAAG6hD,cAAcnqJ,QAAgBypJ,EAAcxlF,oCAE1D2zD,IAEJrc,EAASl9G,YAAY6vJ,EAAiBvxE,gBACvC,GAEHnR,GAAGxlB,OAAOu1D,EAAU,CAAC+S,EAAkB3xC,aAAcghD,EAAWywB,EAAmBzxE,eAEnFnR,GAAGgJ,IAAImpD,EAAW,CACd3sG,SAAU,WACVxW,MAAO,IACPw4C,IAAK,IACLqlB,OAAQ,IACR9mB,MAAQo3F,QAERrwE,SAAU,SACV+G,gBAAiB,OACjBuF,WAAY,+BACZnE,WAAY,OACZijD,YAAa,SAKbyqB,EADA7F,EAASE,MACS,IAAInW,GAAgB,CAClCrZ,OAAM,KACFlf,GAAgBwuC,EAASE,MAAMxsJ,IAAM,eAAgBssJ,EAASE,QAElEjW,SAAQ,KACJjqC,GAAG2R,MAAM,CACLpsG,OAAQ0tG,EACRt3E,QAASi0C,GAAK,iBACd1c,QAAS,CAAC0c,GAAK,UAAW,UAC1B/rC,SAAQpuC,MAASuJ,IACb,GAAIA,IAAW4wE,GAAK,UAChB,OAGJ,IAAI0X,EAAUpkB,GAAG1+D,GAAG,CAChBga,OAAQy0F,EACR9mC,UAAW,iBACXjgE,QAAS,+BAAiC0jE,GAAK,uBAGnDowE,EAASE,MAAMjW,UAAQ,KAEf+V,EAAShtC,aAAaxxB,QACtByxB,EAASj2F,YAAYsqE,MACxB,KAEG2rB,EAASj2F,YAAYsqE,UAKzC69C,YAAW,KACPja,EAAsB,SAAZA,EAAqB,QAAU,OACzC+6B,OAIU,IAAIjmD,GAAGomD,gBAAgB,CACrCn2B,QAAS+vB,EAAS/vB,QAClBo2B,OAAQ,WACJ70C,GAAgB,YAAawuC,EAASE,QAE1C/vB,MAAO,WACHm2B,MAEJj2B,SAAU,WACNk2B,GAAQvkB,iBAEZzR,OAAQ,WACJi2B,GAAep9E,QAEnBqnD,QAAS,WACLg2B,MAEJ/1B,OAAQ,WACJlf,GAAgB,YAAawuC,EAASE,UAIlDh9E,GAAGkO,aAAay0E,EAAgBxxE,aAAc,wBAC9CwxE,EAAgBxxE,aAAatnE,MAAMkkE,aAAe,OAGlD,IAwCI8yD,EAxCA0d,GAAmB,IAAIzhD,GAAG0mD,iBAAiB,CAC3C31B,WAAY,SAASv9B,GACjB,GAAkB,SAAdA,EACAwyB,EAAkBva,QAAQ,aACvB,GAAkB,SAAdjY,EACPwyB,EAAkBva,QAAQ,aACvB,GAAkB,SAAdjY,EACPwyB,EAAkBva,QAAQ,aACvB,GAAkB,SAAdjY,EACPwyB,EAAkBva,QAAQ,YACvB,CAAA,GAAkB,UAAdjY,EAGP,MAAM,IAAIlgG,MAAM,qBAFhB0yH,EAAkBva,QAAQ,SAI9B80C,EAAWpzI,KAAKqmF,GAChB2uD,KACApe,EAAczZ,eAElBuI,SAAU,WACN7M,EAAkBxE,WAAWvzD,YAAY0e,UAAU,SAAW,EAAE,EAAI,KAExEmmD,UAAW,WACP9M,EAAkBxE,WAAWvzD,YAAY0e,UAAU,UAAW,EAAG,GAAI,KAEzEo4C,OAAQ,WACJk9B,GAAgBt0E,QAEpBs3C,OAAQ,WACJg9B,GAAgBr0E,mBAmCf22D,GAAgB/vB,GACrBqsC,EAAkBrsC,EAAM9U,QACxBghD,EAAa79C,WAAW2R,EAAM9U,SAC9BymB,GAAaC,SAAS5R,GAnC1BitC,GAAiBnuD,WAAW8sD,EAAW,KACvCpyE,GAAUP,aAAY,WAClBg0E,GAAiBnuB,cAActlD,GAAUF,WACzC2zE,GAAiBluB,cAAcvlD,GAAUH,cAE7C3K,GAAGkO,aAAaqwE,GAAiBptE,aAAc,wBAwC/C0vD,EAAgB,IAAI/jC,GAAG2mD,cAAc,CACjC19F,MAAO,IACPC,OAAQ,GACR6/D,SAAU,IACVE,WAAY,IAAI/lD,GAAG+W,IAAI,EAAG,EAAG,GAC7BmqC,gBAZmBwiC,GACnB9uB,EAAe8uB,EACflG,EAAa3jE,SAAS6pE,GACtBt3B,EAAoB7Y,UAAUmwC,GAC9B7iB,EAAczZ,iBAUlByZ,EAAchZ,UAAUj2H,KAAK6O,IAAI,IAAK7O,KAAK+O,IAAI,IAAKu8I,EAAW,OAC/Drc,EAAcjZ,iBAAgB,SAAU+7B,GAEhCA,EACA7gC,EAAkBva,QAAQ,SAE1Bua,EAAkBva,QAAQg2C,GAAiBhuD,aAC3C0uD,SAIR,IAAI2E,GAAWvxJ,SAASC,cAAc,OAClCmqI,GAAWpqI,SAASC,cAAc,OACtC0tE,GAAGgJ,IAAIyzD,GAAU,CACbniD,OAAQ,OACRxwE,QAAS,OACT8kE,SAAU,OACVzB,eAAgB,gBAChBC,WAAY,aAEhB,IAAIy2E,GAAyB,IAAI/mD,GAAGgnD,uBAAuB,CACvDhrF,UAAW,EACXy3D,SAAU,SAASv+G,GACf+rI,EAAc3kF,aAAakkF,EAAmBtrI,OAGtD4xI,GAAS/wJ,YAAY4pI,IAKrBz8D,GAAGxlB,OACCiiF,GACA,CAACoE,EAAc1vD,aAAc0vD,EAAc/Y,mBAAoB+7B,GAAuB1yE,eAG1F,IAAI+tE,GAAc,IAAIpiD,GAAGinD,OAAO,CAC5BnoE,UAAW,WACXm1C,WAAW,EACXP,OAAS,WACL,IAAI10H,EAAS,YAEJ+0H,EAAU1oE,GACf,MAAO,CACHj4D,GAAIi4D,EACJwqB,MAAOmqB,GAAGghD,UAAU31F,GAAQwqB,MAC5BhQ,MAAOm6B,GAAGghD,UAAU31F,GAAQqiD,QAC5BwmB,OAAQ,eAzFCgzB,EA0FL7gC,EAAWh7D,GAAQgpB,aAAatnE,MAAMC,QAAU,QAzFhD,iBADKk6I,EA2FW77F,KAzF5Bu1F,EAAuBsG,GAGvBnjB,IACgB,gBAAZmjB,EACAnjB,EAAc3mG,QAAO,GAErB2mG,EAAc3mG,QAAO,IAI7BujH,EAAiBuG,EACjBxG,EAAer6B,EAAW6gC,GAC1BxG,EAAa3jE,SAAS+6C,GACtB4oB,EAAa79C,WAAWg+C,GACxB76B,EAAkBva,QAAQ,QAC1Bg2C,GAAiB3jE,UAAU,QAC3BqkE,KAyEgBpe,EAAczZ,cACdgF,EAAoB1Y,iBAAiB,CACjCjJ,WAAY3N,GAAGghD,UAAU31F,GAAQsiD,WACjCC,cAAe5N,GAAGghD,UAAU31F,GAAQuiD,gBAExCkzC,EAAYz6B,EAAWh7D,GAAQg4C,WAC/BisB,EAAoB3Y,YAAY0P,EAAWh7D,GAAQi4C,eAEvDlwB,QAAS,WACLizC,EAAWh7D,GAAQgpB,aAAatnE,MAAMC,QAAU,SAK5D,IAAIo+C,EAASn4D,OAAOD,KAAKqzH,GACzB,IAAK,IAAInzH,EAAI,EAAGA,EAAIk4D,EAAOj4D,OAAQD,IAC/B8L,EAAOzB,KAAKw2H,EAAU3oE,EAAOl4D,KAEjC,OAAO8L,EA7BF,KAiCb,IAAK,IAAIunH,KAAKvmB,GAAGghD,UACThhD,GAAGghD,UAAUlpJ,eAAeyuH,IAC5BugC,GAAS/wJ,YAAYswH,EAAWE,GAAGlyC,cAI3C,MAAM4xC,GAAS,IAAIjmB,GAAGmnD,OAAO,CACzBziH,MAAO,EACPqkC,SAAU,EACVk2D,QAAS,WACLjZ,EAAkBhF,WAAU,GAC5BiF,GAAOriF,OAAOoiF,EAAkBvd,WAAYud,EAAkBxD,gBAElE4c,MAAO,WACHpZ,EAAkBpE,UAClBqE,GAAOriF,OAAOoiF,EAAkBvd,WAAYud,EAAkBxD,gBAElE8c,cAAe,SAASv2D,EAAUm5C,GAC9B8D,EAAkB/D,SAASl5C,EAAUm5C,GACrC+D,GAAOriF,OAAOoiF,EAAkBvd,WAAYud,EAAkBxD,kBAItE,IAAIo/B,GAAS,IAAI5hD,GAAGonD,OAAO,CACvB/3B,YAAa0U,IAGbsjB,GAAS,IAAIrnD,GAAGsnD,OAAO,CACvBj4B,YAAa0U,IAGbwjB,GAAU,IAAIvnD,GAAGwnD,QAAQ,CACzBn4B,YAAa0U,IAGbge,GAAY,IAAI/hD,GAAGynD,UAAU,CAC7B3jC,QAAS,SAAS4jC,EAAQxhH,EAAIE,EAAIwgC,EAAIzH,EAAI/E,GAEtC,IAAI0/C,EAAakC,EAASf,cAAc4lC,EAAgB72F,QAEpDq5B,EAAgB,CAChB3tF,KAAM6xJ,GAAQ7lB,WACdx7F,GAAIA,EACJE,GAAIA,EACJwgC,GAAIA,EACJzH,GAAIA,EACJ/E,SAAUA,EACVoqB,WAAY+iE,GAAQ3lB,gBACpB5qD,QAASuwE,GAAQjkD,aACjB9f,SAAU+jE,GAAQ/8C,eAEK,SAAvB+8C,GAAQ7lB,YAIkB,WAAtB6lB,GAAQ77C,WAHZroB,EAASK,UAAYqgD,EAAc/mD,WACnCqG,EAASC,UAAYikE,GAAQ5lB,gBAMzBt+C,EAASI,QAAUsgD,EAAc/mD,WAIrC0qE,GACA1rC,EAASP,aAAa3B,EAAY,MAClCkC,EAAShR,UAAU8O,EAAYz2B,IAE/B24B,EAASP,aAAa3B,EAAY,CAC9BtO,KAAM,SAAShvC,GACXwjC,GAAGgL,UAAUxuC,EAAK6mB,MAI9B2iC,EAAkBrD,kBAK1B,MAAMuD,GAAelmB,GAAG2nD,eAAe3rC,GAAU,SAAUj/G,GACvDwnI,GAAgBvoB,EAASb,SAASp+G,IAClCixE,GAAUzwE,KAAK,CACX0kG,KAAM,CAAC,QACP5zB,OAAQ,aACRzxB,OAAQ,CAAC7/C,OAEdk2G,GACGkT,GAAe,IAAInmB,GAAG4nD,aAAa,CACrC30C,SAAUA,EACV7mC,QAAS,WACLm0E,EAAWpzI,KAAK,aAGxBg5G,GAAawH,aAAayyB,GAAY,KACtCj6B,GAAaC,SAASpK,EAASb,SAASa,EAASf,cAAc4lC,EAAgB72F,UAE/E,MAAM69F,GAAY,IAAI7nD,GAAG8nD,UACrB70C,EACA8wB,EACA7d,GACAqe,GACAve,EACAC,IAAM,IAEK6R,IACV,IAEUmoB,IACV,IAEUjkC,IACV,IAEU6kC,KAETb,EAASE,MACXpc,GAGEme,GAAkB,IAAIjiD,GAAG+nD,gBAC3B1hC,EACAF,GACAD,GACAD,GACAD,GAAiB,KAEb,IAAKT,EACD,MAAM,IAAIjyH,MAAM,6BAEpB,OAAOiyH,KACV,IACKvJ,QACA6kC,IACLmH,IACGnH,EAAkBmH,KACrB,IACKtH,aAMD4F,KACLtmD,GAAGioD,eAAe,CACdnwB,aAAcA,EACdC,eAAgBgM,EAAclZ,kBAC9BmN,cAAeioB,EACfhoB,YAAajc,EAAS/D,WACtBigB,aAAclc,EAAS9D,YACvBigB,eAAgBlhI,OAAO28E,WA13CP,IA03CwCusE,EAAUA,EAAUE,EAC5EjoB,gBAAiBgoB,EACjB/nB,UAAW,SAASpvE,EAAOC,EAAQgxB,GAC/B8hC,EAASx6B,MAAM,CACXv4B,MAAOA,EACPC,OAAQA,EACRgxB,MAAmB,IAAZA,EAAM36E,EAAU26E,EAAQ,OAGnCgsC,GAAatiF,OAAO,GACpB2gG,GAAgBvoB,EAASb,SAAS,IAClC6K,EAAkBhF,YAClBiF,GAAOriF,OAAOoiF,EAAkBvd,WAAYud,EAAkBxD,eAE9Di+B,GAAe,GAEnBnoB,SAAU,wBAITmuB,GAAW5iH,GAChBq/B,GAAGglF,YAAY,CACXl+F,OAAQgyD,EAASpB,kBAAkB,GACnCj1C,SAAUzC,GAAGwB,UAAYujD,EAAe,OACxCpiD,MAAO3C,GAAGwB,UAAYujD,EAAe,OACrCpkF,SAAUA,GAAsB,eApCxCmqC,GAAUP,aAAa5c,IACnBoxF,GAAgBx7B,QAAQ51D,MAuC5B,MAAM21F,GAAiB,IAAIxmD,GAAGmoD,eAC1BnI,EAAShtC,aACTC,GAAQ,IACFgvB,QACAjmB,GACNiM,GAGEs+B,GAAUvG,EAASE,MAAQ,KAAO,IAAIlgD,GAAGooD,QAC3Cn1C,EACAH,GAAY,IACNkJ,EAASjJ,cACfkvB,GACCvsI,IACGusI,EAAavsI,IAEjBouJ,GAAgB,KAEZ0C,GAAep9E,SAEnBk9E,GACAG,IAAU,KAENzmD,GAAGqoD,YAAYrsC,EAAU/I,EAAU+sC,EAAShtC,aAAcgtC,EAASz1F,KAAOy1F,EAASz1F,IAAIkzE,SAAWuiB,EAASz1F,IAAIkzE,SAAW,kBA0MzG7G,GACrB52B,GAAGsoD,gBAAgBr1C,EAAU+I,EAASpB,kBAAkB,IAAI,SAAU2tC,GAClE,GAAsB,IAAlBA,EAASt2I,MAAiC,IAAnBs2I,EAASr2I,OAAgC,IAAjBq2I,EAAS79F,KAAiC,IAApB69F,EAASx4E,OAC9E,OAGJ,IAAIlf,EAAI,CACJ6uC,QAASmhD,EACT72F,OAAQgyD,EACRn/G,MAAO0rJ,EACPxoD,QAAS/xB,IAEbgyB,GAAG+lB,UAAUxrB,WAAWjkG,MAAMu6D,GAC9Bq1D,GAAatiF,SACboiF,EAAkBhF,YAClBiF,GAAOriF,OAAOoiF,EAAkBvd,WAAYud,EAAkBxD,iBAC/DshB,EAAelN,KAvNlBopB,EAAShtC,cAGPw1C,GAAc,IAAIxoD,GAAGyoD,aAAW,KAE9Bv9B,EAAsB,SAAZA,EAAqB,QAAU,OACzC+6B,IACKjG,EAASE,OACVl9E,GAAapa,QAAQ,UAAWsiE,KAGxC80B,EAAS0I,kBA8JJvG,KACL,IAAK5B,EACD,OAGJ,IAQI/sD,EAAYiuD,GAAiBhuD,YAC7Bk1D,EAAWpI,EAAWjsB,iBAEtBs0B,EAAU31J,OAAOD,KAXP,CACVw4G,KAAQ,GACRuY,KAAQ,GACRx+B,KAAQ,GACR5Z,KAAQ,GACRk4C,MAAS,KAOb,IAAK,IAAI3wH,EAAI,EAAGA,EAAI01J,EAAQz1J,OAAQD,IAC5BsgG,IAAco1D,EAAQ11J,GACtBqtJ,EAAW5yB,aAAai7B,EAAQ11J,IAAI,IAEpCqtJ,EAAW5yB,aAAai7B,EAAQ11J,IAAI,GAChCy1J,IAAaC,EAAQ11J,IACrBqtJ,EAAWpzI,KAAKqmF,IAlLhC+sD,EAAa,IAAIvgD,GAAGinD,OAAO,CACvBnoE,UAAW,OACX40C,OAAQ,CACJ,CACItgI,GAAI,OACJyyE,MAAO+J,GAAK,cACZiG,MAAO9G,EAAA0iB,IACPyiC,OAAQ,WACmB,gBAAnBysB,GACA5c,EAAc3mG,QAAO,GAEzB8lC,GAAGxlB,OACCiiF,GACA,CAACoE,EAAc1vD,aAAc0vD,EAAc/Y,mBAAoB+7B,GAAuB1yE,eAE1FyyE,GAAS/5I,MAAMC,QAAU,SAE7BomE,QAAS,WACL0zE,GAAS/5I,MAAMC,QAAU,QAE7Bk/D,IAAK,CACDugD,SAAU,SAGlB,CACIr5H,GAAI,OACJyyE,MAAO+J,GAAK,aACZiG,MAAO9G,EAAA2kB,IACPvL,WAAW,EACX+rC,OAAQ,WACJjO,GAAO0H,cAAa,IAExBv6C,QAAS,WACL6yC,GAAO0H,cAAa,IAExBzhD,IAAK,CACDugD,SAAU,SAGlB,CACIr5H,GAAI,OACJyyE,MAAO+J,GAAK,qBACZiG,MAAO9G,EAAA2iB,IACPvJ,WAAW,EACX+rC,OAAQ,WACJ6P,EAAc3mG,QAAO,GACrBwkH,GAAOj0B,cAAa,IAExBv6C,QAAS,WACLwuE,GAAOj0B,cAAa,IAExBzhD,IAAK,CACDugD,SAAU,SAGlB,CACIr5H,GAAI,OACJyyE,MAAO+J,GAAK,aACZiG,MAAO9G,EAAA4iB,IACPxJ,WAAW,EACX+rC,OAAQ,WACJ6P,EAAc3mG,QAAO,GACrBiqH,GAAO15B,cAAa,IAExBv6C,QAAS,WACLi0E,GAAO15B,cAAa,IAExBzhD,IAAK,CACDugD,SAAU,SAGlB,CACIr5H,GAAI,QACJyyE,MAAO+J,GAAK,cACZiG,MAAO9G,EAAA6iB,IACPzJ,WAAW,EACX+rC,OAAQ,WACJ6P,EAAc3mG,QAAO,GACrBmqH,GAAQ55B,cAAa,IAEzBv6C,QAAS,WACLm0E,GAAQ55B,cAAa,IAEzBzhD,IAAK,CACDugD,SAAU,SAGlB,CACIr5H,GAAI,SACJyyE,MAAO+J,GAAK,cACZiG,MAAO9G,EAAA85E,IACP30B,OAAQ,WACJhO,GAAatiF,SACbsiF,GAAan5G,MAAMC,QAAU,SAEjComE,QAAS,WACL8yC,GAAan5G,MAAMC,QAAU,QAEjCk/D,IAAK,CACDugD,SAAU,SAGlB,CACIr5H,GAAI,OACJ6mD,MAAO21B,GAAK,YACZskD,OAAQ,WACJ2zB,GAAUx0D,QAEdjgB,QAAS,WACLy0E,GAAU30C,QAEdhnC,IAAK,CACDmJ,QAAS,UAGjB,CACIjiF,GAAI,OACJ6mD,MAAO21B,GAAK,YACZuY,YAAao+D,GACbryB,OAAQ,WACCqyB,KAGLA,GAAQlyE,aAAatnE,MAAMC,QAAU,QACrCu5I,GAAQ54B,cAAa,KAEzBv6C,QAAS,WACAmzE,KAGLA,GAAQlyE,aAAatnE,MAAMC,QAAU,OACrCu5I,GAAQ54B,cAAa,KAEzBzhD,IAAK,CACDmJ,QAAS,UAGjB,CACIjiF,GAAI,WACJyyE,MAAO+J,GAAK,gBACZiG,MAAO9G,EAAA8wE,IACP3rB,OAAQ,WACJs0B,GAAYn0E,aAAatnE,MAAMC,QAAU,SAG7ComE,QAAS,WACLo1E,GAAYn0E,aAAatnE,MAAMC,QAAU,QAG7Ck/D,IAAK,CACDugD,SAAU,YAsD1B,MAAMq8B,GAAmB5lF,GAAG1+D,GAAG,CAC3B0nE,IAAK,CACDjjB,MAAO,QACPvgC,SAAU,WACVqnD,OAAQ,IACR99D,KAAM,OAGd,GAAI+tI,EAAS+I,UAAW,CACpBD,GAAiBprG,OAAOsiG,EAAS+I,WAChB,IAAI/qI,kBAAgB,IAAOgrI,OACnCnqI,QACL8mI,EACA,CACItoG,YAAY,EACZu4E,WAAW,EACXC,SAAS,aAIZmzB,KACL,IAAKhJ,EAAS+I,UACV,OAEJ,MACM5gE,EADY,IAEFlxF,OAAO48E,aACnB8xE,EAAerwB,aAAe,GAAKr+H,OAAO48E,YAE9Ci1E,GAAiB/7I,MAAMC,QAAUm7E,EAAY,GAAK,OAKtDjlB,GAAGxlB,OAAOioG,EAAgB,CACtBx/B,GAAa9xC,aACbksE,EAAWlsE,aACXyyE,GACA7gC,GAAO5xC,aACPutE,GAAOvtE,aACPgzE,GAAOhzE,aACPkzE,GAAQlzE,aACR6xC,GACA2hC,GAAUxzE,aACVkyE,GAAUA,GAAQlyE,aAAe,KACjCm0E,GAAYn0E,aACZnR,GAAG1+D,GAAG,CACF0nE,IAAK,CACDhjB,OAAQ,UAGhB4/F,IAAsC,OAG1C,MAAM5C,GAAoB,IAAIlmD,GAAGipD,kBAAkB,WAC/C5zB,UACAnK,IAKJ/zH,KAAK0mF,MAAK,IACCo1B,EAGX97G,KAAK2jG,OAAM,CAAI/xC,EAAGC,KAGV/xD,OAAOiyJ,QAAU,GACjBjyJ,OAAOy7E,SAAS,EAAG,GAGnBytE,IAAYrrJ,KAAK6O,IAAI,EAAGolD,IAAMq3F,IAAatrJ,KAAK6O,IAAI,EAAGqlD,KAI3Dm3F,EAAUrrJ,KAAK6O,IAAI,EAAGolD,GACtBq3F,EAAWtrJ,KAAK6O,IAAI,EAAGqlD,GAEvBg9F,IACAgD,KAEA7iC,GAAawH,aAAayyB,GAAY,KACtCrc,EAAchZ,UAAUj2H,KAAK6O,IAAI,IAAK7O,KAAK+O,IAAI,IAAKu8I,EAAW,OAC/DqB,GAAiBnuD,WAAW8sD,EAAW,OAG3CjpJ,KAAKs0H,IAAO1oD,IACR+gE,EAAcrY,IAAI1oD,IAGtB5rE,KAAKgyJ,OAAS,WACV,OAAOt1C,GAAamI,EAASpB,kBAAkB,GAAG/9C,UAAU,eAGhE1lE,KAAKiyJ,OAAM3zJ,iBACP,4BCxyDgCumH,GACpC,IAAIqD,EAAWrD,EAAShB,gBAEpBqN,EAAY,CACZp/D,MAAO+yD,EAAS/D,WAChB/uD,OAAQ8yD,EAAS9D,YAEjB9xB,SAAU,IAEd,IAAK,IAAIlzF,EAAI,EAAGA,EAAImsH,EAASlsH,OAAQD,IAAK,CAEtC,IAAI4sB,EAAOu/F,EAASnsH,GACpBm1H,EAAUjiC,SAAS7oF,KAAK,CACpBoB,KAAMmhB,EAAKnhB,KACXq4E,QAASl3D,EAAKk3D,QACdhtB,OAAQlqC,EAAKkqC,OACbg9B,UAAWgZ,GAAGsoB,IAAIC,aAAazoG,EAAK8mE,YACpC30E,KAAM,EACNy4C,IAAK,IAIb,IACIl5B,SADcp9B,EAAA,UACCs0H,eAAeL,GAClC,OAAO,IAAItjD,KAAK,CAACvzC,GAAS,CAAE97B,KAAM,6BDgxDjB2zJ,CAAkBrtC,IAGnC7kH,KAAKmyJ,gBAAe,KAChBp+B,EAAsB,SAAZA,EAAqB,QAAU,OACpC80B,EAASE,OACVl9E,GAAapa,QAAQ,UAAWsiE,GAEpC+6B,KAKJ9uJ,KAAK2jG,OAAOqlD,EAASC,GACrB6F,IAEA,CACI/iF,GAAGpmD,iBAAiB7lB,OAAQ,UAAQ,KAChCE,KAAK2jG,OAAO7jG,OAAO28E,WAAY38E,OAAO48E,gBAE1C3Q,GAAGpmD,iBAAiB7lB,OAAQ,qBAAmB,KAC3CE,KAAK2jG,OAAO7jG,OAAO28E,WAAY38E,OAAO48E,gBAK1C,MAAM01E,EAAsBrmF,GAAG1+D,GAAG,CAC9Bga,OAAQjpB,SAAS0oD,KACjBiuB,IAAK,CACDxjD,SAAU,QACVzW,KAAM,IACNy4C,IAAK,IACLx4C,MAAO,IACP69D,OAAQ,IACR4I,cAAe,OACflI,OAAQ,KACR0H,WAAY,UAGH,IAAIqxE,gBAAc,IAAOryJ,KAAK2jG,OAAO7jG,OAAO28E,WAAY38E,OAAO48E,eACvEh1D,QAAQ0qI,GAGjBrmF,GAAGpmD,iBAAiB3lB,KAAK0mF,QAAS,SAAU1hE,IACxCA,EAAM4xC,oBAGV,MAAM07F,EAAW5zJ,IACbA,EAAEk4D,kBAEN92D,OAAO6lB,iBAAiB,eAAgB2sI,GACxCxyJ,OAAO6lB,iBAAiB,gBAAiB2sI,GACzCxyJ,OAAO6lB,iBAAiB,aAAc2sI,IE/1D9CZ,GAAiBz0J,EAAA,SAAAC,aAA6C,SAAWD,EAAA,SAAAE,QAA6C,SJ0B9GulG,GAAgBC,WAGpB2lD,GAAQhuC,GAERiuC,GAAa3lD,GAAUC,qBAAsBs9C,IAC7CoI,GAAa3lD,GAAUQ,WAAYs9C,IACnC6H,GAAa3lD,GAAUU,SAAU2+C,IACjCsG,GAAa3lD,GAAU/O,KAAM2vD,IAC7B+E,GAAa3lD,GAAUW,gBAAiB+gD,IACxCiE,GAAa3lD,GAAUY,OAAQkhD,IAC/B6D,GAAa3lD,GAAUc,cAAeihD,IACtC4D,GAAa3lD,GAAUe,OAAQgiD,IAC/B4C,GAAa3lD,GAAUvwB,OAAQ8zE,IAC/BoC,GAAa3lD,GAAUgB,YAAa8iD,IACpC6B,GAAa3lD,GAAUnxB,UAAWs1E,IAClCwB,GAAa3lD,GAAUmB,OAAQgkD,IAC/BQ,GAAa3lD,GAAUoB,cAAeikD,IACtCM,GAAa3lD,GAAUiB,QAASskD,IAEhCzlD,GAAgBC,UAAW,cKhC3B,IAAI4vD,EAEAC,GAAc,iBAkCHC,IACX1mF,GAAGjY,oBAAoBh0D,OAAQ,mBAAoB2yJ,GACnD,IAAI92C,EAAe,IAAI9S,GAAG6pD,aACtBnjE,EAAsB,KAC1B,IACI,MAAMitB,QAAmBb,EAAac,OAClCD,IACAjtB,EAAUitB,EAAWjtB,SAE3B,MAAM7wF,GACJ,IAAI8lC,EACc,aAAd9lC,EAAE8lC,QACFA,EAAU,mCACW,iBAAd9lC,EAAE8lC,UACTA,EAAU,0CAEVA,GACA1e,YAAW,WAEP,MADAysI,GAASA,EAAMj+B,IAAI9vF,GACb,IAAIroC,MAAM,kCAAoCuC,KACrD,eAhDU6wF,EAAqBosB,GAC1C,GAAI42C,EACA,KAAM,6CAEV,IAAII,EAAkBv0J,SAASm0H,eAAe,kBAC9C,IAEIogC,EAAgBzmF,WAAWrmD,YAAY8sI,GACzC,MAAMj0J,IAER,MAAMm9G,EAAe,IAAIhT,GAAG+pD,aAAa/7E,IAAW,GAAM,GAC1D07E,EAAQ,IAAI5J,GACRp5D,EACA,cACIssB,eACAF,IAGRE,EAAax4E,OACTksD,GACAzpE,YAAU,KACNysI,EAAMj+B,IAAI77C,GAAK,4BAChB,KAGPr6E,SAAS0oD,KAAKloD,YAAY2zJ,EAAM7rE,SA0BhCmsE,CAAgBtjE,EAASosB,GAxD7B5vC,GAAGpmD,iBAAiB7lB,OAAQ,oBAAkB,KAC1C0yJ,GAAc,WnL2FQp6E,GAAgB06E,YAAY/6E,ImLlClDy6E,EACAC,IAEA1mF,GAAGpmD,iBAAiB7lB,OAAQ,mBAAoB2yJ","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/@parcel/runtime-js/lib/runtime-27b4545d6c5c7a25.js","node_modules/@parcel/runtime-js/lib/helpers/browser/import-polyfill.js","node_modules/@parcel/runtime-js/lib/helpers/cacheLoader.js","node_modules/@parcel/runtime-js/lib/runtime-e2071b51daf153c5.js","node_modules/@parcel/runtime-js/lib/runtime-3b45ee4ddd5bae56.js","node_modules/@parcel/runtime-js/lib/runtime-54d72812370846c2.js","node_modules/@parcel/runtime-js/lib/runtime-07f1d3d9e8a93aea.js","node_modules/@parcel/runtime-js/lib/runtime-1b451964771c24c2.js","node_modules/core-js/internals/object-get-own-property-descriptor.js","node_modules/core-js/internals/global.js","node_modules/core-js/internals/descriptors.js","node_modules/core-js/internals/fails.js","node_modules/core-js/internals/function-bind-native.js","node_modules/core-js/internals/function-call.js","node_modules/core-js/internals/object-property-is-enumerable.js","node_modules/core-js/internals/create-property-descriptor.js","node_modules/core-js/internals/function-uncurry-this.js","node_modules/core-js/internals/classof-raw.js","node_modules/core-js/internals/indexed-object.js","node_modules/core-js/internals/require-object-coercible.js","node_modules/core-js/internals/to-indexed-object.js","node_modules/core-js/internals/is-callable.js","node_modules/core-js/internals/is-object.js","node_modules/core-js/internals/get-built-in.js","node_modules/core-js/internals/object-is-prototype-of.js","node_modules/core-js/internals/engine-user-agent.js","node_modules/core-js/internals/engine-v8-version.js","node_modules/core-js/internals/native-symbol.js","node_modules/core-js/internals/use-symbol-as-uid.js","node_modules/core-js/internals/is-symbol.js","node_modules/core-js/internals/try-to-string.js","node_modules/core-js/internals/a-callable.js","node_modules/core-js/internals/get-method.js","node_modules/core-js/internals/ordinary-to-primitive.js","node_modules/core-js/internals/set-global.js","node_modules/core-js/internals/shared-store.js","node_modules/core-js/internals/shared.js","node_modules/core-js/internals/to-object.js","node_modules/core-js/internals/has-own-property.js","node_modules/core-js/internals/uid.js","node_modules/core-js/internals/well-known-symbol.js","node_modules/core-js/internals/to-primitive.js","node_modules/core-js/internals/to-property-key.js","node_modules/core-js/internals/document-create-element.js","node_modules/core-js/internals/ie8-dom-define.js","node_modules/core-js/internals/object-define-property.js","node_modules/core-js/internals/v8-prototype-define-bug.js","node_modules/core-js/internals/an-object.js","node_modules/core-js/internals/create-non-enumerable-property.js","node_modules/core-js/internals/inspect-source.js","node_modules/core-js/internals/native-weak-map.js","node_modules/core-js/internals/shared-key.js","node_modules/core-js/internals/hidden-keys.js","node_modules/core-js/internals/internal-state.js","node_modules/core-js/internals/function-name.js","node_modules/core-js/internals/redefine.js","node_modules/core-js/internals/object-get-own-property-names.js","node_modules/core-js/internals/to-integer-or-infinity.js","node_modules/core-js/internals/to-absolute-index.js","node_modules/core-js/internals/to-length.js","node_modules/core-js/internals/length-of-array-like.js","node_modules/core-js/internals/array-includes.js","node_modules/core-js/internals/object-keys-internal.js","node_modules/core-js/internals/object-get-own-property-symbols.js","node_modules/core-js/internals/enum-bug-keys.js","node_modules/core-js/internals/own-keys.js","node_modules/core-js/internals/copy-constructor-properties.js","node_modules/core-js/internals/is-forced.js","node_modules/core-js/internals/export.js","node_modules/core-js/internals/to-string-tag-support.js","node_modules/core-js/internals/classof.js","node_modules/core-js/internals/to-string.js","node_modules/core-js/modules/es.symbol.description.js","node_modules/core-js/internals/well-known-symbol-wrapped.js","node_modules/core-js/internals/path.js","node_modules/core-js/internals/define-well-known-symbol.js","node_modules/core-js/modules/es.symbol.async-iterator.js","node_modules/core-js/internals/is-array.js","node_modules/core-js/internals/function-bind-context.js","node_modules/core-js/internals/flatten-into-array.js","node_modules/core-js/internals/is-constructor.js","node_modules/core-js/internals/array-species-constructor.js","node_modules/core-js/internals/array-species-create.js","node_modules/core-js/modules/es.array.flat.js","node_modules/core-js/modules/es.array.flat-map.js","node_modules/core-js/internals/object-define-properties.js","node_modules/core-js/internals/object-keys.js","node_modules/core-js/internals/html.js","node_modules/core-js/internals/object-create.js","node_modules/core-js/internals/add-to-unscopables.js","node_modules/core-js/internals/iterators.js","node_modules/core-js/modules/es.array.iterator.js","node_modules/core-js/internals/correct-prototype-getter.js","node_modules/core-js/internals/object-get-prototype-of.js","node_modules/core-js/internals/iterators-core.js","node_modules/core-js/internals/create-iterator-constructor.js","node_modules/core-js/internals/set-to-string-tag.js","node_modules/core-js/internals/a-possible-prototype.js","node_modules/core-js/internals/object-set-prototype-of.js","node_modules/core-js/internals/define-iterator.js","node_modules/core-js/internals/array-reduce.js","node_modules/core-js/modules/es.array.reduce.js","node_modules/core-js/internals/array-method-is-strict.js","node_modules/core-js/internals/engine-is-node.js","node_modules/core-js/modules/es.array.reduce-right.js","node_modules/core-js/internals/create-property.js","node_modules/core-js/internals/array-slice-simple.js","node_modules/core-js/internals/array-sort.js","node_modules/core-js/internals/engine-ff-version.js","node_modules/core-js/internals/engine-is-ie-or-edge.js","node_modules/core-js/internals/engine-webkit-version.js","node_modules/core-js/modules/es.array.sort.js","node_modules/core-js/modules/es.array.unscopables.flat.js","node_modules/core-js/modules/es.array.unscopables.flat-map.js","node_modules/core-js/modules/es.math.hypot.js","node_modules/core-js/internals/object-prototype-accessors-forced.js","node_modules/core-js/modules/es.object.define-getter.js","node_modules/core-js/modules/es.object.define-setter.js","node_modules/core-js/internals/is-array-iterator-method.js","node_modules/core-js/internals/get-iterator-method.js","node_modules/core-js/internals/get-iterator.js","node_modules/core-js/internals/iterator-close.js","node_modules/core-js/internals/iterate.js","node_modules/core-js/modules/es.object.from-entries.js","node_modules/core-js/modules/es.object.lookup-getter.js","node_modules/core-js/modules/es.object.lookup-setter.js","node_modules/core-js/internals/native-promise-constructor.js","node_modules/core-js/internals/redefine-all.js","node_modules/core-js/internals/set-species.js","node_modules/core-js/internals/an-instance.js","node_modules/core-js/internals/check-correctness-of-iteration.js","node_modules/core-js/internals/a-constructor.js","node_modules/core-js/internals/species-constructor.js","node_modules/core-js/internals/function-apply.js","node_modules/core-js/internals/array-slice.js","node_modules/core-js/internals/engine-is-ios.js","node_modules/core-js/internals/task.js","node_modules/core-js/modules/es.promise.js","node_modules/core-js/internals/microtask.js","node_modules/core-js/internals/engine-is-ios-pebble.js","node_modules/core-js/internals/engine-is-webos-webkit.js","node_modules/core-js/internals/new-promise-capability.js","node_modules/core-js/internals/promise-resolve.js","node_modules/core-js/internals/host-report-errors.js","node_modules/core-js/internals/perform.js","node_modules/core-js/internals/queue.js","node_modules/core-js/internals/engine-is-browser.js","node_modules/core-js/modules/es.promise.finally.js","node_modules/core-js/internals/regexp-flags.js","node_modules/core-js/internals/regexp-sticky-helpers.js","node_modules/core-js/internals/regexp-exec.js","node_modules/core-js/internals/regexp-unsupported-dot-all.js","node_modules/core-js/internals/regexp-unsupported-ncg.js","node_modules/core-js/modules/es.regexp.exec.js","node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js","node_modules/core-js/internals/string-multibyte.js","node_modules/core-js/internals/advance-string-index.js","node_modules/core-js/internals/get-substitution.js","node_modules/core-js/internals/regexp-exec-abstract.js","node_modules/core-js/modules/es.string.replace.js","node_modules/core-js/internals/string-trim.js","node_modules/core-js/modules/es.string.trim-end.js","node_modules/core-js/internals/string-trim-forced.js","node_modules/core-js/internals/whitespaces.js","node_modules/core-js/modules/es.string.trim-start.js","node_modules/core-js/internals/array-buffer-native.js","node_modules/core-js/internals/array-buffer-view-core.js","node_modules/core-js/internals/typed-array-constructors-require-wrappers.js","node_modules/core-js/internals/to-index.js","node_modules/core-js/internals/ieee754.js","node_modules/core-js/internals/array-buffer.js","node_modules/core-js/internals/array-fill.js","node_modules/core-js/internals/is-integral-number.js","node_modules/core-js/internals/to-positive-integer.js","node_modules/core-js/internals/to-offset.js","node_modules/core-js/internals/typed-array-constructor.js","node_modules/core-js/internals/typed-array-from.js","node_modules/core-js/internals/array-iteration.js","node_modules/core-js/internals/inherit-if-required.js","node_modules/core-js/modules/es.typed-array.float32-array.js","node_modules/core-js/modules/es.typed-array.float64-array.js","node_modules/core-js/modules/es.typed-array.int8-array.js","node_modules/core-js/modules/es.typed-array.int16-array.js","node_modules/core-js/modules/es.typed-array.int32-array.js","node_modules/core-js/modules/es.typed-array.uint8-array.js","node_modules/core-js/modules/es.typed-array.uint8-clamped-array.js","node_modules/core-js/modules/es.typed-array.uint16-array.js","node_modules/core-js/modules/es.typed-array.uint32-array.js","node_modules/core-js/modules/es.typed-array.from.js","node_modules/core-js/modules/es.typed-array.of.js","node_modules/core-js/internals/clear-error-stack.js","node_modules/core-js/internals/install-error-cause.js","node_modules/core-js/internals/normalize-string-argument.js","node_modules/core-js/internals/error-stack-installable.js","node_modules/core-js/modules/es.aggregate-error.js","node_modules/core-js/modules/esnext.array.last-index.js","node_modules/core-js/modules/esnext.array.last-item.js","node_modules/core-js/internals/object-get-own-property-names-external.js","node_modules/core-js/internals/internal-metadata.js","node_modules/core-js/internals/array-buffer-non-extensible.js","node_modules/core-js/internals/object-is-extensible.js","node_modules/core-js/internals/freezing.js","node_modules/core-js/internals/collection.js","node_modules/core-js/internals/collection-strong.js","node_modules/core-js/modules/es.map.js","node_modules/core-js/internals/collection-weak.js","node_modules/core-js/modules/es.weak-map.js","node_modules/core-js/internals/composite-key.js","node_modules/core-js/modules/esnext.composite-key.js","node_modules/core-js/modules/esnext.composite-symbol.js","node_modules/core-js/modules/es.global-this.js","node_modules/core-js/modules/esnext.map.delete-all.js","node_modules/core-js/internals/is-pure.js","node_modules/core-js/internals/collection-delete-all.js","node_modules/core-js/internals/get-map-iterator.js","node_modules/core-js/modules/esnext.map.every.js","node_modules/core-js/modules/esnext.map.filter.js","node_modules/core-js/modules/esnext.map.find.js","node_modules/core-js/modules/esnext.map.find-key.js","node_modules/core-js/internals/collection-from.js","node_modules/core-js/modules/esnext.map.from.js","node_modules/core-js/modules/esnext.map.group-by.js","node_modules/core-js/internals/same-value-zero.js","node_modules/core-js/modules/esnext.map.includes.js","node_modules/core-js/modules/esnext.map.key-by.js","node_modules/core-js/modules/esnext.map.key-of.js","node_modules/core-js/modules/esnext.map.map-keys.js","node_modules/core-js/modules/esnext.map.map-values.js","node_modules/core-js/modules/esnext.map.merge.js","node_modules/core-js/modules/esnext.map.of.js","node_modules/core-js/internals/collection-of.js","node_modules/core-js/modules/esnext.map.reduce.js","node_modules/core-js/modules/esnext.map.some.js","node_modules/core-js/modules/esnext.map.update.js","node_modules/core-js/modules/esnext.math.clamp.js","node_modules/core-js/modules/esnext.math.deg-per-rad.js","node_modules/core-js/modules/esnext.math.degrees.js","node_modules/core-js/internals/math-scale.js","node_modules/core-js/internals/math-sign.js","node_modules/core-js/internals/math-fround.js","node_modules/core-js/modules/esnext.math.fscale.js","node_modules/core-js/modules/esnext.math.iaddh.js","node_modules/core-js/modules/esnext.math.imulh.js","node_modules/core-js/modules/esnext.math.isubh.js","node_modules/core-js/modules/esnext.math.rad-per-deg.js","node_modules/core-js/modules/esnext.math.radians.js","node_modules/core-js/modules/esnext.math.scale.js","node_modules/core-js/internals/number-is-finite.js","node_modules/core-js/modules/esnext.math.seeded-prng.js","node_modules/core-js/modules/esnext.math.signbit.js","node_modules/core-js/modules/esnext.math.umulh.js","node_modules/core-js/internals/number-parse-int.js","node_modules/core-js/modules/esnext.number.from-string.js","node_modules/core-js/modules/esnext.observable.js","node_modules/core-js/modules/es.promise.all-settled.js","node_modules/core-js/modules/es.promise.any.js","node_modules/core-js/modules/esnext.promise.try.js","node_modules/core-js/internals/reflect-metadata.js","node_modules/core-js/modules/esnext.reflect.define-metadata.js","node_modules/core-js/modules/esnext.reflect.delete-metadata.js","node_modules/core-js/modules/esnext.reflect.get-metadata.js","node_modules/core-js/internals/array-unique-by.js","node_modules/core-js/modules/esnext.reflect.get-metadata-keys.js","node_modules/core-js/modules/esnext.reflect.get-own-metadata.js","node_modules/core-js/modules/esnext.reflect.get-own-metadata-keys.js","node_modules/core-js/modules/esnext.reflect.has-metadata.js","node_modules/core-js/modules/esnext.reflect.has-own-metadata.js","node_modules/core-js/modules/esnext.reflect.metadata.js","node_modules/core-js/modules/esnext.set.add-all.js","node_modules/core-js/internals/collection-add-all.js","node_modules/core-js/modules/esnext.set.delete-all.js","node_modules/core-js/modules/esnext.set.difference.js","node_modules/core-js/internals/get-set-iterator.js","node_modules/core-js/modules/esnext.set.every.js","node_modules/core-js/modules/esnext.set.filter.js","node_modules/core-js/modules/esnext.set.find.js","node_modules/core-js/modules/esnext.set.from.js","node_modules/core-js/modules/esnext.set.intersection.js","node_modules/core-js/modules/esnext.set.is-disjoint-from.js","node_modules/core-js/modules/esnext.set.is-subset-of.js","node_modules/core-js/modules/esnext.set.is-superset-of.js","node_modules/core-js/modules/esnext.set.join.js","node_modules/core-js/modules/esnext.set.map.js","node_modules/core-js/modules/esnext.set.of.js","node_modules/core-js/modules/esnext.set.reduce.js","node_modules/core-js/modules/esnext.set.some.js","node_modules/core-js/modules/esnext.set.symmetric-difference.js","node_modules/core-js/modules/esnext.set.union.js","node_modules/core-js/modules/esnext.string.at.js","node_modules/core-js/modules/esnext.string.code-points.js","node_modules/core-js/internals/is-regexp.js","node_modules/core-js/modules/es.string.match-all.js","node_modules/core-js/modules/es.string.replace-all.js","node_modules/core-js/modules/esnext.symbol.dispose.js","node_modules/core-js/modules/esnext.symbol.observable.js","node_modules/core-js/modules/esnext.symbol.pattern-match.js","node_modules/core-js/modules/esnext.weak-map.delete-all.js","node_modules/core-js/modules/esnext.weak-map.from.js","node_modules/core-js/modules/esnext.weak-map.of.js","node_modules/core-js/modules/esnext.weak-set.add-all.js","node_modules/core-js/modules/esnext.weak-set.delete-all.js","node_modules/core-js/modules/esnext.weak-set.from.js","node_modules/core-js/modules/esnext.weak-set.of.js","node_modules/core-js/internals/dom-iterables.js","node_modules/core-js/internals/dom-token-list-prototype.js","node_modules/core-js/modules/web.dom-collections.iterator.js","node_modules/core-js/modules/web.immediate.js","node_modules/core-js/modules/web.queue-microtask.js","node_modules/core-js/modules/es.string.iterator.js","node_modules/core-js/internals/native-url.js","node_modules/core-js/modules/web.url.js","node_modules/core-js/internals/object-assign.js","node_modules/core-js/internals/call-with-safe-iteration-closing.js","node_modules/core-js/internals/array-from.js","node_modules/core-js/internals/string-punycode-to-ascii.js","node_modules/core-js/internals/validate-arguments-length.js","node_modules/core-js/modules/web.url-search-params.js","src/app/script/polyfills.ts","node_modules/core-js/modules/web.url.to-json.js","node_modules/mdn-polyfills/Node.prototype.append.js","src/app/script/bb/base/create-canvas.ts","src/app/script/bb/base/browser.ts","src/app/script/bb/input/event-listener.ts","src/app/script/bb/base/base.ts","src/app/script/bb/input/key-listener.ts","src/app/script/bb/math/math.ts","src/app/script/bb/input/pointer-listener.ts","src/app/script/bb/input/event-chain.ts","src/app/script/bb/base/canvas.ts","src/app/script/bb/math/matrix.ts","src/app/script/bb/math/vec2.ts","src/app/script/bb/math/line.ts","src/app/script/bb/color/color.ts","src/app/script/bb/base/ui.ts","src/app/script/bb/base/bb-log.ts","src/app/script/bb/base/local-storage.ts","src/app/script/bb/bb.ts","src/app/script/klecks/history/kl-history.ts","src/app/script/klecks/ui/modals/modal-count.ts","node_modules/@parcel/runtime-js/lib/runtime-0f552af82fdb3b1a.js","node_modules/@parcel/runtime-js/lib/runtime-341cc8a118b2d125.js","src/app/languages/languages.ts","src/app/languages/en.json","src/app/script/language/language.ts","src/app/script/klecks/ui/modals/popup.ts","src/app/script/klecks/ui/base-components/checkbox.ts","src/app/script/klecks/ui/base-components/input.ts","src/app/script/klecks/ui/base-components/select.ts","src/app/script/klecks/ui/base-components/image-toggle.ts","src/app/script/klecks/ui/base-components/image-radio-list.ts","node_modules/@parcel/runtime-js/lib/runtime-5d6ebfd9efdfc190.js","src/app/script/klecks/ui/base-components/pen-pressure-toggle.ts","src/app/script/klecks/ui/base-components/slider-falloff.ts","src/app/script/klecks/ui/base-components/kl-slider.ts","node_modules/@parcel/runtime-js/lib/runtime-65e106cb46a298db.js","src/app/script/klecks/ui/modals/color-slider-hex-dialog.ts","node_modules/@parcel/runtime-js/lib/runtime-9cac46cb40765b3a.js","src/app/script/klecks/ui/base-components/kl-color-slider.ts","src/app/script/klecks/ui/base-components/kl-color-slider-small.ts","src/app/script/klecks/ui/base-components/point-slider.ts","src/app/script/klecks/ui/base-components/color-options.ts","src/app/script/klecks/ui/base-components/options.ts","node_modules/@parcel/runtime-js/lib/runtime-8e4b4290e90a50a8.js","src/app/script/klecks/ui/components/crop-copy.ts","node_modules/@parcel/runtime-js/lib/runtime-840d362d839ef6d0.js","node_modules/@parcel/runtime-js/lib/runtime-7b76ecf6acf5e9a3.js","node_modules/@parcel/runtime-js/lib/runtime-48535fffdb44ce9f.js","node_modules/@parcel/runtime-js/lib/runtime-49ff5d514e8b9d11.js","src/app/script/klecks/image-operations/flood-fill.ts","src/app/script/klecks/image-operations/shape-tool.ts","src/app/script/klecks/image-operations/render-text.ts","src/app/script/klecks/canvas/draw-project.ts","node_modules/@parcel/runtime-js/lib/runtime-1c564e9d9efbe0e4.js","src/app/script/klecks/canvas/kl-canvas.ts","src/app/script/klecks/canvas/translate-blending.ts","src/app/script/klecks/canvas-ui/workspace-svg-overlay.ts","node_modules/@parcel/runtime-js/lib/runtime-4bb3bbae63f77564.js","node_modules/@parcel/runtime-js/lib/runtime-8af8d0096b7c09ed.js","node_modules/@parcel/runtime-js/lib/runtime-864b74dd25ee463c.js","node_modules/@parcel/runtime-js/lib/runtime-238defd245609b49.js","src/app/script/klecks/canvas-ui/kl-canvas-workspace.ts","src/app/script/klecks/canvas-ui/canvas-preview.ts","src/app/script/klecks/ui/components/free-transform.ts","node_modules/@parcel/runtime-js/lib/runtime-e5b3f296fc1c13d5.js","src/app/script/klecks/ui/components/free-transform-canvas.ts","src/app/script/klecks/ui/components/cropper.ts","node_modules/@parcel/runtime-js/lib/runtime-b08bdf7b6fd7bad3.js","node_modules/@parcel/runtime-js/lib/runtime-f5164c8228caf500.js","node_modules/@parcel/runtime-js/lib/runtime-349f9148ac29bbef.js","node_modules/@parcel/runtime-js/lib/runtime-d4fbf127a26d1fc5.js","node_modules/@parcel/runtime-js/lib/runtime-3ce45808cae440d4.js","node_modules/@parcel/runtime-js/lib/runtime-fafcb78fa42eb2b1.js","node_modules/@parcel/runtime-js/lib/runtime-b5f107da03e289f0.js","node_modules/@parcel/runtime-js/lib/runtime-1c8e8fe7ff2ba7c8.js","node_modules/@parcel/runtime-js/lib/runtime-6ece0fa7ee906a7e.js","node_modules/@parcel/runtime-js/lib/runtime-daaf667efc6ef5af.js","src/app/script/klecks/ui/components/tool-dropdown.ts","node_modules/@parcel/runtime-js/lib/runtime-92a061557df3a9bb.js","node_modules/@parcel/runtime-js/lib/runtime-120b3551816326b7.js","node_modules/@parcel/runtime-js/lib/runtime-69d4adc76a185434.js","node_modules/@parcel/runtime-js/lib/runtime-f3d9c1aeef7b1775.js","node_modules/@parcel/runtime-js/lib/runtime-68b97118ad565b5e.js","node_modules/@parcel/runtime-js/lib/runtime-ff1a4a16eee51754.js","node_modules/@parcel/runtime-js/lib/runtime-ec10848cb6b4e705.js","node_modules/@parcel/runtime-js/lib/runtime-a38db5c800b2448e.js","node_modules/@parcel/runtime-js/lib/runtime-0d137efdc0b3ff37.js","node_modules/@parcel/runtime-js/lib/runtime-b8f340fb31f21579.js","node_modules/@parcel/runtime-js/lib/runtime-a7ae0e6c4cfa23c6.js","node_modules/@parcel/runtime-js/lib/runtime-e276f4f7fb7a184f.js","node_modules/@parcel/runtime-js/lib/runtime-68fbe4d873eb7a0f.js","src/app/script/klecks/storage/psd.ts","src/app/script/klecks/storage/indexed-db.ts","node_modules/@parcel/runtime-js/lib/runtime-f676816018c61fad.js","node_modules/@parcel/runtime-js/lib/runtime-9936408b71f1f78e.js","node_modules/@parcel/runtime-js/lib/runtime-34db0290c13f39d7.js","node_modules/@parcel/runtime-js/lib/runtime-92876a18e5e1ead4.js","node_modules/@parcel/runtime-js/lib/runtime-370d914a2e1e0fb4.js","node_modules/@parcel/runtime-js/lib/runtime-498716c4061b4fad.js","node_modules/@parcel/runtime-js/lib/runtime-e70829fe07fe02e9.js","node_modules/@parcel/runtime-js/lib/runtime-80ec9c19201b9f9b.js","node_modules/@parcel/runtime-js/lib/runtime-f6fca33214805f6a.js","node_modules/@parcel/runtime-js/lib/runtime-86cb52991c85facc.js","node_modules/@parcel/runtime-js/lib/runtime-8d672c38b08291d4.js","node_modules/@parcel/runtime-js/lib/runtime-4066c86ec2d4f080.js","node_modules/@parcel/runtime-js/lib/runtime-07fee30ea4c66c9c.js","src/app/script/klecks/filters/filters.ts","src/app/script/bb/math/perlin.ts","src/app/script/klecks/brushes/alphas/brush-alphas.ts","src/app/script/klecks/brushes/brushes-common.ts","src/app/script/klecks/brushes/blend-brush.ts","src/app/script/klecks/brushes/sketchy-brush.ts","src/app/script/klecks/brushes/smudge-brush.ts","src/app/script/klecks/brushes/brushes.ts","src/app/script/klecks/brushes/pen-brush.ts","src/app/script/klecks/brushes/pixel-brush.ts","src/app/script/klecks/brushes/chemy-brush.ts","src/app/script/klecks/brushes/eraser-brush.ts","node_modules/@parcel/runtime-js/lib/runtime-b4ccd3f45aaa87b6.js","src/app/script/klecks/brushes-ui/pen-brush-ui.ts","src/app/script/klecks/brushes-ui/brushes-consts.ts","node_modules/@parcel/runtime-js/lib/runtime-52b1652f427bed37.js","src/app/script/klecks/brushes-ui/blend-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-f229e6bd24983f2d.js","src/app/script/klecks/brushes-ui/sketchy-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-00f38a760aef508f.js","src/app/script/klecks/brushes-ui/pixel-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-ce7eca9f9b4bb5d5.js","src/app/script/klecks/brushes-ui/eraser-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-2ab58ecd623efad0.js","src/app/script/klecks/brushes-ui/smudge-brush-ui.ts","node_modules/@parcel/runtime-js/lib/runtime-35aa419fca3b4010.js","src/app/script/klecks/ui/base-components/box-toggle.ts","src/app/script/klecks/brushes-ui/chemy-brush-ui.ts","src/app/script/klecks/brushes-ui/brushes-ui.ts","src/app/script/klecks/ui/modals/show-iframe-popup.ts","src/app/script/klecks/ui/components/browser-storage-ui.ts","src/app/script/klecks/storage/base-64-to-blob.ts","src/app/script/klecks/storage/project-converter.ts","src/app/script/klecks/storage/project-store.ts","src/app/script/klecks/storage/ag-psd-wrapper.ts","node_modules/@parcel/runtime-js/lib/runtime-d5a221419ce09b33.js","node_modules/file-saver/src/FileSaver.js","src/app/script/klecks/brushes-ui/brush-setting-service.ts","node_modules/@parcel/runtime-js/lib/runtime-0c2baa19c7a3bdda.js","node_modules/@parcel/runtime-js/lib/runtime-d0cd43e68812cdc4.js","src/app/script/klecks/kl.ts","src/app/script/klecks/history/undo-redo-catchup.ts","src/app/script/klecks/storage/save-to-computer.ts","src/app/script/klecks/ui/base-components/radio-list.ts","src/app/script/klecks/ui/components/status-overlay.ts","src/app/script/klecks/ui/components/layer-preview.ts","src/app/script/klecks/ui/components/show-reminder-toast.ts","src/app/script/klecks/ui/components/fitted-image.ts","src/app/script/klecks/ui/components/kl-image-dropper.ts","src/app/script/klecks/ui/components/overlay-toolspace.ts","src/app/script/klecks/ui/components/toolspace-top-row.ts","src/app/script/klecks/ui/components/toolspace-tool-row.ts","src/app/script/klecks/ui/components/toolspace-stabilizer-row.ts","src/app/script/klecks/ui/components/tab-row.ts","src/app/script/klecks/ui/components/toolspace-collapser.ts","src/app/script/klecks/ui/components/save-reminder.ts","src/app/script/klecks/ui/components/toolspace-scroller.ts","src/app/script/klecks/ui/modals/export-dialog-deprecated.ts","src/app/script/klecks/ui/modals/clipboard-dialog.ts","src/app/script/klecks/ui/modals/show-import-as-layer-dialog.ts","src/app/script/klecks/ui/modals/new-image-dialog.ts","src/app/script/klecks/ui/modals/text-tool-dialog.ts","src/app/script/klecks/ui/modals/show-import-image-dialog.ts","src/app/script/klecks/ui/modals/imgur-upload.ts","src/app/script/klecks/ui/tool-tabs/hand-ui.ts","src/app/script/klecks/ui/tool-tabs/fill-ui.ts","src/app/script/klecks/ui/tool-tabs/text-ui.ts","src/app/script/klecks/ui/tool-tabs/shape-ui.ts","src/app/script/klecks/ui/tool-tabs/file-tab.ts","src/app/script/klecks/ui/tool-tabs/filter-tab.ts","src/app/script/klecks/ui/tool-tabs/settings-tab.ts","src/app/script/klecks/ui/tool-tabs/kl-layer-manager.ts","src/app/script/embed/toolspace-top-row.ts","src/app/script/klecks/filters/filters-consts.ts","src/app/script-vendor/glfx.ts","src/app/script/klecks/filters/shared-gl-fx.ts","src/app/script/klecks/filters/gl-brightness-contrast.ts","src/app/script/klecks/filters/crop-extend.ts","src/app/script/klecks/filters/gl-curves.ts","node_modules/@parcel/runtime-js/lib/runtime-8619104484d232df.js","src/app/script/klecks/filters/flip.ts","src/app/script/klecks/filters/gl-hue-saturation.ts","src/app/script/klecks/filters/invert.ts","src/app/script/klecks/filters/gl-perspective.ts","node_modules/@parcel/runtime-js/lib/runtime-0ba4f54b5b7226a1.js","src/app/script/klecks/filters/resize.ts","src/app/script/klecks/filters/rotate.ts","src/app/script/klecks/filters/gl-tilt-shift.ts","src/app/script/klecks/filters/transform.ts","src/app/script/klecks/filters/gl-blur.ts","src/app/script/klecks/filters/gl-unsharp-mask.ts","src/app/script/klecks/filters/to-alpha.ts","src/app/script/klecks/filters/filters-lazy.ts","node_modules/@parcel/runtime-js/lib/runtime-53efa941ea7e6246.js","src/app/script/app/kl-app.ts","src/app/script/klecks/storage/kl-canvas-to-psd-blob.ts","node_modules/@parcel/runtime-js/lib/runtime-964b62644035ccde.js","src/app/script/main-standalone.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","\"use strict\";\n\nvar bundleURL = {};\n\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n\n  return value;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","module.exports = (require(\"./helpers/browser/import-polyfill\")(require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"6OT74\"))).then(() => parcelRequire('11sRX'));","\"use strict\";\n\nvar cacheLoader = require('../cacheLoader');\n\nmodule.exports = cacheLoader(function (bundle) {\n  return new Promise(function (resolve, reject) {\n    // Add a global function to handle when the script loads.\n    var globalName = \"i\".concat(('' + Math.random()).slice(2));\n\n    global[globalName] = function (m) {\n      resolve(m);\n      cleanup();\n    }; // Remove script on load or error\n\n\n    var cleanup = function () {\n      delete global[globalName];\n      script.onerror = null;\n      script.remove();\n    }; // Append an inline script tag into the document head\n\n\n    var script = document.createElement('script');\n    script.async = true;\n    script.type = 'module';\n    script.charset = 'utf-8';\n    script.textContent = \"import * as m from '\".concat(bundle, \"'; \").concat(globalName, \"(m);\");\n\n    script.onerror = function (e) {\n      reject(e);\n      cleanup();\n    };\n\n    document.head.appendChild(script);\n  });\n});","\"use strict\";\n\nvar cachedBundles = {};\nvar cachedPreloads = {};\nvar cachedPrefetches = {};\n\nfunction getCache(type) {\n  switch (type) {\n    case 'preload':\n      return cachedPreloads;\n\n    case 'prefetch':\n      return cachedPrefetches;\n\n    default:\n      return cachedBundles;\n  }\n}\n\nmodule.exports = function (loader, type) {\n  return function (bundle) {\n    var cache = getCache(type);\n\n    if (cache[bundle]) {\n      return cache[bundle];\n    }\n\n    return cache[bundle] = loader.apply(null, arguments).catch(function (e) {\n      delete cache[bundle];\n      throw e;\n    });\n  };\n};","module.exports = (require(\"./helpers/browser/import-polyfill\")(require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"hUIiR\"))).then(() => parcelRequire('2BQEx'));","module.exports = (require(\"./helpers/browser/import-polyfill\")(require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"eiNJp\"))).then(() => parcelRequire('2C9ch'));","module.exports = (require(\"./helpers/browser/import-polyfill\")(require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"4tKUq\"))).then(() => parcelRequire('duojR'));","module.exports = (require(\"./helpers/browser/import-polyfill\")(require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"78RX7\"))).then(() => parcelRequire('aeoOn'));","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"lrLBb\\\":\\\"index.8b095a55.js\\\",\\\"iDK6N\\\":\\\"check.8d706b11.svg\\\",\\\"8gElo\\\":\\\"cancel.17aa34ea.svg\\\",\\\"6OT74\\\":\\\"de.34f83aa6.js\\\",\\\"hUIiR\\\":\\\"ja.02b6624e.js\\\",\\\"eiNJp\\\":\\\"zh-CN.6f3b125f.js\\\",\\\"kav7s\\\":\\\"brush-pressure.f4437531.svg\\\",\\\"43nfB\\\":\\\"copy.4adadd0c.svg\\\",\\\"9Vqzx\\\":\\\"tool-picker.d0e69c3a.svg\\\",\\\"vALcr\\\":\\\"angle.f0b557ac.svg\\\",\\\"gShQZ\\\":\\\"add-layer.ce1078bb.svg\\\",\\\"ldqtT\\\":\\\"duplicate-layer.3314e3c7.svg\\\",\\\"apAfQ\\\":\\\"merge-layers.19da79a6.svg\\\",\\\"dpNT8\\\":\\\"remove-layer.4e9b2b7d.svg\\\",\\\"5E29d\\\":\\\"rename-layer.13b70bac.svg\\\",\\\"6rWqS\\\":\\\"cursor-picker.db2f5b39.png\\\",\\\"5mHop\\\":\\\"cursor-zoom-ew.fbb85406.png\\\",\\\"gy6aj\\\":\\\"cursor-fill.8027a243.png\\\",\\\"9SVhx\\\":\\\"cursor-text.dcaa5de5.png\\\",\\\"8BBCz\\\":\\\"cursor-rotate.5b164044.png\\\",\\\"g2W7q\\\":\\\"klecks-logo.802fb0cc.png\\\",\\\"7SFt9\\\":\\\"new-image.09cdcd80.svg\\\",\\\"2Vvkk\\\":\\\"import.7a68c844.svg\\\",\\\"1zJpX\\\":\\\"export.bc31616f.svg\\\",\\\"9cKp0\\\":\\\"share.454898d1.svg\\\",\\\"3iiTs\\\":\\\"help.208e9032.svg\\\",\\\"gGmfI\\\":\\\"tool-paint.6cdb3344.svg\\\",\\\"67aEJ\\\":\\\"tool-fill.3358320a.svg\\\",\\\"a2j2Q\\\":\\\"tool-text.1cbd0325.svg\\\",\\\"gZhDT\\\":\\\"tool-shape.3de78c3f.svg\\\",\\\"48B5J\\\":\\\"caret-down.68d4cd16.svg\\\",\\\"ksMx1\\\":\\\"tool-hand.e7fc81b9.svg\\\",\\\"bReTA\\\":\\\"tool-zoom-in.d413f042.svg\\\",\\\"i3X7V\\\":\\\"tool-zoom-out.299f4d1f.svg\\\",\\\"j4HZO\\\":\\\"tool-undo.540bf765.svg\\\",\\\"jItzQ\\\":\\\"inverted-border.3353c7f3.svg\\\",\\\"ea7ga\\\":\\\"edit-rotate.fd0e572a.svg\\\",\\\"gNPQL\\\":\\\"ui-collapse.2b5dfc6a.svg\\\",\\\"9Mrdl\\\":\\\"align-left.4876a845.svg\\\",\\\"jc4S8\\\":\\\"align-center.6f56d4bd.svg\\\",\\\"cgtA2\\\":\\\"align-right.1521d61c.svg\\\",\\\"erfrN\\\":\\\"typo-italic.39f02a8d.svg\\\",\\\"kdJe6\\\":\\\"typo-bold.8156fef3.svg\\\",\\\"gJYYq\\\":\\\"edit-brightness-contrast.8430cb26.svg\\\",\\\"25BJB\\\":\\\"edit-crop.16c534dd.svg\\\",\\\"fDGND\\\":\\\"edit-curves.bbdb97b2.svg\\\",\\\"8f0bW\\\":\\\"edit-flip.00fd2c6b.svg\\\",\\\"fAhTF\\\":\\\"edit-hue-saturation.c9c1c847.svg\\\",\\\"lTNVM\\\":\\\"edit-invert.fa435c66.png\\\",\\\"2mMxs\\\":\\\"edit-perspective.e23100db.svg\\\",\\\"lkhcY\\\":\\\"edit-resize.56391e2b.svg\\\",\\\"c9hFy\\\":\\\"edit-tilt-shift.dd20efff.png\\\",\\\"297B8\\\":\\\"edit-to-alpha.f7a2065a.svg\\\",\\\"jxtUn\\\":\\\"edit-transform.c8795430.svg\\\",\\\"lfC0f\\\":\\\"edit-triangle-blur.9df2dbef.png\\\",\\\"cDstS\\\":\\\"edit-unsharp-mask.c58e988c.png\\\",\\\"efRnq\\\":\\\"brush-pen.49a7b91e.svg\\\",\\\"lGY8s\\\":\\\"brush-blend.2b9837fa.svg\\\",\\\"jDXzO\\\":\\\"brush-sketchy.9e5d0120.png\\\",\\\"hkoNI\\\":\\\"brush-pixel.673f3e4c.svg\\\",\\\"baIZM\\\":\\\"brush-eraser.a9e10dce.svg\\\",\\\"91Av5\\\":\\\"brush-smudge.45852bcd.svg\\\",\\\"aI6cE\\\":\\\"brush-chemy.a5a188f6.svg\\\",\\\"28TVy\\\":\\\"loading.7ff8a2ac.gif\\\",\\\"4tKUq\\\":\\\"dist.f610cf07.js\\\",\\\"8EUal\\\":\\\"bitbof-logo.bc5e3ed5.svg\\\",\\\"lQWO9\\\":\\\"ui-swap-lr.7f474f51.svg\\\",\\\"78RX7\\\":\\\"licenses.e4375971.js\\\",\\\"grSoY\\\":\\\"checkmark.5cb0764b.svg\\\",\\\"2xc61\\\":\\\"constrain.62f04e45.svg\\\",\\\"gXLuy\\\":\\\"tab-settings.1f52740e.svg\\\",\\\"ll6eH\\\":\\\"tab-layers.c8a104e7.svg\\\"}\"));","var DESCRIPTORS = require('../internals/descriptors');\nvar call = require('../internals/function-call');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","var fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar bind = FunctionPrototype.bind;\nvar call = FunctionPrototype.call;\nvar uncurryThis = NATIVE_BIND && bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? function (fn) {\n  return fn && uncurryThis(fn);\n} : function (fn) {\n  return fn && function () {\n    return call.apply(fn, arguments);\n  };\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n","var global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar Object = global.Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split(it, '') : Object(it);\n} : Object;\n","var global = require('../internals/global');\n\nvar TypeError = global.TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = function (argument) {\n  return typeof argument == 'function';\n};\n","var isCallable = require('../internals/is-callable');\n\nmodule.exports = function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n","/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/engine-v8-version');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","var global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar Object = global.Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, Object(it));\n};\n","var global = require('../internals/global');\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  try {\n    return String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar tryToString = require('../internals/try-to-string');\n\nvar TypeError = global.TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a function');\n};\n","var aCallable = require('../internals/a-callable');\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return func == null ? undefined : aCallable(func);\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\n\nvar TypeError = global.TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var global = require('../internals/global');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.20.3',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2014-2022 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n","var global = require('../internals/global');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar Object = global.Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar hasOwn = require('../internals/has-own-property');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar symbolFor = Symbol && Symbol['for'];\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    var description = 'Symbol.' + name;\n    if (NATIVE_SYMBOL && hasOwn(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else if (USE_SYMBOL_AS_UID && symbolFor) {\n      WellKnownSymbolsStore[name] = symbolFor(description);\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol(description);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar getMethod = require('../internals/get-method');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TypeError = global.TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n","var toPrimitive = require('../internals/to-primitive');\nvar isSymbol = require('../internals/is-symbol');\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var global = require('../internals/global');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\n\nvar TypeError = global.TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype != 42;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar String = global.String;\nvar TypeError = global.TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw TypeError(String(argument) + ' is not an object');\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar isCallable = require('../internals/is-callable');\nvar store = require('../internals/shared-store');\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","module.exports = {};\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar hasOwn = require('../internals/has-own-property');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = uncurryThis(store.get);\n  var wmhas = uncurryThis(store.has);\n  var wmset = uncurryThis(store.set);\n  set = function (it, metadata) {\n    if (wmhas(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar hasOwn = require('../internals/has-own-property');\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar setGlobal = require('../internals/set-global');\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\nvar CONFIGURABLE_FUNCTION_NAME = require('../internals/function-name').CONFIGURABLE;\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  var name = options && options.name !== undefined ? options.name : key;\n  var state;\n  if (isCallable(value)) {\n    if (String(name).slice(0, 7) === 'Symbol(') {\n      name = '[' + String(name).replace(/^Symbol\\(([^)]*)\\)/, '$1') + ']';\n    }\n    if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n      createNonEnumerableProperty(value, 'name', name);\n    }\n    state = enforceInternalState(value);\n    if (!state.source) {\n      state.source = TEMPLATE.join(typeof name == 'string' ? name : '');\n    }\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n});\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- safe\n  return number !== number || number === 0 ? 0 : (number > 0 ? floor : ceil)(number);\n};\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var toLength = require('../internals/to-length');\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n","// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n","var hasOwn = require('../internals/has-own-property');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n","var fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n  options.name        - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var global = require('../internals/global');\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar Object = global.Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","var global = require('../internals/global');\nvar classof = require('../internals/classof');\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return String(argument);\n};\n","// `Symbol.prototype.description` getter\n// https://tc39.es/ecma262/#sec-symbol.prototype.description\n'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar toString = require('../internals/to-string');\nvar defineProperty = require('../internals/object-define-property').f;\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\n\nvar NativeSymbol = global.Symbol;\nvar SymbolPrototype = NativeSymbol && NativeSymbol.prototype;\n\nif (DESCRIPTORS && isCallable(NativeSymbol) && (!('description' in SymbolPrototype) ||\n  // Safari 12 bug\n  NativeSymbol().description !== undefined\n)) {\n  var EmptyStringDescriptionStore = {};\n  // wrap Symbol constructor for correct work with undefined description\n  var SymbolWrapper = function Symbol() {\n    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : toString(arguments[0]);\n    var result = isPrototypeOf(SymbolPrototype, this)\n      ? new NativeSymbol(description)\n      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'\n      : description === undefined ? NativeSymbol() : NativeSymbol(description);\n    if (description === '') EmptyStringDescriptionStore[result] = true;\n    return result;\n  };\n\n  copyConstructorProperties(SymbolWrapper, NativeSymbol);\n  SymbolWrapper.prototype = SymbolPrototype;\n  SymbolPrototype.constructor = SymbolWrapper;\n\n  var NATIVE_SYMBOL = String(NativeSymbol('test')) == 'Symbol(test)';\n  var symbolToString = uncurryThis(SymbolPrototype.toString);\n  var symbolValueOf = uncurryThis(SymbolPrototype.valueOf);\n  var regexp = /^Symbol\\((.*)\\)[^)]+$/;\n  var replace = uncurryThis(''.replace);\n  var stringSlice = uncurryThis(''.slice);\n\n  defineProperty(SymbolPrototype, 'description', {\n    configurable: true,\n    get: function description() {\n      var symbol = symbolValueOf(this);\n      var string = symbolToString(symbol);\n      if (hasOwn(EmptyStringDescriptionStore, symbol)) return '';\n      var desc = NATIVE_SYMBOL ? stringSlice(string, 7, -1) : replace(string, regexp, '$1');\n      return desc === '' ? undefined : desc;\n    }\n  });\n\n  $({ global: true, forced: true }, {\n    Symbol: SymbolWrapper\n  });\n}\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nexports.f = wellKnownSymbol;\n","var global = require('../internals/global');\n\nmodule.exports = global;\n","var path = require('../internals/path');\nvar hasOwn = require('../internals/has-own-property');\nvar wrappedWellKnownSymbolModule = require('../internals/well-known-symbol-wrapped');\nvar defineProperty = require('../internals/object-define-property').f;\n\nmodule.exports = function (NAME) {\n  var Symbol = path.Symbol || (path.Symbol = {});\n  if (!hasOwn(Symbol, NAME)) defineProperty(Symbol, NAME, {\n    value: wrappedWellKnownSymbolModule.f(NAME)\n  });\n};\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.asyncIterator` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.asynciterator\ndefineWellKnownSymbol('asyncIterator');\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\n// eslint-disable-next-line es/no-array-isarray -- safe\nmodule.exports = Array.isArray || function isArray(argument) {\n  return classof(argument) == 'Array';\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar bind = uncurryThis(uncurryThis.bind);\n\n// optional / simple context binding\nmodule.exports = function (fn, that) {\n  aCallable(fn);\n  return that === undefined ? fn : NATIVE_BIND ? bind(fn, that) : function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","'use strict';\nvar global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar bind = require('../internals/function-bind-context');\n\nvar TypeError = global.TypeError;\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg) : false;\n  var element, elementLen;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        elementLen = lengthOfArrayLike(element);\n        targetIndex = flattenIntoArray(target, original, element, elementLen, targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1FFFFFFFFFFFFF) throw TypeError('Exceed the acceptable array length');\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof');\nvar getBuiltIn = require('../internals/get-built-in');\nvar inspectSource = require('../internals/inspect-source');\n\nvar noop = function () { /* empty */ };\nvar empty = [];\nvar construct = getBuiltIn('Reflect', 'construct');\nvar constructorRegExp = /^\\s*(?:class|function)\\b/;\nvar exec = uncurryThis(constructorRegExp.exec);\nvar INCORRECT_TO_STRING = !constructorRegExp.exec(noop);\n\nvar isConstructorModern = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  try {\n    construct(noop, empty, argument);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\nvar isConstructorLegacy = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  switch (classof(argument)) {\n    case 'AsyncFunction':\n    case 'GeneratorFunction':\n    case 'AsyncGeneratorFunction': return false;\n  }\n  try {\n    // we can't check .prototype since constructors produced by .bind haven't it\n    // `Function#toString` throws on some built-it function in some legacy engines\n    // (for example, `DOMQuad` and similar in FF41-)\n    return INCORRECT_TO_STRING || !!exec(constructorRegExp, inspectSource(argument));\n  } catch (error) {\n    return true;\n  }\n};\n\nisConstructorLegacy.sham = true;\n\n// `IsConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-isconstructor\nmodule.exports = !construct || fails(function () {\n  var called;\n  return isConstructorModern(isConstructorModern.call)\n    || !isConstructorModern(Object)\n    || !isConstructorModern(function () { called = true; })\n    || called;\n}) ? isConstructorLegacy : isConstructorModern;\n","var global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\nvar Array = global.Array;\n\n// a part of `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (isConstructor(C) && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n","var arraySpeciesConstructor = require('../internals/array-species-constructor');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  return new (arraySpeciesConstructor(originalArray))(length === 0 ? 0 : length);\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flat` method\n// https://tc39.es/ecma262/#sec-array.prototype.flat\n$({ target: 'Array', proto: true }, {\n  flat: function flat(/* depthArg = 1 */) {\n    var depthArg = arguments.length ? arguments[0] : undefined;\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, depthArg === undefined ? 1 : toIntegerOrInfinity(depthArg));\n    return A;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-array.prototype.flatmap\n$({ target: 'Array', proto: true }, {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A;\n    aCallable(callbackfn);\n    A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return A;\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nexports.f = DESCRIPTORS && !V8_PROTOTYPE_DEFINE_BUG ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var props = toIndexedObject(Properties);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], props[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","/* global ActiveXObject -- old IE, WSH */\nvar anObject = require('../internals/an-object');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    activeXDocument = new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = typeof document != 'undefined'\n    ? document.domain && activeXDocument\n      ? NullProtoObjectViaActiveX(activeXDocument) // old IE\n      : NullProtoObjectViaIFrame()\n    : NullProtoObjectViaActiveX(activeXDocument); // WSH\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : definePropertiesModule.f(result, Properties);\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar definePropertyModule = require('../internals/object-define-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","module.exports = {};\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar Iterators = require('../internals/iterators');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineProperty = require('../internals/object-define-property').f;\nvar defineIterator = require('../internals/define-iterator');\nvar IS_PURE = require('../internals/is-pure');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar ARRAY_ITERATOR = 'Array Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(ARRAY_ITERATOR);\n\n// `Array.prototype.entries` method\n// https://tc39.es/ecma262/#sec-array.prototype.entries\n// `Array.prototype.keys` method\n// https://tc39.es/ecma262/#sec-array.prototype.keys\n// `Array.prototype.values` method\n// https://tc39.es/ecma262/#sec-array.prototype.values\n// `Array.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-array.prototype-@@iterator\n// `CreateArrayIterator` internal method\n// https://tc39.es/ecma262/#sec-createarrayiterator\nmodule.exports = defineIterator(Array, 'Array', function (iterated, kind) {\n  setInternalState(this, {\n    type: ARRAY_ITERATOR,\n    target: toIndexedObject(iterated), // target\n    index: 0,                          // next index\n    kind: kind                         // kind\n  });\n// `%ArrayIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%arrayiteratorprototype%.next\n}, function () {\n  var state = getInternalState(this);\n  var target = state.target;\n  var kind = state.kind;\n  var index = state.index++;\n  if (!target || index >= target.length) {\n    state.target = undefined;\n    return { value: undefined, done: true };\n  }\n  if (kind == 'keys') return { value: index, done: false };\n  if (kind == 'values') return { value: target[index], done: false };\n  return { value: [index, target[index]], done: false };\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values%\n// https://tc39.es/ecma262/#sec-createunmappedargumentsobject\n// https://tc39.es/ecma262/#sec-createmappedargumentsobject\nvar values = Iterators.Arguments = Iterators.Array;\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n\n// V8 ~ Chrome 45- bug\nif (!IS_PURE && DESCRIPTORS && values.name !== 'values') try {\n  defineProperty(values, 'name', { value: 'values' });\n} catch (error) { /* empty */ }\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  // eslint-disable-next-line es/no-object-getprototypeof -- required for testing\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","var global = require('../internals/global');\nvar hasOwn = require('../internals/has-own-property');\nvar isCallable = require('../internals/is-callable');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar Object = global.Object;\nvar ObjectPrototype = Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {\n  var object = toObject(O);\n  if (hasOwn(object, IE_PROTO)) return object[IE_PROTO];\n  var constructor = object.constructor;\n  if (isCallable(constructor) && object instanceof constructor) {\n    return constructor.prototype;\n  } return object instanceof Object ? ObjectPrototype : null;\n};\n","'use strict';\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar create = require('../internals/object-create');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar BUGGY_SAFARI_ITERATORS = false;\n\n// `%IteratorPrototype%` object\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-object\nvar IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;\n\n/* eslint-disable es/no-array-prototype-keys -- safe */\nif ([].keys) {\n  arrayIterator = [].keys();\n  // Safari 8 has buggy iterators w/o `next`\n  if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;\n  else {\n    PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));\n    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;\n  }\n}\n\nvar NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {\n  var test = {};\n  // FF44- legacy iterators case\n  return IteratorPrototype[ITERATOR].call(test) !== test;\n});\n\nif (NEW_ITERATOR_PROTOTYPE) IteratorPrototype = {};\nelse if (IS_PURE) IteratorPrototype = create(IteratorPrototype);\n\n// `%IteratorPrototype%[@@iterator]()` method\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-@@iterator\nif (!isCallable(IteratorPrototype[ITERATOR])) {\n  redefine(IteratorPrototype, ITERATOR, function () {\n    return this;\n  });\n}\n\nmodule.exports = {\n  IteratorPrototype: IteratorPrototype,\n  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS\n};\n","'use strict';\nvar IteratorPrototype = require('../internals/iterators-core').IteratorPrototype;\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar Iterators = require('../internals/iterators');\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (IteratorConstructor, NAME, next, ENUMERABLE_NEXT) {\n  var TO_STRING_TAG = NAME + ' Iterator';\n  IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(+!ENUMERABLE_NEXT, next) });\n  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);\n  Iterators[TO_STRING_TAG] = returnThis;\n  return IteratorConstructor;\n};\n","var defineProperty = require('../internals/object-define-property').f;\nvar hasOwn = require('../internals/has-own-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nmodule.exports = function (target, TAG, STATIC) {\n  if (target && !STATIC) target = target.prototype;\n  if (target && !hasOwn(target, TO_STRING_TAG)) {\n    defineProperty(target, TO_STRING_TAG, { configurable: true, value: TAG });\n  }\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar String = global.String;\nvar TypeError = global.TypeError;\n\nmodule.exports = function (argument) {\n  if (typeof argument == 'object' || isCallable(argument)) return argument;\n  throw TypeError(\"Can't set \" + String(argument) + ' as a prototype');\n};\n","/* eslint-disable no-proto -- safe */\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n// eslint-disable-next-line es/no-object-setprototypeof -- safe\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n    setter = uncurryThis(Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set);\n    setter(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar IS_PURE = require('../internals/is-pure');\nvar FunctionName = require('../internals/function-name');\nvar isCallable = require('../internals/is-callable');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\nvar IteratorsCore = require('../internals/iterators-core');\n\nvar PROPER_FUNCTION_NAME = FunctionName.PROPER;\nvar CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;\nvar IteratorPrototype = IteratorsCore.IteratorPrototype;\nvar BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;\nvar ITERATOR = wellKnownSymbol('iterator');\nvar KEYS = 'keys';\nvar VALUES = 'values';\nvar ENTRIES = 'entries';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {\n  createIteratorConstructor(IteratorConstructor, NAME, next);\n\n  var getIterationMethod = function (KIND) {\n    if (KIND === DEFAULT && defaultIterator) return defaultIterator;\n    if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];\n    switch (KIND) {\n      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };\n      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };\n      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };\n    } return function () { return new IteratorConstructor(this); };\n  };\n\n  var TO_STRING_TAG = NAME + ' Iterator';\n  var INCORRECT_VALUES_NAME = false;\n  var IterablePrototype = Iterable.prototype;\n  var nativeIterator = IterablePrototype[ITERATOR]\n    || IterablePrototype['@@iterator']\n    || DEFAULT && IterablePrototype[DEFAULT];\n  var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);\n  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;\n  var CurrentIteratorPrototype, methods, KEY;\n\n  // fix native\n  if (anyNativeIterator) {\n    CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));\n    if (CurrentIteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {\n      if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {\n        if (setPrototypeOf) {\n          setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);\n        } else if (!isCallable(CurrentIteratorPrototype[ITERATOR])) {\n          redefine(CurrentIteratorPrototype, ITERATOR, returnThis);\n        }\n      }\n      // Set @@toStringTag to native iterators\n      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);\n      if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;\n    }\n  }\n\n  // fix Array.prototype.{ values, @@iterator }.name in V8 / FF\n  if (PROPER_FUNCTION_NAME && DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {\n    if (!IS_PURE && CONFIGURABLE_FUNCTION_NAME) {\n      createNonEnumerableProperty(IterablePrototype, 'name', VALUES);\n    } else {\n      INCORRECT_VALUES_NAME = true;\n      defaultIterator = function values() { return call(nativeIterator, this); };\n    }\n  }\n\n  // export additional methods\n  if (DEFAULT) {\n    methods = {\n      values: getIterationMethod(VALUES),\n      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),\n      entries: getIterationMethod(ENTRIES)\n    };\n    if (FORCED) for (KEY in methods) {\n      if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {\n        redefine(IterablePrototype, KEY, methods[KEY]);\n      }\n    } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);\n  }\n\n  // define iterator\n  if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {\n    redefine(IterablePrototype, ITERATOR, defaultIterator, { name: DEFAULT });\n  }\n  Iterators[NAME] = defaultIterator;\n\n  return methods;\n};\n","var global = require('../internals/global');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\nvar TypeError = global.TypeError;\n\n// `Array.prototype.{ reduce, reduceRight }` methods implementation\nvar createMethod = function (IS_RIGHT) {\n  return function (that, callbackfn, argumentsLength, memo) {\n    aCallable(callbackfn);\n    var O = toObject(that);\n    var self = IndexedObject(O);\n    var length = lengthOfArrayLike(O);\n    var index = IS_RIGHT ? length - 1 : 0;\n    var i = IS_RIGHT ? -1 : 1;\n    if (argumentsLength < 2) while (true) {\n      if (index in self) {\n        memo = self[index];\n        index += i;\n        break;\n      }\n      index += i;\n      if (IS_RIGHT ? index < 0 : length <= index) {\n        throw TypeError('Reduce of empty array with no initial value');\n      }\n    }\n    for (;IS_RIGHT ? index >= 0 : length > index; index += i) if (index in self) {\n      memo = callbackfn(memo, self[index], index, O);\n    }\n    return memo;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.reduce` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduce\n  left: createMethod(false),\n  // `Array.prototype.reduceRight` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduceright\n  right: createMethod(true)\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduce = require('../internals/array-reduce').left;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduce');\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduce` method\n// https://tc39.es/ecma262/#sec-array.prototype.reduce\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || CHROME_BUG }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var length = arguments.length;\n    return $reduce(this, callbackfn, length, length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","var classof = require('../internals/classof-raw');\nvar global = require('../internals/global');\n\nmodule.exports = classof(global.process) == 'process';\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduceRight = require('../internals/array-reduce').right;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduceRight');\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduceRight` method\n// https://tc39.es/ecma262/#sec-array.prototype.reduceright\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || CHROME_BUG }, {\n  reduceRight: function reduceRight(callbackfn /* , initialValue */) {\n    return $reduceRight(this, callbackfn, arguments.length, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar toPropertyKey = require('../internals/to-property-key');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPropertyKey(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","var global = require('../internals/global');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\n\nvar Array = global.Array;\nvar max = Math.max;\n\nmodule.exports = function (O, start, end) {\n  var length = lengthOfArrayLike(O);\n  var k = toAbsoluteIndex(start, length);\n  var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n  var result = Array(max(fin - k, 0));\n  for (var n = 0; k < fin; k++, n++) createProperty(result, n, O[k]);\n  result.length = n;\n  return result;\n};\n","var arraySlice = require('../internals/array-slice-simple');\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n","var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flat');\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flatMap');\n","var $ = require('../internals/export');\n\n// eslint-disable-next-line es/no-math-hypot -- required for testing\nvar $hypot = Math.hypot;\nvar abs = Math.abs;\nvar sqrt = Math.sqrt;\n\n// Chrome 77 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=9546\nvar BUGGY = !!$hypot && $hypot(Infinity, NaN) !== Infinity;\n\n// `Math.hypot` method\n// https://tc39.es/ecma262/#sec-math.hypot\n$({ target: 'Math', stat: true, forced: BUGGY }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  hypot: function hypot(value1, value2) {\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * sqrt(sum);\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\n// Forced replacement object prototype accessors methods\nmodule.exports = IS_PURE || !fails(function () {\n  // This feature detection crashes old WebKit\n  // https://github.com/zloirock/core-js/issues/232\n  if (WEBKIT && WEBKIT < 535) return;\n  var key = Math.random();\n  // In FF throws only define methods\n  // eslint-disable-next-line no-undef, no-useless-call -- required for testing\n  __defineSetter__.call(null, key, function () { /* empty */ });\n  delete global[key];\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineGetter__: function __defineGetter__(P, getter) {\n      definePropertyModule.f(toObject(this), P, { get: aCallable(getter), enumerable: true, configurable: true });\n    }\n  });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar definePropertyModule = require('../internals/object-define-property');\n\n// `Object.prototype.__defineSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__defineSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __defineSetter__: function __defineSetter__(P, setter) {\n      definePropertyModule.f(toObject(this), P, { set: aCallable(setter), enumerable: true, configurable: true });\n    }\n  });\n}\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","var classof = require('../internals/classof');\nvar getMethod = require('../internals/get-method');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return getMethod(it, ITERATOR)\n    || getMethod(it, '@@iterator')\n    || Iterators[classof(it)];\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar tryToString = require('../internals/try-to-string');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (argument, usingIterator) {\n  var iteratorMethod = arguments.length < 2 ? getIteratorMethod(argument) : usingIterator;\n  if (aCallable(iteratorMethod)) return anObject(call(iteratorMethod, argument));\n  throw TypeError(tryToString(argument) + ' is not iterable');\n};\n","var call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar getMethod = require('../internals/get-method');\n\nmodule.exports = function (iterator, kind, value) {\n  var innerResult, innerError;\n  anObject(iterator);\n  try {\n    innerResult = getMethod(iterator, 'return');\n    if (!innerResult) {\n      if (kind === 'throw') throw value;\n      return value;\n    }\n    innerResult = call(innerResult, iterator);\n  } catch (error) {\n    innerError = true;\n    innerResult = error;\n  }\n  if (kind === 'throw') throw value;\n  if (innerError) throw innerResult;\n  anObject(innerResult);\n  return value;\n};\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar tryToString = require('../internals/try-to-string');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar iteratorClose = require('../internals/iterator-close');\n\nvar TypeError = global.TypeError;\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nvar ResultPrototype = Result.prototype;\n\nmodule.exports = function (iterable, unboundFunction, options) {\n  var that = options && options.that;\n  var AS_ENTRIES = !!(options && options.AS_ENTRIES);\n  var IS_ITERATOR = !!(options && options.IS_ITERATOR);\n  var INTERRUPTED = !!(options && options.INTERRUPTED);\n  var fn = bind(unboundFunction, that);\n  var iterator, iterFn, index, length, result, next, step;\n\n  var stop = function (condition) {\n    if (iterator) iteratorClose(iterator, 'normal', condition);\n    return new Result(true, condition);\n  };\n\n  var callFn = function (value) {\n    if (AS_ENTRIES) {\n      anObject(value);\n      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);\n    } return INTERRUPTED ? fn(value, stop) : fn(value);\n  };\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (!iterFn) throw TypeError(tryToString(iterable) + ' is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = lengthOfArrayLike(iterable); length > index; index++) {\n        result = callFn(iterable[index]);\n        if (result && isPrototypeOf(ResultPrototype, result)) return result;\n      } return new Result(false);\n    }\n    iterator = getIterator(iterable, iterFn);\n  }\n\n  next = iterator.next;\n  while (!(step = call(next, iterator)).done) {\n    try {\n      result = callFn(step.value);\n    } catch (error) {\n      iteratorClose(iterator, 'throw', error);\n    }\n    if (typeof result == 'object' && result && isPrototypeOf(ResultPrototype, result)) return result;\n  } return new Result(false);\n};\n","var $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar createProperty = require('../internals/create-property');\n\n// `Object.fromEntries` method\n// https://github.com/tc39/proposal-object-from-entries\n$({ target: 'Object', stat: true }, {\n  fromEntries: function fromEntries(iterable) {\n    var obj = {};\n    iterate(iterable, function (k, v) {\n      createProperty(obj, k, v);\n    }, { AS_ENTRIES: true });\n    return obj;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupGetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupGetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupGetter__: function __lookupGetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.get;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar FORCED = require('../internals/object-prototype-accessors-forced');\nvar toObject = require('../internals/to-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\n\n// `Object.prototype.__lookupSetter__` method\n// https://tc39.es/ecma262/#sec-object.prototype.__lookupSetter__\nif (DESCRIPTORS) {\n  $({ target: 'Object', proto: true, forced: FORCED }, {\n    __lookupSetter__: function __lookupSetter__(P) {\n      var O = toObject(this);\n      var key = toPropertyKey(P);\n      var desc;\n      do {\n        if (desc = getOwnPropertyDescriptor(O, key)) return desc.set;\n      } while (O = getPrototypeOf(O));\n    }\n  });\n}\n","var global = require('../internals/global');\n\nmodule.exports = global.Promise;\n","var redefine = require('../internals/redefine');\n\nmodule.exports = function (target, src, options) {\n  for (var key in src) redefine(target, key, src[key], options);\n  return target;\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar definePropertyModule = require('../internals/object-define-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n\n  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {\n    defineProperty(Constructor, SPECIES, {\n      configurable: true,\n      get: function () { return this; }\n    });\n  }\n};\n","var global = require('../internals/global');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (it, Prototype) {\n  if (isPrototypeOf(Prototype, it)) return it;\n  throw TypeError('Incorrect invocation');\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var called = 0;\n  var iteratorWithReturn = {\n    next: function () {\n      return { done: !!called++ };\n    },\n    'return': function () {\n      SAFE_CLOSING = true;\n    }\n  };\n  iteratorWithReturn[ITERATOR] = function () {\n    return this;\n  };\n  // eslint-disable-next-line es/no-array-from, no-throw-literal -- required for testing\n  Array.from(iteratorWithReturn, function () { throw 2; });\n} catch (error) { /* empty */ }\n\nmodule.exports = function (exec, SKIP_CLOSING) {\n  if (!SKIP_CLOSING && !SAFE_CLOSING) return false;\n  var ITERATION_SUPPORT = false;\n  try {\n    var object = {};\n    object[ITERATOR] = function () {\n      return {\n        next: function () {\n          return { done: ITERATION_SUPPORT = true };\n        }\n      };\n    };\n    exec(object);\n  } catch (error) { /* empty */ }\n  return ITERATION_SUPPORT;\n};\n","var global = require('../internals/global');\nvar isConstructor = require('../internals/is-constructor');\nvar tryToString = require('../internals/try-to-string');\n\nvar TypeError = global.TypeError;\n\n// `Assert: IsConstructor(argument) is true`\nmodule.exports = function (argument) {\n  if (isConstructor(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a constructor');\n};\n","var anObject = require('../internals/an-object');\nvar aConstructor = require('../internals/a-constructor');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aConstructor(S);\n};\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar apply = FunctionPrototype.apply;\nvar call = FunctionPrototype.call;\n\n// eslint-disable-next-line es/no-reflect -- safe\nmodule.exports = typeof Reflect == 'object' && Reflect.apply || (NATIVE_BIND ? call.bind(apply) : function () {\n  return call.apply(apply, arguments);\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis([].slice);\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent);\n","var global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar bind = require('../internals/function-bind-context');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar fails = require('../internals/fails');\nvar html = require('../internals/html');\nvar arraySlice = require('../internals/array-slice');\nvar createElement = require('../internals/document-create-element');\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar set = global.setImmediate;\nvar clear = global.clearImmediate;\nvar process = global.process;\nvar Dispatch = global.Dispatch;\nvar Function = global.Function;\nvar MessageChannel = global.MessageChannel;\nvar String = global.String;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar location, defer, channel, port;\n\ntry {\n  // Deno throws a ReferenceError on `location` access without `--location` flag\n  location = global.location;\n} catch (error) { /* empty */ }\n\nvar run = function (id) {\n  if (hasOwn(queue, id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\n\nvar runner = function (id) {\n  return function () {\n    run(id);\n  };\n};\n\nvar listener = function (event) {\n  run(event.data);\n};\n\nvar post = function (id) {\n  // old engines have not location.origin\n  global.postMessage(String(id), location.protocol + '//' + location.host);\n};\n\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!set || !clear) {\n  set = function setImmediate(fn) {\n    var args = arraySlice(arguments, 1);\n    queue[++counter] = function () {\n      apply(isCallable(fn) ? fn : Function(fn), undefined, args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clear = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (IS_NODE) {\n    defer = function (id) {\n      process.nextTick(runner(id));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(runner(id));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  // except iOS - https://github.com/zloirock/core-js/issues/624\n  } else if (MessageChannel && !IS_IOS) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = bind(port.postMessage, port);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (\n    global.addEventListener &&\n    isCallable(global.postMessage) &&\n    !global.importScripts &&\n    location && location.protocol !== 'file:' &&\n    !fails(post)\n  ) {\n    defer = post;\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in createElement('script')) {\n    defer = function (id) {\n      html.appendChild(createElement('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(runner(id), 0);\n    };\n  }\n}\n\nmodule.exports = {\n  set: set,\n  clear: clear\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar setSpecies = require('../internals/set-species');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar inspectSource = require('../internals/inspect-source');\nvar iterate = require('../internals/iterate');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar speciesConstructor = require('../internals/species-constructor');\nvar task = require('../internals/task').set;\nvar microtask = require('../internals/microtask');\nvar promiseResolve = require('../internals/promise-resolve');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar Queue = require('../internals/queue');\nvar InternalStateModule = require('../internals/internal-state');\nvar isForced = require('../internals/is-forced');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_BROWSER = require('../internals/engine-is-browser');\nvar IS_NODE = require('../internals/engine-is-node');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\nvar PROMISE = 'Promise';\n\nvar getInternalState = InternalStateModule.getterFor(PROMISE);\nvar setInternalState = InternalStateModule.set;\nvar getInternalPromiseState = InternalStateModule.getterFor(PROMISE);\nvar NativePromisePrototype = NativePromise && NativePromise.prototype;\nvar PromiseConstructor = NativePromise;\nvar PromisePrototype = NativePromisePrototype;\nvar TypeError = global.TypeError;\nvar document = global.document;\nvar process = global.process;\nvar newPromiseCapability = newPromiseCapabilityModule.f;\nvar newGenericPromiseCapability = newPromiseCapability;\n\nvar DISPATCH_EVENT = !!(document && document.createEvent && global.dispatchEvent);\nvar NATIVE_REJECTION_EVENT = isCallable(global.PromiseRejectionEvent);\nvar UNHANDLED_REJECTION = 'unhandledrejection';\nvar REJECTION_HANDLED = 'rejectionhandled';\nvar PENDING = 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\nvar HANDLED = 1;\nvar UNHANDLED = 2;\nvar SUBCLASSING = false;\n\nvar Internal, OwnPromiseCapability, PromiseWrapper, nativeThen;\n\nvar FORCED = isForced(PROMISE, function () {\n  var PROMISE_CONSTRUCTOR_SOURCE = inspectSource(PromiseConstructor);\n  var GLOBAL_CORE_JS_PROMISE = PROMISE_CONSTRUCTOR_SOURCE !== String(PromiseConstructor);\n  // V8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n  // We can't detect it synchronously, so just check versions\n  if (!GLOBAL_CORE_JS_PROMISE && V8_VERSION === 66) return true;\n  // We need Promise#finally in the pure version for preventing prototype pollution\n  if (IS_PURE && !PromisePrototype['finally']) return true;\n  // We can't use @@species feature detection in V8 since it causes\n  // deoptimization and performance degradation\n  // https://github.com/zloirock/core-js/issues/679\n  if (V8_VERSION >= 51 && /native code/.test(PROMISE_CONSTRUCTOR_SOURCE)) return false;\n  // Detect correctness of subclassing with @@species support\n  var promise = new PromiseConstructor(function (resolve) { resolve(1); });\n  var FakePromise = function (exec) {\n    exec(function () { /* empty */ }, function () { /* empty */ });\n  };\n  var constructor = promise.constructor = {};\n  constructor[SPECIES] = FakePromise;\n  SUBCLASSING = promise.then(function () { /* empty */ }) instanceof FakePromise;\n  if (!SUBCLASSING) return true;\n  // Unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n  return !GLOBAL_CORE_JS_PROMISE && IS_BROWSER && !NATIVE_REJECTION_EVENT;\n});\n\nvar INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function (iterable) {\n  PromiseConstructor.all(iterable)['catch'](function () { /* empty */ });\n});\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && isCallable(then = it.then) ? then : false;\n};\n\nvar callReaction = function (reaction, state) {\n  var value = state.value;\n  var ok = state.state == FULFILLED;\n  var handler = ok ? reaction.ok : reaction.fail;\n  var resolve = reaction.resolve;\n  var reject = reaction.reject;\n  var domain = reaction.domain;\n  var result, then, exited;\n  try {\n    if (handler) {\n      if (!ok) {\n        if (state.rejection === UNHANDLED) onHandleUnhandled(state);\n        state.rejection = HANDLED;\n      }\n      if (handler === true) result = value;\n      else {\n        if (domain) domain.enter();\n        result = handler(value); // can throw\n        if (domain) {\n          domain.exit();\n          exited = true;\n        }\n      }\n      if (result === reaction.promise) {\n        reject(TypeError('Promise-chain cycle'));\n      } else if (then = isThenable(result)) {\n        call(then, result, resolve, reject);\n      } else resolve(result);\n    } else reject(value);\n  } catch (error) {\n    if (domain && !exited) domain.exit();\n    reject(error);\n  }\n};\n\nvar notify = function (state, isReject) {\n  if (state.notified) return;\n  state.notified = true;\n  microtask(function () {\n    var reactions = state.reactions;\n    var reaction;\n    while (reaction = reactions.get()) {\n      callReaction(reaction, state);\n    }\n    state.notified = false;\n    if (isReject && !state.rejection) onUnhandled(state);\n  });\n};\n\nvar dispatchEvent = function (name, promise, reason) {\n  var event, handler;\n  if (DISPATCH_EVENT) {\n    event = document.createEvent('Event');\n    event.promise = promise;\n    event.reason = reason;\n    event.initEvent(name, false, true);\n    global.dispatchEvent(event);\n  } else event = { promise: promise, reason: reason };\n  if (!NATIVE_REJECTION_EVENT && (handler = global['on' + name])) handler(event);\n  else if (name === UNHANDLED_REJECTION) hostReportErrors('Unhandled promise rejection', reason);\n};\n\nvar onUnhandled = function (state) {\n  call(task, global, function () {\n    var promise = state.facade;\n    var value = state.value;\n    var IS_UNHANDLED = isUnhandled(state);\n    var result;\n    if (IS_UNHANDLED) {\n      result = perform(function () {\n        if (IS_NODE) {\n          process.emit('unhandledRejection', value, promise);\n        } else dispatchEvent(UNHANDLED_REJECTION, promise, value);\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      state.rejection = IS_NODE || isUnhandled(state) ? UNHANDLED : HANDLED;\n      if (result.error) throw result.value;\n    }\n  });\n};\n\nvar isUnhandled = function (state) {\n  return state.rejection !== HANDLED && !state.parent;\n};\n\nvar onHandleUnhandled = function (state) {\n  call(task, global, function () {\n    var promise = state.facade;\n    if (IS_NODE) {\n      process.emit('rejectionHandled', promise);\n    } else dispatchEvent(REJECTION_HANDLED, promise, state.value);\n  });\n};\n\nvar bind = function (fn, state, unwrap) {\n  return function (value) {\n    fn(state, value, unwrap);\n  };\n};\n\nvar internalReject = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  state.value = value;\n  state.state = REJECTED;\n  notify(state, true);\n};\n\nvar internalResolve = function (state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  try {\n    if (state.facade === value) throw TypeError(\"Promise can't be resolved itself\");\n    var then = isThenable(value);\n    if (then) {\n      microtask(function () {\n        var wrapper = { done: false };\n        try {\n          call(then, value,\n            bind(internalResolve, wrapper, state),\n            bind(internalReject, wrapper, state)\n          );\n        } catch (error) {\n          internalReject(wrapper, error, state);\n        }\n      });\n    } else {\n      state.value = value;\n      state.state = FULFILLED;\n      notify(state, false);\n    }\n  } catch (error) {\n    internalReject({ done: false }, error, state);\n  }\n};\n\n// constructor polyfill\nif (FORCED) {\n  // 25.4.3.1 Promise(executor)\n  PromiseConstructor = function Promise(executor) {\n    anInstance(this, PromisePrototype);\n    aCallable(executor);\n    call(Internal, this);\n    var state = getInternalState(this);\n    try {\n      executor(bind(internalResolve, state), bind(internalReject, state));\n    } catch (error) {\n      internalReject(state, error);\n    }\n  };\n  PromisePrototype = PromiseConstructor.prototype;\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  Internal = function Promise(executor) {\n    setInternalState(this, {\n      type: PROMISE,\n      done: false,\n      notified: false,\n      parent: false,\n      reactions: new Queue(),\n      rejection: false,\n      state: PENDING,\n      value: undefined\n    });\n  };\n  Internal.prototype = redefineAll(PromisePrototype, {\n    // `Promise.prototype.then` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.then\n    // eslint-disable-next-line unicorn/no-thenable -- safe\n    then: function then(onFulfilled, onRejected) {\n      var state = getInternalPromiseState(this);\n      var reaction = newPromiseCapability(speciesConstructor(this, PromiseConstructor));\n      state.parent = true;\n      reaction.ok = isCallable(onFulfilled) ? onFulfilled : true;\n      reaction.fail = isCallable(onRejected) && onRejected;\n      reaction.domain = IS_NODE ? process.domain : undefined;\n      if (state.state == PENDING) state.reactions.add(reaction);\n      else microtask(function () {\n        callReaction(reaction, state);\n      });\n      return reaction.promise;\n    },\n    // `Promise.prototype.catch` method\n    // https://tc39.es/ecma262/#sec-promise.prototype.catch\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    var state = getInternalState(promise);\n    this.promise = promise;\n    this.resolve = bind(internalResolve, state);\n    this.reject = bind(internalReject, state);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === PromiseConstructor || C === PromiseWrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n\n  if (!IS_PURE && isCallable(NativePromise) && NativePromisePrototype !== Object.prototype) {\n    nativeThen = NativePromisePrototype.then;\n\n    if (!SUBCLASSING) {\n      // make `Promise#then` return a polyfilled `Promise` for native promise-based APIs\n      redefine(NativePromisePrototype, 'then', function then(onFulfilled, onRejected) {\n        var that = this;\n        return new PromiseConstructor(function (resolve, reject) {\n          call(nativeThen, that, resolve, reject);\n        }).then(onFulfilled, onRejected);\n      // https://github.com/zloirock/core-js/issues/640\n      }, { unsafe: true });\n\n      // makes sure that native promise-based APIs `Promise#catch` properly works with patched `Promise#then`\n      redefine(NativePromisePrototype, 'catch', PromisePrototype['catch'], { unsafe: true });\n    }\n\n    // make `.constructor === Promise` work for native promise-based APIs\n    try {\n      delete NativePromisePrototype.constructor;\n    } catch (error) { /* empty */ }\n\n    // make `instanceof Promise` work for native promise-based APIs\n    if (setPrototypeOf) {\n      setPrototypeOf(NativePromisePrototype, PromisePrototype);\n    }\n  }\n}\n\n$({ global: true, wrap: true, forced: FORCED }, {\n  Promise: PromiseConstructor\n});\n\nsetToStringTag(PromiseConstructor, PROMISE, false, true);\nsetSpecies(PROMISE);\n\nPromiseWrapper = getBuiltIn(PROMISE);\n\n// statics\n$({ target: PROMISE, stat: true, forced: FORCED }, {\n  // `Promise.reject` method\n  // https://tc39.es/ecma262/#sec-promise.reject\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    call(capability.reject, undefined, r);\n    return capability.promise;\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: IS_PURE || FORCED }, {\n  // `Promise.resolve` method\n  // https://tc39.es/ecma262/#sec-promise.resolve\n  resolve: function resolve(x) {\n    return promiseResolve(IS_PURE && this === PromiseWrapper ? PromiseConstructor : this, x);\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, {\n  // `Promise.all` method\n  // https://tc39.es/ecma262/#sec-promise.all\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aCallable(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        remaining++;\n        call($promiseResolve, C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  },\n  // `Promise.race` method\n  // https://tc39.es/ecma262/#sec-promise.race\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aCallable(C.resolve);\n      iterate(iterable, function (promise) {\n        call($promiseResolve, C, promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar macrotask = require('../internals/task').set;\nvar IS_IOS = require('../internals/engine-is-ios');\nvar IS_IOS_PEBBLE = require('../internals/engine-is-ios-pebble');\nvar IS_WEBOS_WEBKIT = require('../internals/engine-is-webos-webkit');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar MutationObserver = global.MutationObserver || global.WebKitMutationObserver;\nvar document = global.document;\nvar process = global.process;\nvar Promise = global.Promise;\n// Node.js 11 shows ExperimentalWarning on getting `queueMicrotask`\nvar queueMicrotaskDescriptor = getOwnPropertyDescriptor(global, 'queueMicrotask');\nvar queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value;\n\nvar flush, head, last, notify, toggle, node, promise, then;\n\n// modern engines have queueMicrotask method\nif (!queueMicrotask) {\n  flush = function () {\n    var parent, fn;\n    if (IS_NODE && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (error) {\n        if (head) notify();\n        else last = undefined;\n        throw error;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // browsers with MutationObserver, except iOS - https://github.com/zloirock/core-js/issues/339\n  // also except WebOS Webkit https://github.com/zloirock/core-js/issues/898\n  if (!IS_IOS && !IS_NODE && !IS_WEBOS_WEBKIT && MutationObserver && document) {\n    toggle = true;\n    node = document.createTextNode('');\n    new MutationObserver(flush).observe(node, { characterData: true });\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (!IS_IOS_PEBBLE && Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    promise = Promise.resolve(undefined);\n    // workaround of WebKit ~ iOS Safari 10.1 bug\n    promise.constructor = Promise;\n    then = bind(promise.then, promise);\n    notify = function () {\n      then(flush);\n    };\n  // Node.js without promises\n  } else if (IS_NODE) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    // strange IE + webpack dev server bug - use .bind(global)\n    macrotask = bind(macrotask, global);\n    notify = function () {\n      macrotask(flush);\n    };\n  }\n}\n\nmodule.exports = queueMicrotask || function (fn) {\n  var task = { fn: fn, next: undefined };\n  if (last) last.next = task;\n  if (!head) {\n    head = task;\n    notify();\n  } last = task;\n};\n","var userAgent = require('../internals/engine-user-agent');\nvar global = require('../internals/global');\n\nmodule.exports = /ipad|iphone|ipod/i.test(userAgent) && global.Pebble !== undefined;\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /web0s(?!.*chrome)/i.test(userAgent);\n","'use strict';\nvar aCallable = require('../internals/a-callable');\n\nvar PromiseCapability = function (C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aCallable(resolve);\n  this.reject = aCallable(reject);\n};\n\n// `NewPromiseCapability` abstract operation\n// https://tc39.es/ecma262/#sec-newpromisecapability\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","var anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar newPromiseCapability = require('../internals/new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","var global = require('../internals/global');\n\nmodule.exports = function (a, b) {\n  var console = global.console;\n  if (console && console.error) {\n    arguments.length == 1 ? console.error(a) : console.error(a, b);\n  }\n};\n","module.exports = function (exec) {\n  try {\n    return { error: false, value: exec() };\n  } catch (error) {\n    return { error: true, value: error };\n  }\n};\n","var Queue = function () {\n  this.head = null;\n  this.tail = null;\n};\n\nQueue.prototype = {\n  add: function (item) {\n    var entry = { item: item, next: null };\n    if (this.head) this.tail.next = entry;\n    else this.head = entry;\n    this.tail = entry;\n  },\n  get: function () {\n    var entry = this.head;\n    if (entry) {\n      this.head = entry.next;\n      if (this.tail === entry) this.tail = null;\n      return entry.item;\n    }\n  }\n};\n\nmodule.exports = Queue;\n","module.exports = typeof window == 'object';\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  // eslint-disable-next-line unicorn/no-thenable -- required for testing\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = isCallable(onFinally);\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// makes sure that native promise-based APIs `Promise#finally` properly works with patched `Promise#then`\nif (!IS_PURE && isCallable(NativePromise)) {\n  var method = getBuiltIn('Promise').prototype['finally'];\n  if (NativePromise.prototype['finally'] !== method) {\n    redefine(NativePromise.prototype, 'finally', method, { unsafe: true });\n  }\n}\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nvar UNSUPPORTED_Y = fails(function () {\n  var re = $RegExp('a', 'y');\n  re.lastIndex = 2;\n  return re.exec('abcd') != null;\n});\n\n// UC Browser bug\n// https://github.com/zloirock/core-js/issues/1008\nvar MISSED_STICKY = UNSUPPORTED_Y || fails(function () {\n  return !$RegExp('a', 'y').sticky;\n});\n\nvar BROKEN_CARET = UNSUPPORTED_Y || fails(function () {\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=773687\n  var re = $RegExp('^r', 'gy');\n  re.lastIndex = 2;\n  return re.exec('str') != null;\n});\n\nmodule.exports = {\n  BROKEN_CARET: BROKEN_CARET,\n  MISSED_STICKY: MISSED_STICKY,\n  UNSUPPORTED_Y: UNSUPPORTED_Y\n};\n","'use strict';\n/* eslint-disable regexp/no-empty-capturing-group, regexp/no-empty-group, regexp/no-lazy-ends -- testing */\n/* eslint-disable regexp/no-useless-quantifier -- testing */\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar regexpFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar shared = require('../internals/shared');\nvar create = require('../internals/object-create');\nvar getInternalState = require('../internals/internal-state').get;\nvar UNSUPPORTED_DOT_ALL = require('../internals/regexp-unsupported-dot-all');\nvar UNSUPPORTED_NCG = require('../internals/regexp-unsupported-ncg');\n\nvar nativeReplace = shared('native-string-replace', String.prototype.replace);\nvar nativeExec = RegExp.prototype.exec;\nvar patchedExec = nativeExec;\nvar charAt = uncurryThis(''.charAt);\nvar indexOf = uncurryThis(''.indexOf);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  call(nativeExec, re1, 'a');\n  call(nativeExec, re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\nvar UNSUPPORTED_Y = stickyHelpers.BROKEN_CARET;\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED || UNSUPPORTED_Y || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG;\n\nif (PATCH) {\n  patchedExec = function exec(string) {\n    var re = this;\n    var state = getInternalState(re);\n    var str = toString(string);\n    var raw = state.raw;\n    var result, reCopy, lastIndex, match, i, object, group;\n\n    if (raw) {\n      raw.lastIndex = re.lastIndex;\n      result = call(patchedExec, raw, str);\n      re.lastIndex = raw.lastIndex;\n      return result;\n    }\n\n    var groups = state.groups;\n    var sticky = UNSUPPORTED_Y && re.sticky;\n    var flags = call(regexpFlags, re);\n    var source = re.source;\n    var charsAdded = 0;\n    var strCopy = str;\n\n    if (sticky) {\n      flags = replace(flags, 'y', '');\n      if (indexOf(flags, 'g') === -1) {\n        flags += 'g';\n      }\n\n      strCopy = stringSlice(str, re.lastIndex);\n      // Support anchored sticky behavior.\n      if (re.lastIndex > 0 && (!re.multiline || re.multiline && charAt(str, re.lastIndex - 1) !== '\\n')) {\n        source = '(?: ' + source + ')';\n        strCopy = ' ' + strCopy;\n        charsAdded++;\n      }\n      // ^(? + rx + ) is needed, in combination with some str slicing, to\n      // simulate the 'y' flag.\n      reCopy = new RegExp('^(?:' + source + ')', flags);\n    }\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + source + '$(?!\\\\s)', flags);\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = call(nativeExec, sticky ? reCopy : re, strCopy);\n\n    if (sticky) {\n      if (match) {\n        match.input = stringSlice(match.input, charsAdded);\n        match[0] = stringSlice(match[0], charsAdded);\n        match.index = re.lastIndex;\n        re.lastIndex += match[0].length;\n      } else re.lastIndex = 0;\n    } else if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      call(nativeReplace, match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    if (match && groups) {\n      match.groups = object = create(null);\n      for (i = 0; i < groups.length; i++) {\n        group = groups[i];\n        object[group[0]] = match[group[1]];\n      }\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('.', 's') -> /./s and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('.', 's');\n  return !(re.dotAll && re.exec('\\n') && re.flags === 's');\n});\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('(?<a>b)', 'g') -> /(?<a>b)/g and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('(?<a>b)', 'g');\n  return re.exec('b').groups.a !== 'b' ||\n    'b'.replace(re, '$<a>c') !== 'bc';\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar exec = require('../internals/regexp-exec');\n\n// `RegExp.prototype.exec` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.exec\n$({ target: 'RegExp', proto: true, forced: /./.exec !== exec }, {\n  exec: exec\n});\n","'use strict';\n// TODO: Remove from `core-js@4` since it's moved to entry points\nrequire('../modules/es.regexp.exec');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefine = require('../internals/redefine');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar SPECIES = wellKnownSymbol('species');\nvar RegExpPrototype = RegExp.prototype;\n\nmodule.exports = function (KEY, exec, FORCED, SHAM) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n\n    if (KEY === 'split') {\n      // We can't use real regex here since it causes deoptimization\n      // and serious performance degradation in V8\n      // https://github.com/zloirock/core-js/issues/306\n      re = {};\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n      re.flags = '';\n      re[SYMBOL] = /./[SYMBOL];\n    }\n\n    re.exec = function () { execCalled = true; return null; };\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    FORCED\n  ) {\n    var uncurriedNativeRegExpMethod = uncurryThis(/./[SYMBOL]);\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      var uncurriedNativeMethod = uncurryThis(nativeMethod);\n      var $exec = regexp.exec;\n      if ($exec === regexpExec || $exec === RegExpPrototype.exec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: uncurriedNativeRegExpMethod(regexp, str, arg2) };\n        }\n        return { done: true, value: uncurriedNativeMethod(str, regexp, arg2) };\n      }\n      return { done: false };\n    });\n\n    redefine(String.prototype, KEY, methods[0]);\n    redefine(RegExpPrototype, SYMBOL, methods[1]);\n  }\n\n  if (SHAM) createNonEnumerableProperty(RegExpPrototype[SYMBOL], 'sham', true);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar charAt = uncurryThis(''.charAt);\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar stringSlice = uncurryThis(''.slice);\n\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = toString(requireObjectCoercible($this));\n    var position = toIntegerOrInfinity(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = charCodeAt(S, position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = charCodeAt(S, position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING\n          ? charAt(S, position)\n          : first\n        : CONVERT_TO_STRING\n          ? stringSlice(S, position, position + 2)\n          : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.es/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.es/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? charAt(S, index).length : 1);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar floor = Math.floor;\nvar charAt = uncurryThis(''.charAt);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d{1,2}|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d{1,2})/g;\n\n// `GetSubstitution` abstract operation\n// https://tc39.es/ecma262/#sec-getsubstitution\nmodule.exports = function (matched, str, position, captures, namedCaptures, replacement) {\n  var tailPos = position + matched.length;\n  var m = captures.length;\n  var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n  if (namedCaptures !== undefined) {\n    namedCaptures = toObject(namedCaptures);\n    symbols = SUBSTITUTION_SYMBOLS;\n  }\n  return replace(replacement, symbols, function (match, ch) {\n    var capture;\n    switch (charAt(ch, 0)) {\n      case '$': return '$';\n      case '&': return matched;\n      case '`': return stringSlice(str, 0, position);\n      case \"'\": return stringSlice(str, tailPos);\n      case '<':\n        capture = namedCaptures[stringSlice(ch, 1, -1)];\n        break;\n      default: // \\d\\d?\n        var n = +ch;\n        if (n === 0) return match;\n        if (n > m) {\n          var f = floor(n / 10);\n          if (f === 0) return match;\n          if (f <= m) return captures[f - 1] === undefined ? charAt(ch, 1) : captures[f - 1] + charAt(ch, 1);\n          return match;\n        }\n        capture = captures[n - 1];\n    }\n    return capture === undefined ? '' : capture;\n  });\n};\n","var global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof-raw');\nvar regexpExec = require('../internals/regexp-exec');\n\nvar TypeError = global.TypeError;\n\n// `RegExpExec` abstract operation\n// https://tc39.es/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (isCallable(exec)) {\n    var result = call(exec, R, S);\n    if (result !== null) anObject(result);\n    return result;\n  }\n  if (classof(R) === 'RegExp') return call(regexpExec, R, S);\n  throw TypeError('RegExp#exec called on incompatible receiver');\n};\n","'use strict';\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar fails = require('../internals/fails');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar getMethod = require('../internals/get-method');\nvar getSubstitution = require('../internals/get-substitution');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar max = Math.max;\nvar min = Math.min;\nvar concat = uncurryThis([].concat);\nvar push = uncurryThis([].push);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar stringSlice = uncurryThis(''.slice);\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// IE <= 11 replaces $0 with the whole match, as if it was $&\n// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0\nvar REPLACE_KEEPS_$0 = (function () {\n  // eslint-disable-next-line regexp/prefer-escape-replacement-dollar-char -- required for testing\n  return 'a'.replace(/./, '$0') === '$0';\n})();\n\n// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string\nvar REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {\n  if (/./[REPLACE]) {\n    return /./[REPLACE]('a', '$0') === '';\n  }\n  return false;\n})();\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  // eslint-disable-next-line regexp/no-useless-dollar-replacements -- false positive\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', function (_, nativeReplace, maybeCallNative) {\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.es/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : getMethod(searchValue, REPLACE);\n      return replacer\n        ? call(replacer, searchValue, O, replaceValue)\n        : call(nativeReplace, toString(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@replace\n    function (string, replaceValue) {\n      var rx = anObject(this);\n      var S = toString(string);\n\n      if (\n        typeof replaceValue == 'string' &&\n        stringIndexOf(replaceValue, UNSAFE_SUBSTITUTE) === -1 &&\n        stringIndexOf(replaceValue, '$<') === -1\n      ) {\n        var res = maybeCallNative(nativeReplace, rx, S, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var functionalReplace = isCallable(replaceValue);\n      if (!functionalReplace) replaceValue = toString(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        push(results, result);\n        if (!global) break;\n\n        var matchStr = toString(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = toString(result[0]);\n        var position = max(min(toIntegerOrInfinity(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) push(captures, maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = concat([matched], captures, position, S);\n          if (namedCaptures !== undefined) push(replacerArgs, namedCaptures);\n          var replacement = toString(apply(replaceValue, undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += stringSlice(S, nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + stringSlice(S, nextSourcePosition);\n    }\n  ];\n}, !REPLACE_SUPPORTS_NAMED_GROUPS || !REPLACE_KEEPS_$0 || REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar whitespaces = require('../internals/whitespaces');\n\nvar replace = uncurryThis(''.replace);\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = toString(requireObjectCoercible($this));\n    if (TYPE & 1) string = replace(string, ltrim, '');\n    if (TYPE & 2) string = replace(string, rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.es/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimEnd = require('../internals/string-trim').end;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimEnd');\n\nvar trimEnd = FORCED ? function trimEnd() {\n  return $trimEnd(this);\n// eslint-disable-next-line es/no-string-prototype-trimstart-trimend -- safe\n} : ''.trimEnd;\n\n// `String.prototype.{ trimEnd, trimRight }` methods\n// https://tc39.es/ecma262/#sec-string.prototype.trimend\n// https://tc39.es/ecma262/#String.prototype.trimright\n$({ target: 'String', proto: true, name: 'trimEnd', forced: FORCED }, {\n  trimEnd: trimEnd,\n  trimRight: trimEnd\n});\n","var PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","// a string of all valid unicode whitespaces\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002' +\n  '\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimStart = require('../internals/string-trim').start;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimStart');\n\nvar trimStart = FORCED ? function trimStart() {\n  return $trimStart(this);\n// eslint-disable-next-line es/no-string-prototype-trimstart-trimend -- safe\n} : ''.trimStart;\n\n// `String.prototype.{ trimStart, trimLeft }` methods\n// https://tc39.es/ecma262/#sec-string.prototype.trimstart\n// https://tc39.es/ecma262/#String.prototype.trimleft\n$({ target: 'String', proto: true, name: 'trimStart', forced: FORCED }, {\n  trimStart: trimStart,\n  trimLeft: trimStart\n});\n","// eslint-disable-next-line es/no-typed-arrays -- safe\nmodule.exports = typeof ArrayBuffer != 'undefined' && typeof DataView != 'undefined';\n","'use strict';\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-native');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar classof = require('../internals/classof');\nvar tryToString = require('../internals/try-to-string');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar defineProperty = require('../internals/object-define-property').f;\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar uid = require('../internals/uid');\n\nvar Int8Array = global.Int8Array;\nvar Int8ArrayPrototype = Int8Array && Int8Array.prototype;\nvar Uint8ClampedArray = global.Uint8ClampedArray;\nvar Uint8ClampedArrayPrototype = Uint8ClampedArray && Uint8ClampedArray.prototype;\nvar TypedArray = Int8Array && getPrototypeOf(Int8Array);\nvar TypedArrayPrototype = Int8ArrayPrototype && getPrototypeOf(Int8ArrayPrototype);\nvar ObjectPrototype = Object.prototype;\nvar TypeError = global.TypeError;\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar TYPED_ARRAY_TAG = uid('TYPED_ARRAY_TAG');\nvar TYPED_ARRAY_CONSTRUCTOR = uid('TYPED_ARRAY_CONSTRUCTOR');\n// Fixing native typed arrays in Opera Presto crashes the browser, see #595\nvar NATIVE_ARRAY_BUFFER_VIEWS = NATIVE_ARRAY_BUFFER && !!setPrototypeOf && classof(global.opera) !== 'Opera';\nvar TYPED_ARRAY_TAG_REQUIRED = false;\nvar NAME, Constructor, Prototype;\n\nvar TypedArrayConstructorsList = {\n  Int8Array: 1,\n  Uint8Array: 1,\n  Uint8ClampedArray: 1,\n  Int16Array: 2,\n  Uint16Array: 2,\n  Int32Array: 4,\n  Uint32Array: 4,\n  Float32Array: 4,\n  Float64Array: 8\n};\n\nvar BigIntArrayConstructorsList = {\n  BigInt64Array: 8,\n  BigUint64Array: 8\n};\n\nvar isView = function isView(it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return klass === 'DataView'\n    || hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar isTypedArray = function (it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar aTypedArray = function (it) {\n  if (isTypedArray(it)) return it;\n  throw TypeError('Target is not a typed array');\n};\n\nvar aTypedArrayConstructor = function (C) {\n  if (isCallable(C) && (!setPrototypeOf || isPrototypeOf(TypedArray, C))) return C;\n  throw TypeError(tryToString(C) + ' is not a typed array constructor');\n};\n\nvar exportTypedArrayMethod = function (KEY, property, forced, options) {\n  if (!DESCRIPTORS) return;\n  if (forced) for (var ARRAY in TypedArrayConstructorsList) {\n    var TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && hasOwn(TypedArrayConstructor.prototype, KEY)) try {\n      delete TypedArrayConstructor.prototype[KEY];\n    } catch (error) {\n      // old WebKit bug - some methods are non-configurable\n      try {\n        TypedArrayConstructor.prototype[KEY] = property;\n      } catch (error2) { /* empty */ }\n    }\n  }\n  if (!TypedArrayPrototype[KEY] || forced) {\n    redefine(TypedArrayPrototype, KEY, forced ? property\n      : NATIVE_ARRAY_BUFFER_VIEWS && Int8ArrayPrototype[KEY] || property, options);\n  }\n};\n\nvar exportTypedArrayStaticMethod = function (KEY, property, forced) {\n  var ARRAY, TypedArrayConstructor;\n  if (!DESCRIPTORS) return;\n  if (setPrototypeOf) {\n    if (forced) for (ARRAY in TypedArrayConstructorsList) {\n      TypedArrayConstructor = global[ARRAY];\n      if (TypedArrayConstructor && hasOwn(TypedArrayConstructor, KEY)) try {\n        delete TypedArrayConstructor[KEY];\n      } catch (error) { /* empty */ }\n    }\n    if (!TypedArray[KEY] || forced) {\n      // V8 ~ Chrome 49-50 `%TypedArray%` methods are non-writable non-configurable\n      try {\n        return redefine(TypedArray, KEY, forced ? property : NATIVE_ARRAY_BUFFER_VIEWS && TypedArray[KEY] || property);\n      } catch (error) { /* empty */ }\n    } else return;\n  }\n  for (ARRAY in TypedArrayConstructorsList) {\n    TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && (!TypedArrayConstructor[KEY] || forced)) {\n      redefine(TypedArrayConstructor, KEY, property);\n    }\n  }\n};\n\nfor (NAME in TypedArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);\n  else NATIVE_ARRAY_BUFFER_VIEWS = false;\n}\n\nfor (NAME in BigIntArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);\n}\n\n// WebKit bug - typed arrays constructors prototype is Object.prototype\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !isCallable(TypedArray) || TypedArray === Function.prototype) {\n  // eslint-disable-next-line no-shadow -- safe\n  TypedArray = function TypedArray() {\n    throw TypeError('Incorrect invocation');\n  };\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME], TypedArray);\n  }\n}\n\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !TypedArrayPrototype || TypedArrayPrototype === ObjectPrototype) {\n  TypedArrayPrototype = TypedArray.prototype;\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME].prototype, TypedArrayPrototype);\n  }\n}\n\n// WebKit bug - one more object in Uint8ClampedArray prototype chain\nif (NATIVE_ARRAY_BUFFER_VIEWS && getPrototypeOf(Uint8ClampedArrayPrototype) !== TypedArrayPrototype) {\n  setPrototypeOf(Uint8ClampedArrayPrototype, TypedArrayPrototype);\n}\n\nif (DESCRIPTORS && !hasOwn(TypedArrayPrototype, TO_STRING_TAG)) {\n  TYPED_ARRAY_TAG_REQUIRED = true;\n  defineProperty(TypedArrayPrototype, TO_STRING_TAG, { get: function () {\n    return isObject(this) ? this[TYPED_ARRAY_TAG] : undefined;\n  } });\n  for (NAME in TypedArrayConstructorsList) if (global[NAME]) {\n    createNonEnumerableProperty(global[NAME], TYPED_ARRAY_TAG, NAME);\n  }\n}\n\nmodule.exports = {\n  NATIVE_ARRAY_BUFFER_VIEWS: NATIVE_ARRAY_BUFFER_VIEWS,\n  TYPED_ARRAY_CONSTRUCTOR: TYPED_ARRAY_CONSTRUCTOR,\n  TYPED_ARRAY_TAG: TYPED_ARRAY_TAG_REQUIRED && TYPED_ARRAY_TAG,\n  aTypedArray: aTypedArray,\n  aTypedArrayConstructor: aTypedArrayConstructor,\n  exportTypedArrayMethod: exportTypedArrayMethod,\n  exportTypedArrayStaticMethod: exportTypedArrayStaticMethod,\n  isView: isView,\n  isTypedArray: isTypedArray,\n  TypedArray: TypedArray,\n  TypedArrayPrototype: TypedArrayPrototype\n};\n","/* eslint-disable no-new -- required for testing */\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar NATIVE_ARRAY_BUFFER_VIEWS = require('../internals/array-buffer-view-core').NATIVE_ARRAY_BUFFER_VIEWS;\n\nvar ArrayBuffer = global.ArrayBuffer;\nvar Int8Array = global.Int8Array;\n\nmodule.exports = !NATIVE_ARRAY_BUFFER_VIEWS || !fails(function () {\n  Int8Array(1);\n}) || !fails(function () {\n  new Int8Array(-1);\n}) || !checkCorrectnessOfIteration(function (iterable) {\n  new Int8Array();\n  new Int8Array(null);\n  new Int8Array(1.5);\n  new Int8Array(iterable);\n}, true) || fails(function () {\n  // Safari (11+) bug - a reason why even Safari 13 should load a typed array polyfill\n  return new Int8Array(new ArrayBuffer(2), 1, undefined).length !== 1;\n});\n","var global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\n\nvar RangeError = global.RangeError;\n\n// `ToIndex` abstract operation\n// https://tc39.es/ecma262/#sec-toindex\nmodule.exports = function (it) {\n  if (it === undefined) return 0;\n  var number = toIntegerOrInfinity(it);\n  var length = toLength(number);\n  if (number !== length) throw RangeError('Wrong length or index');\n  return length;\n};\n","// IEEE754 conversions based on https://github.com/feross/ieee754\nvar global = require('../internals/global');\n\nvar Array = global.Array;\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar floor = Math.floor;\nvar log = Math.log;\nvar LN2 = Math.LN2;\n\nvar pack = function (number, mantissaLength, bytes) {\n  var buffer = Array(bytes);\n  var exponentLength = bytes * 8 - mantissaLength - 1;\n  var eMax = (1 << exponentLength) - 1;\n  var eBias = eMax >> 1;\n  var rt = mantissaLength === 23 ? pow(2, -24) - pow(2, -77) : 0;\n  var sign = number < 0 || number === 0 && 1 / number < 0 ? 1 : 0;\n  var index = 0;\n  var exponent, mantissa, c;\n  number = abs(number);\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (number != number || number === Infinity) {\n    // eslint-disable-next-line no-self-compare -- NaN check\n    mantissa = number != number ? 1 : 0;\n    exponent = eMax;\n  } else {\n    exponent = floor(log(number) / LN2);\n    c = pow(2, -exponent);\n    if (number * c < 1) {\n      exponent--;\n      c *= 2;\n    }\n    if (exponent + eBias >= 1) {\n      number += rt / c;\n    } else {\n      number += rt * pow(2, 1 - eBias);\n    }\n    if (number * c >= 2) {\n      exponent++;\n      c /= 2;\n    }\n    if (exponent + eBias >= eMax) {\n      mantissa = 0;\n      exponent = eMax;\n    } else if (exponent + eBias >= 1) {\n      mantissa = (number * c - 1) * pow(2, mantissaLength);\n      exponent = exponent + eBias;\n    } else {\n      mantissa = number * pow(2, eBias - 1) * pow(2, mantissaLength);\n      exponent = 0;\n    }\n  }\n  while (mantissaLength >= 8) {\n    buffer[index++] = mantissa & 255;\n    mantissa /= 256;\n    mantissaLength -= 8;\n  }\n  exponent = exponent << mantissaLength | mantissa;\n  exponentLength += mantissaLength;\n  while (exponentLength > 0) {\n    buffer[index++] = exponent & 255;\n    exponent /= 256;\n    exponentLength -= 8;\n  }\n  buffer[--index] |= sign * 128;\n  return buffer;\n};\n\nvar unpack = function (buffer, mantissaLength) {\n  var bytes = buffer.length;\n  var exponentLength = bytes * 8 - mantissaLength - 1;\n  var eMax = (1 << exponentLength) - 1;\n  var eBias = eMax >> 1;\n  var nBits = exponentLength - 7;\n  var index = bytes - 1;\n  var sign = buffer[index--];\n  var exponent = sign & 127;\n  var mantissa;\n  sign >>= 7;\n  while (nBits > 0) {\n    exponent = exponent * 256 + buffer[index--];\n    nBits -= 8;\n  }\n  mantissa = exponent & (1 << -nBits) - 1;\n  exponent >>= -nBits;\n  nBits += mantissaLength;\n  while (nBits > 0) {\n    mantissa = mantissa * 256 + buffer[index--];\n    nBits -= 8;\n  }\n  if (exponent === 0) {\n    exponent = 1 - eBias;\n  } else if (exponent === eMax) {\n    return mantissa ? NaN : sign ? -Infinity : Infinity;\n  } else {\n    mantissa = mantissa + pow(2, mantissaLength);\n    exponent = exponent - eBias;\n  } return (sign ? -1 : 1) * mantissa * pow(2, exponent - mantissaLength);\n};\n\nmodule.exports = {\n  pack: pack,\n  unpack: unpack\n};\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-native');\nvar FunctionName = require('../internals/function-name');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefineAll = require('../internals/redefine-all');\nvar fails = require('../internals/fails');\nvar anInstance = require('../internals/an-instance');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\nvar toIndex = require('../internals/to-index');\nvar IEEE754 = require('../internals/ieee754');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar arrayFill = require('../internals/array-fill');\nvar arraySlice = require('../internals/array-slice-simple');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar PROPER_FUNCTION_NAME = FunctionName.PROPER;\nvar CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar DATA_VIEW = 'DataView';\nvar PROTOTYPE = 'prototype';\nvar WRONG_LENGTH = 'Wrong length';\nvar WRONG_INDEX = 'Wrong index';\nvar NativeArrayBuffer = global[ARRAY_BUFFER];\nvar $ArrayBuffer = NativeArrayBuffer;\nvar ArrayBufferPrototype = $ArrayBuffer && $ArrayBuffer[PROTOTYPE];\nvar $DataView = global[DATA_VIEW];\nvar DataViewPrototype = $DataView && $DataView[PROTOTYPE];\nvar ObjectPrototype = Object.prototype;\nvar Array = global.Array;\nvar RangeError = global.RangeError;\nvar fill = uncurryThis(arrayFill);\nvar reverse = uncurryThis([].reverse);\n\nvar packIEEE754 = IEEE754.pack;\nvar unpackIEEE754 = IEEE754.unpack;\n\nvar packInt8 = function (number) {\n  return [number & 0xFF];\n};\n\nvar packInt16 = function (number) {\n  return [number & 0xFF, number >> 8 & 0xFF];\n};\n\nvar packInt32 = function (number) {\n  return [number & 0xFF, number >> 8 & 0xFF, number >> 16 & 0xFF, number >> 24 & 0xFF];\n};\n\nvar unpackInt32 = function (buffer) {\n  return buffer[3] << 24 | buffer[2] << 16 | buffer[1] << 8 | buffer[0];\n};\n\nvar packFloat32 = function (number) {\n  return packIEEE754(number, 23, 4);\n};\n\nvar packFloat64 = function (number) {\n  return packIEEE754(number, 52, 8);\n};\n\nvar addGetter = function (Constructor, key) {\n  defineProperty(Constructor[PROTOTYPE], key, { get: function () { return getInternalState(this)[key]; } });\n};\n\nvar get = function (view, count, index, isLittleEndian) {\n  var intIndex = toIndex(index);\n  var store = getInternalState(view);\n  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);\n  var bytes = getInternalState(store.buffer).bytes;\n  var start = intIndex + store.byteOffset;\n  var pack = arraySlice(bytes, start, start + count);\n  return isLittleEndian ? pack : reverse(pack);\n};\n\nvar set = function (view, count, index, conversion, value, isLittleEndian) {\n  var intIndex = toIndex(index);\n  var store = getInternalState(view);\n  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);\n  var bytes = getInternalState(store.buffer).bytes;\n  var start = intIndex + store.byteOffset;\n  var pack = conversion(+value);\n  for (var i = 0; i < count; i++) bytes[start + i] = pack[isLittleEndian ? i : count - i - 1];\n};\n\nif (!NATIVE_ARRAY_BUFFER) {\n  $ArrayBuffer = function ArrayBuffer(length) {\n    anInstance(this, ArrayBufferPrototype);\n    var byteLength = toIndex(length);\n    setInternalState(this, {\n      bytes: fill(Array(byteLength), 0),\n      byteLength: byteLength\n    });\n    if (!DESCRIPTORS) this.byteLength = byteLength;\n  };\n\n  ArrayBufferPrototype = $ArrayBuffer[PROTOTYPE];\n\n  $DataView = function DataView(buffer, byteOffset, byteLength) {\n    anInstance(this, DataViewPrototype);\n    anInstance(buffer, ArrayBufferPrototype);\n    var bufferLength = getInternalState(buffer).byteLength;\n    var offset = toIntegerOrInfinity(byteOffset);\n    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset');\n    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);\n    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);\n    setInternalState(this, {\n      buffer: buffer,\n      byteLength: byteLength,\n      byteOffset: offset\n    });\n    if (!DESCRIPTORS) {\n      this.buffer = buffer;\n      this.byteLength = byteLength;\n      this.byteOffset = offset;\n    }\n  };\n\n  DataViewPrototype = $DataView[PROTOTYPE];\n\n  if (DESCRIPTORS) {\n    addGetter($ArrayBuffer, 'byteLength');\n    addGetter($DataView, 'buffer');\n    addGetter($DataView, 'byteLength');\n    addGetter($DataView, 'byteOffset');\n  }\n\n  redefineAll(DataViewPrototype, {\n    getInt8: function getInt8(byteOffset) {\n      return get(this, 1, byteOffset)[0] << 24 >> 24;\n    },\n    getUint8: function getUint8(byteOffset) {\n      return get(this, 1, byteOffset)[0];\n    },\n    getInt16: function getInt16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);\n      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;\n    },\n    getUint16: function getUint16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);\n      return bytes[1] << 8 | bytes[0];\n    },\n    getInt32: function getInt32(byteOffset /* , littleEndian */) {\n      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined));\n    },\n    getUint32: function getUint32(byteOffset /* , littleEndian */) {\n      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined)) >>> 0;\n    },\n    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 23);\n    },\n    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 8, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 52);\n    },\n    setInt8: function setInt8(byteOffset, value) {\n      set(this, 1, byteOffset, packInt8, value);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      set(this, 1, byteOffset, packInt8, value);\n    },\n    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packFloat32, value, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {\n      set(this, 8, byteOffset, packFloat64, value, arguments.length > 2 ? arguments[2] : undefined);\n    }\n  });\n} else {\n  var INCORRECT_ARRAY_BUFFER_NAME = PROPER_FUNCTION_NAME && NativeArrayBuffer.name !== ARRAY_BUFFER;\n  /* eslint-disable no-new -- required for testing */\n  if (!fails(function () {\n    NativeArrayBuffer(1);\n  }) || !fails(function () {\n    new NativeArrayBuffer(-1);\n  }) || fails(function () {\n    new NativeArrayBuffer();\n    new NativeArrayBuffer(1.5);\n    new NativeArrayBuffer(NaN);\n    return INCORRECT_ARRAY_BUFFER_NAME && !CONFIGURABLE_FUNCTION_NAME;\n  })) {\n  /* eslint-enable no-new -- required for testing */\n    $ArrayBuffer = function ArrayBuffer(length) {\n      anInstance(this, ArrayBufferPrototype);\n      return new NativeArrayBuffer(toIndex(length));\n    };\n\n    $ArrayBuffer[PROTOTYPE] = ArrayBufferPrototype;\n\n    for (var keys = getOwnPropertyNames(NativeArrayBuffer), j = 0, key; keys.length > j;) {\n      if (!((key = keys[j++]) in $ArrayBuffer)) {\n        createNonEnumerableProperty($ArrayBuffer, key, NativeArrayBuffer[key]);\n      }\n    }\n\n    ArrayBufferPrototype.constructor = $ArrayBuffer;\n  } else if (INCORRECT_ARRAY_BUFFER_NAME && CONFIGURABLE_FUNCTION_NAME) {\n    createNonEnumerableProperty(NativeArrayBuffer, 'name', ARRAY_BUFFER);\n  }\n\n  // WebKit bug - the same parent prototype for typed arrays and data view\n  if (setPrototypeOf && getPrototypeOf(DataViewPrototype) !== ObjectPrototype) {\n    setPrototypeOf(DataViewPrototype, ObjectPrototype);\n  }\n\n  // iOS Safari 7.x bug\n  var testView = new $DataView(new $ArrayBuffer(2));\n  var $setInt8 = uncurryThis(DataViewPrototype.setInt8);\n  testView.setInt8(0, 2147483648);\n  testView.setInt8(1, 2147483649);\n  if (testView.getInt8(0) || !testView.getInt8(1)) redefineAll(DataViewPrototype, {\n    setInt8: function setInt8(byteOffset, value) {\n      $setInt8(this, byteOffset, value << 24 >> 24);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      $setInt8(this, byteOffset, value << 24 >> 24);\n    }\n  }, { unsafe: true });\n}\n\nsetToStringTag($ArrayBuffer, ARRAY_BUFFER);\nsetToStringTag($DataView, DATA_VIEW);\n\nmodule.exports = {\n  ArrayBuffer: $ArrayBuffer,\n  DataView: $DataView\n};\n","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = lengthOfArrayLike(O);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","var isObject = require('../internals/is-object');\n\nvar floor = Math.floor;\n\n// `IsIntegralNumber` abstract operation\n// https://tc39.es/ecma262/#sec-isintegralnumber\n// eslint-disable-next-line es/no-number-isinteger -- safe\nmodule.exports = Number.isInteger || function isInteger(it) {\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n","var global = require('../internals/global');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar RangeError = global.RangeError;\n\nmodule.exports = function (it) {\n  var result = toIntegerOrInfinity(it);\n  if (result < 0) throw RangeError(\"The argument can't be less than 0\");\n  return result;\n};\n","var global = require('../internals/global');\nvar toPositiveInteger = require('../internals/to-positive-integer');\n\nvar RangeError = global.RangeError;\n\nmodule.exports = function (it, BYTES) {\n  var offset = toPositiveInteger(it);\n  if (offset % BYTES) throw RangeError('Wrong offset');\n  return offset;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar ArrayBufferModule = require('../internals/array-buffer');\nvar anInstance = require('../internals/an-instance');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar isIntegralNumber = require('../internals/is-integral-number');\nvar toLength = require('../internals/to-length');\nvar toIndex = require('../internals/to-index');\nvar toOffset = require('../internals/to-offset');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar classof = require('../internals/classof');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar create = require('../internals/object-create');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar typedArrayFrom = require('../internals/typed-array-from');\nvar forEach = require('../internals/array-iteration').forEach;\nvar setSpecies = require('../internals/set-species');\nvar definePropertyModule = require('../internals/object-define-property');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar InternalStateModule = require('../internals/internal-state');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar nativeDefineProperty = definePropertyModule.f;\nvar nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\nvar round = Math.round;\nvar RangeError = global.RangeError;\nvar ArrayBuffer = ArrayBufferModule.ArrayBuffer;\nvar ArrayBufferPrototype = ArrayBuffer.prototype;\nvar DataView = ArrayBufferModule.DataView;\nvar NATIVE_ARRAY_BUFFER_VIEWS = ArrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS;\nvar TYPED_ARRAY_CONSTRUCTOR = ArrayBufferViewCore.TYPED_ARRAY_CONSTRUCTOR;\nvar TYPED_ARRAY_TAG = ArrayBufferViewCore.TYPED_ARRAY_TAG;\nvar TypedArray = ArrayBufferViewCore.TypedArray;\nvar TypedArrayPrototype = ArrayBufferViewCore.TypedArrayPrototype;\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\nvar isTypedArray = ArrayBufferViewCore.isTypedArray;\nvar BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';\nvar WRONG_LENGTH = 'Wrong length';\n\nvar fromList = function (C, list) {\n  aTypedArrayConstructor(C);\n  var index = 0;\n  var length = list.length;\n  var result = new C(length);\n  while (length > index) result[index] = list[index++];\n  return result;\n};\n\nvar addGetter = function (it, key) {\n  nativeDefineProperty(it, key, { get: function () {\n    return getInternalState(this)[key];\n  } });\n};\n\nvar isArrayBuffer = function (it) {\n  var klass;\n  return isPrototypeOf(ArrayBufferPrototype, it) || (klass = classof(it)) == 'ArrayBuffer' || klass == 'SharedArrayBuffer';\n};\n\nvar isTypedArrayIndex = function (target, key) {\n  return isTypedArray(target)\n    && !isSymbol(key)\n    && key in target\n    && isIntegralNumber(+key)\n    && key >= 0;\n};\n\nvar wrappedGetOwnPropertyDescriptor = function getOwnPropertyDescriptor(target, key) {\n  key = toPropertyKey(key);\n  return isTypedArrayIndex(target, key)\n    ? createPropertyDescriptor(2, target[key])\n    : nativeGetOwnPropertyDescriptor(target, key);\n};\n\nvar wrappedDefineProperty = function defineProperty(target, key, descriptor) {\n  key = toPropertyKey(key);\n  if (isTypedArrayIndex(target, key)\n    && isObject(descriptor)\n    && hasOwn(descriptor, 'value')\n    && !hasOwn(descriptor, 'get')\n    && !hasOwn(descriptor, 'set')\n    // TODO: add validation descriptor w/o calling accessors\n    && !descriptor.configurable\n    && (!hasOwn(descriptor, 'writable') || descriptor.writable)\n    && (!hasOwn(descriptor, 'enumerable') || descriptor.enumerable)\n  ) {\n    target[key] = descriptor.value;\n    return target;\n  } return nativeDefineProperty(target, key, descriptor);\n};\n\nif (DESCRIPTORS) {\n  if (!NATIVE_ARRAY_BUFFER_VIEWS) {\n    getOwnPropertyDescriptorModule.f = wrappedGetOwnPropertyDescriptor;\n    definePropertyModule.f = wrappedDefineProperty;\n    addGetter(TypedArrayPrototype, 'buffer');\n    addGetter(TypedArrayPrototype, 'byteOffset');\n    addGetter(TypedArrayPrototype, 'byteLength');\n    addGetter(TypedArrayPrototype, 'length');\n  }\n\n  $({ target: 'Object', stat: true, forced: !NATIVE_ARRAY_BUFFER_VIEWS }, {\n    getOwnPropertyDescriptor: wrappedGetOwnPropertyDescriptor,\n    defineProperty: wrappedDefineProperty\n  });\n\n  module.exports = function (TYPE, wrapper, CLAMPED) {\n    var BYTES = TYPE.match(/\\d+$/)[0] / 8;\n    var CONSTRUCTOR_NAME = TYPE + (CLAMPED ? 'Clamped' : '') + 'Array';\n    var GETTER = 'get' + TYPE;\n    var SETTER = 'set' + TYPE;\n    var NativeTypedArrayConstructor = global[CONSTRUCTOR_NAME];\n    var TypedArrayConstructor = NativeTypedArrayConstructor;\n    var TypedArrayConstructorPrototype = TypedArrayConstructor && TypedArrayConstructor.prototype;\n    var exported = {};\n\n    var getter = function (that, index) {\n      var data = getInternalState(that);\n      return data.view[GETTER](index * BYTES + data.byteOffset, true);\n    };\n\n    var setter = function (that, index, value) {\n      var data = getInternalState(that);\n      if (CLAMPED) value = (value = round(value)) < 0 ? 0 : value > 0xFF ? 0xFF : value & 0xFF;\n      data.view[SETTER](index * BYTES + data.byteOffset, value, true);\n    };\n\n    var addElement = function (that, index) {\n      nativeDefineProperty(that, index, {\n        get: function () {\n          return getter(this, index);\n        },\n        set: function (value) {\n          return setter(this, index, value);\n        },\n        enumerable: true\n      });\n    };\n\n    if (!NATIVE_ARRAY_BUFFER_VIEWS) {\n      TypedArrayConstructor = wrapper(function (that, data, offset, $length) {\n        anInstance(that, TypedArrayConstructorPrototype);\n        var index = 0;\n        var byteOffset = 0;\n        var buffer, byteLength, length;\n        if (!isObject(data)) {\n          length = toIndex(data);\n          byteLength = length * BYTES;\n          buffer = new ArrayBuffer(byteLength);\n        } else if (isArrayBuffer(data)) {\n          buffer = data;\n          byteOffset = toOffset(offset, BYTES);\n          var $len = data.byteLength;\n          if ($length === undefined) {\n            if ($len % BYTES) throw RangeError(WRONG_LENGTH);\n            byteLength = $len - byteOffset;\n            if (byteLength < 0) throw RangeError(WRONG_LENGTH);\n          } else {\n            byteLength = toLength($length) * BYTES;\n            if (byteLength + byteOffset > $len) throw RangeError(WRONG_LENGTH);\n          }\n          length = byteLength / BYTES;\n        } else if (isTypedArray(data)) {\n          return fromList(TypedArrayConstructor, data);\n        } else {\n          return call(typedArrayFrom, TypedArrayConstructor, data);\n        }\n        setInternalState(that, {\n          buffer: buffer,\n          byteOffset: byteOffset,\n          byteLength: byteLength,\n          length: length,\n          view: new DataView(buffer)\n        });\n        while (index < length) addElement(that, index++);\n      });\n\n      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);\n      TypedArrayConstructorPrototype = TypedArrayConstructor.prototype = create(TypedArrayPrototype);\n    } else if (TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS) {\n      TypedArrayConstructor = wrapper(function (dummy, data, typedArrayOffset, $length) {\n        anInstance(dummy, TypedArrayConstructorPrototype);\n        return inheritIfRequired(function () {\n          if (!isObject(data)) return new NativeTypedArrayConstructor(toIndex(data));\n          if (isArrayBuffer(data)) return $length !== undefined\n            ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES), $length)\n            : typedArrayOffset !== undefined\n              ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES))\n              : new NativeTypedArrayConstructor(data);\n          if (isTypedArray(data)) return fromList(TypedArrayConstructor, data);\n          return call(typedArrayFrom, TypedArrayConstructor, data);\n        }(), dummy, TypedArrayConstructor);\n      });\n\n      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);\n      forEach(getOwnPropertyNames(NativeTypedArrayConstructor), function (key) {\n        if (!(key in TypedArrayConstructor)) {\n          createNonEnumerableProperty(TypedArrayConstructor, key, NativeTypedArrayConstructor[key]);\n        }\n      });\n      TypedArrayConstructor.prototype = TypedArrayConstructorPrototype;\n    }\n\n    if (TypedArrayConstructorPrototype.constructor !== TypedArrayConstructor) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, 'constructor', TypedArrayConstructor);\n    }\n\n    createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_CONSTRUCTOR, TypedArrayConstructor);\n\n    if (TYPED_ARRAY_TAG) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_TAG, CONSTRUCTOR_NAME);\n    }\n\n    exported[CONSTRUCTOR_NAME] = TypedArrayConstructor;\n\n    $({\n      global: true, forced: TypedArrayConstructor != NativeTypedArrayConstructor, sham: !NATIVE_ARRAY_BUFFER_VIEWS\n    }, exported);\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayConstructor)) {\n      createNonEnumerableProperty(TypedArrayConstructor, BYTES_PER_ELEMENT, BYTES);\n    }\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayConstructorPrototype)) {\n      createNonEnumerableProperty(TypedArrayConstructorPrototype, BYTES_PER_ELEMENT, BYTES);\n    }\n\n    setSpecies(CONSTRUCTOR_NAME);\n  };\n} else module.exports = function () { /* empty */ };\n","var bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aConstructor = require('../internals/a-constructor');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar aTypedArrayConstructor = require('../internals/array-buffer-view-core').aTypedArrayConstructor;\n\nmodule.exports = function from(source /* , mapfn, thisArg */) {\n  var C = aConstructor(this);\n  var O = toObject(source);\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var iteratorMethod = getIteratorMethod(O);\n  var i, length, result, step, iterator, next;\n  if (iteratorMethod && !isArrayIteratorMethod(iteratorMethod)) {\n    iterator = getIterator(O, iteratorMethod);\n    next = iterator.next;\n    O = [];\n    while (!(step = call(next, iterator)).done) {\n      O.push(step.value);\n    }\n  }\n  if (mapping && argumentsLength > 2) {\n    mapfn = bind(mapfn, arguments[2]);\n  }\n  length = lengthOfArrayLike(O);\n  result = new (aTypedArrayConstructor(C))(length);\n  for (i = 0; length > i; i++) {\n    result[i] = mapping ? mapfn(O[i], i) : O[i];\n  }\n  return result;\n};\n","var bind = require('../internals/function-bind-context');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = uncurryThis([].push);\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex, filterReject }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var IS_FILTER_REJECT = TYPE == 7;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that);\n    var length = lengthOfArrayLike(self);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER || IS_FILTER_REJECT ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push(target, value);      // filter\n        } else switch (TYPE) {\n          case 4: return false;             // every\n          case 7: push(target, value);      // filterReject\n        }\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.es/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.es/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.es/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.es/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.es/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.es/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.es/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6),\n  // `Array.prototype.filterReject` method\n  // https://github.com/tc39/proposal-array-filtering\n  filterReject: createMethod(7)\n};\n","var isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    isCallable(NewTarget = dummy.constructor) &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float32', function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float64Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float64', function (init) {\n  return function Float64Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int8Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int8', function (init) {\n  return function Int8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int16Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int16', function (init) {\n  return function Int16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Int32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Int32', function (init) {\n  return function Int32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint8Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint8', function (init) {\n  return function Uint8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint8ClampedArray` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint8', function (init) {\n  return function Uint8ClampedArray(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n}, true);\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint16Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint16', function (init) {\n  return function Uint16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint32', function (init) {\n  return function Uint32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","'use strict';\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\nvar exportTypedArrayStaticMethod = require('../internals/array-buffer-view-core').exportTypedArrayStaticMethod;\nvar typedArrayFrom = require('../internals/typed-array-from');\n\n// `%TypedArray%.from` method\n// https://tc39.es/ecma262/#sec-%typedarray%.from\nexportTypedArrayStaticMethod('from', typedArrayFrom, TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS);\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = require('../internals/typed-array-constructors-require-wrappers');\n\nvar aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;\nvar exportTypedArrayStaticMethod = ArrayBufferViewCore.exportTypedArrayStaticMethod;\n\n// `%TypedArray%.of` method\n// https://tc39.es/ecma262/#sec-%typedarray%.of\nexportTypedArrayStaticMethod('of', function of(/* ...items */) {\n  var index = 0;\n  var length = arguments.length;\n  var result = new (aTypedArrayConstructor(this))(length);\n  while (length > index) result[index] = arguments[index++];\n  return result;\n}, TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS);\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar replace = uncurryThis(''.replace);\n\nvar TEST = (function (arg) { return String(Error(arg).stack); })('zxcasd');\nvar V8_OR_CHAKRA_STACK_ENTRY = /\\n\\s*at [^:]*:[^\\n]*/;\nvar IS_V8_OR_CHAKRA_STACK = V8_OR_CHAKRA_STACK_ENTRY.test(TEST);\n\nmodule.exports = function (stack, dropEntries) {\n  if (IS_V8_OR_CHAKRA_STACK && typeof stack == 'string') {\n    while (dropEntries--) stack = replace(stack, V8_OR_CHAKRA_STACK_ENTRY, '');\n  } return stack;\n};\n","var isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\n// `InstallErrorCause` abstract operation\n// https://tc39.es/proposal-error-cause/#sec-errorobjects-install-error-cause\nmodule.exports = function (O, options) {\n  if (isObject(options) && 'cause' in options) {\n    createNonEnumerableProperty(O, 'cause', options.cause);\n  }\n};\n","var toString = require('../internals/to-string');\n\nmodule.exports = function (argument, $default) {\n  return argument === undefined ? arguments.length < 2 ? '' : $default : toString(argument);\n};\n","var fails = require('../internals/fails');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = !fails(function () {\n  var error = Error('a');\n  if (!('stack' in error)) return true;\n  // eslint-disable-next-line es/no-object-defineproperty -- safe\n  Object.defineProperty(error, 'stack', createPropertyDescriptor(1, 7));\n  return error.stack !== 7;\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar create = require('../internals/object-create');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar clearErrorStack = require('../internals/clear-error-stack');\nvar installErrorCause = require('../internals/install-error-cause');\nvar iterate = require('../internals/iterate');\nvar normalizeStringArgument = require('../internals/normalize-string-argument');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar ERROR_STACK_INSTALLABLE = require('../internals/error-stack-installable');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar Error = global.Error;\nvar push = [].push;\n\nvar $AggregateError = function AggregateError(errors, message /* , options */) {\n  var options = arguments.length > 2 ? arguments[2] : undefined;\n  var isInstance = isPrototypeOf(AggregateErrorPrototype, this);\n  var that;\n  if (setPrototypeOf) {\n    that = setPrototypeOf(new Error(), isInstance ? getPrototypeOf(this) : AggregateErrorPrototype);\n  } else {\n    that = isInstance ? this : create(AggregateErrorPrototype);\n    createNonEnumerableProperty(that, TO_STRING_TAG, 'Error');\n  }\n  if (message !== undefined) createNonEnumerableProperty(that, 'message', normalizeStringArgument(message));\n  if (ERROR_STACK_INSTALLABLE) createNonEnumerableProperty(that, 'stack', clearErrorStack(that.stack, 1));\n  installErrorCause(that, options);\n  var errorsArray = [];\n  iterate(errors, push, { that: errorsArray });\n  createNonEnumerableProperty(that, 'errors', errorsArray);\n  return that;\n};\n\nif (setPrototypeOf) setPrototypeOf($AggregateError, Error);\nelse copyConstructorProperties($AggregateError, Error, { name: true });\n\nvar AggregateErrorPrototype = $AggregateError.prototype = create(Error.prototype, {\n  constructor: createPropertyDescriptor(1, $AggregateError),\n  message: createPropertyDescriptor(1, ''),\n  name: createPropertyDescriptor(1, 'AggregateError')\n});\n\n// `AggregateError` constructor\n// https://tc39.es/ecma262/#sec-aggregate-error-constructor\n$({ global: true }, {\n  AggregateError: $AggregateError\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar defineProperty = require('../internals/object-define-property').f;\n\n// `Array.prototype.lastIndex` getter\n// https://github.com/keithamus/proposal-array-last\nif (DESCRIPTORS && !('lastIndex' in [])) {\n  defineProperty(Array.prototype, 'lastIndex', {\n    configurable: true,\n    get: function lastIndex() {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return len == 0 ? 0 : len - 1;\n    }\n  });\n\n  addToUnscopables('lastIndex');\n}\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar defineProperty = require('../internals/object-define-property').f;\n\n// `Array.prototype.lastIndex` accessor\n// https://github.com/keithamus/proposal-array-last\nif (DESCRIPTORS && !('lastItem' in [])) {\n  defineProperty(Array.prototype, 'lastItem', {\n    configurable: true,\n    get: function lastItem() {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return len == 0 ? undefined : O[len - 1];\n    },\n    set: function lastItem(value) {\n      var O = toObject(this);\n      var len = lengthOfArrayLike(O);\n      return O[len == 0 ? 0 : len - 1] = value;\n    }\n  });\n\n  addToUnscopables('lastItem');\n}\n","/* eslint-disable es/no-object-getownpropertynames -- safe */\nvar classof = require('../internals/classof-raw');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar $getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar arraySlice = require('../internals/array-slice-simple');\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return $getOwnPropertyNames(it);\n  } catch (error) {\n    return arraySlice(windowNames);\n  }\n};\n\n// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && classof(it) == 'Window'\n    ? getWindowNames(it)\n    : $getOwnPropertyNames(toIndexedObject(it));\n};\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertyNamesExternalModule = require('../internals/object-get-own-property-names-external');\nvar isExtensible = require('../internals/object-is-extensible');\nvar uid = require('../internals/uid');\nvar FREEZING = require('../internals/freezing');\n\nvar REQUIRED = false;\nvar METADATA = uid('meta');\nvar id = 0;\n\nvar setMetadata = function (it) {\n  defineProperty(it, METADATA, { value: {\n    objectID: 'O' + id++, // object ID\n    weakData: {}          // weak collections IDs\n  } });\n};\n\nvar fastKey = function (it, create) {\n  // return a primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMetadata(it);\n  // return object ID\n  } return it[METADATA].objectID;\n};\n\nvar getWeakData = function (it, create) {\n  if (!hasOwn(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMetadata(it);\n  // return the store of weak collections IDs\n  } return it[METADATA].weakData;\n};\n\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZING && REQUIRED && isExtensible(it) && !hasOwn(it, METADATA)) setMetadata(it);\n  return it;\n};\n\nvar enable = function () {\n  meta.enable = function () { /* empty */ };\n  REQUIRED = true;\n  var getOwnPropertyNames = getOwnPropertyNamesModule.f;\n  var splice = uncurryThis([].splice);\n  var test = {};\n  test[METADATA] = 1;\n\n  // prevent exposing of metadata key\n  if (getOwnPropertyNames(test).length) {\n    getOwnPropertyNamesModule.f = function (it) {\n      var result = getOwnPropertyNames(it);\n      for (var i = 0, length = result.length; i < length; i++) {\n        if (result[i] === METADATA) {\n          splice(result, i, 1);\n          break;\n        }\n      } return result;\n    };\n\n    $({ target: 'Object', stat: true, forced: true }, {\n      getOwnPropertyNames: getOwnPropertyNamesExternalModule.f\n    });\n  }\n};\n\nvar meta = module.exports = {\n  enable: enable,\n  fastKey: fastKey,\n  getWeakData: getWeakData,\n  onFreeze: onFreeze\n};\n\nhiddenKeys[METADATA] = true;\n","// FF26- bug: ArrayBuffers are non-extensible, but Object.isExtensible does not report it\nvar fails = require('../internals/fails');\n\nmodule.exports = fails(function () {\n  if (typeof ArrayBuffer == 'function') {\n    var buffer = new ArrayBuffer(8);\n    // eslint-disable-next-line es/no-object-isextensible, es/no-object-defineproperty -- safe\n    if (Object.isExtensible(buffer)) Object.defineProperty(buffer, 'a', { value: 8 });\n  }\n});\n","var fails = require('../internals/fails');\nvar isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar ARRAY_BUFFER_NON_EXTENSIBLE = require('../internals/array-buffer-non-extensible');\n\n// eslint-disable-next-line es/no-object-isextensible -- safe\nvar $isExtensible = Object.isExtensible;\nvar FAILS_ON_PRIMITIVES = fails(function () { $isExtensible(1); });\n\n// `Object.isExtensible` method\n// https://tc39.es/ecma262/#sec-object.isextensible\nmodule.exports = (FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE) ? function isExtensible(it) {\n  if (!isObject(it)) return false;\n  if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return false;\n  return $isExtensible ? $isExtensible(it) : true;\n} : $isExtensible;\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-isextensible, es/no-object-preventextensions -- required for testing\n  return Object.isExtensible(Object.preventExtensions({}));\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar iterate = require('../internals/iterate');\nvar anInstance = require('../internals/an-instance');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nmodule.exports = function (CONSTRUCTOR_NAME, wrapper, common) {\n  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;\n  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var NativeConstructor = global[CONSTRUCTOR_NAME];\n  var NativePrototype = NativeConstructor && NativeConstructor.prototype;\n  var Constructor = NativeConstructor;\n  var exported = {};\n\n  var fixMethod = function (KEY) {\n    var uncurriedNativeMethod = uncurryThis(NativePrototype[KEY]);\n    redefine(NativePrototype, KEY,\n      KEY == 'add' ? function add(value) {\n        uncurriedNativeMethod(this, value === 0 ? 0 : value);\n        return this;\n      } : KEY == 'delete' ? function (key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'get' ? function get(key) {\n        return IS_WEAK && !isObject(key) ? undefined : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : KEY == 'has' ? function has(key) {\n        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);\n      } : function set(key, value) {\n        uncurriedNativeMethod(this, key === 0 ? 0 : key, value);\n        return this;\n      }\n    );\n  };\n\n  var REPLACE = isForced(\n    CONSTRUCTOR_NAME,\n    !isCallable(NativeConstructor) || !(IS_WEAK || NativePrototype.forEach && !fails(function () {\n      new NativeConstructor().entries().next();\n    }))\n  );\n\n  if (REPLACE) {\n    // create collection constructor\n    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);\n    InternalMetadataModule.enable();\n  } else if (isForced(CONSTRUCTOR_NAME, true)) {\n    var instance = new Constructor();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    // eslint-disable-next-line no-new -- required for testing\n    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new NativeConstructor();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n\n    if (!ACCEPT_ITERABLES) {\n      Constructor = wrapper(function (dummy, iterable) {\n        anInstance(dummy, NativePrototype);\n        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);\n        if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n        return that;\n      });\n      Constructor.prototype = NativePrototype;\n      NativePrototype.constructor = Constructor;\n    }\n\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n\n    // weak collections should not contains .clear method\n    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;\n  }\n\n  exported[CONSTRUCTOR_NAME] = Constructor;\n  $({ global: true, forced: Constructor != NativeConstructor }, exported);\n\n  setToStringTag(Constructor, CONSTRUCTOR_NAME);\n\n  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);\n\n  return Constructor;\n};\n","'use strict';\nvar defineProperty = require('../internals/object-define-property').f;\nvar create = require('../internals/object-create');\nvar redefineAll = require('../internals/redefine-all');\nvar bind = require('../internals/function-bind-context');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar defineIterator = require('../internals/define-iterator');\nvar setSpecies = require('../internals/set-species');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fastKey = require('../internals/internal-metadata').fastKey;\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var Constructor = wrapper(function (that, iterable) {\n      anInstance(that, Prototype);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        index: create(null),\n        first: undefined,\n        last: undefined,\n        size: 0\n      });\n      if (!DESCRIPTORS) that.size = 0;\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var Prototype = Constructor.prototype;\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var entry = getEntry(that, key);\n      var previous, index;\n      // change existing entry\n      if (entry) {\n        entry.value = value;\n      // create new entry\n      } else {\n        state.last = entry = {\n          index: index = fastKey(key, true),\n          key: key,\n          value: value,\n          previous: previous = state.last,\n          next: undefined,\n          removed: false\n        };\n        if (!state.first) state.first = entry;\n        if (previous) previous.next = entry;\n        if (DESCRIPTORS) state.size++;\n        else that.size++;\n        // add to index\n        if (index !== 'F') state.index[index] = entry;\n      } return that;\n    };\n\n    var getEntry = function (that, key) {\n      var state = getInternalState(that);\n      // fast case\n      var index = fastKey(key);\n      var entry;\n      if (index !== 'F') return state.index[index];\n      // frozen object case\n      for (entry = state.first; entry; entry = entry.next) {\n        if (entry.key == key) return entry;\n      }\n    };\n\n    redefineAll(Prototype, {\n      // `{ Map, Set }.prototype.clear()` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.clear\n      // https://tc39.es/ecma262/#sec-set.prototype.clear\n      clear: function clear() {\n        var that = this;\n        var state = getInternalState(that);\n        var data = state.index;\n        var entry = state.first;\n        while (entry) {\n          entry.removed = true;\n          if (entry.previous) entry.previous = entry.previous.next = undefined;\n          delete data[entry.index];\n          entry = entry.next;\n        }\n        state.first = state.last = undefined;\n        if (DESCRIPTORS) state.size = 0;\n        else that.size = 0;\n      },\n      // `{ Map, Set }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.delete\n      // https://tc39.es/ecma262/#sec-set.prototype.delete\n      'delete': function (key) {\n        var that = this;\n        var state = getInternalState(that);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.next;\n          var prev = entry.previous;\n          delete state.index[entry.index];\n          entry.removed = true;\n          if (prev) prev.next = next;\n          if (next) next.previous = prev;\n          if (state.first == entry) state.first = next;\n          if (state.last == entry) state.last = prev;\n          if (DESCRIPTORS) state.size--;\n          else that.size--;\n        } return !!entry;\n      },\n      // `{ Map, Set }.prototype.forEach(callbackfn, thisArg = undefined)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.foreach\n      // https://tc39.es/ecma262/#sec-set.prototype.foreach\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        var state = getInternalState(this);\n        var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n        var entry;\n        while (entry = entry ? entry.next : state.first) {\n          boundFunction(entry.value, entry.key, this);\n          // revert to the last existing entry\n          while (entry && entry.removed) entry = entry.previous;\n        }\n      },\n      // `{ Map, Set}.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-map.prototype.has\n      // https://tc39.es/ecma262/#sec-set.prototype.has\n      has: function has(key) {\n        return !!getEntry(this, key);\n      }\n    });\n\n    redefineAll(Prototype, IS_MAP ? {\n      // `Map.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.get\n      get: function get(key) {\n        var entry = getEntry(this, key);\n        return entry && entry.value;\n      },\n      // `Map.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-map.prototype.set\n      set: function set(key, value) {\n        return define(this, key === 0 ? 0 : key, value);\n      }\n    } : {\n      // `Set.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-set.prototype.add\n      add: function add(value) {\n        return define(this, value = value === 0 ? 0 : value, value);\n      }\n    });\n    if (DESCRIPTORS) defineProperty(Prototype, 'size', {\n      get: function () {\n        return getInternalState(this).size;\n      }\n    });\n    return Constructor;\n  },\n  setStrong: function (Constructor, CONSTRUCTOR_NAME, IS_MAP) {\n    var ITERATOR_NAME = CONSTRUCTOR_NAME + ' Iterator';\n    var getInternalCollectionState = internalStateGetterFor(CONSTRUCTOR_NAME);\n    var getInternalIteratorState = internalStateGetterFor(ITERATOR_NAME);\n    // `{ Map, Set }.prototype.{ keys, values, entries, @@iterator }()` methods\n    // https://tc39.es/ecma262/#sec-map.prototype.entries\n    // https://tc39.es/ecma262/#sec-map.prototype.keys\n    // https://tc39.es/ecma262/#sec-map.prototype.values\n    // https://tc39.es/ecma262/#sec-map.prototype-@@iterator\n    // https://tc39.es/ecma262/#sec-set.prototype.entries\n    // https://tc39.es/ecma262/#sec-set.prototype.keys\n    // https://tc39.es/ecma262/#sec-set.prototype.values\n    // https://tc39.es/ecma262/#sec-set.prototype-@@iterator\n    defineIterator(Constructor, CONSTRUCTOR_NAME, function (iterated, kind) {\n      setInternalState(this, {\n        type: ITERATOR_NAME,\n        target: iterated,\n        state: getInternalCollectionState(iterated),\n        kind: kind,\n        last: undefined\n      });\n    }, function () {\n      var state = getInternalIteratorState(this);\n      var kind = state.kind;\n      var entry = state.last;\n      // revert to the last existing entry\n      while (entry && entry.removed) entry = entry.previous;\n      // get next entry\n      if (!state.target || !(state.last = entry = entry ? entry.next : state.state.first)) {\n        // or finish the iteration\n        state.target = undefined;\n        return { value: undefined, done: true };\n      }\n      // return step by kind\n      if (kind == 'keys') return { value: entry.key, done: false };\n      if (kind == 'values') return { value: entry.value, done: false };\n      return { value: [entry.key, entry.value], done: false };\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // `{ Map, Set }.prototype[@@species]` accessors\n    // https://tc39.es/ecma262/#sec-get-map-@@species\n    // https://tc39.es/ecma262/#sec-get-set-@@species\n    setSpecies(CONSTRUCTOR_NAME);\n  }\n};\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Map` constructor\n// https://tc39.es/ecma262/#sec-map-objects\ncollection('Map', function (init) {\n  return function Map() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar getWeakData = require('../internals/internal-metadata').getWeakData;\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar ArrayIterationModule = require('../internals/array-iteration');\nvar hasOwn = require('../internals/has-own-property');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\nvar find = ArrayIterationModule.find;\nvar findIndex = ArrayIterationModule.findIndex;\nvar splice = uncurryThis([].splice);\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (store) {\n  return store.frozen || (store.frozen = new UncaughtFrozenStore());\n};\n\nvar UncaughtFrozenStore = function () {\n  this.entries = [];\n};\n\nvar findUncaughtFrozen = function (store, key) {\n  return find(store.entries, function (it) {\n    return it[0] === key;\n  });\n};\n\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.entries.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = findIndex(this.entries, function (it) {\n      return it[0] === key;\n    });\n    if (~index) splice(this.entries, index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var Constructor = wrapper(function (that, iterable) {\n      anInstance(that, Prototype);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        id: id++,\n        frozen: undefined\n      });\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var Prototype = Constructor.prototype;\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var data = getWeakData(anObject(key), true);\n      if (data === true) uncaughtFrozenStore(state).set(key, value);\n      else data[state.id] = value;\n      return that;\n    };\n\n    redefineAll(Prototype, {\n      // `{ WeakMap, WeakSet }.prototype.delete(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.delete\n      // https://tc39.es/ecma262/#sec-weakset.prototype.delete\n      'delete': function (key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state)['delete'](key);\n        return data && hasOwn(data, state.id) && delete data[state.id];\n      },\n      // `{ WeakMap, WeakSet }.prototype.has(key)` methods\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.has\n      // https://tc39.es/ecma262/#sec-weakset.prototype.has\n      has: function has(key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state).has(key);\n        return data && hasOwn(data, state.id);\n      }\n    });\n\n    redefineAll(Prototype, IS_MAP ? {\n      // `WeakMap.prototype.get(key)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.get\n      get: function get(key) {\n        var state = getInternalState(this);\n        if (isObject(key)) {\n          var data = getWeakData(key);\n          if (data === true) return uncaughtFrozenStore(state).get(key);\n          return data ? data[state.id] : undefined;\n        }\n      },\n      // `WeakMap.prototype.set(key, value)` method\n      // https://tc39.es/ecma262/#sec-weakmap.prototype.set\n      set: function set(key, value) {\n        return define(this, key, value);\n      }\n    } : {\n      // `WeakSet.prototype.add(value)` method\n      // https://tc39.es/ecma262/#sec-weakset.prototype.add\n      add: function add(value) {\n        return define(this, value, true);\n      }\n    });\n\n    return Constructor;\n  }\n};\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar redefineAll = require('../internals/redefine-all');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar collection = require('../internals/collection');\nvar collectionWeak = require('../internals/collection-weak');\nvar isObject = require('../internals/is-object');\nvar isExtensible = require('../internals/object-is-extensible');\nvar enforceInternalState = require('../internals/internal-state').enforce;\nvar NATIVE_WEAK_MAP = require('../internals/native-weak-map');\n\nvar IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;\nvar InternalWeakMap;\n\nvar wrapper = function (init) {\n  return function WeakMap() {\n    return init(this, arguments.length ? arguments[0] : undefined);\n  };\n};\n\n// `WeakMap` constructor\n// https://tc39.es/ecma262/#sec-weakmap-constructor\nvar $WeakMap = collection('WeakMap', wrapper, collectionWeak);\n\n// IE11 WeakMap frozen keys fix\n// We can't use feature detection because it crash some old IE builds\n// https://github.com/zloirock/core-js/issues/485\nif (NATIVE_WEAK_MAP && IS_IE11) {\n  InternalWeakMap = collectionWeak.getConstructor(wrapper, 'WeakMap', true);\n  InternalMetadataModule.enable();\n  var WeakMapPrototype = $WeakMap.prototype;\n  var nativeDelete = uncurryThis(WeakMapPrototype['delete']);\n  var nativeHas = uncurryThis(WeakMapPrototype.has);\n  var nativeGet = uncurryThis(WeakMapPrototype.get);\n  var nativeSet = uncurryThis(WeakMapPrototype.set);\n  redefineAll(WeakMapPrototype, {\n    'delete': function (key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeDelete(this, key) || state.frozen['delete'](key);\n      } return nativeDelete(this, key);\n    },\n    has: function has(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) || state.frozen.has(key);\n      } return nativeHas(this, key);\n    },\n    get: function get(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas(this, key) ? nativeGet(this, key) : state.frozen.get(key);\n      } return nativeGet(this, key);\n    },\n    set: function set(key, value) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceInternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        nativeHas(this, key) ? nativeSet(this, key, value) : state.frozen.set(key, value);\n      } else nativeSet(this, key, value);\n      return this;\n    }\n  });\n}\n","// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.map');\nrequire('../modules/es.weak-map');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar create = require('../internals/object-create');\nvar isObject = require('../internals/is-object');\n\nvar Object = global.Object;\nvar TypeError = global.TypeError;\nvar Map = getBuiltIn('Map');\nvar WeakMap = getBuiltIn('WeakMap');\n\nvar Node = function () {\n  // keys\n  this.object = null;\n  this.symbol = null;\n  // child nodes\n  this.primitives = null;\n  this.objectsByIndex = create(null);\n};\n\nNode.prototype.get = function (key, initializer) {\n  return this[key] || (this[key] = initializer());\n};\n\nNode.prototype.next = function (i, it, IS_OBJECT) {\n  var store = IS_OBJECT\n    ? this.objectsByIndex[i] || (this.objectsByIndex[i] = new WeakMap())\n    : this.primitives || (this.primitives = new Map());\n  var entry = store.get(it);\n  if (!entry) store.set(it, entry = new Node());\n  return entry;\n};\n\nvar root = new Node();\n\nmodule.exports = function () {\n  var active = root;\n  var length = arguments.length;\n  var i, it;\n  // for prevent leaking, start from objects\n  for (i = 0; i < length; i++) {\n    if (isObject(it = arguments[i])) active = active.next(i, it, true);\n  }\n  if (this === Object && active === root) throw TypeError('Composite keys must contain a non-primitive component');\n  for (i = 0; i < length; i++) {\n    if (!isObject(it = arguments[i])) active = active.next(i, it, false);\n  } return active;\n};\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar apply = require('../internals/function-apply');\nvar getCompositeKeyNode = require('../internals/composite-key');\nvar getBuiltIn = require('../internals/get-built-in');\nvar create = require('../internals/object-create');\n\nvar Object = global.Object;\n\nvar initializer = function () {\n  var freeze = getBuiltIn('Object', 'freeze');\n  return freeze ? freeze(create(null)) : create(null);\n};\n\n// https://github.com/tc39/proposal-richer-keys/tree/master/compositeKey\n$({ global: true }, {\n  compositeKey: function compositeKey() {\n    return apply(getCompositeKeyNode, Object, arguments).get('object', initializer);\n  }\n});\n","var $ = require('../internals/export');\nvar getCompositeKeyNode = require('../internals/composite-key');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\n\n// https://github.com/tc39/proposal-richer-keys/tree/master/compositeKey\n$({ global: true }, {\n  compositeSymbol: function compositeSymbol() {\n    if (arguments.length == 1 && typeof arguments[0] == 'string') return getBuiltIn('Symbol')['for'](arguments[0]);\n    return apply(getCompositeKeyNode, null, arguments).get('symbol', getBuiltIn('Symbol'));\n  }\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\n\n// `globalThis` object\n// https://tc39.es/ecma262/#sec-globalthis\n$({ global: true }, {\n  globalThis: global\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `Map.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","module.exports = false;\n","'use strict';\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\n\n// https://github.com/tc39/collection-methods\nmodule.exports = function deleteAll(/* ...elements */) {\n  var collection = anObject(this);\n  var remover = aCallable(collection['delete']);\n  var allDeleted = true;\n  var wasDeleted;\n  for (var k = 0, len = arguments.length; k < len; k++) {\n    wasDeleted = call(remover, collection, arguments[k]);\n    allDeleted = allDeleted && wasDeleted;\n  }\n  return !!allDeleted;\n};\n","var call = require('../internals/function-call');\n\nmodule.exports = function (it) {\n  // eslint-disable-next-line es/no-map -- safe\n  return call(Map.prototype.entries, it);\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.every` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  every: function every(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return !iterate(iterator, function (key, value, stop) {\n      if (!boundFunction(value, key, map)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.filter` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      if (boundFunction(value, key, map)) call(setter, newMap, key, value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.find` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  find: function find(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop(value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.findKey` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  findKey: function findKey(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop(key);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar aConstructor = require('../internals/a-constructor');\nvar iterate = require('../internals/iterate');\n\nvar push = [].push;\n\nmodule.exports = function from(source /* , mapFn, thisArg */) {\n  var length = arguments.length;\n  var mapFn = length > 1 ? arguments[1] : undefined;\n  var mapping, array, n, boundFunction;\n  aConstructor(this);\n  mapping = mapFn !== undefined;\n  if (mapping) aCallable(mapFn);\n  if (source == undefined) return new this();\n  array = [];\n  if (mapping) {\n    n = 0;\n    boundFunction = bind(mapFn, length > 2 ? arguments[2] : undefined);\n    iterate(source, function (nextItem) {\n      call(push, array, boundFunction(nextItem, n++));\n    });\n  } else {\n    iterate(source, push, { that: array });\n  }\n  return new this(array);\n};\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `Map.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-map.from\n$({ target: 'Map', stat: true }, {\n  from: from\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar getIterator = require('../internals/get-iterator');\nvar iterate = require('../internals/iterate');\n\nvar push = uncurryThis([].push);\n\n// `Map.groupBy` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', stat: true }, {\n  groupBy: function groupBy(iterable, keyDerivative) {\n    aCallable(keyDerivative);\n    var iterator = getIterator(iterable);\n    var newMap = new this();\n    var has = aCallable(newMap.has);\n    var get = aCallable(newMap.get);\n    var set = aCallable(newMap.set);\n    iterate(iterator, function (element) {\n      var derivedKey = keyDerivative(element);\n      if (!call(has, newMap, derivedKey)) call(set, newMap, derivedKey, [element]);\n      else push(call(get, newMap, derivedKey), element);\n    }, { IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","// `SameValueZero` abstract operation\n// https://tc39.es/ecma262/#sec-samevaluezero\nmodule.exports = function (x, y) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return x === y || x != x && y != y;\n};\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar anObject = require('../internals/an-object');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar sameValueZero = require('../internals/same-value-zero');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.includes` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  includes: function includes(searchElement) {\n    return iterate(getMapIterator(anObject(this)), function (key, value, stop) {\n      if (sameValueZero(value, searchElement)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar iterate = require('../internals/iterate');\nvar aCallable = require('../internals/a-callable');\n\n// `Map.keyBy` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', stat: true }, {\n  keyBy: function keyBy(iterable, keyDerivative) {\n    var newMap = new this();\n    aCallable(keyDerivative);\n    var setter = aCallable(newMap.set);\n    iterate(iterable, function (element) {\n      call(setter, newMap, keyDerivative(element), element);\n    });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.keyOf` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  keyOf: function keyOf(searchElement) {\n    return iterate(getMapIterator(anObject(this)), function (key, value, stop) {\n      if (value === searchElement) return stop(key);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.mapKeys` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  mapKeys: function mapKeys(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      call(setter, newMap, boundFunction(value, key, map), value);\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.mapValues` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  mapValues: function mapValues(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newMap = new (speciesConstructor(map, getBuiltIn('Map')))();\n    var setter = aCallable(newMap.set);\n    iterate(iterator, function (key, value) {\n      call(setter, newMap, key, boundFunction(value, key, map));\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    return newMap;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Map.prototype.merge` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  merge: function merge(iterable /* ...iterables */) {\n    var map = anObject(this);\n    var setter = aCallable(map.set);\n    var argumentsLength = arguments.length;\n    var i = 0;\n    while (i < argumentsLength) {\n      iterate(arguments[i++], setter, { that: map, AS_ENTRIES: true });\n    }\n    return map;\n  }\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `Map.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-map.of\n$({ target: 'Map', stat: true }, {\n  of: of\n});\n","'use strict';\nvar arraySlice = require('../internals/array-slice');\n\n// https://tc39.github.io/proposal-setmap-offrom/\nmodule.exports = function of() {\n  return new this(arraySlice(arguments));\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar aCallable = require('../internals/a-callable');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\nvar TypeError = global.TypeError;\n\n// `Map.prototype.reduce` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var noInitial = arguments.length < 2;\n    var accumulator = noInitial ? undefined : arguments[1];\n    aCallable(callbackfn);\n    iterate(iterator, function (key, value) {\n      if (noInitial) {\n        noInitial = false;\n        accumulator = value;\n      } else {\n        accumulator = callbackfn(accumulator, value, key, map);\n      }\n    }, { AS_ENTRIES: true, IS_ITERATOR: true });\n    if (noInitial) throw TypeError('Reduce of empty map with no initial value');\n    return accumulator;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getMapIterator = require('../internals/get-map-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.some` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  some: function some(callbackfn /* , thisArg */) {\n    var map = anObject(this);\n    var iterator = getMapIterator(map);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (key, value, stop) {\n      if (boundFunction(value, key, map)) return stop();\n    }, { AS_ENTRIES: true, IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar aCallable = require('../internals/a-callable');\n\nvar TypeError = global.TypeError;\n\n// `Set.prototype.update` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Map', proto: true, real: true, forced: IS_PURE }, {\n  update: function update(key, callback /* , thunk */) {\n    var map = anObject(this);\n    var get = aCallable(map.get);\n    var has = aCallable(map.has);\n    var set = aCallable(map.set);\n    var length = arguments.length;\n    aCallable(callback);\n    var isPresentInMap = call(has, map, key);\n    if (!isPresentInMap && length < 3) {\n      throw TypeError('Updating absent value');\n    }\n    var value = isPresentInMap ? call(get, map, key) : aCallable(length > 2 ? arguments[2] : undefined)(key, map);\n    call(set, map, key, callback(value, key, map));\n    return map;\n  }\n});\n","var $ = require('../internals/export');\n\nvar min = Math.min;\nvar max = Math.max;\n\n// `Math.clamp` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  clamp: function clamp(x, lower, upper) {\n    return min(upper, max(lower, x));\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.DEG_PER_RAD` constant\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  DEG_PER_RAD: Math.PI / 180\n});\n","var $ = require('../internals/export');\n\nvar RAD_PER_DEG = 180 / Math.PI;\n\n// `Math.degrees` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  degrees: function degrees(radians) {\n    return radians * RAD_PER_DEG;\n  }\n});\n","// `Math.scale` method implementation\n// https://rwaldron.github.io/proposal-math-extensions/\nmodule.exports = Math.scale || function scale(x, inLow, inHigh, outLow, outHigh) {\n  var nx = +x;\n  var nInLow = +inLow;\n  var nInHigh = +inHigh;\n  var nOutLow = +outLow;\n  var nOutHigh = +outHigh;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (nx != nx || nInLow != nInLow || nInHigh != nInHigh || nOutLow != nOutLow || nOutHigh != nOutHigh) return NaN;\n  if (nx === Infinity || nx === -Infinity) return nx;\n  return (nx - nInLow) * (nOutHigh - nOutLow) / (nInHigh - nInLow) + nOutLow;\n};\n","// `Math.sign` method implementation\n// https://tc39.es/ecma262/#sec-math.sign\n// eslint-disable-next-line es/no-math-sign -- safe\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n","var sign = require('../internals/math-sign');\n\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar EPSILON = pow(2, -52);\nvar EPSILON32 = pow(2, -23);\nvar MAX32 = pow(2, 127) * (2 - EPSILON32);\nvar MIN32 = pow(2, -126);\n\nvar roundTiesToEven = function (n) {\n  return n + 1 / EPSILON - 1 / EPSILON;\n};\n\n// `Math.fround` method implementation\n// https://tc39.es/ecma262/#sec-math.fround\n// eslint-disable-next-line es/no-math-fround -- safe\nmodule.exports = Math.fround || function fround(x) {\n  var $abs = abs(x);\n  var $sign = sign(x);\n  var a, result;\n  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;\n  a = (1 + EPSILON32 / EPSILON) * $abs;\n  result = a - (a - $abs);\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (result > MAX32 || result != result) return $sign * Infinity;\n  return $sign * result;\n};\n","var $ = require('../internals/export');\n\nvar scale = require('../internals/math-scale');\nvar fround = require('../internals/math-fround');\n\n// `Math.fscale` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  fscale: function fscale(x, inLow, inHigh, outLow, outHigh) {\n    return fround(scale(x, inLow, inHigh, outLow, outHigh));\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.iaddh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  iaddh: function iaddh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 + (y1 >>> 0) + (($x0 & $y0 | ($x0 | $y0) & ~($x0 + $y0 >>> 0)) >>> 31) | 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.imulh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  imulh: function imulh(u, v) {\n    var UINT16 = 0xFFFF;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >> 16;\n    var v1 = $v >> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >> 16);\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.isubh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  isubh: function isubh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 - (y1 >>> 0) - ((~$x0 & $y0 | ~($x0 ^ $y0) & $x0 - $y0 >>> 0) >>> 31) | 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.RAD_PER_DEG` constant\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  RAD_PER_DEG: 180 / Math.PI\n});\n","var $ = require('../internals/export');\n\nvar DEG_PER_RAD = Math.PI / 180;\n\n// `Math.radians` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  radians: function radians(degrees) {\n    return degrees * DEG_PER_RAD;\n  }\n});\n","var $ = require('../internals/export');\nvar scale = require('../internals/math-scale');\n\n// `Math.scale` method\n// https://rwaldron.github.io/proposal-math-extensions/\n$({ target: 'Math', stat: true }, {\n  scale: scale\n});\n","var global = require('../internals/global');\n\nvar globalIsFinite = global.isFinite;\n\n// `Number.isFinite` method\n// https://tc39.es/ecma262/#sec-number.isfinite\n// eslint-disable-next-line es/no-number-isfinite -- safe\nmodule.exports = Number.isFinite || function isFinite(it) {\n  return typeof it == 'number' && globalIsFinite(it);\n};\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar anObject = require('../internals/an-object');\nvar numberIsFinite = require('../internals/number-is-finite');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar SEEDED_RANDOM = 'Seeded Random';\nvar SEEDED_RANDOM_GENERATOR = SEEDED_RANDOM + ' Generator';\nvar SEED_TYPE_ERROR = 'Math.seededPRNG() argument should have a \"seed\" field with a finite value.';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(SEEDED_RANDOM_GENERATOR);\nvar TypeError = global.TypeError;\n\nvar $SeededRandomGenerator = createIteratorConstructor(function SeededRandomGenerator(seed) {\n  setInternalState(this, {\n    type: SEEDED_RANDOM_GENERATOR,\n    seed: seed % 2147483647\n  });\n}, SEEDED_RANDOM, function next() {\n  var state = getInternalState(this);\n  var seed = state.seed = (state.seed * 1103515245 + 12345) % 2147483647;\n  return { value: (seed & 1073741823) / 1073741823, done: false };\n});\n\n// `Math.seededPRNG` method\n// https://github.com/tc39/proposal-seeded-random\n// based on https://github.com/tc39/proposal-seeded-random/blob/78b8258835b57fc2100d076151ab506bc3202ae6/demo.html\n$({ target: 'Math', stat: true, forced: true }, {\n  seededPRNG: function seededPRNG(it) {\n    var seed = anObject(it).seed;\n    if (!numberIsFinite(seed)) throw TypeError(SEED_TYPE_ERROR);\n    return new $SeededRandomGenerator(seed);\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.signbit` method\n// https://github.com/tc39/proposal-Math.signbit\n$({ target: 'Math', stat: true }, {\n  signbit: function signbit(x) {\n    return (x = +x) == x && x == 0 ? 1 / x == -Infinity : x < 0;\n  }\n});\n","var $ = require('../internals/export');\n\n// `Math.umulh` method\n// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\n// TODO: Remove from `core-js@4`\n$({ target: 'Math', stat: true }, {\n  umulh: function umulh(u, v) {\n    var UINT16 = 0xFFFF;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >>> 16;\n    var v1 = $v >>> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >>> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >>> 16);\n  }\n});\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar trim = require('../internals/string-trim').trim;\nvar whitespaces = require('../internals/whitespaces');\n\nvar $parseInt = global.parseInt;\nvar Symbol = global.Symbol;\nvar ITERATOR = Symbol && Symbol.iterator;\nvar hex = /^[+-]?0x/i;\nvar exec = uncurryThis(hex.exec);\nvar FORCED = $parseInt(whitespaces + '08') !== 8 || $parseInt(whitespaces + '0x16') !== 22\n  // MS Edge 18- broken with boxed symbols\n  || (ITERATOR && !fails(function () { $parseInt(Object(ITERATOR)); }));\n\n// `parseInt` method\n// https://tc39.es/ecma262/#sec-parseint-string-radix\nmodule.exports = FORCED ? function parseInt(string, radix) {\n  var S = trim(toString(string));\n  return $parseInt(S, (radix >>> 0) || (exec(hex, S) ? 16 : 10));\n} : $parseInt;\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar parseInt = require('../internals/number-parse-int');\n\nvar INVALID_NUMBER_REPRESENTATION = 'Invalid number representation';\nvar INVALID_RADIX = 'Invalid radix';\nvar RangeError = global.RangeError;\nvar SyntaxError = global.SyntaxError;\nvar TypeError = global.TypeError;\nvar valid = /^[\\da-z]+$/;\nvar charAt = uncurryThis(''.charAt);\nvar exec = uncurryThis(valid.exec);\nvar numberToString = uncurryThis(1.0.toString);\nvar stringSlice = uncurryThis(''.slice);\n\n// `Number.fromString` method\n// https://github.com/tc39/proposal-number-fromstring\n$({ target: 'Number', stat: true }, {\n  fromString: function fromString(string, radix) {\n    var sign = 1;\n    var R, mathNum;\n    if (typeof string != 'string') throw TypeError(INVALID_NUMBER_REPRESENTATION);\n    if (!string.length) throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    if (charAt(string, 0) == '-') {\n      sign = -1;\n      string = stringSlice(string, 1);\n      if (!string.length) throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    }\n    R = radix === undefined ? 10 : toIntegerOrInfinity(radix);\n    if (R < 2 || R > 36) throw RangeError(INVALID_RADIX);\n    if (!exec(valid, string) || numberToString(mathNum = parseInt(string, R), R) !== string) {\n      throw SyntaxError(INVALID_NUMBER_REPRESENTATION);\n    }\n    return sign * mathNum;\n  }\n});\n","'use strict';\n// https://github.com/tc39/proposal-observable\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar setSpecies = require('../internals/set-species');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar isConstructor = require('../internals/is-constructor');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar defineProperty = require('../internals/object-define-property').f;\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar getIterator = require('../internals/get-iterator');\nvar getMethod = require('../internals/get-method');\nvar iterate = require('../internals/iterate');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar $$OBSERVABLE = wellKnownSymbol('observable');\nvar OBSERVABLE = 'Observable';\nvar SUBSCRIPTION = 'Subscription';\nvar SUBSCRIPTION_OBSERVER = 'SubscriptionObserver';\nvar getterFor = InternalStateModule.getterFor;\nvar setInternalState = InternalStateModule.set;\nvar getObservableInternalState = getterFor(OBSERVABLE);\nvar getSubscriptionInternalState = getterFor(SUBSCRIPTION);\nvar getSubscriptionObserverInternalState = getterFor(SUBSCRIPTION_OBSERVER);\nvar Array = global.Array;\n\nvar SubscriptionState = function (observer) {\n  this.observer = anObject(observer);\n  this.cleanup = undefined;\n  this.subscriptionObserver = undefined;\n};\n\nSubscriptionState.prototype = {\n  type: SUBSCRIPTION,\n  clean: function () {\n    var cleanup = this.cleanup;\n    if (cleanup) {\n      this.cleanup = undefined;\n      try {\n        cleanup();\n      } catch (error) {\n        hostReportErrors(error);\n      }\n    }\n  },\n  close: function () {\n    if (!DESCRIPTORS) {\n      var subscription = this.facade;\n      var subscriptionObserver = this.subscriptionObserver;\n      subscription.closed = true;\n      if (subscriptionObserver) subscriptionObserver.closed = true;\n    } this.observer = undefined;\n  },\n  isClosed: function () {\n    return this.observer === undefined;\n  }\n};\n\nvar Subscription = function (observer, subscriber) {\n  var subscriptionState = setInternalState(this, new SubscriptionState(observer));\n  var start;\n  if (!DESCRIPTORS) this.closed = false;\n  try {\n    if (start = getMethod(observer, 'start')) call(start, observer, this);\n  } catch (error) {\n    hostReportErrors(error);\n  }\n  if (subscriptionState.isClosed()) return;\n  var subscriptionObserver = subscriptionState.subscriptionObserver = new SubscriptionObserver(subscriptionState);\n  try {\n    var cleanup = subscriber(subscriptionObserver);\n    var subscription = cleanup;\n    if (cleanup != null) subscriptionState.cleanup = isCallable(cleanup.unsubscribe)\n      ? function () { subscription.unsubscribe(); }\n      : aCallable(cleanup);\n  } catch (error) {\n    subscriptionObserver.error(error);\n    return;\n  } if (subscriptionState.isClosed()) subscriptionState.clean();\n};\n\nSubscription.prototype = redefineAll({}, {\n  unsubscribe: function unsubscribe() {\n    var subscriptionState = getSubscriptionInternalState(this);\n    if (!subscriptionState.isClosed()) {\n      subscriptionState.close();\n      subscriptionState.clean();\n    }\n  }\n});\n\nif (DESCRIPTORS) defineProperty(Subscription.prototype, 'closed', {\n  configurable: true,\n  get: function () {\n    return getSubscriptionInternalState(this).isClosed();\n  }\n});\n\nvar SubscriptionObserver = function (subscriptionState) {\n  setInternalState(this, {\n    type: SUBSCRIPTION_OBSERVER,\n    subscriptionState: subscriptionState\n  });\n  if (!DESCRIPTORS) this.closed = false;\n};\n\nSubscriptionObserver.prototype = redefineAll({}, {\n  next: function next(value) {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      try {\n        var nextMethod = getMethod(observer, 'next');\n        if (nextMethod) call(nextMethod, observer, value);\n      } catch (error) {\n        hostReportErrors(error);\n      }\n    }\n  },\n  error: function error(value) {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      subscriptionState.close();\n      try {\n        var errorMethod = getMethod(observer, 'error');\n        if (errorMethod) call(errorMethod, observer, value);\n        else hostReportErrors(value);\n      } catch (err) {\n        hostReportErrors(err);\n      } subscriptionState.clean();\n    }\n  },\n  complete: function complete() {\n    var subscriptionState = getSubscriptionObserverInternalState(this).subscriptionState;\n    if (!subscriptionState.isClosed()) {\n      var observer = subscriptionState.observer;\n      subscriptionState.close();\n      try {\n        var completeMethod = getMethod(observer, 'complete');\n        if (completeMethod) call(completeMethod, observer);\n      } catch (error) {\n        hostReportErrors(error);\n      } subscriptionState.clean();\n    }\n  }\n});\n\nif (DESCRIPTORS) defineProperty(SubscriptionObserver.prototype, 'closed', {\n  configurable: true,\n  get: function () {\n    return getSubscriptionObserverInternalState(this).subscriptionState.isClosed();\n  }\n});\n\nvar $Observable = function Observable(subscriber) {\n  anInstance(this, ObservablePrototype);\n  setInternalState(this, {\n    type: OBSERVABLE,\n    subscriber: aCallable(subscriber)\n  });\n};\n\nvar ObservablePrototype = $Observable.prototype;\n\nredefineAll(ObservablePrototype, {\n  subscribe: function subscribe(observer) {\n    var length = arguments.length;\n    return new Subscription(isCallable(observer) ? {\n      next: observer,\n      error: length > 1 ? arguments[1] : undefined,\n      complete: length > 2 ? arguments[2] : undefined\n    } : isObject(observer) ? observer : {}, getObservableInternalState(this).subscriber);\n  }\n});\n\nredefineAll($Observable, {\n  from: function from(x) {\n    var C = isConstructor(this) ? this : $Observable;\n    var observableMethod = getMethod(anObject(x), $$OBSERVABLE);\n    if (observableMethod) {\n      var observable = anObject(call(observableMethod, x));\n      return observable.constructor === C ? observable : new C(function (observer) {\n        return observable.subscribe(observer);\n      });\n    }\n    var iterator = getIterator(x);\n    return new C(function (observer) {\n      iterate(iterator, function (it, stop) {\n        observer.next(it);\n        if (observer.closed) return stop();\n      }, { IS_ITERATOR: true, INTERRUPTED: true });\n      observer.complete();\n    });\n  },\n  of: function of() {\n    var C = isConstructor(this) ? this : $Observable;\n    var length = arguments.length;\n    var items = Array(length);\n    var index = 0;\n    while (index < length) items[index] = arguments[index++];\n    return new C(function (observer) {\n      for (var i = 0; i < length; i++) {\n        observer.next(items[i]);\n        if (observer.closed) return;\n      } observer.complete();\n    });\n  }\n});\n\nredefine(ObservablePrototype, $$OBSERVABLE, function () { return this; });\n\n$({ global: true }, {\n  Observable: $Observable\n});\n\nsetSpecies(OBSERVABLE);\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\n// `Promise.allSettled` method\n// https://tc39.es/ecma262/#sec-promise.allsettled\n$({ target: 'Promise', stat: true }, {\n  allSettled: function allSettled(iterable) {\n    var C = this;\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aCallable(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        remaining++;\n        call(promiseResolve, C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'fulfilled', value: value };\n          --remaining || resolve(values);\n        }, function (error) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = { status: 'rejected', reason: error };\n          --remaining || resolve(values);\n        });\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar aCallable = require('../internals/a-callable');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar iterate = require('../internals/iterate');\n\nvar PROMISE_ANY_ERROR = 'No one promise resolved';\n\n// `Promise.any` method\n// https://tc39.es/ecma262/#sec-promise.any\n$({ target: 'Promise', stat: true }, {\n  any: function any(iterable) {\n    var C = this;\n    var AggregateError = getBuiltIn('AggregateError');\n    var capability = newPromiseCapabilityModule.f(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var promiseResolve = aCallable(C.resolve);\n      var errors = [];\n      var counter = 0;\n      var remaining = 1;\n      var alreadyResolved = false;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyRejected = false;\n        remaining++;\n        call(promiseResolve, C, promise).then(function (value) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyResolved = true;\n          resolve(value);\n        }, function (error) {\n          if (alreadyRejected || alreadyResolved) return;\n          alreadyRejected = true;\n          errors[index] = error;\n          --remaining || reject(new AggregateError(errors, PROMISE_ANY_ERROR));\n        });\n      });\n      --remaining || reject(new AggregateError(errors, PROMISE_ANY_ERROR));\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\n\n// `Promise.try` method\n// https://github.com/tc39/proposal-promise-try\n$({ target: 'Promise', stat: true }, {\n  'try': function (callbackfn) {\n    var promiseCapability = newPromiseCapabilityModule.f(this);\n    var result = perform(callbackfn);\n    (result.error ? promiseCapability.reject : promiseCapability.resolve)(result.value);\n    return promiseCapability.promise;\n  }\n});\n","// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.map');\nrequire('../modules/es.weak-map');\nvar getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar shared = require('../internals/shared');\n\nvar Map = getBuiltIn('Map');\nvar WeakMap = getBuiltIn('WeakMap');\nvar push = uncurryThis([].push);\n\nvar metadata = shared('metadata');\nvar store = metadata.store || (metadata.store = new WeakMap());\n\nvar getOrCreateMetadataMap = function (target, targetKey, create) {\n  var targetMetadata = store.get(target);\n  if (!targetMetadata) {\n    if (!create) return;\n    store.set(target, targetMetadata = new Map());\n  }\n  var keyMetadata = targetMetadata.get(targetKey);\n  if (!keyMetadata) {\n    if (!create) return;\n    targetMetadata.set(targetKey, keyMetadata = new Map());\n  } return keyMetadata;\n};\n\nvar ordinaryHasOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? false : metadataMap.has(MetadataKey);\n};\n\nvar ordinaryGetOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? undefined : metadataMap.get(MetadataKey);\n};\n\nvar ordinaryDefineOwnMetadata = function (MetadataKey, MetadataValue, O, P) {\n  getOrCreateMetadataMap(O, P, true).set(MetadataKey, MetadataValue);\n};\n\nvar ordinaryOwnMetadataKeys = function (target, targetKey) {\n  var metadataMap = getOrCreateMetadataMap(target, targetKey, false);\n  var keys = [];\n  if (metadataMap) metadataMap.forEach(function (_, key) { push(keys, key); });\n  return keys;\n};\n\nvar toMetadataKey = function (it) {\n  return it === undefined || typeof it == 'symbol' ? it : String(it);\n};\n\nmodule.exports = {\n  store: store,\n  getMap: getOrCreateMetadataMap,\n  has: ordinaryHasOwnMetadata,\n  get: ordinaryGetOwnMetadata,\n  set: ordinaryDefineOwnMetadata,\n  keys: ordinaryOwnMetadataKeys,\n  toKey: toMetadataKey\n};\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar ordinaryDefineOwnMetadata = ReflectMetadataModule.set;\n\n// `Reflect.defineMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  defineMetadata: function defineMetadata(metadataKey, metadataValue, target /* , targetKey */) {\n    var targetKey = arguments.length < 4 ? undefined : toMetadataKey(arguments[3]);\n    ordinaryDefineOwnMetadata(metadataKey, metadataValue, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar getOrCreateMetadataMap = ReflectMetadataModule.getMap;\nvar store = ReflectMetadataModule.store;\n\n// `Reflect.deleteMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  deleteMetadata: function deleteMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    var metadataMap = getOrCreateMetadataMap(anObject(target), targetKey, false);\n    if (metadataMap === undefined || !metadataMap['delete'](metadataKey)) return false;\n    if (metadataMap.size) return true;\n    var targetMetadata = store.get(target);\n    targetMetadata['delete'](targetKey);\n    return !!targetMetadata.size || store['delete'](target);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar ordinaryGetOwnMetadata = ReflectMetadataModule.get;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryGetMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return ordinaryGetOwnMetadata(MetadataKey, O, P);\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryGetMetadata(MetadataKey, parent, P) : undefined;\n};\n\n// `Reflect.getMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getMetadata: function getMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryGetMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar Map = getBuiltIn('Map');\nvar MapPrototype = Map.prototype;\nvar mapForEach = uncurryThis(MapPrototype.forEach);\nvar mapHas = uncurryThis(MapPrototype.has);\nvar mapSet = uncurryThis(MapPrototype.set);\nvar push = uncurryThis([].push);\n\n// `Array.prototype.uniqueBy` method\n// https://github.com/tc39/proposal-array-unique\nmodule.exports = function uniqueBy(resolver) {\n  var that = toObject(this);\n  var length = lengthOfArrayLike(that);\n  var result = arraySpeciesCreate(that, 0);\n  var map = new Map();\n  var resolverFunction = resolver != null ? aCallable(resolver) : function (value) {\n    return value;\n  };\n  var index, item, key;\n  for (index = 0; index < length; index++) {\n    item = that[index];\n    key = resolverFunction(item);\n    if (!mapHas(map, key)) mapSet(map, key, item);\n  }\n  mapForEach(map, function (value) {\n    push(result, value);\n  });\n  return result;\n};\n","var $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar $arrayUniqueBy = require('../internals/array-unique-by');\n\nvar arrayUniqueBy = uncurryThis($arrayUniqueBy);\nvar concat = uncurryThis([].concat);\nvar ordinaryOwnMetadataKeys = ReflectMetadataModule.keys;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryMetadataKeys = function (O, P) {\n  var oKeys = ordinaryOwnMetadataKeys(O, P);\n  var parent = getPrototypeOf(O);\n  if (parent === null) return oKeys;\n  var pKeys = ordinaryMetadataKeys(parent, P);\n  return pKeys.length ? oKeys.length ? arrayUniqueBy(concat(oKeys, pKeys)) : pKeys : oKeys;\n};\n\n// `Reflect.getMetadataKeys` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getMetadataKeys: function getMetadataKeys(target /* , targetKey */) {\n    var targetKey = arguments.length < 2 ? undefined : toMetadataKey(arguments[1]);\n    return ordinaryMetadataKeys(anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryGetOwnMetadata = ReflectMetadataModule.get;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.getOwnMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getOwnMetadata: function getOwnMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryGetOwnMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryOwnMetadataKeys = ReflectMetadataModule.keys;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.getOwnMetadataKeys` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  getOwnMetadataKeys: function getOwnMetadataKeys(target /* , targetKey */) {\n    var targetKey = arguments.length < 2 ? undefined : toMetadataKey(arguments[1]);\n    return ordinaryOwnMetadataKeys(anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\nvar ordinaryHasMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return true;\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryHasMetadata(MetadataKey, parent, P) : false;\n};\n\n// `Reflect.hasMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  hasMetadata: function hasMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryHasMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar ordinaryHasOwnMetadata = ReflectMetadataModule.has;\nvar toMetadataKey = ReflectMetadataModule.toKey;\n\n// `Reflect.hasOwnMetadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  hasOwnMetadata: function hasOwnMetadata(metadataKey, target /* , targetKey */) {\n    var targetKey = arguments.length < 3 ? undefined : toMetadataKey(arguments[2]);\n    return ordinaryHasOwnMetadata(metadataKey, anObject(target), targetKey);\n  }\n});\n","var $ = require('../internals/export');\nvar ReflectMetadataModule = require('../internals/reflect-metadata');\nvar anObject = require('../internals/an-object');\n\nvar toMetadataKey = ReflectMetadataModule.toKey;\nvar ordinaryDefineOwnMetadata = ReflectMetadataModule.set;\n\n// `Reflect.metadata` method\n// https://github.com/rbuckton/reflect-metadata\n$({ target: 'Reflect', stat: true }, {\n  metadata: function metadata(metadataKey, metadataValue) {\n    return function decorator(target, key) {\n      ordinaryDefineOwnMetadata(metadataKey, metadataValue, anObject(target), toMetadataKey(key));\n    };\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar addAll = require('../internals/collection-add-all');\n\n// `Set.prototype.addAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  addAll: addAll\n});\n","'use strict';\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\n\n// https://github.com/tc39/collection-methods\nmodule.exports = function addAll(/* ...elements */) {\n  var set = anObject(this);\n  var adder = aCallable(set.add);\n  for (var k = 0, len = arguments.length; k < len; k++) {\n    call(adder, set, arguments[k]);\n  }\n  return set;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `Set.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.difference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  difference: function difference(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    var remover = aCallable(newSet['delete']);\n    iterate(iterable, function (value) {\n      call(remover, newSet, value);\n    });\n    return newSet;\n  }\n});\n","var call = require('../internals/function-call');\n\nmodule.exports = function (it) {\n  // eslint-disable-next-line es/no-set -- safe\n  return call(Set.prototype.values, it);\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.every` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  every: function every(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return !iterate(iterator, function (value, stop) {\n      if (!boundFunction(value, value, set)) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.filter` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var adder = aCallable(newSet.add);\n    iterate(iterator, function (value) {\n      if (boundFunction(value, value, set)) call(adder, newSet, value);\n    }, { IS_ITERATOR: true });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.find` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  find: function find(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (value, stop) {\n      if (boundFunction(value, value, set)) return stop(value);\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).result;\n  }\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `Set.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-set.from\n$({ target: 'Set', stat: true }, {\n  from: from\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.intersection` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  intersection: function intersection(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var hasCheck = aCallable(set.has);\n    var adder = aCallable(newSet.add);\n    iterate(iterable, function (value) {\n      if (call(hasCheck, set, value)) call(adder, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isDisjointFrom` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isDisjointFrom\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isDisjointFrom: function isDisjointFrom(iterable) {\n    var set = anObject(this);\n    var hasCheck = aCallable(set.has);\n    return !iterate(iterable, function (value, stop) {\n      if (call(hasCheck, set, value) === true) return stop();\n    }, { INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar isCallable = require('../internals/is-callable');\nvar anObject = require('../internals/an-object');\nvar getIterator = require('../internals/get-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isSubsetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSubsetOf\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isSubsetOf: function isSubsetOf(iterable) {\n    var iterator = getIterator(this);\n    var otherSet = anObject(iterable);\n    var hasCheck = otherSet.has;\n    if (!isCallable(hasCheck)) {\n      otherSet = new (getBuiltIn('Set'))(iterable);\n      hasCheck = aCallable(otherSet.has);\n    }\n    return !iterate(iterator, function (value, stop) {\n      if (call(hasCheck, otherSet, value) === false) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.isSupersetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSupersetOf\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  isSupersetOf: function isSupersetOf(iterable) {\n    var set = anObject(this);\n    var hasCheck = aCallable(set.has);\n    return !iterate(iterable, function (value, stop) {\n      if (call(hasCheck, set, value) === false) return stop();\n    }, { INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar anObject = require('../internals/an-object');\nvar toString = require('../internals/to-string');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\nvar arrayJoin = uncurryThis([].join);\nvar push = [].push;\n\n// `Set.prototype.join` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  join: function join(separator) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var sep = separator === undefined ? ',' : toString(separator);\n    var result = [];\n    iterate(iterator, push, { that: result, IS_ITERATOR: true });\n    return arrayJoin(result, sep);\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.map` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  map: function map(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))();\n    var adder = aCallable(newSet.add);\n    iterate(iterator, function (value) {\n      call(adder, newSet, boundFunction(value, value, set));\n    }, { IS_ITERATOR: true });\n    return newSet;\n  }\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `Set.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-set.of\n$({ target: 'Set', stat: true }, {\n  of: of\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar IS_PURE = require('../internals/is-pure');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\nvar TypeError = global.TypeError;\n\n// `Set.prototype.reduce` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var noInitial = arguments.length < 2;\n    var accumulator = noInitial ? undefined : arguments[1];\n    aCallable(callbackfn);\n    iterate(iterator, function (value) {\n      if (noInitial) {\n        noInitial = false;\n        accumulator = value;\n      } else {\n        accumulator = callbackfn(accumulator, value, value, set);\n      }\n    }, { IS_ITERATOR: true });\n    if (noInitial) throw TypeError('Reduce of empty set with no initial value');\n    return accumulator;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar anObject = require('../internals/an-object');\nvar bind = require('../internals/function-bind-context');\nvar getSetIterator = require('../internals/get-set-iterator');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.some` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  some: function some(callbackfn /* , thisArg */) {\n    var set = anObject(this);\n    var iterator = getSetIterator(set);\n    var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return iterate(iterator, function (value, stop) {\n      if (boundFunction(value, value, set)) return stop();\n    }, { IS_ITERATOR: true, INTERRUPTED: true }).stopped;\n  }\n});\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.symmetricDifference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  symmetricDifference: function symmetricDifference(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    var remover = aCallable(newSet['delete']);\n    var adder = aCallable(newSet.add);\n    iterate(iterable, function (value) {\n      call(remover, newSet, value) || call(adder, newSet, value);\n    });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar getBuiltIn = require('../internals/get-built-in');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar speciesConstructor = require('../internals/species-constructor');\nvar iterate = require('../internals/iterate');\n\n// `Set.prototype.union` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: IS_PURE }, {\n  union: function union(iterable) {\n    var set = anObject(this);\n    var newSet = new (speciesConstructor(set, getBuiltIn('Set')))(set);\n    iterate(iterable, aCallable(newSet.add), { that: newSet });\n    return newSet;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar charAt = require('../internals/string-multibyte').charAt;\nvar fails = require('../internals/fails');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\n\nvar FORCED = fails(function () {\n  return '𠮷'.at(-2) !== '𠮷';\n});\n\n// `String.prototype.at` method\n// https://github.com/mathiasbynens/String.prototype.at\n$({ target: 'String', proto: true, forced: FORCED }, {\n  at: function at(index) {\n    var S = toString(requireObjectCoercible(this));\n    var len = S.length;\n    var relativeIndex = toIntegerOrInfinity(index);\n    var k = relativeIndex >= 0 ? relativeIndex : len + relativeIndex;\n    return (k < 0 || k >= len) ? undefined : charAt(S, k);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar InternalStateModule = require('../internals/internal-state');\nvar StringMultibyteModule = require('../internals/string-multibyte');\n\nvar codeAt = StringMultibyteModule.codeAt;\nvar charAt = StringMultibyteModule.charAt;\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// TODO: unify with String#@@iterator\nvar $StringIterator = createIteratorConstructor(function StringIterator(string) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: string,\n    index: 0\n  });\n}, 'String', function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: { codePoint: codeAt(point, 0), position: index }, done: false };\n});\n\n// `String.prototype.codePoints` method\n// https://github.com/tc39/proposal-string-prototype-codepoints\n$({ target: 'String', proto: true }, {\n  codePoints: function codePoints() {\n    return new $StringIterator(toString(requireObjectCoercible(this)));\n  }\n});\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.es/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","'use strict';\n/* eslint-disable es/no-string-prototype-matchall -- safe */\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar anObject = require('../internals/an-object');\nvar classof = require('../internals/classof-raw');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isRegExp = require('../internals/is-regexp');\nvar regExpFlags = require('../internals/regexp-flags');\nvar getMethod = require('../internals/get-method');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar InternalStateModule = require('../internals/internal-state');\nvar IS_PURE = require('../internals/is-pure');\n\nvar MATCH_ALL = wellKnownSymbol('matchAll');\nvar REGEXP_STRING = 'RegExp String';\nvar REGEXP_STRING_ITERATOR = REGEXP_STRING + ' Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(REGEXP_STRING_ITERATOR);\nvar RegExpPrototype = RegExp.prototype;\nvar TypeError = global.TypeError;\nvar getFlags = uncurryThis(regExpFlags);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar un$MatchAll = uncurryThis(''.matchAll);\n\nvar WORKS_WITH_NON_GLOBAL_REGEX = !!un$MatchAll && !fails(function () {\n  un$MatchAll('a', /./);\n});\n\nvar $RegExpStringIterator = createIteratorConstructor(function RegExpStringIterator(regexp, string, $global, fullUnicode) {\n  setInternalState(this, {\n    type: REGEXP_STRING_ITERATOR,\n    regexp: regexp,\n    string: string,\n    global: $global,\n    unicode: fullUnicode,\n    done: false\n  });\n}, REGEXP_STRING, function next() {\n  var state = getInternalState(this);\n  if (state.done) return { value: undefined, done: true };\n  var R = state.regexp;\n  var S = state.string;\n  var match = regExpExec(R, S);\n  if (match === null) return { value: undefined, done: state.done = true };\n  if (state.global) {\n    if (toString(match[0]) === '') R.lastIndex = advanceStringIndex(S, toLength(R.lastIndex), state.unicode);\n    return { value: match, done: false };\n  }\n  state.done = true;\n  return { value: match, done: false };\n});\n\nvar $matchAll = function (string) {\n  var R = anObject(this);\n  var S = toString(string);\n  var C, flagsValue, flags, matcher, $global, fullUnicode;\n  C = speciesConstructor(R, RegExp);\n  flagsValue = R.flags;\n  if (flagsValue === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype)) {\n    flagsValue = getFlags(R);\n  }\n  flags = flagsValue === undefined ? '' : toString(flagsValue);\n  matcher = new C(C === RegExp ? R.source : R, flags);\n  $global = !!~stringIndexOf(flags, 'g');\n  fullUnicode = !!~stringIndexOf(flags, 'u');\n  matcher.lastIndex = toLength(R.lastIndex);\n  return new $RegExpStringIterator(matcher, S, $global, fullUnicode);\n};\n\n// `String.prototype.matchAll` method\n// https://tc39.es/ecma262/#sec-string.prototype.matchall\n$({ target: 'String', proto: true, forced: WORKS_WITH_NON_GLOBAL_REGEX }, {\n  matchAll: function matchAll(regexp) {\n    var O = requireObjectCoercible(this);\n    var flags, S, matcher, rx;\n    if (regexp != null) {\n      if (isRegExp(regexp)) {\n        flags = toString(requireObjectCoercible('flags' in RegExpPrototype\n          ? regexp.flags\n          : getFlags(regexp)\n        ));\n        if (!~stringIndexOf(flags, 'g')) throw TypeError('`.matchAll` does not allow non-global regexes');\n      }\n      if (WORKS_WITH_NON_GLOBAL_REGEX) return un$MatchAll(O, regexp);\n      matcher = getMethod(regexp, MATCH_ALL);\n      if (matcher === undefined && IS_PURE && classof(regexp) == 'RegExp') matcher = $matchAll;\n      if (matcher) return call(matcher, regexp, O);\n    } else if (WORKS_WITH_NON_GLOBAL_REGEX) return un$MatchAll(O, regexp);\n    S = toString(O);\n    rx = new RegExp(regexp, 'g');\n    return IS_PURE ? call($matchAll, rx, S) : rx[MATCH_ALL](S);\n  }\n});\n\nIS_PURE || MATCH_ALL in RegExpPrototype || redefine(RegExpPrototype, MATCH_ALL, $matchAll);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar isCallable = require('../internals/is-callable');\nvar isRegExp = require('../internals/is-regexp');\nvar toString = require('../internals/to-string');\nvar getMethod = require('../internals/get-method');\nvar regExpFlags = require('../internals/regexp-flags');\nvar getSubstitution = require('../internals/get-substitution');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar RegExpPrototype = RegExp.prototype;\nvar TypeError = global.TypeError;\nvar getFlags = uncurryThis(regExpFlags);\nvar indexOf = uncurryThis(''.indexOf);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\nvar max = Math.max;\n\nvar stringIndexOf = function (string, searchValue, fromIndex) {\n  if (fromIndex > string.length) return -1;\n  if (searchValue === '') return fromIndex;\n  return indexOf(string, searchValue, fromIndex);\n};\n\n// `String.prototype.replaceAll` method\n// https://tc39.es/ecma262/#sec-string.prototype.replaceall\n$({ target: 'String', proto: true }, {\n  replaceAll: function replaceAll(searchValue, replaceValue) {\n    var O = requireObjectCoercible(this);\n    var IS_REG_EXP, flags, replacer, string, searchString, functionalReplace, searchLength, advanceBy, replacement;\n    var position = 0;\n    var endOfLastMatch = 0;\n    var result = '';\n    if (searchValue != null) {\n      IS_REG_EXP = isRegExp(searchValue);\n      if (IS_REG_EXP) {\n        flags = toString(requireObjectCoercible('flags' in RegExpPrototype\n          ? searchValue.flags\n          : getFlags(searchValue)\n        ));\n        if (!~indexOf(flags, 'g')) throw TypeError('`.replaceAll` does not allow non-global regexes');\n      }\n      replacer = getMethod(searchValue, REPLACE);\n      if (replacer) {\n        return call(replacer, searchValue, O, replaceValue);\n      } else if (IS_PURE && IS_REG_EXP) {\n        return replace(toString(O), searchValue, replaceValue);\n      }\n    }\n    string = toString(O);\n    searchString = toString(searchValue);\n    functionalReplace = isCallable(replaceValue);\n    if (!functionalReplace) replaceValue = toString(replaceValue);\n    searchLength = searchString.length;\n    advanceBy = max(1, searchLength);\n    position = stringIndexOf(string, searchString, 0);\n    while (position !== -1) {\n      replacement = functionalReplace\n        ? toString(replaceValue(searchString, position, string))\n        : getSubstitution(searchString, string, position, [], undefined, replaceValue);\n      result += stringSlice(string, endOfLastMatch, position) + replacement;\n      endOfLastMatch = position + searchLength;\n      position = stringIndexOf(string, searchString, position + advanceBy);\n    }\n    if (endOfLastMatch < string.length) {\n      result += stringSlice(string, endOfLastMatch);\n    }\n    return result;\n  }\n});\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.dispose` well-known symbol\n// https://github.com/tc39/proposal-using-statement\ndefineWellKnownSymbol('dispose');\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.observable` well-known symbol\n// https://github.com/tc39/proposal-observable\ndefineWellKnownSymbol('observable');\n","// TODO: remove from `core-js@4`\nvar defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.patternMatch` well-known symbol\n// https://github.com/tc39/proposal-pattern-matching\ndefineWellKnownSymbol('patternMatch');\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `WeakMap.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakMap', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `WeakMap.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.from\n$({ target: 'WeakMap', stat: true }, {\n  from: from\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `WeakMap.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.of\n$({ target: 'WeakMap', stat: true }, {\n  of: of\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar addAll = require('../internals/collection-add-all');\n\n// `WeakSet.prototype.addAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakSet', proto: true, real: true, forced: IS_PURE }, {\n  addAll: addAll\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar deleteAll = require('../internals/collection-delete-all');\n\n// `WeakSet.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakSet', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: deleteAll\n});\n","var $ = require('../internals/export');\nvar from = require('../internals/collection-from');\n\n// `WeakSet.from` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.from\n$({ target: 'WeakSet', stat: true }, {\n  from: from\n});\n","var $ = require('../internals/export');\nvar of = require('../internals/collection-of');\n\n// `WeakSet.of` method\n// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.of\n$({ target: 'WeakSet', stat: true }, {\n  of: of\n});\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","// in old WebKit versions, `element.classList` is not an instance of global `DOMTokenList`\nvar documentCreateElement = require('../internals/document-create-element');\n\nvar classList = documentCreateElement('span').classList;\nvar DOMTokenListPrototype = classList && classList.constructor && classList.constructor.prototype;\n\nmodule.exports = DOMTokenListPrototype === Object.prototype ? undefined : DOMTokenListPrototype;\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar ArrayIteratorMethods = require('../modules/es.array.iterator');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar ArrayValues = ArrayIteratorMethods.values;\n\nvar handlePrototype = function (CollectionPrototype, COLLECTION_NAME) {\n  if (CollectionPrototype) {\n    // some Chrome versions have non-configurable methods on DOMTokenList\n    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {\n      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);\n    } catch (error) {\n      CollectionPrototype[ITERATOR] = ArrayValues;\n    }\n    if (!CollectionPrototype[TO_STRING_TAG]) {\n      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n    }\n    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {\n      // some Chrome versions have non-configurable methods on DOMTokenList\n      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {\n        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);\n      } catch (error) {\n        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];\n      }\n    }\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype, COLLECTION_NAME);\n}\n\nhandlePrototype(DOMTokenListPrototype, 'DOMTokenList');\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar task = require('../internals/task');\n\nvar FORCED = !global.setImmediate || !global.clearImmediate;\n\n// http://w3c.github.io/setImmediate/\n$({ global: true, bind: true, enumerable: true, forced: FORCED }, {\n  // `setImmediate` method\n  // http://w3c.github.io/setImmediate/#si-setImmediate\n  setImmediate: task.set,\n  // `clearImmediate` method\n  // http://w3c.github.io/setImmediate/#si-clearImmediate\n  clearImmediate: task.clear\n});\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar microtask = require('../internals/microtask');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar process = global.process;\n\n// `queueMicrotask` method\n// https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-queuemicrotask\n$({ global: true, enumerable: true, noTargetGet: true }, {\n  queueMicrotask: function queueMicrotask(fn) {\n    var domain = IS_NODE && process.domain;\n    microtask(domain ? domain.bind(fn) : fn);\n  }\n});\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar toString = require('../internals/to-string');\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: toString(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line unicorn/relative-url-style -- required for testing\n  var url = new URL('b?a=1&b=2&c=3', 'http://a');\n  var searchParams = url.searchParams;\n  var result = '';\n  url.pathname = 'c%20d';\n  searchParams.forEach(function (value, key) {\n    searchParams['delete']('b');\n    result += key + value;\n  });\n  return (IS_PURE && !url.toJSON)\n    || !searchParams.sort\n    || url.href !== 'http://a/c%20d?a=1&c=3'\n    || searchParams.get('c') !== '3'\n    || String(new URLSearchParams('?a=1')) !== 'a=1'\n    || !searchParams[ITERATOR]\n    // throws in Edge\n    || new URL('https://a@b').username !== 'a'\n    || new URLSearchParams(new URLSearchParams('a=b')).get('a') !== 'b'\n    // not punycoded in Edge\n    || new URL('http://тест').host !== 'xn--e1aybc'\n    // not escaped in Chrome 62-\n    || new URL('http://a#б').hash !== '#%D0%B1'\n    // fails in Chrome 66-\n    || result !== 'a1c3'\n    // throws in Safari\n    || new URL('http://x', undefined).host !== 'x';\n});\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.string.iterator');\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineProperties = require('../internals/object-define-properties').f;\nvar redefine = require('../internals/redefine');\nvar anInstance = require('../internals/an-instance');\nvar hasOwn = require('../internals/has-own-property');\nvar assign = require('../internals/object-assign');\nvar arrayFrom = require('../internals/array-from');\nvar arraySlice = require('../internals/array-slice-simple');\nvar codeAt = require('../internals/string-multibyte').codeAt;\nvar toASCII = require('../internals/string-punycode-to-ascii');\nvar $toString = require('../internals/to-string');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar URLSearchParamsModule = require('../modules/web.url-search-params');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar getInternalURLState = InternalStateModule.getterFor('URL');\nvar URLSearchParams = URLSearchParamsModule.URLSearchParams;\nvar getInternalSearchParamsState = URLSearchParamsModule.getState;\n\nvar NativeURL = global.URL;\nvar TypeError = global.TypeError;\nvar parseInt = global.parseInt;\nvar floor = Math.floor;\nvar pow = Math.pow;\nvar charAt = uncurryThis(''.charAt);\nvar exec = uncurryThis(/./.exec);\nvar join = uncurryThis([].join);\nvar numberToString = uncurryThis(1.0.toString);\nvar pop = uncurryThis([].pop);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar shift = uncurryThis([].shift);\nvar split = uncurryThis(''.split);\nvar stringSlice = uncurryThis(''.slice);\nvar toLowerCase = uncurryThis(''.toLowerCase);\nvar unshift = uncurryThis([].unshift);\n\nvar INVALID_AUTHORITY = 'Invalid authority';\nvar INVALID_SCHEME = 'Invalid scheme';\nvar INVALID_HOST = 'Invalid host';\nvar INVALID_PORT = 'Invalid port';\n\nvar ALPHA = /[a-z]/i;\n// eslint-disable-next-line regexp/no-obscure-range -- safe\nvar ALPHANUMERIC = /[\\d+-.a-z]/i;\nvar DIGIT = /\\d/;\nvar HEX_START = /^0x/i;\nvar OCT = /^[0-7]+$/;\nvar DEC = /^\\d+$/;\nvar HEX = /^[\\da-f]+$/i;\n/* eslint-disable regexp/no-control-character -- safe */\nvar FORBIDDEN_HOST_CODE_POINT = /[\\0\\t\\n\\r #%/:<>?@[\\\\\\]^|]/;\nvar FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT = /[\\0\\t\\n\\r #/:<>?@[\\\\\\]^|]/;\nvar LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE = /^[\\u0000-\\u0020]+|[\\u0000-\\u0020]+$/g;\nvar TAB_AND_NEW_LINE = /[\\t\\n\\r]/g;\n/* eslint-enable regexp/no-control-character -- safe */\nvar EOF;\n\n// https://url.spec.whatwg.org/#ipv4-number-parser\nvar parseIPv4 = function (input) {\n  var parts = split(input, '.');\n  var partsLength, numbers, index, part, radix, number, ipv4;\n  if (parts.length && parts[parts.length - 1] == '') {\n    parts.length--;\n  }\n  partsLength = parts.length;\n  if (partsLength > 4) return input;\n  numbers = [];\n  for (index = 0; index < partsLength; index++) {\n    part = parts[index];\n    if (part == '') return input;\n    radix = 10;\n    if (part.length > 1 && charAt(part, 0) == '0') {\n      radix = exec(HEX_START, part) ? 16 : 8;\n      part = stringSlice(part, radix == 8 ? 1 : 2);\n    }\n    if (part === '') {\n      number = 0;\n    } else {\n      if (!exec(radix == 10 ? DEC : radix == 8 ? OCT : HEX, part)) return input;\n      number = parseInt(part, radix);\n    }\n    push(numbers, number);\n  }\n  for (index = 0; index < partsLength; index++) {\n    number = numbers[index];\n    if (index == partsLength - 1) {\n      if (number >= pow(256, 5 - partsLength)) return null;\n    } else if (number > 255) return null;\n  }\n  ipv4 = pop(numbers);\n  for (index = 0; index < numbers.length; index++) {\n    ipv4 += numbers[index] * pow(256, 3 - index);\n  }\n  return ipv4;\n};\n\n// https://url.spec.whatwg.org/#concept-ipv6-parser\n// eslint-disable-next-line max-statements -- TODO\nvar parseIPv6 = function (input) {\n  var address = [0, 0, 0, 0, 0, 0, 0, 0];\n  var pieceIndex = 0;\n  var compress = null;\n  var pointer = 0;\n  var value, length, numbersSeen, ipv4Piece, number, swaps, swap;\n\n  var chr = function () {\n    return charAt(input, pointer);\n  };\n\n  if (chr() == ':') {\n    if (charAt(input, 1) != ':') return;\n    pointer += 2;\n    pieceIndex++;\n    compress = pieceIndex;\n  }\n  while (chr()) {\n    if (pieceIndex == 8) return;\n    if (chr() == ':') {\n      if (compress !== null) return;\n      pointer++;\n      pieceIndex++;\n      compress = pieceIndex;\n      continue;\n    }\n    value = length = 0;\n    while (length < 4 && exec(HEX, chr())) {\n      value = value * 16 + parseInt(chr(), 16);\n      pointer++;\n      length++;\n    }\n    if (chr() == '.') {\n      if (length == 0) return;\n      pointer -= length;\n      if (pieceIndex > 6) return;\n      numbersSeen = 0;\n      while (chr()) {\n        ipv4Piece = null;\n        if (numbersSeen > 0) {\n          if (chr() == '.' && numbersSeen < 4) pointer++;\n          else return;\n        }\n        if (!exec(DIGIT, chr())) return;\n        while (exec(DIGIT, chr())) {\n          number = parseInt(chr(), 10);\n          if (ipv4Piece === null) ipv4Piece = number;\n          else if (ipv4Piece == 0) return;\n          else ipv4Piece = ipv4Piece * 10 + number;\n          if (ipv4Piece > 255) return;\n          pointer++;\n        }\n        address[pieceIndex] = address[pieceIndex] * 256 + ipv4Piece;\n        numbersSeen++;\n        if (numbersSeen == 2 || numbersSeen == 4) pieceIndex++;\n      }\n      if (numbersSeen != 4) return;\n      break;\n    } else if (chr() == ':') {\n      pointer++;\n      if (!chr()) return;\n    } else if (chr()) return;\n    address[pieceIndex++] = value;\n  }\n  if (compress !== null) {\n    swaps = pieceIndex - compress;\n    pieceIndex = 7;\n    while (pieceIndex != 0 && swaps > 0) {\n      swap = address[pieceIndex];\n      address[pieceIndex--] = address[compress + swaps - 1];\n      address[compress + --swaps] = swap;\n    }\n  } else if (pieceIndex != 8) return;\n  return address;\n};\n\nvar findLongestZeroSequence = function (ipv6) {\n  var maxIndex = null;\n  var maxLength = 1;\n  var currStart = null;\n  var currLength = 0;\n  var index = 0;\n  for (; index < 8; index++) {\n    if (ipv6[index] !== 0) {\n      if (currLength > maxLength) {\n        maxIndex = currStart;\n        maxLength = currLength;\n      }\n      currStart = null;\n      currLength = 0;\n    } else {\n      if (currStart === null) currStart = index;\n      ++currLength;\n    }\n  }\n  if (currLength > maxLength) {\n    maxIndex = currStart;\n    maxLength = currLength;\n  }\n  return maxIndex;\n};\n\n// https://url.spec.whatwg.org/#host-serializing\nvar serializeHost = function (host) {\n  var result, index, compress, ignore0;\n  // ipv4\n  if (typeof host == 'number') {\n    result = [];\n    for (index = 0; index < 4; index++) {\n      unshift(result, host % 256);\n      host = floor(host / 256);\n    } return join(result, '.');\n  // ipv6\n  } else if (typeof host == 'object') {\n    result = '';\n    compress = findLongestZeroSequence(host);\n    for (index = 0; index < 8; index++) {\n      if (ignore0 && host[index] === 0) continue;\n      if (ignore0) ignore0 = false;\n      if (compress === index) {\n        result += index ? ':' : '::';\n        ignore0 = true;\n      } else {\n        result += numberToString(host[index], 16);\n        if (index < 7) result += ':';\n      }\n    }\n    return '[' + result + ']';\n  } return host;\n};\n\nvar C0ControlPercentEncodeSet = {};\nvar fragmentPercentEncodeSet = assign({}, C0ControlPercentEncodeSet, {\n  ' ': 1, '\"': 1, '<': 1, '>': 1, '`': 1\n});\nvar pathPercentEncodeSet = assign({}, fragmentPercentEncodeSet, {\n  '#': 1, '?': 1, '{': 1, '}': 1\n});\nvar userinfoPercentEncodeSet = assign({}, pathPercentEncodeSet, {\n  '/': 1, ':': 1, ';': 1, '=': 1, '@': 1, '[': 1, '\\\\': 1, ']': 1, '^': 1, '|': 1\n});\n\nvar percentEncode = function (chr, set) {\n  var code = codeAt(chr, 0);\n  return code > 0x20 && code < 0x7F && !hasOwn(set, chr) ? chr : encodeURIComponent(chr);\n};\n\n// https://url.spec.whatwg.org/#special-scheme\nvar specialSchemes = {\n  ftp: 21,\n  file: null,\n  http: 80,\n  https: 443,\n  ws: 80,\n  wss: 443\n};\n\n// https://url.spec.whatwg.org/#windows-drive-letter\nvar isWindowsDriveLetter = function (string, normalized) {\n  var second;\n  return string.length == 2 && exec(ALPHA, charAt(string, 0))\n    && ((second = charAt(string, 1)) == ':' || (!normalized && second == '|'));\n};\n\n// https://url.spec.whatwg.org/#start-with-a-windows-drive-letter\nvar startsWithWindowsDriveLetter = function (string) {\n  var third;\n  return string.length > 1 && isWindowsDriveLetter(stringSlice(string, 0, 2)) && (\n    string.length == 2 ||\n    ((third = charAt(string, 2)) === '/' || third === '\\\\' || third === '?' || third === '#')\n  );\n};\n\n// https://url.spec.whatwg.org/#single-dot-path-segment\nvar isSingleDot = function (segment) {\n  return segment === '.' || toLowerCase(segment) === '%2e';\n};\n\n// https://url.spec.whatwg.org/#double-dot-path-segment\nvar isDoubleDot = function (segment) {\n  segment = toLowerCase(segment);\n  return segment === '..' || segment === '%2e.' || segment === '.%2e' || segment === '%2e%2e';\n};\n\n// States:\nvar SCHEME_START = {};\nvar SCHEME = {};\nvar NO_SCHEME = {};\nvar SPECIAL_RELATIVE_OR_AUTHORITY = {};\nvar PATH_OR_AUTHORITY = {};\nvar RELATIVE = {};\nvar RELATIVE_SLASH = {};\nvar SPECIAL_AUTHORITY_SLASHES = {};\nvar SPECIAL_AUTHORITY_IGNORE_SLASHES = {};\nvar AUTHORITY = {};\nvar HOST = {};\nvar HOSTNAME = {};\nvar PORT = {};\nvar FILE = {};\nvar FILE_SLASH = {};\nvar FILE_HOST = {};\nvar PATH_START = {};\nvar PATH = {};\nvar CANNOT_BE_A_BASE_URL_PATH = {};\nvar QUERY = {};\nvar FRAGMENT = {};\n\nvar URLState = function (url, isBase, base) {\n  var urlString = $toString(url);\n  var baseState, failure, searchParams;\n  if (isBase) {\n    failure = this.parse(urlString);\n    if (failure) throw TypeError(failure);\n    this.searchParams = null;\n  } else {\n    if (base !== undefined) baseState = new URLState(base, true);\n    failure = this.parse(urlString, null, baseState);\n    if (failure) throw TypeError(failure);\n    searchParams = getInternalSearchParamsState(new URLSearchParams());\n    searchParams.bindURL(this);\n    this.searchParams = searchParams;\n  }\n};\n\nURLState.prototype = {\n  type: 'URL',\n  // https://url.spec.whatwg.org/#url-parsing\n  // eslint-disable-next-line max-statements -- TODO\n  parse: function (input, stateOverride, base) {\n    var url = this;\n    var state = stateOverride || SCHEME_START;\n    var pointer = 0;\n    var buffer = '';\n    var seenAt = false;\n    var seenBracket = false;\n    var seenPasswordToken = false;\n    var codePoints, chr, bufferCodePoints, failure;\n\n    input = $toString(input);\n\n    if (!stateOverride) {\n      url.scheme = '';\n      url.username = '';\n      url.password = '';\n      url.host = null;\n      url.port = null;\n      url.path = [];\n      url.query = null;\n      url.fragment = null;\n      url.cannotBeABaseURL = false;\n      input = replace(input, LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE, '');\n    }\n\n    input = replace(input, TAB_AND_NEW_LINE, '');\n\n    codePoints = arrayFrom(input);\n\n    while (pointer <= codePoints.length) {\n      chr = codePoints[pointer];\n      switch (state) {\n        case SCHEME_START:\n          if (chr && exec(ALPHA, chr)) {\n            buffer += toLowerCase(chr);\n            state = SCHEME;\n          } else if (!stateOverride) {\n            state = NO_SCHEME;\n            continue;\n          } else return INVALID_SCHEME;\n          break;\n\n        case SCHEME:\n          if (chr && (exec(ALPHANUMERIC, chr) || chr == '+' || chr == '-' || chr == '.')) {\n            buffer += toLowerCase(chr);\n          } else if (chr == ':') {\n            if (stateOverride && (\n              (url.isSpecial() != hasOwn(specialSchemes, buffer)) ||\n              (buffer == 'file' && (url.includesCredentials() || url.port !== null)) ||\n              (url.scheme == 'file' && !url.host)\n            )) return;\n            url.scheme = buffer;\n            if (stateOverride) {\n              if (url.isSpecial() && specialSchemes[url.scheme] == url.port) url.port = null;\n              return;\n            }\n            buffer = '';\n            if (url.scheme == 'file') {\n              state = FILE;\n            } else if (url.isSpecial() && base && base.scheme == url.scheme) {\n              state = SPECIAL_RELATIVE_OR_AUTHORITY;\n            } else if (url.isSpecial()) {\n              state = SPECIAL_AUTHORITY_SLASHES;\n            } else if (codePoints[pointer + 1] == '/') {\n              state = PATH_OR_AUTHORITY;\n              pointer++;\n            } else {\n              url.cannotBeABaseURL = true;\n              push(url.path, '');\n              state = CANNOT_BE_A_BASE_URL_PATH;\n            }\n          } else if (!stateOverride) {\n            buffer = '';\n            state = NO_SCHEME;\n            pointer = 0;\n            continue;\n          } else return INVALID_SCHEME;\n          break;\n\n        case NO_SCHEME:\n          if (!base || (base.cannotBeABaseURL && chr != '#')) return INVALID_SCHEME;\n          if (base.cannotBeABaseURL && chr == '#') {\n            url.scheme = base.scheme;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n            url.fragment = '';\n            url.cannotBeABaseURL = true;\n            state = FRAGMENT;\n            break;\n          }\n          state = base.scheme == 'file' ? FILE : RELATIVE;\n          continue;\n\n        case SPECIAL_RELATIVE_OR_AUTHORITY:\n          if (chr == '/' && codePoints[pointer + 1] == '/') {\n            state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n            pointer++;\n          } else {\n            state = RELATIVE;\n            continue;\n          } break;\n\n        case PATH_OR_AUTHORITY:\n          if (chr == '/') {\n            state = AUTHORITY;\n            break;\n          } else {\n            state = PATH;\n            continue;\n          }\n\n        case RELATIVE:\n          url.scheme = base.scheme;\n          if (chr == EOF) {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n          } else if (chr == '/' || (chr == '\\\\' && url.isSpecial())) {\n            state = RELATIVE_SLASH;\n          } else if (chr == '?') {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = '';\n            state = QUERY;\n          } else if (chr == '#') {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.query = base.query;\n            url.fragment = '';\n            state = FRAGMENT;\n          } else {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            url.path = arraySlice(base.path);\n            url.path.length--;\n            state = PATH;\n            continue;\n          } break;\n\n        case RELATIVE_SLASH:\n          if (url.isSpecial() && (chr == '/' || chr == '\\\\')) {\n            state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          } else if (chr == '/') {\n            state = AUTHORITY;\n          } else {\n            url.username = base.username;\n            url.password = base.password;\n            url.host = base.host;\n            url.port = base.port;\n            state = PATH;\n            continue;\n          } break;\n\n        case SPECIAL_AUTHORITY_SLASHES:\n          state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          if (chr != '/' || charAt(buffer, pointer + 1) != '/') continue;\n          pointer++;\n          break;\n\n        case SPECIAL_AUTHORITY_IGNORE_SLASHES:\n          if (chr != '/' && chr != '\\\\') {\n            state = AUTHORITY;\n            continue;\n          } break;\n\n        case AUTHORITY:\n          if (chr == '@') {\n            if (seenAt) buffer = '%40' + buffer;\n            seenAt = true;\n            bufferCodePoints = arrayFrom(buffer);\n            for (var i = 0; i < bufferCodePoints.length; i++) {\n              var codePoint = bufferCodePoints[i];\n              if (codePoint == ':' && !seenPasswordToken) {\n                seenPasswordToken = true;\n                continue;\n              }\n              var encodedCodePoints = percentEncode(codePoint, userinfoPercentEncodeSet);\n              if (seenPasswordToken) url.password += encodedCodePoints;\n              else url.username += encodedCodePoints;\n            }\n            buffer = '';\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial())\n          ) {\n            if (seenAt && buffer == '') return INVALID_AUTHORITY;\n            pointer -= arrayFrom(buffer).length + 1;\n            buffer = '';\n            state = HOST;\n          } else buffer += chr;\n          break;\n\n        case HOST:\n        case HOSTNAME:\n          if (stateOverride && url.scheme == 'file') {\n            state = FILE_HOST;\n            continue;\n          } else if (chr == ':' && !seenBracket) {\n            if (buffer == '') return INVALID_HOST;\n            failure = url.parseHost(buffer);\n            if (failure) return failure;\n            buffer = '';\n            state = PORT;\n            if (stateOverride == HOSTNAME) return;\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial())\n          ) {\n            if (url.isSpecial() && buffer == '') return INVALID_HOST;\n            if (stateOverride && buffer == '' && (url.includesCredentials() || url.port !== null)) return;\n            failure = url.parseHost(buffer);\n            if (failure) return failure;\n            buffer = '';\n            state = PATH_START;\n            if (stateOverride) return;\n            continue;\n          } else {\n            if (chr == '[') seenBracket = true;\n            else if (chr == ']') seenBracket = false;\n            buffer += chr;\n          } break;\n\n        case PORT:\n          if (exec(DIGIT, chr)) {\n            buffer += chr;\n          } else if (\n            chr == EOF || chr == '/' || chr == '?' || chr == '#' ||\n            (chr == '\\\\' && url.isSpecial()) ||\n            stateOverride\n          ) {\n            if (buffer != '') {\n              var port = parseInt(buffer, 10);\n              if (port > 0xFFFF) return INVALID_PORT;\n              url.port = (url.isSpecial() && port === specialSchemes[url.scheme]) ? null : port;\n              buffer = '';\n            }\n            if (stateOverride) return;\n            state = PATH_START;\n            continue;\n          } else return INVALID_PORT;\n          break;\n\n        case FILE:\n          url.scheme = 'file';\n          if (chr == '/' || chr == '\\\\') state = FILE_SLASH;\n          else if (base && base.scheme == 'file') {\n            if (chr == EOF) {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = base.query;\n            } else if (chr == '?') {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = '';\n              state = QUERY;\n            } else if (chr == '#') {\n              url.host = base.host;\n              url.path = arraySlice(base.path);\n              url.query = base.query;\n              url.fragment = '';\n              state = FRAGMENT;\n            } else {\n              if (!startsWithWindowsDriveLetter(join(arraySlice(codePoints, pointer), ''))) {\n                url.host = base.host;\n                url.path = arraySlice(base.path);\n                url.shortenPath();\n              }\n              state = PATH;\n              continue;\n            }\n          } else {\n            state = PATH;\n            continue;\n          } break;\n\n        case FILE_SLASH:\n          if (chr == '/' || chr == '\\\\') {\n            state = FILE_HOST;\n            break;\n          }\n          if (base && base.scheme == 'file' && !startsWithWindowsDriveLetter(join(arraySlice(codePoints, pointer), ''))) {\n            if (isWindowsDriveLetter(base.path[0], true)) push(url.path, base.path[0]);\n            else url.host = base.host;\n          }\n          state = PATH;\n          continue;\n\n        case FILE_HOST:\n          if (chr == EOF || chr == '/' || chr == '\\\\' || chr == '?' || chr == '#') {\n            if (!stateOverride && isWindowsDriveLetter(buffer)) {\n              state = PATH;\n            } else if (buffer == '') {\n              url.host = '';\n              if (stateOverride) return;\n              state = PATH_START;\n            } else {\n              failure = url.parseHost(buffer);\n              if (failure) return failure;\n              if (url.host == 'localhost') url.host = '';\n              if (stateOverride) return;\n              buffer = '';\n              state = PATH_START;\n            } continue;\n          } else buffer += chr;\n          break;\n\n        case PATH_START:\n          if (url.isSpecial()) {\n            state = PATH;\n            if (chr != '/' && chr != '\\\\') continue;\n          } else if (!stateOverride && chr == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (!stateOverride && chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            state = PATH;\n            if (chr != '/') continue;\n          } break;\n\n        case PATH:\n          if (\n            chr == EOF || chr == '/' ||\n            (chr == '\\\\' && url.isSpecial()) ||\n            (!stateOverride && (chr == '?' || chr == '#'))\n          ) {\n            if (isDoubleDot(buffer)) {\n              url.shortenPath();\n              if (chr != '/' && !(chr == '\\\\' && url.isSpecial())) {\n                push(url.path, '');\n              }\n            } else if (isSingleDot(buffer)) {\n              if (chr != '/' && !(chr == '\\\\' && url.isSpecial())) {\n                push(url.path, '');\n              }\n            } else {\n              if (url.scheme == 'file' && !url.path.length && isWindowsDriveLetter(buffer)) {\n                if (url.host) url.host = '';\n                buffer = charAt(buffer, 0) + ':'; // normalize windows drive letter\n              }\n              push(url.path, buffer);\n            }\n            buffer = '';\n            if (url.scheme == 'file' && (chr == EOF || chr == '?' || chr == '#')) {\n              while (url.path.length > 1 && url.path[0] === '') {\n                shift(url.path);\n              }\n            }\n            if (chr == '?') {\n              url.query = '';\n              state = QUERY;\n            } else if (chr == '#') {\n              url.fragment = '';\n              state = FRAGMENT;\n            }\n          } else {\n            buffer += percentEncode(chr, pathPercentEncodeSet);\n          } break;\n\n        case CANNOT_BE_A_BASE_URL_PATH:\n          if (chr == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            url.path[0] += percentEncode(chr, C0ControlPercentEncodeSet);\n          } break;\n\n        case QUERY:\n          if (!stateOverride && chr == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          } else if (chr != EOF) {\n            if (chr == \"'\" && url.isSpecial()) url.query += '%27';\n            else if (chr == '#') url.query += '%23';\n            else url.query += percentEncode(chr, C0ControlPercentEncodeSet);\n          } break;\n\n        case FRAGMENT:\n          if (chr != EOF) url.fragment += percentEncode(chr, fragmentPercentEncodeSet);\n          break;\n      }\n\n      pointer++;\n    }\n  },\n  // https://url.spec.whatwg.org/#host-parsing\n  parseHost: function (input) {\n    var result, codePoints, index;\n    if (charAt(input, 0) == '[') {\n      if (charAt(input, input.length - 1) != ']') return INVALID_HOST;\n      result = parseIPv6(stringSlice(input, 1, -1));\n      if (!result) return INVALID_HOST;\n      this.host = result;\n    // opaque host\n    } else if (!this.isSpecial()) {\n      if (exec(FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT, input)) return INVALID_HOST;\n      result = '';\n      codePoints = arrayFrom(input);\n      for (index = 0; index < codePoints.length; index++) {\n        result += percentEncode(codePoints[index], C0ControlPercentEncodeSet);\n      }\n      this.host = result;\n    } else {\n      input = toASCII(input);\n      if (exec(FORBIDDEN_HOST_CODE_POINT, input)) return INVALID_HOST;\n      result = parseIPv4(input);\n      if (result === null) return INVALID_HOST;\n      this.host = result;\n    }\n  },\n  // https://url.spec.whatwg.org/#cannot-have-a-username-password-port\n  cannotHaveUsernamePasswordPort: function () {\n    return !this.host || this.cannotBeABaseURL || this.scheme == 'file';\n  },\n  // https://url.spec.whatwg.org/#include-credentials\n  includesCredentials: function () {\n    return this.username != '' || this.password != '';\n  },\n  // https://url.spec.whatwg.org/#is-special\n  isSpecial: function () {\n    return hasOwn(specialSchemes, this.scheme);\n  },\n  // https://url.spec.whatwg.org/#shorten-a-urls-path\n  shortenPath: function () {\n    var path = this.path;\n    var pathSize = path.length;\n    if (pathSize && (this.scheme != 'file' || pathSize != 1 || !isWindowsDriveLetter(path[0], true))) {\n      path.length--;\n    }\n  },\n  // https://url.spec.whatwg.org/#concept-url-serializer\n  serialize: function () {\n    var url = this;\n    var scheme = url.scheme;\n    var username = url.username;\n    var password = url.password;\n    var host = url.host;\n    var port = url.port;\n    var path = url.path;\n    var query = url.query;\n    var fragment = url.fragment;\n    var output = scheme + ':';\n    if (host !== null) {\n      output += '//';\n      if (url.includesCredentials()) {\n        output += username + (password ? ':' + password : '') + '@';\n      }\n      output += serializeHost(host);\n      if (port !== null) output += ':' + port;\n    } else if (scheme == 'file') output += '//';\n    output += url.cannotBeABaseURL ? path[0] : path.length ? '/' + join(path, '/') : '';\n    if (query !== null) output += '?' + query;\n    if (fragment !== null) output += '#' + fragment;\n    return output;\n  },\n  // https://url.spec.whatwg.org/#dom-url-href\n  setHref: function (href) {\n    var failure = this.parse(href);\n    if (failure) throw TypeError(failure);\n    this.searchParams.update();\n  },\n  // https://url.spec.whatwg.org/#dom-url-origin\n  getOrigin: function () {\n    var scheme = this.scheme;\n    var port = this.port;\n    if (scheme == 'blob') try {\n      return new URLConstructor(scheme.path[0]).origin;\n    } catch (error) {\n      return 'null';\n    }\n    if (scheme == 'file' || !this.isSpecial()) return 'null';\n    return scheme + '://' + serializeHost(this.host) + (port !== null ? ':' + port : '');\n  },\n  // https://url.spec.whatwg.org/#dom-url-protocol\n  getProtocol: function () {\n    return this.scheme + ':';\n  },\n  setProtocol: function (protocol) {\n    this.parse($toString(protocol) + ':', SCHEME_START);\n  },\n  // https://url.spec.whatwg.org/#dom-url-username\n  getUsername: function () {\n    return this.username;\n  },\n  setUsername: function (username) {\n    var codePoints = arrayFrom($toString(username));\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    this.username = '';\n    for (var i = 0; i < codePoints.length; i++) {\n      this.username += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n    }\n  },\n  // https://url.spec.whatwg.org/#dom-url-password\n  getPassword: function () {\n    return this.password;\n  },\n  setPassword: function (password) {\n    var codePoints = arrayFrom($toString(password));\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    this.password = '';\n    for (var i = 0; i < codePoints.length; i++) {\n      this.password += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n    }\n  },\n  // https://url.spec.whatwg.org/#dom-url-host\n  getHost: function () {\n    var host = this.host;\n    var port = this.port;\n    return host === null ? ''\n      : port === null ? serializeHost(host)\n      : serializeHost(host) + ':' + port;\n  },\n  setHost: function (host) {\n    if (this.cannotBeABaseURL) return;\n    this.parse(host, HOST);\n  },\n  // https://url.spec.whatwg.org/#dom-url-hostname\n  getHostname: function () {\n    var host = this.host;\n    return host === null ? '' : serializeHost(host);\n  },\n  setHostname: function (hostname) {\n    if (this.cannotBeABaseURL) return;\n    this.parse(hostname, HOSTNAME);\n  },\n  // https://url.spec.whatwg.org/#dom-url-port\n  getPort: function () {\n    var port = this.port;\n    return port === null ? '' : $toString(port);\n  },\n  setPort: function (port) {\n    if (this.cannotHaveUsernamePasswordPort()) return;\n    port = $toString(port);\n    if (port == '') this.port = null;\n    else this.parse(port, PORT);\n  },\n  // https://url.spec.whatwg.org/#dom-url-pathname\n  getPathname: function () {\n    var path = this.path;\n    return this.cannotBeABaseURL ? path[0] : path.length ? '/' + join(path, '/') : '';\n  },\n  setPathname: function (pathname) {\n    if (this.cannotBeABaseURL) return;\n    this.path = [];\n    this.parse(pathname, PATH_START);\n  },\n  // https://url.spec.whatwg.org/#dom-url-search\n  getSearch: function () {\n    var query = this.query;\n    return query ? '?' + query : '';\n  },\n  setSearch: function (search) {\n    search = $toString(search);\n    if (search == '') {\n      this.query = null;\n    } else {\n      if ('?' == charAt(search, 0)) search = stringSlice(search, 1);\n      this.query = '';\n      this.parse(search, QUERY);\n    }\n    this.searchParams.update();\n  },\n  // https://url.spec.whatwg.org/#dom-url-searchparams\n  getSearchParams: function () {\n    return this.searchParams.facade;\n  },\n  // https://url.spec.whatwg.org/#dom-url-hash\n  getHash: function () {\n    var fragment = this.fragment;\n    return fragment ? '#' + fragment : '';\n  },\n  setHash: function (hash) {\n    hash = $toString(hash);\n    if (hash == '') {\n      this.fragment = null;\n      return;\n    }\n    if ('#' == charAt(hash, 0)) hash = stringSlice(hash, 1);\n    this.fragment = '';\n    this.parse(hash, FRAGMENT);\n  },\n  update: function () {\n    this.query = this.searchParams.serialize() || null;\n  }\n};\n\n// `URL` constructor\n// https://url.spec.whatwg.org/#url-class\nvar URLConstructor = function URL(url /* , base */) {\n  var that = anInstance(this, URLPrototype);\n  var base = arguments.length > 1 ? arguments[1] : undefined;\n  var state = setInternalState(that, new URLState(url, false, base));\n  if (!DESCRIPTORS) {\n    that.href = state.serialize();\n    that.origin = state.getOrigin();\n    that.protocol = state.getProtocol();\n    that.username = state.getUsername();\n    that.password = state.getPassword();\n    that.host = state.getHost();\n    that.hostname = state.getHostname();\n    that.port = state.getPort();\n    that.pathname = state.getPathname();\n    that.search = state.getSearch();\n    that.searchParams = state.getSearchParams();\n    that.hash = state.getHash();\n  }\n};\n\nvar URLPrototype = URLConstructor.prototype;\n\nvar accessorDescriptor = function (getter, setter) {\n  return {\n    get: function () {\n      return getInternalURLState(this)[getter]();\n    },\n    set: setter && function (value) {\n      return getInternalURLState(this)[setter](value);\n    },\n    configurable: true,\n    enumerable: true\n  };\n};\n\nif (DESCRIPTORS) {\n  defineProperties(URLPrototype, {\n    // `URL.prototype.href` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-href\n    href: accessorDescriptor('serialize', 'setHref'),\n    // `URL.prototype.origin` getter\n    // https://url.spec.whatwg.org/#dom-url-origin\n    origin: accessorDescriptor('getOrigin'),\n    // `URL.prototype.protocol` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-protocol\n    protocol: accessorDescriptor('getProtocol', 'setProtocol'),\n    // `URL.prototype.username` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-username\n    username: accessorDescriptor('getUsername', 'setUsername'),\n    // `URL.prototype.password` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-password\n    password: accessorDescriptor('getPassword', 'setPassword'),\n    // `URL.prototype.host` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-host\n    host: accessorDescriptor('getHost', 'setHost'),\n    // `URL.prototype.hostname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hostname\n    hostname: accessorDescriptor('getHostname', 'setHostname'),\n    // `URL.prototype.port` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-port\n    port: accessorDescriptor('getPort', 'setPort'),\n    // `URL.prototype.pathname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-pathname\n    pathname: accessorDescriptor('getPathname', 'setPathname'),\n    // `URL.prototype.search` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-search\n    search: accessorDescriptor('getSearch', 'setSearch'),\n    // `URL.prototype.searchParams` getter\n    // https://url.spec.whatwg.org/#dom-url-searchparams\n    searchParams: accessorDescriptor('getSearchParams'),\n    // `URL.prototype.hash` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hash\n    hash: accessorDescriptor('getHash', 'setHash')\n  });\n}\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\nredefine(URLPrototype, 'toJSON', function toJSON() {\n  return getInternalURLState(this).serialize();\n}, { enumerable: true });\n\n// `URL.prototype.toString` method\n// https://url.spec.whatwg.org/#URL-stringification-behavior\nredefine(URLPrototype, 'toString', function toString() {\n  return getInternalURLState(this).serialize();\n}, { enumerable: true });\n\nif (NativeURL) {\n  var nativeCreateObjectURL = NativeURL.createObjectURL;\n  var nativeRevokeObjectURL = NativeURL.revokeObjectURL;\n  // `URL.createObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL\n  if (nativeCreateObjectURL) redefine(URLConstructor, 'createObjectURL', bind(nativeCreateObjectURL, NativeURL));\n  // `URL.revokeObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/revokeObjectURL\n  if (nativeRevokeObjectURL) redefine(URLConstructor, 'revokeObjectURL', bind(nativeRevokeObjectURL, NativeURL));\n}\n\nsetToStringTag(URLConstructor, 'URL');\n\n$({ global: true, forced: !USE_NATIVE_URL, sham: !DESCRIPTORS }, {\n  URL: URLConstructor\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar call = require('../internals/function-call');\nvar fails = require('../internals/fails');\nvar objectKeys = require('../internals/object-keys');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\n\n// eslint-disable-next-line es/no-object-assign -- safe\nvar $assign = Object.assign;\n// eslint-disable-next-line es/no-object-defineproperty -- required for testing\nvar defineProperty = Object.defineProperty;\nvar concat = uncurryThis([].concat);\n\n// `Object.assign` method\n// https://tc39.es/ecma262/#sec-object.assign\nmodule.exports = !$assign || fails(function () {\n  // should have correct order of operations (Edge bug)\n  if (DESCRIPTORS && $assign({ b: 1 }, $assign(defineProperty({}, 'a', {\n    enumerable: true,\n    get: function () {\n      defineProperty(this, 'b', {\n        value: 3,\n        enumerable: false\n      });\n    }\n  }), { b: 2 })).b !== 1) return true;\n  // should work with symbols and should have deterministic property order (V8 bug)\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line es/no-symbol -- safe\n  var symbol = Symbol();\n  var alphabet = 'abcdefghijklmnopqrst';\n  A[symbol] = 7;\n  alphabet.split('').forEach(function (chr) { B[chr] = chr; });\n  return $assign({}, A)[symbol] != 7 || objectKeys($assign({}, B)).join('') != alphabet;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars -- required for `.length`\n  var T = toObject(target);\n  var argumentsLength = arguments.length;\n  var index = 1;\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  var propertyIsEnumerable = propertyIsEnumerableModule.f;\n  while (argumentsLength > index) {\n    var S = IndexedObject(arguments[index++]);\n    var keys = getOwnPropertySymbols ? concat(objectKeys(S), getOwnPropertySymbols(S)) : objectKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) {\n      key = keys[j++];\n      if (!DESCRIPTORS || call(propertyIsEnumerable, S, key)) T[key] = S[key];\n    }\n  } return T;\n} : $assign;\n","var anObject = require('../internals/an-object');\nvar iteratorClose = require('../internals/iterator-close');\n\n// call something on iterator step with safe closing on error\nmodule.exports = function (iterator, fn, value, ENTRIES) {\n  try {\n    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n  } catch (error) {\n    iteratorClose(iterator, 'throw', error);\n  }\n};\n","'use strict';\nvar global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar isConstructor = require('../internals/is-constructor');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nvar Array = global.Array;\n\n// `Array.from` method implementation\n// https://tc39.es/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var IS_CONSTRUCTOR = isConstructor(this);\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined);\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod && !(this == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = getIterator(O, iteratorMethod);\n    next = iterator.next;\n    result = IS_CONSTRUCTOR ? new this() : [];\n    for (;!(step = call(next, iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = lengthOfArrayLike(O);\n    result = IS_CONSTRUCTOR ? new this(length) : Array(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","'use strict';\n// based on https://github.com/bestiejs/punycode.js/blob/master/punycode.js\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\nvar base = 36;\nvar tMin = 1;\nvar tMax = 26;\nvar skew = 38;\nvar damp = 700;\nvar initialBias = 72;\nvar initialN = 128; // 0x80\nvar delimiter = '-'; // '\\x2D'\nvar regexNonASCII = /[^\\0-\\u007E]/; // non-ASCII chars\nvar regexSeparators = /[.\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\nvar OVERFLOW_ERROR = 'Overflow: input needs wider integers to process';\nvar baseMinusTMin = base - tMin;\n\nvar RangeError = global.RangeError;\nvar exec = uncurryThis(regexSeparators.exec);\nvar floor = Math.floor;\nvar fromCharCode = String.fromCharCode;\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar join = uncurryThis([].join);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar split = uncurryThis(''.split);\nvar toLowerCase = uncurryThis(''.toLowerCase);\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n */\nvar ucs2decode = function (string) {\n  var output = [];\n  var counter = 0;\n  var length = string.length;\n  while (counter < length) {\n    var value = charCodeAt(string, counter++);\n    if (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n      // It's a high surrogate, and there is a next character.\n      var extra = charCodeAt(string, counter++);\n      if ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n        push(output, ((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n      } else {\n        // It's an unmatched surrogate; only append this code unit, in case the\n        // next code unit is the high surrogate of a surrogate pair.\n        push(output, value);\n        counter--;\n      }\n    } else {\n      push(output, value);\n    }\n  }\n  return output;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n */\nvar digitToBasic = function (digit) {\n  //  0..25 map to ASCII a..z or A..Z\n  // 26..35 map to ASCII 0..9\n  return digit + 22 + 75 * (digit < 26);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n */\nvar adapt = function (delta, numPoints, firstTime) {\n  var k = 0;\n  delta = firstTime ? floor(delta / damp) : delta >> 1;\n  delta += floor(delta / numPoints);\n  while (delta > baseMinusTMin * tMax >> 1) {\n    delta = floor(delta / baseMinusTMin);\n    k += base;\n  }\n  return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n */\nvar encode = function (input) {\n  var output = [];\n\n  // Convert the input in UCS-2 to an array of Unicode code points.\n  input = ucs2decode(input);\n\n  // Cache the length.\n  var inputLength = input.length;\n\n  // Initialize the state.\n  var n = initialN;\n  var delta = 0;\n  var bias = initialBias;\n  var i, currentValue;\n\n  // Handle the basic code points.\n  for (i = 0; i < input.length; i++) {\n    currentValue = input[i];\n    if (currentValue < 0x80) {\n      push(output, fromCharCode(currentValue));\n    }\n  }\n\n  var basicLength = output.length; // number of basic code points.\n  var handledCPCount = basicLength; // number of code points that have been handled;\n\n  // Finish the basic string with a delimiter unless it's empty.\n  if (basicLength) {\n    push(output, delimiter);\n  }\n\n  // Main encoding loop:\n  while (handledCPCount < inputLength) {\n    // All non-basic code points < n have been handled already. Find the next larger one:\n    var m = maxInt;\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue >= n && currentValue < m) {\n        m = currentValue;\n      }\n    }\n\n    // Increase `delta` enough to advance the decoder's <n,i> state to <m,0>, but guard against overflow.\n    var handledCPCountPlusOne = handledCPCount + 1;\n    if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n      throw RangeError(OVERFLOW_ERROR);\n    }\n\n    delta += (m - n) * handledCPCountPlusOne;\n    n = m;\n\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue < n && ++delta > maxInt) {\n        throw RangeError(OVERFLOW_ERROR);\n      }\n      if (currentValue == n) {\n        // Represent delta as a generalized variable-length integer.\n        var q = delta;\n        var k = base;\n        while (true) {\n          var t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n          if (q < t) break;\n          var qMinusT = q - t;\n          var baseMinusT = base - t;\n          push(output, fromCharCode(digitToBasic(t + qMinusT % baseMinusT)));\n          q = floor(qMinusT / baseMinusT);\n          k += base;\n        }\n\n        push(output, fromCharCode(digitToBasic(q)));\n        bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n        delta = 0;\n        handledCPCount++;\n      }\n    }\n\n    delta++;\n    n++;\n  }\n  return join(output, '');\n};\n\nmodule.exports = function (input) {\n  var encoded = [];\n  var labels = split(replace(toLowerCase(input), regexSeparators, '\\u002E'), '.');\n  var i, label;\n  for (i = 0; i < labels.length; i++) {\n    label = labels[i];\n    push(encoded, exec(regexNonASCII, label) ? 'xn--' + encode(label) : label);\n  }\n  return join(encoded, '.');\n};\n","var global = require('../internals/global');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (passed, required) {\n  if (passed < required) throw TypeError('Not enough arguments');\n  return passed;\n};\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.array.iterator');\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\nvar anInstance = require('../internals/an-instance');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar bind = require('../internals/function-bind-context');\nvar classof = require('../internals/classof');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar $toString = require('../internals/to-string');\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arraySort = require('../internals/array-sort');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar URL_SEARCH_PARAMS = 'URLSearchParams';\nvar URL_SEARCH_PARAMS_ITERATOR = URL_SEARCH_PARAMS + 'Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalParamsState = InternalStateModule.getterFor(URL_SEARCH_PARAMS);\nvar getInternalIteratorState = InternalStateModule.getterFor(URL_SEARCH_PARAMS_ITERATOR);\n\nvar n$Fetch = getBuiltIn('fetch');\nvar N$Request = getBuiltIn('Request');\nvar Headers = getBuiltIn('Headers');\nvar RequestPrototype = N$Request && N$Request.prototype;\nvar HeadersPrototype = Headers && Headers.prototype;\nvar RegExp = global.RegExp;\nvar TypeError = global.TypeError;\nvar decodeURIComponent = global.decodeURIComponent;\nvar encodeURIComponent = global.encodeURIComponent;\nvar charAt = uncurryThis(''.charAt);\nvar join = uncurryThis([].join);\nvar push = uncurryThis([].push);\nvar replace = uncurryThis(''.replace);\nvar shift = uncurryThis([].shift);\nvar splice = uncurryThis([].splice);\nvar split = uncurryThis(''.split);\nvar stringSlice = uncurryThis(''.slice);\n\nvar plus = /\\+/g;\nvar sequences = Array(4);\n\nvar percentSequence = function (bytes) {\n  return sequences[bytes - 1] || (sequences[bytes - 1] = RegExp('((?:%[\\\\da-f]{2}){' + bytes + '})', 'gi'));\n};\n\nvar percentDecode = function (sequence) {\n  try {\n    return decodeURIComponent(sequence);\n  } catch (error) {\n    return sequence;\n  }\n};\n\nvar deserialize = function (it) {\n  var result = replace(it, plus, ' ');\n  var bytes = 4;\n  try {\n    return decodeURIComponent(result);\n  } catch (error) {\n    while (bytes) {\n      result = replace(result, percentSequence(bytes--), percentDecode);\n    }\n    return result;\n  }\n};\n\nvar find = /[!'()~]|%20/g;\n\nvar replacements = {\n  '!': '%21',\n  \"'\": '%27',\n  '(': '%28',\n  ')': '%29',\n  '~': '%7E',\n  '%20': '+'\n};\n\nvar replacer = function (match) {\n  return replacements[match];\n};\n\nvar serialize = function (it) {\n  return replace(encodeURIComponent(it), find, replacer);\n};\n\nvar URLSearchParamsIterator = createIteratorConstructor(function Iterator(params, kind) {\n  setInternalState(this, {\n    type: URL_SEARCH_PARAMS_ITERATOR,\n    iterator: getIterator(getInternalParamsState(params).entries),\n    kind: kind\n  });\n}, 'Iterator', function next() {\n  var state = getInternalIteratorState(this);\n  var kind = state.kind;\n  var step = state.iterator.next();\n  var entry = step.value;\n  if (!step.done) {\n    step.value = kind === 'keys' ? entry.key : kind === 'values' ? entry.value : [entry.key, entry.value];\n  } return step;\n}, true);\n\nvar URLSearchParamsState = function (init) {\n  this.entries = [];\n  this.url = null;\n\n  if (init !== undefined) {\n    if (isObject(init)) this.parseObject(init);\n    else this.parseQuery(typeof init == 'string' ? charAt(init, 0) === '?' ? stringSlice(init, 1) : init : $toString(init));\n  }\n};\n\nURLSearchParamsState.prototype = {\n  type: URL_SEARCH_PARAMS,\n  bindURL: function (url) {\n    this.url = url;\n    this.update();\n  },\n  parseObject: function (object) {\n    var iteratorMethod = getIteratorMethod(object);\n    var iterator, next, step, entryIterator, entryNext, first, second;\n\n    if (iteratorMethod) {\n      iterator = getIterator(object, iteratorMethod);\n      next = iterator.next;\n      while (!(step = call(next, iterator)).done) {\n        entryIterator = getIterator(anObject(step.value));\n        entryNext = entryIterator.next;\n        if (\n          (first = call(entryNext, entryIterator)).done ||\n          (second = call(entryNext, entryIterator)).done ||\n          !call(entryNext, entryIterator).done\n        ) throw TypeError('Expected sequence with length 2');\n        push(this.entries, { key: $toString(first.value), value: $toString(second.value) });\n      }\n    } else for (var key in object) if (hasOwn(object, key)) {\n      push(this.entries, { key: key, value: $toString(object[key]) });\n    }\n  },\n  parseQuery: function (query) {\n    if (query) {\n      var attributes = split(query, '&');\n      var index = 0;\n      var attribute, entry;\n      while (index < attributes.length) {\n        attribute = attributes[index++];\n        if (attribute.length) {\n          entry = split(attribute, '=');\n          push(this.entries, {\n            key: deserialize(shift(entry)),\n            value: deserialize(join(entry, '='))\n          });\n        }\n      }\n    }\n  },\n  serialize: function () {\n    var entries = this.entries;\n    var result = [];\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      push(result, serialize(entry.key) + '=' + serialize(entry.value));\n    } return join(result, '&');\n  },\n  update: function () {\n    this.entries.length = 0;\n    this.parseQuery(this.url.query);\n  },\n  updateURL: function () {\n    if (this.url) this.url.update();\n  }\n};\n\n// `URLSearchParams` constructor\n// https://url.spec.whatwg.org/#interface-urlsearchparams\nvar URLSearchParamsConstructor = function URLSearchParams(/* init */) {\n  anInstance(this, URLSearchParamsPrototype);\n  var init = arguments.length > 0 ? arguments[0] : undefined;\n  setInternalState(this, new URLSearchParamsState(init));\n};\n\nvar URLSearchParamsPrototype = URLSearchParamsConstructor.prototype;\n\nredefineAll(URLSearchParamsPrototype, {\n  // `URLSearchParams.prototype.append` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-append\n  append: function append(name, value) {\n    validateArgumentsLength(arguments.length, 2);\n    var state = getInternalParamsState(this);\n    push(state.entries, { key: $toString(name), value: $toString(value) });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.delete` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-delete\n  'delete': function (name) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var key = $toString(name);\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index].key === key) splice(entries, index, 1);\n      else index++;\n    }\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.get` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-get\n  get: function get(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) return entries[index].value;\n    }\n    return null;\n  },\n  // `URLSearchParams.prototype.getAll` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-getall\n  getAll: function getAll(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var result = [];\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) push(result, entries[index].value);\n    }\n    return result;\n  },\n  // `URLSearchParams.prototype.has` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-has\n  has: function has(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = $toString(name);\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index++].key === key) return true;\n    }\n    return false;\n  },\n  // `URLSearchParams.prototype.set` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-set\n  set: function set(name, value) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var found = false;\n    var key = $toString(name);\n    var val = $toString(value);\n    var index = 0;\n    var entry;\n    for (; index < entries.length; index++) {\n      entry = entries[index];\n      if (entry.key === key) {\n        if (found) splice(entries, index--, 1);\n        else {\n          found = true;\n          entry.value = val;\n        }\n      }\n    }\n    if (!found) push(entries, { key: key, value: val });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.sort` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-sort\n  sort: function sort() {\n    var state = getInternalParamsState(this);\n    arraySort(state.entries, function (a, b) {\n      return a.key > b.key ? 1 : -1;\n    });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.forEach` method\n  forEach: function forEach(callback /* , thisArg */) {\n    var entries = getInternalParamsState(this).entries;\n    var boundFunction = bind(callback, arguments.length > 1 ? arguments[1] : undefined);\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      boundFunction(entry.value, entry.key, this);\n    }\n  },\n  // `URLSearchParams.prototype.keys` method\n  keys: function keys() {\n    return new URLSearchParamsIterator(this, 'keys');\n  },\n  // `URLSearchParams.prototype.values` method\n  values: function values() {\n    return new URLSearchParamsIterator(this, 'values');\n  },\n  // `URLSearchParams.prototype.entries` method\n  entries: function entries() {\n    return new URLSearchParamsIterator(this, 'entries');\n  }\n}, { enumerable: true });\n\n// `URLSearchParams.prototype[@@iterator]` method\nredefine(URLSearchParamsPrototype, ITERATOR, URLSearchParamsPrototype.entries, { name: 'entries' });\n\n// `URLSearchParams.prototype.toString` method\n// https://url.spec.whatwg.org/#urlsearchparams-stringification-behavior\nredefine(URLSearchParamsPrototype, 'toString', function toString() {\n  return getInternalParamsState(this).serialize();\n}, { enumerable: true });\n\nsetToStringTag(URLSearchParamsConstructor, URL_SEARCH_PARAMS);\n\n$({ global: true, forced: !USE_NATIVE_URL }, {\n  URLSearchParams: URLSearchParamsConstructor\n});\n\n// Wrap `fetch` and `Request` for correct work with polyfilled `URLSearchParams`\nif (!USE_NATIVE_URL && isCallable(Headers)) {\n  var headersHas = uncurryThis(HeadersPrototype.has);\n  var headersSet = uncurryThis(HeadersPrototype.set);\n\n  var wrapRequestOptions = function (init) {\n    if (isObject(init)) {\n      var body = init.body;\n      var headers;\n      if (classof(body) === URL_SEARCH_PARAMS) {\n        headers = init.headers ? new Headers(init.headers) : new Headers();\n        if (!headersHas(headers, 'content-type')) {\n          headersSet(headers, 'content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n        return create(init, {\n          body: createPropertyDescriptor(0, $toString(body)),\n          headers: createPropertyDescriptor(0, headers)\n        });\n      }\n    } return init;\n  };\n\n  if (isCallable(n$Fetch)) {\n    $({ global: true, enumerable: true, forced: true }, {\n      fetch: function fetch(input /* , init */) {\n        return n$Fetch(input, arguments.length > 1 ? wrapRequestOptions(arguments[1]) : {});\n      }\n    });\n  }\n\n  if (isCallable(N$Request)) {\n    var RequestConstructor = function Request(input /* , init */) {\n      anInstance(this, RequestPrototype);\n      return new N$Request(input, arguments.length > 1 ? wrapRequestOptions(arguments[1]) : {});\n    };\n\n    RequestPrototype.constructor = RequestConstructor;\n    RequestConstructor.prototype = RequestPrototype;\n\n    $({ global: true, forced: true }, {\n      Request: RequestConstructor\n    });\n  }\n}\n\nmodule.exports = {\n  URLSearchParams: URLSearchParamsConstructor,\n  getState: getInternalParamsState\n};\n","import 'core-js';\nimport 'mdn-polyfills/Node.prototype.append';\n\nif (!('scrollTo' in Element.prototype)) {\n    Object.defineProperty(Element.prototype, 'scrollTo', {\n        value: function (x, y) {\n            this.scrollLeft = x;\n            this.scrollTop = y;\n        }\n    });\n}\n\nif (!('scrollBy' in Element.prototype)) {\n    Object.defineProperty(Element.prototype, 'scrollBy', {\n        value: function (x, y) {\n            this.scrollLeft += x;\n            this.scrollTop += y;\n        }\n    });\n}\n\n// sometimes Android WebView has no localStorage\nif (!('localStorage' in window)) {\n    try {\n        window['localStorage'] = {\n            getItem: () => null,\n            setItem: () => {},\n            removeItem: () => {},\n        } as any;\n    } catch (e) {\n        // maybe it doesn't let me set this\n    }\n}","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\n$({ target: 'URL', proto: true, enumerable: true }, {\n  toJSON: function toJSON() {\n    return call(URL.prototype.toString, this);\n  }\n});\n","!function(){function t(){var e=Array.prototype.slice.call(arguments),n=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;n.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(n)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty(\"append\")||Object.defineProperty(e,\"append\",{configurable:!0,enumerable:!0,writable:!0,value:t})})}();\n","export function createCanvas(w?: number, h?: number): HTMLCanvasElement {\n    const result = document.createElement('canvas');\n    if (w && h) {\n        result.width = w;\n        result.height = h;\n    }\n    return result;\n}","import {createCanvas} from './create-canvas';\n\nexport const isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n\nexport const eventUsesHighResTimeStamp = (function() {\n\n    let eventUsesHighResTimeStamp: boolean | null = null;\n    if (document.body) {\n        (function() {\n            const event = new Event('');\n            eventUsesHighResTimeStamp = event.timeStamp < 1000 * 60 * 60;\n        })();\n    } else {\n        window.addEventListener('DOMContentLoaded', function(event) {\n            eventUsesHighResTimeStamp = event.timeStamp < 1000 * 60 * 60;\n        });\n    }\n\n    return function(): boolean {\n        if (eventUsesHighResTimeStamp === null) {\n            throw 'eventUsesHighResTimeStamp not initialized';\n        }\n        return eventUsesHighResTimeStamp;\n    }\n})();\n\nexport const mouseEventHasMovement = (() => {\n\n    // no support: IE, Safari, Safari iOS\n    // supported but broken: Firefox\n\n    if (!('MouseEvent' in window)) {\n        return false;\n    }\n    let mouseEvent;\n    try {\n        mouseEvent = new MouseEvent('mousemove'); // browsers not supporting the constructor don't have it\n    } catch (e) {\n        return false;\n    }\n    if (!('movementX' in mouseEvent)) {\n        return false; // likely safari\n    }\n    return !isFirefox;\n})();\n\nexport const hasPointerEvents = !!window.PointerEvent;\n\nexport const hasWebGl = (function() {\n\n    const hasWebgl = (function() {\n        const canvas = createCanvas();\n        try {\n            canvas.getContext('experimental-webgl', { premultipliedAlpha: false });\n            return true;\n        } catch (e) {\n            return false;\n        }\n    })();\n\n    return function() {\n        return hasWebgl;\n    }\n})();\n\nexport const getVisitor = (function () {\n    const visitor = {\n        chrome: false,\n        gl: false\n    };\n    //Chrome\n    if ((window as any).chrome && (window as any).chrome.app) {\n        visitor.chrome = true;\n    }\n    //WebGL\n    visitor.gl = hasWebGl();\n    return function () {\n        return JSON.parse(JSON.stringify(visitor));\n    }\n})();\n\nexport const isCssMinMaxSupported = (function() {\n    let result: boolean | null = null;\n\n    function test() {\n        const div = document.createElement('div');\n        div.style.position = 'absolute';\n        div.style.top = '0';\n        div.style.left = 'max(0px, 25px)';\n        document.body.appendChild(div);\n        setTimeout(function() {\n            result = div.offsetLeft === 25;\n            document.body.removeChild(div);\n        }, 25);\n    }\n\n    if (document.body) {\n        test();\n    } else {\n        window.addEventListener('DOMContentLoaded', function() {\n            test();\n        });\n    }\n\n    return function(): boolean {\n        if (result === null) {\n            throw new Error('isCssMinMaxSupported not initialized');\n        }\n        return result;\n    };\n})();\n\nexport const canShareFiles = function(): boolean {\n    return 'share' in navigator && 'canShare' in navigator;\n};","import {hasPointerEvents} from '../base/browser';\n\nconst listenerFuncObj = {};\n\nexport const setEventListener = function (DomEl, type, listener) {\n    if (!hasPointerEvents) {\n        type = type.replace('pointer', 'mouse');\n    }\n    DomEl[type] = listener;\n};\n\nexport const addEventListener = function (DomEl, type, listener, options?) {\n    if (!hasPointerEvents) {\n        type = type.replace('pointer', 'mouse');\n    }\n    if (!(type in listenerFuncObj)) {\n        listenerFuncObj[type] = [];\n    }\n    listenerFuncObj[type].push(listener);\n    DomEl.addEventListener(type, listener, options);\n};\n\nexport const removeEventListener = function (DomEl, type, listener, options?) {\n    if (!hasPointerEvents) {\n        type = type.replace('pointer', 'mouse');\n    }\n    if (type in listenerFuncObj) {\n        for (let i = 0; i < listenerFuncObj[type].length; i++) {\n            if (listenerFuncObj[type][i] === listener) {\n                listenerFuncObj[type].splice(i, 1);\n                i--;\n            }\n        }\n    }\n    DomEl.removeEventListener(type, listener, options);\n};","import {IKeyString, ISize2D, ISVG, IVector2D} from '../BB.types';\n\nexport function insertAfter (referenceNode: Element, newNode: Element): void {\n    if (referenceNode.parentNode) {\n        referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n    }\n}\n\nexport function loadImage (im: HTMLImageElement, callback: () => void): void {\n    let counter = 0;\n\n    function check() {\n        if (counter === 1000) {\n            alert(\"couldn't load\");\n            return;\n        }\n        if (im.complete) {\n            counter++;\n            callback();\n        } else {\n            setTimeout(check, 1);\n        }\n    }\n\n    check();\n}\n\nexport function css (el: HTMLElement | SVGElement, styleObj: IKeyString): void {\n    const keyArr = Object.keys(styleObj);\n    let keyStr: string;\n    const style = (el.style as unknown) as IKeyString;\n    for (let i = 0; i < keyArr.length; i++) {\n        keyStr = keyArr[i];\n        style[keyStr] = styleObj[keyStr];\n        style.alignContent = 'true';\n        if (keyStr === 'userSelect') {\n            style.webkitUserSelect = styleObj[keyStr]; // safari\n        }\n    }\n}\n\nexport function setAttributes (el: HTMLElement, attrObj: IKeyString): void {\n    const keyArr = Object.keys(attrObj);\n    let keyStr;\n    for (let i = 0; i < keyArr.length; i++) {\n        keyStr = keyArr[i];\n        el.setAttribute(keyStr, attrObj[keyStr]);\n    }\n}\n\nexport function addClassName (el: HTMLElement | SVGElement, classStr: string): void {\n    const classAttr = el.getAttribute('class');\n    const splitArr = classAttr === null ? [] : classAttr.split(' ');\n    if (splitArr.includes(classStr)) {\n        return;\n    }\n    splitArr.push(classStr);\n    el.setAttribute('class', splitArr.join(' '));\n}\n\nexport function removeClassName (el: HTMLElement | SVGElement, classStr: string): void {\n    const classAttr = el.getAttribute('class');\n    const splitArr = classAttr === null ? [] : classAttr.split(' ');\n    if (!splitArr.includes(classStr)) {\n        return;\n    }\n    for (let i = 0; i < splitArr.length; i++) {\n        if (splitArr[i] === classStr) {\n            splitArr.splice(i, 1);\n            i--;\n        }\n    }\n    el.setAttribute('class', splitArr.join(' '));\n}\n\n/**\n * appendChild with an array\n * @param target\n * @param els\n */\nexport function append(target: HTMLElement, els: (HTMLElement | string | null)[]) {\n    const fragment = document.createDocumentFragment();\n    els.forEach(item => item ? fragment.append(item) : null);\n    target.append(fragment);\n}\n\n/**\n * a needs to fit into b\n * @param aw\n * @param ah\n * @param bw\n * @param bh\n * @param min\n */\nexport function fitInto (aw: number, ah: number, bw: number, bh: number, min?: number): ISize2D {\n    let width = aw * bw, height = ah * bw;\n    if (width > bw) {\n        height = bw / width * height;\n        width = bw;\n    }\n    if (height > bh) {\n        width = bh / height * width;\n        height = bh;\n    }\n    if (min) {\n        width = Math.max(min, width);\n        height = Math.max(min, height);\n    }\n    return {width, height};\n}\n\n/**\n * center b in a\n * @param aw\n * @param ah\n * @param bw\n * @param bh\n */\nexport function centerWithin (aw: number, ah: number, bw: number, bh: number): IVector2D {\n    return {\n        x: aw / 2 - bw / 2,\n        y: ah / 2 - bh / 2\n    };\n}\n\nexport function getDate (): string {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\n    const day = date.getDate().toString().padStart(2, '0');\n    const minutes = (date.getHours() * 60 + date.getMinutes()).toString(36).padStart(3, '0');\n\n    return year + '_' + month + '_' + day + '_' + minutes + '_';\n}\n\nexport function gcd (a: number, b: number): number {\n    return b ? gcd(b, a % b) : a;\n}\n\nexport function reduce (numerator: number, denominator: number): [number, number] {\n    const g = gcd(numerator, denominator);\n    return [numerator / g, denominator / g];\n}\n\nexport function decToFraction (decimalNumber: number): [number, number] {\n    const len = decimalNumber.toString().length - 2;\n    const denominator = Math.pow(10, len);\n    const numerator = decimalNumber * denominator;\n    return reduce(numerator, denominator);\n}\n\n/**\n * blobObj isn't always a Blob, but rather an object, because Blob doesn't exist.\n * @param blobObj\n * @returns {string}\n */\nexport function imageBlobToUrl(blobObj: Blob): string {\n    if (!blobObj) {\n        throw new Error('blobObj is undefined or null');\n    }\n    if (window.Blob && blobObj instanceof Blob) {\n        return URL.createObjectURL(blobObj); // object url\n    } else if (blobObj.constructor.name === 'Object') {\n        const fauxBlob = (blobObj as unknown) as {type: string, encoding: string, data: string};\n        return 'data:' + fauxBlob.type + ';' + fauxBlob.encoding + ',' + fauxBlob.data; // data url\n    } else {\n        throw new Error('unknown blob format');\n    }\n}\n\nexport function dateDayDifference (dateA: string | Date, dateB: string | Date): number {\n    dateA = new Date(dateA);\n    dateB = new Date(dateB);\n    dateA.setHours(0, 0, 0, 0);\n    dateB.setHours(0, 0, 0, 0);\n    return (dateB.getTime() - dateA.getTime()) / (1000 * 60 * 60 * 24);\n}\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function copyObj (obj: any): any {\n    return JSON.parse(JSON.stringify(obj));\n}\n\n/**\n * triggers Web Share API - share feature on mobile devices\n * Only works if they support file sharing - e.g. Safari can't do this yet\n * only call if BB.canShareFiles() -> true\n *\n * p = {\n *     canvas: Canvas,\n *     fileName: string,\n *     title: string\n * }\n *\n * @param p\n */\nexport function shareCanvas (p: {canvas: HTMLCanvasElement, fileName:string, title: string, callback: () => void}): void {\n    const mimetype = 'image/png';\n    const err = () => alert('sharing not supported');\n    p.canvas.toBlob(function(blob) {\n        if (blob === null) {\n            err();\n            p.callback();\n            return;\n        }\n        try {\n            const filesArray = [new File([blob], p.fileName, {type: mimetype})];\n            navigator.share({\n                title: p.title,\n                files: filesArray,\n            } as any)\n                .then(r => {\n\n                })\n                .catch(e => {\n                    err();\n            });\n        } catch(e) {\n            err();\n        }\n        p.callback();\n    }, mimetype);\n}\n\n/**\n * Prevent ipad from zooming in when double tapping. iPadOS 13 bug.\n * Give it your click event\n *\n * @param clickEvent\n * @returns {boolean}\n */\nexport function handleClick (clickEvent: MouseEvent): boolean {\n    const target: HTMLElement | null = clickEvent.target as HTMLElement;\n    if (!target) {\n        return false;\n    }\n    if (['A', 'LABEL', 'INPUT'].includes(target.tagName) || (target as any).allowClick) {\n        return true;\n    }\n    clickEvent.preventDefault();\n    return false;\n}\n\n\n/**\n * @param el {elementType: string, childrenArr: []el, ...svg attributes...}\n * @returns svg element tree\n */\nexport function createSvg (el: ISVG): SVGElement {\n    const result = document.createElementNS('http://www.w3.org/2000/svg', el.elementType);\n    const keyArr = Object.keys(el);\n    let keyStr;\n    for (let i = 0; i < keyArr.length; i++) {\n        keyStr = keyArr[i];\n        if (keyStr === 'childrenArr') {\n            for (let e = 0; e < el.childrenArr.length; e++) {\n                result.appendChild(createSvg(el.childrenArr[e]));\n            }\n        } else if (keyStr !== 'elementType') {\n            result.setAttribute(keyStr, el[keyStr] as string);\n        }\n    }\n    return result;\n}","import {addEventListener, removeEventListener} from './event-listener';\n\n\nconst globalKey = (() => {\n\n    const keyStrToKeyObj = { // keyStr not to contain a '+', because that's used for the comboStr\n        'space': [' ', 'Spacebar'], // Spacebar in IE\n        'alt': ['Alt', 'AltGraph'],\n        'shift': 'Shift',\n        'ctrl': 'Control',\n        'cmd': ['Meta', 'MetaLeft', 'MetaRight'],\n        'enter': 'Enter',\n        'esc': 'Escape',\n        'backspace': 'Backspace',\n        'delete': 'Delete',\n        'sqbr_open': '[',\n        'sqbr_close': ']',\n        'a': ['a', 'A'],\n        'b': ['b', 'B'],\n        'c': ['c', 'C'],\n        'e': ['e', 'E'],\n        'f': ['f', 'F'],\n        'g': ['g', 'G'],\n        'r': ['r', 'R'], // when holding shift\n        's': ['s', 'S'],\n        't': ['t', 'T'],\n        'u': ['u', 'U'],\n        'x': ['x', 'X'],\n        'y': ['y', 'Y'],\n        'z': ['z', 'Z'],\n        'plus': '+',\n        'minus': '-',\n        'left': 'ArrowLeft',\n        'right': 'ArrowRight',\n        'up': 'ArrowUp',\n        'down': 'ArrowDown',\n        'home': 'Home',\n        'end': 'End'\n    };\n  \n    const keyToKeyStrArr = Object.keys(keyStrToKeyObj);\n    const isDownObj = {};\n    const keyToKeyStrObj = {}; // event.key to keyStr { ArrowLeft: 'left', ... }\n    let comboArr = [];\n    //a physical key's \"key\" can change as other keys get pressed. to keep track, need to also track the code\n    let codeIsDownObj = {}; // { KeyE: 'e', KeyF: null } - null not down, string, the associated keyStr\n    const listenerArr = [];\n\n    for (let i = 0; i < keyToKeyStrArr.length; i++) {\n        isDownObj[keyToKeyStrArr[i]] = false;\n        \n\n        const code = keyStrToKeyObj[keyToKeyStrArr[i]];\n        if (typeof code === 'string') {\n            keyToKeyStrObj[keyStrToKeyObj[keyToKeyStrArr[i]]] = keyToKeyStrArr[i];\n        } else {\n            for (let e = 0; e < code.length; e++) {\n               \n                keyToKeyStrObj[code[e]] = keyToKeyStrArr[i];\n            }\n        }\n    }\n\n    function emitDown(a, b, c, d?) {\n        listenerArr.forEach(item => {\n            if (!item[0]) {\n                return;\n            }\n            item[0](a, b, c, d);\n        });\n    }\n\n    function emitUp(a, b, c) {\n        listenerArr.forEach(item => {\n            if (!item[1]) {\n                return;\n            }\n            item[1](a, b, c);\n        });\n    }\n\n    function emitBlur() {\n        listenerArr.forEach(item => {\n            if (!item[2]) {\n                return;\n            }\n            item[2]();\n        });\n    }\n\n    function keyDown(e) {\n        const key = e.key;\n        const code = 'code' in e ? e.code : e.keyCode; // ie doesn't have code\n        console.log(code)\n\n        if (key in keyToKeyStrObj) {\n            const keyStr = keyToKeyStrObj[key];\n            if (isDownObj[keyStr]) {\n                emitDown(keyStr, e, comboArr.join('+'), true);\n                return;\n            }\n            isDownObj[keyStr] = true;\n            codeIsDownObj[code] = keyStr;\n\n            //add to combo\n            comboArr.push(keyStr);\n\n            emitDown(keyStr, e, comboArr.join('+'));\n        }\n    }\n\n\n    function keyUp(e) {\n        const key = e.key;\n        const code = 'code' in e ? e.code : e.keyCode; // ie doesn't have code\n        const oldComboStr = comboArr.join('+');\n\n        // because of a macOS bug: when meta key is down, keyup of other keys does not fire.\n        // https://stackoverflow.com/questions/25438608/javascript-keyup-isnt-called-when-command-and-another-is-pressed\n        if ([\n            'Meta', 'MetaLeft', 'MetaRight',\n            'OSLeft', 'OSRight', // Firefox\n        ].includes(code)) {\n            blur(null);\n            return;\n        }\n\n        if (code in codeIsDownObj && codeIsDownObj[code] !== null) {\n            const keyStr = codeIsDownObj[code];\n            isDownObj[keyStr] = false;\n            codeIsDownObj[code] = null;\n\n            //remove from combo\n            for (let i = 0; i < comboArr.length; i++) {\n                if (comboArr[i] == keyStr) {\n                    comboArr.splice(i, 1);\n                    i--;\n                }\n            }\n\n            emitUp(keyStr, e, oldComboStr);\n        }\n    }\n\n    function blur(event) {\n        const oldComboStr = comboArr.join('+');\n        comboArr = [];\n        codeIsDownObj = {};\n\n        const eventArr = [];\n        for (let i = 0; i < keyToKeyStrArr.length; i++) {\n            if (isDownObj[keyToKeyStrArr[i]]) {\n                isDownObj[keyToKeyStrArr[i]] = false;\n                eventArr.push(keyToKeyStrArr[i]);\n            }\n        }\n        for (let i = 0; i < eventArr.length; i++) {\n            emitUp(\n                eventArr[i],\n                {\n                    preventDefault: function () {},\n                    stopPropagation: function () {},\n                },\n                oldComboStr,\n            );\n        }\n        emitBlur();\n    }\n\n\n\n    return {\n        add: (keyListener) => {\n            if (listenerArr.includes(keyListener)) {\n                return;\n            }\n            const first = listenerArr.length === 0;\n            listenerArr.push(keyListener);\n\n            if (first) {\n                addEventListener(document, 'keydown', keyDown);\n                addEventListener(document, 'keyup', keyUp);\n                addEventListener(window, 'blur', blur);\n            }\n        },\n        remove: (keyListener) => {\n            if (!listenerArr.includes(keyListener)) {\n                return;\n            }\n            const last = listenerArr.length === 1;\n            for (let i = 0; i < listenerArr.length; i++) {\n                if (listenerArr[i] === keyListener) {\n                    listenerArr.splice(i, 1);\n                    break;\n                }\n            }\n            if (last) {\n                removeEventListener(document, 'keydown', keyDown);\n                removeEventListener(document, 'keyup', keyUp);\n                removeEventListener(window, 'blur', blur);\n            }\n        },\n        getIsDown: () => {\n            return isDownObj;\n        },\n        getCombo: () => {\n            return comboArr;\n        },\n    };\n})();\n\n\n\n/**\n * Listens to key events in window. Makes combos easier - e.g. ctrl + z\n *\n * keyStr - see in implementation - my representation of a key. e.g. 'r' can be 'r' and 'R'\n * comboStr - string joins currently pressed keyStr with a +\n *              e.g. 'ctrl+z'\n *\n */\nexport class KeyListener {\n\n    private readonly onDown;\n    private readonly onUp;\n    private readonly onBlur;\n    private readonly ref;\n\n    constructor (\n        p: {\n            onDown?: (keyStr: string, e: KeyboardEvent, comboStr: string, isRepeat?: boolean) => void;\n            onUp?: (keyStr: string, e: KeyboardEvent, oldComboStr: string) => void;\n            onBlur?: () => void;\n        },\n    ) {\n        this.onDown = p.onDown;\n        this.onUp = p.onUp;\n        this.onBlur = p.onBlur;\n        this.ref = [this.onDown, this.onUp, this.onBlur];\n        globalKey.add(this.ref);\n    }\n\n    isPressed (keyStr: string): boolean {\n        if (!(keyStr in globalKey.getIsDown())) {\n            throw 'key \"' + keyStr + '\" not found';\n        }\n        return globalKey.getIsDown()[keyStr];\n    }\n\n    getComboStr (): string {\n        return globalKey.getCombo().join('+');\n    }\n\n    comboOnlyContains (keyStrArr: string[]): boolean {\n        for (let i = 0; i < globalKey.getCombo().length; i++) {\n            if (!keyStrArr.includes(globalKey.getCombo()[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    destroy (): void {\n        globalKey.remove(this.ref);\n    }\n}\n\nexport function sameKeys(comboAStr: string, comboBStr: string): boolean {\n    return comboAStr.split('+').sort().join('+')=== comboBStr.split('+').sort().join('+');\n}","import {IBounds, IVector2D} from '../BB.types';\n\nexport function mix (a: number, b: number, f: number): number {\n    return a * (1 - f) + b * f;\n}\n\nexport function dist (ax: number, ay: number, bx: number, by: number): number {\n    return Math.sqrt(Math.pow(ax - bx, 2) + Math.pow(ay - by, 2));\n}\n\nexport function distSquared (ax: number, ay: number, bx: number, by: number): number {\n    // faster because no square-root\n    return Math.pow(ax - bx, 2) + Math.pow(ay - by, 2);\n}\n\nexport function lenSquared (x: number, y: number): number {\n    // faster because no square-root\n    return x * x + y * y;\n}\n\nexport function pointsToAngleRad (p1: IVector2D, p2: IVector2D): number {\n    return Math.atan2(p2.y - p1.y, p2.x - p1.x);\n}\n\nexport function pointsToAngleDeg (p1: IVector2D, p2: IVector2D): number {\n    return pointsToAngleRad(p1, p2) * 180 / Math.PI;\n}\n\nexport function clamp (num: number, min: number, max: number): number {\n    return num <= min\n        ? min\n        : num >= max\n            ? max\n            : num;\n}\n\nexport function rotate (x: number, y: number, deg: number): IVector2D {\n    const theta = deg * (Math.PI / 180);\n    const cs = Math.cos(theta);\n    const sn = Math.sin(theta);\n\n    return {\n        x: x * cs - y * sn,\n        y: x * sn + y * cs\n    };\n}\n\nexport function rotateAround (center: IVector2D, point: IVector2D, deg: number): IVector2D {\n    const rot = rotate(point.x - center.x, point.y - center.y, deg);\n    rot.x += center.x;\n    rot.y += center.y;\n    return rot;\n}\n\nexport function intDxy(remainder: IVector2D, fDx: number, fDy: number) {\n    remainder.x += fDx;\n    remainder.y += fDy;\n    const dX = Math.round(remainder.x);\n    const dY = Math.round(remainder.y);\n    remainder.x -= dX;\n    remainder.y -= dY;\n    return {\n        dX,\n        dY,\n    };\n}\n\n/**\n * return closest even number\n * @param f\n */\nexport function roundEven(f: number) {\n    if (f % 1 === 0) {\n        if (f % 2 === 0) {\n            return f;\n        }\n        return f + 1;\n    }\n    const above = Math.ceil(f);\n    const below = Math.floor(f);\n    if (above % 2 === 0) {\n        return above;\n    } else {\n        return below;\n    }\n}\n\n/**\n * return closest uneven number\n * @param f\n */\nexport function roundUneven(f: number) {\n    if (f % 1 === 0) {\n        if (f % 2 === 0) {\n            return f + 1;\n        }\n        return f;\n    }\n    const above = Math.ceil(f);\n    const below = Math.floor(f);\n    if (above % 2 === 1) {\n        return above;\n    } else {\n        return below;\n    }\n}\n\n/**\n * update target so it includes bounds\n * @param target\n * @param bounds\n */\nexport function updateBounds (target: IBounds, bounds: IBounds): IBounds {\n    if (!bounds) {\n        return target;\n    }\n    if (!target) {\n        target = { x1: bounds.x1, y1: bounds.y1, x2: bounds.x2, y2: bounds.y2 };\n    } else {\n        target.x1 = Math.min(target.x1, bounds.x1);\n        target.y1 = Math.min(target.y1, bounds.y1);\n        target.x2 = Math.max(target.x2, bounds.x2);\n        target.y2 = Math.max(target.y2, bounds.y2);\n    }\n    return target;\n}\n\n/**\n * determine overlap of bounds with width&height\n */\nexport function boundsInArea (bounds: IBounds, width: number, height: number): IBounds | null {\n    let x1 = Math.max(0, bounds.x1);\n    let y1 = Math.max(0, bounds.y1);\n    let x2 = Math.min(width - 1, bounds.x2);\n    let y2 = Math.min(height - 1, bounds.y2);\n    if (x1 > x2 || y1 > y2) {\n        return null;\n    }\n    return { x1, y1, x2, y2 };\n}","import {addEventListener, removeEventListener} from './event-listener';\n\n\n/**\n * Filters wheel events. removes swipe scrolling and pinch scrolling that trackpads do. (as best as it can)\n * Normalizes regular scrolls.\n *\n * Why:\n * - trackpad scrolling is different from old school mouse scrolling\n * - but there is not way to learn from the browser if it's trackpad scrolling\n * - browsers don't even give access to the raw swiping or pinching movement, but some abstraction on top, making the scrolling\n *      continue an arbitrary amount, at an arbitrary scale\n * - each browser does this differently. So you can't offer a coherent experience\n *\n * - also trackpads are painful to draw with. So supporting a trackpad-based workflow makes not much sense.\n *\n * @param callback - func({deltaY: number, pageX: number, pageY: number, clientX: number, clientY: number}\n * @constructor\n */\nimport {eventUsesHighResTimeStamp, hasPointerEvents, isFirefox} from '../base/browser';\nimport {mix} from '../math/math';\n\nconst WheelCleaner = function (callback) {\n    const sequenceTimeoutMs = 200;\n\n    const knownUnitArr = [100];\n    let sequenceLength = 0;\n    let sequenceUnit = null;\n    let endSequenceTimeout;\n    let toEmitDelta = null;\n    let position = null;\n\n\n    function emit(delta) {\n        callback({\n            deltaY: Math.round(delta / sequenceUnit),\n            pageX: position.pageX,\n            pageY: position.pageY,\n            clientX: position.clientX,\n            clientY: position.clientY,\n        });\n    }\n\n    function endSequence() {\n        if (toEmitDelta !== null) {\n            emit(toEmitDelta);\n            toEmitDelta = null;\n        }\n        if (sequenceUnit !== null && !(knownUnitArr.includes(sequenceUnit))) {\n            knownUnitArr.push(sequenceUnit);\n        }\n        sequenceLength = 0;\n        sequenceUnit = null;\n    }\n\n    // --- interface ---\n    this.process = function (event) {\n\n        position = {\n            pageX: event.pageX,\n            pageY: event.pageY,\n            clientX: event.clientX,\n            clientY: event.clientY,\n        };\n\n        clearTimeout(endSequenceTimeout);\n        endSequenceTimeout = setTimeout(endSequence, sequenceTimeoutMs);\n\n        //prep delta\n        let delta = event.deltaY;\n        if ('deltaMode' in event && event.deltaMode === 1) {\n            delta *= 100 / 3;\n        }\n        const absDelta = Math.abs(delta);\n\n\n        if (sequenceLength > 0 && sequenceUnit === null) {\n            //previously determined dirty sequence\n            toEmitDelta = null;\n            return;\n        }\n\n        //sequence begins\n        if (sequenceLength === 0) {\n            sequenceLength++;\n            if (absDelta < 50) {\n                //dirty - probably a swipe scroll or pinch scroll on trackpad\n                return;\n            }\n\n            sequenceUnit = absDelta;\n            if (knownUnitArr.includes(sequenceUnit)) {\n                //we know this unit - emit right away\n                emit(delta);\n            } else {\n                //unknown unit - wait until next event or sequence end, to have more certainty that it's clean\n                toEmitDelta = delta;\n            }\n            return;\n        }\n\n        //sequence continues\n        if (absDelta === 0) {\n            //ignore zero scroll\n            return;\n        }\n        if (\n            absDelta === sequenceUnit ||\n            (absDelta / sequenceUnit) % 1 < 0.0001// a multiple\n        ) {\n            //fine\n        } else if ((sequenceUnit / absDelta) % 1 < 0.0001) {\n            //unit was actually a multiple - update it\n            sequenceUnit = absDelta;\n\n        } else if (absDelta !== sequenceUnit) {\n            //not clean - delta is varying - probably a swipe scroll or pinch scroll on trackpad\n            sequenceUnit = null;\n            toEmitDelta = null;\n            return;\n        }\n\n\n        if (toEmitDelta !== null) {\n            emit(toEmitDelta);\n            toEmitDelta = null;\n        }\n        emit(delta);\n    };\n};\n\n\n/**\n * PointerListener - for pointer events, wheel events. uses fallbacks. ideally consistent behavior across browsers\n * Has some workarounds for browser specific bugs. As browsers get better, this constructor should get smaller\n *\n * p = {\n *     target: DOM element,\n *     onPointer: func (pointerEvent), //optional\n *     onWheel: func (wheelEvent), //optional\n *     onEnterLeave: func (isOver: boolean), //optional\n *     maxPointers: int (1 - n), //default is 1\n *     fixScribble: boolean, // fix ipad scribble issue\n * }\n *\n * pointerEvent = {\n *     type: 'pointerdown'|'pointermove'|'pointerup',\n *     pointerId: long,\n *     pointerType: 'touch'|'mouse'|'pen',\n *     pageX: number,\n *     pageY: number,\n *     clientX: number,\n *     clientY: number,\n *     relX: number, //position relative to top left of target\n *     relY: number,\n *     dX: number, //movementX not supported by safari on iOS, so need my own\n *     dY: number,\n *     downPageX: number, //where was pointer when down-event occurred - set for down|move|up\n *     downPageY: number,\n *     coalescedArr: Array of {\n *         pageX: number,\n *         pageY: number,\n *         clientX: number,\n *         clientY: number,\n *         relX: number, //position relative to top left of target\n *         relY: number,\n *         dX: number,\n *         dY: number,\n *         time: number// same timescale as performance.now() - might be exact same number as in parent\n *     },\n *     time: number, // same timescale as performance.now()\n *     button: 'left'|'middle'|'right',\n *     pressure: number (0-1), // always 1 for touch and mouse\n *     eventPreventDefault: function(),\n *     eventStopPropagation: function(),\n * }\n *\n * wheelEvent = {\n *     deltaY: number, // increments of 1\n *     pageX: number,\n *     pageY: number,\n *     relX: number,\n *     relY: number,\n * }\n *\n * isOver(): boolean - if pointer over the target\n *\n * @param p\n */\nexport const PointerListener = (function () {\n\n    //keeping track of pointers for movement fallback\n    const pointerArr = [];\n\n    function addPointer(event) {\n        const pointerObj = {\n            pointerId: event.pointerId,\n            lastPageX: null,\n            lastPageY: null\n        };\n        pointerArr.push(pointerObj);\n\n        if (pointerArr.length > 15) {\n            pointerArr.shift();\n        }\n\n        return pointerObj;\n    }\n\n    function getPointer(event) {\n        for (let i = pointerArr.length - 1; i >= 0; i--) {\n            if (event.pointerId === pointerArr[i].pointerId) {\n                return pointerArr[i];\n            }\n        }\n        return null;\n    }\n\n\n    let pressureNormalizeAvgCount = 0;\n    let pressureNormalizeAvgPressure = null;\n    let pressureNormalizeIsComplete = false;\n    let pressureNormalizeFactor = 1;\n\n    return function (p) {\n        const targetElement = p.target;\n        const onPointerCallback = p.onPointer;\n        const onWheelCallback = p.onWheel;\n        const onEnterLeaveCallback = p.onEnterLeave;\n        const maxPointers = 'maxPointers' in p ? p.maxPointers : 1;\n        const buttonsToStr = { // translation\n            '1': 'left',\n            '2': 'right',\n            '4': 'middle'\n        };\n        const wheelCleaner = new WheelCleaner(function (wheelEvent) {\n            if (isDestroyed) {\n                return;\n            }\n            if (onWheelCallback) {\n                const bounds = targetElement.getBoundingClientRect();\n                wheelEvent.relX = wheelEvent.clientX - bounds.left + targetElement.scrollLeft;\n                wheelEvent.relY = wheelEvent.clientY - bounds.top + targetElement.scrollTop;\n                onWheelCallback(wheelEvent);\n            }\n        });\n        let isDestroyed = false;\n\n        const timeStampOffset = eventUsesHighResTimeStamp() ? 0 : -performance.timing.navigationStart;\n\n\n        //to circumvent a chrome input glitch\n        let lastPointerType = '';\n        let didSkip = false;\n\n\n        /*\n        pointers that are pressing a button\n        dragObj = {\n            pointerId: long,\n            pointerType: 'mouse'|'pen'|'touch',\n            downPageX: number, //where was pointer when down-event occurred\n            downPageY: number,\n            button: long,\n            lastPageX: number, //pageX in previous event - only for touch events, because they don't have movementX/Y\n            lastPageY: number,\n            lastTimeStamp: number\n        }\n         */\n        const dragObjArr = [];\n        const dragPointerIdArr = [];\n\n        function getDragObj(pointerId) {\n            for (let i = 0; i < dragObjArr.length; i++) {\n                if (pointerId === dragObjArr[i].pointerId) {\n                    return dragObjArr[i];\n                }\n            }\n            return null;\n        }\n\n        function removeDragObj(pointerId) {\n            let removedDragObj = null;\n            for (let i = 0; i < dragPointerIdArr.length; i++) {\n                if (dragPointerIdArr[i] === pointerId) {\n                    removedDragObj = dragObjArr[i];\n                    dragObjArr.splice(i, 1);\n                    dragPointerIdArr.splice(i, 1);\n                    i--;\n                }\n            }\n            return removedDragObj;\n        }\n\n\n        function normalizePressure(pressure, type?) {\n            if (pressure === 0 || pressure === 1) {\n                return pressure;\n            }\n\n            // was this there to prevent some glitch?\n            /*if (pressureNormalizeIsComplete && type === 'pointerdown' && pressure !== 1) {\n                pressure *= 0.004;\n            }*/\n\n            if (pressureNormalizeAvgCount < 60) {\n                if (pressureNormalizeAvgCount === 0) {\n                    pressureNormalizeAvgPressure = pressure;\n                } else {\n                    pressureNormalizeAvgPressure = mix(pressure, pressureNormalizeAvgPressure, 0.95);\n                }\n                pressureNormalizeAvgCount++;\n            } else if (!pressureNormalizeIsComplete) {\n                pressureNormalizeIsComplete = true;\n                //BB.throwOut('avg pressure decision!' + pressureNormalizeAvgPressure);\n                if (pressureNormalizeAvgPressure < 0.13) { // absurd pressure needed\n                    pressureNormalizeFactor = 2.3;\n                }\n            }\n\n\n            return Math.pow(pressure, 1 / pressureNormalizeFactor);\n        }\n\n\n        /**\n         *\n         * More trustworthy pointer attributes. that behave the same across browsers.\n         * returns a new object. this object also gets attached to the orig event. -> event.corrected\n         *\n         * @param event\n         * @returns {{pointerId: number, timeStamp: number, button, buttons, pointerType: (string|string|any), movementY: number, movementX: number, pressure, coalescedArr: [], pageY, pageX, clientX, clientY, eventPreventDefault: func, eventStopPropagation: func}\n         */\n        function correctPointerEvent(event) {\n            if (event.corrected) {\n                return event.corrected;\n            }\n\n            /*if (event.type === 'pointermove' && !window.hidePressureOut) {\n                if (event.type === 'pointermove') {\n                    BB.throwOut(event.pressure + ' ' + event.pointerType);\n                }\n            }*/\n\n            const correctedObj = {\n                pointerId: event.pointerId,\n                pointerType: event.pointerType,\n                pageX: event.pageX,\n                pageY: event.pageY,\n                clientX: event.clientX,\n                clientY: event.clientY,\n                movementX: event.movementX,\n                movementY: event.movementY,\n                timeStamp: event.timeStamp + timeStampOffset,\n                pressure: normalizePressure(event.pressure, event.type),\n                buttons: event.buttons,\n                button: event.button,\n                coalescedArr: [],\n                eventPreventDefault: function () {\n                    event.preventDefault();\n                },\n                eventStopPropagation: function () {\n                    event.stopPropagation();\n                }\n            };\n            event.corrected = correctedObj;\n\n            let customPressure = null;\n            if ('pointerId' in event) {\n                if ('pressure' in event && event.buttons !== 0 && (['mouse'].includes(event.pointerType) || (event.pointerType === 'touch' && event.pressure === 0))) {\n                    correctedObj.pressure = 1;\n                    customPressure = 1;\n                }\n            } else {\n                correctedObj.pointerId = 0;\n                correctedObj.pointerType = 'mouse';\n                correctedObj.pressure = event.buttons !== 0 ? 1 : 0;\n                customPressure = correctedObj.pressure;\n            }\n\n            if (isFirefox && event.pointerType != 'mouse' && event.type === 'pointermove' && event.buttons === 0) { // once again firefox\n                correctedObj.buttons = 1; //todo wrong if no buttons actually pressed\n            }\n\n            let coalescedEventArr = [];\n            if ('getCoalescedEvents' in event) {\n                coalescedEventArr = event.getCoalescedEvents();\n            }\n\n            // chrome somehow movementX not same scale as pageX. todo: only chrome?\n            // so make my own\n\n            let pointerObj = getPointer(correctedObj);\n            if (pointerObj === null) {\n                pointerObj = addPointer(correctedObj);\n            }\n\n            const totalLastX = pointerObj.lastPageX;\n            const totalLastY = pointerObj.lastPageY;\n\n            for (let i = 0; i < coalescedEventArr.length; i++) {\n                const eventItem = coalescedEventArr[i];\n\n                correctedObj.coalescedArr.push({\n                    pageX: eventItem.pageX,\n                    pageY: eventItem.pageY,\n                    clientX: eventItem.clientX,\n                    clientY: eventItem.clientY,\n                    movementX: pointerObj.lastPageX === null ? 0 : eventItem.pageX - pointerObj.lastPageX,\n                    movementY: pointerObj.lastPageY === null ? 0 : eventItem.pageY - pointerObj.lastPageY,\n                    timeStamp: eventItem.timeStamp === 0 ? correctedObj.timeStamp : (eventItem.timeStamp + timeStampOffset), // 0 in firefox\n                    pressure: customPressure === null ? normalizePressure(eventItem.pressure) : customPressure\n                });\n\n                pointerObj.lastPageX = eventItem.pageX;\n                pointerObj.lastPageY = eventItem.pageY;\n            }\n\n            pointerObj.lastPageX = correctedObj.pageX;\n            pointerObj.lastPageY = correctedObj.pageY;\n            correctedObj.movementX = totalLastX === null ? 0 : pointerObj.lastPageX - totalLastX;\n            correctedObj.movementY = totalLastY === null ? 0 : pointerObj.lastPageY - totalLastY;\n\n            return correctedObj;\n\n        }\n\n        /**\n         * creates a value for onPointer, from a pointer event handler\n         *\n         * @param typeStr string - 'pointerdown'|'pointermove'|'pointerup'\n         * @param correctedEvent - corrected pointer event from correctPointerEvent()\n         * @param custom - object for setting custom attributes\n         * @returns {{pointerId: number, pointerType: *, dX: (*), relY: number, dY: (*), relX: number, type: *, event: *, pageY: *, pageX: *}}\n         */\n        function createPointerOutEvent(typeStr, correctedEvent, custom?) {\n\n            const bounds = targetElement.getBoundingClientRect();\n            const result: any = {\n                type: typeStr,\n                pointerId: correctedEvent.pointerId,\n                pointerType: correctedEvent.pointerType,\n                pageX: correctedEvent.pageX,\n                pageY: correctedEvent.pageY,\n                clientX: correctedEvent.clientX,\n                clientY: correctedEvent.clientY,\n                relX: correctedEvent.clientX - bounds.left + targetElement.scrollLeft,\n                relY: correctedEvent.clientY - bounds.top + targetElement.scrollTop,\n                dX: correctedEvent.movementX,\n                dY: correctedEvent.movementY,\n                time: correctedEvent.timeStamp,\n                eventPreventDefault: correctedEvent.eventPreventDefault,\n                eventStopPropagation: correctedEvent.eventStopPropagation\n            };\n\n            if (typeStr === 'pointermove') {\n                result.coalescedArr = [];\n                if (correctedEvent.coalescedArr.length > 1) {\n                    let coalescedItem;\n                    for (let i = 0; i < correctedEvent.coalescedArr.length; i++) {\n                        coalescedItem = correctedEvent.coalescedArr[i];\n                        result.coalescedArr.push({\n                            pageX: coalescedItem.pageX,\n                            pageY: coalescedItem.pageY,\n                            clientX: coalescedItem.clientX,\n                            clientY: coalescedItem.clientY,\n                            relX: coalescedItem.clientX - bounds.left + targetElement.scrollLeft,\n                            relY: coalescedItem.clientY - bounds.top + targetElement.scrollTop,\n                            dX: coalescedItem.movementX,\n                            dY: coalescedItem.movementY,\n                            time: coalescedItem.timeStamp\n                        });\n                    }\n                }\n            }\n\n            if (custom) {\n                const keyArr = Object.keys(custom);\n                for (let i = 0; i < keyArr.length; i++) {\n                    result[keyArr[i]] = custom[keyArr[i]];\n                }\n            }\n\n            return result;\n        }\n\n        /**\n         * creates a value for onPointer, from a fallback touch event handler\n         *\n         * @param typeStr string - 'pointerdown'|'pointermove'|'pointerup'\n         * @param touchListItem - element from changed touch list\n         * @param touchEvent - touch event\n         * @param custom - object for setting custom attributes\n         * @returns {{pointerId: number, pointerType: string, relY: number, relX: number, type: *, event: *, pageY: *, pageX: *}}\n         */\n        function createTouchOutEvent(typeStr, touchListItem, touchEvent, custom) {\n            const bounds = targetElement.getBoundingClientRect();\n            const result: any = {\n                type: typeStr,\n                pointerId: touchListItem.identifier,\n                pointerType: 'touch',\n                pageX: touchListItem.pageX,\n                pageY: touchListItem.pageY,\n                clientX: touchListItem.clientX,\n                clientY: touchListItem.clientY,\n                relX: touchListItem.pageX - bounds.left + targetElement.scrollLeft,\n                relY: touchListItem.pageY - bounds.top + targetElement.scrollTop,\n                time: touchEvent.timeStamp + timeStampOffset,\n                eventPreventDefault: function() { touchEvent.preventDefault(); },\n                eventStopPropagation: function() { touchEvent.stopPropagation(); }\n            };\n\n            if (typeStr === 'pointermove') {\n                result.coalescedArr = [];\n            }\n\n            const keyArr = Object.keys(custom);\n            for (let i = 0; i < keyArr.length; i++) {\n                result[keyArr[i]] = custom[keyArr[i]];\n            }\n\n            return result;\n        }\n\n        function setupDocumentListeners() {\n            addEventListener(document, 'pointermove', onGlobalPointerMove);\n            addEventListener(document, 'pointerup', onGlobalPointerUp);\n            addEventListener(document, 'pointerleave', onGlobalPointerLeave);\n        }\n\n        function destroyDocumentListeners() {\n            removeEventListener(document, 'pointermove', onGlobalPointerMove);\n            removeEventListener(document, 'pointerup', onGlobalPointerUp);\n            removeEventListener(document, 'pointerleave', onGlobalPointerLeave);\n        }\n\n        let isOverCounter = 0; // might be multiple pointers\n        function onPointerEnter() {\n            isOverCounter++;\n            if (onEnterLeaveCallback) {\n                onEnterLeaveCallback(true);\n            }\n        }\n\n        function onPointerLeave() {\n            isOverCounter--;\n            if (onEnterLeaveCallback) {\n                onEnterLeaveCallback(false);\n            }\n        }\n\n        function onPointermove(event) {\n            event = correctPointerEvent(event);\n\n            const tempLastPointerType = lastPointerType;\n            lastPointerType = event.pointerType;\n\n            if (dragPointerIdArr.includes(event.pointerId) || dragPointerIdArr.length === maxPointers || event.pointerType === 'touch') {\n                didSkip = false;\n                return;\n            }\n\n            // chrome input glitch workaround - throws in a random mouse event with the wrong position when using a stylus\n            if (!didSkip && event.pointerType === 'mouse' && tempLastPointerType === 'pen') {\n                didSkip = true;\n                return;\n            }\n            didSkip = false;\n\n            const outEvent = createPointerOutEvent('pointermove', event);\n            onPointerCallback(outEvent);\n\n        }\n\n        function onPointerdown(event) {\n            //BB.throwOut('pointerdown ' + event.pointerId + ' | ' + dragPointerIdArr.length);\n            event = correctPointerEvent(event);\n            ////console.log('debug: ' + event.pointerId + ' pointerdown');\n            if (dragPointerIdArr.includes(event.pointerId) || dragPointerIdArr.length === maxPointers || !([1, 2, 4].includes(event.buttons))) {\n                //BB.throwOut('pointerdown ignored');\n                return;\n            }\n\n\n            //set up global listeners\n            if (dragObjArr.length === 0) {\n                setupDocumentListeners();\n            }\n            const dragObj = {\n                pointerId: event.pointerId,\n                pointerType: event.pointerType,\n                downPageX: event.pageX,\n                downPageY: event.pageY,\n                buttons: event.buttons,\n                lastPageX: event.pageX,\n                lastPageY: event.pageY,\n                lastTimeStamp: event.timeStamp\n            };\n            dragObjArr.push(dragObj);\n            setTouchTimeout(dragObj);\n            dragPointerIdArr.push(event.pointerId);\n\n            const outEvent = createPointerOutEvent('pointerdown', event, {\n                downPageX: event.pageX,\n                downPageY: event.pageY,\n                button: buttonsToStr[event.buttons],\n                pressure: event.pressure\n            });\n\n            onPointerCallback(outEvent);\n        }\n\n\n        function onGlobalPointerMove(event) {\n            //BB.throwOut('pointermove ' + event.pointerId);\n            event = correctPointerEvent(event);\n            ////console.log('debug: ' + event.pointerId + ' GLOBALpointermove');\n            if (!(dragPointerIdArr.includes(event.pointerId))) {\n                return;\n            }\n\n            const dragObj = getDragObj(event.pointerId);\n            clearTouchTimeout(dragObj);\n\n            //if pointer changes button its pressing -> turn into pointerup\n            if (event.buttons !== dragObj.buttons) {\n                //pointer up\n\n                //remove listener\n                if (dragObjArr.length === 1) {\n                    destroyDocumentListeners();\n                }\n                removeDragObj(event.pointerId);\n\n                const outEvent = createPointerOutEvent('pointerup', event, {\n                    downPageX: dragObj.downPageX,\n                    downPageY: dragObj.downPageY\n                });\n                onPointerCallback(outEvent);\n                return;\n\n            }\n\n            setTouchTimeout(dragObj);\n\n            // ipad likes to do this\n            if (\n                event.pointerType === 'pen' &&\n                event.pageX === dragObj.lastPageX &&\n                event.pageY === dragObj.lastPageY &&\n                event.timeStamp === dragObj.lastTimeStamp\n            ) {\n                //ignore\n                return;\n            }\n\n            const outEvent = createPointerOutEvent('pointermove', event, {\n                downPageX: dragObj.downPageX,\n                downPageY: dragObj.downPageY,\n                button: buttonsToStr[event.buttons],\n                pressure: event.pressure\n            });\n\n            dragObj.lastPageX = event.pageX;\n            dragObj.lastPageY = event.pageY;\n            dragObj.lastTimeStamp = event.timeStamp;\n\n            onPointerCallback(outEvent);\n\n        }\n\n        function onGlobalPointerUp(event) {\n            //BB.throwOut('pointerup ' + event.pointerId);\n            event = correctPointerEvent(event);\n            ////console.log('debug: ' + event.pointerId + ' GLOBALpointerup');\n            if (!(dragPointerIdArr.includes(event.pointerId))) {\n                return;\n            }\n\n            //remove listener\n            if (dragObjArr.length === 1) {\n                destroyDocumentListeners();\n            }\n            const dragObj = removeDragObj(event.pointerId);\n            clearTouchTimeout(dragObj);\n\n            const outEvent = createPointerOutEvent('pointerup', event, {\n                downPageX: dragObj.downPageX,\n                downPageY: dragObj.downPageY\n            });\n            onPointerCallback(outEvent);\n\n        }\n\n        function onGlobalPointerLeave(event) {\n            //BB.throwOut('pointerleave ' + event.pointerId);\n            event = correctPointerEvent(event);\n            ////console.log('debug: ' + event.pointerId + ' onGlobalPointerLeave', event);\n            if (!(dragPointerIdArr.includes(event.pointerId))) { //} || event.target !== document) {\n                return;\n            }\n\n            //remove listener\n            if (dragObjArr.length === 1) {\n                destroyDocumentListeners();\n            }\n            const dragObj = removeDragObj(event.pointerId);\n            clearTouchTimeout(dragObj);\n\n            const outEvent = createPointerOutEvent('pointerup', event, {\n                downPageX: dragObj.downPageX,\n                downPageY: dragObj.downPageY\n            });\n            onPointerCallback(outEvent);\n        }\n\n\n        /*\n        --- ipad pointer event glitch damage control ---\n\n        ipad pointer events are glitchy. doesn't always fire pointerup.\n        - when two fingers get really close to each other\n        - when finger moves out and back in bottom\n\n        This artificially fires a pointerup\n        */\n        function onTouchTimeout(dragObj) {\n\n            //create fake event\n            const fakeEvent = {\n                pointerId: dragObj.pointerId,\n                pointerType: dragObj.pointerType,\n                type: 'pointerup',\n                timeStamp: performance.now(),\n                pageX: 0,\n                pageY: 0,\n                clientX: 0,\n                clientY: 0,\n                preventDefault: function () {\n                },\n                stopPropagation: function () {\n                }\n            };\n\n            //call onGlobalPointerUp with it\n            onGlobalPointerUp(fakeEvent);\n        }\n\n        function setTouchTimeout(dragObj) {\n            if (dragObj.pointerType !== 'touch') {\n                return;\n            }\n            dragObj.touchTimeout = setTimeout(function () {\n                onTouchTimeout(dragObj);\n            }, 2500); // 2.5 seconds\n        }\n\n        function clearTouchTimeout(dragObj) {\n            if (!dragObj.touchTimeout) {\n                return;\n            }\n            clearTimeout(dragObj.touchTimeout);\n            dragObj.touchTimeout = null;\n        }\n\n\n        if (onEnterLeaveCallback) {\n            addEventListener(targetElement, 'pointerenter', onPointerEnter);\n            addEventListener(targetElement, 'pointerleave', onPointerLeave);\n        }\n        if (onPointerCallback) {\n            addEventListener(targetElement, 'pointermove', onPointermove);\n            addEventListener(targetElement, 'pointerdown', onPointerdown);\n        }\n        if (onWheelCallback) {\n            addEventListener(targetElement, 'wheel', wheelCleaner.process);\n        }\n\n\n        let onTouchstart;\n        let onTouchmove;\n        let onTouchend;\n\n        // --- touch fallback ---\n        if (!(hasPointerEvents)) {\n\n            onTouchstart = function (event) {\n                ////console.log('onTouchstart', event, event.changedTouches.length);\n                event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\n\n                const touchArr = event.changedTouches;\n                for (let i = 0; i < touchArr.length && dragObjArr.length < maxPointers; i++) {\n                    const touchObj = touchArr[i];\n\n                    //set up global listeners\n                    if (dragObjArr.length === 0) {\n                        addEventListener(document, 'touchmove', onTouchmove);\n                        addEventListener(document, 'touchend', onTouchend);\n                        addEventListener(document, 'touchcancel', onTouchend);\n                    }\n                    dragObjArr.push({\n                        pointerId: touchObj.identifier,\n                        downPageX: touchObj.pageX,\n                        downPageY: touchObj.pageY,\n                        buttons: 1,\n                        lastPageX: touchObj.pageX,\n                        lastPageY: touchObj.pageY,\n                    });\n                    dragPointerIdArr.push(touchObj.identifier);\n\n                    const outEvent = createTouchOutEvent('pointerdown', touchObj, event, {\n                        dX: 0,\n                        dY: 0,\n                        downPageX: touchObj.downPageX,\n                        downPageY: touchObj.downPageY,\n                        button: 'left',\n                        pressure: 1\n                    });\n                    onPointerCallback(outEvent);\n                }\n\n            }\n\n            onTouchmove = function (event) {\n                event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\n\n\n                const touchArr = event.changedTouches;\n                for (let i = 0; i < touchArr.length; i++) {\n                    const touchObj = touchArr[i];\n\n                    if (!(dragPointerIdArr.includes(touchObj.identifier))) {\n                        continue;\n                    }\n                    const dragObj = getDragObj(touchObj.identifier);\n\n                    const outEvent = createTouchOutEvent('pointermove', touchObj, event, {\n                        dX: touchObj.pageX - dragObj.lastPageX,\n                        dY: touchObj.pageY - dragObj.lastPageY,\n                        downPageX: dragObj.downPageX,\n                        downPageY: dragObj.downPageY,\n                        button: 'left',\n                        isCoalesced: false,\n                        pressure: 1\n                    });\n                    dragObj.lastPageX = touchObj.pageX;\n                    dragObj.lastPageY = touchObj.pageY;\n                    onPointerCallback(outEvent);\n\n                }\n\n            }\n\n            onTouchend = function (event) {\n                if (event.type !== 'touchcancel') {\n                    event.preventDefault(); // needs to stay, otherwise page scrolls on iOS12\n                }\n\n\n                const touchArr = event.changedTouches;\n                for (let i = 0; i < touchArr.length; i++) {\n                    const touchObj = touchArr[i];\n\n                    if (!(dragPointerIdArr.includes(touchObj.identifier))) {\n                        continue;\n                    }\n\n                    //remove listener\n                    if (dragObjArr.length === 1) {\n                        removeEventListener(document, 'touchmove', onTouchmove);\n                        removeEventListener(document, 'touchend', onTouchend);\n                        removeEventListener(document, 'touchcancel', onTouchend);\n                    }\n                    const dragObj = removeDragObj(touchObj.identifier);\n\n                    const outEvent = createTouchOutEvent('pointerup', touchObj, event, {\n                        dX: touchObj.pageX - dragObj.lastPageX,\n                        dY: touchObj.pageY - dragObj.lastPageY,\n                        downPageX: dragObj.downPageX,\n                        downPageY: dragObj.downPageY,\n                    });\n\n                    onPointerCallback(outEvent);\n                }\n\n            }\n\n            if (onPointerCallback) {\n                addEventListener(targetElement, 'touchstart', onTouchstart);\n            }\n\n        } else if (p.fixScribble) {\n            //ipad scribble workaround https://developer.apple.com/forums/thread/662874\n            onTouchmove = function(e) {\n                e.preventDefault();\n            }\n            addEventListener(targetElement, 'touchmove', onTouchmove);\n\n        }\n\n\n        // --- interface ---\n\n        this.isOver = function () {\n            return isOverCounter > 0;\n        };\n\n        this.destroy = function () {\n            if (isDestroyed) {\n                return;\n            }\n            isDestroyed = true;\n            removeEventListener(targetElement, 'pointerenter', onPointerEnter);\n            removeEventListener(targetElement, 'pointerleave', onPointerLeave);\n            removeEventListener(targetElement, 'pointermove', onPointermove);\n            removeEventListener(targetElement, 'pointerdown', onPointerdown);\n            removeEventListener(targetElement, 'wheel', wheelCleaner.process);\n            if (dragObjArr.length > 0) {\n                destroyDocumentListeners();\n            }\n\n            if (!(hasPointerEvents)) {\n                removeEventListener(targetElement, 'touchstart', onTouchstart);\n                if (dragObjArr.length > 0) {\n                    removeEventListener(document, 'touchmove', onTouchmove);\n                    removeEventListener(document, 'touchend', onTouchend);\n                    removeEventListener(document, 'touchcancel', onTouchend);\n                }\n            } else {\n                removeEventListener(targetElement, 'touchmove', onTouchmove);\n            }\n        };\n\n    }\n})();","import {clamp, dist, mix, pointsToAngleRad} from '../math/math';\n\n\ntype ChainOutFunc = (event?) => void;\n\n/**\n * for chaining event processing. useful for gestures (double tap, pinch zoom, max pointer filter).\n * each element in the chain might hold back the events, swallow them, or transform them\n *\n * p = {\n *     chainArr: ChainElement[]\n * }\n *\n * chainIn(event): null - feed an event into the chain\n * setChainOut(func): void - func(event) <- called when passed through chain\n * ^ each ChainElement needs these methods too\n *\n * @param p\n * @constructor\n */\nexport const EventChain = function (p) {\n\n    const chainArr = p.chainArr;\n    let chainOut: ChainOutFunc = () => undefined;\n\n    function continueChain(i, event) {\n        for (; i < chainArr.length; i++) {\n            event = chainArr[i].chainIn(event);\n            if (event === null) {\n                return null;\n            }\n        }\n        chainOut(event);\n        return null;\n    }\n\n    for (let i = 0; i < chainArr.length; i++) {\n        (function (i) {\n            chainArr[i].setChainOut(function (event) {\n                continueChain(i + 1, event);\n            });\n        })(i);\n    }\n\n    // --- interface ---\n\n    this.chainIn = function (event) {\n        return continueChain(0, event);\n    };\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n};\n\n\n/**\n * A ChainElement. Detects double taps.\n *\n * p = {\n *     onDoubleTap: function({pageX: number, pageY: number}) - fires when double tap occurs\n * }\n *\n * chainIn\n * setChainOut\n * setAllowedPointerTypeArr(string[]): void - which pointer types are allowed\n * setAllowedButtonArr(string[]): void - which buttons are allowed\n *\n * @param p\n * @constructor\n */\nexport const DoubleTapper = function (p) {\n\n    let chainOut: ChainOutFunc = function () {\n    };\n    const minSilenceBeforeDurationMs = 400;\n    const maxPressedDurationMs = 300;\n    const maxPressedDistancePx = 10;\n    const maxInbetweenDistancePx = 19;\n    const maxUpToUpDurationMs = 500;\n    const maxUntilSecondDownDurationMs = 300;\n    const minSilenceAfterMs = 250;\n\n    let allowedPointerTypeArr = ['touch', 'mouse', 'pen'];\n    let allowedButtonArr = ['left'];\n\n    let sequenceArr = [];\n    const pointersDownIdArr = [];\n    let lastUpTime = 0;\n    let nowTime = 0;\n\n    let eventQueueArr = [];\n\n\n    function fail() {\n        if (sequenceArr.length === 0) { // no gesture started -> can be ignored\n            return;\n        }\n        clearTimeout(timeoutObj.fail);\n        clearTimeout(timeoutObj.maxUntilSecondDown);\n        clearTimeout(timeoutObj.success);\n        timeoutObj.fail = null;\n        timeoutObj.maxUntilSecondDown = null;\n        timeoutObj.success = null;\n\n\n        for (let i = 0; i < eventQueueArr.length; i++) {\n            chainOut(eventQueueArr[i]);\n        }\n        eventQueueArr = [];\n\n        sequenceArr = [];\n    }\n\n    // double tap achieved\n    function success() {\n        timeoutObj.fail = null;\n        timeoutObj.success = null;\n        eventQueueArr = []; // events get swallowed\n        const lastSequenceItem = sequenceArr[sequenceArr.length - 1];\n        sequenceArr = [];\n        p.onDoubleTap({pageX: lastSequenceItem.pageX, pageY: lastSequenceItem.pageY});\n    }\n\n\n    const timeoutObj = {\n        fail: null,\n        maxUntilSecondDown: null,\n        success: null\n    };\n\n    //returns false if time already up. otherwise sets up timeout\n    function setupTimeout(timeoutStr, targetFunc, timeMS) {\n        const diff = timeMS - nowTime;\n        //console.log(fingers + ': ' + timeoutStr + ' diff', diff);\n        if (diff <= 0) { // time already up\n            return false;\n        }\n        timeoutObj[timeoutStr] = setTimeout(targetFunc, diff);\n        return true;\n    }\n\n\n    /**\n     * @param event object - a pointer event from BB.PointerListener\n     */\n    function processEvent(event) {\n\n        if (event.type === 'pointerdown') {\n            pointersDownIdArr.push(event.pointerId);\n        } else if (event.type === 'pointerup') {\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\n                if (pointersDownIdArr[i] === event.pointerId) {\n                    pointersDownIdArr.splice(i, 1);\n                    break;\n                }\n            }\n        }\n\n        if (!allowedPointerTypeArr.includes(event.pointerType)) { //wrong input type -> fail\n            //console.log('wrong input type -> fail');\n            fail();\n            return;\n        }\n\n        nowTime = performance.now();\n        const lastSequenceItem = sequenceArr.length > 0 ? sequenceArr[sequenceArr.length - 1] : null;\n        if (event.type === 'pointerup') {\n            lastUpTime = event.time;\n        }\n\n        if (event.type === 'pointerdown') {\n            if (pointersDownIdArr.length > 1) { // more than one pointer down -> fail\n                //console.log('more than one pointer down -> fail');\n                fail();\n                return;\n            }\n            if (timeoutObj.success !== null) { // silence-after not achieved -> fail\n                //console.log('silence-after not achieved -> fail');\n                fail();\n                return;\n            }\n            if (sequenceArr.length === 0 && nowTime - lastUpTime < minSilenceBeforeDurationMs) { // silence before not achieved -> fail\n                //console.log('silence before not achieved -> fail');\n                fail();\n                return;\n            }\n            if (!allowedButtonArr.includes(event.button)) { // wrong button -> fail\n                //console.log('wrong button -> fail', event.button, allowedButtonArr);\n                fail();\n                return;\n            }\n            if (lastSequenceItem && lastSequenceItem.isDown || sequenceArr.length > 2) { // jumbled -> fail\n                //console.log('jumbled -> fail');\n                fail();\n                return;\n            }\n            if (lastSequenceItem) {\n                const distance = dist(lastSequenceItem.position[0], lastSequenceItem.position[1], event.pageX, event.pageY);\n                if (distance > maxInbetweenDistancePx) { //moved too much -> reset\n                    //console.log('maxInbetweenDistancePx -> reset');\n                    fail();\n\n                    if (nowTime - lastSequenceItem.time < minSilenceBeforeDurationMs) { //silence before not achieved -> fail\n                        return;\n                    }\n                }\n            }\n            sequenceArr.push({\n                isDown: true,\n                time: nowTime,\n                position: [event.pageX, event.pageY],\n                pointerId: event.pointerId\n            });\n            //maxUntilSecondDown\n\n            if (sequenceArr.length > 1) {\n                clearTimeout(timeoutObj.maxUntilSecondDown);\n            } else if (!setupTimeout('maxUntilSecondDown', fail, event.time + maxUntilSecondDownDurationMs)) {\n                //console.log('event.time + maxPressedDurationMs -> fail');\n                fail();\n                return;\n            }\n\n\n            clearTimeout(timeoutObj.fail);\n            if (!setupTimeout('fail', fail, event.time + maxPressedDurationMs)) {\n                //console.log('event.time + maxPressedDurationMs -> fail');\n                fail();\n                return;\n            }\n        }\n        if (lastSequenceItem && event.type === 'pointermove' && lastSequenceItem.pointerId === event.pointerId) {\n            /*if (lastSequenceItem.pointerId !== event.pointerId) { //another pointer mixing in -> fail\n                console.log('another pointer mixing in -> fail');\n                fail();\n                return;\n            }*/\n            const distance = dist(lastSequenceItem.position[0], lastSequenceItem.position[1], event.pageX, event.pageY);\n            if (distance > maxPressedDistancePx) { //moved too much -> fail\n                //console.log('maxPressedDistancePx -> fail');\n                fail();\n                return;\n            }\n        }\n        if (lastSequenceItem && event.type === 'pointerup') {\n            if (lastSequenceItem.pointerId !== event.pointerId) { //another pointer mixing in -> fail\n                fail();\n                return;\n            }\n            if (nowTime >= lastSequenceItem.time + maxPressedDurationMs) { //pressed too long -> fail\n                fail();\n                return;\n            }\n            clearTimeout(timeoutObj.fail);\n\n            if (sequenceArr.length < 3) {\n                if (!setupTimeout('fail', fail, event.time + maxUpToUpDurationMs)) {\n                    fail();\n                    return;\n                }\n\n                sequenceArr = [\n                    lastSequenceItem,\n                    {\n                        isUp: true,\n                        time: nowTime,\n                        position: [event.pageX, event.pageY]\n                    }\n                ];\n                return;\n            }\n\n            if (nowTime < sequenceArr[1].time + maxUpToUpDurationMs) {\n                // double tap almost success\n                // only needs silence\n                sequenceArr.push({\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                });\n                if (!setupTimeout('success', success, event.time + minSilenceAfterMs)) {\n                    fail();\n                }\n            } else { // time up -> fail\n                fail();\n            }\n\n        }\n    }\n\n\n    // --- interface ---\n\n    this.chainIn = function (event) {\n\n        processEvent(event);\n\n        if (sequenceArr.length === 0) { //existing events can not become a double tap\n            fail();\n            return event;\n        }\n        // events might become a double tap -> queue\n        eventQueueArr.push(event);\n        return null;\n    };\n\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n\n    this.setAllowedPointerTypeArr = function (arr) {\n        allowedPointerTypeArr = arr;\n    };\n\n    this.setAllowedButtonArr = function (arr) {\n        allowedButtonArr = arr;\n    };\n};\n\n\n/**\n * A ChainElement. Detects a single tap, done with N 'touch' pointers\n *\n * p = {\n *      fingers: number - number of fingers\n *      onTap: function() - fires when tap occurs\n * }\n *\n * chainIn\n * setChainOut\n *\n * @param p\n * @constructor\n */\nexport const NFingerTapper = function (p) {\n\n    const fingers = p.fingers;\n    let chainOut: ChainOutFunc = function () {\n    };\n\n    const minSilenceBeforeDurationMs = 50; //250;\n    const maxTapMs = 500;\n    const maxFirstLastFingerDownMs = 250;\n    const maxPressedDistancePx = 12; //5 + fingers * 5;\n    const silenceAfterDurationMs = 250;\n\n\n    /*\n        fingerObj = {\n            pointerId: number,\n            downTime: number,\n            downPageX: number,\n            downPageY: number,\n            isUp: boolean\n        }\n     */\n    let fingerArr = [];\n    let firstDownTime;\n    let eventQueueArr = [];\n    let lastEventTime = 0;\n    const pointersDownIdArr = [];\n\n    function fail() {\n        if (eventQueueArr.length === 0) {\n            return;\n        }\n        clearTimeout(timeoutObj.firstLastDownTimeout);\n        clearTimeout(timeoutObj.tapTimeout);\n        for (let i = 0; i < eventQueueArr.length; i++) {\n            chainOut(eventQueueArr[i]);\n        }\n        eventQueueArr = [];\n        fingerArr = [];\n    }\n\n    function success() {\n        clearTimeout(timeoutObj.firstLastDownTimeout);\n        clearTimeout(timeoutObj.tapTimeout);\n        eventQueueArr = []; // events get swallowed\n        fingerArr = [];\n        p.onTap();\n    }\n\n    let nowTime;\n    const timeoutObj = {\n        firstLastDownTimeout: null,\n        tapTimeout: null\n    };\n\n    function setupTimeout(timeoutStr, timeMS) {\n        const diff = timeMS - nowTime;\n        //console.log(fingers + ': ' + timeoutStr + ' diff', diff);\n        if (diff <= 0) { // time already up\n            return false;\n        }\n        timeoutObj[timeoutStr] = setTimeout(fail, diff);\n        return true;\n    }\n\n    function processEvent(event) {\n\n        const tempLastEventTime = lastEventTime;\n        lastEventTime = event.time;\n\n        if (event.type === 'pointerdown') {\n            pointersDownIdArr.push(event.pointerId);\n        } else if (event.type === 'pointerup') {\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\n                if (pointersDownIdArr[i] === event.pointerId) {\n                    pointersDownIdArr.splice(i, 1);\n                    break;\n                }\n            }\n        }\n\n        if (event.pointerType !== 'touch') {\n            if (fingerArr.length > 0) { // already in gesture -> fail\n                fail();\n            }\n            return;\n        }\n\n        nowTime = performance.now();\n\n        if (event.type === 'pointerdown') {\n            //console.log('down');\n            if (fingerArr.length + 1 !== pointersDownIdArr.length) { // failed before, and some fingers are still down -> fail\n                fail();\n                return;\n            }\n            if (fingerArr.length === fingers) { // too many fingers down -> fail\n                //console.log(fingers + ': too many fingers down -> fail');\n                fail();\n                return;\n            }\n            if (fingerArr.length > 0 && event.time - maxFirstLastFingerDownMs > fingerArr[0].downTime) { // took too long to touch with all fingers -> fail\n                //console.log(fingers + ': took too long to touch with all fingers -> fail');\n                fail();\n                return;\n            }\n            if (fingerArr.length === 0 && event.time - minSilenceBeforeDurationMs < tempLastEventTime) { // not enough silence before -> fail\n                //console.log(fingers + ': not enough silence before -> fail');\n                fail();\n                return;\n            }\n\n            if (fingerArr.length === 0) {\n                firstDownTime = event.time;\n\n                if (!setupTimeout('firstLastDownTimeout', event.time + maxFirstLastFingerDownMs) || !setupTimeout('tapTimeout', event.time + maxTapMs)) { // timeouts already up -> fail\n                    fail();\n                    return;\n                }\n\n            }\n            fingerArr.push({\n                pointerId: event.pointerId,\n                downTime: event.time,\n                downPageX: event.pageX,\n                downPageY: event.pageY\n            });\n            return;\n\n        }\n\n        if (event.type === 'pointermove') {\n\n            if (fingerArr.length === 0) {\n                //not in a gesture -> ignore\n                return;\n            }\n\n            let fingerObj = null;\n            for (let i = 0; i < fingerArr.length; i++) {\n                if (fingerArr[i].pointerId === event.pointerId) {\n                    fingerObj = fingerArr[i];\n                    break;\n                }\n            }\n            if (fingerObj === null) { // finger not part of the tap is on screen -> fail\n                fail();\n                return;\n            }\n\n            if (event.time - maxTapMs > firstDownTime) { // tap took too long -> fail\n                //console.log(fingers + ': tap took too long -> fail');\n                fail();\n                return;\n            }\n\n            const distance = dist(event.pageX, event.pageY, fingerObj.downPageX, fingerObj.downPageY);\n            if (distance > maxPressedDistancePx) { // finger moved too much -> fail\n                //console.log(fingers + ': a finger moved too much -> fail', distance);\n                fail();\n                return;\n            }\n\n        }\n\n        if (event.type === 'pointerup') {\n\n            if (fingerArr.length === 0) {\n                //not in a gesture -> ignore\n                return;\n            }\n\n            //console.log('up', event.pageX, event.pageY);\n            if (fingerArr.length !== fingers) { // not enough fingers -> fail\n                //console.log(fingers + ': not enough fingers -> fail');\n                fail();\n                return;\n            }\n\n            let fingerObj = null;\n            let i = 0;\n            for (; i < fingerArr.length; i++) {\n                if (fingerArr[i].pointerId === event.pointerId) {\n                    fingerObj = fingerArr[i];\n                    break;\n                }\n            }\n            if (fingerObj === null) {\n                //do nothing\n                return;\n            }\n\n            if (event.time - maxTapMs > firstDownTime) { // tap took too long -> fail\n                //console.log(fingers + ': tap took too long -> fail');\n                fail();\n                return;\n            }\n\n            const distance = dist(event.pageX, event.pageY, fingerObj.downPageX, fingerObj.downPageY);\n            if (distance > maxPressedDistancePx) { // finger moved too much -> fail\n                //console.log(fingers + ': b finger moved too much -> fail', distance, event.pageX, event.pageY);\n                //console.log(fingerArr);\n                fail();\n                return;\n            }\n\n            fingerObj.isUp = true;\n\n            let allAreUp = true;\n            for (let i = 0; i < fingerArr.length; i++) {\n                if (!fingerArr[i].isUp) {\n                    allAreUp = false;\n                    break;\n                }\n            }\n            //console.log('fingerArr', fingerArr);\n\n            if (allAreUp) { // success\n                success();\n                return true;\n            }\n\n        }\n\n\n    }\n\n\n    // --- interface ---\n\n    this.chainIn = function (event) {\n\n        const result = processEvent(event);\n\n        //console.log(fingerArr.length);\n\n        if (result === true) {\n            //tap success -> event gets swallowed\n            return null;\n        }\n        if (fingerArr.length === 0) {\n            return event;\n        } else {\n            eventQueueArr.push(event);\n        }\n\n        return null;\n\n    };\n\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n};\n\n\n/**\n * A ChainElement. Detects a pinch zooming (2 touch pointers). If one finger lifts, then will use the remaining.\n * Further pointers are ignored, but their events get swallowed during the pinching.\n * pinching ends when ALL pointers are lifted.\n * Events passed through if no pinching.\n *\n * p = {\n *      onPinch: function({type: 'end'} | {\n *          type: 'move',\n *          relX: number,\n *          relY: number,\n *          downRelX: number,\n *          downRelY: number,\n *          angleDeg: number,\n *          scale: number\n *      }) - fires when pinching occurs\n * }\n *\n * chainIn\n * setChainOut\n *\n * @param p\n * @constructor\n */\nexport const PinchZoomer = function (p) {\n\n    const firstFingerMaxDistancePx = 10;\n    const untilSecondFingerDurationMs = 250;\n\n    let chainOut: ChainOutFunc = function () {\n    };\n    const pointersDownIdArr = [];\n    /*\n    gestureObj = {\n        touchPointerArr: Array of {\n            pointerId: number,\n            relX: number,\n            relY: number,\n            downRelX: number, // only for first\n            downRelY: number\n        },\n        otherPointerIdArr: number[],\n        isInProgress: boolean\n    }\n    */\n    let gestureObj = null;\n    let eventQueueArr = [];\n\n\n    function end() {\n        gestureObj = null;\n        eventQueueArr = [];\n    }\n\n    function fail(doSwallow?) {\n        if (!gestureObj) { // no gesture happening -> ignore\n            return;\n        }\n\n        clearTimeout(timeoutObj.secondFingerTimeout);\n        if (!doSwallow) {\n            for (let i = 0; i < eventQueueArr.length; i++) {\n                chainOut(eventQueueArr[i]);\n            }\n        }\n        end();\n    }\n\n\n    let nowTime;\n    const timeoutObj = {\n        secondFingerTimeout: null\n    };\n\n    function setupTimeout(timeoutStr, targetFunc, timeMS) {\n        const diff = timeMS - nowTime;\n        if (diff <= 0) { // time already up\n            return false;\n        }\n        timeoutObj[timeoutStr] = setTimeout(targetFunc, diff);\n        return true;\n    }\n\n\n    function processEvent(event) {\n\n        if (event.type === 'pointerdown') {\n            pointersDownIdArr.push(event.pointerId);\n\n        } else if (event.type === 'pointerup') {\n            for (let i = 0; i < pointersDownIdArr.length; i++) {\n                if (pointersDownIdArr[i] === event.pointerId) {\n                    pointersDownIdArr.splice(i, 1);\n                    break;\n                }\n            }\n        }\n\n        //pass through scenarios\n        if (\n            !gestureObj && (\n                event.pointerType !== 'touch' || // wrong pointer type\n                (event.type === 'pointermove' && pointersDownIdArr.length > 0) || // failed before\n                pointersDownIdArr.length > 1 || // failed before\n                event.type === 'pointerup' // failed before\n            )\n        ) {\n            return;\n        }\n\n        nowTime = performance.now();\n\n\n        //pointer down\n        if (event.type === 'pointerdown') {\n\n            if (gestureObj) {\n                if (event.pointerType === 'touch') { // touch finger down - as nth pointer\n\n                    gestureObj.touchPointerArr.push({\n                        pointerId: event.pointerId,\n                        relX: event.relX,\n                        relY: event.relY\n                    });\n\n                    if (gestureObj.isInProgress) {\n                        continuePinch(gestureObj, {\n                            type: 'down',\n                            index: gestureObj.touchPointerArr.length - 1\n                        });\n                    } else {\n                        clearTimeout(timeoutObj.secondFingerTimeout);\n                        gestureObj.isInProgress = true;\n                        beginPinch(gestureObj);\n                    }\n                    return;\n\n                } else { // non-touch finger down - as nth pointer\n\n                    if (gestureObj.isInProgress) {\n                        gestureObj.otherPointerIdArr.push(event.pointerId);\n                    } else { // second pointer wrong type -> fail\n                        fail();\n                    }\n                    return;\n                }\n\n\n            } else {\n                // first finger down - can only be touch if no gestureObj\n                gestureObj = {\n                    touchPointerArr: [{\n                        pointerId: event.pointerId,\n                        relX: event.relX,\n                        relY: event.relY,\n                        downRelX: event.relX,\n                        downRelY: event.relY\n                    }],\n                    otherPointerIdArr: [],\n                    isInProgress: false\n                };\n                if (!setupTimeout('secondFingerTimeout', function () {\n                    fail();\n                }, event.time + untilSecondFingerDurationMs)) { // time ran out -> fail\n                    fail();\n                    return;\n                }\n                return;\n            }\n\n        }\n\n\n        //pointer move\n        if (event.type === 'pointermove' && event.pointerType === 'touch') {\n            //gesture object should always exist here\n\n            let touchPointerObj = null;\n            let i = 0;\n            for (; i < gestureObj.touchPointerArr.length; i++) {\n                if (event.pointerId === gestureObj.touchPointerArr[i].pointerId) {\n                    touchPointerObj = gestureObj.touchPointerArr[i];\n                    break;\n                }\n            }\n\n            //null should not be possible\n\n            touchPointerObj.relX = event.relX;\n            touchPointerObj.relY = event.relY;\n\n            if (!gestureObj.isInProgress) { // only one finger down & pinching hasn't started\n                const distance = dist(touchPointerObj.downRelX, touchPointerObj.downRelY, touchPointerObj.relX, touchPointerObj.relY);\n                if (distance > firstFingerMaxDistancePx) { // moved too much -> fail\n                    fail();\n                    return;\n                }\n\n            } else {\n                if (i < 2) { // only first two touches can affect pinching\n                    continuePinch(gestureObj, {\n                        type: 'move',\n                        index: i\n                    });\n                }\n            }\n\n            return;\n        }\n\n\n        //pointer up\n        if (event.type === 'pointerup') {\n            //gesture object should always exist here\n\n            if (event.pointerType === 'touch') {\n                let i = 0;\n                for (; i < gestureObj.touchPointerArr.length; i++) {\n                    if (gestureObj.touchPointerArr[i].pointerId === event.pointerId) {\n                        gestureObj.touchPointerArr.splice(i, 1);\n                        break;\n                    }\n                }\n                if (gestureObj.touchPointerArr.length > 0) {\n                    continuePinch(gestureObj, {\n                        type: 'up',\n                        index: i\n                    });\n                }\n\n            } else { // non-touch\n                for (let i = 0; i < gestureObj.otherPointerIdArr.length; i++) {\n                    if (gestureObj.otherPointerIdArr[i] === event.pointerId) {\n                        gestureObj.otherPointerIdArr.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n\n            //all fingers lifted?\n            if (gestureObj.touchPointerArr.length === 0 && gestureObj.otherPointerIdArr.length === 0) {\n                if (gestureObj.isInProgress) { // lifted last finger -> end of pinching\n                    end();\n                    endPinch();\n                } else { // lifted finger again before pinching started -> fail\n                    fail();\n                }\n                return;\n            }\n\n        }\n\n\n    }\n\n\n    // --- actual pinch transform logic ---\n\n    let pincherArr = [];\n\n    function beginPinch(gestureObj) {\n\n        for (let i = 0; i < gestureObj.touchPointerArr.length; i++) {\n            const pointerObj = gestureObj.touchPointerArr[i];\n            pincherArr.push({\n                pointerId: pointerObj.pointerId,\n                relX: pointerObj.relX,\n                relY: pointerObj.relY,\n                downRelX: pointerObj.relX,\n                downRelY: pointerObj.relY\n            });\n        }\n\n        const event: any = {\n            type: 'move',\n            angleRad: 0,\n            scale: 1\n        };\n\n        if (pincherArr.length === 1) {\n            event.relX = pincherArr[0].downRelX;\n            event.relY = pincherArr[0].downRelY;\n        } else {\n            event.relX = 0.5 * (pincherArr[0].downRelX + pincherArr[1].downRelX);\n            event.relY = 0.5 * (pincherArr[0].downRelY + pincherArr[1].downRelY);\n        }\n        event.downRelX = event.relX;\n        event.downRelY = event.relY;\n\n        p.onPinch(event);\n\n    }\n\n    //actionObj = {type: 'down'|'move'|'up', index: number}\n    function continuePinch(gestureObj, actionObj) {\n\n        if (actionObj.index > 1) { // only first two pointers matter\n            return;\n        }\n\n        if (actionObj.type === 'move') {\n\n            let event;\n            pincherArr[actionObj.index].relX = gestureObj.touchPointerArr[actionObj.index].relX;\n            pincherArr[actionObj.index].relY = gestureObj.touchPointerArr[actionObj.index].relY;\n\n            if (pincherArr.length === 1) {\n\n                event = {\n                    type: 'move',\n                    downRelX: pincherArr[0].downRelX,\n                    downRelY: pincherArr[0].downRelY,\n                    relX: pincherArr[0].relX,\n                    relY: pincherArr[0].relY,\n                    angleRad: 0,\n                    scale: 1\n                };\n\n            } else {\n\n                const startDist = dist(pincherArr[0].downRelX, pincherArr[0].downRelY, pincherArr[1].downRelX, pincherArr[1].downRelY);\n                const distance = dist(pincherArr[0].relX, pincherArr[0].relY, pincherArr[1].relX, pincherArr[1].relY);\n\n                const startAngle = pointsToAngleRad({\n                    x: pincherArr[0].downRelX,\n                    y: pincherArr[0].downRelY\n                }, {x: pincherArr[1].downRelX, y: pincherArr[1].downRelY});\n                const angle = pointsToAngleRad({\n                    x: pincherArr[0].relX,\n                    y: pincherArr[0].relY\n                }, {x: pincherArr[1].relX, y: pincherArr[1].relY});\n\n                event = {\n                    type: 'move',\n                    downRelX: 0.5 * (pincherArr[0].downRelX + pincherArr[1].downRelX),\n                    downRelY: 0.5 * (pincherArr[0].downRelY + pincherArr[1].downRelY),\n                    relX: 0.5 * (pincherArr[0].relX + pincherArr[1].relX),\n                    relY: 0.5 * (pincherArr[0].relY + pincherArr[1].relY),\n                    angleRad: angle - startAngle,\n                    scale: distance / startDist\n                };\n\n            }\n\n            p.onPinch(event);\n\n        } else if (actionObj.type === 'down' || actionObj.type === 'up') {\n            endPinch();\n            beginPinch(gestureObj);\n        }\n\n    }\n\n    function endPinch() {\n        pincherArr = [];\n        p.onPinch({\n            type: 'end'\n        });\n    }\n\n\n    // --- interface ---\n\n    this.chainIn = function (event) {\n        processEvent(event);\n        if (gestureObj) {\n            if (!gestureObj.isInProgress) { // might still fail -> into queue\n                eventQueueArr.push(event);\n            }\n        } else {\n            return event;\n        }\n        return null;\n    };\n\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n};\n\n\n/**\n * A ChainElement. Splits up coalesced events into their own pointermove events. Otherwise regular pass through.\n *\n * @constructor\n */\nexport const CoalescedExploder = function () {\n\n    let chainOut: ChainOutFunc = function () {\n    };\n\n    // --- interface ---\n\n    this.chainIn = function (event) {\n\n        if (event.type === 'pointermove') {\n\n            if (event.coalescedArr.length > 0) {\n\n                let eventCopy = JSON.parse(JSON.stringify(event));\n                eventCopy.coalescedArr = [];\n                let coalescedItem;\n\n                for (let i = 0; i < event.coalescedArr.length; i++) {\n\n                    if (i > 0) {\n                        eventCopy = JSON.parse(JSON.stringify(event));\n                    }\n                    coalescedItem = event.coalescedArr[i];\n\n                    eventCopy.pageX = coalescedItem.pageX;\n                    eventCopy.pageY = coalescedItem.pageY;\n                    eventCopy.relX = coalescedItem.relX;\n                    eventCopy.relY = coalescedItem.relY;\n                    eventCopy.dX = coalescedItem.dX;\n                    eventCopy.dY = coalescedItem.dY;\n                    eventCopy.time = coalescedItem.time;\n                    if (i < event.coalescedArr.length - 1) {\n                        eventCopy.isCoalesced = true;\n                    }\n\n                    chainOut(eventCopy);\n                }\n\n            } else {\n                return event;\n            }\n        } else {\n            return event;\n        }\n\n        return null;\n    };\n\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n};\n\nexport const OnePointerLimiter = function (pointers?) {\n\n    let chainOut: ChainOutFunc = function () {\n    };\n\n    let downPointerId = null;\n    const ignorePointerIdArr = [];\n\n\n    // --- interface ---\n\n    this.chainIn = function (event) {\n\n        if (ignorePointerIdArr.includes(event.pointerId)) {\n            if (event.type === 'pointerup') {\n                for (let i = 0; i < ignorePointerIdArr.length; i++) {\n                    if (ignorePointerIdArr[i] === event.pointerId) {\n                        ignorePointerIdArr.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n            return null;\n        }\n\n        if (downPointerId === null) {\n            if (event.type === 'pointerdown') {\n                downPointerId = event.pointerId;\n            }\n            return event;\n\n        } else {\n            if (event.pointerId !== downPointerId) {\n                if (event.type === 'pointerdown') {\n                    ignorePointerIdArr.push(event.pointerId);\n                }\n                return null;\n            }\n            if (event.type === 'pointerup') {\n                downPointerId = null;\n            }\n            return event;\n        }\n\n        return null;\n\n    };\n\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n\n};\n\n\n/**\n * Not really and event chain element. but pretty similar.\n *\n * Processes draw input events. When shift held -> linetool\n * line events - what KlCanvasWorkspace passes onDraw(e)\n *\n * p = {\n *     onDraw: function(drawEvent)\n * }\n *\n * pass input in with process(drawEvent)\n *\n * modifies draw event to include such events:\n * {\n *     type: 'line',\n *     x0: null, // you have to fill that in\n *     y0: null, // you have to fill that in\n *     pressure0: null, // you have to fill that in\n *     x1: number,\n *     y1: number,\n *     pressure1: number\n * }\n *\n * @param p\n * @constructor\n */\nexport const LinetoolProcessor = function (p) {\n\n    let downEvent = null;\n    let eventQueue = [];\n    let direction = null;\n    const DIR_X = 0, DIR_Y = 1;\n\n    this.process = function (event) {\n        if (event.type === 'down') {\n            downEvent = event;\n            direction = null;\n\n            if (event.shiftIsPressed) {\n\n                p.onDraw({\n                    type: 'line',\n                    x0: null,\n                    y0: null,\n                    pressure0: null,\n                    x1: event.x,\n                    y1: event.y,\n                    pressure1: event.pressure\n                });\n\n                eventQueue.push(event);\n                return;\n            }\n\n        }\n\n        if (event.type === 'move') {\n\n            if (event.shiftIsPressed) {\n\n                if (direction === null) {\n                    const dX = Math.abs(event.x - downEvent.x);\n                    const dY = Math.abs(event.y - downEvent.y);\n\n                    if (dX > 5 || dY > 5) {\n                        direction = dX > dY ? DIR_X : DIR_Y;\n\n                        for (let i = 0; i < eventQueue.length; i++) {\n                            const e = eventQueue[i];\n                            if (direction === DIR_X) {\n                                e.y = downEvent.y;\n                            } else {\n                                e.x = downEvent.x;\n                            }\n                            p.onDraw(JSON.parse(JSON.stringify(e)));\n                        }\n                        eventQueue = [];\n                    }\n                }\n\n                if (direction === null) {\n                    eventQueue.push(event);\n                    return;\n                }\n\n                if (direction === DIR_X) {\n                    event.y = downEvent.y;\n                } else {\n                    event.x = downEvent.x;\n                }\n\n            } else {\n                if (eventQueue.length > 0) {\n                    for (let i = 0; i < eventQueue.length; i++) {\n                        p.onDraw(JSON.parse(JSON.stringify(eventQueue[i])));\n                    }\n                    eventQueue = [];\n                }\n            }\n\n        }\n\n        if (event.type === 'up') {\n            eventQueue = [];\n        }\n\n        p.onDraw(JSON.parse(JSON.stringify(event)));\n    };\n};\n\n\n/**\n * cleans up DrawEvents. More trustworthy events. EventChain element\n *\n * that events can only go line this: down -> n x move -> up\n * so, sanitizes this: down, down, down. becomes only one down. the other downs are ignored/swallowed\n * @constructor\n */\nexport const LineSanitizer = function () {\n\n    let chainOut: ChainOutFunc = function () {\n    };\n\n    let isDrawing = false;\n\n    // --- interface ---\n    this.chainIn = function (event) {\n\n        if (event.type === 'down') {\n            if (isDrawing) {\n                //console.log('line sanitizer - down, but already drawing');\n                chainOut({\n                    type: 'up',\n                    scale: event.scale,\n                    shiftIsPressed: event.shiftIsPressed,\n                    isCoalesced: false\n                });\n            } else {\n                isDrawing = true;\n            }\n        }\n        if (!isDrawing && (event.type === 'move' || event.type === 'up')) {\n            //console.log('line sanitizer - ' + event.type + ' but not drawing');\n            return null;\n        }\n\n        if (event.type === 'up' && isDrawing) {\n            isDrawing = false;\n        }\n\n        return event;\n    };\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n    this.getIsDrawing = function () {\n        return isDrawing;\n    };\n};\n\n\n/**\n * Line smoothing. EventChain element. Smoothing via blending new position with old position.\n * for onDraw events from KlCanvasWorkspace.\n *\n * p = {\n *     smoothing: number, // 0-1, 0: no smoothing, 1: 100% smoothing -> would never catch up\n * }\n *\n * smoothing > 0: will fire DrawEvents in interval when no new move events\n *\n * type: 'line' Events are just passed through.\n *\n * @param p\n * @constructor\n */\nexport const LineSmoothing = function (p) {\n\n    let chainOut: ChainOutFunc = function () {\n    };\n    let smoothing = clamp(p.smoothing, 0, 1);\n    let lastMixedInput;\n    let interval;\n    let timeout;\n\n    // --- interface ---\n\n    this.chainIn = function (event) {\n        event = JSON.parse(JSON.stringify(event));\n        clearTimeout(timeout);\n        clearInterval(interval);\n\n        if (event.type === 'down') {\n            lastMixedInput = {\n                x: event.x,\n                y: event.y,\n                pressure: event.pressure\n            };\n        }\n\n        if (event.type === 'move') {\n\n            const inputX = event.x;\n            const inputY = event.y;\n            const inputPressure = event.pressure;\n\n            event.x = mix(event.x, lastMixedInput.x, smoothing);\n            event.y = mix(event.y, lastMixedInput.y, smoothing);\n            event.pressure = mix(event.pressure, lastMixedInput.pressure, smoothing);\n            lastMixedInput = {\n                x: event.x,\n                y: event.y,\n                pressure: event.pressure\n            };\n\n            if (smoothing > 0) {\n                timeout = setTimeout(function () {\n                    interval = setInterval(function () {\n                        event = JSON.parse(JSON.stringify(event));\n\n                        event.x = mix(inputX, lastMixedInput.x, smoothing);\n                        event.y = mix(inputY, lastMixedInput.y, smoothing);\n                        event.pressure = mix(inputPressure, lastMixedInput.pressure, smoothing);\n                        lastMixedInput = {\n                            x: event.x,\n                            y: event.y,\n                            pressure: event.pressure\n                        };\n\n                        chainOut(event);\n                    }, 35);\n                }, 80);\n            }\n\n        }\n\n        return event;\n    };\n\n    this.setChainOut = function (func) {\n        chainOut = func;\n    };\n\n    this.setSmoothing = function (s) {\n        smoothing = clamp(s, 0, 1);\n    };\n};\n","import {IKeyString} from '../BB.types';\nimport {createCanvas} from './create-canvas';\n\nexport function copyCanvas(canvas: HTMLCanvasElement): HTMLCanvasElement {\n    const resultCanvas = createCanvas(canvas.width, canvas.height);\n    const ctx = resultCanvas.getContext('2d');\n    if (!ctx) {\n        throw new Error('2d context not supported or canvas already initialized');\n    }\n    ctx.drawImage(canvas, 0, 0);\n    return resultCanvas;\n}\n\n/**\n * Determine if should disable imageSmoothing for transformation.\n * ImageSmoothing can make images blurry even when they're in the original scale and aligned with the pixelgrid.\n */\nexport function testShouldPixelate(\n    transform: {x: number, y: number, width:number, height: number, angleDeg: number},\n    scaleX: number,\n    scaleY: number,\n): boolean {\n    if (\n        ![1, -1].includes(scaleX) || ![1, -1].includes(scaleY) ||\n        transform.width % 1 !== 0 || transform.height % 1 !== 0 ||\n        Math.abs(transform.angleDeg) % 90 !== 0\n    ) {\n        return false;\n    }\n    const whSwapped = Math.abs(transform.angleDeg - 90) % 180 === 0;\n    const width = whSwapped ? transform.height : transform.width;\n    const height = whSwapped ? transform.width : transform.height;\n    return (\n            (Math.abs(width) % 2 === 0 && transform.x % 1 === 0) ||\n            (Math.abs(width) % 2 === 1 && transform.x % 1 === 0.5)\n        ) &&\n        (\n            (Math.abs(height) % 2 === 0 && transform.y % 1 === 0) ||\n            (Math.abs(height) % 2 === 1 && transform.y % 1 === 0.5)\n        );\n}\n\n\n/**\n * @param destCtx - the canvas that will be drawn on\n * @param transformImage - image that will be drawn on canvas\n * @param transform - {x, y, width, height, angle} - x and y are center of transformImage\n * @param bounds object - optional {x, y, width, height} - crop of transformImage in transformImage image space\n * @param pixelated\n */\nexport function drawTransformedImageWithBounds(\n    destCtx: CanvasRenderingContext2D,\n    transformImage: HTMLImageElement | HTMLCanvasElement,\n    transform: {x: number, y: number, width:number, height: number, angleDeg: number},\n    bounds?: {x: number, y: number, width: number, height: number},\n    pixelated?: boolean,\n): void {\n    if (!bounds) {\n        bounds = {\n            x: 0,\n            y: 0,\n            width: transformImage.width,\n            height: transformImage.height\n        };\n    }\n\n    destCtx.save();\n    if (pixelated) {\n        destCtx.imageSmoothingEnabled = false;\n    } else {\n        destCtx.imageSmoothingEnabled = true;\n        destCtx.imageSmoothingQuality = 'high';\n    }\n\n    destCtx.translate(transform.x, transform.y);\n    destCtx.rotate(transform.angleDeg / 180 * Math.PI);\n    destCtx.scale(transform.width > 0 ? 1 : -1, transform.height > 0 ? 1 : -1);\n    destCtx.drawImage(\n        transformImage,\n        bounds.x, bounds.y, bounds.width, bounds.height,\n        -Math.abs(transform.width) / 2, -Math.abs(transform.height) / 2, Math.abs(transform.width), Math.abs(transform.height));\n\n    destCtx.restore();\n}\n\n/**\n * all transformations are optional\n * center is the point around which will be scaled and rotated\n *\n * @param baseCanvas canvas - the canvas that will be drawn on\n * @param transformImage image|canvas - image that will be drawn on canvas\n * @param transformObj {center: {x, y}, scale: {x, y}, translate: {x, y}, angleDegree}\n */\nexport function drawTransformedImageOnCanvas(\n    baseCanvas: HTMLCanvasElement,\n    transformImage: HTMLImageElement | HTMLCanvasElement,\n    transformObj: {\n        center: {x: number, y: number},\n        scale: {x: number, y: number},\n        translate: {x: number, y: number},\n        angleDegree: number,\n    },\n): void {\n    transformObj = JSON.parse(JSON.stringify(transformObj));\n    if (!transformObj.center) {\n        transformObj.center = {\n            x: transformImage.width / 2,\n            y: transformImage.height / 2\n        }\n    }\n    if (!transformObj.scale) {\n        transformObj.scale = {\n            x: 1,\n            y: 1\n        };\n    }\n    if (!transformObj.angleDegree) {\n        transformObj.angleDegree = 0;\n    }\n    if (!transformObj.translate) {\n        transformObj.translate = {\n            x: 0,\n            y: 0\n        };\n    }\n\n    const ctx = baseCanvas.getContext('2d');\n    if (!ctx) {\n        throw new Error('2d context not supported or canvas already initialized');\n    }\n    ctx.save();\n    if (\n        Math.abs(transformObj.scale.x - 1) >  0.000001 ||\n        Math.abs(transformObj.scale.y - 1) > 0.000001 ||\n        Math.abs(transformObj.angleDegree % 90) > 0.000001\n    ) {\n        ctx.imageSmoothingEnabled = true;\n        ctx.imageSmoothingQuality = 'high';\n    } else {\n        ctx.imageSmoothingEnabled = false;\n    }\n\n    ctx.translate(transformObj.translate.x, transformObj.translate.y);\n    ctx.translate(transformObj.center.x, transformObj.center.y);\n    ctx.rotate(transformObj.angleDegree / 180 * Math.PI);\n    ctx.scale(transformObj.scale.x, transformObj.scale.y);\n    ctx.translate(-transformObj.center.x, -transformObj.center.y);\n    ctx.drawImage(transformImage, 0, 0, transformImage.width, transformImage.height);\n\n    ctx.restore();\n}\n\nexport const createCheckerCanvas = function(size: number): HTMLCanvasElement {\n    const canvas = createCanvas();\n    let ctx;\n    if (size < 1) {\n        canvas.width = 1;\n        canvas.height = 1;\n        ctx = canvas.getContext('2d');\n        if (!ctx) {\n            throw new Error('2d context not supported or canvas already initialized');\n        }\n        ctx.fillStyle = 'rgb(128, 128, 128)';\n        ctx.fillRect(0, 0, 1, 1);\n    } else if (size > 200) {\n        canvas.width = 401;\n        canvas.height = 401;\n    } else {\n        canvas.width = size * 2;\n        canvas.height = size * 2;\n        ctx = canvas.getContext('2d');\n        if (!ctx) {\n            throw new Error('2d context not supported or canvas already initialized');\n        }\n        ctx.fillStyle = 'rgb(255, 255, 255)';\n        ctx.fillRect(0, 0, size * 2, size * 2);\n        ctx.fillStyle = 'rgb(200, 200, 200)';\n        ctx.fillRect(0, 0, size, size);\n        ctx.fillRect(size, size, size * 2, size * 2);\n    }\n    return canvas;\n};\n\nexport const createCheckerDataUrl = (function () {\n    const cache: IKeyString = { // previously created dataUrls\n        '8': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2M8ceLEfwY8wNzcHJ80A+OoAcMiDP7//483HZw8eRJ/Ohg1gIFx6IcBAIhJUqnarXQ1AAAAAElFTkSuQmCC',\n        '4': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAJ0lEQVQoU2M8ceLEfwYkYG5ujsxlYKSDgv///6O44eTJk6huoL0CAGsOKVVu8UYvAAAAAElFTkSuQmCC'\n    };\n\n    return function (size: number, callback?: (s: string) => void) {\n        function create(size: number): string {\n            size = parseInt('' + size);\n            if (cache['' + size]) {\n                return cache['' + size];\n            }\n            const canvas = createCheckerCanvas(size);\n            const result = canvas.toDataURL('image/png');\n            cache['' + size] = result;\n            return result;\n        }\n\n        if (callback) { //async\n            setTimeout(function () {\n                callback(create(size));\n            }, 1);\n        } else { //sync\n            return create(size);\n        }\n    };\n})();\n\n/**\n * smooth resize image\n * @param canvas canvas - will be resized (modified)\n * @param w\n * @param h\n * @param tmp1 canvas - optional, provide to save resources\n * @param tmp2 canvas - optional, provide to save resources\n */\nexport function resizeCanvas(\n    canvas: HTMLCanvasElement,\n    w: number,\n    h: number,\n    tmp1?: HTMLCanvasElement,\n    tmp2?: HTMLCanvasElement,\n): void {\n\n    //determine base 2 exponents of old and new size\n    function getBase2Obj(oldW: number, oldH: number, newW: number, newH: number) {\n        const result = {\n            oldWidthEx: Math.round(Math.log2(oldW)),\n            oldHeightEx: Math.round(Math.log2(oldH)),\n            newWidthEx: Math.ceil(Math.log2(newW)),\n            newHeightEx: Math.ceil(Math.log2(newH))\n        };\n        result.oldWidthEx = Math.max(result.oldWidthEx, result.newWidthEx);\n        result.oldHeightEx = Math.max(result.oldHeightEx, result.newHeightEx);\n        return result;\n    }\n\n    if (!w || !h || (w === canvas.width && h === canvas.height)) {\n        return;\n    }\n    w = Math.max(w, 1);\n    h = Math.max(h, 1);\n    if (w <= canvas.width && h <= canvas.height) {\n\n        tmp1 = !tmp1 ? createCanvas() : tmp1;\n        tmp2 = !tmp2 ? createCanvas() : tmp2;\n\n        const base2 = getBase2Obj(canvas.width, canvas.height, w, h);\n\n        //initially scale to a base of 2. unless new size is too close to old. e.g. sizing from 900 to 600\n        tmp2.width = base2.oldWidthEx > base2.newWidthEx ? Math.pow(2, base2.oldWidthEx) : w;\n        tmp2.height = base2.oldHeightEx > base2.newHeightEx ? Math.pow(2, base2.oldHeightEx) : h;\n        tmp1.getContext('2d')!.save();\n        tmp2.getContext('2d')!.save();\n\n        let ew, eh;\n        let buffer1 = tmp1, buffer2 = tmp2;\n\n        ew = base2.oldWidthEx;\n        eh = base2.oldHeightEx;\n\n        let bufferCtx = buffer2.getContext('2d')!;\n        bufferCtx.imageSmoothingEnabled = true;\n        bufferCtx.imageSmoothingQuality  = 'high';\n        bufferCtx.globalCompositeOperation  = 'copy';\n        bufferCtx.drawImage(canvas, 0, 0, buffer2.width, buffer2.height);\n\n        let currentWidth = buffer2.width;\n        let currentHeight = buffer2.height;\n\n        //stepwise half the size\n        for (; ew > base2.newWidthEx || eh > base2.newHeightEx; ew--, eh--) {\n            bufferCtx = buffer1.getContext('2d')!;\n            bufferCtx.imageSmoothingEnabled = true;\n            bufferCtx.imageSmoothingQuality  = 'high';\n            bufferCtx.globalCompositeOperation  = 'copy';\n\n            const newWidth = (ew > base2.newWidthEx) ? currentWidth / 2 : currentWidth;\n            const newHeight = (eh > base2.newHeightEx) ? currentHeight / 2 : currentHeight;\n\n            //buffer also needs to be properly sized, unfortunately\n            buffer1.width = newWidth;\n            buffer1.height = newHeight;\n\n            bufferCtx.drawImage(\n                buffer2,\n                0, 0,\n                currentWidth, currentHeight,\n                0, 0,\n                newWidth, newHeight\n            );\n            currentWidth = newWidth;\n            currentHeight = newHeight;\n\n            //swap\n            const tmp = buffer1;\n            buffer1 = buffer2;\n            buffer2 = tmp;\n        }\n\n        //when no longer can be halved, bring to target size\n        canvas.width = w;\n        canvas.height = h;\n        const canvasCtx = canvas.getContext('2d')!;\n        canvasCtx.save();\n        canvasCtx.imageSmoothingEnabled = true;\n        canvasCtx.imageSmoothingQuality  = 'high';\n        canvasCtx.drawImage(\n            buffer2,\n            0, 0,\n            currentWidth, currentHeight,\n            0, 0,\n            w, h\n        );\n        canvasCtx.restore();\n        tmp1.getContext('2d')!.restore();\n        tmp2.getContext('2d')!.restore();\n\n    } else if (w >= canvas.width && h >= canvas.height) {\n\n        tmp1 = !tmp1 ? createCanvas() : tmp1;\n        tmp1.width = w;\n        tmp1.height = h;\n        const tmp1Ctx = tmp1.getContext('2d')!;\n        tmp1Ctx.save();\n        tmp1Ctx.imageSmoothingEnabled = true;\n        tmp1Ctx.imageSmoothingQuality  = 'high';\n        tmp1Ctx.drawImage(canvas, 0, 0, w, h);\n        tmp1Ctx.restore();\n\n        canvas.width = w;\n        canvas.height = h;\n        canvas.getContext('2d')!.drawImage(tmp1, 0, 0);\n\n    } else {\n        resizeCanvas(canvas, w, canvas.height, tmp1, tmp2);\n        resizeCanvas(canvas, w, h, tmp1, tmp2);\n    }\n}\n\n/**\n * puts naive greyscale version of image into alpha channel.\n * only writes a, doesn't write rgb\n * @param canvas\n */\nexport function convertToAlphaChannelCanvas(canvas: HTMLCanvasElement): void {\n    const imdat = canvas.getContext('2d')!.getImageData(0, 0, canvas.width, canvas.height);\n    for (let i = 0; i < imdat.data.length; i += 4) {\n        if (imdat.data[i + 3] === 0) {\n            continue;\n        }\n        imdat.data[i + 3] = (imdat.data[i] + imdat.data[i + 1] + imdat.data[i + 2]) / 3 * (imdat.data[i + 3] / 255);\n    }\n    canvas.getContext('2d')!.putImageData(imdat, 0, 0);\n}\n","export const Matrix = (function () {\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web\n    // yes not optimized - but it's not used for physics simulations.\n\n    // const perfTotal = 0;\n\n    // point • matrix\n    function multiplyMatrixAndPoint(matrix, point) {\n        const result = [\n            (point[0] * matrix[0]) + (point[1] * matrix[4]) + (point[2] * matrix[8]) + (point[3] * matrix[12]), // x\n            (point[0] * matrix[1]) + (point[1] * matrix[5]) + (point[2] * matrix[9]) + (point[3] * matrix[13]), // y\n            (point[0] * matrix[2]) + (point[1] * matrix[6]) + (point[2] * matrix[10]) + (point[3] * matrix[14]), // z\n            (point[0] * matrix[3]) + (point[1] * matrix[7]) + (point[2] * matrix[11]) + (point[3] * matrix[15]) // w\n        ];\n        return result;\n    }\n\n    //matrixB • matrixA\n    function multiplyMatrices(matrixA, matrixB) {\n\n        // Slice the second matrix up into rows\n        const row0 = [matrixB[0], matrixB[1], matrixB[2], matrixB[3]];\n        const row1 = [matrixB[4], matrixB[5], matrixB[6], matrixB[7]];\n        const row2 = [matrixB[8], matrixB[9], matrixB[10], matrixB[11]];\n        const row3 = [matrixB[12], matrixB[13], matrixB[14], matrixB[15]];\n\n        // Multiply each row by matrixA\n        const result0 = multiplyMatrixAndPoint(matrixA, row0);\n        const result1 = multiplyMatrixAndPoint(matrixA, row1);\n        const result2 = multiplyMatrixAndPoint(matrixA, row2);\n        const result3 = multiplyMatrixAndPoint(matrixA, row3);\n\n        // Turn the result rows back into a single matrix\n        return [\n            result0[0], result0[1], result0[2], result0[3],\n            result1[0], result1[1], result1[2], result1[3],\n            result2[0], result2[1], result2[2], result2[3],\n            result3[0], result3[1], result3[2], result3[3]\n        ];\n    }\n\n    function createTranslationMatrix(x, y) {\n        return [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            x, y, 0, 1\n        ];\n    }\n\n    function createRotationMatrix(angleRad) {\n        //let angleRad = angleDeg / 360 * 2 * Math.PI;\n        return [\n            Math.cos(-angleRad), -Math.sin(-angleRad), 0, 0,\n            Math.sin(-angleRad), Math.cos(-angleRad), 0, 0,\n            0, 0, 1, 0,\n            0, 0, 0, 1\n        ];\n    }\n\n    function createScaleMatrix(f) {\n        return [\n            f, 0, 0, 0,\n            0, f, 0, 0,\n            0, 0, 1, 0,\n            0, 0, 0, 1\n        ];\n    }\n\n    return {\n        getIdentity: function () {\n            return [\n                1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1\n            ];\n        },\n        multiplyMatrixAndPoint: multiplyMatrixAndPoint,\n        multiplyMatrices: multiplyMatrices,\n        createTranslationMatrix: createTranslationMatrix,\n        createRotationMatrix: createRotationMatrix,\n        createScaleMatrix: createScaleMatrix\n    };\n})();","import {IVector2D} from '../BB.types';\n\nexport const Vec2 = {\n    add: function (p1: IVector2D, p2: IVector2D): IVector2D {\n        return {x: p1.x + p2.x, y: p1.y + p2.y};\n    },\n    sub: function (p1: IVector2D, p2: IVector2D): IVector2D {\n        return {x: p1.x - p2.x, y: p1.y - p2.y};\n    },\n    nor: function (p: IVector2D): IVector2D {\n        const len = Math.sqrt(Math.pow(p.x, 2) + Math.pow(p.y, 2));\n        return {x: p.x / len, y: p.y / len};\n    },\n    len: function (p: IVector2D): number {\n        return Math.sqrt(Math.pow(p.x, 2) + Math.pow(p.y, 2));\n    },\n    dist: function (p1: IVector2D, p2: IVector2D): number {\n        return Vec2.len(Vec2.sub(p1, p2));\n    },\n    mul: function (p: IVector2D, s: number): IVector2D {\n        return {x: p.x * s, y: p.y * s};\n    },\n    angle: function (p1: IVector2D, p2: IVector2D): number {\n        return Math.atan2(p2.y - p1.y, p2.x - p1.x);\n    },\n    dot: function(a: IVector2D, b: IVector2D): number {\n        const aArr = [a.x, a.y];\n        const bArr = [b.x, b.y];\n        return aArr.map((x, i) => aArr[i] * bArr[i]).reduce((m, n) => m + n);\n    }\n};","import {Vec2} from './vec2';\nimport {pointsToAngleDeg, clamp, dist, mix} from './math';\nimport {IVector2D} from \"../bb.types\";\n\n/**\n * project p onto line\n * @param lineStart\n * @param lineEnd\n * @param p\n */\nexport const projectPointOnLine = function (lineStart: IVector2D, lineEnd: IVector2D, p: IVector2D): IVector2D {\n    let x, y;\n    if (lineStart.x === lineEnd.x) {\n        x = lineStart.x;\n        y = p.y;\n\n        return {\n            x: x,\n            y: y\n        };\n    }\n    const m = (lineEnd.y - lineStart.y) / (lineEnd.x - lineStart.x);\n    const b = lineStart.y - (m * lineStart.x);\n\n    x = (m * p.y + p.x - m * b) / (m * m + 1);\n    y = (m * m * p.y + m * p.x + b) / (m * m + 1);\n\n    return {\n        x: x,\n        y: y\n    };\n};\n\n\n\n/**\n * Operations on a line made up of points\n *\n * getAtDist(dist) - point when traveling *dist* along the line\n * getLength - gives you total length of line\n *\n * @param params object - {points: [{x:float, y:float}, ...]}\n * @constructor\n */\nexport const PointLine = function (params) {\n    const segmentArr = [];\n    const _this = this;\n\n    for (let i = 0; i < params.points.length; i++) {\n        (function (i) {\n            let length = undefined;\n            if (i < params.points.length - 1) {\n                length = dist(params.points[i].x, params.points[i].y, params.points[i + 1].x, params.points[i + 1].y);\n            }\n            segmentArr[i] = {\n                x: params.points[i].x,\n                y: params.points[i].y,\n                length: length\n            };\n        })(i);\n    }\n\n    /**\n     * @param dist number - distance in pixels, > 0\n     * @returns {{x: number, y: number}}\n     */\n    this.getAtDist = function (dist) {\n        let remainder = Math.min(_this.getLength(), dist);\n        let i = 0;\n\n        for (; remainder > segmentArr[i].length && i < segmentArr.length - 2; i++) {\n            remainder -= segmentArr[i].length;\n        }\n\n        const fac = Math.min(1, Math.max(0, remainder / segmentArr[i].length));\n\n        return {\n            x: (segmentArr[i].x * (1 - fac) + segmentArr[i + 1].x * fac),\n            y: (segmentArr[i].y * (1 - fac) + segmentArr[i + 1].y * fac)\n        };\n    };\n    this.getLength = function () {\n        let result = 0;\n        for (let i = 0; i < segmentArr.length - 1; i++) {\n            result += segmentArr[i].length;\n        }\n        return result;\n    };\n};\n\n/**\n * Each instance is one line made up of bezier interpolated segments.\n * You feed it points. It calculates control points on its own, and the resulting curve.\n *\n * @constructor\n */\nexport const BezierLine = function () {\n    const _this = this;\n    const pointArr = [];\n    let lastDot = 0;\n    let lastPoint;\n    let lastCallbackPoint;\n    let lastAngle;\n    let lastSpacing = null;\n\n    /**\n     * creates bezier curve from control points\n     *\n     * @param p1 - control point 1 {x: float, y: float}\n     * @param p2 - control point 2 {x: float, y: float}\n     * @param p3 - control point 3 {x: float, y: float}\n     * @param p4 - control point 4 {x: float, y: float}\n     * @param resolution - int\n     * @returns {Array} - bezier curve made up of points {x: float, y: float}\n     */\n    function getBezierPoints(p1, p2, p3, p4, resolution) {\n        const curvePoints = [];\n        let t, result;\n        for (let i = 0; i <= resolution; i++) {\n            t = i / resolution;\n            result = {};\n            result.x = Math.pow(1 - t, 3) * p1.x + 3 * Math.pow(1 - t, 2) * t * p2.x + 3 * (1 - t) * Math.pow(t, 2) * p3.x + Math.pow(t, 3) * p4.x;\n            result.y = Math.pow(1 - t, 3) * p1.y + 3 * Math.pow(1 - t, 2) * t * p2.y + 3 * (1 - t) * Math.pow(t, 2) * p3.y + Math.pow(t, 3) * p4.y;\n            curvePoints[curvePoints.length] = result;\n        }\n        return curvePoints;\n    }\n\n    /**\n     *\n     * add now point to line\n     * line will go until the previous point\n     *\n     * @param x - coord of new point\n     * @param y - coord of new point\n     * @param spacing - space between each step\n     * @param callback - calls for each step - x, y, t - t is 0-1 how far along\n     * @param controlsCallback - calls that callback with the bezier control points p1, p2, p3, p4 - each {x: float, y: float}\n     */\n    this.add = function (x, y, spacing, callback, controlsCallback) {\n        if (lastPoint && x === lastPoint.x && y === lastPoint.y) {\n            return;\n        }\n        lastPoint = {x: x, y: y};\n        pointArr[pointArr.length] = {\n            x: x,\n            y: y,\n            spacing: spacing\n        };\n\n        //calculate directions\n        if (pointArr.length === 1) {\n            lastSpacing = spacing;\n            return;\n        } else if (pointArr.length === 2) {\n            pointArr[0].dir = Vec2.nor(Vec2.sub(pointArr[1], pointArr[0]));\n            lastDot = spacing;\n            lastSpacing = spacing;\n            return;\n        } else {\n            const pointM1 = pointArr[pointArr.length - 1];\n            const pointM2 = pointArr[pointArr.length - 2];\n            const pointM3 = pointArr[pointArr.length - 3];\n            pointM2.dir = Vec2.nor(Vec2.sub(pointM1, pointM3));\n            if (isNaN(pointM2.dir.x) || isNaN(pointM2.dir.y)) {\n                //when xy -3 == -1\n                pointM2.dir = JSON.parse(JSON.stringify(pointM3.dir));\n            }\n        }\n\n        //get bezier curve\n        const a = pointArr[pointArr.length - 3];\n        const b = pointArr[pointArr.length - 2];\n        const p1 = a;\n        const p2 = Vec2.add(a, Vec2.mul(a.dir, Vec2.dist(a, b) / 4));\n        const p3 = Vec2.sub(b, Vec2.mul(b.dir, Vec2.dist(a, b) / 4));\n        const p4 = b;\n\n\n        let pointLine;\n        if (callback) {\n            let curvePoints;\n            curvePoints = getBezierPoints(p1, p2, p3, p4, 20);\n            pointLine = new PointLine({points: curvePoints});\n        } else {\n            pointLine = new PointLine({points: [p1, p4]});\n        }\n\n        //interate over curve with spacing and callback\n        const len = pointLine.getLength();\n        let tempSpacing = mix(lastSpacing, spacing, clamp(lastDot / len, 0, 1));\n        let d = lastDot;\n        for (; d <= len; d += tempSpacing) {\n            tempSpacing = mix(lastSpacing, spacing, clamp(d / len, 0, 1));\n            const point = pointLine.getAtDist(d);\n            const angle = lastCallbackPoint ? pointsToAngleDeg(lastCallbackPoint, point) : undefined;\n            if (callback) {\n                callback({\n                    x: point.x,\n                    y: point.y,\n                    t: d / len,\n                    angle: angle,\n                    dAngle: lastCallbackPoint ? angle - lastAngle : 0\n                });\n            }\n            lastCallbackPoint = point;\n            lastAngle = angle;\n        }\n\n        if (callback) {\n            lastDot = d - len;\n        } else {\n            lastDot = 0;\n            controlsCallback({p1: p1, p2: p2, p3: p3, p4: p4});\n        }\n\n        lastSpacing = spacing;\n    };\n\n    this.addFinal = function(spacing, callback, controlsCallback) {\n        if (pointArr.length < 2) {\n            return;\n        }\n\n        const p1 = pointArr[pointArr.length - 2];\n        const p2 = pointArr[pointArr.length - 1];\n\n        const newP = Vec2.add(p2, Vec2.sub(p2, p1));\n\n        _this.add(newP.x, newP.y, spacing, callback, controlsCallback);\n    };\n\n};\n\n/**\n * from glfx.script by evanW:\n * from SplineInterpolator.cs in the Paint.NET source code\n *\n * points go 0 - 1. I think.\n *\n * @param points\n * @constructor\n */\nexport const SplineInterpolator = function (points) {\n    const n = points.length;\n    this.xa = [];\n    this.ya = [];\n    this.u = [];\n    this.y2 = [];\n    let i;\n\n    const first = points[0][0];\n    const last = points[points.length - 1][0];\n\n    points.sort(function (a, b) {\n        return a[0] - b[0];\n    });\n    for (i = 0; i < n; i++) {\n        this.xa.push(points[i][0]);\n        this.ya.push(points[i][1]);\n    }\n\n    this.u[0] = 0;\n    this.y2[0] = 0;\n\n    for (i = 1; i < n - 1; ++i) {\n        // This is the decomposition loop of the tridiagonal algorithm.\n        // y2 and u are used for temporary storage of the decomposed factors.\n        const wx = this.xa[i + 1] - this.xa[i - 1];\n        const sig = (this.xa[i] - this.xa[i - 1]) / wx;\n        const p = sig * this.y2[i - 1] + 2.0;\n\n        this.y2[i] = (sig - 1.0) / p;\n\n        const ddydx =\n            (this.ya[i + 1] - this.ya[i]) / (this.xa[i + 1] - this.xa[i]) -\n            (this.ya[i] - this.ya[i - 1]) / (this.xa[i] - this.xa[i - 1]);\n\n        this.u[i] = (6.0 * ddydx / wx - sig * this.u[i - 1]) / p;\n    }\n\n    this.y2[n - 1] = 0;\n\n    // This is the backsubstitution loop of the tridiagonal algorithm\n    for (i = n - 2; i >= 0; --i) {\n        this.y2[i] = this.y2[i] * this.y2[i + 1] + this.u[i];\n    }\n\n    this.getFirstX = function () {\n        return first;\n    };\n    this.getLastX = function () {\n        return last;\n    };\n};\n\nSplineInterpolator.prototype.interpolate = function (x) {\n    const n = this.ya.length;\n    let klo = 0;\n    let khi = n - 1;\n\n    // We will find the right place in the table by means of\n    // bisection. This is optimal if sequential calls to this\n    // routine are at random values of x. If sequential calls\n    // are in order, and closely spaced, one would do better\n    // to store previous values of klo and khi.\n    while (khi - klo > 1) {\n        const k = (khi + klo) >> 1;\n\n        if (this.xa[k] > x) {\n            khi = k;\n        } else {\n            klo = k;\n        }\n    }\n\n    const h = this.xa[khi] - this.xa[klo];\n    const a = (this.xa[khi] - x) / h;\n    const b = (x - this.xa[klo]) / h;\n\n    // Cubic spline polynomial is now evaluated.\n    return a * this.ya[klo] + b * this.ya[khi] +\n        ((a * a * a - a) * this.y2[klo] + (b * b * b - b) * this.y2[khi]) * (h * h) / 6.0;\n};\n\n/**\n * find x to y. simply by stepping through. suboptimal, so don't call often.\n * searches in x 0-1 range\n *\n * @param y\n * @param resolution\n */\nSplineInterpolator.prototype.findX = function (y, resolution) {\n    let x = null;\n    let dist = null;\n    for (let i = 0; i <= resolution; i++) {\n        const tempX = i / resolution;\n        const tempY = this.interpolate(tempX);\n        if (x === null) {\n            x = tempX;\n            dist = Math.abs(tempY - y);\n            continue;\n        }\n\n        const tempDist = Math.abs(tempY - y);\n\n        if (tempDist < dist) {\n            x = tempX;\n            dist = tempDist;\n        } else {\n            //distance increasing\n            break;\n        }\n    }\n    return x;\n};\n\n/**\n * input for a spline, following curve of quadratic function x^2 [0 - 1]\n * returns [[0, startVal], ..., [1, endVal]]\n * @param startVal\n * @param endVal\n * @param stepSize\n * @returns {[]}\n */\nexport const quadraticSplineInput = function (startVal, endVal, stepSize) {\n    function round(v, dec) {\n        return Math.round(v * Math.pow(10, dec)) / Math.pow(10, dec);\n    }\n\n    const resultArr = [];\n    for (let i = 0; i <= 1; i += stepSize) {\n        resultArr.push([round(i, 4), round(startVal + Math.pow(i, 2) * (endVal - startVal), 4)]);\n    }\n    return resultArr;\n};","\n\n\n// based on js color conversion http://www.webtoolkit.info/\n\n\nexport class HSV {\n    h: number;\n    s: number;\n    v: number;\n    constructor(h: number, s: number, v: number) {\n        this.h = Math.max(0, Math.min(360, h));\n        this.s = Math.max(0.001, Math.min(100, s)); //bug when 0\n        this.v = Math.max(0, Math.min(100, v));\n    }\n}\n\nexport class RGB {\n    r : number;\n    g: number;\n    b: number;\n    constructor(r: number, g: number, b: number) {\n        this.r = Math.max(0, Math.min(255, r));\n        this.g = Math.max(0, Math.min(255, g));\n        this.b = Math.max(0, Math.min(255, b));\n    }\n}\n\nexport class CMYK {\n    c: number;\n    m: number;\n    y: number;\n    k: number;\n    constructor(c: number, m: number, y: number, k: number) {\n        this.c = Math.max(0, Math.min(100, c));\n        this.m = Math.max(0, Math.min(100, m));\n        this.y = Math.max(0, Math.min(100, y));\n        this.k = Math.max(0, Math.min(100, k));\n    }\n}\n\nexport const ColorConverter = {\n\n    _RGBtoHSV: function (RGB: RGB): HSV {\n        const result = new HSV(0, 0, 0);\n\n        const r = RGB.r / 255;\n        const g = RGB.g / 255;\n        const b = RGB.b / 255;\n\n        const minVal = Math.min(r, g, b);\n        const maxVal = Math.max(r, g, b);\n        const delta = maxVal - minVal;\n\n        result.v = maxVal;\n\n        if (delta == 0) {\n            result.h = 0;\n            result.s = 0;\n        } else {\n            result.s = delta / maxVal;\n            const del_R = (((maxVal - r) / 6) + (delta / 2)) / delta;\n            const del_G = (((maxVal - g) / 6) + (delta / 2)) / delta;\n            const del_B = (((maxVal - b) / 6) + (delta / 2)) / delta;\n\n            if (r == maxVal) {\n                result.h = del_B - del_G;\n            } else if (g == maxVal) {\n                result.h = (1 / 3) + del_R - del_B;\n            } else if (b == maxVal) {\n                result.h = (2 / 3) + del_G - del_R;\n            }\n\n            if (result.h < 0) {\n                result.h += 1;\n            }\n            if (result.h > 1) {\n                result.h -= 1;\n            }\n        }\n\n        result.h = Math.round(result.h * 360);\n        result.s = Math.round(result.s * 100);\n        result.v = Math.round(result.v * 100);\n\n        return result;\n    },\n\n    _HSVtoRGB: function (HSV: HSV): RGB {\n        const result = new RGB(0, 0, 0);\n\n        let var_h, var_i, var_1, var_2, var_3, var_r, var_g, var_b;\n\n        const h = (HSV.h / 360) % 1;\n        const s = HSV.s / 100;\n        const v = HSV.v / 100;\n\n        if (s == 0) {\n            result.r = v * 255;\n            result.g = v * 255;\n            result.b = v * 255;\n        } else {\n            var_h = h * 6;\n            var_i = Math.floor(var_h);\n            var_1 = v * (1 - s);\n            var_2 = v * (1 - s * (var_h - var_i));\n            var_3 = v * (1 - s * (1 - (var_h - var_i)));\n\n            if (var_i == 0) {\n                var_r = v;\n                var_g = var_3;\n                var_b = var_1\n            } else if (var_i == 1) {\n                var_r = var_2;\n                var_g = v;\n                var_b = var_1\n            } else if (var_i == 2) {\n                var_r = var_1;\n                var_g = v;\n                var_b = var_3\n            } else if (var_i == 3) {\n                var_r = var_1;\n                var_g = var_2;\n                var_b = v\n            } else if (var_i == 4) {\n                var_r = var_3;\n                var_g = var_1;\n                var_b = v\n            } else {\n                var_r = v;\n                var_g = var_1;\n                var_b = var_2\n            }\n\n            result.r = var_r * 255;\n            result.g = var_g * 255;\n            result.b = var_b * 255;\n\n            result.r = Math.round(result.r);\n            result.g = Math.round(result.g);\n            result.b = Math.round(result.b);\n        }\n\n        return result;\n    },\n\n    _CMYKtoRGB: function (CMYK: CMYK): RGB {\n        const result = new RGB(0, 0, 0);\n\n        const c = CMYK.c / 100;\n        const m = CMYK.m / 100;\n        const y = CMYK.y / 100;\n        const k = CMYK.k / 100;\n\n        result.r = 1 - Math.min(1, c * (1 - k) + k);\n        result.g = 1 - Math.min(1, m * (1 - k) + k);\n        result.b = 1 - Math.min(1, y * (1 - k) + k);\n\n        result.r = Math.round(result.r * 255);\n        result.g = Math.round(result.g * 255);\n        result.b = Math.round(result.b * 255);\n\n        return result;\n    },\n\n    _RGBtoCMYK: function (RGB: RGB): CMYK {\n        const result = new CMYK(0, 0, 0, 0);\n\n        const r = RGB.r / 255;\n        const g = RGB.g / 255;\n        const b = RGB.b / 255;\n\n        result.k = Math.min(1 - r, 1 - g, 1 - b);\n        result.c = (1 - r - result.k) / (1 - result.k);\n        result.m = (1 - g - result.k) / (1 - result.k);\n        result.y = (1 - b - result.k) / (1 - result.k);\n\n        result.c = Math.round(result.c * 100);\n        result.m = Math.round(result.m * 100);\n        result.y = Math.round(result.y * 100);\n        result.k = Math.round(result.k * 100);\n\n        return result;\n    },\n\n    toRGB: function (o: RGB | HSV | CMYK): RGB {\n        if (o instanceof RGB) {\n            return o;\n        }\n        if (o instanceof HSV) {\n            return this._HSVtoRGB(o);\n        }\n        if (o instanceof CMYK) {\n            return this._CMYKtoRGB(o);\n        }\n    },\n\n    toHSV: function (o: RGB | HSV | CMYK): HSV {\n        if (o instanceof HSV) {\n            return o;\n        }\n        if (o instanceof RGB) {\n            return this._RGBtoHSV(o);\n        }\n        if (o instanceof CMYK) {\n            return this._RGBtoHSV(this._CMYKtoRGB(o));\n        }\n    },\n\n    toCMYK: function (o: RGB | HSV | CMYK): CMYK {\n        if (o instanceof CMYK) {\n            return o;\n        }\n        if (o instanceof RGB) {\n            return this._RGBtoCMYK(o);\n        }\n        if (o instanceof HSV) {\n            return this._RGBtoCMYK(this._HSVtoRGB(o));\n        }\n    },\n    toHexString: function (o: RGB): string {\n        if (o instanceof RGB) {\n            let ha = (parseInt('' + o.r)).toString(16);\n            let hb = (parseInt('' + o.g)).toString(16);\n            let hc = (parseInt('' + o.b)).toString(16);\n            if (ha.length == 1)\n                ha = '0' + ha;\n            if (hb.length == 1)\n                hb = '0' + hb;\n            if (hc.length == 1)\n                hc = '0' + hc;\n            return ha + hb + hc;\n        }\n    },\n    toRgbStr: function(rgbObj: {r: number, g: number, b: number}): string {\n        return 'rgb(' + Math.round(rgbObj.r) + ', ' + Math.round(rgbObj.g) + ', ' + Math.round(rgbObj.b) + ')';\n    },\n    toRgbaStr: function(rgbaObj: {r: number, g: number, b: number, a: number}): string {\n        return 'rgba(' + Math.round(rgbaObj.r) + ', ' + Math.round(rgbaObj.g) + ', ' + Math.round(rgbaObj.b) + ', ' + rgbaObj.a + ')';\n    },\n    hexToRGB: function(hexStr: string): RGB | null {\n        hexStr = hexStr.trim();\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n        const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n        hexStr = hexStr.replace(shorthandRegex, function(m, r, g, b) {\n            return r + r + g + g + b + b;\n        });\n\n        const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hexStr);\n        return result ? new RGB(\n            parseInt(result[1], 16),\n            parseInt(result[2], 16),\n            parseInt(result[3], 16)\n        ) : null;\n    }\n\n};\n\nexport function testIsWhiteBestContrast(rgbObj: {r: number, g: number, b: number}): boolean {\n    return (rgbObj.r * 0.299 + rgbObj.g * 0.587 + rgbObj.b * 0.114) < 125;\n}","import {addEventListener} from '../input/event-listener';\nimport {css} from './base';\nimport {BB} from '../bb';\n\n\nexport function appendTextDiv(target: HTMLElement, text: string): HTMLDivElement {\n    const div = document.createElement('div');\n    div.innerHTML = text;\n    target.appendChild(div);\n    return div;\n}\n\n/**\n * Is an input element focused.\n * Set attribute \"data-ignore-focus\" to \"true\" if its focus should be ignored.\n *\n * @param getAll - check all, even those with \"data-ignore-focus\" = \"true\"\n */\nexport function isInputFocused(getAll: boolean = false): boolean {\n    let result = document.activeElement && ['INPUT', 'TEXTAREA'].includes(document.activeElement.tagName);\n    if (getAll) {\n        return result;\n    } else {\n        return result && !document.activeElement.getAttribute('data-ignore-focus');\n    }\n}\n\n/**\n * clears text selection in window\n */\nexport function clearSelection(): void {\n    if (window.getSelection) {\n        const sel = window.getSelection();\n        if (sel) {\n            if (sel.empty) {\n                sel.empty();\n            } else if (sel.removeAllRanges) {\n                sel.removeAllRanges();\n            }\n        }\n    } else if ('selection' in document) {\n        (document as any).selection.empty();\n    }\n}\n\n/**\n * prevents being able to focus element.\n * warning: it creates a listener\n *\n * @param el - dom element\n */\nexport const makeUnfocusable = (function() {\n\n    function preventFocus(event: MouseEvent) {\n        event.preventDefault();\n        let didFocusRelated = false;\n        if (event.relatedTarget) {\n            try {\n                (event.relatedTarget as HTMLElement).focus();\n                didFocusRelated = true;\n            } catch(e) {\n                console.error('failed to focus');\n            }\n        }\n        if (!didFocusRelated) {\n            (event.currentTarget as HTMLElement).blur();\n        }\n    }\n\n    return function(el) {\n        el.setAttribute('tabindex', '-1');\n        addEventListener(el, 'focus', preventFocus);\n    };\n})();\n\n\nconst els: {\n    el: HTMLElement;\n    listeners: [string, any][];\n}[] = [];\n// window['els'] = els;\n\n/**\n *\n * Create DOM element - div by default\n * params = {\n * \t    parent: someOtherDiv,\n * \t    css: {\n * \t\t    width: \"500px\",\n * \t\t    backgroundColor: \"#fff\"\n * \t    },\n * \t    content: \"test\", //or  content: [divA, divB, divC]   or content: someDiv\n * \t    className: \"bla\",\n *      id: \"bla\"\n * }\n *\n * @param params\n */\nexport function el(\n    params: {\n        parent?: HTMLElement,\n        css?: { [key: string]: string },\n        custom?: { [key: string]: any },\n        content?: string | (HTMLElement | string | null)[] | HTMLElement | SVGElement,\n        textContent?: string,\n        className?: string,\n        title?: string,\n        id?: string,\n        tagName?: string,\n        onClick?: (e: Event) => void,\n        onChange?: (e: Event) => void,\n    }\n): HTMLElement {\n    const div = document.createElement(params.tagName ? params.tagName : 'div');\n    const arr = [];\n    if (params.css) {\n        css(div, params.css);\n    }\n\n    if (params.content) {\n        if (typeof params.content === typeof 'aa') {\n            div.innerHTML = params.content as string;\n\n        } else if (Array.isArray(params.content)) {\n            BB.append(div, params.content);\n\n        } else {\n            div.appendChild(params.content as HTMLElement);\n\n        }\n    }\n    if (params.textContent) {\n        div.textContent = params.textContent;\n    }\n    if (params.className) {\n        div.className = params.className;\n    }\n    if (params.id) {\n        div.id = params.id;\n    }\n    if (params.parent) {\n        params.parent.appendChild(div);\n    }\n    if ('title' in params && params.title !== undefined) {\n        div.title = params.title;\n    }\n    const listeners = [];\n    if ('onClick' in params) {\n        addEventListener(div, 'click', params.onClick);\n        listeners.push(['click', params.onClick]);\n    }\n    if ('onChange' in params) {\n        addEventListener(div, 'change', params.onChange);\n        listeners.push(['change', params.onChange]);\n    }\n    if (listeners.length > 0) {\n        els.push({\n            el: div,\n            listeners: listeners,\n        })\n        /*div.style.backgroundColor = '#ff0';\n        div.style.border = '1px solid #ff0';*/\n    }\n    if ('custom' in params) {\n        const customKeyArr = Object.keys(params.custom);\n        for (let i = 0; i < customKeyArr.length; i++) {\n            div.setAttribute(customKeyArr[i], params.custom[customKeyArr[i]]);\n        }\n    }\n    return div;\n}\n\n/**\n * removes event listeners for Elements created via el()\n * @param el\n */\nexport function destroyEl(el: HTMLElement) {\n    for (let i = 0; i < els.length; i++) {\n        const item = els[i];\n        if (item.el === el) {\n            item.listeners.forEach(item => {\n                el.removeEventListener(item[0], item[1]);\n            });\n            els.splice(i, 1);\n            return;\n        }\n    }\n    // not found\n    return;\n}\n","\nexport class BbLog {\n\n    private static listeners: any[] = [];\n\n    constructor() {\n    }\n\n    static subscribe(listener) {\n        if (BbLog.listeners.includes(listener)) {\n            return;\n        }\n        BbLog.listeners.push(listener);\n    }\n\n    static unsubscribe(listener) {\n        for (let i = 0; i < BbLog.listeners.length; i++) {\n            if (listener === BbLog.listeners[i]) {\n                BbLog.listeners.splice(i, 1);\n                return;\n            }\n        }\n    }\n\n    static emit (msg) {\n        BbLog.listeners.forEach(item => {\n            item(msg);\n        });\n    }\n}","/**\n * LocalStorage wrapper that does not throw exceptions.\n * If cookies disabled in Safari localStorage interactions throw exception \"insecure operation\"\n */\nexport class LocalStorage {\n\n    private static error;\n\n    static getItem (key: string): string {\n        let result = null;\n        try {\n            result = localStorage.getItem(key);\n        } catch (e) {\n            this.error = e;\n        }\n        return result;\n    }\n\n    static setItem (key: string, value: string): void {\n        try {\n            localStorage.setItem(key, value);\n        } catch (e) {\n            this.error = e;\n        }\n    }\n\n    static removeItem (key: string): void {\n        try {\n            localStorage.removeItem(key);\n        } catch (e) {\n            this.error = e;\n        }\n    }\n\n    static getError (): any {\n        return this.error;\n    }\n}","import * as BBEventListener from './input/event-listener';\nimport {\n    addClassName, append, centerWithin, copyObj, createSvg,\n    css, dateDayDifference, decToFraction,\n    fitInto, gcd, getDate,\n    handleClick, imageBlobToUrl,\n    insertAfter, loadImage,\n    reduce,\n    removeClassName, setAttributes, shareCanvas\n} from './base/base';\nimport {\n    canShareFiles,\n    eventUsesHighResTimeStamp,\n    getVisitor,\n    hasPointerEvents,\n    hasWebGl,\n    isCssMinMaxSupported,\n    mouseEventHasMovement\n} from './base/browser';\nimport {KeyListener, sameKeys} from './input/key-listener';\nimport {PointerListener} from './input/pointer-listener';\nimport * as EventChain from './input/event-chain';\nimport {\n    convertToAlphaChannelCanvas,\n    copyCanvas,\n    createCheckerCanvas, createCheckerDataUrl,\n    drawTransformedImageOnCanvas,\n    drawTransformedImageWithBounds, resizeCanvas, testShouldPixelate\n} from './base/canvas';\nimport {Matrix} from './math/matrix';\nimport {Vec2} from './math/vec2';\nimport {BezierLine, PointLine, projectPointOnLine, quadraticSplineInput, SplineInterpolator} from './math/line';\nimport {CMYK, ColorConverter, HSV, RGB, testIsWhiteBestContrast} from './color/color';\nimport {appendTextDiv, clearSelection, destroyEl, el, isInputFocused, makeUnfocusable} from './base/ui';\nimport {\n    pointsToAngleDeg,\n    clamp,\n    dist,\n    mix,\n    pointsToAngleRad,\n    rotate,\n    rotateAround,\n    intDxy,\n    roundEven, roundUneven, distSquared, lenSquared, updateBounds, boundsInArea\n} from './math/math';\nimport {createCanvas} from './base/create-canvas';\nimport {BbLog} from './base/bb-log';\nimport {LocalStorage} from './base/local-storage';\n\nexport const BB = {\n\n    // ---- browser ----\n    eventUsesHighResTimeStamp,\n    mouseEventHasMovement,\n    hasPointerEvents,\n    hasWebGl,\n    getVisitor,\n    isCssMinMaxSupported,\n    canShareFiles,\n\n    // ---- base ----\n    insertAfter,\n    loadImage,\n    css,\n    setAttributes,\n    addClassName,\n    removeClassName,\n    append,\n    fitInto,\n    centerWithin,\n    getDate,\n    gcd,\n    reduce,\n    decToFraction,\n    imageBlobToUrl,\n    dateDayDifference,\n    copyObj,\n    shareCanvas,\n    handleClick,\n    createSvg,\n    BbLog,\n    LocalStorage,\n\n    // ---- math ----\n    mix,\n    dist,\n    distSquared,\n    lenSquared,\n    pointsToAngleRad,\n    pointsToAngleDeg,\n    clamp,\n    rotate,\n    rotateAround,\n    Matrix,\n    Vec2,\n    intDxy,\n    roundEven,\n    roundUneven,\n    updateBounds,\n    boundsInArea,\n\n    // ---- line ----\n    projectPointOnLine,\n    PointLine,\n    BezierLine,\n    SplineInterpolator,\n    quadraticSplineInput,\n\n    // ---- canvas ----\n    canvas: createCanvas,\n    copyCanvas,\n    testShouldPixelate,\n    drawTransformedImageWithBounds,\n    drawTransformedImageOnCanvas,\n    createCheckerCanvas,\n    createCheckerDataUrl,\n    resizeCanvas,\n    convertToAlphaChannelCanvas,\n\n    // ---- color ----\n    HSV,\n    RGB,\n    CMYK,\n    ColorConverter,\n    testIsWhiteBestContrast,\n\n    // ---- UI ----\n    appendTextDiv,\n    clearSelection,\n    makeUnfocusable,\n    el,\n    destroyEl,\n    isInputFocused: isInputFocused,\n\n\n    // ---- events / input ----\n\n    addEventListener: BBEventListener.addEventListener,\n    removeEventListener: BBEventListener.removeEventListener,\n    setEventListener: BBEventListener.setEventListener,\n\n    KeyListener,\n    PointerListener,\n    sameKeys,\n\n    EventChain,\n\n};\n","\nexport interface IHistoryEntry {\n    tool: string[];\n    action?: string;\n    params?: any[];\n\n    actions?: {\n        action: string;\n        params: any[];\n    }[]\n}\n\nexport interface IHistoryBroadcast {\n    bufferUpdate: IHistoryEntry;\n}\n\nexport type IHistoryListener = (p: IHistoryBroadcast | null) => void;\n\nlet historyInstance: boolean = false;\n\nexport interface KlHistoryInterface {\n    pause (b: boolean): void;\n    addListener (l: IHistoryListener): void;\n    push (e: IHistoryEntry): void;\n    undo (): (IHistoryEntry | null)[];\n    redo (): (IHistoryEntry | null)[];\n    getAll (): (IHistoryEntry | null)[];\n    canRedo (): boolean;\n    canUndo (): boolean;\n    getState (): number;\n    getActionNumber (): number;\n}\n\nexport class DecoyKlHistory implements KlHistoryInterface {\n    pause (b: boolean): void {}\n    addListener (l: IHistoryListener): void {}\n    push (e: IHistoryEntry): void {}\n    undo (): (IHistoryEntry | null)[] { return []; }\n    redo (): (IHistoryEntry | null)[] { return []; }\n    getAll (): (IHistoryEntry | null)[] { return []; }\n    canRedo (): boolean { return false; }\n    canUndo (): boolean { return false; }\n    getState (): number { return 0; }\n    getActionNumber (): number { return 0; }\n}\n\nexport class KlHistory implements KlHistoryInterface {\n\n    private state: number; // on .push state increments by one\n    private dataArr: (IHistoryEntry | null)[]; // null if beyond max undo to trigger garbage collection\n    private listeners: IHistoryListener[];\n    private pauseStack: number; // how often paused without unpause\n    private readonly max: number = 20; // max number undo steps\n    private maxState: number; // can't go backwards -> max state is the buffer image(klCanvas)\n    private actionNumber: number; // current action the user is on. untouched document = -1 because dataArr.length is 0\n    \n    private broadcast (p: IHistoryBroadcast | null): void {\n        setTimeout(() => {\n            for (let i = 0; i < this.listeners.length; i++) {\n                this.listeners[i](p);\n            }\n            this.state++;\n        }, 1);\n    }\n    \n    // ---- public ----\n    \n    constructor () {\n        if (historyInstance) {\n            throw new Error('klHistory already instantiated');\n        }\n        historyInstance = true;\n        this.state = 0;\n        this.dataArr = [];\n        this.listeners = [];\n        this.pauseStack = 0;\n        this.maxState = -1;\n        this.actionNumber = -1;\n    }\n\n    /**\n     * you need pause because there are sometimes actions that would cause other\n     * undo steps\n     * for example a filter that does something crazy with two layers and then merges them\n     * you want that to be one undo step, and prevent merging from causing its undo step.\n     * so while that filter is doing its magic you should pause possible undo steps that\n     * that are caused by a part of its code(in this example: merging layers)\n     *\n     * @param b\n     */\n    pause (b: boolean): void {\n        if (b === false) {\n            this.pauseStack = Math.max(0, this.pauseStack - 1);\n        } else {\n            this.pauseStack++;\n        }\n    }\n\n    addListener (l: IHistoryListener): void {\n        this.listeners.push(l);\n    }\n\n    push (e: IHistoryEntry): void {\n        if (this.pauseStack > 0) {\n            return;\n        }\n        while (this.actionNumber < this.dataArr.length - 1) {\n            this.dataArr.pop();\n        }\n\n        //taking care of actions that shouldn't cause a new undo step\n        const top = this.dataArr[this.dataArr.length - 1];\n        if (e.action === 'layerOpacity' && top && top.action === 'layerOpacity' && top.params[0] === e.params[0]) {\n            this.dataArr[this.dataArr.length - 1] = e;\n            this.state++; //still needs to increment because something changed\n            return;\n        }\n        if (e.action === 'focusLayer' && top && top.action === 'focusLayer') {\n            this.dataArr[this.dataArr.length - 1] = e;\n            this.state++;\n            return;\n        }\n\n\n        this.dataArr[this.dataArr.length] = e;\n        this.actionNumber = this.dataArr.length - 1;\n        const maxBefore = this.maxState;\n        this.maxState = Math.max(this.maxState, this.actionNumber - this.max);\n        if (maxBefore < this.maxState) {\n            this.broadcast({bufferUpdate: this.dataArr[this.maxState]});\n        } else {\n            this.broadcast(null);\n        }\n        if (this.maxState >= 0) {\n            this.dataArr[this.maxState] = null; //to free some memory...imported images take a lot of space\n        }\n    }\n\n    undo (): (IHistoryEntry | null)[] {\n        let result;\n        if (this.canUndo()) {\n            result = [];\n            for (let i = this.maxState + 1; i < this.actionNumber; i++) {\n                result.push(this.dataArr[i]);\n            }\n            this.actionNumber--;\n            this.broadcast(null);\n        }\n\n        return result;\n    }\n\n    redo (): (IHistoryEntry | null)[] {\n        const result = [];\n        if (this.canRedo()) {\n            this.actionNumber++;\n            result.push(this.dataArr[this.actionNumber]);\n            this.broadcast(null);\n        }\n        return result;\n    }\n\n    getAll (): (IHistoryEntry | null)[] {\n        return [].concat(this.dataArr);\n    }\n\n    canRedo (): boolean {\n        return this.actionNumber < this.dataArr.length - 1;\n    }\n\n    canUndo (): boolean {\n        return this.actionNumber > this.maxState;\n    }\n\n    getState (): number {\n        return this.state;\n    }\n\n    /**\n     * actionNumber - number of undo-able actions a user has done (e.g. if drawn 5 lines total -> 5)\n     */\n    getActionNumber (): number {\n        return (this.actionNumber + 1);\n    }\n    \n}\n\nexport const klHistory = new KlHistory();\n","\n// not the best\n\n/**\n * how many modals are open\n */\n\nexport class DialogCounter {\n    private listeners: ((v: number) => void)[] = [];\n    private count = 0;\n\n    private emit (): void {\n        this.listeners.forEach(item => {\n            item(this.count);\n        });\n    }\n\n    increase (v?: number): void {\n        if (v !== undefined) {\n            this.count += v;\n        } else {\n            this.count++;\n        }\n        this.emit();\n    }\n    decrease (v?: number): void {\n        if (v !== undefined) {\n            this.count -= v;\n        } else {\n            this.count--;\n        }\n        this.emit();\n    }\n    get (): number {\n        return this.count;\n    }\n    subscribe (listener: (v: number) => void): void {\n        this.listeners.push(listener);\n    }\n}\n\nexport const dialogCounter = new DialogCounter();\n","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"iDK6N\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"8gElo\");","// generated from src/languages. \"npm run lang:build\" to update\n\n// @ts-ignore\nimport dataEn from './en.json';\n\nexport const english = dataEn;\nexport const languages: {code: string; name: string}[] = [\n    {\n        code: 'en',\n        name: 'English',\n    },\n    {\n        code: 'de',\n        name: 'Deutsch',\n    },\n    {\n        code: 'ja',\n        name: '日本語',\n    },\n    {\n        code: 'zh-CN',\n        name: '简体中文',\n    }\n];\nexport const loadLanguage = async (code: string) => {\n    if (code === 'en') {\n        return english;\n    } else if (code === 'de') {\n        // @ts-ignore\n        return await import('./de.json');\n    } else if (code === 'ja') {\n        // @ts-ignore\n        return await import('./ja.json');\n    } else if (code === 'zh-CN') {\n        // @ts-ignore\n        return await import('./zh-CN.json');\n    }\n    throw new Error('unknown language code');\n};\n\nexport type TTranslationCode = \"switch-ui-left-right\" | // Switch left/right UI\n    \"toggle-show-tools\" | // Show/Hide Tools\n    \"scroll\" | // Scroll\n    \"donate\" | // Donate\n    \"home\" | // Home\n    \"modal-new-tab\" | // Open in new tab\n    \"tab-layers\" | // Layers\n    \"tab-edit\" | // Edit\n    \"tab-file\" | // File\n    \"tool-brush\" | // Brush\n    \"tool-paint-bucket\" | // Paint Bucket\n    \"tool-shape\" | // Shape\n    \"tool-text\" | // Text\n    \"tool-hand\" | // Hand Tool\n    \"tool-zoom\" | // Zoom\n    \"tool-undo-redo\" | // Undo / Redo\n    \"undo\" | // Undo\n    \"redo\" | // Redo\n    \"brush-pen\" | // Pen\n    \"brush-blend\" | // Blend\n    \"brush-sketchy\" | // Sketchy\n    \"brush-pixel\" | // Pixel\n    \"brush-chemy\" | // Chemy\n    \"brush-smudge\" | // Smudge\n    \"brush-size\" | // Size\n    \"brush-blending\" | // Blending\n    \"brush-toggle-pressure\" | // Toggle Pressure Sensitivity\n    \"brush-lock-alpha\" | // Lock Alpha\n    \"brush-lock-alpha-title\" | // Locks layer's alpha channel\n    \"brush-pen-circle\" | // Circle\n    \"brush-pen-chalk\" | // Chalk\n    \"brush-pen-calligraphy\" | // Calligraphy\n    \"brush-pen-square\" | // Square\n    \"brush-sketchy-scale\" | // Scale\n    \"brush-pixel-dither\" | // Dither\n    \"brush-chemy-fill\" | // Fill\n    \"brush-chemy-stroke\" | // Stroke\n    \"brush-chemy-mirror-x\" | // Horizontal Symmetry\n    \"brush-chemy-mirror-y\" | // Vertical Symmetry\n    \"brush-chemy-gradient\" | // Gradient\n    \"brush-eraser-transparent-bg\" | // Transparent Background\n    \"stabilizer\" | // Stabilizer\n    \"stabilizer-title\" | // Stroke Stabilizer\n    \"eyedropper\" | // Eyedropper\n    \"secondary-color\" | // Secondary Color\n    \"manual-color-input\" | // Manual Color Input\n    \"mci-hex\" | // Hex\n    \"mci-copy\" | // Copy\n    \"modal-ok\" | // Ok\n    \"modal-cancel\" | // Cancel\n    \"modal-close\" | // Close\n    \"layers-active-layer\" | // Active Layer\n    \"layers-layer\" | // Layer\n    \"layers-copy\" | // copy\n    \"layers-blending\" | // Blending\n    \"layers-new\" | // New Layer\n    \"layers-remove\" | // Remove Layer\n    \"layers-duplicate\" | // Duplicate Layer\n    \"layers-merge\" | // Merge with layer below\n    \"layers-rename\" | // Rename\n    \"layers-blend-normal\" | // normal\n    \"layers-blend-darken\" | // darken\n    \"layers-blend-multiply\" | // multiply\n    \"layers-blend-color-burn\" | // color burn\n    \"layers-blend-lighten\" | // lighten\n    \"layers-blend-screen\" | // screen\n    \"layers-blend-color-dodge\" | // color dodge\n    \"layers-blend-overlay\" | // overlay\n    \"layers-blend-soft-light\" | // soft light\n    \"layers-blend-hard-light\" | // hard light\n    \"layers-blend-difference\" | // difference\n    \"layers-blend-exclusion\" | // exclusion\n    \"layers-blend-hue\" | // hue\n    \"layers-blend-saturation\" | // saturation\n    \"layers-blend-color\" | // color\n    \"layers-blend-luminosity\" | // luminosity\n    \"layers-rename-title\" | // Rename Layer\n    \"layers-rename-name\" | // Name\n    \"layers-rename-clear\" | // Clear Name\n    \"layers-rename-sketch\" | // Sketch\n    \"layers-rename-colors\" | // Colors\n    \"layers-rename-lines\" | // Lines\n    \"layers-rename-foreground\" | // Foreground\n    \"layers-merge-modal-title\" | // Merge/Mix Layers\n    \"layers-merge-description\" | // Merges the selected layer with the one underneath. Select the mix mode:\n    \"file-no-autosave\" | // No autosave, no cloud storage\n    \"file-new\" | // New\n    \"file-import\" | // Import\n    \"file-save\" | // Save\n    \"file-save-png\" | // Save PNG\n    \"file-save-psd\" | // Save PSD\n    \"file-save-layers\" | // Save Layers\n    \"file-copy\" | // Copy\n    \"file-copy-title\" | // Copy To Clipboard\n    \"file-share\" | // Share\n    \"file-storage\" | // Browser Storage\n    \"file-storage-thumb-title\" | // Restores when reopening page\n    \"file-storage-about\" | // About Browser Storage\n    \"file-storage-cant-access\" | // Can't access\n    \"file-storage-empty\" | // Empty\n    \"file-storage-store\" | // Store\n    \"file-storage-clear\" | // Clear\n    \"file-storage-storing\" | // Storing\n    \"file-storage-overwrite\" | // Overwrite\n    \"file-storage-min-ago\" | // {x}min ago\n    \"file-storage-hours-ago\" | // {x}h ago\n    \"file-storage-days-ago\" | // {x}d ago\n    \"file-storage-month-ago\" | // > 1month ago\n    \"file-storage-restored\" | // Restored from Browser Storage\n    \"file-storage-stored\" | // Stored to Browser Storage\n    \"file-storage-failed\" | // Failed to store to Browser Storage\n    \"file-storage-failed-1\" | // Failed to store. Possible causes:\n    \"file-storage-failed-2\" | // Out of disk space\n    \"file-storage-failed-3\" | // Storage disabled in incognito tab\n    \"file-storage-failed-4\" | // Browser doesn't support storage\n    \"file-storage-failed-clear\" | // Failed to clear.\n    \"file-upload\" | // Upload\n    \"cleared-layer\" | // Cleared layer\n    \"filled\" | // Filled\n    \"new-title\" | // New Image\n    \"new-current\" | // Current\n    \"new-fit\" | // Fit\n    \"new-oversize\" | // Oversize\n    \"new-square\" | // Square\n    \"new-landscape\" | // Landscape\n    \"new-portrait\" | // Portrait\n    \"new-screen\" | // Screen\n    \"new-video\" | // Video\n    \"new-din-paper\" | // DIN Paper\n    \"new-px\" | // px\n    \"new-ratio\" | // Ratio\n    \"upload-title\" | // Upload to Imgur\n    \"upload-link-notice\" | // Anyone with the link to your uploaded image will be able to view it.\n    \"upload-name\" | // Title\n    \"upload-title-untitled\" | // Untitled\n    \"upload-caption\" | // Caption\n    \"upload-tos\" | // Terms of Service\n    \"upload-tos-2\" | // for imgur.com\n    \"upload-submit\" | // Upload\n    \"upload-uploading\" | // Uploading...\n    \"upload-success\" | // Upload Successful\n    \"upload-failed\" | // Upload failed.\n    \"upload-delete\" | // To delete your image from Imgur visit:\n    \"cropcopy-title-copy\" | // Copy To Clipboard\n    \"cropcopy-title-crop\" | // Crop\n    \"cropcopy-btn-copy\" | // To Clipboard\n    \"cropcopy-copied\" | // Copied.\n    \"cropcopy-btn-crop\" | // Apply Crop\n    \"crop-drag-to-crop\" | // Drag to crop\n    \"filter-crop-extend\" | // Crop/Extend\n    \"filter-flip\" | // Flip\n    \"filter-perspective\" | // Perspective\n    \"filter-resize\" | // Resize\n    \"filter-rotate\" | // Rotate\n    \"filter-transform\" | // Transform\n    \"filter-bright-contrast\" | // Bright/Contrast\n    \"filter-curves\" | // Curves\n    \"filter-hue-sat\" | // Hue/Saturation\n    \"filter-invert\" | // Invert\n    \"filter-tilt-shift\" | // Tilt Shift\n    \"filter-to-alpha\" | // To Alpha\n    \"filter-triangle-blur\" | // Triangle Blur\n    \"filter-unsharp-mask\" | // Unsharp Mask\n    \"filter-crop-title\" | // Crop / Extend\n    \"filter-crop-description\" | // Crop or extend the image.\n    \"filter-crop-left\" | // Left\n    \"filter-crop-right\" | // Right\n    \"filter-crop-top\" | // Top\n    \"filter-crop-bottom\" | // Bottom\n    \"filter-crop-rule-thirds\" | // Rule of Thirds\n    \"filter-crop-fill\" | // Fill\n    \"filter-flip-title\" | // Flip\n    \"filter-flip-description\" | // Flips layer or whole image.\n    \"filter-flip-horizontal\" | // Horizontal\n    \"filter-flip-vertical\" | // Vertical\n    \"filter-flip-image\" | // Flip Image\n    \"filter-flip-layer\" | // Flip Layer\n    \"filter-perspective-title\" | // Perspective\n    \"filter-perspective-description\" | // Transforms the selected layer.\n    \"filter-perspective-before\" | // Before\n    \"filter-perspective-after\" | // After\n    \"filter-resize-title\" | // Resize\n    \"filter-resize-description\" | // Resizes the image.\n    \"filter-rotate-title\" | // Rotate\n    \"filter-rotate-description\" | // Rotates the image.\n    \"filter-transform-empty\" | // Layer is empty.\n    \"filter-transform-title\" | // Transform\n    \"filter-transform-description\" | // Transforms selected layer. Hold Shift for additional behavior.\n    \"filter-transform-rotation\" | // Rotation\n    \"filter-transform-flip\" | // Flip\n    \"filter-transform-center\" | // Center\n    \"filter-transform-constrain\" | // Constrain\n    \"filter-transform-snap\" | // Snap\n    \"filter-transform-snap-title\" | // Snap Rotation And Position\n    \"filter-bright-contrast-title\" | // Brightness / Contrast\n    \"filter-bright-contrast-description\" | // Change brightness and contrast for the selected layer.\n    \"filter-bright-contrast-brightness\" | // Brightness\n    \"filter-bright-contrast-contrast\" | // Contrast\n    \"filter-curves-title\" | // Curves\n    \"filter-curves-description\" | // Apply curves on the selected layer.\n    \"filter-curves-all\" | // All\n    \"filter-hue-sat-title\" | // Hue / Saturation\n    \"filter-hue-sat-description\" | // Change hue and saturation for the selected layer.\n    \"filter-hue-sat-hue\" | // Hue\n    \"filter-hue-sat-saturation\" | // Saturation\n    \"filter-applied\" | // applied\n    \"filter-tilt-shift-title\" | // Tilt Shift\n    \"filter-tilt-shift-description\" | // Applies tilt shift on the selected layer.\n    \"filter-tilt-shift-blur\" | // Blur Radius\n    \"filter-tilt-shift-gradient\" | // Gradient Radius\n    \"filter-to-alpha-title\" | // To Alpha\n    \"filter-to-alpha-description\" | // Generates alpha channel for selected layer from:\n    \"filter-to-alpha-inverted-lum\" | // Inverted Luminance\n    \"filter-to-alpha-lum\" | // Luminance\n    \"filter-to-alpha-replace\" | // Replace RGB\n    \"filter-triangle-blur-title\" | // Triangle Blur\n    \"filter-triangle-blur-description\" | // Applies triangle blur on the selected layer.\n    \"filter-unsharp-mask-title\" | // Unsharp Mask\n    \"filter-unsharp-mask-description\" | // Sharpens the selected layer by scaling pixels away from the average of their neighbors.\n    \"filter-unsharp-mask-strength\" | // Strength\n    \"import-opening\" | // Opening file...\n    \"import-title\" | // Import Image\n    \"import-too-large\" | // Image too large, will be downscaled.\n    \"import-btn-as-layer\" | // As Layer\n    \"import-btn-as-image\" | // As Image\n    \"import-as-layer-title\" | // Import Image as New Layer\n    \"import-as-layer-description\" | // Adjust the position of the imported image.\n    \"import-as-layer-limit-reached\" | // Layer limit reached. Image will be placed on existing layer.\n    \"import-as-layer-fit\" | // Fit\n    \"import-flatten\" | // Flatten image\n    \"import-unsupported-file\" | // Unsupported file type. See Help for supported types.\n    \"import-broken-file\" | // Couldn't load image. File might be corrupted.\n    \"import-psd-unsupported\" | // Unsupported features. PSD had to be flattened.\n    \"import-psd-limited-support\" | // PSD support is limited. Flattened will more likely look correct.\n    \"import-psd-too-large\" | // Image exceeds maximum dimensions of {x} x {x} pixels. Unable to import.\n    \"import-psd-size\" | // Image size\n    \"hand-reset\" | // Reset\n    \"hand-fit\" | // Fit\n    \"bucket-tolerance\" | // Tolerance\n    \"bucket-sample\" | // Sample\n    \"bucket-sample-title\" | // Which layers to sample color from\n    \"bucket-sample-all\" | // All\n    \"bucket-sample-active\" | // Active\n    \"bucket-sample-above\" | // Above\n    \"bucket-grow\" | // Grow\n    \"bucket-grow-title\" | // Grow filled area (in pixels)\n    \"bucket-contiguous\" | // Contiguous\n    \"bucket-contiguous-title\" | // Only fill connected areas\n    \"shape-stroke\" | // Stroke\n    \"shape-fill\" | // Fill\n    \"shape-rect\" | // Rectangle\n    \"shape-ellipse\" | // Ellipse\n    \"shape-line\" | // Line\n    \"shape-line-width\" | // Line Width\n    \"shape-outwards\" | // Outwards\n    \"shape-fixed\" | // Fixed 1:1\n    \"shape-snap\" | // Snap\n    \"shape-snap-title\" | // 45° Angle Snapping\n    \"text-instruction\" | // Click canvas to place text\n    \"text-title\" | // Add Text\n    \"text-placeholder\" | // Your text (multiline Shift+Enter)\n    \"text-color\" | // Color\n    \"text-size\" | // Size\n    \"text-left\" | // Left\n    \"text-center\" | // Center\n    \"text-right\" | // Right\n    \"text-italic\" | // Italic\n    \"text-bold\" | // Bold\n    \"save-reminder-title\" | // Reminder to save\n    \"save-reminder-text\" | // Unsaved work may get lost.\n    \"submit\" | // Submit\n    \"submit-title\" | // Submit Drawing\n    \"submit-prompt\" | // Submit drawing?\n    \"submit-submitting\" | // Submitting\n    \"embed-init-loading\" | // Loading app\n    \"embed-init-waiting\" | // Waiting for image\n    \"unsaved\" | // Unsaved\n    \"help\" | // Help\n    \"tab-settings\" | // Settings\n    \"settings-language\" | // Language\n    \"settings-preferred-language\" | // Preferred Language\n    \"settings-language-reload\" | // Will update after reloading.\n    \"licenses\" | // Licenses\n    \"source-code\" | // Source Code\n    \"auto\" | // auto\n    \"zoom-in\" | // Zoom In\n    \"zoom-out\" | // Zoom Out\n    \"radius\" | // Radius\n    \"constrain-proportions\" | // Constrain Proportions\n    \"width\" | // Width\n    \"height\" | // Height\n    \"opacity\" | // Opacity\n    \"red\" | // Red\n    \"green\" | // Green\n    \"blue\" | // Blue\n    \"eraser\" | // Eraser\n    \"center\" | // Center\n    \"background\" | // Background\n    \"scaling-algorithm\" | // Scaling Algorithm\n    \"algorithm-smooth\" | // Smooth\n    \"algorithm-pixelated\" | // Pixelated\n    \"preview\"; // Preview\n","{\"switch-ui-left-right\":\"Switch left/right UI\",\"toggle-show-tools\":\"Show/Hide Tools\",\"scroll\":\"Scroll\",\"donate\":\"Donate\",\"home\":\"Home\",\"modal-new-tab\":\"Open in new tab\",\"tab-layers\":\"Layers\",\"tab-edit\":\"Edit\",\"tab-file\":\"File\",\"tool-brush\":\"Brush\",\"tool-paint-bucket\":\"Paint Bucket\",\"tool-shape\":\"Shape\",\"tool-text\":\"Text\",\"tool-hand\":\"Hand Tool\",\"tool-zoom\":\"Zoom\",\"tool-undo-redo\":\"Undo / Redo\",\"undo\":\"Undo\",\"redo\":\"Redo\",\"brush-pen\":\"Pen\",\"brush-blend\":\"Blend\",\"brush-sketchy\":\"Sketchy\",\"brush-pixel\":\"Pixel\",\"brush-chemy\":\"Chemy\",\"brush-smudge\":\"Smudge\",\"brush-size\":\"Size\",\"brush-blending\":\"Blending\",\"brush-toggle-pressure\":\"Toggle Pressure Sensitivity\",\"brush-lock-alpha\":\"Lock Alpha\",\"brush-lock-alpha-title\":\"Locks layer's alpha channel\",\"brush-pen-circle\":\"Circle\",\"brush-pen-chalk\":\"Chalk\",\"brush-pen-calligraphy\":\"Calligraphy\",\"brush-pen-square\":\"Square\",\"brush-sketchy-scale\":\"Scale\",\"brush-pixel-dither\":\"Dither\",\"brush-chemy-fill\":\"Fill\",\"brush-chemy-stroke\":\"Stroke\",\"brush-chemy-mirror-x\":\"Horizontal Symmetry\",\"brush-chemy-mirror-y\":\"Vertical Symmetry\",\"brush-chemy-gradient\":\"Gradient\",\"brush-eraser-transparent-bg\":\"Transparent Background\",\"stabilizer\":\"Stabilizer\",\"stabilizer-title\":\"Stroke Stabilizer\",\"eyedropper\":\"Eyedropper\",\"secondary-color\":\"Secondary Color\",\"manual-color-input\":\"Manual Color Input\",\"mci-hex\":\"Hex\",\"mci-copy\":\"Copy\",\"modal-ok\":\"Ok\",\"modal-cancel\":\"Cancel\",\"modal-close\":\"Close\",\"layers-active-layer\":\"Active Layer\",\"layers-layer\":\"Layer\",\"layers-copy\":\"copy\",\"layers-blending\":\"Blending\",\"layers-new\":\"New Layer\",\"layers-remove\":\"Remove Layer\",\"layers-duplicate\":\"Duplicate Layer\",\"layers-merge\":\"Merge with layer below\",\"layers-rename\":\"Rename\",\"layers-blend-normal\":\"normal\",\"layers-blend-darken\":\"darken\",\"layers-blend-multiply\":\"multiply\",\"layers-blend-color-burn\":\"color burn\",\"layers-blend-lighten\":\"lighten\",\"layers-blend-screen\":\"screen\",\"layers-blend-color-dodge\":\"color dodge\",\"layers-blend-overlay\":\"overlay\",\"layers-blend-soft-light\":\"soft light\",\"layers-blend-hard-light\":\"hard light\",\"layers-blend-difference\":\"difference\",\"layers-blend-exclusion\":\"exclusion\",\"layers-blend-hue\":\"hue\",\"layers-blend-saturation\":\"saturation\",\"layers-blend-color\":\"color\",\"layers-blend-luminosity\":\"luminosity\",\"layers-rename-title\":\"Rename Layer\",\"layers-rename-name\":\"Name\",\"layers-rename-clear\":\"Clear Name\",\"layers-rename-sketch\":\"Sketch\",\"layers-rename-colors\":\"Colors\",\"layers-rename-lines\":\"Lines\",\"layers-rename-foreground\":\"Foreground\",\"layers-merge-modal-title\":\"Merge/Mix Layers\",\"layers-merge-description\":\"Merges the selected layer with the one underneath. Select the mix mode:\",\"file-no-autosave\":\"No autosave, no cloud storage\",\"file-new\":\"New\",\"file-import\":\"Import\",\"file-save\":\"Save\",\"file-save-png\":\"Save PNG\",\"file-save-psd\":\"Save PSD\",\"file-save-layers\":\"Save Layers\",\"file-copy\":\"Copy\",\"file-copy-title\":\"Copy To Clipboard\",\"file-share\":\"Share\",\"file-storage\":\"Browser Storage\",\"file-storage-thumb-title\":\"Restores when reopening page\",\"file-storage-about\":\"About Browser Storage\",\"file-storage-cant-access\":\"Can't access\",\"file-storage-empty\":\"Empty\",\"file-storage-store\":\"Store\",\"file-storage-clear\":\"Clear\",\"file-storage-storing\":\"Storing\",\"file-storage-overwrite\":\"Overwrite\",\"file-storage-min-ago\":\"{x}min ago\",\"file-storage-hours-ago\":\"{x}h ago\",\"file-storage-days-ago\":\"{x}d ago\",\"file-storage-month-ago\":\"> 1month ago\",\"file-storage-restored\":\"Restored from Browser Storage\",\"file-storage-stored\":\"Stored to Browser Storage\",\"file-storage-failed\":\"Failed to store to Browser Storage\",\"file-storage-failed-1\":\"Failed to store. Possible causes:\",\"file-storage-failed-2\":\"Out of disk space\",\"file-storage-failed-3\":\"Storage disabled in incognito tab\",\"file-storage-failed-4\":\"Browser doesn't support storage\",\"file-storage-failed-clear\":\"Failed to clear.\",\"file-upload\":\"Upload\",\"cleared-layer\":\"Cleared layer\",\"filled\":\"Filled\",\"new-title\":\"New Image\",\"new-current\":\"Current\",\"new-fit\":\"Fit\",\"new-oversize\":\"Oversize\",\"new-square\":\"Square\",\"new-landscape\":\"Landscape\",\"new-portrait\":\"Portrait\",\"new-screen\":\"Screen\",\"new-video\":\"Video\",\"new-din-paper\":\"DIN Paper\",\"new-px\":\"px\",\"new-ratio\":\"Ratio\",\"upload-title\":\"Upload to Imgur\",\"upload-link-notice\":\"Anyone with the link to your uploaded image will be able to view it.\",\"upload-name\":\"Title\",\"upload-title-untitled\":\"Untitled\",\"upload-caption\":\"Caption\",\"upload-tos\":\"Terms of Service\",\"upload-tos-2\":\"for imgur.com\",\"upload-submit\":\"Upload\",\"upload-uploading\":\"Uploading...\",\"upload-success\":\"Upload Successful\",\"upload-failed\":\"Upload failed.\",\"upload-delete\":\"To delete your image from Imgur visit:\",\"cropcopy-title-copy\":\"Copy To Clipboard\",\"cropcopy-title-crop\":\"Crop\",\"cropcopy-btn-copy\":\"To Clipboard\",\"cropcopy-copied\":\"Copied.\",\"cropcopy-btn-crop\":\"Apply Crop\",\"crop-drag-to-crop\":\"Drag to crop\",\"filter-crop-extend\":\"Crop/Extend\",\"filter-flip\":\"Flip\",\"filter-perspective\":\"Perspective\",\"filter-resize\":\"Resize\",\"filter-rotate\":\"Rotate\",\"filter-transform\":\"Transform\",\"filter-bright-contrast\":\"Bright/Contrast\",\"filter-curves\":\"Curves\",\"filter-hue-sat\":\"Hue/Saturation\",\"filter-invert\":\"Invert\",\"filter-tilt-shift\":\"Tilt Shift\",\"filter-to-alpha\":\"To Alpha\",\"filter-triangle-blur\":\"Triangle Blur\",\"filter-unsharp-mask\":\"Unsharp Mask\",\"filter-crop-title\":\"Crop / Extend\",\"filter-crop-description\":\"Crop or extend the image.\",\"filter-crop-left\":\"Left\",\"filter-crop-right\":\"Right\",\"filter-crop-top\":\"Top\",\"filter-crop-bottom\":\"Bottom\",\"filter-crop-rule-thirds\":\"Rule of Thirds\",\"filter-crop-fill\":\"Fill\",\"filter-flip-title\":\"Flip\",\"filter-flip-description\":\"Flips layer or whole image.\",\"filter-flip-horizontal\":\"Horizontal\",\"filter-flip-vertical\":\"Vertical\",\"filter-flip-image\":\"Flip Image\",\"filter-flip-layer\":\"Flip Layer\",\"filter-perspective-title\":\"Perspective\",\"filter-perspective-description\":\"Transforms the selected layer.\",\"filter-perspective-before\":\"Before\",\"filter-perspective-after\":\"After\",\"filter-resize-title\":\"Resize\",\"filter-resize-description\":\"Resizes the image.\",\"filter-rotate-title\":\"Rotate\",\"filter-rotate-description\":\"Rotates the image.\",\"filter-transform-empty\":\"Layer is empty.\",\"filter-transform-title\":\"Transform\",\"filter-transform-description\":\"Transforms selected layer. Hold Shift for additional behavior.\",\"filter-transform-rotation\":\"Rotation\",\"filter-transform-flip\":\"Flip\",\"filter-transform-center\":\"Center\",\"filter-transform-constrain\":\"Constrain\",\"filter-transform-snap\":\"Snap\",\"filter-transform-snap-title\":\"Snap Rotation And Position\",\"filter-bright-contrast-title\":\"Brightness / Contrast\",\"filter-bright-contrast-description\":\"Change brightness and contrast for the selected layer.\",\"filter-bright-contrast-brightness\":\"Brightness\",\"filter-bright-contrast-contrast\":\"Contrast\",\"filter-curves-title\":\"Curves\",\"filter-curves-description\":\"Apply curves on the selected layer.\",\"filter-curves-all\":\"All\",\"filter-hue-sat-title\":\"Hue / Saturation\",\"filter-hue-sat-description\":\"Change hue and saturation for the selected layer.\",\"filter-hue-sat-hue\":\"Hue\",\"filter-hue-sat-saturation\":\"Saturation\",\"filter-applied\":\"applied\",\"filter-tilt-shift-title\":\"Tilt Shift\",\"filter-tilt-shift-description\":\"Applies tilt shift on the selected layer.\",\"filter-tilt-shift-blur\":\"Blur Radius\",\"filter-tilt-shift-gradient\":\"Gradient Radius\",\"filter-to-alpha-title\":\"To Alpha\",\"filter-to-alpha-description\":\"Generates alpha channel for selected layer from:\",\"filter-to-alpha-inverted-lum\":\"Inverted Luminance\",\"filter-to-alpha-lum\":\"Luminance\",\"filter-to-alpha-replace\":\"Replace RGB\",\"filter-triangle-blur-title\":\"Triangle Blur\",\"filter-triangle-blur-description\":\"Applies triangle blur on the selected layer.\",\"filter-unsharp-mask-title\":\"Unsharp Mask\",\"filter-unsharp-mask-description\":\"Sharpens the selected layer by scaling pixels away from the average of their neighbors.\",\"filter-unsharp-mask-strength\":\"Strength\",\"import-opening\":\"Opening file...\",\"import-title\":\"Import Image\",\"import-too-large\":\"Image too large, will be downscaled.\",\"import-btn-as-layer\":\"As Layer\",\"import-btn-as-image\":\"As Image\",\"import-as-layer-title\":\"Import Image as New Layer\",\"import-as-layer-description\":\"Adjust the position of the imported image.\",\"import-as-layer-limit-reached\":\"Layer limit reached. Image will be placed on existing layer.\",\"import-as-layer-fit\":\"Fit\",\"import-flatten\":\"Flatten image\",\"import-unsupported-file\":\"Unsupported file type. See Help for supported types.\",\"import-broken-file\":\"Couldn't load image. File might be corrupted.\",\"import-psd-unsupported\":\"Unsupported features. PSD had to be flattened.\",\"import-psd-limited-support\":\"PSD support is limited. Flattened will more likely look correct.\",\"import-psd-too-large\":\"Image exceeds maximum dimensions of {x} x {x} pixels. Unable to import.\",\"import-psd-size\":\"Image size\",\"hand-reset\":\"Reset\",\"hand-fit\":\"Fit\",\"bucket-tolerance\":\"Tolerance\",\"bucket-sample\":\"Sample\",\"bucket-sample-title\":\"Which layers to sample color from\",\"bucket-sample-all\":\"All\",\"bucket-sample-active\":\"Active\",\"bucket-sample-above\":\"Above\",\"bucket-grow\":\"Grow\",\"bucket-grow-title\":\"Grow filled area (in pixels)\",\"bucket-contiguous\":\"Contiguous\",\"bucket-contiguous-title\":\"Only fill connected areas\",\"shape-stroke\":\"Stroke\",\"shape-fill\":\"Fill\",\"shape-rect\":\"Rectangle\",\"shape-ellipse\":\"Ellipse\",\"shape-line\":\"Line\",\"shape-line-width\":\"Line Width\",\"shape-outwards\":\"Outwards\",\"shape-fixed\":\"Fixed 1:1\",\"shape-snap\":\"Snap\",\"shape-snap-title\":\"45° Angle Snapping\",\"text-instruction\":\"Click canvas to place text\",\"text-title\":\"Add Text\",\"text-placeholder\":\"Your text (multiline Shift+Enter)\",\"text-color\":\"Color\",\"text-size\":\"Size\",\"text-left\":\"Left\",\"text-center\":\"Center\",\"text-right\":\"Right\",\"text-italic\":\"Italic\",\"text-bold\":\"Bold\",\"save-reminder-title\":\"Reminder to save\",\"save-reminder-text\":\"Unsaved work may get lost.\",\"submit\":\"Submit\",\"submit-title\":\"Submit Drawing\",\"submit-prompt\":\"Submit drawing?\",\"submit-submitting\":\"Submitting\",\"embed-init-loading\":\"Loading app\",\"embed-init-waiting\":\"Waiting for image\",\"unsaved\":\"Unsaved\",\"help\":\"Help\",\"tab-settings\":\"Settings\",\"settings-language\":\"Language\",\"settings-preferred-language\":\"Preferred Language\",\"settings-language-reload\":\"Will update after reloading.\",\"licenses\":\"Licenses\",\"source-code\":\"Source Code\",\"auto\":\"auto\",\"zoom-in\":\"Zoom In\",\"zoom-out\":\"Zoom Out\",\"radius\":\"Radius\",\"constrain-proportions\":\"Constrain Proportions\",\"width\":\"Width\",\"height\":\"Height\",\"opacity\":\"Opacity\",\"red\":\"Red\",\"green\":\"Green\",\"blue\":\"Blue\",\"eraser\":\"Eraser\",\"center\":\"Center\",\"background\":\"Background\",\"scaling-algorithm\":\"Scaling Algorithm\",\"algorithm-smooth\":\"Smooth\",\"algorithm-pixelated\":\"Pixelated\",\"preview\":\"Preview\"}","// @ts-ignore\nimport {english, languages, loadLanguage, TTranslationCode} from '../../languages/languages';\n\nexport const LS_LANGUAGE_KEY = 'klecks-language';\n\nexport class LanguageStrings {\n    private data: any;\n    private listeners: (() => void)[] = [];\n    private code: string;\n\n    // --- public ----\n    constructor () {\n        // need to use setLanguage for a different language\n        this.data = {...english};\n        this.code = 'en';\n    }\n\n    async setLanguage (langCode: string): Promise<void> {\n        if (langCode === 'en') {\n            this.data = {...english};\n        } else {\n            this.data = {...english, ...(await loadLanguage(langCode))};\n        }\n        this.code = langCode;\n        document.documentElement.setAttribute(\"lang\", langCode);\n        this.listeners.forEach(item => {\n            item();\n        });\n    }\n\n    get (code: TTranslationCode): string {\n        if (!(code in this.data)) {\n            throw new Error('translation code doesn\\'t exist: ' + code);\n        }\n        return this.data[code];\n    }\n\n    getLanguage (): {code: string; name: string} {\n        return languages.find(item => {\n            return item.code === this.code;\n        })\n    }\n\n    getCode (): string {\n        return this.code;\n    }\n\n    // get notified on language change\n    subscribe (subscriber: () => void) {\n        if (this.listeners.includes(subscriber)) {\n            return;\n        }\n        this.listeners.push(subscriber);\n    }\n\n    unsubscribe (subscriber: () => void) {\n        for (let i = 0; i < this.listeners.length; i++) {\n            if (subscriber === this.listeners[i]) {\n                this.listeners.splice(i, 1);\n                return;\n            }\n        }\n    }\n}\n\nlet activeLanguageCode: string = 'en'; // active language code\n{\n    const langs: string[] = []; // from highest to lowest priority\n    const navLangs = navigator.languages ? navigator.languages : [navigator.language];\n    navLangs.forEach(item => {\n        const split = item.split('-');\n        langs.push(item);\n        if (split.length === 2) {\n            langs.push(split[0]);\n        }\n    });\n    try {\n        if (localStorage.getItem(LS_LANGUAGE_KEY)) {\n            langs.unshift(localStorage.getItem(LS_LANGUAGE_KEY));\n        }\n    } catch (e) {\n        // likely cookies disabled in Safari\n    }\n    for (let i = 0; i < langs.length; i++) {\n        const lang = langs[i];\n        if (languages.find(item => {\n            return item.code.toLowerCase() === lang.toLowerCase();\n        })) {\n            activeLanguageCode = lang;\n            break;\n        }\n    }\n}\n\nexport const languageStrings = new LanguageStrings();\n\nexport const LANG = (code: TTranslationCode | null, replace?: {[key: string]: string}): string => {\n    if (replace) {\n        let result = languageStrings.get(code);\n        const keyArr = Object.keys(replace);\n        keyArr.forEach(key => {\n            result = result.replace(`{${key}}`, replace[key]);\n        });\n        return result;\n    } else {\n        return languageStrings.get(code);\n    }\n};\n\nexport const initLANG = () => languageStrings.setLanguage(activeLanguageCode);","import {dialogCounter} from './modal-count';\nimport {BB} from '../../../bb/bb';\n// @ts-ignore\nimport checkImg from 'url:~/src/app/img/ui/check.svg';\n// @ts-ignore\nimport cancelImg from 'url:~/src/app/img/ui/cancel.svg';\nimport {LANG} from '../../../language/language';\nimport {IKeyString} from '../../../bb/bb.types';\n\nwindow.onscroll = (e) => {\n    e.preventDefault();\n}\n\nexport function popup (\n    p: {\n        target: HTMLElement;\n        div?: HTMLElement; // node with content\n        message: string; // can be html\n        callback?: (result: string) => void;\n        buttons?: string[]; // \"Ok\", and \"Cancel\" will be automatically translated\n        primaries?: string[];\n        type?: 'error' | 'warning' | 'upload' | 'ok'; // todo\n        closefunc?: (f: () => void) => void; // returns a function you can call to close (Cancel) the dialog\n        style?: IKeyString;\n        clickOnEnter?: string; // name of button - will be clicked if enter key pressed\n        autoFocus?: false | string; // name of  to automatically focus - default 'Ok' - false -> none\n        ignoreBackground?: boolean; // deafult false; if true clicking on background doesn't close\n    }\n): void {\n    dialogCounter.increase();\n    let isClosed = false;\n\n\n    // need this extra layer because chrome mobile otherwise scrolls the page and then glitches as the address bar goes away\n    const rootRootEl = BB.el({\n        parent: document.body,\n        css: {\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            right: '0',\n            bottom: '0',\n            overflow: 'hidden',\n        }\n    });\n    const rootEl = BB.el({\n        parent: rootRootEl,\n        className: 'kl-popup',\n    });\n\n    const scrollContent = BB.el({\n        parent: rootEl,\n        css: {\n            width: '100%',\n            minHeight: '100%',\n            // padding: '10px 0',\n            position: 'relative',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center',\n        }\n    });\n\n    const bgEl = BB.el({\n        parent: scrollContent,\n        onClick: () => {\n            if (p.ignoreBackground) {\n                return;\n            }\n            close('Cancel');\n        },\n        css: {\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            zIndex: '0',\n            width: '100%',\n            height: '100%',\n        }\n    });\n\n    const titleHeight = 40;\n    const xButton = BB.el({\n        tagName: 'button',\n        className: 'popup-x',\n        content: `<img alt=\"${LANG('modal-close')}\" height=\"20\" src=\"${cancelImg}\">`,\n        title: LANG('modal-close'),\n        onClick: () => {\n            close('Cancel');\n        },\n        css: {\n            width: titleHeight + 'px',\n            height: titleHeight + 'px',\n            lineHeight: titleHeight + 'px',\n            position: 'absolute',\n            right: '0',\n            top: '0',\n            background: 'none',\n            boxShadow: 'none',\n        }\n    });\n\n    const boxClasses = ['kl-popup-box'];\n    boxClasses.push('kl-popup-box--sm');\n    const boxEl = BB.el({\n        content: [\n            xButton,\n            BB.el({\n                content:p.message,\n                css: {\n                    marginBottom: p.div ? '10px' : null,\n                    marginRight: '15px',\n                }\n            }),\n            p.div,\n        ],\n        className: boxClasses.join(' '),\n        css: p.style ? p.style : null,\n    });\n\n    scrollContent.append(\n        BB.el({\n            css: {\n                flex: '0.5',\n            }\n        }),\n        boxEl,\n        BB.el({\n            css: {\n                flex: '1',\n            }\n        })\n    );\n\n    if (p.type === 'error') {\n        BB.addClassName(boxEl, 'poperror');\n    }\n    if (p.type === 'ok') {\n        BB.addClassName(boxEl, 'popok');\n    }\n    if (p.type === 'warning') {\n        BB.addClassName(boxEl, 'popwarning');\n    }\n    if (p.type === 'upload') {\n        BB.addClassName(boxEl, 'popupload');\n    }\n\n    const keyListener = new BB.KeyListener({\n        onDown: function(keyStr, e, comboStr) {\n            if (isClosed) {\n                return;\n            }\n            if (clickOnEnterBtn && comboStr === 'enter' && !BB.isInputFocused()) {\n                e.stopPropagation();\n                setTimeout(function() {\n                    clickOnEnterBtn.click();\n                }, 10);\n            }\n            if (comboStr === 'esc') {\n                e.stopPropagation();\n                close('Cancel');\n            }\n        }\n    });\n    // prevent ctrl scroll -> zooming page\n    const wheelPrevent = (event) => {\n        if (keyListener.isPressed('ctrl')) {\n            event.preventDefault();\n        }\n    };\n    BB.addEventListener(rootEl, 'wheel', wheelPrevent);\n    rootEl.onclick = BB.handleClick;\n\n    let autoFocus = null;\n    if (p.autoFocus) {\n        autoFocus = p.autoFocus;\n    } else if (p.autoFocus === false) {\n        autoFocus = null;\n    } else {\n        autoFocus = 'Ok';\n    }\n\n    const buttonRowEl = p.buttons && p.buttons.length > 0 ? BB.el({\n        parent: boxEl,\n        css: {\n            display: 'flex',\n            flexWrap: 'wrap',\n            justifyContent: 'flex-end',\n            marginTop: '12px', // 8px already via buttons\n            marginLeft: '-8px',\n        }\n    }) : null;\n    let clickOnEnterBtn;\n    const btnElArr = [];\n    if (p.buttons) {\n        p.buttons.forEach(buttonName => {\n            const btnClasses = ['kl-popup__btn'];\n            if (buttonName === 'Ok' || (p.primaries && p.primaries.includes(buttonName))) {\n                btnClasses.push('kl-button-primary');\n            }\n            let iconUrl;\n            let label = buttonName;\n            if (buttonName === 'Ok') {\n                label = LANG('modal-ok');\n                iconUrl = checkImg;\n            }\n            if (buttonName === 'Cancel') {\n                label = LANG('modal-cancel');\n                iconUrl = cancelImg;\n            }\n            let iconImg = null;\n            if (iconUrl) {\n                iconImg = BB.el({\n                    tagName: 'img',\n                    custom: {\n                        src: iconUrl,\n                        height: '17',\n                    }\n                });\n            }\n            const btn = BB.el({\n                parent: buttonRowEl,\n                tagName: 'button',\n                className: btnClasses.join(' '),\n                content: [iconImg, label],\n                onClick: () => {\n                    close(buttonName);\n                },\n            });\n            btnElArr.push(btn);\n            if (autoFocus === buttonName) {\n                setTimeout(() => {\n                    btn.focus();\n                    rootEl.scrollTo(0, 0);\n                }, 10);\n                setTimeout(() => {\n                    // safari needs a separate timeout\n                    rootEl.scrollTo(0, 0);\n                }, 20);\n            }\n            if (buttonName === p.clickOnEnter) {\n                clickOnEnterBtn = btn;\n            }\n        });\n    }\n\n    function close (value: string) {\n        if (isClosed) {\n            return;\n        }\n\n        isClosed = true;\n        BB.clearSelection();\n        document.body.removeChild(rootRootEl);\n        dialogCounter.decrease();\n        BB.destroyEl(xButton);\n        BB.destroyEl(bgEl);\n        keyListener.destroy();\n        BB.removeEventListener(rootEl, 'wheel', wheelPrevent);\n        rootEl.onclick = null;\n        btnElArr.forEach(item => {\n            BB.destroyEl(item);\n        });\n        btnElArr.splice(0, btnElArr.length);\n\n        if (p.callback) {\n            p.callback(value);\n        }\n    }\n\n    if (p.closefunc) {\n        p.closefunc(function () {\n            close('Cancel');\n        });\n    }\n\n}\n\n\n/**\n * popups that fill whole height, with some padding.\n * currently only used for iframe popups.\n *\n * p = {\n *      title: DOM Element | string, // optional (todo allow string)\n *      icon: 'ok', // optional todo\n *      content: DOM Element, // optional\n *      buttonArr: [ // optional todo\n *          'Ok',\n *          'Cancel'\n *      ],\n *      autoFocus: string | false, //todo\n *      clickOnEnter: string, //todo\n *      onClose: function(result: string), // optional (todo result)\n *\n *      //size and position\n *      width: 500,\n *      isMaxHeight: boolean //todo, currently always true\n * }\n *\n * @param p\n * @constructor\n */\nexport const Popup = function(p) {\n    dialogCounter.increase();\n    const parent = document.body;\n    const div = BB.el({\n        parent: parent,\n        className: 'g-root',\n        css: {\n            position: 'fixed',\n            left: '0',\n            top: '0',\n            bottom: '0',\n            right: '0',\n            background: 'rgba(0, 0, 0, 0.45)',\n            overflow: 'auto',\n            animationName: 'consoleIn',\n            animationDuration: '0.3s',\n            animationTimingFunction: 'ease-out'\n        }\n    });\n    div.onclick = BB.handleClick;\n\n    let updateInterval;\n\n    function close() {\n        dialogCounter.decrease();\n        div.onclick = null;\n        parent.removeChild(div);\n        clearInterval(updateInterval);\n        window.removeEventListener('resize', updatePos);\n        keyListener.destroy();\n        BB.destroyEl(xButton);\n        BB.destroyEl(bgEl);\n        if (p.onClose) {\n            p.onClose();\n        }\n    }\n\n    //background element registering clicks\n    const bgEl = BB.el({\n        parent: div,\n        css: {\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            bottom: '0',\n            right: '0'\n        },\n        onClick: close\n    });\n\n    //the actual popup box\n    const popupEl = BB.el({\n        parent: div,\n        css: {\n            position: 'absolute',\n            width: (BB.isCssMinMaxSupported() ?\n                'min(calc(100% - 40px), ' + (p.width ? p.width : 400) + 'px)' :\n                (p.width ? p.width : 400) + 'px'),\n            height: 'calc(100% - 40px)',\n            background: '#eee',\n            borderRadius: '10px',\n            overflow: 'hidden',\n            boxShadow: 'rgba(0, 0, 0, 0.25) 0px 5px 60px'\n        }\n    });\n\n    //x and y position via script. flex not powerful enough imo\n    function updatePos() {\n        const elW = popupEl.offsetWidth;\n        const elH = popupEl.offsetHeight;\n\n        BB.css(popupEl, {\n            left: Math.max(0, (window.innerWidth - elW) / 2) + 'px',\n            top: Math.max(20, (window.innerHeight - elH) / 2 - (elH * 0.20)) + 'px'\n        });\n    }\n    //todo also update when popup changes size - resizeobserver and fallback\n    //updateInterval = setInterval(updatePos, 100);\n    updatePos();\n    window.addEventListener('resize', updatePos);\n\n    //title row in popup\n    const titleHeight = 40;\n    const titleEl = BB.el({\n        parent: popupEl,\n        css: {\n            height: titleHeight + 'px',\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            paddingLeft: (titleHeight / 2) + 'px'\n        }\n    });\n    if (p.title) {\n        titleEl.appendChild(p.title);\n    }\n    const xButton = BB.el({\n        parent: titleEl,\n        tagName: 'button',\n        className: 'popup-x',\n        content: `<img alt=\"${LANG('modal-close')}\" height=\"20\" src=\"${cancelImg}\">`,\n        title: LANG('modal-close'),\n        onClick: close,\n        css: {\n            width: titleHeight + 'px',\n            height: titleHeight + 'px',\n            lineHeight: titleHeight + 'px',\n            background: 'none',\n            boxShadow: 'none',\n        },\n        custom: {\n            tabindex: '0',\n        }\n    });\n\n    const contentEl = BB.el({\n        parent: popupEl,\n        css: {\n            height: 'calc(100% - ' + titleHeight + 'px)'\n        }\n    });\n    if (p.content) {\n        contentEl.appendChild(p.content);\n    }\n\n    const keyListener = new BB.KeyListener({\n        onDown: function(keyStr, e) {\n            if (keyStr === 'esc') {\n                e.stopPropagation();\n                close();\n            }\n        }\n    });\n\n\n    // --- interface ---\n    this.close = function() {\n        close();\n    };\n};","import {BB} from '../../../bb/bb';\n\n/**\n * Checkbox - with label\n */\nexport class Checkbox {\n\n    private element: HTMLElement;\n    private check: HTMLInputElement;\n\n    // --- public ---\n\n    constructor (params: {\n        init?: boolean; // default false\n        label: string;\n        callback: (boolean) => void;\n        allowTab?: boolean; // default false\n        title?: string;\n        doHighlight?: boolean; // default false\n        css?: any;\n    }) {\n        this.element = BB.el({\n            className: 'kl-checkbox'\n        });\n\n        const innerEl = BB.el({\n            parent: this.element,\n            tagName: 'label',\n            className: 'kl-checkbox__inner'\n        });\n\n        this.check = BB.el({\n            parent: innerEl,\n            tagName: 'input',\n            css: {\n                marginLeft: '0',\n                display: 'inline-block'\n            },\n            custom: {\n                type: 'checkbox'\n            }\n        }) as HTMLInputElement;\n        this.check.checked = params.init;\n        if (params.doHighlight && this.check.checked) {\n            BB.addClassName(this.element, 'kl-checkbox--highlight');\n        }\n        if (!params.allowTab) {\n            this.check.tabIndex = -1;\n        }\n\n        if (params.title) {\n            innerEl.title = params.title;\n        }\n\n        const label = document.createElement('div');\n        label.style.display = 'inline-block';\n        label.innerHTML = params.label;\n        (label as any).allowClick = true;\n        innerEl.appendChild(label);\n\n        this.check.onchange = () => {\n            if (params.doHighlight) {\n                if (this.check.checked) {\n                    BB.addClassName(this.element, 'kl-checkbox--highlight');\n                } else {\n                    BB.removeClassName(this.element, 'kl-checkbox--highlight');\n                }\n            }\n            params.callback(this.check.checked);\n            setTimeout(() => {\n                this.check.blur();\n            }, 0);\n        };\n        if (params.css) {\n            BB.css(this.element, params.css);\n        }\n    }\n\n    getValue(): boolean {\n        return this.check.checked;\n    }\n\n    getElement(): HTMLElement {\n        return this.element;\n    }\n\n    destroy() {\n        this.check.onchange = null;\n    }\n\n}\n","import {BB} from '../../../bb/bb';\nimport {IKeyString} from '../../../bb/bb.types';\n\nexport const input = function (params: {\n    type?: 'button' | 'checkbox' | 'number' | 'text'; // default text\n    min?: number;\n    max?: number;\n    callback: (val: string) => void;\n    init: string | number;\n    css?: IKeyString;\n}) {\n    const result = document.createElement('input');\n    if (params.type) {\n        try {\n            result.type = params.type;\n        } catch(e) {} // ie can't deal with number\n    } else {\n        result.type = 'text';\n    }\n    if (params.min !== undefined) {\n        result.min = '' + params.min;\n    }\n    if (params.max !== undefined) {\n        result.max = '' + params.max;\n    }\n    result.value = '' + params.init;\n    if (params.callback) {\n        result.onchange = function() {\n            params.callback(result.value);\n        };\n    }\n    if (params.css) {\n        BB.css(result, params.css);\n    }\n\n    return result;\n};","import {BB} from '../../../bb/bb';\nimport {IKeyString} from '../../../bb/bb.types';\n\n/**\n * A select dropdown\n */\nexport class Select {\n\n    private selectEl: HTMLSelectElement;\n    private optionArr: ([string, string] | null)[]; // [value, label]\n    private changeListener: (event) => void;\n    private onChange: (val: string) => void;\n\n    \n    // --- public ---\n    constructor (p: {\n        isFocusable?: boolean; // default false\n        optionArr: ([string, string] | null)[], // [value, label]\n        initValue?: string; // default null\n        onChange: (val: string) => void;\n        css?: IKeyString;\n        title?: string;\n    }) {\n        this.selectEl = BB.el({\n            tagName: 'select',\n            title: p.title,\n            css: {\n                cursor: 'pointer',\n                fontSize: '15px',\n                padding: '3px',\n                background: '#fff', // makes safari pay attention to font-size\n                //webkitAppearance: 'none'\n                colorScheme: 'only light', // chrome doesn't properly invert the text color\n            }\n        }) as HTMLSelectElement;\n        if (p.css) {\n            BB.css(this.selectEl, p.css);\n        }\n\n        const isFocusable = p.isFocusable;\n        if (!isFocusable) {\n            this.selectEl.tabIndex = -1;\n        }\n        this.optionArr = p.optionArr;\n        for (let i = 0; i < this.optionArr.length; i++) {\n            if (this.optionArr[i] === null) {\n                continue;\n            }\n            const option = document.createElement('option');\n            option.value = this.optionArr[i][0];\n            option.textContent = this.optionArr[i][1];\n            this.selectEl.append(option);\n        }\n        this.onChange = p.onChange;\n        this.changeListener = (e) => {\n            if (!isFocusable) {\n                this.selectEl.blur();\n            }\n            this.onChange(this.selectEl.value);\n        };\n        this.selectEl.addEventListener('change', this.changeListener);\n        this.selectEl.value = 'initValue' in p ? p.initValue : null;\n    }\n\n    setValue (val) {\n        this.selectEl.value = val;\n    }\n\n    getValue () {\n        return this.selectEl.value;\n    }\n\n    setDeltaValue (delta) {\n        let index = 0;\n        for (let i = 0; i < this.optionArr.length; i++) {\n            if ('' + this.optionArr[i][0] === this.selectEl.value) {\n                index = i;\n                break;\n            }\n        }\n        index = Math.max(0, Math.min(this.optionArr.length -1, index + delta));\n        this.selectEl.value = this.optionArr[index][0];\n        this.onChange(this.selectEl.value);\n    }\n\n    getElement () {\n        return this.selectEl;\n    }\n\n    destroy = () => {\n        this.selectEl.removeEventListener('change', this.changeListener);\n    }\n    \n}\n","import {BB} from '../../../bb/bb';\n\n\n/**\n * Toggle button with an image\n *\n * p = {\n *     initValue: boolean,\n *     title: string,\n *     isRadio: boolean, // if true, can't click when active\n *     onChange: function(boolean)\n * }\n *\n * @param p\n * @constructor\n */\nexport const ImageToggle = function(p) {\n    let isActive = !!p.initValue;\n    const div = BB.el({\n        className: 'image-toggle',\n        title: p.title,\n        css: {\n            backgroundImage: \"url('\" + p.image + \"')\"\n        },\n        onClick: function(e) {\n            e.preventDefault();\n            if (p.isRadio && isActive) {\n                return;\n            }\n            isActive = !isActive;\n            update();\n            p.onChange(isActive);\n        },\n    });\n\n    function update() {\n        if (isActive) {\n            BB.addClassName(div, 'image-toggle-active');\n        } else {\n            BB.removeClassName(div, 'image-toggle-active');\n        }\n    }\n\n    update();\n\n    // --- interface ---\n    this.setValue = function(b) {\n        isActive = !!b;\n        update();\n    };\n    this.getElement = function() {\n        return div;\n    };\n    this.getValue = function() {\n        return isActive;\n    }\n\n};","import {BB} from '../../../bb/bb';\nimport {ImageToggle} from './image-toggle';\n\n/**\n * Radio input group. each one has an image\n *\n * p = {\n *     optionArr: {\n *         id: string,\n *         title: string,\n *         image: string,\n *     }[],\n *     initId: string,\n *     sizePx: number,\n *     onChange: function(id: string): void\n * }\n *\n * @param p\n */\nexport const ImageRadioList = function(p) {\n\n    const div = BB.el({\n        className: 'image-radio-wrapper',\n        css: {\n            display: 'flex'\n        }\n    });\n\n    let activeIndex;\n    const optionArr = [];\n\n    function select(index, id) {\n        activeIndex = index;\n        for (let i = 0; i < optionArr.length; i++) {\n            optionArr[i].setValue(i === activeIndex);\n        }\n        p.onChange(id);\n    }\n\n    function createOption(index, o) {\n        if (o.id === p.initId) {\n            activeIndex = index;\n        }\n        const radioEl = new ImageToggle({\n            image: o.image,\n            title: o.title,\n            initValue: o.id === p.initId,\n            isRadio: true,\n            onChange: function() {\n                select(index, o.id);\n            }\n        });\n        div.appendChild(radioEl.getElement());\n\n        return radioEl;\n\n    }\n\n    for (let i = 0; i < p.optionArr.length; i++) {\n        optionArr.push(createOption(i, p.optionArr[i]));\n    }\n\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n    this.getValue = function() {\n        return p.optionArr[activeIndex].id;\n    };\n};","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"kav7s\");","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport iconImg from 'url:~/src/app/img/ui/brush-pressure.svg';\nimport {LANG} from '../../../language/language';\n\n\n/**\n * small toggle button with a pen icon - representing toggling pressure sensitivity\n * @param isChecked - boolean - initial value\n * @param changeCallback - function(isChecked boolean) - called on change\n * @returns {HTMLElement} - the toggle button\n */\nexport const penPressureToggle = function(isChecked, changeCallback) {\n\n    const toggleDiv = BB.el({\n        css: {\n            cssFloat: 'right',\n            borderRadius: '3px',\n            width: '18px',\n            height: '18px',\n            backgroundImage: 'url(\"' + iconImg + '\")',\n            backgroundSize: 'contain',\n            backgroundRepeat: 'no-repeat',\n            cursor: 'pointer',\n            boxSizing: 'border-box',\n            colorScheme: 'only light',\n        }\n    });\n\n    if (!BB.hasPointerEvents) {\n        toggleDiv.style.display = 'none';\n    }\n\n    function redraw() {\n        if (isChecked) {\n            BB.css(toggleDiv, {\n                backgroundColor: '#fff',\n                opacity: '0.9',\n                border: '1px solid var(--active-highlight-color)'\n            });\n        } else {\n            BB.css(toggleDiv, {\n                backgroundColor: 'transparent',\n                opacity: '0.5',\n                border: '1px solid #666'\n            });\n        }\n    }\n\n    toggleDiv.title = LANG('brush-toggle-pressure');\n    toggleDiv.onclick = function() {\n        isChecked = !isChecked;\n        redraw();\n        changeCallback(isChecked);\n    };\n\n    redraw();\n    changeCallback(isChecked);\n\n    return toggleDiv;\n};","\n\n/**\n * to make sliders more finegrained.\n * @param deltaY number - how far pointer moved away vertically since down\n * @returns {number} the factor 0-1. 0 -> infinite movement for change of 1. 1 -> 1px for change of 1\n */\nexport const calcSliderFalloffFactor = function(deltaY, isRightButton) {\n    let result = Math.min(10, 1 + Math.pow(Math.floor(deltaY / 50), 2));\n    if (isRightButton) {\n        result *= 2;\n    }\n    return 1 / result;\n};\n","import {BB} from '../../../bb/bb';\nimport {calcSliderFalloffFactor} from './slider-falloff';\nimport {IKlSliderConfig} from '../../kl.types';\nimport {languageStrings} from '../../../language/language';\n\n\n\n/**\n * big slider, e.g. used for brush size\n *\n * p = {\n *      label: 'Size',\n *      width: 500,\n *      height: 20,\n *      theme: 'compact-light',\n *      min: 0,\n *      max: 100,\n *      initValue: 10,\n *      resolution: 600, // if you want spline.find to use a different resolution\n *      curve: 'quadratic' | [...], // optional. array is BB.SplineInterpolator points. 0-1\n *      formatFunc: function(value) { // optional\n *          return Math.round(value);\n *      },\n *      onChange: function(value) {},\n *      isChangeOnFinal: true,\n *      eventResMs: 123,\n *      isEnabled?: boolean, // default = true\n * }\n *\n * Values can be spline interpolated\n * On change callback can be debounced\n *\n * @param p - obj\n * @constructor\n */\nexport const KlSlider = function (p) {\n    const _this = this;\n    let isEnabled = p.isEnabled !== false;\n    let useSpline = !!p.curve;\n    let splineInterpolator;\n\n    if (!p.label || !p.onChange) {\n        throw 'PcSlider missing params';\n    }\n    if (p.min != 0 && p.max != 0 && p.initValue != 0) {\n        if (!p.min || !p.max || !p.initValue) {\n            throw 'PcSlider broken params';\n        }\n    }\n    if (p.min >= p.max) {\n        throw 'PcSlider broken params';\n    }\n\n    const elementWidth = p.width;\n    const elementHeight = p.height;\n    const resolution = p.resolution ? p.resolution : elementWidth;\n    let min = p.min;\n    let max = p.max;\n    const onChange = p.onChange;\n    const isChangeOnFinal = !!p.isChangeOnFinal;\n    const formatFunc = p.formatFunc;\n    const eventResMs = p.eventResMs;\n\n    if (useSpline) {\n        const curveArr = p.curve === 'quadratic' ? BB.quadraticSplineInput(min, max, 0.1) : p.curve;\n        splineInterpolator = new BB.SplineInterpolator(curveArr);\n    }\n\n    function toLinearValue(value) {\n        if (useSpline) {\n            return splineInterpolator.findX(value, Math.floor(resolution * 1.5));\n        }\n        return (value - min) / (max - min);\n    }\n\n    function toValue(pLinearValue) {\n        let result = min + pLinearValue * (max - min);\n        if (useSpline) {\n            result = splineInterpolator.interpolate(pLinearValue);\n        }\n        return result;\n    }\n\n    const div = BB.el({\n        className: 'sliderWrapper',\n        css: {\n            overflow: 'hidden',\n            position: 'relative',\n            width: elementWidth + 'px',\n            height: elementHeight + 'px',\n            userSelect: 'none'\n        }\n    });\n    const labelCaption = p.label;\n    const label = document.createElement('div');\n    const control = document.createElement('div');\n    const controlInner = document.createElement('div');\n    let linearValue = toLinearValue(p.initValue); //0 - 1\n\n    div.appendChild(control);\n    div.appendChild(label);\n    control.appendChild(controlInner);\n    control.className = 'sliderInner';\n\n\n    div.oncontextmenu = function () {\n        return false;\n    };\n    //control.style.backgroundColor = \"#aaa\";\n    label.innerHTML = labelCaption;\n\n    control.style.position = 'absolute';\n    control.style.left = '0';\n    control.style.top = '0';\n    control.style.width = (linearValue * elementWidth) + 'px';\n    control.style.height = elementHeight + 'px';\n\n    const labelFontSize = elementHeight - 14;\n    BB.css(label, {\n        position: 'absolute',\n        left: '7px',\n        top: (elementHeight / 2 - labelFontSize / 2 + 1) + 'px',\n        lineHeight: labelFontSize + 'px',\n        fontSize: labelFontSize + 'px',\n        pointerEvents: 'none'\n    });\n\n    function updateEnable (): void {\n        if (isEnabled) {\n            BB.css(div, {\n                opacity: null,\n                pointerEvents: null,\n            });\n        } else {\n            BB.css(div, {\n                opacity: '0.5',\n                pointerEvents: 'none',\n            });\n        }\n    }\n    updateEnable();\n\n    function getOutsideVal() {\n        let result = min + linearValue * (max - min);\n        if (useSpline) {\n            result = splineInterpolator.interpolate(linearValue);\n        }\n        return result;\n    }\n\n    function updateLabel() {\n        let outVal = toValue(linearValue);\n        outVal = formatFunc ? formatFunc(outVal) : parseInt(outVal);\n        outVal = outVal.toLocaleString(languageStrings.getCode());\n        label.innerHTML = labelCaption + '&nbsp;&nbsp;<span style=\"font-weight:bold\">' + outVal + '</span>';\n        control.style.width = (linearValue * elementWidth) + 'px';\n    }\n\n    let lastCallbackTime = 0;\n    function emit(isFinal) {\n        if (!isFinal && isChangeOnFinal) {\n            return;\n        }\n        if (eventResMs && !isFinal) {\n            const now = performance.now();\n            if (now - lastCallbackTime >= eventResMs) {\n                lastCallbackTime = now;\n                onChange(getOutsideVal());\n            }\n        } else {\n            onChange(getOutsideVal());\n        }\n    }\n\n    let virtualVal;\n    function onPointer(event) {\n        event.eventPreventDefault();\n\n        if (!isEnabled) {\n            return;\n        }\n\n        if (event.type === 'pointerdown') {\n            div.className = 'sliderWrapper sliderWrapperActive';\n\n            if (event.button === 'left') {\n                linearValue = event.relX / elementWidth;\n                linearValue = Math.max(0, Math.min(1, linearValue));\n                updateLabel();\n                emit(false);\n            }\n            virtualVal = linearValue;\n        }\n\n        if (event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\n\n            let deltaX = event.dX;\n            const deltaY = Math.abs(event.pageY - event.downPageY);\n            const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\n            deltaX *= factor;\n            deltaX /= elementWidth;\n\n            virtualVal += deltaX;\n            linearValue = Math.max(0, Math.min(1, virtualVal));\n\n            updateLabel();\n            emit(false);\n        }\n\n        if (event.type === 'pointerup') {\n            div.className = 'sliderWrapper';\n            emit(true);\n        }\n\n    }\n\n    let pointerListener;\n    const pointerListenerTimeout = setTimeout(() => {\n        pointerListener = new BB.PointerListener({\n            target: div,\n            maxPointers: 1,\n            fixScribble: true,\n            onPointer: onPointer,\n            onWheel: function(event) {\n                if (useSpline) {\n                    linearValue += -event.deltaY * (splineInterpolator.getLastX() - splineInterpolator.getFirstX()) / 40;\n                    linearValue = Math.max(splineInterpolator.getFirstX(), Math.min(splineInterpolator.getLastX(), linearValue));\n                } else {\n                    linearValue += -event.deltaY / 40;\n                    linearValue = Math.max(0, Math.min(1, linearValue));\n                }\n                updateLabel();\n                onChange(getOutsideVal());\n            }\n        });\n        updateLabel();\n    }, 1);\n\n\n    // --- interface ---\n    this.increaseValue = function (f) {\n        linearValue = Math.min(1, linearValue + Math.abs(f));\n        updateLabel();\n        onChange(getOutsideVal());\n    };\n    this.decreaseValue = function (f) {\n        linearValue = Math.max(0, linearValue - Math.abs(f));\n        updateLabel();\n        onChange(getOutsideVal());\n    };\n    this.setValue = function(v) {\n        linearValue = toLinearValue(v);\n        updateLabel();\n    };\n    this.getValue = function () {\n        return getOutsideVal();\n    };\n    this.update = function(config: IKlSliderConfig): void {\n        min = config.min;\n        max = config.max;\n        useSpline = !!config.curve;\n        if (useSpline) {\n            const curveArr = config.curve === 'quadratic' ? BB.quadraticSplineInput(min, max, 0.1) : config.curve;\n            splineInterpolator = new BB.SplineInterpolator(curveArr);\n        } else {\n            splineInterpolator = null;\n        }\n        _this.setIsEnabled(!config.isDisabled);\n    };\n    this.setIsEnabled = function (e: boolean): void {\n        isEnabled = !!e;\n        updateEnable();\n    };\n\n    this.destroy = function() {\n        clearTimeout(pointerListenerTimeout);\n        if (pointerListener) {\n            pointerListener.destroy();\n        }\n    };\n\n    this.getElement = function() {\n        return div;\n    }\n\n};","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"43nfB\");","import {BB} from '../../../bb/bb';\nimport {input} from '../base-components/input';\nimport {popup} from './popup';\nimport {LANG} from '../../../language/language';\n// @ts-ignore\nimport copyImg from 'url:~/src/app/img/ui/copy.svg';\n\n/**\n * dialog for manually inputting the color\n * @param p {color: rgbObj, onClose: function(rgbObj | null)}\n * @constructor\n */\nexport const HexColorDialog = function (p) {\n\n    let lastValidRgb = new BB.RGB(p.color.r, p.color.g, p.color.b);\n\n    const div = BB.el({});\n\n    const previewEl = BB.el({\n        css: {\n            width: '20px',\n            height: '20px',\n            marginBottom: '10px',\n            boxShadow: 'inset 0 0 0 1px #fff, 0 0 0 1px #000',\n            background: '#' + BB.ColorConverter.toHexString(lastValidRgb),\n            colorScheme: 'only light',\n        }\n    });\n    div.appendChild(previewEl);\n\n\n    // --- Hex ---\n    const hexRowEl = BB.el({\n        css: {\n            display: 'flex',\n            alignItems: 'center',\n            marginBottom: '15px'\n        }\n    });\n    const hexLabel = BB.el({\n        content: LANG('mci-hex'),\n        css: {\n            width: '60px'\n        }\n    });\n    const hexInput = input({\n        init: '#' + BB.ColorConverter.toHexString(lastValidRgb),\n        css: {\n            width: '80px'\n        },\n        callback: function() {\n            let rgbObj = BB.ColorConverter.hexToRGB(hexInput.value);\n            if (rgbObj === null) {\n                rgbObj = lastValidRgb;\n                hexInput.value = '#' + BB.ColorConverter.toHexString(lastValidRgb);\n            } else {\n                lastValidRgb = rgbObj;\n            }\n            previewEl.style.background = '#' + BB.ColorConverter.toHexString(rgbObj);\n\n            for (let i = 0; i < rgbArr.length; i++) {\n                rgbArr[i].update();\n            }\n        }\n    });\n    const copyButton = BB.el({\n        tagName: 'button',\n        content: '<img src=\"' + copyImg + '\" height=\"20\"/>',\n        title: LANG('mci-copy'),\n        css: {\n            marginLeft: '10px'\n        },\n        onClick: function() {\n            hexInput.select();\n            document.execCommand('copy');\n        }\n    });\n    hexRowEl.appendChild(hexLabel);\n    hexRowEl.appendChild(hexInput);\n    hexRowEl.appendChild(copyButton);\n    div.appendChild(hexRowEl);\n    setTimeout(function () {\n        hexInput.focus();\n        hexInput.select();\n    }, 0);\n\n\n    // --- R G B ---\n    function createRgbInputRow(labelStr, attributeStr) {\n        const result: any = {};\n\n        const rowEl = BB.el({\n            css: {\n                display: 'flex',\n                alignItems: 'center',\n                marginTop: '5px',\n            }\n        });\n        const labelEl = BB.el({\n            content: labelStr,\n            css: {\n                width: '60px'\n            }\n        });\n\n        const inputEl = input({\n            init: lastValidRgb[attributeStr],\n            min: 0,\n            max: 255,\n            type: 'number',\n            css: {\n                width: '80px'\n            },\n            callback: function() {\n                if (inputEl.value === '' || parseFloat(inputEl.value) < 0 || parseFloat(inputEl.value) > 255) {\n                    result.update();\n                    return;\n                }\n                inputEl.value = '' + Math.round(parseFloat(inputEl.value));\n                lastValidRgb[attributeStr] = inputEl.value;\n                previewEl.style.background = '#' + BB.ColorConverter.toHexString(lastValidRgb);\n                hexInput.value = '#' + BB.ColorConverter.toHexString(lastValidRgb);\n            }\n        });\n\n        rowEl.appendChild(labelEl);\n        rowEl.appendChild(inputEl);\n        div.appendChild(rowEl);\n\n\n        result.update = function() {\n            inputEl.value = lastValidRgb[attributeStr];\n        };\n        return result;\n    }\n    const rgbArr = [];\n    rgbArr.push(createRgbInputRow(LANG('red'), 'r'));\n    rgbArr.push(createRgbInputRow(LANG('green'), 'g'));\n    rgbArr.push(createRgbInputRow(LANG('blue'), 'b'));\n\n\n    popup({\n        target: document.body,\n        message: `<b>${LANG('manual-color-input')}</b>`,\n        div: div,\n        autoFocus: false,\n        clickOnEnter: 'Ok',\n        buttons: ['Ok', 'Cancel'],\n        callback: function (resultStr) {\n            let rgbObj = null;\n            if (resultStr === 'Ok') {\n                rgbObj = BB.ColorConverter.hexToRGB(hexInput.value);\n            }\n            p.onClose(rgbObj);\n        }\n    });\n\n};","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"9Vqzx\");","import {BB} from '../../../bb/bb';\nimport {HexColorDialog} from '../modals/color-slider-hex-dialog';\nimport {calcSliderFalloffFactor} from './slider-falloff';\n// @ts-ignore\nimport eyedropperImg from 'url:~/src/app/img/ui/tool-picker.svg';\nimport {LANG} from '../../../language/language';\n\n/**\n * big main HS+V color slider\n * 2 elements: slider, and colorpreview(output) + eyedropper\n *\n * p = {\n *     width: number,\n *     height: number, // hue slider and output height\n *     svHeight: number,\n *     startValue: rgb, // 0-255\n *     onPick: function(rgb)\n * }\n *\n * @param p\n * @constructor\n */\nexport const KlColorSlider = function (p) {\n\n    const _this = this;\n    let pickCallback = function(result?) {};\n    const div = document.createElement('div');\n    div.style.position = 'relative';\n    div.className = 'colorSlider';\n    const outputDiv = BB.el({\n        css: {\n            display: 'flex',\n            alignItems: 'center'\n        }\n    });\n    const width = p.width;\n    let svHeight = p.svHeight;\n    const height = p.height;\n    const emitColor = p.onPick;\n\n    let primaryColorRGB = {\n        r: parseInt(p.startValue.r, 10),\n        g: parseInt(p.startValue.g, 10),\n        b: parseInt(p.startValue.b, 10)\n    };\n    let primaryColorHSV = BB.ColorConverter.toHSV(p.startValue); // BB.HSV\n    let secondaryColorRGB = {r: 255, g: 255, b: 255};\n    let secondaryColorHSV = BB.ColorConverter._RGBtoHSV(secondaryColorRGB); // BB.HSV\n\n    const svWrapper = BB.el({});\n    const svSvg = new DOMParser().parseFromString('<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\"> <defs> <linearGradient id=\"value\" gradientTransform=\"rotate(90)\"> <stop offset=\"0\" stop-color=\"rgba(0,0,0,0)\"/> <stop offset=\"100%\" stop-color=\"rgba(0,0,0,1)\"/> </linearGradient> <linearGradient id=\"hue\" gradientTransform=\"rotate(0)\"> <stop offset=\"0\" stop-color=\"#fff\"/> <stop id=\"hue-stop\" offset=\"100%\" stop-color=\"#f00\"/> </linearGradient> </defs> <rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" fill=\"url(\\'#hue\\')\"/> <rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" fill=\"url(\\'#value\\')\"/></svg>', 'image/svg+xml').documentElement;\n    const hueStop = (svSvg as any).getElementById('hue-stop');\n    BB.setAttributes(hueStop, {\n        'stop-color': '#f0f'\n    });\n    BB.css(svSvg, {\n        width: width + 'px',\n        height: svHeight + 'px'\n    });\n    svWrapper.appendChild(svSvg);\n\n    const divH = document.createElement('div');\n    BB.css(divH, {\n        position: 'relative',\n        height: height + 'px'\n    });\n    const divPreview = document.createElement('div');\n    const controlH = document.createElement('div');\n\n    const enabled = true;\n\n    function updatePrimaryHSV(hsv) {\n        if (hsv.s === 0) {\n            primaryColorHSV = new BB.HSV(primaryColorHSV.h, hsv.s, hsv.v);\n        } else {\n            primaryColorHSV = new BB.HSV(hsv.h, hsv.s, hsv.v);\n        }\n    }\n\n    function createHueBg(targetEl) {\n        const im = new Image();\n        BB.css(im, {\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            display: 'none',\n            pointerEvents: 'none'\n        });\n        const cv = BB.canvas(width, height);\n        const ctx = cv.getContext('2d');\n        const gradH = ctx.createLinearGradient(0, 0, width, 0);\n        for (let i = 0; i < 1; i += 0.01) {\n            const col = BB.ColorConverter.toRGB(new BB.HSV(i * 360, 100, 100));\n            let ha = (parseInt('' + col.r)).toString(16);\n            let hb = (parseInt('' + col.g)).toString(16);\n            let hc = (parseInt('' + col.b)).toString(16);\n            if (ha.length === 1)\n                ha = '0' + ha;\n            if (hb.length === 1)\n                hb = '0' + hb;\n            if (hc.length === 1)\n                hc = '0' + hc;\n            gradH.addColorStop(i, '#' + ha + hb + hc);\n        }\n        ctx.fillStyle = gradH;\n        ctx.fillRect(0, 0, width, height);\n\n        targetEl.appendChild(im);\n        im.alt = 'hue';\n        im.src = cv.toDataURL('image/png');\n        im.style.display = 'block';\n    }\n\n\n    function updateSVCanvas() {\n        const rgb = BB.ColorConverter.toRGB(new BB.HSV(primaryColorHSV.h, 100, 100));\n        BB.setAttributes(hueStop, {\n            'stop-color': '#' + BB.ColorConverter.toHexString(rgb)\n        });\n    }\n\n    function updateSVPointer() {\n\n        const left = primaryColorHSV.s / 100 * width - 7;\n        const top = (1 - primaryColorHSV.v / 100) * svHeight - 6;\n        BB.css(pointerSV, {\n            left: left + 'px',\n            top: top + 'px'\n        });\n    }\n\n    function setColPreview() {\n        divPreview.style.backgroundColor = 'rgb(' + primaryColorRGB.r + ',' + primaryColorRGB.g + ',' + primaryColorRGB.b + ')';\n\n        if (BB.testIsWhiteBestContrast(primaryColorRGB)) {\n            BB.css(pickerButton, {\n                filter: 'invert(1)'\n            });\n            BB.css(hexButton, {\n                filter: 'invert(1)'\n            });\n        } else{\n            BB.css(pickerButton, {\n                filter: ''\n            });\n            BB.css(hexButton, {\n                filter: ''\n            });\n        }\n\n    }\n\n    updateSVCanvas();\n    div.style.width = width + 'px';\n    div.oncontextmenu = function () {\n        return false;\n    };\n\n    const SVContainer = document.createElement('div');\n    BB.css(SVContainer, {\n        width: width + 'px',\n        height: svHeight/2 + 'px',\n        overflow: 'hidden',\n        display: 'block',\n        position: 'relative',\n        cursor: 'crosshair',\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px'\n    });\n\n    const pointerSV = document.createElement('div');\n    BB.css(pointerSV, {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        position: 'absolute',\n        pointerEvents: 'none',\n        boxShadow: '0px 0px 0 1px #000, inset 0px 0px 0 1px #fff'\n    });\n\n    SVContainer.appendChild(svWrapper);\n    SVContainer.appendChild(pointerSV);\n    updateSVPointer();\n    div.appendChild(SVContainer);\n    div.appendChild(divH);\n    outputDiv.appendChild(divPreview);\n    BB.css(divPreview, {\n        display: 'flex',\n        justifyContent: 'space-between',\n        width: (height * 2.5) + 'px',\n        height: height + 'px',\n        //position: \"relative\",\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px',\n        colorScheme: 'only light',\n    });\n\n    BB.css(divH, {\n        overflow: 'hidden',\n        position: 'relative',\n        width: width + 'px',\n        height: height/2 + 'px',\n        cursor: 'ew-resize',\n        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px',\n        marginTop: '1px',\n        marginBottom: '1px'\n    });\n\n    //divH.className = \"svSlider\";\n    BB.css(controlH, {\n        width: '1px',\n        height: height/2 + 'px',\n        background: '#000',\n        borderLeft: '1px solid #fff',\n        position: 'absolute',\n        top: '0',\n        left: parseInt('' + (primaryColorHSV.h / 360 * width - 1)) + 'px'\n    });\n\n\n    const virtualHSV = {\n        h: 0,\n        s: 0,\n        v: 0\n    };\n    let svPointerListener;\n    let hPointerListener;\n\n\n    const pickerButton = BB.el({\n        title: LANG('eyedropper') + ' [Alt]',\n        className: 'color-picker-preview-button',\n        css: {\n            width: '30px',\n            height: '30px',\n            backgroundImage: 'url(' + eyedropperImg + ')',\n            backgroundRepeat:  'no-repeat',\n            backgroundSize: '70%',\n            backgroundPosition: 'center'\n        }\n    });\n    let isPicking = false;\n\n\n    pickerButton.onclick = function () {\n        if (isPicking === false) {\n            BB.removeClassName(pickerButton, 'color-picker-preview-button-hover');\n            BB.addClassName(pickerButton, 'color-picker-preview-button-active');\n            isPicking = true;\n            pickCallback(true);\n        } else {\n            pickCallback(false);\n            _this.pickingDone();\n        }\n    };\n    const pickerButtonPointerListener = new BB.PointerListener({\n        target: pickerButton,\n        onEnterLeave: function(isOver) {\n            if (isPicking) {\n                return;\n            }\n            if (isOver) {\n                BB.addClassName(pickerButton, 'color-picker-preview-button-hover');\n            } else {\n                BB.removeClassName(pickerButton, 'color-picker-preview-button-hover');\n            }\n        }\n    });\n    divPreview.appendChild(pickerButton);\n\n\n    const hexButton = BB.el({\n        content: '#',\n        className: 'color-picker-preview-button',\n        title: LANG('manual-color-input'),\n        css: {\n            height: '100%',\n            width: height + 'px',\n            lineHeight: height + 'px',\n            fontSize: (height * 0.65) + 'px'\n        },\n        onClick: function() {\n            HexColorDialog({\n                color: new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b),\n                onClose: function(rgbObj) {\n                    if (!rgbObj) {\n                        return;\n                    }\n                    _this.setColor(rgbObj);\n                    emitColor(new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b));\n                }\n            });\n        }\n    });\n    const hexButtonPointerListener = new BB.PointerListener({\n        target: hexButton,\n        onEnterLeave: function(isOver) {\n            if (isOver) {\n                BB.addClassName(hexButton, 'color-picker-preview-button-hover');\n            } else {\n                BB.removeClassName(hexButton, 'color-picker-preview-button-hover');\n            }\n        }\n    });\n    divPreview.appendChild(hexButton);\n\n    setColPreview();\n\n\n    setTimeout(function() {\n        createHueBg(divH);\n        divH.appendChild(controlH);\n        svPointerListener = new BB.PointerListener({\n            target: svWrapper,\n            maxPointers: 1,\n            fixScribble: true,\n            onPointer: function(event) {\n                if (event.type === 'pointerdown') {\n                    BB.css(SVContainer, {\n                        boxShadow: '0px 0px 0px 1px rgb(255,255,255)',\n                        zIndex: '1'\n                    });\n\n                    if (event.button === 'left') {\n\n                        virtualHSV.s = event.relX / width * 100;\n                        virtualHSV.v = 100 - event.relY / svHeight * 100;\n\n                        primaryColorHSV = new BB.HSV(primaryColorHSV.h, virtualHSV.s, virtualHSV.v);\n                        primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\n\n                        updateSVPointer();\n                        setColPreview();\n                        emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\n                    } else {\n                        virtualHSV.s = primaryColorHSV.s;\n                        virtualHSV.v = primaryColorHSV.v;\n                    }\n                }\n\n                if (event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\n\n                    let factor = 1;\n                    if (event.button === 'right') {\n                        factor = 0.5;\n                    }\n\n                    virtualHSV.s += event.dX / width * 100 * factor;\n                    virtualHSV.v -= event.dY / svHeight * 100 * factor;\n\n                    primaryColorHSV = new BB.HSV(primaryColorHSV.h, virtualHSV.s, virtualHSV.v);\n                    primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\n                    updateSVPointer();\n                    setColPreview();\n                    emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\n\n                }\n\n                if (event.type === 'pointerup') {\n                    BB.css(SVContainer, {\n                        boxShadow: '0 0 0 1px rgb(188, 188, 188)',\n                        zIndex: '0'\n                    });\n                }\n\n            }\n        });\n        hPointerListener = new BB.PointerListener({\n            target: divH,\n            maxPointers: 1,\n            fixScribble: true,\n            onPointer: function(event) {\n\n                if (event.type === 'pointerdown') {\n                    BB.css(divH, {\n                        boxShadow: '0px 0px 0px 1px rgba(255,255,255,1)'\n                    });\n\n                    if (event.button === 'left') {\n\n                        virtualHSV.h = event.relX / width * 359.99;\n\n                        primaryColorHSV = new BB.HSV(virtualHSV.h, primaryColorHSV.s, primaryColorHSV.v);\n                        primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\n                        controlH.style.left = (Math.round(primaryColorHSV.h / 359.99 * width) - 1) + 'px';\n                        updateSVCanvas();\n                        setColPreview();\n                        emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\n                    } else {\n                        virtualHSV.h = primaryColorHSV.h;\n                    }\n                }\n\n                if (event.type === 'pointermove' && ['left', 'right'].includes(event.button)) {\n\n                    const deltaY = Math.abs(event.pageY - event.downPageY);\n                    const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\n\n                    virtualHSV.h += event.dX / width * 359.99 * factor;\n\n                    if (event.button === 'right') {\n                        virtualHSV.h = virtualHSV.h % 359.99;\n                        if (virtualHSV.h < 0) {\n                            virtualHSV.h += 359.99;\n                        }\n                    }\n                    virtualHSV.h = Math.min(359.99, virtualHSV.h);\n                    primaryColorHSV = new BB.HSV(virtualHSV.h, primaryColorHSV.s, primaryColorHSV.v);\n                    primaryColorRGB = BB.ColorConverter.toRGB(primaryColorHSV);\n                    controlH.style.left = (Math.round(primaryColorHSV.h / 359.99 * width) - 1) + 'px';\n                    updateSVCanvas();\n                    setColPreview();\n                    emitColor(BB.ColorConverter.toRGB(primaryColorHSV));\n\n                }\n\n                if (event.type === 'pointerup') {\n                    BB.css(divH, {\n                        boxShadow: 'rgb(188, 188, 188) 0 0 0 1px'\n                    });\n                }\n            }\n        });\n    }, 1);\n\n\n    // --- second color ---\n\n    const secondaryColorBtn = BB.el({\n        parent: outputDiv,\n        title: LANG('secondary-color') + ' [X]',\n        css: {\n            cursor: 'pointer',\n            marginLeft: '5px',\n            width: '22px',\n            height: '22px',\n            boxShadow: 'rgb(188, 188, 188) 0px 0px 0px 1px',\n            colorScheme: 'only light',\n        },\n        onClick: function(e) {\n            e.preventDefault();\n            swapColors();\n        }\n    });\n    function updateSecondaryColor() {\n        secondaryColorBtn.style.backgroundColor = BB.ColorConverter.toRgbStr(secondaryColorRGB);\n    }\n    function swapColors() {\n        // swap hsv\n        let tmp: any = secondaryColorHSV;\n        secondaryColorHSV = primaryColorHSV;\n        updatePrimaryHSV(tmp);\n        // swap rgb\n        tmp = secondaryColorRGB;\n        secondaryColorRGB = primaryColorRGB;\n        primaryColorRGB = tmp;\n\n        controlH.style.left = parseInt('' + (primaryColorHSV.h / 359 * width - 1)) + 'px';\n        updateSVCanvas();\n        updateSVPointer();\n        setColPreview();\n        updateSecondaryColor();\n\n        emitColor(new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b));\n    }\n    updateSecondaryColor();\n\n\n\n    // --- interface ---\n\n    this.setColor = function (c) {\n        primaryColorRGB = {r: parseInt(c.r, 10), g: parseInt(c.g, 10), b: parseInt(c.b, 10)};\n        updatePrimaryHSV(BB.ColorConverter.toHSV(c));\n        controlH.style.left = parseInt('' + (primaryColorHSV.h / 359 * width - 1)) + 'px';\n        updateSVCanvas();\n        updateSVPointer();\n        setColPreview();\n    };\n\n    this.getColor = function () {\n        return new BB.RGB(primaryColorRGB.r, primaryColorRGB.g, primaryColorRGB.b);\n    };\n\n    this.getSecondaryRGB = function() {\n        return new BB.RGB(secondaryColorRGB.r, secondaryColorRGB.g, secondaryColorRGB.b);\n    };\n\n    this.setPickCallback = function (func) {\n        pickCallback = func;\n    };\n\n    this.pickingDone = function () {\n        if (!isPicking) {\n            return;\n        }\n        isPicking = false;\n        BB.removeClassName(pickerButton, 'color-picker-preview-button-active');\n    };\n\n    this.enable = function (e) {\n        if (e) {\n            div.style.pointerEvents = '';\n            div.style.opacity = '1';\n            outputDiv.style.pointerEvents = '';\n            outputDiv.style.opacity = '1';\n        } else {\n            div.style.pointerEvents = 'none';\n            div.style.opacity = '0.5';\n            outputDiv.style.pointerEvents = 'none';\n            outputDiv.style.opacity = '0.5';\n        }\n    };\n\n    this.setHeight = function (h) {\n        h = parseInt('' +(h - height * 2 - 3), 10);\n        if (h === svHeight) {\n            return;\n        }\n        svHeight = h;\n        BB.css(svSvg, {\n            width: width + 'px',\n            height: svHeight + 'px'\n        });\n        SVContainer.style.height = svHeight + 'px';\n        updateSVPointer();\n    };\n\n    this.swapColors = function() {\n        swapColors();\n    };\n\n    this.getElement = function() {\n        return div;\n    };\n\n    this.getOutputElement = function() {\n        return outputDiv;\n    }\n\n};","import {BB} from '../../../bb/bb';\nimport {calcSliderFalloffFactor} from './slider-falloff';\n\n\n/**\n * a small color slider\n *\n * params {\n * \t width: 200,\n * \t heightSV: 200,\n * \t heightH: 10,\n * \t color: {r,g,b}\n * \t callback: function(c){}\n * }\n *\n * @param params\n * @constructor\n */\nexport const KlSmallColorSlider = function (params) {\n    const div = document.createElement('div');\n    div.oncontextmenu = function(e) {\n        e.preventDefault();\n    };\n    let color = BB.ColorConverter.toHSV(new BB.RGB(params.color.r, params.color.g, params.color.b));\n    BB.css(div, {\n        width: params.width + 'px',\n        position: 'relative',\n        overflow: 'hidden',\n        userSelect: 'none'\n    });\n\n    const canvasSV = BB.canvas(10, 10);\n    canvasSV.style.width = params.width + 'px';\n    canvasSV.style.height = params.heightSV + 'px';\n    canvasSV.style.cursor = 'crosshair';\n\n    function updateSV() {\n        const ctx = canvasSV.getContext('2d');\n        for (let i = 0; i < canvasSV.height; i += 1) {\n            const gradient1 = ctx.createLinearGradient(0, 0, canvasSV.width, 0);\n\n            const colleft = BB.ColorConverter.toRGB(new BB.HSV(color.h, 1, 100 - (i / canvasSV.height * 100.0)));\n            const colright = BB.ColorConverter.toRGB(new BB.HSV(color.h, 100, 100 - (i / canvasSV.height * 100.0)));\n            gradient1.addColorStop(0, '#' + BB.ColorConverter.toHexString(colleft));\n            gradient1.addColorStop(1, '#' + BB.ColorConverter.toHexString(colright));\n            ctx.fillStyle = '#ff0000'; //needed for chrome...otherwise alpha problem\n            ctx.fillStyle = gradient1;\n            ctx.fillRect(0, i, canvasSV.width, 1);\n        }\n    }\n\n    updateSV();\n\n    const canvasH = BB.canvas(params.width, params.heightH);\n    canvasH.style.cursor = 'ew-resize';\n    (function () {\n        const ctx = canvasH.getContext('2d');\n\n        const gradH = ctx.createLinearGradient(0, 0, params.width, 0);\n        for (let i = 0; i < 1; i += 0.01) {\n            const col = BB.ColorConverter.toRGB(new BB.HSV(i * 360, 100, 100));\n            gradH.addColorStop(i, 'rgba(' + parseInt('' + col.r) + ', ' + parseInt('' + col.g) + ', ' + parseInt('' + col.b) + ', 1)');\n        }\n        ctx.fillStyle = gradH;\n        ctx.fillRect(0, 0, params.width, params.heightH);\n\n    })();\n    BB.css(canvasSV, {\n        width: params.width + 'px',\n        height: params.heightSV + 'px',\n        overflow: 'hidden',\n        position: 'relative'\n    });\n    canvasSV.style.cssFloat = 'left';\n    canvasH.style.cssFloat = 'left';\n\n    div.appendChild(canvasSV);\n    div.appendChild(canvasH);\n\n    const pointerSV = document.createElement('div');\n    BB.css(pointerSV, {\n        width: '8px',\n        height: '8px',\n        borderRadius: '8px',\n        position: 'absolute',\n        pointerEvents: 'none',\n        boxShadow: '0 0 0 1px #000, inset 0 0 0 1px #fff'\n    });\n    div.appendChild(pointerSV);\n\n    const pointerH = document.createElement('div');\n    BB.css(pointerH, {\n        width: '0',\n        height: params.heightH + 'px',\n        borderLeft: '1px solid #fff',\n        borderRight: '1px solid #000',\n        position: 'absolute',\n        top: params.heightSV + 'px',\n        pointerEvents: 'none'\n    });\n    div.appendChild(pointerH);\n\n\n    function updateSVPointer() {\n        const left = color.s / 100 * params.width - 4;\n        const top = (1 - color.v / 100) * params.heightSV - 4;\n        BB.css(pointerSV, {\n            left: left + 'px',\n            top: top + 'px'\n        });\n        /*if (top < params.heightSV/3) {\n        pointerSV.style.border = \"1px solid rgba(0,0,0,1)\";\n    } else {\n        pointerSV.style.border = \"1px solid rgba(255,255,255,1)\";\n    }*/\n    }\n\n    function updateHPointer() {\n        pointerH.style.left = (color.h / 359.999 * params.width - 1) + 'px';\n    }\n\n    updateSVPointer();\n    updateHPointer();\n\n    const virtualHSV = {\n        h: 0,\n        s: 0,\n        v: 0\n    };\n\n    let svPointerId = null;\n    const svPointerListener = new BB.PointerListener({\n        target: canvasSV,\n        maxPointers: 1,\n        fixScribble: true,\n        onPointer: function(event) {\n\n            if (event.type === 'pointerdown') {\n                svPointerId = event.pointerId;\n                if (event.button === 'left') {\n\n                    virtualHSV.s = event.relX / params.width * 100;\n                    virtualHSV.v = 100 - event.relY / params.heightSV * 100;\n\n                    color = new BB.HSV(color.h, virtualHSV.s, virtualHSV.v);\n\n                    updateSVPointer();\n                    params.callback(BB.ColorConverter.toRGB(color));\n                } else {\n                    virtualHSV.s = color.s;\n                    virtualHSV.v = color.v;\n                }\n            }\n\n            if (event.type === 'pointermove' && ['left', 'right'].includes(event.button) && svPointerId === event.pointerId) {\n\n                let factor = 1;\n                if (event.button === 'right') {\n                    factor = 0.5;\n                }\n\n                virtualHSV.s += event.dX / params.width * 100 * factor;\n                virtualHSV.v -= event.dY / params.heightSV * 100 * factor;\n\n                color = new BB.HSV(color.h, virtualHSV.s, virtualHSV.v);\n                updateSVPointer();\n                params.callback(BB.ColorConverter.toRGB(color));\n\n            }\n            if (event.type === 'pointerup') {\n                svPointerId = null;\n            }\n\n        }\n    });\n\n    let hPointerId = null;\n    const hPointerListener = new BB.PointerListener({\n        target: canvasH,\n        maxPointers: 1,\n        fixScribble: true,\n        onPointer: function(event) {\n\n            if (event.type === 'pointerdown') {\n                hPointerId = event.pointerId;\n                if (event.button === 'left') {\n\n                    virtualHSV.h = event.relX / params.width * 359.99;\n\n                    color = new BB.HSV(virtualHSV.h, color.s, color.v);\n                    updateSV();\n                    updateHPointer();\n                    params.callback(BB.ColorConverter.toRGB(color));\n                } else {\n                    virtualHSV.h = color.h;\n                }\n            }\n\n            if (event.type === 'pointermove' && ['left', 'right'].includes(event.button) && hPointerId === event.pointerId) {\n\n                const deltaY = Math.abs(event.pageY - event.downPageY);\n                const factor = calcSliderFalloffFactor(deltaY, event.button === 'right');\n\n                virtualHSV.h += event.dX / params.width * 359.99 * factor;\n\n                if (event.button === 'right') {\n                    virtualHSV.h = virtualHSV.h % 359.99;\n                    if (virtualHSV.h < 0) {\n                        virtualHSV.h += 359.99;\n                    }\n                }\n                virtualHSV.h = Math.min(359.99, virtualHSV.h);\n                color = new BB.HSV(virtualHSV.h, color.s, color.v);\n                updateSV();\n                updateHPointer();\n                params.callback(BB.ColorConverter.toRGB(color));\n\n            }\n            if (event.type === 'pointerup') {\n                hPointerId = null;\n            }\n        }\n    });\n\n\n    const cleardiv = document.createElement('div');\n    cleardiv.style.clear = 'both';\n    div.appendChild(cleardiv);\n\n    // --- interface ---\n    this.setColor = function (c) {\n        color = BB.ColorConverter.toHSV(new BB.RGB(c.r, c.g, c.b));\n        updateSV();\n        updateSVPointer();\n        updateHPointer();\n    };\n    this.getColor = function () {\n        return BB.ColorConverter.toRGB(color);\n    };\n    this.getElement = function() {\n        return div;\n    };\n    this.destroy = function() {\n        svPointerListener.destroy();\n        hPointerListener.destroy();\n    };\n    this.end = function() {\n        svPointerId = null;\n        hPointerId = null;\n    };\n\n};","import {BB} from '../../../bb/bb';\n\n\n/**\n * a slider that looks like this\n * ------O----\n *\n * param: {init, width, pointSize, callback(value, isFirst, isLast)}\n *\n * @param param\n * @constructor\n */\nexport const PointSlider = function(param) {\n\n    const div = document.createElement('div');\n    div.style.position = 'relative';\n    const sliderLine = BB.el({});\n    const sliderPoint = BB.el({\n        css: {\n            colorScheme: 'only light',\n        }\n    });\n    div.appendChild(sliderLine);\n    div.appendChild(sliderPoint);\n    let sliderPos;\n    let isDragging = false;\n\n    //sliderLine\n    {\n        BB.css(sliderLine, {\n            marginTop: parseInt('' + (param.pointSize / 2 - 1)) + 'px',\n            height: '2px',\n            background: '#aaa',\n            width: param.width + 'px'\n        });\n    }\n    //sliderPoint\n    const touchAreaEl = BB.el({ // expand clickable area\n        parent: sliderPoint,\n        css: {\n            // background: 'rgba(255,0,0,0.4)',\n            margin: '-7px 0 0 -7px',\n            width: 'calc(100% + 14px)',\n            height: 'calc(100% + 7px)',\n        }\n    });\n\n    function redrawPoint() {\n        sliderPoint.style.left = sliderPos + 'px';\n        if (isDragging) {\n            sliderPoint.style.boxShadow = '0 0 6px rgba(0,0,0,1)';\n        } else {\n            sliderPoint.style.boxShadow = '0 0 3px rgba(0,0,0,0.8)';\n        }\n    }\n    function getValue() {\n        return sliderPos /  (param.width - param.pointSize);\n    }\n\n    let pointerListener;\n    {\n        let isFirst;\n        sliderPos = BB.clamp(param.init * (param.width - param.pointSize), 0, param.width - param.pointSize);\n        BB.css(sliderPoint, {\n            position: 'absolute',\n            top: '0px',\n            backgroundColor: '#eaeaea',\n            boxShadow: '0 0 3px rgba(0,0,0,0.8)',\n            width: param.pointSize + 'px',\n            height: param.pointSize + 'px',\n            borderRadius: param.pointSize + 'px',\n            cursor: 'ew-resize',\n            transition: 'box-shadow 0.2s ease-in-out'\n        });\n        redrawPoint();\n        let imaginaryPos;\n        pointerListener = new BB.PointerListener({\n            target: sliderPoint,\n            fixScribble: true,\n            onPointer: function(event) {\n                if (event.type === 'pointerdown' && event.button === 'left') {\n                    isFirst = true;\n                    isDragging = true;\n                    imaginaryPos = sliderPos;\n                    redrawPoint();\n                    event.eventStopPropagation();\n                } else if (event.type === 'pointermove' && event.button === 'left') {\n                    event.eventStopPropagation();\n                    imaginaryPos = imaginaryPos + event.dX;\n                    sliderPos = parseInt('' + BB.clamp(imaginaryPos, 0, param.width - param.pointSize));\n                    redrawPoint();\n                    param.callback(getValue(), isFirst, false);\n                    isFirst = false;\n                }\n                if (event.type === 'pointerup') {\n                    event.eventStopPropagation();\n                    isDragging = false;\n                    redrawPoint();\n                    param.callback(getValue(), false, true);\n                }\n            }\n        })\n    }\n\n    // --- interface ---\n    this.getEl = function() {\n        return div;\n    };\n    this.setActive = function(isActive) {\n        if (isActive) {\n            sliderPoint.style.backgroundColor = '#fff';\n        } else {\n            sliderPoint.style.backgroundColor = '#eaeaea';\n        }\n    };\n    this.destroy = function() {\n        pointerListener.destroy();\n    };\n};","import {BB} from '../../../bb/bb';\n\n/**\n * UI to pick between colors in colorArr. can display full transparent (checkerboard).\n * Can't deal with 0.5 alpha.\n * Rectangular buttons.\n *\n * p = {\n *     colorArr: rgba[], // duplicates are removed\n *     onChange: func(rgbaObj),\n *     label: string,\n *     initialIndex: int// optional, index before duplicates were removed\n * }\n *\n * @param p\n * @constructor\n */\nexport const ColorOptions = function(p) {\n    const div = BB.el({\n        content: p.label ? p.label : '',\n        css: {\n            display: 'flex',\n            alignItems: 'center',\n            colorScheme: 'only light',\n        }\n    });\n\n    let selectedIndex = 0;\n    const colorArr = [];\n    const buttonArr = [];\n    const buttonSize = 22;\n    const checkerUrl = BB.createCheckerDataUrl(5);\n\n    // build colorArr while removing duplicates\n    for (let i = 0; i < p.colorArr.length; i++) {\n        const item = p.colorArr[i];\n        let found = false;\n        for (let e = 0; e < colorArr.length; e++) {\n            const sItem = colorArr[e];\n            if (sItem === null || item === null) {\n                continue;\n            }\n            if (sItem.r === item.r && sItem.g === item.g && sItem.b === item.b && sItem.a === item.a) {\n                found = true;\n                break;\n            }\n        }\n        if (found) {\n            continue;\n        }\n        colorArr.push(item);\n        if ('initialIndex' in p && p.initialIndex === i) {\n            selectedIndex = colorArr.length - 1;\n        }\n    }\n\n    for (let i = 0; i < colorArr.length; i++) {\n        (function(i) {\n\n            const colorButton = BB.el({\n                content: colorArr[i] ? '' : 'X',\n                css: {\n                    width: buttonSize + 'px',\n                    height: buttonSize + 'px',\n                    backgroundColor: colorArr[i] ? BB.ColorConverter.toRgbaStr(colorArr[i]) : 'transparent',\n                    marginLeft: '7px',\n                    boxShadow: '0 0 0 1px #aaa',\n                    cursor: 'pointer',\n                    userSelect: 'none',\n                    textAlign: 'center',\n                    lineHeight: (buttonSize + 1) + 'px',\n                    color: '#aaa'\n                }\n            });\n            if (colorArr[i] && colorArr[i].a === 0) {\n                colorButton.style.backgroundImage = 'url(' + checkerUrl + ')';\n            }\n\n            colorButton.onclick = function(e) {\n                e.preventDefault();\n                selectedIndex = i;\n                update();\n                p.onChange(colorArr[i]);\n            };\n\n            (colorButton as any).setIsSelected = function(b) {\n                if (b) {\n                    BB.css(colorButton, {\n                        boxShadow: '0 0 0 2px var(--active-highlight-color), 0 0 5px 0 var(--active-highlight-color)',\n                        pointerEvents: 'none'\n                    });\n                } else {\n                    BB.css(colorButton, {\n                        boxShadow: '0 0 0 1px #aaa',\n                        pointerEvents: ''\n                    });\n                }\n            };\n\n\n            div.appendChild(colorButton);\n            buttonArr.push(colorButton);\n        })(i);\n    }\n\n\n    function update() {\n        for (let i = 0; i < buttonArr.length; i++) {\n            buttonArr[i].setIsSelected(i === selectedIndex);\n        }\n    }\n    update();\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n\n    this.destroy = () => {\n        buttonArr.forEach(item => {\n            item.onclick = null;\n        });\n        buttonArr.splice(0, buttonArr.length);\n    };\n};","import {BB} from '../../../bb/bb';\n\n/**\n * selectable options\n * p = {\n *     optionArr: {\n *          id: string,\n *          label: string | HTMLElement\n *     }[],\n *     initialId?: string,\n *     onChange: function(id string): void,\n *     changeOnInit?: boolean, // trigger change on creation\n * }\n *\n * @param p\n * @constructor\n */\nexport const Options = function(p) {\n    const div = BB.el({});\n\n    const wrapperEl = BB.el({\n        parent: div,\n        className: 'kl-option-wrapper',\n        css: {\n            display: 'flex'\n        }\n    });\n\n    const optionArr: {\n        id: string;\n        el: HTMLElement;\n    }[] = [];\n    let selectedId = 'initialId' in p ? p.initialId : p.optionArr[0].id;\n\n    function createOption(o) {\n        const optionObj = {\n            id: o.id,\n            el: null,\n        };\n\n        const classArr = ['kl-option'];\n        if (p.isSmall) {\n            classArr.push('kl-option--small');\n        }\n        if (typeof o.label !== 'string') {\n            classArr.push('kl-option--custom-el');\n            BB.css(o.label, {\n                display: 'block',\n                pointerEvents: 'none',\n            });\n        }\n\n        optionObj.el = BB.el({\n            parent: wrapperEl,\n            content: o.label,\n            className: classArr.join(' '),\n            onClick: function() {\n                if (selectedId !== optionObj.id) {\n                    selectedId = optionObj.id;\n                    update();\n                    p.onChange(selectedId);\n                }\n            }\n        });\n\n        if (o.title) {\n            optionObj.el.title = o.title;\n        }\n\n        optionArr.push(optionObj);\n    }\n\n    function update() {\n        for (let i = 0; i < optionArr.length; i++) {\n            if (optionArr[i].id === selectedId) {\n                BB.addClassName(optionArr[i].el, 'kl-option-selected');\n            } else {\n                BB.removeClassName(optionArr[i].el, 'kl-option-selected');\n            }\n        }\n    }\n\n    for (let i = 0; i < p.optionArr.length; i++) {\n        createOption(p.optionArr[i]);\n    }\n\n    update();\n\n    if (p.changeOnInit) {\n        setTimeout(function() {\n            p.onChange(selectedId);\n        }, 0);\n    }\n\n    function getIndex() {\n        for (let i = 0; i < optionArr.length; i++) {\n            if (optionArr[i].id === selectedId) {\n                return i;\n            }\n        }\n    }\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n    this.getValue = function() {\n        return selectedId;\n    }\n    this.next = function() {\n        selectedId = optionArr[(getIndex() + 1) % optionArr.length].id;\n        update();\n        p.onChange(selectedId);\n    };\n    this.previous = function() {\n        selectedId = optionArr[(optionArr.length + getIndex() - 1) % optionArr.length].id;\n        update();\n        p.onChange(selectedId);\n    };\n    this.destroy = () => {\n        optionArr.forEach(item => {\n            BB.destroyEl(item.el);\n        });\n        optionArr.splice(0, optionArr.length);\n    };\n};","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"vALcr\");","import {BB} from '../../../bb/bb';\n\n/**\n * element that lets you crop an image and copy it via right click\n *\n * param = {\n *     width: number,\n *     height: number,\n *     canvas: image | canvas,\n *     isNotCopy: boolean,\n *     onChange: function(width, height)\n * }\n *\n * @param param object\n * @constructor\n */\nexport function CropCopy(param) {\n    const div = document.createElement('div');\n    BB.css(div, {\n        position: 'relative',\n        height: param.height + 'px',\n        width: param.width + 'px',\n        overflow: 'hidden',\n        colorScheme: 'only light',\n    });\n    div.style.position = 'relative';\n\n    let crop;\n    function resetCrop() {\n        crop = {\n            x: 0,\n            y: 0,\n            width: param.canvas.width,\n            height: param.canvas.height\n        };\n    }\n    resetCrop();\n\n\n    function updateCroppedCanvas() {\n        croppedCanvas.width = Math.round(crop.width);\n        croppedCanvas.height = Math.round(crop.height);\n        let ctx = croppedCanvas.getContext('2d');\n        ctx.drawImage(param.canvas, Math.round(-crop.x), Math.round(-crop.y));\n        if (croppedImage) {\n            croppedImage.src = croppedCanvas.toDataURL('image/png');\n        }\n\n        if (param.onChange) {\n            param.onChange(croppedCanvas.width, croppedCanvas.height);\n        }\n    }\n    function updateSelectionRect() {\n        BB.css(selectionRect, {\n            left: (thumbX + crop.x * scaleW) + 'px',\n            top: (thumbY + crop.y * scaleH) + 'px',\n            width: (crop.width * scaleW) + 'px',\n            height: (crop.height * scaleH) + 'px'\n        });\n        if (param.onChange) {\n            param.onChange(Math.round(crop.width), Math.round(crop.height));\n        }\n    }\n    function isInsideSelectionRect(p) {\n        let rect = {\n            x: Math.round(thumbX + crop.x * scaleW),\n            y: Math.round(thumbY + crop.y * scaleH),\n            width: Math.round(crop.width * scaleW),\n            height: Math.round(crop.height * scaleH)\n        };\n        return rect.x <= p.x && p.x <= rect.x + rect.width &&\n            rect.y <= p.y && p.y <= rect.y + rect.height;\n    }\n\n    const croppedCanvas = BB.canvas();\n    let eventTarget = croppedCanvas;\n    let croppedImage = null;\n    if (!param.isNotCopy) { //navigator.appName === 'Microsoft Internet Explorer') { //i would prefer not using an image\n        croppedImage = new Image();\n        eventTarget = croppedImage;\n    }\n    BB.css(eventTarget, {\n        height: param.height + 'px',\n        width: param.width + 'px'\n    });\n    div.appendChild(eventTarget);\n    updateCroppedCanvas();\n\n    const padding = 20;\n    const previewWrapper = BB.el({\n        css: {\n            width: param.width + 'px',\n            height: param.height + 'px',\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            pointerEvents: 'none'\n        }\n    });\n    div.appendChild(previewWrapper);\n    BB.createCheckerDataUrl(4, function(v) {\n        previewWrapper.style.backgroundImage = 'url('+v+')';\n    });\n\n    const thumbSize = BB.fitInto(param.canvas.width, param.canvas.height, param.width - padding * 2, param.height - padding * 2, 1);\n    const thumbCanvas = BB.canvas(Math.round(thumbSize.width), Math.round(thumbSize.height));\n    thumbCanvas.style.imageRendering = 'pixelated';\n    const scaleW = thumbCanvas.width / param.canvas.width;\n    const scaleH = thumbCanvas.height / param.canvas.height;\n    const thumbCtx = thumbCanvas.getContext('2d');\n    thumbCtx.imageSmoothingEnabled = false;\n    thumbCtx.drawImage(param.canvas, 0, 0, thumbCanvas.width, thumbCanvas.height);\n    previewWrapper.appendChild(thumbCanvas);\n    const thumbX = parseInt('' + ((param.width - thumbCanvas.width) / 2));\n    const thumbY = parseInt('' + ((param.height - thumbCanvas.height) / 2));\n    BB.css(thumbCanvas, {\n        position: 'absolute',\n        left: thumbX + \"px\",\n        top: thumbY + \"px\"\n    });\n\n    const selectionRect = BB.el({\n        css: {\n            position: 'absolute',\n            boxShadow: '0 0 0 1px #fff, 0 0 0 2px #000, 0 0 40px 1px #000',\n        }\n    });\n    previewWrapper.appendChild(selectionRect);\n    updateSelectionRect();\n\n\n    function toOriginalSpace(p) {\n        return {\n            x: BB.clamp((p.x - thumbX) / scaleW, 0, param.canvas.width),\n            y: BB.clamp((p.y - thumbY) / scaleH, 0, param.canvas.height),\n        };\n    }\n    //gen crop from thumb-space points\n    function genCrop(p1, p2) {\n        let topLeftP = {\n            x: Math.min(p1.x, p2.x),\n            y: Math.min(p1.y, p2.y)\n        };\n        let bottomRightP = {\n            x: Math.max(p1.x, p2.x),\n            y: Math.max(p1.y, p2.y)\n        };\n        let origTopLeftP = toOriginalSpace(topLeftP);\n        let origBottomRightP = toOriginalSpace(bottomRightP);\n        origTopLeftP.x = Math.floor(origTopLeftP.x);\n        origTopLeftP.y = Math.floor(origTopLeftP.y);\n        origBottomRightP.x = Math.ceil(origBottomRightP.x);\n        origBottomRightP.y = Math.ceil(origBottomRightP.y);\n        return {\n            x: origTopLeftP.x,\n            y: origTopLeftP.y,\n            width: origBottomRightP.x - origTopLeftP.x,\n            height: origBottomRightP.y - origTopLeftP.y\n        };\n    }\n\n    function isReset() {\n        return crop.x === 0 && crop.y === 0 && crop.width === param.canvas.width && crop.height === param.canvas.height;\n    }\n\n    let startP;\n    let startCrop = null;\n    let isDragging = false;\n    let didMove = false;\n    let updateCropTimeout;\n    const pointerListener = new BB.PointerListener({\n        target: eventTarget,\n        fixScribble: true,\n        onPointer: function(event) {\n            let fullPos;\n            if (event.type === 'pointerdown' && event.button === 'left') {\n                event.eventPreventDefault();\n                isDragging = true;\n                startP = {\n                    x: event.relX,\n                    y: event.relY\n                };\n                if (!isReset() && isInsideSelectionRect(startP)) {\n                    startCrop = {\n                        x: crop.x,\n                        y: crop.y,\n                        width: crop.width,\n                        height: crop.height\n                    };\n                } else {\n                    crop = genCrop(startP, startP);\n                }\n            } else if (event.type === 'pointermove' && event.button === 'left') {\n                event.eventPreventDefault();\n                didMove = true;\n                if (startCrop) {\n                    crop.x = startCrop.x + Math.round((event.relX - startP.x) / scaleW);\n                    crop.y = startCrop.y + Math.round((event.relY - startP.y) / scaleH);\n                    crop.x = BB.clamp(crop.x, 0, param.canvas.width - crop.width);\n                    crop.y = BB.clamp(crop.y, 0, param.canvas.height - crop.height);\n                } else {\n                    crop = genCrop(startP, {x: event.relX, y: event.relY});\n                }\n                updateSelectionRect();\n            } else if (event.type === 'pointerup' && startP) {\n                event.eventPreventDefault();\n                isDragging = false;\n                startCrop = null;\n                startP = null;\n                if (crop.width === 0 || crop.height === 0 || !didMove) {\n                    resetCrop();\n                    updateSelectionRect();\n                }\n                didMove = false;\n                updateCropTimeout = setTimeout(updateCroppedCanvas, 1);\n            }\n        }\n    });\n\n    const keyListener = new BB.KeyListener({\n        onDown: function(keyStr, e, comboStr) {\n            if (isDragging) {\n                return;\n            }\n            let doUpdate = false;\n\n            let stepSize = Math.max(1, 1 / scaleW);\n            let shiftIsPressed = keyListener.isPressed('shift');\n\n            if (keyStr === 'left') {\n                if (shiftIsPressed) {\n                    crop.width = BB.clamp(crop.width - stepSize, 1, param.canvas.width - crop.x);\n                } else {\n                    crop.x = BB.clamp(crop.x - stepSize, 0, param.canvas.width - crop.width);\n                }\n                doUpdate = true;\n            }\n            if (keyStr === 'right') {\n                if (shiftIsPressed) {\n                    crop.width = BB.clamp(crop.width + stepSize, 1, param.canvas.width - crop.x);\n                } else {\n                    crop.x = BB.clamp(crop.x + stepSize, 0, param.canvas.width - crop.width);\n                }\n                doUpdate = true;\n            }\n            if (keyStr === 'up') {\n                if (shiftIsPressed) {\n                    crop.height = BB.clamp(crop.height - stepSize, 1, param.canvas.height - crop.y);\n                } else {\n                    crop.y = BB.clamp(crop.y - stepSize, 0, param.canvas.height - crop.height);\n                }\n                doUpdate = true;\n            }\n            if (keyStr === 'down') {\n                if (shiftIsPressed) {\n                    crop.height = BB.clamp(crop.height + stepSize, 1, param.canvas.height - crop.y);\n                } else {\n                    crop.y = BB.clamp(crop.y + stepSize, 0, param.canvas.height - crop.height);\n                }\n                doUpdate = true;\n            }\n\n            if (doUpdate) {\n                e.preventDefault();\n                updateSelectionRect();\n                clearTimeout(updateCropTimeout);\n                updateCropTimeout = setTimeout(updateCroppedCanvas, 100);\n            }\n        }\n    });\n\n    this.getEl = function() {\n        return div;\n    };\n    this.reset = function() {\n        resetCrop();\n        updateCroppedCanvas();\n        updateSelectionRect();\n    };\n    this.destroy = function() {\n        eventTarget.style.removeProperty('width');\n        eventTarget.style.removeProperty('height');\n        keyListener.destroy();\n        pointerListener.destroy();\n    };\n    this.isReset = function() {\n        return isReset();\n    };\n    this.getRect = function() {\n        return JSON.parse(JSON.stringify(crop));\n    };\n    this.getCroppedImage = function() {\n        return croppedCanvas;\n    };\n}\n","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"gShQZ\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"ldqtT\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"apAfQ\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"dpNT8\");","\n/**\n * Flood fill. Tried https://github.com/binarymax/floodfill.js/ but it implemented tolerance wrong, and had bugs.\n * So, my own implementation. can handle tolerance, grow, opacity.\n * Needs to be optimized.\n */\n\n/**\n * Set values in data within rect to 254, unless they're 255\n *\n * @param data Uint8Array\n * @param width int\n * @param x0 int\n * @param y0 int\n * @param x1 int >x0\n * @param y1 int >y0\n */\nfunction fillRect(data, width, x0, y0, x1, y1) {\n    for (let x = x0; x <= x1; x++) {\n        for (let y = y0; y <= y1; y++) {\n            if (data[y * width + x] === 255) {\n                continue;\n            }\n            data[y * width + x] = 254;\n        }\n    }\n}\n\nlet mx, my;\n\n/**\n * Get index i moved by dX, dY. in array with dimensions width height.\n * Returns null if outside bounds.\n *\n * @param width int\n * @param height int\n * @param i int\n * @param dX int\n * @param dY int\n * @returns {null|*}\n */\nfunction moveIndex(width, height, i, dX, dY) {\n    mx = i % width + dX;\n    my = Math.floor(i / width) + dY;\n\n    if (mx < 0 || my < 0 || mx >= width || my >= height) {\n        return null;\n    }\n\n    return my * width + mx;\n}\n\n/**\n * If pixel can be filled (within tolerance) will be set 255 and returns true.\n * returns false if already filled, or i is null\n *\n * @param srcArr Uint8Array rgba\n * @param targetArr Uint8Array\n * @param width int\n * @param height int\n * @param initRgba rgba\n * @param tolerance int 0 - 255\n * @param i int - srcArr index\n * @returns {boolean}\n */\nfunction testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, i) {\n    if (i === null || targetArr[i] === 255) {\n        return false;\n    }\n\n    if (\n        srcArr[i * 4] === initRgba[0] &&\n        srcArr[i * 4 + 1] === initRgba[1] &&\n        srcArr[i * 4 + 2] === initRgba[2] &&\n        srcArr[i * 4 + 3] === initRgba[3]\n    ) {\n        targetArr[i] = 255;\n        return true;\n    }\n\n    if (\n        tolerance > 0 &&\n        Math.abs(srcArr[i * 4] - initRgba[0]) <= tolerance &&\n        Math.abs(srcArr[i * 4 + 1] - initRgba[1]) <= tolerance &&\n        Math.abs(srcArr[i * 4 + 2] - initRgba[2]) <= tolerance &&\n        Math.abs(srcArr[i * 4 + 3] - initRgba[3]) <= tolerance\n    ) {\n        targetArr[i] = 255;\n        return true;\n    }\n\n    return false;\n}\n\n\n/**\n *\n * @param srcArr Uint8Array rgba\n * @param targetArr Uint8Array\n * @param width int\n * @param height int\n * @param px int\n * @param py int\n * @param tolerance int 0 - 255\n * @param grow int >= 0\n * @param isContiguous boolean\n */\nfunction floodFill(srcArr, targetArr, width, height, px, py, tolerance, grow, isContiguous) {\n\n    let initRgba = [\n        srcArr[(py * width + px) * 4],\n        srcArr[(py * width + px) * 4 + 1],\n        srcArr[(py * width + px) * 4 + 2],\n        srcArr[(py * width + px) * 4 + 3]\n    ];\n\n    if (isContiguous) {\n        let q = [];\n        q.push(py * width + px);\n        targetArr[py * width + px] = 255;\n\n        let i, e;\n        while (q.length) {\n            i = q.pop();\n\n            // queue up unfilled neighbors\n            e = moveIndex(width, height, i, -1, 0); // left\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\n\n            e = moveIndex(width, height, i, 1, 0); // right\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\n\n            e = moveIndex(width, height, i, 0, -1); // up\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\n\n            e = moveIndex(width, height, i, 0, 1); // bottom\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, e) && q.push(e);\n        }\n    } else {\n        for (let i = 0; i < width * height; i++) {\n            testAndFill(srcArr, targetArr, width, height, initRgba, tolerance, i);\n        }\n    }\n\n\n    // grow\n    if (grow === 0) {\n        return;\n    }\n\n    // how does it grow? it finds all pixel at the edge.\n    // then depending on what kind of edge it is, it draws a rectangle into target\n    // the rectangle has the value 254, or else it mess it all up.\n    // after it's all done, replaces it with 255\n    let x0, x1, y0, y1;\n    let l, tl, t, tr, r, br, b, bl; // left, top left, top, top right, etc.\n    for (let x = 0; x < width; x++) {\n        for (let y = 0; y < height; y++) {\n            if (targetArr[y * width + x] !== 255) {\n                continue;\n            }\n\n            // bounds of rectangle\n            x0 = x;\n            x1 = x;\n            y0 = y;\n            y1 = y;\n\n            l = targetArr[(y) * width + x - 1] !== 255;\n            tl = targetArr[(y - 1) * width + x - 1] !== 255;\n            t = targetArr[(y - 1) * width + x] !== 255;\n            tr = targetArr[(y - 1) * width + x + 1] !== 255;\n            r = targetArr[(y) * width + x + 1] !== 255;\n            br = targetArr[(y + 1) * width + x + 1] !== 255;\n            b = targetArr[(y + 1) * width + x] !== 255;\n            bl = targetArr[(y + 1) * width + x - 1] !== 255;\n\n            if (l) { // left\n                x0 = x - grow;\n            }\n            if (l && tl && t) { // top left\n                x0 = x - grow;\n                y0 = y - grow;\n            }\n            if (t) { // top\n                y0 = Math.min(y0, y - grow);\n            }\n            if (t && tr && r) { // top right\n                y0 = Math.min(y0, y - grow);\n                x1 = x + grow;\n            }\n            if (r) { // right\n                x1 = Math.max(x1, x + 1 * grow);\n            }\n            if (r && br && b) { // bottom right\n                x1 = Math.max(x1, x + 1 * grow);\n                y1 = Math.max(y1, y + 1 * grow);\n            }\n            if (b) { // bottom\n                y1 = Math.max(y1, y + 1 * grow);\n            }\n            if (b && bl && l) { // bottom left\n                x0 = Math.min(x0, x - 1 * grow);\n                y1 = Math.max(y1, y + 1 * grow);\n            }\n\n            if (!l && !tl && !t && !tr && !r && !br && !b && !bl) {\n                continue;\n            }\n\n            fillRect(\n                targetArr,\n                width,\n                Math.max(0, x0),\n                Math.max(0, y0),\n                Math.min(width - 1, x1),\n                Math.min(height - 1, y1)\n            );\n        }\n    }\n    for (let i = 0; i < width * height; i++) {\n        if (targetArr[i] === 254) {\n            targetArr[i] = 255;\n        }\n    }\n\n}\n\n\n/**\n * Does flood fill, and returns that. an array - 0 not filled. 255 filled\n *\n * returns {\n *     data: Uint8Array\n * }\n *\n * @param rgbaArr Uint8Array rgba\n * @param width int\n * @param height int\n * @param x int\n * @param y int\n * @param tolerance int 0 - 255\n * @param grow int >= 0\n * @param isContiguous boolean\n * @returns {{data: Uint8Array}}\n */\nexport function floodFillBits(rgbaArr, width, height, x, y, tolerance, grow, isContiguous) {\n    x = Math.round(x);\n    y = Math.round(y);\n\n    let resultArr = new Uint8Array(new ArrayBuffer(width * height));\n\n    floodFill(rgbaArr, resultArr, width, height, x, y, tolerance, grow, isContiguous);\n\n    return {\n        data: resultArr\n    }\n}\n","import {BB} from '../../bb/bb';\nimport {IShapeToolObject} from '../kl.types';\n\n\n/**\n * Input processor for shape tool.\n * Coordinates are in canvas space.\n * angleRad is the angle of the canvas.\n *\n * @param p - {onShape: func(isDone, x1, y1, x2, y2, angleRad)}\n * @constructor\n */\nexport function ShapeTool(p) {\n\n    let downX, downY, downAngleRad;\n\n    this.onDown = function(x, y, angleRad) {\n        downX = x;\n        downY = y;\n        downAngleRad = angleRad;\n    };\n\n    this.onMove = function(x, y) {\n        p.onShape(false, downX, downY, x, y, downAngleRad);\n    };\n\n    this.onUp = function(x, y) {\n        p.onShape(true, downX, downY, x, y, downAngleRad);\n    };\n}\n\n/**\n * Draw a shape (rectangle, ellipse, line)\n *\n * @param ctx\n * @param shapeObj\n */\nexport function drawShape(\n    ctx: CanvasRenderingContext2D,\n    shapeObj: IShapeToolObject,\n) {\n\n    if (['rect', 'ellipse', 'line'].includes(shapeObj.type)) {\n        const lineWidth = Math.round(shapeObj.lineWidth);\n        const angleDeg = shapeObj.angleRad * 180 / Math.PI;\n\n        // --- prep canvas ---\n        ctx.save();\n        if (shapeObj.opacity) {\n            ctx.globalAlpha = shapeObj.opacity;\n        }\n        if (shapeObj.isEraser) {\n            ctx.globalCompositeOperation = 'destination-out';\n        }\n        ctx.rotate(-shapeObj.angleRad);\n        if (shapeObj.fillRgb) {\n            ctx.fillStyle = BB.ColorConverter.toRgbStr(shapeObj.fillRgb);\n        } else if (shapeObj.strokeRgb) {\n            ctx.strokeStyle = BB.ColorConverter.toRgbStr(shapeObj.strokeRgb);\n            ctx.lineWidth = lineWidth;\n        }\n\n        let x1 = shapeObj.x1;\n        let y1 = shapeObj.y1;\n        let x2 = shapeObj.x2;\n        let y2 = shapeObj.y2;\n\n        // --- angle snapping ---\n        if (shapeObj.isAngleSnap) {\n            let r1 = BB.rotate(x1, y1, shapeObj.angleRad / Math.PI * 180);\n            let r2 = BB.rotate(x2, y2, shapeObj.angleRad / Math.PI * 180);\n\n            let pAngleDeg = BB.pointsToAngleDeg(r1, r2) + 90;\n            let pAngleDegSnapped = Math.round(pAngleDeg / 45) * 45;\n            let rotated = BB.rotateAround({x: x1, y: y1}, {x: x2, y: y2}, pAngleDegSnapped - pAngleDeg);\n            x2 = rotated.x;\n            y2 = rotated.y;\n\n            // needs to be perfect if p1->p2 aligns with canvas x- or y-axis\n            if ((angleDeg + pAngleDegSnapped) % 90 === 0) {\n                if (Math.round((angleDeg - pAngleDegSnapped) / 90) % 2 === 0) { // up or down\n                    x2 = x1;\n                } else { // left or right\n                    y2 = y1;\n                }\n            }\n        }\n\n        let x = x1;\n        let y = y1;\n        let dX = x2 - x1;\n        let dY = y2 - y1;\n\n        // --- 1:1 ratio ---\n        if (shapeObj.type !== 'line' && shapeObj.isFixedRatio) {\n            let r1 = BB.rotate(shapeObj.x1, shapeObj.y1, shapeObj.angleRad / Math.PI * 180);\n            let r2 = BB.rotate(shapeObj.x2, shapeObj.y2, shapeObj.angleRad / Math.PI * 180);\n\n            let rx = r1.x;\n            let ry = r1.y;\n            let rdX = r2.x - r1.x;\n            let rdY = r2.y - r1.y;\n\n            if (Math.abs(rdX) < Math.abs(rdY)) {\n                rdY = Math.abs(rdX) * (rdY < 0 ? -1 : 1);\n            } else {\n                rdX = Math.abs(rdY) * (rdX < 0 ? -1 : 1);\n            }\n            r2.x = rx + rdX;\n            r2.y = ry + rdY;\n\n            r1 = BB.rotate(r1.x, r1.y, -shapeObj.angleRad / Math.PI * 180);\n            r2 = BB.rotate(r2.x, r2.y, -shapeObj.angleRad / Math.PI * 180);\n\n            x1 = r1.x;\n            y1 = r1.y;\n            x2 = r2.x;\n            y2 = r2.y;\n\n            x = x1;\n            y = y1;\n            dX = x2 - x1;\n            dY = y2 - y1;\n        }\n\n        // outwards modifier\n        if (shapeObj.isOutwards) {\n            x -= dX;\n            y -= dY;\n            dX *= 2;\n            dY *= 2;\n\n            x1 = x;\n            y1 = y;\n            x2 = x + dX;\n            y2 = y + dY;\n        }\n\n        let p1;\n        let p2;\n        if (shapeObj.type === 'line') { // --- line ---\n\n            // rounded\n            const x1r = Math.round(x1);\n            const y1r = Math.round(y1);\n            const x2r = Math.round(x2);\n            const y2r = Math.round(y2);\n\n            // floored\n            const x1f = Math.floor(x1);\n            const y1f = Math.floor(y1);\n            const x2f = Math.floor(x2);\n            const y2f = Math.floor(y2);\n\n            if (lineWidth % 2 === 0) {\n\n                if (y1r === y2r) {\n                    p1 = {\n                        x: x1f,\n                        y: y1r,\n                    };\n                    p2 = {\n                        x: x2f,\n                        y: y2r,\n                    };\n\n                    if (x1f < x2f) {\n                        p2.x += 1;\n                    } else {\n                        p1.x += 1;\n                    }\n                } else if (x1r === x2r) {\n                    p1 = {\n                        x: x1r,\n                        y: y1f,\n                    };\n                    p2 = {\n                        x: x2r,\n                        y: y2f,\n                    };\n\n                    if (y1f < y2f) {\n                        p2.y += 1;\n                    } else {\n                        p1.y += 1;\n                    }\n                } else {\n                    p1 = {\n                        x: x1,\n                        y: y1,\n                    };\n                    p2 = {\n                        x: x2,\n                        y: y2,\n                    };\n                }\n\n            } else {\n                p1 = {\n                    x: x1f,\n                    y: y1f,\n                };\n                p2 = {\n                    x: x2f,\n                    y: y2f,\n                };\n                if (y1f === y2f) {\n                    if (x1f < x2f) {\n                        p2.x += 1;\n                    } else {\n                        p1.x += 1;\n                    }\n                    p1.y += 0.5;\n                    p2.y += 0.5;\n                } else if (x1f === x2f) {\n                    if (y1f < y2f) {\n                        p2.y += 1;\n                    } else {\n                        p1.y += 1;\n                    }\n                    p1.x += 0.5;\n                    p2.x += 0.5;\n                } else {\n                    p1.x = x1;\n                    p1.y = y1;\n                    p2.x = x2;\n                    p2.y = y2;\n                }\n            }\n\n            p1 = BB.rotate(p1.x, p1.y, shapeObj.angleRad / Math.PI * 180);\n            p2 = BB.rotate(p2.x, p2.y, shapeObj.angleRad / Math.PI * 180);\n\n            ctx.beginPath();\n            ctx.moveTo(p1.x, p1.y);\n            ctx.lineTo(p2.x, p2.y);\n            ctx.stroke();\n\n        } else if (shapeObj.type === 'rect') { // --- rect ---\n\n            // floored\n            const x1f = Math.floor(x1);\n            const y1f = Math.floor(y1);\n            const x2f = Math.floor(x2);\n            const y2f = Math.floor(y2);\n\n            if (angleDeg % 90 === 0) {\n                if (shapeObj.fillRgb) {\n                    if (x1 % 1 === 0) {\n                        x1 += 1;\n                    }\n                    if (y1 % 1 === 0) {\n                        y1 += 1;\n                    }\n                    if (x2 % 1 === 0) {\n                        x2 += 1;\n                    }\n                    if (y2 % 1 === 0) {\n                        y2 += 1;\n                    }\n\n                    p1 = {\n                        x: x1 < x2 ? x1f : x2f,\n                        y: y1 < y2 ? y1f : y2f,\n                    };\n                    p2 = {\n                        x: Math.ceil((x1 < x2 ? x2 : x1) - p1.x),\n                        y: Math.ceil((y1 < y2 ? y2 : y1) - p1.y),\n                    };\n                    p2.x = p1.x + p2.x;\n                    p2.y = p1.y + p2.y;\n\n                } else {\n                    if (lineWidth % 2 === 0) {\n                        p1 = {\n                            x: x1f,\n                            y: y1f,\n                        };\n                        p2 = {\n                            x: x2f,\n                            y: y2f,\n                        };\n                    } else {\n                        p1 = {\n                            x: x1f + 0.5,\n                            y: y1f + 0.5,\n                        };\n                        p2 = {\n                            x: x2f + 0.5,\n                            y: y2f + 0.5,\n                        };\n                    }\n                }\n            } else {\n                p1 = {\n                    x: x1,\n                    y: y1,\n                };\n                p2 = {\n                    x: x2,\n                    y: y2,\n                };\n            }\n\n            p1 = BB.rotate(p1.x, p1.y, shapeObj.angleRad / Math.PI * 180);\n            p2 = BB.rotate(p2.x, p2.y, shapeObj.angleRad / Math.PI * 180);\n            p2.x = p2.x - p1.x;\n            p2.y = p2.y - p1.y;\n\n            if (shapeObj.fillRgb) {\n                ctx.fillRect(p1.x, p1.y, p2.x, p2.y);\n            } else {\n                ctx.strokeRect(p1.x, p1.y, p2.x, p2.y);\n            }\n\n        } else {  // --- circle ---\n            p1 = BB.rotate(x1, y1, shapeObj.angleRad / Math.PI * 180);\n            p2 = BB.rotate(x2, y2, shapeObj.angleRad / Math.PI * 180);\n            x = p1.x;\n            y = p1.y;\n            dX = p2.x - p1.x;\n            dY = p2.y - p1.y;\n\n            ctx.beginPath();\n            ctx.ellipse(x + dX / 2, y + dY / 2, Math.abs(dX / 2), Math.abs(dY / 2), 0, 0, Math.PI * 2);\n            if (shapeObj.fillRgb) {\n                ctx.fill();\n            } else {\n                ctx.stroke();\n            }\n        }\n\n\n        ctx.restore();\n\n    } else {\n        throw new Error('unknown shape');\n    }\n}","import {BB} from '../../bb/bb';\nimport {IRect} from '../../bb/bb.types';\n\nexport interface IRenderTextParam {\n    textStr: string; // text to be drawn. can contain newlines\n    x: number;\n    y: number;\n    size: number;\n    font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy'; // default sans-serif\n    align: 'left' | 'center' | 'right'; // default 'left'\n    isBold: boolean; // default false\n    isItalic: boolean; // default false\n    angleRad: number; // default 0 - rotates around x y\n    lineHeight?: number; // pixels\n    color: string;\n    isDebug?: boolean;\n}\n\n\n/**\n * Draw text on a canvas.\n *\n * @param canvas\n * @param p\n * @returns - bounds. coords relative to p.x p.y\n */\nexport function renderText(canvas: HTMLCanvasElement, p: IRenderTextParam): IRect {\n\n    // always at least a space. so bounds aren't just a dot\n    let textStr = p.textStr === '' ? ' ' : p.textStr;\n\n    // --- create el ---\n    // create an actual dom element. figure out where exactly each letter is positioned.\n    // that way multiline is feasible. canvas can't do multiline or text-align\n    let outer = BB.el({\n        css: {\n            position: 'fixed',\n            left: '0',\n            top: '0',\n            width: '100000px',\n            fontSize: p.size + 'px',\n            lineHeight: p.lineHeight ? p.lineHeight + 'px' : 'default',\n        }\n    });\n    let div = BB.el({\n        parent: outer,\n        css: {\n            display: 'inline-block',\n            textAlign: p.align ? p.align : 'left',\n            fontFamily: p.font ? p.font : 'sans-serif',\n            fontSize: p.size + 'px',\n            fontWeight: p.isBold ? 'bold' : 'normal',\n            fontStyle: p.isItalic ? 'italic' : 'normal',\n            lineHeight: p.lineHeight ? p.lineHeight + 'px' : 'default',\n\n\n            opacity: '0',\n            pointerEvents: 'none'\n        }\n    });\n    let spanStr = '';\n    let replaceObj = {\n        \"\\n\": '<br>',\n        \" \": '&nbsp;',\n        \"\t\": '&nbsp;&nbsp;&nbsp;&nbsp;',\n    };\n    for (let i = 0; i < textStr.length; i++) {\n        if (textStr[i] === \"\\n\") {\n            div.appendChild(BB.el({\n                tagName: 'span',\n                textContent: spanStr,\n                css: {\n                    whiteSpace: 'pre'\n                }\n            }));\n            spanStr = '';\n            div.appendChild(BB.el({\n                tagName: 'br'\n            }));\n            continue;\n        }\n        spanStr += textStr[i].replace(\"\\t\", '    ');\n    }\n    div.appendChild(BB.el({\n        tagName: 'span',\n        textContent: spanStr,\n        css: {\n            whiteSpace: 'pre'\n        }\n    }));\n    document.body.appendChild(outer);\n\n\n    // --- determine bounds ---\n    let bounds = {\n        x0: 99999999,\n        y0: 99999999,\n        x1: 0,\n        y1: 0\n    }\n    for (let i = 0; i < div.children.length; i++) {\n        let el = div.children[i] as HTMLElement;\n        bounds.x0 = Math.min(bounds.x0, el.offsetLeft);\n        bounds.y0 = Math.min(bounds.y0, el.offsetTop);\n        bounds.x1 = Math.max(bounds.x1, el.offsetLeft + el.offsetWidth);\n        bounds.y1 = Math.max(bounds.y1, el.offsetTop + el.offsetHeight);\n    }\n\n    // --- draw ---\n    let ctx = canvas.getContext('2d');\n    ctx.save();\n\n    let font = [];\n    if (p.isItalic) {\n        font.push('italic');\n    }\n    if (p.isBold) {\n        font.push('bold');\n    }\n    font.push(p.size + 'px ' + (p.font ? p.font : 'sans-serif'));\n    ctx.font = font.join(' ');\n    ctx.fillStyle = p.color ? p.color : '#000';\n\n    let x = p.x;\n    let y = p.y;\n    if (p.align === 'right') {\n        x += -bounds.x1 + bounds.x0;\n    }\n    if (p.align === 'center') {\n        x += (-bounds.x1 + bounds.x0) / 2;\n    }\n    ctx.translate(p.x, p.y);\n    ctx.rotate(p.angleRad ? -p.angleRad : 0);\n    ctx.translate(-p.x, -p.y);\n    ctx.translate(x, y);\n\n    // fill\n    for (let i = 0; i < div.children.length; i++) {\n        let el = div.children[i] as HTMLElement;\n\n        //ctx.fillText(el.innerText, 0, 0);\n        ctx.fillText(el.innerText, el.offsetLeft, el.offsetTop);\n    }\n\n    if (p.isDebug) {\n        ctx.lineWidth = 1;\n        ctx.strokeRect(0, -p.size * 0.85, bounds.x1, bounds.y1);\n        ctx.restore();\n        ctx.fillRect(p.x - 1, p.y - 1, 2, 2);\n    } else {\n        ctx.restore();\n    }\n\n    document.body.removeChild(outer);\n\n    return {\n        x: x - p.x,\n        y: y - p.y -p.size * 0.85,\n        width: bounds.x1 - bounds.x0,\n        height: bounds.y1 - bounds.y0\n    };\n}","import {BB} from '../../bb/bb';\nimport {IKlProject} from '../kl.types';\n\nexport function drawProject(project: IKlProject, factor) {\n    let resultCanvas = BB.canvas(\n        Math.max(1, Math.round(project.width * factor)),\n        Math.max(1, Math.round(project.height * factor))\n    );\n    let ctx = resultCanvas.getContext(\"2d\");\n    ctx.save();\n    if (factor > 1) {\n        ctx.imageSmoothingEnabled = false;\n    }\n    for (let i = 0; i < project.layers.length; i++) {\n        if (project.layers[i].opacity === 0) {\n            continue;\n        }\n        ctx.globalAlpha = project.layers[i].opacity;\n        ctx.globalCompositeOperation = project.layers[i].mixModeStr ? project.layers[i].mixModeStr : 'source-over';\n        ctx.drawImage(project.layers[i].image, 0, 0, resultCanvas.width, resultCanvas.height);\n    }\n    ctx.restore();\n    return resultCanvas;\n}","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"5E29d\");","import {BB} from '../../bb/bb';\nimport {floodFillBits} from '../image-operations/flood-fill';\nimport {drawShape} from '../image-operations/shape-tool';\nimport {IRenderTextParam, renderText} from '../image-operations/render-text';\nimport {IKlProject, IMixMode, IRGB, IShapeToolObject} from '../kl.types';\nimport {DecoyKlHistory, KlHistoryInterface} from '../history/kl-history';\nimport {drawProject} from './draw-project';\nimport {LANG} from '../../language/language';\n\n\nconst allowedMixModes = [\n    'source-over',\n    'darken',\n    'multiply',\n    'color-burn',\n    'lighten',\n    'screen',\n    'color-dodge',\n    'overlay',\n    'soft-light',\n    'hard-light',\n    'difference',\n    'exclusion',\n    'hue',\n    'saturation',\n    'color',\n    'luminosity',\n];\n\nexport const MAX_LAYERS = 16;\n\ninterface KlCanvasLayer extends HTMLCanvasElement {\n    name: string;\n    mixModeStr: IMixMode;\n    opacity: number;\n    compositeObj?: {\n        draw: (ctx: CanvasRenderingContext2D) => void;\n    },\n    index: number; // certain brushes need to know\n}\n\n/**\n * The image/canvas that the user paints on\n * Has layers. layers have names and opacity.\n *\n * Interacts with the history you specify (for undo/redo)\n */\nexport class KlCanvas {\n\n    // todo changeListener consistent concept\n    // todo history interaction, consistent concept - currently have to look at code to know if something pushes on history\n\n    private width: number;\n    private height: number;\n    private layerCanvasArr: KlCanvasLayer[];\n    private pickCanvas: HTMLCanvasElement; // canvas to draw into for color picker\n    private history: KlHistoryInterface;\n    private changeListenerArr:  (() => void)[]; // subscribers get notified when opacity changes\n\n\n    private init (w: number, h: number): void {\n        if (!w || !h || isNaN(w) || isNaN(h) || w < 1 || h < 1) {\n            throw new Error('init - invalid canvas size');\n        }\n        this.width = w;\n        this.height = h;\n    }\n\n    private emitChange (): void {\n        // some changes don't get captured by the history - e.g. changing opacity as the user drags the slider\n        this.changeListenerArr.forEach(item => item());\n    }\n\n    private updateIndices (): void {\n        this.layerCanvasArr.forEach((item, index) => {\n            item.index = index;\n        });\n    }\n\n    // ---- public ----\n\n    constructor (\n        params: {\n            projectObj: {\n                width: number;\n                height: number;\n                layers: {\n                    name: string;\n                    opacity: number;\n                    image: HTMLImageElement | HTMLCanvasElement; // already loaded!\n                }[];\n            }\n        } | {\n            // creates blank KlCanvas, 0 layers\n            width: number;\n            height: number;\n        } | {\n            copy: KlCanvas;\n        },\n        private layerNrOffset: number = 0,\n    ) {\n        this.layerCanvasArr = [];\n        this.pickCanvas = BB.canvas(1, 1);\n        this.history = new DecoyKlHistory();\n        if ('copy' in params) {\n            this.width = 1;\n            this.height = 1;\n        } else {\n            if ('width' in params && 'height' in params) {\n                this.width = params.width;\n                this.height = params.height;\n            } else {\n                this.width = 1;\n                this.height = 1;\n            }\n        }\n        this.init(this.width, this.height);\n\n        this.changeListenerArr = [];\n\n        if ('copy' in params) {\n            this.copy(params.copy);\n        } else if ('projectObj' in params) {\n            const origLayers = [].concat(params.projectObj.layers);\n            this.init(params.projectObj.width, params.projectObj.height);\n\n            if (!origLayers.length) {\n                throw new Error('project.layers needs at least 1 layer');\n            }\n\n            for (let i = 0; i < origLayers.length; i++) {\n                if (origLayers[i].mixModeStr && !allowedMixModes.includes(origLayers[i].mixModeStr)) {\n                    throw new Error('unknown mixModeStr ' + origLayers[i].mixModeStr);\n                }\n\n                this.addLayer();\n                this.layerOpacity(i, origLayers[i].opacity);\n                this.layerCanvasArr[i].name = origLayers[i].name;\n                this.layerCanvasArr[i].mixModeStr = origLayers[i].mixModeStr ? origLayers[i].mixModeStr : 'source-over';\n                this.layerCanvasArr[i].getContext(\"2d\").drawImage(origLayers[i].image, 0, 0);\n            }\n        }\n        this.updateIndices();\n    }\n\n    setHistory (h: KlHistoryInterface): void {\n        this.history = h;\n    }\n\n    /**\n     * Resets canvas -> 1 layer, 100% opacity,\n     * unless layers provided.\n     * @param p\n     */\n    reset (\n        p: {\n            width: number;\n            height: number;\n            color?: IRGB; // optional - fill color\n            image?: HTMLImageElement | HTMLCanvasElement; // image drawn on layer\n            layerName?: string; // if via image\n            layers?: {\n                name: string;\n                opacity: number;\n                mixModeStr: IMixMode;\n                image: HTMLCanvasElement;\n            }[];\n        }\n    ): void | number {\n        if (!p.width || !p.height || p.width < 1 || p.height < 1 || isNaN(p.width) || isNaN(p.height) ) {\n            throw new Error('invalid canvas size');\n        }\n\n        this.history.pause(true);\n\n        this.width = p.width;\n        this.height = p.height;\n\n        this.layerCanvasArr.splice(1, Math.max(0, this.layerCanvasArr.length - 1));\n\n        if (p.layers) {\n            for (let i = 0; i < p.layers.length; i++) {\n                let item = p.layers[i];\n                if (!this.layerCanvasArr[i]) {\n                    this.addLayer();\n                }\n                this.layerCanvasArr[i].name = item.name;\n                this.layerCanvasArr[i].width = this.width;\n                this.layerCanvasArr[i].height = this.height;\n                this.layerCanvasArr[i].mixModeStr = item.mixModeStr ? item.mixModeStr : 'source-over';\n                this.layerCanvasArr[i].getContext(\"2d\").drawImage(item.image, 0, 0);\n                this.layerOpacity(i, item.opacity);\n            }\n        } else {\n            this.layerCanvasArr[0].name = p.layerName ? p.layerName : LANG('layers-layer') + \" 1\";\n            this.layerCanvasArr[0].width = this.width;\n            this.layerCanvasArr[0].height = this.height;\n            this.layerCanvasArr[0].mixModeStr = 'source-over';\n            this.layerOpacity(0, 1);\n            if (p.color) {\n                this.layerFill(0, p.color);\n            } else if (p.image) {\n                this.layerCanvasArr[0].getContext(\"2d\").drawImage(p.image, 0, 0);\n            }\n        }\n        this.updateIndices();\n\n        this.history.pause(false);\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"reset\",\n            params: [p] // dont screw with p\n        });\n\n        return this.layerCanvasArr.length - 1;\n    }\n\n    isLayerLimitReached (): boolean {\n        return this.layerCanvasArr.length >= MAX_LAYERS;\n    }\n\n    getWidth (): number {\n        return this.width;\n    }\n\n    getHeight (): number {\n        return this.height;\n    }\n\n    copy (toCopyCanvas: KlCanvas): void {\n        if (\n            toCopyCanvas.getWidth() < 1 ||\n            toCopyCanvas.getHeight() < 1 ||\n            isNaN(toCopyCanvas.getWidth()) ||\n            isNaN(toCopyCanvas.getHeight())\n        ) {\n            throw new Error('invalid canvas size');\n        }\n\n        // keep existing canvases\n\n        let origLayers = toCopyCanvas.getLayers();\n\n        while (this.layerCanvasArr.length > origLayers.length) {\n            this.removeLayer(this.layerCanvasArr.length - 1);\n        }\n\n        if (toCopyCanvas.getWidth() != this.width || toCopyCanvas.getHeight() != this.height) {\n            this.init(toCopyCanvas.getWidth(), toCopyCanvas.getHeight());\n        }\n        for (let i = 0; i < origLayers.length; i++) {\n            if (i >= this.layerCanvasArr.length) {\n                this.addLayer();\n            } else {\n                this.layerCanvasArr[i].width = this.width;\n                this.layerCanvasArr[i].height = this.height;\n            }\n            this.layerOpacity(i, origLayers[i].opacity);\n            this.layerCanvasArr[i].name = origLayers[i].name;\n            this.layerCanvasArr[i].mixModeStr = origLayers[i].mixModeStr;\n            this.layerCanvasArr[i].getContext(\"2d\").drawImage(origLayers[i].context.canvas, 0, 0);\n        }\n        this.updateIndices();\n    }\n\n    getLayerCount (): number {\n        return this.layerCanvasArr.length;\n    }\n\n    resize (w: number, h: number, algorithm: 'smooth' | 'pixelated' = 'smooth'): boolean {\n        if (!w || !h || (w === this.width && h === this.height) || isNaN(w) || isNaN(h) || w < 1 || h < 1) {\n            return false;\n        }\n        w = Math.max(w, 1);\n        h = Math.max(h, 1);\n\n        let tmp1, tmp2;\n\n        if (algorithm === 'pixelated') {\n            tmp1 = BB.canvas(w, h);\n            let tmp1Ctx = tmp1.getContext('2d');\n            tmp1Ctx.imageSmoothingEnabled = false;\n            for (let i = 0; i < this.layerCanvasArr.length; i++) {\n                if (i > 0) {\n                    tmp1Ctx.clearRect(0, 0, w, h);\n                }\n                let layerCanvas = this.layerCanvasArr[i];\n                tmp1Ctx.drawImage(layerCanvas, 0, 0, w, h);\n                layerCanvas.width = w;\n                layerCanvas.height = h;\n                let layerContext = layerCanvas.getContext('2d');\n                layerContext.drawImage(tmp1, 0, 0);\n            }\n\n        } else if (algorithm === 'smooth') {\n            tmp1 = BB.canvas();\n            tmp2 = BB.canvas();\n            for (let i = 0; i < this.layerCanvasArr.length; i++) {\n                BB.resizeCanvas(this.layerCanvasArr[i], w, h, tmp1, tmp2);\n            }\n        } else {\n            throw new Error('unknown resize algorithm');\n        }\n\n        this.width = w;\n        this.height = h;\n        return true;\n    }\n\n    /**\n     * crop / extend\n     * @param p\n     */\n    resizeCanvas (p: {\n        left: number;\n        top: number;\n        right: number;\n        bottom: number;\n        fillColor?: IRGB\n    }): void {\n\n        const newW = Math.round(p.left) + this.width + Math.round(p.right);\n        const newH = Math.round(p.top) + this.height + Math.round(p.bottom);\n        const offX = Math.round(p.left);\n        const offY = Math.round(p.top);\n\n        if (isNaN(newW) || isNaN(newH) || newW < 1 || newH < 1) {\n            throw new Error('KlCanvas.resizeCanvas - invalid canvas size');\n        }\n\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\n            const ctemp = BB.canvas(this.width, this.height);\n            let layerCanvas = this.layerCanvasArr[i];\n            let layerCtx = this.layerCanvasArr[i].getContext(\"2d\");\n            ctemp.getContext(\"2d\").drawImage(layerCanvas, 0, 0);\n\n            this.layerCanvasArr[i].width = newW;\n            this.layerCanvasArr[i].height = newH;\n\n            layerCtx.save();\n            if (i === 0 && p.fillColor) {\n                layerCtx.fillStyle = BB.ColorConverter.toRgbStr(p.fillColor);\n                layerCtx.fillRect(0, 0, newW, newH);\n                layerCtx.clearRect(offX, offY, this.width, this.height);\n            }\n            layerCtx.drawImage(ctemp, offX, offY);\n            layerCtx.restore();\n        }\n        this.width = newW;\n        this.height = newH;\n    }\n\n    /**\n     * will be inserted on top of selected\n     * @param selected\n     */\n    addLayer (selected?: number): false | number {\n        if (this.isLayerLimitReached()) {\n            return false;\n        }\n        let canvas = BB.canvas(this.width, this.height);\n        (canvas as any).mixModeStr = 'source-over';\n\n        if (selected === undefined) {\n            this.layerCanvasArr[this.layerCanvasArr.length] = canvas as any;\n            selected = Math.max(0, this.layerCanvasArr.length - 1);\n        } else {\n            this.layerCanvasArr.splice(selected + 1, 0, canvas as any);\n            selected++;\n        }\n\n        (canvas as any).name = LANG('layers-layer') + \" \" + (this.layerCanvasArr.length + this.layerNrOffset);\n        this.history.pause(true);\n        this.layerOpacity(selected, 1);\n        this.history.pause(false);\n        this.updateIndices();\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"addLayer\",\n            params: [selected - 1]\n        });\n        return selected;\n    }\n\n    duplicateLayer (i: number): false | number {\n        if (!this.layerCanvasArr[i] || this.isLayerLimitReached()) {\n            return false;\n        }\n        let canvas = BB.canvas(this.width, this.height);\n        this.layerCanvasArr.splice(i + 1, 0, canvas as any);\n\n        (canvas as any).name = this.layerCanvasArr[i].name + \" \" + LANG('layers-copy');\n        (canvas as any).mixModeStr = this.layerCanvasArr[i].mixModeStr;\n        canvas.getContext(\"2d\").drawImage(this.layerCanvasArr[i], 0, 0);\n        this.history.pause(true);\n        this.layerOpacity(i + 1, this.layerCanvasArr[i].opacity);\n        this.history.pause(false);\n\n        this.updateIndices();\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"duplicateLayer\",\n            params: [i]\n        });\n        return i + 1;\n    }\n\n    getLayerContext (i: number, doReturnNull?: boolean): CanvasRenderingContext2D | null {\n        if (this.layerCanvasArr[i]) {\n            return this.layerCanvasArr[i].getContext(\"2d\");\n        }\n        if (doReturnNull) {\n            return null;\n        }\n        throw new Error(\"layer of index \" + i + \" not found (in \" + this.layerCanvasArr.length + \" layers)\");\n    }\n\n    removeLayer (i: number): false | number {\n        if (this.layerCanvasArr[i]) {\n            this.layerCanvasArr.splice(i, 1);\n            this.updateIndices();\n        } else {\n            return false;\n        }\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"removeLayer\",\n            params: [i]\n        });\n\n        return Math.max(0, i - 1);\n    }\n\n    renameLayer (i: number, name: string): boolean {\n        if (this.layerCanvasArr[i]) {\n            this.layerCanvasArr[i].name = name;\n        } else {\n            return false;\n        }\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"renameLayer\",\n            params: [i, name]\n        });\n\n        return true;\n    }\n\n    layerOpacity (i: number, o: number): void {\n        if (!this.layerCanvasArr[i]) {\n            return;\n        }\n        o = Math.max(0, Math.min(1, o));\n        this.layerCanvasArr[i].opacity = o;\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"layerOpacity\",\n            params: [i, o]\n        });\n\n        this.emitChange();\n    }\n\n    moveLayer (i: number, d: number): void | number {\n        if (d === 0) {\n            return;\n        }\n        if (this.layerCanvasArr[i]) {\n            const temp = this.layerCanvasArr[i];\n            this.layerCanvasArr.splice(i, 1);\n            const targetIndex = Math.max(0, Math.min(i + d, this.layerCanvasArr.length));\n            this.layerCanvasArr.splice(targetIndex, 0, temp);\n            this.updateIndices();\n            this.history.push({\n                tool: [\"canvas\"],\n                action: \"moveLayer\",\n                params: [i, d]\n            });\n            return targetIndex;\n        }\n    }\n\n    mergeLayers (layerBottomIndex: number, layerTopIndex: number, mixModeStr: IMixMode | 'as-alpha'): void | number {\n        if (\n            !this.layerCanvasArr[layerBottomIndex] ||\n            !this.layerCanvasArr[layerTopIndex] ||\n            layerBottomIndex === layerTopIndex\n        ) {\n            return;\n        }\n        //order messed up\n        if (layerBottomIndex > layerTopIndex) {\n            let temp = layerBottomIndex;\n            layerBottomIndex = layerTopIndex;\n            layerTopIndex = temp;\n        }\n\n        let topOpacity = this.layerCanvasArr[layerTopIndex].opacity;\n        if (topOpacity !== 0 && topOpacity) {\n            let ctx = this.layerCanvasArr[layerBottomIndex].getContext(\"2d\");\n            ctx.save();\n\n            if (mixModeStr === 'as-alpha') { // todo remove this?\n\n                BB.convertToAlphaChannelCanvas(this.layerCanvasArr[layerTopIndex]);\n                ctx.globalCompositeOperation = 'destination-in';\n                ctx.globalAlpha = topOpacity;\n                this.layerCanvasArr[layerBottomIndex].getContext(\"2d\").drawImage(this.layerCanvasArr[layerTopIndex], 0, 0);\n\n            } else {\n\n                if (mixModeStr) {\n                    ctx.globalCompositeOperation = mixModeStr;\n                }\n                ctx.globalAlpha = topOpacity;\n                this.layerCanvasArr[layerBottomIndex].getContext(\"2d\").drawImage(this.layerCanvasArr[layerTopIndex], 0, 0);\n\n            }\n\n            ctx.restore();\n\n            // workaround for chrome bug https://bugs.chromium.org/p/chromium/issues/detail?id=1281185\n            // TODO remove if chrome updated\n            if (mixModeStr) {\n                ctx.save();\n                ctx.fillStyle = \"rgba(0,0,0,0.01)\";\n                ctx.fillRect(-0.9999999, -0.9999999, 1, 1);\n                ctx.restore();\n            }\n        }\n        this.updateIndices();\n        this.history.pause(true);\n        this.removeLayer(layerTopIndex);\n        this.history.pause(false);\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"mergeLayers\",\n            params: [layerBottomIndex, layerTopIndex, mixModeStr]\n        });\n\n        return layerBottomIndex;\n    }\n\n    rotate (deg: number): void {\n        while (deg < 0) {\n            deg += 360;\n        }\n        deg %= 360;\n        if (deg % 90 != 0 || deg === 0)\n            return;\n        let temp = BB.canvas();\n        if (deg === 0 || deg === 180) {\n            temp.width = this.width;\n            temp.height = this.height;\n        } else if (deg === 90 || deg === 270) {\n            temp.width = this.height;\n            temp.height = this.width;\n        }\n        let ctx = temp.getContext(\"2d\");\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\n            ctx.clearRect(0, 0, temp.width, temp.height);\n            ctx.save();\n            ctx.translate(temp.width / 2, temp.height / 2);\n            ctx.rotate(deg * Math.PI / 180);\n            if (deg === 180) {\n                ctx.drawImage(this.layerCanvasArr[i], -temp.width / 2, -temp.height / 2);\n            } else if (deg === 90 || deg === 270) {\n                ctx.drawImage(this.layerCanvasArr[i], -temp.height / 2, -temp.width / 2);\n            }\n            this.layerCanvasArr[i].width = temp.width;\n            this.layerCanvasArr[i].height = temp.height;\n            this.layerCanvasArr[i].getContext(\"2d\").clearRect(0, 0, this.layerCanvasArr[i].width, this.layerCanvasArr[i].height);\n            this.layerCanvasArr[i].getContext(\"2d\").drawImage(temp, 0, 0);\n            ctx.restore();\n        }\n        this.width = temp.width;\n        this.height = temp.height;\n    }\n\n    flip (isHorizontal: boolean, isVertical: boolean, layerIndex: number): void {\n        if (!isHorizontal && !isVertical) {\n            return;\n        }\n\n        let temp = BB.canvas(this.width, this.height);\n        temp.width = this.width;\n        temp.height = this.height;\n        let tempCtx = temp.getContext(\"2d\");\n\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\n\n            if ( (layerIndex || layerIndex === 0) && i !== layerIndex) {\n                continue;\n            }\n\n            tempCtx.save();\n            tempCtx.clearRect(0, 0, temp.width, temp.height);\n            tempCtx.translate(temp.width / 2, temp.height / 2);\n            tempCtx.scale((isHorizontal ? -1 : 1), (isVertical ? -1 : 1));\n            tempCtx.drawImage(this.layerCanvasArr[i], -temp.width / 2, -temp.height / 2);\n            tempCtx.restore();\n\n            this.layerCanvasArr[i].getContext(\"2d\").clearRect(0, 0, this.layerCanvasArr[i].width, this.layerCanvasArr[i].height);\n            this.layerCanvasArr[i].getContext(\"2d\").drawImage(temp, 0, 0);\n        }\n    }\n\n    layerFill (layerIndex: number, colorObj: IRGB, compositeOperation?: string): void {\n        let ctx = this.layerCanvasArr[layerIndex].getContext(\"2d\");\n        ctx.save();\n        if (compositeOperation) {\n            ctx.globalCompositeOperation = compositeOperation;\n        }\n        ctx.fillStyle = \"rgba(\" + colorObj.r + \",\" + colorObj.g + \",\" + colorObj.b + \",1)\";\n        ctx.fillRect(0, 0, this.layerCanvasArr[layerIndex].width, this.layerCanvasArr[layerIndex].height);\n        ctx.restore();\n\n        // workaround for chrome bug https://bugs.chromium.org/p/chromium/issues/detail?id=1281185\n        // TODO remove if chrome updated\n        ctx.save();\n        ctx.fillStyle = \"rgba(0,0,0,0.01)\";\n        ctx.fillRect(-0.9999999, -0.9999999, 1, 1);\n        ctx.restore();\n\n        /*if (!document.getElementById('testocanvas')) {\n            layerCanvasArr[layerIndex].id = 'testocanvas';\n            document.body.appendChild(layerCanvasArr[layerIndex]);\n            BB.css(layerCanvasArr[layerIndex], {\n                position: 'fixed',\n                left: '0',\n                top: '0',\n                zIndex: '1111111',\n                transform: 'scale(0.2)',\n                border: '10px solid red',\n            });\n        }\n        if (!document.getElementById('testocanvas')) {\n            let c = document.createElement('canvas');\n            c.width = 1000;\n            c.height = 1000;\n            let ctx2 = c.getContext('2d');\n            ctx2.drawImage(layerCanvasArr[layerIndex], 0, 0);\n            c.id = 'testocanvas';\n            document.body.appendChild(c);\n            BB.css(c, {\n                position: 'fixed',\n                left: '0',\n                top: '0',\n                zIndex: '1111111',\n                transform: 'scale(0.2)',\n                border: '10px solid red',\n            });\n        }*/\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"layerFill\",\n            params: [layerIndex, colorObj, compositeOperation]\n        });\n    }\n\n    floodFill (\n        layerIndex: number, // index of layer to be filled\n        x: number, // starting point\n        y: number,\n        rgb: IRGB, // fill color\n        opacity: number,\n        tolerance: number,\n        sampleStr: 'current' | 'all' | 'above',\n        grow: number, // int >= 0 - radius around filled area that is to be filled too\n        isContiguous: boolean,\n    ): void {\n        if (x < 0 || y < 0 || x >= this.width || y >= this.height || opacity === 0) {\n            return;\n        }\n        tolerance = Math.round(tolerance);\n\n        if (!(['above', 'current', 'all'].includes(sampleStr))) {\n            throw new Error('invalid sampleStr');\n        }\n\n        let result;\n\n        let srcCtx;\n        let srcImageData;\n        let srcData;\n\n        let targetCtx;\n        let targetImageData;\n        let targetData;\n\n\n        if (sampleStr === 'all') {\n\n            let srcCanvas = this.layerCanvasArr.length === 1 ? this.layerCanvasArr[0] : this.getCompleteCanvas(1);\n            srcCtx = srcCanvas.getContext('2d');\n            srcImageData = srcCtx.getImageData(0, 0, this.width, this.height);\n            srcData = srcImageData.data;\n            result = floodFillBits(srcData, this.width, this.height, x, y, tolerance, Math.round(grow), isContiguous);\n\n            srcCanvas = null;\n            srcCtx = null;\n            srcImageData = null;\n            srcData = null;\n\n            targetCtx = this.layerCanvasArr[layerIndex].getContext('2d');\n            targetImageData = targetCtx.getImageData(0, 0, this.width, this.height);\n\n        } else {\n            let srcIndex = sampleStr === 'above' ? layerIndex + 1 : layerIndex;\n\n            if (srcIndex >= this.layerCanvasArr.length) {\n                return;\n            }\n\n            srcCtx = this.layerCanvasArr[srcIndex].getContext('2d');\n            srcImageData = srcCtx.getImageData(0, 0, this.width, this.height);\n            srcData = srcImageData.data;\n            result = floodFillBits(srcData, this.width, this.height, x, y, tolerance, Math.round(grow), isContiguous);\n\n            if (layerIndex !== srcIndex) {\n                srcCtx = null;\n                srcImageData = null;\n                srcData = null;\n            }\n\n            targetCtx = layerIndex === srcIndex ? srcCtx : this.layerCanvasArr[layerIndex].getContext('2d');\n            targetImageData = layerIndex === srcIndex ? srcImageData : targetCtx.getImageData(0, 0, this.width, this.height);\n\n        }\n\n        targetData = targetImageData.data;\n        if (opacity === 1) {\n            for (let i = 0; i < this.width * this.height; i++) {\n                if (result.data[i] === 255) {\n                    targetData[i * 4] = rgb.r;\n                    targetData[i * 4 + 1] = rgb.g;\n                    targetData[i * 4 + 2] = rgb.b;\n                    targetData[i * 4 + 3] = 255;\n                }\n            }\n        } else {\n            for (let i = 0; i < this.width * this.height; i++) {\n                if (result.data[i] === 255) {\n                    targetData[i * 4] = BB.mix(targetData[i * 4], rgb.r, opacity);\n                    targetData[i * 4 + 1] = BB.mix(targetData[i * 4 + 1], rgb.g, opacity);\n                    targetData[i * 4 + 2] = BB.mix(targetData[i * 4 + 2], rgb.b, opacity);\n                    targetData[i * 4 + 3] = BB.mix(targetData[i * 4 + 3], 255, opacity);\n                }\n            }\n        }\n        targetCtx.putImageData(targetImageData, 0, 0);\n\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"replaceLayer\",\n            params: [layerIndex, targetImageData]\n        });\n    }\n\n    /**\n     * draw shape via BB.drawShape\n     * @param layerIndex\n     * @param shapeObj\n     */\n    drawShape (layerIndex: number, shapeObj: IShapeToolObject): void {\n        drawShape(this.layerCanvasArr[layerIndex].getContext(\"2d\"), shapeObj);\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"drawShape\",\n            params: [layerIndex, BB.copyObj(shapeObj)],\n        });\n    }\n\n    text (layerIndex: number, p: IRenderTextParam): void {\n        renderText(this.layerCanvasArr[layerIndex], BB.copyObj(p));\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"text\",\n            params: [layerIndex, BB.copyObj(p)],\n        });\n    }\n\n    replaceLayer (layerIndex: number, imageData: ImageData): void {\n        let ctx = this.layerCanvasArr[layerIndex].getContext(\"2d\");\n        ctx.putImageData(imageData, 0, 0);\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"replaceLayer\",\n            params: [layerIndex, imageData],\n        });\n    }\n\n    clearLayer (layerIndex: number): void {\n        let ctx = this.layerCanvasArr[layerIndex].getContext(\"2d\");\n        ctx.save();\n        ctx.clearRect(0, 0, this.layerCanvasArr[layerIndex].width, this.layerCanvasArr[layerIndex].height);\n        ctx.restore();\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"clearLayer\",\n            params: [layerIndex]\n        });\n    }\n\n    getLayers (): {\n        context: CanvasRenderingContext2D;\n        opacity: number;\n        name: string;\n        mixModeStr: IMixMode;\n    }[] {\n        return this.layerCanvasArr.map(item => {\n            return {\n                context: item.getContext(\"2d\"),\n                opacity: item.opacity,\n                name: item.name,\n                mixModeStr: item.mixModeStr,\n            };\n        });\n    }\n\n    getLayersFast (): {\n        canvas: KlCanvasLayer;\n        opacity: number;\n        name: string;\n        mixModeStr: IMixMode;\n    }[] {\n        return this.layerCanvasArr.map(item => {\n            return {\n                canvas: item,\n                opacity: item.opacity,\n                name: item.name,\n                mixModeStr: item.mixModeStr,\n            };\n        });\n    }\n\n    getLayerIndex (canvasObj: HTMLCanvasElement, doReturnNull?: boolean): null | number {\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\n            if (this.layerCanvasArr[i] === canvasObj) {\n                return i;\n            }\n        }\n        if (!doReturnNull) {\n            throw new Error(\"layer not found (in \" + this.layerCanvasArr.length + \" layers)\");\n        }\n        return null;\n    }\n\n    getLayer (index: number, doReturnNull?: boolean): null | {\n        context: CanvasRenderingContext2D;\n        opacity: number;\n        name: string;\n        id: number;\n    } {\n        if (this.layerCanvasArr[index]) {\n            return {\n                context: this.layerCanvasArr[index].getContext(\"2d\"),\n                opacity: this.layerCanvasArr[index].opacity,\n                name: this.layerCanvasArr[index].name,\n                id: index,\n            };\n        }\n        if (!doReturnNull) {\n            throw new Error(\"layer of index \" + index + \" not found (in \" + this.layerCanvasArr.length + \" layers)\");\n        }\n        return null;\n    }\n\n    getColorAt (x: number, y: number): IRGB {\n        x = Math.floor(x);\n        y = Math.floor(y);\n        let ctx = this.pickCanvas.getContext(\"2d\");\n        ctx.save();\n        ctx.imageSmoothingEnabled = false;\n        ctx.clearRect(0, 0, 1, 1);\n        for (let i = 0; i < this.layerCanvasArr.length; i++) {\n            ctx.globalAlpha = this.layerCanvasArr[i].opacity;\n            ctx.globalCompositeOperation = this.layerCanvasArr[i].mixModeStr;\n            ctx.drawImage(this.layerCanvasArr[i], -x, -y);\n        }\n        ctx.restore();\n        let imData = ctx.getImageData(0, 0, 1, 1);\n        return new BB.RGB(imData.data[0], imData.data[1], imData.data[2]);\n    }\n\n    getCompleteCanvas (factor: number): HTMLCanvasElement {\n        return drawProject(this.getProject(), factor);\n    }\n\n    getProject (): IKlProject {\n        return {\n            width: this.width,\n            height: this.height,\n            layers: this.layerCanvasArr.map(layer => {\n                return {\n                    name: layer.name,\n                    opacity: layer.opacity,\n                    mixModeStr: layer.mixModeStr,\n                    image: layer,\n                };\n            }),\n        };\n    }\n\n    addChangeListener (func: () => void): void {\n        if (this.changeListenerArr.includes(func)) {\n            return;\n        }\n        this.changeListenerArr.push(func);\n    }\n\n    removeChangeListener (func: () => void): void {\n        for (let i = 0; i < this.changeListenerArr.length; i++) {\n            if (this.changeListenerArr[i] === func) {\n                this.changeListenerArr.splice(i, 1);\n                return;\n            }\n        }\n    }\n\n    setMixMode (layerIndex: number, mixModeStr: IMixMode): void {\n        if (!this.layerCanvasArr[layerIndex]) {\n            throw new Error('invalid layer');\n        }\n        this.layerCanvasArr[layerIndex].mixModeStr = mixModeStr;\n\n        this.history.push({\n            tool: [\"canvas\"],\n            action: \"setMixMode\",\n            params: [layerIndex, '' + mixModeStr],\n        });\n    }\n\n    /**\n     * Set composite drawing step for KlCanvasWorkspace.\n     * To apply temporary manipulations to a layer.\n     *\n     * @param layerIndex\n     * @param compositeObj\n     */\n    setComposite (\n        layerIndex: number,\n        compositeObj: null | {\n            draw: (ctx: CanvasRenderingContext2D) => void;\n        }\n    ): void {\n        if (!this.layerCanvasArr[layerIndex]) {\n            throw new Error('invalid layer');\n        }\n        this.layerCanvasArr[layerIndex].compositeObj = compositeObj;\n    }\n\n}\n","import {IMixMode} from '../kl.types';\nimport {LANG} from '../../language/language';\nimport {TTranslationCode} from '../../../languages/languages';\n\nexport function translateBlending(blendMode?: IMixMode): string {\n    if (!blendMode) {\n        return LANG('layers-blend-normal');\n    }\n\n    const codes: {\n        [key: string]: TTranslationCode\n    } = {\n        'source-over': 'layers-blend-normal',\n        'darken': 'layers-blend-darken',\n        'multiply': 'layers-blend-multiply',\n        'color-burn': 'layers-blend-color-burn',\n        'lighten': 'layers-blend-lighten',\n        'screen': 'layers-blend-screen',\n        'color-dodge': 'layers-blend-color-dodge',\n        'overlay': 'layers-blend-overlay',\n        'soft-light': 'layers-blend-soft-light',\n        'hard-light': 'layers-blend-hard-light',\n        'difference': 'layers-blend-difference',\n        'exclusion': 'layers-blend-exclusion',\n        'hue': 'layers-blend-hue',\n        'saturation': 'layers-blend-saturation',\n        'color': 'layers-blend-color',\n        'luminosity': 'layers-blend-luminosity',\n    };\n\n    if (!(blendMode in codes)) {\n        throw new Error('unknown blend mode');\n    }\n    return LANG(codes[blendMode]);\n}","import {BB} from '../../bb/bb';\nimport {IRGB} from '../kl.types';\n\n/**\n * Overlay for KlCanvasWorkspace.\n * - brush circle\n * - eyedropper circle\n * - compass needle (rotation hud)\n */\nexport class WorkspaceSvgOverlay {\n    private rootElement: SVGElement;\n    private brushCircleOuter: SVGElement;\n    private brushCircleInner: SVGElement;\n    private pickerPreviewBorder: SVGElement;\n    private pickerPreviewCol: SVGElement;\n    private readonly compassSize: number;\n    private compass: SVGElement;\n    private compassInner: SVGElement;\n    private compassBaseCircle: SVGElement;\n    private compassLineCircle: SVGElement;\n    private compassUpperTriangle: SVGElement;\n    private compassLowerTriangle: SVGElement;\n\n    // ---- public ----\n\n    constructor (\n        p: {\n            width: number;\n            height: number;\n        }\n    ) {\n        this.rootElement = BB.createSvg({\n            elementType: 'svg',\n            width: '' + p.width,\n            height: '' + p.height,\n        });\n        BB.css(this.rootElement, {\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            pointerEvents: 'none',\n            userSelect: 'none'\n        });\n\n        //brush circles\n        this.brushCircleOuter = BB.createSvg({\n            elementType: 'circle',\n            r: '10',\n            stroke: 'rgba(0,0,0,0.7)',\n            'stroke-width': '1',\n            fill: 'none',\n        });\n        this.brushCircleInner = BB.createSvg({\n            elementType: 'circle',\n            r: '9',\n            stroke: 'rgba(255,255,255,0.7)',\n            'stroke-width': '1',\n            fill: 'none',\n        });\n        this.rootElement.append(this.brushCircleOuter, this.brushCircleInner);\n\n        //color picker preview circle\n        this.pickerPreviewBorder = BB.createSvg({\n            elementType: 'circle',\n            r: '47',\n            stroke: 'black',\n            'stroke-width': '22',\n            fill: 'none',\n        });\n        this.pickerPreviewBorder.style.opacity = '0';\n        this.pickerPreviewCol = BB.createSvg({\n            elementType: 'circle',\n            r: '47',\n            stroke: 'black',\n            'stroke-width': '20',\n            fill: 'none',\n        });\n        this.pickerPreviewCol.style.opacity = '0';\n        this.rootElement.append(this.pickerPreviewBorder, this.pickerPreviewCol);\n\n\n        //rotation compass\n        this.compassSize = 30;\n        this.compass = BB.createSvg({\n            elementType: 'g',\n            transform: 'translate(' + (p.width/2) + ', ' + (p.height/2) + ')',\n        });\n        BB.css(this.compass, {\n            transition: 'opacity 0.25s ease-in-out',\n            opacity: '0',\n        });\n        this.compassInner = BB.createSvg({\n            elementType: 'g',\n            transform: 'rotate(45)',\n        });\n        this.compassBaseCircle = BB.createSvg({\n            elementType: 'circle',\n            fill: 'rgba(0,0,0,0.9)',\n            stroke: 'none',\n            cx: '0',\n            cy: '0',\n            r: '' + this.compassSize,\n        });\n        this.compassLineCircle = BB.createSvg({\n            elementType: 'circle',\n            fill: 'none',\n            stroke: 'rgba(255,255,255,0.75)',\n            'stroke-width': '1',\n            cx: '0',\n            cy: '0',\n            r: '' + (this.compassSize * 0.9),\n        });\n        this.compassUpperTriangle = BB.createSvg({\n            elementType: 'path',\n            fill: '#f00',\n            stroke: 'none',\n            d: 'M -'+(this.compassSize * 0.25)+',0 '+(this.compassSize * 0.25)+',0 0,-'+(this.compassSize * 0.9)+' z',\n        });\n        this.compassLowerTriangle = BB.createSvg({\n            elementType: 'path',\n            fill: '#fff',\n            stroke: 'none',\n            d: 'M -'+(this.compassSize * 0.25)+',0 '+(this.compassSize * 0.25)+',0 0,'+(this.compassSize * 0.9)+' z',\n        });\n\n        this.compassInner.append(\n            this.compassBaseCircle,\n            this.compassLineCircle,\n            this.compassUpperTriangle,\n            this.compassLowerTriangle\n        );\n        this.compass.append(this.compassInner);\n        this.rootElement.append(this.compass);\n    }\n\n    getElement (): SVGElement {\n        return this.rootElement;\n    }\n\n    setSize (width: number, height: number): void {\n        this.rootElement.setAttribute('width', '' + width);\n        this.rootElement.setAttribute('height', '' + height);\n        this.compass.setAttribute('transform', 'translate(' + (width/2) + ', ' + (height/2) + ')');\n    }\n\n    updateCursor (p: {\n        x?: number;\n        y?: number;\n        radius?: number;\n        isVisible?: boolean;\n    }): void {\n        if ('x' in p) {\n            this.brushCircleOuter.setAttribute('cx', '' + p.x);\n            this.brushCircleInner.setAttribute('cx', '' + p.x);\n        }\n        if ('y' in p) {\n            this.brushCircleOuter.setAttribute('cy', '' + p.y);\n            this.brushCircleInner.setAttribute('cy', '' + p.y);\n        }\n        if ('radius' in p) {\n            this.brushCircleOuter.setAttribute('r', '' + Math.max(0, p.radius));\n            this.brushCircleInner.setAttribute('r', '' + Math.max(0, p.radius - 1));\n        }\n        if ('isVisible' in p) {\n            this.brushCircleOuter.style.opacity = p.isVisible ? '1' : '0';\n            this.brushCircleInner.style.opacity = p.isVisible ? '1' : '0';\n        }\n    }\n\n    updateColorPreview (p: {\n        x?: number;\n        y?: number;\n        color?: IRGB;\n        isVisible?: boolean;\n    }): void {\n        if ('x' in p) {\n            this.pickerPreviewCol.setAttribute('cx', '' + p.x);\n            this.pickerPreviewBorder.setAttribute('cx', '' + p.x);\n        }\n        if ('y' in p) {\n            this.pickerPreviewCol.setAttribute('cy', '' + p.y);\n            this.pickerPreviewBorder.setAttribute('cy', '' + p.y);\n        }\n        if ('color' in p) {\n            this.pickerPreviewCol.setAttribute('stroke', BB.ColorConverter.toRgbStr(p.color));\n            let borderColor = BB.testIsWhiteBestContrast(p.color) ? 'rgba(255,255,255,0.5)' : 'rgba(0,0,0,0.5)'\n            this.pickerPreviewBorder.setAttribute('stroke', borderColor);\n        }\n        if ('isVisible' in p) {\n            this.pickerPreviewCol.style.opacity = p.isVisible ? '1' : '0';\n            this.pickerPreviewBorder.style.opacity = p.isVisible ? '1' : '0';\n        }\n    }\n\n    updateCompass (p: {\n        angleDeg?: number;\n        isVisible?: boolean;\n    }): void {\n        if ('angleDeg' in p) {\n            this.compassInner.setAttribute('transform', 'rotate(' + p.angleDeg + ')');\n            this.compassLineCircle.style.opacity = p.angleDeg % 90 === 0 ? '1' : '0';\n        }\n        if ('isVisible' in p) {\n            this.compass.style.opacity = p.isVisible ? '1' : '0';\n        }\n    }\n\n}\n","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"6rWqS\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"5mHop\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"gy6aj\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"9SVhx\");","import {BB} from '../../bb/bb';\nimport {IRGB, ITransform} from '../kl.types';\nimport {WorkspaceSvgOverlay} from './workspace-svg-overlay';\nimport {klHistory} from '../history/kl-history';\n// @ts-ignore\nimport pickerImg from 'url:~/src/app/img/ui/cursor-picker.png';\n// @ts-ignore\nimport zoomEwImg from 'url:~/src/app/img/ui/cursor-zoom-ew.png';\n// @ts-ignore\nimport fillImg from 'url:~/src/app/img/ui/cursor-fill.png';\n// @ts-ignore\nimport textImg from 'url:~/src/app/img/ui/cursor-text.png';\nimport {IPressureInput, IVector2D} from '../../bb/bb.types';\nimport {KlCanvas} from '../canvas/kl-canvas';\nimport {KeyListener} from '../../bb/input/key-listener';\n\nexport interface IViewChangeEvent {\n    changed: ('scale' | 'angle')[];\n    angle: number;\n    scale: number;\n}\n\ntype TModeStr = 'draw' | 'pick' | 'hand' | 'shape' | 'fill' | 'text'; // | 'transform' | 'select'\n\nconst MIN_SCALE = 1 / 16;\nconst MAX_SCALE = 64;\nenum TMode {\n    Draw,\n    Hand,\n    HandGrabbing,\n    Pick,\n    Zoom,\n    Rotate,\n    Rotating,\n    Fill,\n    Text,\n    Shape,\n}\nconst ANIMATION_SPEED = 0.3; // rate of transition towards targetTransform\n\n/**\n * Work area that displays the KlCanvas.\n * - pan, zoom, rotate (also via multi-touch)\n * - input modes: drawing, hand, pick, fill, text // transform, select\n * - drawing input events\n * - view change events\n * - eyedropper input events (pick)\n * - draws cursor, eyedropper overlay\n *\n * subscribes to klCanvas changes\n * listens to kl history for changes\n * and you can manually trigger redraw\n */\nexport class KlCanvasWorkspace {\n\n    private rootEl: HTMLElement;\n    private klCanvas: KlCanvas;\n    private renderTargetCanvas: HTMLCanvasElement;\n    private renderTargetCtx: CanvasRenderingContext2D;\n    private renderWidth: number;\n    private renderHeight: number;\n    private compositeCanvas: HTMLCanvasElement; // for drawing klcanvas layer composite\n    private compositeCtx: CanvasRenderingContext2D;\n    private doResizeCanvas: boolean;\n    private oldTransformObj: ITransform;\n    private targetTransformObj: ITransform; // animation target\n    private highResTransformObj: ITransform; // animated, internal high res\n    private renderedTransformObj: ITransform; // same as highRes, but rounded - what's actually displayed\n    private cursorPos: IVector2D;\n    private usesCssCursor: boolean;\n    private bgVisible: boolean;\n    private transformIsDirty: boolean;\n    private doAnimateTranslate: boolean;\n    private svgOverlay: WorkspaceSvgOverlay;\n    private emptyCanvas: HTMLCanvasElement;\n    private keyListener: KeyListener;\n    private currentMode: TMode;\n    private globalMode: TMode;\n    private renderTime: number; // for debugging - average ms per render()\n    private lastDrawEvent: IPressureInput | null; // previous drawing input\n    private linetoolProcessor: any; // todo type - BB.EventChain.LinetoolProcessor\n    private pointer: IVector2D | null; // position of cursor\n    private isDrawing: boolean;\n    private inputProcessorObj: any; // todo type\n    private currentInputProcessor: any; // todo type\n    private angleIsExtraSticky: boolean;\n    private pinchZoomer: any; // todo type - BB.EventChain.PinchZoomer\n    private mainDoubleTapper: any; // todo type - BB.EventChain.DoubleTapper - todo docs\n    private middleDoubleTapper: any; // todo type - BB.EventChain.DoubleTapper - todo docs\n    private twoFingerTap: any; // todo type - BB.EventChain.NFingerTapper\n    private threeFingerTap: any; // todo type - BB.EventChain.NFingerTapper\n    private pointerEventChain: any; // todo type - BB.EventChain.EventChain\n    private pointerListener: any; // todo type - BB.PointerListener\n    private brushRadius: number;\n    private animationFrameRequested: boolean;\n    private lastRenderedState: number; // KlHistory state - to detect if there are changes to draw\n    private lastRenderTime: number; // ms from performance.now()\n    private hideBrushCursorTimeout: number;\n    private onViewChange: (e:  IViewChangeEvent) => void;\n\n    private getRenderedTransform (): ITransform {\n        // rounded x & y so canvas is less blurry.\n        const result = this.renderedTransformObj;\n        result.x = this.highResTransformObj.x;\n        result.y = this.highResTransformObj.y;\n        result.scale = this.highResTransformObj.scale;\n        result.angle = this.highResTransformObj.angle;\n\n        if (result.angle % (Math.PI / 2) === 0 && result.scale % 1 === 0) {\n            result.x = Math.round(result.x);\n            result.y = Math.round(result.y);\n        }\n\n        return result;\n    }\n\n    private updateChangeListener (): void {\n        this.klCanvas.addChangeListener(() => {\n            this.lastRenderedState = -1;\n            this.reqFrame();\n        });\n    }\n\n    private updateCursor (modeInt: TMode, doForce?: boolean): void {\n        if (modeInt === this.currentMode && !doForce) {\n            return;\n        }\n        const oldMode = this.currentMode;\n        this.currentMode = modeInt;\n        this.lastRenderedState = -1;\n        if (this.currentMode === TMode.Draw) {\n            this.rootEl.style.cursor = 'crosshair';\n        } else if (this.currentMode === TMode.Hand) {\n            this.rootEl.style.cursor = 'grab';\n        } else if (this.currentMode === TMode.HandGrabbing) {\n            this.rootEl.style.cursor = 'grabbing';\n        } else if (this.currentMode === TMode.Pick) {\n            this.rootEl.style.cursor = \"url('\" + pickerImg + \"') 0 15, crosshair\";\n        } else if (this.currentMode === TMode.Zoom) {\n            this.rootEl.style.cursor = \"url('\" + zoomEwImg + \"') 7 7, zoom-in\";\n        } else if (this.currentMode === TMode.Rotate) {\n            this.rootEl.style.cursor = \"grab\";\n        } else if (this.currentMode === TMode.Rotating) {\n            this.rootEl.style.cursor = \"grabbing\";\n        } else if (this.currentMode === TMode.Fill) {\n            this.rootEl.style.cursor = \"url('\" + fillImg + \"') 1 12, crosshair\";\n        } else if (this.currentMode === TMode.Text) {\n            this.rootEl.style.cursor = \"url('\" + textImg + \"') 1 12, crosshair\";\n        } else if (this.currentMode === TMode.Shape) {\n            this.rootEl.style.cursor = 'crosshair';\n        }\n\n        if ([TMode.Draw, TMode.Pick, TMode.Fill, TMode.Text, TMode.Shape].includes(this.globalMode)) {\n            const oldIsHand = [TMode.Hand, TMode.HandGrabbing].includes(oldMode);\n            const currentIsHand = [TMode.Hand, TMode.HandGrabbing].includes(this.currentMode);\n            if (!oldIsHand && currentIsHand) {\n                this.mainDoubleTapper.setAllowedPointerTypeArr(['mouse', 'pen', 'touch']);\n            }\n            if (oldIsHand && !currentIsHand) {\n                this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\n            }\n        }\n\n        if (this.currentMode !== TMode.Pick) {\n            this.svgOverlay.updateColorPreview({isVisible: false});\n        }\n    }\n\n    /**\n     * returns false if no change of zoom\n     * @param stepNum\n     * @param centerX\n     * @param centerY\n     * @private\n     */\n    private internalZoomByStep (stepNum: number, centerX: number, centerY: number): boolean {\n        const step = Math.log2(this.targetTransformObj.scale);\n\n        let newStep = step / Math.abs(stepNum);\n        newStep += stepNum > 0 ? 1 : -1;\n        newStep = Math.round(newStep);\n        newStep *= Math.abs(stepNum);\n        const newScale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, Math.pow(2, newStep)));\n\n        //has zoomed?\n        if (newScale === this.targetTransformObj.scale) {\n            return false;\n        }\n\n\n        const effectiveFactor = newScale / this.targetTransformObj.scale;\n        this.targetTransformObj.scale = newScale;\n\n        let matrix = BB.Matrix.getIdentity();\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerX, centerY));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(effectiveFactor));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerX, -centerY));\n\n        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\n        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\n        this.targetTransformObj.x = origin[0];\n        this.targetTransformObj.y = origin[1];\n\n        this.transformIsDirty = true;\n\n        return true;\n    }\n\n    /**\n     * mixes two transform objects. modifies A\n     * @param transformA\n     * @param transformB\n     * @param blendFactor 0 -> A, 1 -> B\n     * @private\n     */\n    private mixTransformObj (transformA: ITransform, transformB: ITransform, blendFactor: number): void {\n        if (transformA.angle === transformB.angle) {\n            transformA.scale = BB.mix(transformA.scale, transformB.scale, blendFactor);\n            transformA.x = BB.mix(transformA.x, transformB.x, blendFactor);\n            transformA.y = BB.mix(transformA.y, transformB.y, blendFactor);\n            transformA.angle = BB.mix(transformA.angle, transformB.angle, blendFactor);\n            return;\n        }\n\n        const w = this.klCanvas.getWidth();\n        const h = this.klCanvas.getHeight();\n\n        // --- determine centerPosA, centerPosB ---\n        const centerPosA = this.canvasToWorkspaceCoord({\n            x: w / 2,\n            y: h / 2\n        }, transformA);\n        const centerPosB = this.canvasToWorkspaceCoord({\n            x: w / 2,\n            y: h / 2\n        }, transformB);\n\n        // --- centerPosMixed ---\n        transformA.x = BB.mix(centerPosA.x , centerPosB.x, blendFactor);\n        transformA.y = BB.mix(centerPosA.y , centerPosB.y, blendFactor);\n\n        // --- scale and angle ---\n        transformA.scale = BB.mix(transformA.scale, transformB.scale, blendFactor);\n        transformA.angle = BB.mix(transformA.angle, transformB.angle, blendFactor);\n\n        // --- x and y ---\n        const mixedPos = this.canvasToWorkspaceCoord({\n            x: -w / 2,\n            y: -h / 2\n        }, transformA);\n        transformA.x = mixedPos.x;\n        transformA.y = mixedPos.y;\n    }\n\n    private render (): void {\n        if (this.doResizeCanvas) {\n            this.doResizeCanvas = false;\n            this.renderTargetCanvas.width = this.renderWidth;\n            this.renderTargetCanvas.height = this.renderHeight;\n        }\n        this.renderContext(this.renderTargetCtx);\n    }\n\n    /**\n     * is the gray background that surrounds canvas visible?\n     * @private\n     */\n    private testBgVisible (): boolean {\n        //bring workspace points (corners of workspace) into canvas coordinate system\n        //then check if any corner point is outside of the canvas -> that means the bg is visible\n\n        const workspacePointArr = [\n            [0, 0], // top left\n            [this.renderWidth, 0], // top right\n            [this.renderWidth, this.renderHeight], // bottom right\n            [0, this.renderHeight], // bottom left\n        ];\n\n        const art = this.getRenderedTransform();\n\n        //setup transformation matrix\n        let matrix = BB.Matrix.getIdentity();\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\n\n        //transform points, then test if outside of canvas\n        for (let i = 0; i < workspacePointArr.length; i++) {\n            let coords = [workspacePointArr[i][0], workspacePointArr[i][1], 0, 1];\n            coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\n\n            if (\n                !(0 <= coords[0] && coords[0] <= this.klCanvas.getWidth() &&\n                    0 <= coords[1] && coords[1] <= this.klCanvas.getHeight())\n            ){\n                //if not inside -> bg visible\n                return true;\n            }\n        }\n        return false;\n    }\n\n    private renderContext (ctx: CanvasRenderingContext2D): void {\n        const w = this.klCanvas.getWidth();\n        const h = this.klCanvas.getHeight();\n\n        const art = this.getRenderedTransform();\n\n        if (art.scale >= 4 || (art.scale === 1 && art.angle === 0)) {\n            ctx.imageSmoothingEnabled = false;\n        } else {\n            ctx.imageSmoothingEnabled = true;\n            ctx.imageSmoothingQuality  = 'low'; // art.scale >= 1 ? 'low' : 'medium';\n        }\n        //ctx.imageSmoothingEnabled = false;\n        //renderTargetCtx.globalCompositeOperation  = 'multiply';\n\n\n\n        ctx.save();\n        {\n            if (this.bgVisible) {\n                ctx.fillStyle = 'rgb(158,158,158)'; // 'rgb(185,185,185)';\n                ctx.fillRect(0, 0, this.renderWidth, this.renderHeight);\n            } else {\n                ctx.clearRect(0, 0, this.renderWidth, this.renderHeight);\n            }\n\n\n\n            if (this.bgVisible) {\n                ctx.save();\n\n                ctx.translate(art.x, art.y);\n                ctx.scale(art.scale, art.scale);\n                ctx.rotate(art.angle);\n\n                ctx.imageSmoothingEnabled = false;\n\n                //outline\n                const borderSize = 1;\n                ctx.globalAlpha = 0.2;\n                ctx.drawImage(\n                    this.emptyCanvas,\n                    -borderSize / art.scale,\n                    -borderSize / art.scale,\n                    w + borderSize * 2 / art.scale,\n                    h + borderSize * 2 / art.scale\n                );\n                ctx.globalAlpha = 1;\n\n                //erase\n                ctx.globalCompositeOperation = 'destination-out';\n                ctx.drawImage(this.emptyCanvas, 0, 0, w, h);\n\n                ctx.restore();\n            }\n\n            /*const region = new Path2D();\n            region.rect(80, 10, 20, 130);\n            ctx.clip(region);*/\n\n            ctx.translate(art.x, art.y);\n            ctx.scale(art.scale, art.scale);\n            ctx.rotate(art.angle);\n\n            const layerArr = this.klCanvas.getLayersFast();\n            for (let i = 0; i < layerArr.length; i++) {\n                if (layerArr[i].opacity > 0) {\n                    ctx.globalAlpha = layerArr[i].opacity;\n                    ctx.globalCompositeOperation = layerArr[i].mixModeStr;\n\n                    if (layerArr[i].canvas.compositeObj) {\n                        if (this.compositeCanvas.width !== layerArr[i].canvas.width || this.compositeCanvas.height !== layerArr[i].canvas.height) {\n                            this.compositeCanvas.width = layerArr[i].canvas.width;\n                            this.compositeCanvas.height = layerArr[i].canvas.height;\n                        } else {\n                            this.compositeCtx.clearRect(0, 0, this.compositeCanvas.width, this.compositeCanvas.height);\n                        }\n                        this.compositeCtx.drawImage(layerArr[i].canvas, 0, 0);\n                        layerArr[i].canvas.compositeObj.draw(this.compositeCtx);\n                        ctx.drawImage(this.compositeCanvas, 0, 0, w, h);\n                    } else {\n                        ctx.drawImage(layerArr[i].canvas, 0, 0, w, h);\n                    }\n                }\n            }\n            ctx.globalAlpha = 1;\n\n\n\n        }\n        ctx.restore();\n\n        // rotation hud\n        if (TMode.Rotate === this.currentMode || TMode.Rotating === this.currentMode) {\n            this.svgOverlay.updateCompass({\n                isVisible: true,\n                angleDeg: art.angle / Math.PI * 180\n            });\n        } else {\n            this.svgOverlay.updateCompass({\n                isVisible: false\n            });\n        }\n    }\n\n    private workspaceToCanvasCoord (p: IVector2D): IVector2D {\n        const art = this.getRenderedTransform();\n        let matrix = BB.Matrix.getIdentity();\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\n\n        let coords = [p.x, p.y, 0, 1];\n        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\n\n        return {\n            x: coords[0],\n            y: coords[1],\n        };\n    }\n\n    private canvasToWorkspaceCoord (p: IVector2D, transformObj: ITransform): IVector2D {\n        let matrix = BB.Matrix.getIdentity();\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(transformObj.x, transformObj.y));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(transformObj.angle));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(transformObj.scale));\n\n        let coords = [p.x, p.y, 0, 1];\n        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\n\n        return {\n            x: coords[0],\n            y: coords[1],\n        };\n    }\n\n    private snapAngleRad (angleRad: number, snapDegIncrement: number, maxDistDeg: number): number {\n        let angleDeg = angleRad * 180 / Math.PI;\n        const modDeg = Math.abs(angleDeg % snapDegIncrement);\n        const dist = Math.min(modDeg, snapDegIncrement - modDeg);\n\n        if (dist <= maxDistDeg) {\n            angleDeg = Math.round(angleDeg / snapDegIncrement) * snapDegIncrement;\n        }\n\n        return angleDeg / 180 * Math.PI;\n    }\n\n    /**\n     * angle always in range [-PI, PI]\n     * @param angleRad\n     * @private\n     */\n    private minimizeAngleRad (angleRad: number): number {\n        angleRad = angleRad % (2 * Math.PI);\n        if (angleRad > Math.PI) {\n            angleRad -= 2 * Math.PI;\n        } else if (angleRad < -Math.PI) {\n            angleRad += 2 * Math.PI;\n        }\n        return angleRad;\n    }\n\n    private resetInputProcessor (): void {\n        this.currentInputProcessor = null;\n        this.updateCursor(this.globalMode);\n        this.reqFrame(true);\n    }\n\n    private reqFrame (doRedrawCanvas?: boolean): void {\n        this.animationFrameRequested = true;\n        if (doRedrawCanvas) {\n            this.lastRenderedState = -1;\n        }\n    }\n\n    private updateLoop (): void {\n        window.requestAnimationFrame(() => this.updateLoop());\n        const newState = klHistory.getState();\n        const doRender = this.lastRenderedState < newState;\n\n        //handle variable framerate\n        const nowTime = performance.now();\n        const elapsedFrames = (nowTime - this.lastRenderTime) * 60 / 1000; //how many frames elapsed since last render if fps were 60fps\n        this.lastRenderTime = nowTime;\n\n        if (this.animationFrameRequested || doRender) {\n            this.animationFrameRequested = false;\n            this.checkChange(elapsedFrames);\n        }\n    }\n\n    private checkChange (elapsedFrames: number): void {\n\n        const newState = klHistory.getState();\n        const doRender = this.lastRenderedState < newState ||\n            this.highResTransformObj.scale !== this.targetTransformObj.scale ||\n            this.highResTransformObj.x !== this.targetTransformObj.x ||\n            this.highResTransformObj.y !== this.targetTransformObj.y;\n\n        //update transform\n        if (\n            !this.doAnimateTranslate &&\n            (\n                this.highResTransformObj.scale === this.targetTransformObj.scale ||\n                Math.abs(this.highResTransformObj.scale - this.targetTransformObj.scale) < 0.008 * this.targetTransformObj.scale\n            )\n        ) {\n            this.highResTransformObj.scale = this.targetTransformObj.scale;\n            this.highResTransformObj.x = this.targetTransformObj.x;\n            this.highResTransformObj.y = this.targetTransformObj.y;\n            this.highResTransformObj.angle = this.targetTransformObj.angle;\n            if (this.transformIsDirty) {\n                this.transformIsDirty = false;\n                this.bgVisible = this.testBgVisible();\n            }\n\n            this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\n        } else if (\n            (this.highResTransformObj.x === this.targetTransformObj.x || Math.abs(this.highResTransformObj.x - this.targetTransformObj.x) < 0.5) &&\n            (this.highResTransformObj.y === this.targetTransformObj.y || Math.abs(this.highResTransformObj.y - this.targetTransformObj.y) < 0.5) &&\n            (\n                this.highResTransformObj.scale === this.targetTransformObj.scale ||\n                Math.abs(this.highResTransformObj.scale - this.targetTransformObj.scale) < 0.008 * this.targetTransformObj.scale\n            )\n        ) {\n            this.highResTransformObj.scale = this.targetTransformObj.scale;\n            this.highResTransformObj.x = this.targetTransformObj.x;\n            this.highResTransformObj.y = this.targetTransformObj.y;\n            this.highResTransformObj.angle = this.targetTransformObj.angle;\n            this. doAnimateTranslate = false;\n            if (this.transformIsDirty) {\n                this.transformIsDirty = false;\n                this.bgVisible = this.testBgVisible();\n            }\n\n            this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\n        } else {\n            this.reqFrame(); //probably needs another frame\n            const blendFactor = Math.min(1, ANIMATION_SPEED * elapsedFrames);\n            this.mixTransformObj(this.highResTransformObj, this.targetTransformObj, blendFactor);\n            this.bgVisible = true; // spare yourself the calculation\n            this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\n        }\n\n        if (this.pointer && this.currentMode == TMode.Draw && !this.usesCssCursor) {\n            this.svgOverlay.updateCursor({\n                x: this.pointer.x,\n                y: this.pointer.y,\n                isVisible: true\n            });\n        } else {\n            this.svgOverlay.updateCursor({isVisible: false});\n        }\n\n\n        if (doRender) {\n            //console.log('scale', this.renderedTransform.scale, 'x', this.renderedTransform.x, 'y', this.renderedTransform.y);\n            this.lastRenderedState = newState;\n            const start = performance.now();\n            this.render();\n            this.renderTime = BB.mix(this.renderTime, performance.now() - start, 0.05);\n        }\n        //setTimeout(this.checkChange, 100);\n\n\n\n        if (doRender) {\n\n            //console.log('rendertime ms: ', this.renderTime);\n        }\n\n    }\n\n    // ---- public ----\n\n    constructor (\n        p: {\n            klCanvas: any; // todo\n            width: number;\n            height: number;\n            onDraw: (val) => void; // todo\n            onPick: (rgb: IRGB, isPointerup: boolean) => void;\n            onFill: (canvasX: number, canvasY: number) => void;\n            onText: (canvasX: number, canvasY: number, angleRad: number) => void;\n            onShape: (type: 'down' | 'up' | 'move', canvasX: number, canvasY: number, angleRad: number) => void;\n            onViewChange: (e:  IViewChangeEvent) => void;\n            onUndo: () => void;\n            onRedo: () => void;\n        }\n    ) {\n        const _this = this;\n        this.rootEl = BB.el({\n            css: {\n                position: 'absolute',\n                left: '0',\n                right: '0',\n                top: '0',\n                bottom: '0',\n                cursor: 'crosshair',\n                userSelect: 'none',\n                colorScheme: 'only light',\n            }\n        });\n        this.klCanvas = p.klCanvas;\n        this.onViewChange = p.onViewChange;\n        this.renderTargetCanvas = BB.canvas(p.width, p.height);\n        this.renderTargetCtx = this.renderTargetCanvas.getContext('2d');\n        this.renderWidth = p.width;\n        this.renderHeight = p.height;\n        this.compositeCanvas = BB.canvas(1, 1); // for drawing klcanvas layer composite\n        this.compositeCtx = this.compositeCanvas.getContext('2d');\n        this.doResizeCanvas = false;\n        this.oldTransformObj = null;\n        this.targetTransformObj = {\n            x: 0,\n            y: 0,\n            scale: 1,\n            angle: 0\n        };\n        this.highResTransformObj = {\n            x: 0,\n            y: 0,\n            scale: 1,\n            angle: 0\n        };\n        this.renderedTransformObj = {\n            x: null,\n            y: null,\n            scale: null,\n            angle: null\n        };\n        this.cursorPos = {\n            x: 0,\n            y: 0\n        };\n        this.usesCssCursor = false;\n        this.bgVisible = true;\n        this.transformIsDirty = true;\n        this.doAnimateTranslate = true;\n\n        this.svgOverlay = new WorkspaceSvgOverlay({\n            width: p.width,\n            height: p.height\n        });\n\n        BB.css(this.renderTargetCanvas, {\n            userSelect: 'none',\n            pointerEvents: 'none',\n        });\n        BB.createCheckerDataUrl(8, (url) => {\n            this.renderTargetCanvas.style.background = \"url(\" + url + \")\";\n        });\n        this.rootEl.appendChild(this.renderTargetCanvas);\n        this.rootEl.appendChild(this.svgOverlay.getElement());\n        BB.addEventListener(this.rootEl, 'touchend', (e) => {\n            e.preventDefault();\n            return false;\n        });\n        BB.addEventListener(this.rootEl, 'contextmenu', (e) => {\n            e.preventDefault();\n            return false;\n        });\n        BB.addEventListener(this.rootEl, 'dragstart', (e) => {\n            e.preventDefault();\n            return false;\n        });\n\n        this.emptyCanvas = BB.canvas(1, 1);\n        {\n            const ctx = this.emptyCanvas.getContext('2d');\n            ctx.fillRect(0, 0, 1, 1);\n        }\n\n        this.keyListener = new BB.KeyListener({\n            onDown: (keyStr, event, comboStr, isRepeat) => {\n\n                if (keyStr === 'alt') {\n                    event.preventDefault();\n                }\n                if (isRepeat) {\n                    return;\n                }\n\n                if (this.currentInputProcessor) {\n                    this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\n\n                } else {\n\n                    if ([TMode.Draw, TMode.Pick, TMode.Fill, TMode.Text, TMode.Shape].includes(this.globalMode) && comboStr === 'space') {\n                        this.currentInputProcessor = this.inputProcessorObj.spaceHand;\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\n                        return;\n                    }\n\n                    if ([TMode.Draw, TMode.Hand, TMode.Fill, TMode.Text, TMode.Shape].includes(this.globalMode) && comboStr === 'alt') {\n                        this.currentInputProcessor = this.inputProcessorObj.altPicker;\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\n                        return;\n                    }\n\n                    if (['r', 'shift+r'].includes(comboStr)) {\n                        this.currentInputProcessor = this.inputProcessorObj.rotate;\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\n                        return;\n                    }\n\n                    if ('z' === comboStr) {\n                        this.currentInputProcessor = this.inputProcessorObj.zoom;\n                        this.currentInputProcessor.onKeyDown(keyStr, event, comboStr, isRepeat);\n                        return;\n                    }\n\n                }\n\n            },\n            onUp: (keyStr, event, oldComboStr) => {\n                if (this.currentInputProcessor) {\n                    this.currentInputProcessor.onKeyUp(keyStr, event, oldComboStr);\n                }\n            }\n        });\n\n        this.updateChangeListener();\n\n        this.currentMode = TMode.Draw;\n        this.globalMode = TMode.Draw;\n\n        this.renderTime = 0;\n\n        this.lastDrawEvent = null;\n\n        this.linetoolProcessor = new BB.EventChain.LinetoolProcessor({\n            onDraw: (event) => {\n                const getMatrix = () => {\n                    const art = this.getRenderedTransform();\n                    let matrix = BB.Matrix.getIdentity();\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(1/art.scale));\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(-art.angle));\n                    matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-art.x, -art.y));\n                    return matrix;\n                };\n\n                if (event.type === 'line' && !this.lastDrawEvent) {\n                    const matrix = getMatrix();\n                    let coords = [event.x1, event.y1, 0, 1];\n                    coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\n                    this.lastDrawEvent = {\n                        x: coords[0],\n                        y: coords[1],\n                        pressure: event.pressure1\n                    };\n                    return;\n                }\n\n                if ('x' in event || 'x0' in event) {\n\n                    const matrix = getMatrix();\n\n                    if ('x' in event) { //down or move\n                        let coords = [event.x, event.y, 0, 1];\n                        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\n                        event.x = coords[0];\n                        event.y = coords[1];\n                    }\n                    if ('x0' in event) { //line\n                        event.x0 = this.lastDrawEvent.x;\n                        event.y0 = this.lastDrawEvent.y;\n                        event.pressure0 = this.lastDrawEvent.pressure;\n                        let coords = [event.x1, event.y1, 0, 1];\n                        coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\n                        event.x1 = coords[0];\n                        event.y1 = coords[1];\n\n                        this.lastDrawEvent = {\n                            x: event.x1,\n                            y: event.y1,\n                            pressure: event.pressure1,\n                        };\n                    }\n                }\n\n\n                if (['down', 'move'].includes(event.type)) {\n                    this.lastDrawEvent = event;\n                }\n                p.onDraw(event);\n            }\n        });\n\n        this.pointer = null;\n        this.isDrawing = false;\n\n\n        this.inputProcessorObj = {\n            draw: {\n                onPointer: (val) => {\n\n                    this.reqFrame();\n                    this.updateCursor(TMode.Draw);\n\n                    const comboStr = this.keyListener.getComboStr();\n\n                    const event: any = {\n                        scale: this.highResTransformObj.scale\n                    };\n                    event.shiftIsPressed = comboStr === 'shift';\n                    event.pressure = val.pressure;\n                    event.isCoalesced = !!val.isCoalesced;\n\n                    if (val.type === 'pointerdown') {\n\n                        this.isDrawing = true;\n                        event.type = 'down';\n\n                    } else if (val.button) {\n                        event.type = 'move';\n\n                    } else if (val.type === 'pointerup') {\n\n                        this.isDrawing = false;\n                        event.type = 'up';\n\n                        this.linetoolProcessor.process(event);\n                        this.resetInputProcessor();\n                        return;\n                    } else {\n                        return;\n                    }\n\n                    event.x = val.relX;\n                    event.y = val.relY;\n\n                    this.linetoolProcessor.process(event);\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n\n                }\n            },\n            fill: {\n                onPointer: (event) => {\n\n                    this.reqFrame();\n                    this.updateCursor(TMode.Fill);\n\n                    if (event.type === 'pointerdown') {\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\n                        p.onFill(Math.floor(coord.x), Math.floor(coord.y));\n\n                    } else if (event.type === 'pointerup') {\n                        this.resetInputProcessor();\n                        return;\n\n                    }\n\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n\n                }\n            },\n            text: {\n                onPointer: (event) => {\n\n                    this.reqFrame();\n                    this.updateCursor(TMode.Text);\n\n                    if (event.type === 'pointerdown') {\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\n                        p.onText(Math.floor(coord.x), Math.floor(coord.y), this.renderedTransformObj.angle);\n\n                    } else if (event.type === 'pointerup') {\n                        this.resetInputProcessor();\n                        return;\n\n                    }\n\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n\n                }\n            },\n            shape: {\n                onPointer: (event) => {\n\n                    this.reqFrame();\n                    this.updateCursor(TMode.Shape);\n                    const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\n\n                    if (event.type === 'pointerdown') {\n                        this.isDrawing = true;\n                        p.onShape('down', coord.x, coord.y, this.renderedTransformObj.angle);\n\n                    } else if (event.type === 'pointermove') {\n                        p.onShape('move', coord.x, coord.y, this.renderedTransformObj.angle);\n\n                    } else if (event.type === 'pointerup') {\n                        this.isDrawing = false;\n                        p.onShape('up', coord.x, coord.y, this.renderedTransformObj.angle);\n                        this.resetInputProcessor();\n\n                    }\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n\n                }\n            },\n            hand: {\n                onPointer: (event) => {\n                    this.updateCursor(TMode.Hand);\n                    if (['left', 'middle'].includes(event.button)) {\n                        this.updateCursor(TMode.HandGrabbing);\n                        this.targetTransformObj.x += event.dX;\n                        this.targetTransformObj.y += event.dY;\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n                        this.doAnimateTranslate = false;\n                        this.transformIsDirty = true;\n                        this.reqFrame(true);\n                    } else if (event.type === 'pointerup') {\n                        this.resetInputProcessor();\n                    }\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n\n                }\n            },\n            spaceHand: {\n                onPointer: (event) => {\n                    this.updateCursor(TMode.Hand);\n                    if (['left', 'middle'].includes(event.button)) {\n                        this.updateCursor(TMode.HandGrabbing);\n                        this.targetTransformObj.x += event.dX;\n                        this.targetTransformObj.y += event.dY;\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n                        this.doAnimateTranslate = false;\n                        this.transformIsDirty = true;\n                        this.reqFrame(true);\n                    }\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n                    if (comboStr !== 'space') {\n                        this.resetInputProcessor();\n                    } else {\n                        this.updateCursor(TMode.Hand);\n                    }\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n                    this.resetInputProcessor();\n                }\n            },\n            zoom: {\n                onPointer: (event) => {\n                    this.updateCursor(TMode.Zoom);\n\n                    if (event.button === 'left' && !event.isCoalesced && event.dX != 0) {\n\n                        const offsetX = event.pageX - event.relX;\n                        const offsetY = event.pageY - event.relY;\n\n                        this.internalZoomByStep(event.dX / 175, event.downPageX - offsetX, event.downPageY - offsetY);\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n                        this.lastRenderedState = -1;\n                        this.reqFrame();\n\n                        this.onViewChange({\n                            changed: ['scale'],\n                            angle: this.targetTransformObj.angle,\n                            scale: this.targetTransformObj.scale\n                        });\n                    }\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n                    if (comboStr !== 'z') {\n                        this.resetInputProcessor();\n                    } else {\n                        this.updateCursor(TMode.Zoom);\n                    }\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n                    this.resetInputProcessor();\n                }\n            },\n            picker: {\n                onPointer: (event) => {\n                    this.updateCursor(TMode.Pick);\n                    if (\n                        (['left', 'right'].includes(event.button) && !event.isCoalesced) ||\n                        event.type === 'pointerup'\n                    ) {\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\n                        const pickedColor = this.klCanvas.getColorAt(coord.x, coord.y);\n                        p.onPick(pickedColor, event.type === 'pointerup');\n                        this.svgOverlay.updateColorPreview({\n                            x: event.relX,\n                            y: event.relY,\n                            color: pickedColor,\n                            isVisible: event.type !== 'pointerup'\n                        });\n\n                        if (event.type === 'pointerup') {\n                            this.resetInputProcessor();\n                        }\n                    }\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n\n                }\n            },\n            altPicker: {\n                onPointer: (event) => {\n                    this.updateCursor(TMode.Pick);\n                    if (\n                        (['left', 'right'].includes(event.button) && !event.isCoalesced) ||\n                        event.type === 'pointerup'\n                    ) {\n                        const coord = this.workspaceToCanvasCoord({x: event.relX, y: event.relY});\n                        const pickedColor = this.klCanvas.getColorAt(coord.x, coord.y);\n                        p.onPick(pickedColor, event.type === 'pointerup');\n                        this.svgOverlay.updateColorPreview({\n                            x: event.relX,\n                            y: event.relY,\n                            color: pickedColor,\n                            isVisible: event.type !== 'pointerup'\n                        });\n                    }\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n                    if (comboStr !== 'alt') {\n                        this.resetInputProcessor();\n                    } else {\n                        this.updateCursor(TMode.Pick);\n                    }\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n                    this.resetInputProcessor();\n                }\n            },\n            rotate: {\n                onPointer: (event) => {\n                    this.updateCursor(event.button === 'left' ? TMode.Rotating : TMode.Rotate);\n\n                    if (event.type === 'pointerdown' && event.button === 'left') {\n                        this.oldTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n                    } else if (event.button === 'left' && !event.isCoalesced && this.oldTransformObj) {\n\n\n                        const offsetX = event.pageX - event.relX;\n                        const offsetY = event.pageY - event.relY;\n                        //rotation done around center\n                        const centerObj = {\n                            x: this.renderWidth / 2,\n                            y: this.renderHeight / 2\n                        };\n\n                        const startAngleRad = BB.Vec2.angle(centerObj, {x: event.downPageX - offsetX, y: event.downPageY - offsetY});\n                        const angleRad = BB.Vec2.angle(centerObj, {x: event.pageX - offsetX, y: event.pageY - offsetY});\n                        let dAngleRad = angleRad - startAngleRad;\n\n                        //apply angle\n                        this.targetTransformObj = JSON.parse(JSON.stringify(this.oldTransformObj));\n                        this.targetTransformObj.angle += dAngleRad;\n\n                        if (this.keyListener.isPressed('shift')) {\n                            this.targetTransformObj.angle = Math.round(this.targetTransformObj.angle / Math.PI * 8) * Math.PI / 8; //snap the angle to 45/2 degs\n                            dAngleRad = this.targetTransformObj.angle - this.oldTransformObj.angle;\n                        }\n\n                        this.targetTransformObj.angle = this.minimizeAngleRad(this.targetTransformObj.angle);\n\n                        //rotate transform.xy\n                        let matrix = BB.Matrix.getIdentity();\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerObj.x, centerObj.y));\n                        //matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(effectiveFactor));\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(dAngleRad));\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerObj.x, -centerObj.y));\n                        //matrix = multiplyMatrices(matrix, createTranslationMatrix(val.x - val.startX, val.y - val.startY));\n\n                        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\n                        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\n                        this.targetTransformObj.x = origin[0];\n                        this.targetTransformObj.y = origin[1];\n\n                        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n\n                        this.transformIsDirty = true;\n                        this.lastRenderedState = -1;\n                        this.reqFrame();\n\n                        this.onViewChange({\n                            changed: ['angle'],\n                            scale: this.targetTransformObj.scale,\n                            angle: this.targetTransformObj.angle\n                        });\n\n                    }\n                },\n                onKeyDown: (keyStr, event, comboStr, isRepeat) => {\n                    if (['r', 'r+shift', 'shift+r', 'r+left', 'r+right', 'r+left+right', 'r+right+left', 'r+up'].includes(comboStr)) {\n                        this.updateCursor(TMode.Rotate);\n                    } else {\n                        this.resetInputProcessor();\n                    }\n                },\n                onKeyUp: (keyStr, event, oldComboStr) => {\n                    const comboStr = this.keyListener.getComboStr();\n                    if (['r', 'r+shift', 'shift+r', 'r+left', 'r+right', 'r+left+right', 'r+right+left', 'r+up'].includes(comboStr)) {\n                        this.updateCursor(TMode.Rotate);\n                    } else {\n                        this.resetInputProcessor();\n                    }\n                }\n            }\n        };\n        this.currentInputProcessor = null;\n\n\n        this.angleIsExtraSticky = false;\n        this.pinchZoomer = new BB.EventChain.PinchZoomer({\n            onPinch: (event) => {\n\n                if (event.type === 'move') {\n\n                    if (!this.oldTransformObj) {\n                        this.oldTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n                        this.angleIsExtraSticky = this.targetTransformObj.angle % (Math.PI / 2) === 0;\n                    }\n\n                    this.targetTransformObj = JSON.parse(JSON.stringify(this.oldTransformObj));\n\n                    event.scale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, this.targetTransformObj.scale * event.scale)) / this.targetTransformObj.scale;\n\n                    this.targetTransformObj.scale *= event.scale;\n                    this.targetTransformObj.angle += event.angleRad;\n                    this.targetTransformObj.angle = this.minimizeAngleRad(\n                        this.snapAngleRad(\n                            this.targetTransformObj.angle,\n                            90,\n                            this.angleIsExtraSticky ? 12 : 4\n                        )\n                    );\n                    if (this.targetTransformObj.angle % (Math.PI / 2) !== 0) {\n                        this.angleIsExtraSticky = false;\n                    }\n                    //targetTransformObj.angle = minimizeAngleRad(snapAngleRad(targetTransformObj.angle, 90, 7));\n                    event.angleRad = this.targetTransformObj.angle - this.oldTransformObj.angle;\n\n                    //calc translation\n                    {\n                        let matrix = BB.Matrix.getIdentity();\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(event.relX, event.relY));\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createScaleMatrix(event.scale));\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(event.angleRad));\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-event.relX, -event.relY));\n                        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(event.relX - event.downRelX, event.relY - event.downRelY));\n\n\n                        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\n                        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\n\n                        this.targetTransformObj.x = origin[0];\n                        this.targetTransformObj.y = origin[1];\n\n                    }\n\n                    this.highResTransformObj = BB.copyObj(this.targetTransformObj);\n\n                    //if (event.scale !== 1) {\n                    this.onViewChange({\n                        changed: ['scale', 'angle'],\n                        scale: this.targetTransformObj.scale,\n                        angle: this.targetTransformObj.angle\n                    });\n                    //}\n                    this.reqFrame();\n                    this.transformIsDirty = true;\n                    this.lastRenderedState = -1;\n\n\n                } else if (event.type === 'end') {\n                    this.oldTransformObj = null;\n                }\n\n\n            }\n        });\n\n        const onDoubleTap = () => {\n            let oldTransform = JSON.parse(JSON.stringify(this.targetTransformObj));\n            _this.fitView();\n            //_this.resetView(true);\n            this.lastRenderedState = -1;\n            this.reqFrame();\n\n            if (\n                oldTransform.scale !== this.targetTransformObj.scale ||\n                oldTransform.angle !== this.targetTransformObj.angle\n            ) {\n                this.onViewChange({\n                    changed: ['scale', 'angle'],\n                    angle: this.targetTransformObj.angle,\n                    scale: this.targetTransformObj.scale\n                });\n            }\n        }\n\n        this.mainDoubleTapper = new BB.EventChain.DoubleTapper({ onDoubleTap });\n        this.middleDoubleTapper = new BB.EventChain.DoubleTapper({ onDoubleTap });\n        this.middleDoubleTapper.setAllowedButtonArr(['middle']);\n\n\n        this.twoFingerTap = new BB.EventChain.NFingerTapper({\n            fingers: 2,\n            onTap: () => {\n                p.onUndo();\n            }\n        });\n        this.threeFingerTap = new BB.EventChain.NFingerTapper({\n            fingers: 3,\n            onTap: () => {\n                p.onRedo();\n            }\n        });\n\n\n        this.pointerEventChain = new BB.EventChain.EventChain({\n            chainArr: [\n                this.twoFingerTap,\n                this.threeFingerTap,\n                this.mainDoubleTapper,\n                this.middleDoubleTapper,\n                this.pinchZoomer,\n                new BB.EventChain.OnePointerLimiter(),\n                new BB.EventChain.CoalescedExploder()\n            ]\n        });\n        this.pointerEventChain.setChainOut((event) => {\n\n            this.cursorPos.x = event.relX;\n            this.cursorPos.y = event.relY;\n            if (event.type === 'pointerup' && event.pointerType === 'touch') {\n                this.pointer = null;\n                this.lastRenderedState = -1;\n                this.reqFrame();\n            } else {\n                if (!this.pointer) {\n                    this.pointer = { x: 0, y: 0 };\n                }\n                this.pointer.x = event.relX;\n                this.pointer.y = event.relY;\n            }\n\n            if (this.currentInputProcessor) {\n                this.currentInputProcessor.onPointer(event);\n\n            } else {\n\n                let comboStr = this.keyListener.getComboStr();\n\n                if (this.globalMode === TMode.Draw) {\n\n                    if (['', 'shift', 'ctrl'].includes(comboStr) && event.type === 'pointerdown' && event.button === 'left') {\n                        this.currentInputProcessor = this.inputProcessorObj.draw;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\n                        this.currentInputProcessor.onPointer(event);\n                    } else {\n                        this.updateCursor(TMode.Draw);\n                        this.reqFrame();\n                    }\n\n                } else if (this.globalMode === TMode.Hand) {\n\n                    if (event.type === 'pointerdown' && ['left', 'middle'].includes(event.button)) {\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\n                        this.currentInputProcessor.onPointer(event);\n                    } else {\n                        this.updateCursor(TMode.Hand);\n                    }\n\n                } else if (this.globalMode === TMode.Pick) {\n\n                    if (event.type === 'pointerdown' && ['left', 'right'].includes(event.button)) {\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\n                        this.currentInputProcessor.onPointer(event);\n                    } else {\n                        this.updateCursor(TMode.Pick);\n                    }\n\n                } else if (this.globalMode === TMode.Fill) {\n\n                    if (event.type === 'pointerdown' && event.button === 'left') {\n                        this.currentInputProcessor = this.inputProcessorObj.fill;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\n                        this.currentInputProcessor.onPointer(event);\n                    } else {\n                        this.updateCursor(TMode.Fill);\n                        this.reqFrame();\n                    }\n\n                } else if (this.globalMode === TMode.Text) {\n\n                    if (event.type === 'pointerdown' && event.button === 'left') {\n                        this.currentInputProcessor = this.inputProcessorObj.text;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\n                        this.currentInputProcessor.onPointer(event);\n                    } else {\n                        this.updateCursor(TMode.Text);\n                        this.reqFrame();\n                    }\n\n                } else if (this.globalMode === TMode.Shape) {\n\n                    if (['', 'shift', 'ctrl'].includes(comboStr) && event.type === 'pointerdown' && event.button === 'left') {\n                        this.currentInputProcessor = this.inputProcessorObj.shape;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'right') {\n                        this.currentInputProcessor = this.inputProcessorObj.picker;\n                        this.currentInputProcessor.onPointer(event);\n                    } else if ([''].includes(comboStr) && event.type === 'pointerdown' && event.button === 'middle') {\n                        this.currentInputProcessor = this.inputProcessorObj.hand;\n                        this.currentInputProcessor.onPointer(event);\n                    } else {\n                        this.updateCursor(TMode.Shape);\n                        this.reqFrame();\n                    }\n\n                }\n\n\n            }\n\n        });\n\n        //prevent ctrl scroll -> zooming page\n        BB.addEventListener(this.rootEl, 'wheel', (event) => {\n            event.preventDefault();\n        });\n\n\n        setTimeout(() => {\n            this.pointerListener = new BB.PointerListener({\n                target: this.rootEl,\n                fixScribble: true,\n                onPointer: (e) => {\n                    if (e.type === 'pointerdown' && e.button === 'middle') {\n                        try {\n                            e.eventPreventDefault();\n                        } catch (e) {}\n                    }\n                    /*if (e.type === 'pointermove') {\n                        BB.throwOut(JSON.stringify(e));\n                    }*/\n\n                    this.pointerEventChain.chainIn(e)\n                },\n                onWheel: (wheelEvent) => {\n\n                    if (this.isDrawing) {\n                        return;\n                    }\n\n                    this.reqFrame();\n                    let didZoom = this.internalZoomByStep(\n                        -wheelEvent.deltaY / (this.keyListener.isPressed('shift') ? 8 : 2),\n                        wheelEvent.relX,\n                        wheelEvent.relY\n                    );\n                    if (didZoom) {\n                        this.onViewChange({\n                            changed: ['scale'],\n                            angle: this.targetTransformObj.angle,\n                            scale: this.targetTransformObj.scale\n                        });\n                    }\n\n                    //updateCursor(TMode.Draw, true);\n                    this.lastRenderedState = -1;\n\n\n                },\n                onEnterLeave: (isOver) => {\n                    if (!isOver) {\n                        if (!this.isDrawing) {\n                            this.pointer = null;\n                            this.lastRenderedState = -1;\n                        }\n                    }\n                },\n                maxPointers: 4\n            });\n        }, 1);\n\n        this.brushRadius = 1;\n\n        this.animationFrameRequested = false;\n\n\n\n\n        //setup rendering\n        this.lastRenderedState = -2;\n        this.lastRenderTime = performance.now();\n\n        window.requestAnimationFrame(() => this.updateLoop());\n\n        this.resetView();\n    }\n\n\n    getElement (): HTMLElement {\n        return this.rootEl;\n    }\n\n    setCanvas (klC: KlCanvas): void {\n        this.klCanvas = klC;\n        this.lastDrawEvent = null;\n        this.resetView();\n\n        this.updateChangeListener();\n\n        this.lastRenderedState = -1;\n        this.reqFrame();\n    }\n\n    /**\n     * set size of workspace area in pixels\n     * @param width\n     * @param height\n     */\n    setSize (width: number, height: number): void {\n        const oldWidth = this.renderWidth;\n        const oldHeight = this.renderHeight;\n\n        if (width === oldWidth && height === oldHeight) {\n            return;\n        }\n\n        this.doResizeCanvas = true;\n        this.renderWidth = width;\n        this.renderHeight = height;\n\n        this.svgOverlay.setSize(width, height);\n\n        this.targetTransformObj.x += (width - oldWidth) / 2;\n        this.targetTransformObj.y += (height - oldHeight) / 2;\n\n        this.highResTransformObj.x = this.targetTransformObj.x;\n        this.highResTransformObj.y = this.targetTransformObj.y;\n\n        this.bgVisible = this.testBgVisible();\n\n        this.lastRenderedState = -1;\n        this.reqFrame();\n    }\n\n    setMode (modeStr: TModeStr): void {\n        //only sets the base mode\n        if (modeStr === 'draw') {\n            this.globalMode = TMode.Draw;\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\n        }\n        if (modeStr === 'fill') {\n            this.globalMode = TMode.Fill;\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\n        }\n        if (modeStr === 'text') {\n            this.globalMode = TMode.Text;\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\n        }\n        if (modeStr === 'shape') {\n            this.globalMode = TMode.Shape;\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\n        }\n        if (modeStr === 'hand') {\n            this.globalMode = TMode.Hand;\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['mouse', 'pen', 'touch']);\n        }\n        if (modeStr === 'pick') {\n            this.globalMode = TMode.Pick;\n            this.mainDoubleTapper.setAllowedPointerTypeArr(['touch']);\n        }\n    }\n\n    setEnabled (b: boolean): void {\n        // todo\n    }\n\n    setCursorSize (diameter: number): void {\n        this.brushRadius = diameter / 2;\n\n        this.svgOverlay.updateCursor({radius: this.brushRadius * this.highResTransformObj.scale});\n\n        if (this.pointer === null) {\n            clearTimeout(this.hideBrushCursorTimeout);\n\n            this.svgOverlay.updateCursor({\n                x: this.renderWidth / 2,\n                y: this.renderHeight / 2,\n                isVisible: true\n            });\n\n            // @ts-ignore\n            this.hideBrushCursorTimeout = setTimeout(() => {\n                if (this.pointer !== null) {\n                    return;\n                }\n                this.svgOverlay.updateCursor({isVisible: false});\n            }, 500);\n        }\n    }\n\n    zoomByStep (stepNum: number): void {\n        if (!this.internalZoomByStep(stepNum, this.renderWidth / 2, this.renderHeight / 2)) {\n            return;\n        }\n\n        this.lastRenderedState = -1;\n        this.reqFrame();\n\n        this.onViewChange({\n            changed: ['scale'],\n            angle: this.targetTransformObj.angle,\n            scale: this.targetTransformObj.scale\n        });\n    }\n\n    resetView (doAnimate?: boolean): void {\n        this.targetTransformObj.scale = 1;\n        this.targetTransformObj.angle = 0;\n\n        this.targetTransformObj.x = (this.renderWidth - this.klCanvas.getWidth()) / 2;\n        this.targetTransformObj.y = (this.renderHeight - this.klCanvas.getHeight()) / 2;\n\n        if (!doAnimate) {\n            this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n        } else {\n            this.doAnimateTranslate = true;\n            this.transformIsDirty = true;\n        }\n\n        this.bgVisible = this.testBgVisible();\n        this.reqFrame();\n\n        if (doAnimate) {\n            this.onViewChange({\n                changed: ['scale', 'angle'],\n                scale: this.targetTransformObj.scale,\n                angle: this.targetTransformObj.angle\n            });\n        }\n    }\n\n    fitView (): void {\n        //fit into view. center. keep angle. margin of 10px\n\n        //calc width and height of bounds\n        const canvasPointsArr = [\n            [0, 0], // top left\n            [this.klCanvas.getWidth(), 0], // top right\n            [this.klCanvas.getWidth(), this.klCanvas.getHeight()], // bottom right\n            [0, this.klCanvas.getHeight()], // bottom left\n            [this.klCanvas.getWidth() / 2, this.klCanvas.getHeight() / 2], // center\n        ];\n\n        //setup transformation matrix\n        let matrix = BB.Matrix.getIdentity();\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(this.targetTransformObj.angle));\n\n        //rotate points\n        for (let i = 0; i < canvasPointsArr.length; i++) {\n            let coords = [canvasPointsArr[i][0], canvasPointsArr[i][1], 0, 1];\n            coords = BB.Matrix.multiplyMatrixAndPoint(matrix, coords);\n            canvasPointsArr[i][0] = coords[0];\n            canvasPointsArr[i][1] = coords[1];\n        }\n\n        const boundsObj = {\n            x0: null,\n            y0: null,\n            x1: null,\n            y1: null\n        };\n        for (let i = 0; i < canvasPointsArr.length; i++) {\n            if (boundsObj.x0 === null || canvasPointsArr[i][0] < boundsObj.x0) {\n                boundsObj.x0 = canvasPointsArr[i][0];\n            }\n            if (boundsObj.y0 === null || canvasPointsArr[i][1] < boundsObj.y0) {\n                boundsObj.y0 = canvasPointsArr[i][1];\n            }\n            if (boundsObj.x1 === null || canvasPointsArr[i][0] > boundsObj.x1) {\n                boundsObj.x1 = canvasPointsArr[i][0];\n            }\n            if (boundsObj.y1 === null || canvasPointsArr[i][1] > boundsObj.y1) {\n                boundsObj.y1 = canvasPointsArr[i][1];\n            }\n        }\n        const boundsWidth = boundsObj.x1 - boundsObj.x0;\n        const boundsHeight = boundsObj.y1 - boundsObj.y0;\n\n        //fit bounds\n        const padding = 40;\n        const fit = BB.fitInto(\n            boundsWidth,\n            boundsHeight, \n            this.renderWidth - padding, \n            this.renderHeight - padding, \n            1\n        );\n\n        //determine scale\n        const factor = fit.width / boundsWidth;\n\n        //center\n        this.targetTransformObj.x = (this.renderWidth / 2) - (canvasPointsArr[4][0] - canvasPointsArr[0][0]) * factor;\n        this.targetTransformObj.y = (this.renderHeight / 2) - (canvasPointsArr[4][1] - canvasPointsArr[0][1]) * factor;\n\n        this.targetTransformObj.scale = factor;\n        this.doAnimateTranslate = true;\n        this.transformIsDirty = true;\n        this.reqFrame();\n\n        this.onViewChange({\n            changed: ['scale', 'angle'],\n            scale: this.targetTransformObj.scale,\n            angle: this.targetTransformObj.angle\n        });\n    }\n\n    setAngle (angleDeg: number, isRelative?: boolean): void {\n        //rotation done around center\n        const centerObj = {\n            x: this.renderWidth / 2,\n            y: this.renderHeight / 2\n        };\n\n        const oldAngleRad = this.targetTransformObj.angle;\n        const angleRad = angleDeg / 180 * Math.PI;\n\n        if (isRelative) {\n            this.targetTransformObj.angle += angleRad;\n        } else {\n            this.targetTransformObj.angle = angleRad;\n        }\n\n        this.targetTransformObj.angle = this.minimizeAngleRad(\n            this.snapAngleRad(\n                this.targetTransformObj.angle,\n                90,\n                4\n            )\n        );\n\n        //rotate transform.xy\n        let matrix = BB.Matrix.getIdentity();\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(centerObj.x, centerObj.y));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createRotationMatrix(this.targetTransformObj.angle - oldAngleRad));\n        matrix = BB.Matrix.multiplyMatrices(matrix, BB.Matrix.createTranslationMatrix(-centerObj.x, -centerObj.y));\n\n        let origin = [this.targetTransformObj.x, this.targetTransformObj.y, 0, 1];\n        origin = BB.Matrix.multiplyMatrixAndPoint(matrix, origin);\n        this.targetTransformObj.x = origin[0];\n        this.targetTransformObj.y = origin[1];\n\n        this.highResTransformObj = JSON.parse(JSON.stringify(this.targetTransformObj));\n        this.transformIsDirty = true;\n        this.reqFrame(true);\n    }\n\n    /**\n     * translate canvas by viewport pixels\n     * @param tx\n     * @param ty\n     */\n    translateView (tx: number, ty: number): void {\n        const scale = 40;\n\n        this.targetTransformObj.x += tx * scale;\n        this.targetTransformObj.y += ty * scale;\n\n        this.transformIsDirty = true;\n        this.doAnimateTranslate = true;\n        this.reqFrame(true);\n    }\n\n    getIsDrawing (): boolean {\n        return this.isDrawing;\n    }\n\n    getScale (): number {\n        return this.targetTransformObj.scale;\n    }\n\n    getAngleDeg (): number {\n        return this.targetTransformObj.angle * 180 / Math.PI;\n    }\n\n    getMaxScale (): number {\n        return MAX_SCALE;\n    }\n\n    getMinScale (): number {\n        return MIN_SCALE;\n    }\n\n    requestFrame (): void {\n        this.lastRenderedState = -1;\n        this.reqFrame();\n    }\n\n    setLastDrawEvent (x: number | null, y?: number, pressure?: number): void {\n        if (x === null) {\n            this.lastDrawEvent = null;\n            return;\n        }\n\n        if (!this.lastDrawEvent) {\n            this.lastDrawEvent = {x: 0, y: 0, pressure: 0};\n        }\n        this.lastDrawEvent.x = x;\n        this.lastDrawEvent.y = y;\n        this.lastDrawEvent.pressure = pressure;\n    }\n\n}\n","import {BB} from '../../bb/bb';\nimport {IKlBasicLayer} from '../kl.types';\n\n/**\n * preview of image with layers. can do mix modes and opacity.\n * creates a canvas.\n *\n * p = {\n *     width: 123,\n *     height: 123,\n *     layers: [// can be changed after the fact\n *         {\n *             image: Canvas,\n *             opacity: 1,\n *             mixModeStr: 'source-over'\n *         }\n *     ]\n * }\n *\n * @param p\n * @constructor\n */\nexport function KlCanvasPreview(\n    p: {\n        width: number;\n        height: number;\n        layers: IKlBasicLayer[];\n    }\n) {\n    const scale = p.width / p.layers[0].image.width;\n    const width = scale > 1 ? p.layers[0].image.width : p.width;\n    const height = scale > 1 ? p.layers[0].image.height : p.height;\n\n    let canvas = BB.canvas(width, height);\n    canvas.style.backgroundImage = 'url(' + BB.createCheckerDataUrl(8) + ')';\n    let ctx = canvas.getContext('2d');\n\n    BB.css(canvas, {\n        width: '100%',\n        height: '100%',\n        imageRendering: scale > 1 ? 'pixelated' : null,\n    });\n\n    function render() {\n        ctx.save();\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        for (let i = 0; i < p.layers.length; i++) {\n            ctx.globalAlpha = p.layers[i].opacity;\n            ctx.globalCompositeOperation = p.layers[i].mixModeStr;\n            if (canvas.width > p.layers[i].image.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(p.layers[i].image, 0, 0, canvas.width, canvas.height);\n        }\n        ctx.restore();\n    }\n\n    setTimeout(render, 0);\n\n    // --- interface ---\n    this.getElement = function() {\n        return canvas;\n    };\n\n    this.render = function() {\n        render();\n    };\n}","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport rotateImg from 'url:~/src/app/img/ui/cursor-rotate.png';\nimport {KeyListener} from '../../../bb/input/key-listener';\nimport {IVector2D} from '../../../bb/bb.types';\n\nexport interface ITransform {\n    x: number; // center of transform region. image space\n    y: number;\n    width: number; // size of transform region. image space\n    height: number;\n    angleDeg: number; // angle of transform region. degrees\n}\n\n\n/**\n * snap entire transform to pixel grid. changes transform\n *\n * for x y:\n * If a dimension has an even size, it be an integer.\n * If it's uneven, it's sits exactly half way between two pixels.\n *\n * @param transform\n */\nfunction snapToPixel(transform: ITransform): void {\n    if (Math.abs(transform.angleDeg) % 90 !== 0) {\n        return;\n    }\n\n    transform.width = Math.round(transform.width);\n    transform.height = Math.round(transform.height);\n    // 0° is original orientation.\n    // At 90° and 270° width and height become swapped due to different orientation.\n    const whSwapped = Math.abs(transform.angleDeg - 90) % 180 === 0;\n    transform.x = ((whSwapped ? transform.height : transform.width) % 2 === 0) ? Math.round(transform.x) : Math.round(transform.x - 0.5) + 0.5;\n    transform.y = ((whSwapped ? transform.width : transform.height) % 2 === 0)  ? Math.round(transform.y) : Math.round(transform.y - 0.5) + 0.5;\n}\n\nfunction copyTransform(transform: ITransform): ITransform {\n    return {\n        x: transform.x,\n        y: transform.y,\n        width: transform.width,\n        height: transform.height,\n        angleDeg: transform.angleDeg,\n    };\n}\n\n/**\n * image space to transform space\n * - origin of transform space is at center of transform bounds.\n * - same scale as image space. -> one unit is x: 1/width, y: 1/height\n * - up is where transform points up\n * - x goes right\n * - y goes down\n * @param x\n * @param y\n * @param transform\n */\nfunction toTransformSpace (x: number, y: number, transform: ITransform): IVector2D {\n    let px, py;\n    px = x - transform.x;\n    py = y - transform.y;\n\n    const rot = BB.rotateAround({x: 0, y: 0},\n        {x: px, y: py},\n        -transform.angleDeg);\n    px = rot.x;\n    py = rot.y;\n\n    return {\n        x: px,\n        y: py,\n    };\n}\n\n/**\n * transform space to image space\n * @param x\n * @param y\n * @param transform\n */\nfunction toImageSpace(x: number, y: number, transform: ITransform): IVector2D {\n    const rot = BB.rotateAround({x: 0, y: 0},\n        {x: x, y: y},\n        transform.angleDeg);\n    return {\n        x: rot.x + transform.x,\n        y: rot.y + transform.y,\n    };\n}\n\n\n\n/**\n * Free Transform UI\n * rotate, scale, translate\n *\n * - if rotation is multiple of 90° it will snap to pixels, to be more useful for pixel art\n * - when rotation goes from non-multiple of 90° to a multiple, it will snap position and width height to pixels\n * - transform.x, transform.y can sit between pixels (by 0.5) if width or height is odd number.\n *      - this is what complicates things\n * - if transform region small, corner grips move out of the way\n *\n * iX iY, iP.x, iP.y - i indicates image space\n * tX tY, tP.x, tP.y - t indicates transform space\n *\n * Not sure if can be used for navigable canvas. (especially if canvas rotates view)\n * Probably can't be extended for distort. Needs a different approach.\n *\n * --- DOM structure ---\n * rootEl {\n * \ttransEl [\n * \t\tboundsEl\n * \t\tedges[]\n * \t\tcorners[] - round grips in the corner of transform region\n * \t\tangleGrip\n * \t]\n * }\n *\n */\nexport class FreeTransform {\n\n    // --- private ---\n    private readonly transform: ITransform; // coordinates and dimensions of transformation\n    private isConstrained: boolean;\n    private ratio: number; // aspect ratio of transform\n    private readonly scale: number;\n    private readonly scaled = { // scaled coordinates and dimensions for screenspace\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n        corners: [{x: 0, y: 0}], // in transform space\n    };\n    private readonly minSnapDist = 7; // minimal snapping distance in px screenspace\n    private snappingEnabled: boolean;\n    private readonly snapX: number[];\n    private readonly snapY: number[];\n    private readonly callback: (transform: ITransform) => void;\n\n\n    private readonly cornerCursors = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];\n    private readonly gripSize = 14;\n    private readonly edgeSize = 10;\n\n    private readonly rootEl: HTMLElement; // sits at origin of image\n    private readonly transEl: HTMLElement; // at middle of transform. rotates\n    private readonly boundsEl: HTMLElement; // draggable bounds rectangle with outline\n    private readonly corners: {\n        i: number; // index in corners array\n        el: HTMLElement; // draggable corner circle in DOM\n        x: number; // unscaled position (transform space)\n        y: number;\n        virtualPos: IVector2D; // unscaled temporary position (image space)\n        updateDOM: () => void; // update styling in DOM\n        pointerListener: any;\n    }[] = [];\n    private keyListener: KeyListener;\n    private boundsPointerListener: any; // BB.PointerListener\n    private anglePointerListener: any; // BB.PointerListener\n    private readonly edges: { // derive position from corners\n        el: HTMLElement;\n        updateDOM: () => void;\n        pointerListener: any;\n    }[] = [];\n    private readonly angleGrip: {\n        el: HTMLElement,\n        x: number; // transform space\n        y: number;\n        snap: boolean,\n        updateDOM: () => void,\n    };\n\n    private updateScaled(): void {\n        this.scaled.x = this.transform.x * this.scale;\n        this.scaled.y = this.transform.y * this.scale;\n        this.scaled.width = this.transform.width * this.scale;\n        this.scaled.height = this.transform.height * this.scale;\n        this.scaled.corners = this.corners.map((item) => {\n            return {x: item.x * this.scale, y: item.y * this.scale};\n        });\n    }\n\n    /**\n     * Returns snapped point, if ix, iy snaps. If no snapping, returns point unchanged.\n     * both in image space\n     *\n     * @param iX - image space\n     * @param iY - image space\n     * @private\n     */\n    private snapCorner (iX: number, iY: number): IVector2D {\n        if (!this.snappingEnabled) {\n            return {x: iX, y: iY};\n        }\n        let dist: number;\n        const snap: {\n            x: number;\n            y: number;\n            dist: {\n                x: number;\n                y: number;\n            }\n        } = {\n            x: null,\n            y: null,\n            dist: {\n                x: null,\n                y: null,\n            }\n        };\n        for (let e = 0; e < this.snapX.length; e++) {\n            dist = Math.abs(iX - this.snapX[e]);\n            if (dist < this.minSnapDist / this.scale) {\n                if (snap.x === null || dist < snap.dist.x) {\n                    snap.x = this.snapX[e];\n                    snap.dist.x = dist;\n                }\n            }\n        }\n        for (let e = 0; e < this.snapY.length; e++) {\n            dist = Math.abs(iY - this.snapY[e]);\n            if (dist < this.minSnapDist / this.scale) {\n                if (snap.y === null || dist < snap.dist.y) {\n                    snap.y = this.snapY[e];\n                    snap.dist.y = dist;\n                }\n            }\n        }\n\n        if (snap.x === null && snap.y === null) {\n            return {\n                x: iX,\n                y: iY,\n            };\n        }\n        return {\n            x: snap.x === null ? iX : snap.x,\n            y: snap.y === null ? iY : snap.y,\n        };\n    }\n\n    /**\n     * If constrained return nearest corner pos that fits aspect ratio\n     *\n     * @param cornerIndex\n     * @param iX\n     * @param iY\n     * @private\n     */\n    private constrainCorner (cornerIndex: number, iX: number, iY: number): IVector2D {\n        if (!this.isConstrained) {\n            return {\n                x: iX,\n                y: iY,\n            };\n        }\n        const flip = this.transform.width * this.transform.height < 0 ? -1 : 1;\n        return BB.projectPointOnLine(\n            {x: this.transform.x, y: this.transform.y},\n            toImageSpace(this.ratio, flip * ([0, 2].includes(cornerIndex) ? 1 : -1), this.transform),\n            {x: iX, y: iY}\n        );\n    }\n\n    /**\n     * Update corners according to width height.\n     * Not their DOM.\n     */\n    private updateCornerPositions (): void {\n        this.corners[0].x = (-this.transform.width / 2); // top left\n        this.corners[0].y = (-this.transform.height / 2);\n\n        this.corners[1].x = (this.transform.width / 2); // top right\n        this.corners[1].y = (-this.transform.height / 2);\n\n        this.corners[2].x = (this.transform.width / 2); // bottom right\n        this.corners[2].y = (this.transform.height / 2);\n\n        this.corners[3].x = (-this.transform.width / 2); // bottom left\n        this.corners[3].y = (this.transform.height / 2);\n    }\n\n    /**\n     * If constrained and dragging an edge, restore aspect ratio\n     * Updates corner positions.\n     *\n     * @param widthChanged\n     * @param heightChanged\n     * @private\n     */\n    private restoreRatio (widthChanged: boolean, heightChanged: boolean): void {\n        if (!this.isConstrained) {\n            return;\n        }\n        const angle90 = Math.abs(this.transform.angleDeg) % 90 === 0;\n        const whSwapped = Math.abs(this.transform.angleDeg - 90) % 180 === 0;\n        if (heightChanged && !widthChanged) {\n            const newHeight = Math.abs(this.corners[3].y - this.corners[0].y);\n            let newWidth = this.ratio * newHeight;\n            if (angle90) {\n                newWidth = (whSwapped ? this.transform.y % 1 : this.transform.x % 1) === 0 ?\n                    BB.roundEven(newWidth) : BB.roundUneven(newWidth);\n            }\n            if (this.corners[1].x - this.corners[0].x < 0) {\n                newWidth *= -1;\n            }\n            this.corners[0].x = -newWidth / 2;\n            this.corners[3].x = -newWidth / 2;\n            this.corners[1].x = newWidth / 2;\n            this.corners[2].x = newWidth / 2;\n        }\n        if (!heightChanged && widthChanged) {\n            const newWidth = Math.abs(this.corners[0].x - this.corners[1].x);\n            let newHeight = newWidth / this.ratio;\n            if (angle90) {\n                newHeight = (whSwapped ? this.transform.x % 1 : this.transform.y % 1) === 0  ?\n                    BB.roundEven(newHeight) : BB.roundUneven(newHeight);\n            }\n            if (this.corners[3].y - this.corners[0].y < 0) {\n                newHeight *= -1;\n            }\n            this.corners[0].y = -newHeight / 2;\n            this.corners[1].y = -newHeight / 2;\n            this.corners[2].y = newHeight / 2;\n            this.corners[3].y = newHeight / 2;\n        }\n    }\n\n\n    /**\n     * update transform based on corners\n     * @private\n     */\n    private updateTransformViaCorners (): void {\n\n        // calc transform center in image space\n        const rot = BB.rotateAround(\n            {x: 0, y: 0},\n            {\n                x: (this.corners[0].x + this.corners[1].x) / 2,\n                y: (this.corners[0].y + this.corners[3].y) / 2,\n            },\n            this.transform.angleDeg\n        );\n        this.transform.x = rot.x + this.transform.x;\n        this.transform.y = rot.y + this.transform.y;\n\n        // update size\n        this.transform.width = this.corners[1].x - this.corners[0].x;\n        this.transform.height = this.corners[3].y - this.corners[0].y;\n\n        // new center means corners changed their position\n        this.updateCornerPositions();\n\n        this.updateDOM();\n    }\n\n    /**\n     * updates DOM according to transform\n     * @param skipCallback\n     */\n    private updateDOM (skipCallback?: boolean) {\n        this.updateScaled();\n\n        BB.css(this.transEl, {\n            left: this.scaled.x + \"px\",\n            top: this.scaled.y + \"px\",\n            transformOrigin: \"0 0\",\n            transform: \"rotate(\" + this.transform.angleDeg + \"deg)\",\n        });\n\n        BB.css(this.boundsEl, {\n            width: Math.abs(this.scaled.width) + \"px\",\n            height: Math.abs(this.scaled.height) + \"px\",\n            left: Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) + \"px\",\n            top: Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) + \"px\"\n        });\n\n        this.corners[0].updateDOM();\n        this.corners[1].updateDOM();\n        this.corners[2].updateDOM();\n        this.corners[3].updateDOM();\n\n        this.edges[0].updateDOM();\n        this.edges[1].updateDOM();\n        this.edges[2].updateDOM();\n        this.edges[3].updateDOM();\n\n\n        this.angleGrip.x = 0;\n        this.angleGrip.y = (-Math.abs(this.transform.height * this.scale) / 2) - 20;\n        this.angleGrip.updateDOM();\n        if (!skipCallback) {\n            if (this.callback) { // why should updateDOM trigger the callback?\n                this.callback(copyTransform(this.transform));\n            }\n        }\n    }\n\n\n\n    // --- public ---\n    constructor (\n        params: {\n            x: number; // center of transform region. image space\n            y: number;\n            width: number; // size of transform region. image space\n            height: number;\n            angleDeg: number; // angle of transform region. degrees\n\n            isConstrained: boolean; // proportions constrained\n            snapX: number[]; // where snapping along X axis. image space\n            snapY: number[]; // where snapping along X axis. image space\n            scale: number; // ratio of screen-space / image-space\n            callback: (transform: ITransform) => void;\n        }\n    ) {\n        this.transform = { // coordinates and dimensions of transformation\n            x: params.x,\n            y: params.y,\n            width: params.width,\n            height: params.height,\n            angleDeg: params.angleDeg,\n        };\n\n        this.isConstrained = !!params.isConstrained;\n\n        this.snapX = params.snapX;\n        this.snapY = params.snapY;\n        this.callback = params.callback;\n        this.scale = params.scale;\n        this.snappingEnabled = true;\n        this.ratio = this.transform.width / this.transform.height;\n\n        this.rootEl = BB.el({\n            className: 'kl-free-transform',\n            css: {\n                userSelect: 'none',\n            }\n        });\n        this.transEl = BB.el({\n            parent: this.rootEl,\n            css: {\n                position: 'absolute',\n            }\n        });\n\n        this.boundsEl = BB.el({\n            css: {\n                position: 'absolute',\n                cursor: 'move',\n                boxShadow: 'rgba(255, 255, 255, 0.5) 0 0 0 1px inset, rgba(0, 0, 0, 0.5) 0 0 0 1px',\n            }\n        });\n\n        const pointerRemainder = {\n            x: 0,\n            y: 0,\n        };\n        function resetRemainder() {\n            pointerRemainder.x = 0;\n            pointerRemainder.y = 0;\n        }\n        this.keyListener = new BB.KeyListener({});\n\n        let boundsStartP = {\n            x: 0,\n            y: 0,\n        }\n        this.boundsPointerListener = new BB.PointerListener({\n            target: this.boundsEl,\n            fixScribble: true,\n            onPointer: (event) => {\n                event.eventPreventDefault();\n                if (event.type === 'pointerdown') {\n                    boundsStartP = {x: this.transform.x, y: this.transform.y};\n                }\n                if (event.type === 'pointermove' && event.button === 'left') {\n                    this.transform.x = boundsStartP.x + (event.pageX - event.downPageX) / this.scale;\n                    this.transform.y = boundsStartP.y + (event.pageY - event.downPageY) / this.scale;\n\n\n                    let dist;\n                    let snap: any = {};\n                    if (this.snappingEnabled) {\n                        let i;\n                        for (i = 0; i < this.snapX.length; i++) {\n                            dist = Math.abs(this.transform.x - this.snapX[i]);\n                            if (dist < this.minSnapDist / this.scale) {\n                                if (!snap.x || dist < snap.distX) {\n                                    snap.x = this.snapX[i];\n                                    snap.distX = dist;\n                                }\n                            }\n                        }\n                        for (i = 0; i < this.snapY.length; i++) {\n                            dist = Math.abs(this.transform.y - this.snapY[i]);\n                            if (dist < this.minSnapDist / this.scale) {\n                                if (!snap.y || dist < snap.distY) {\n                                    snap.y = this.snapY[i];\n                                    snap.distY = dist;\n                                }\n                            }\n                        }\n\n                        let iP;\n                        for (i = 0; i < 4; i++) {\n                            iP = toImageSpace(this.corners[i].x, this.corners[i].y, this.transform);\n                            let j;\n                            for (j = 0; j < this.snapX.length; j++) {\n                                dist = Math.abs(iP.x - this.snapX[j]);\n                                if (dist < this.minSnapDist / this.scale) {\n                                    if (!snap.x || dist < snap.distX) {\n                                        snap.x = this.snapX[j] - (iP.x - this.transform.x);\n                                        snap.distX = dist;\n                                    }\n                                }\n                            }\n                            for (j = 0; j < this.snapY.length; j++) {\n                                dist = Math.abs(iP.y - this.snapY[j]);\n                                if (dist < this.minSnapDist / this.scale) {\n                                    if (!snap.y || dist < snap.distY) {\n                                        snap.y = this.snapY[j] - (iP.y - this.transform.y);\n                                        snap.distY = dist;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (this.keyListener.getComboStr() === 'shift') {\n                        let projected = BB.projectPointOnLine(\n                            {x: 0, y: boundsStartP.y},\n                            {x: 10, y: boundsStartP.y},\n                            {x: this.transform.x, y: this.transform.y});\n                        let dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\n                        snap = {};\n                        snap.x = projected.x;\n                        snap.y = projected.y;\n                        snap.distX = dist;\n                        snap.distY = dist;\n\n                        projected = BB.projectPointOnLine(\n                            {x: boundsStartP.x, y: 0},\n                            {x: boundsStartP.x, y: 10},\n                            {x: this.transform.x, y: this.transform.y});\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\n                        if (dist < snap.distX) {\n                            snap.x = projected.x;\n                            snap.y = projected.y;\n                            snap.distX = dist;\n                            snap.distY = dist;\n                        }\n\n                        projected = BB.projectPointOnLine(\n                            {x: boundsStartP.x, y: boundsStartP.y},\n                            {x: boundsStartP.x + 1, y: boundsStartP.y + 1},\n                            {x: this.transform.x, y: this.transform.y});\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\n                        if (dist < snap.distX) {\n                            snap.x = projected.x;\n                            snap.y = projected.y;\n                            snap.distX = dist;\n                            snap.distY = dist;\n                        }\n\n                        projected = BB.projectPointOnLine(\n                            {x: boundsStartP.x, y: boundsStartP.y},\n                            {x: boundsStartP.x + 1, y: boundsStartP.y - 1},\n                            {x: this.transform.x, y: this.transform.y});\n                        dist = BB.dist(projected.x, projected.y, this.transform.x, this.transform.y);\n                        if (dist < snap.distX) {\n                            snap.x = projected.x;\n                            snap.y = projected.y;\n                            snap.distX = dist;\n                            snap.distY = dist;\n                        }\n                    }\n                    if (snap.x != undefined) {\n                        this.transform.x = snap.x;\n                    }\n                    if (snap.y != undefined) {\n                        this.transform.y = snap.y;\n                    }\n\n                    // snap to pixels\n                    if (Math.abs(this.transform.angleDeg) % 90 === 0) {\n                        snapToPixel(this.transform);\n                        this.updateCornerPositions();\n                    }\n\n                    this.updateDOM();\n                }\n            }\n        })\n\n        for (let i = 0; i < 4; i++) {\n            ((i) => {\n                const g = this.corners[i] = {\n                    i: i,\n                    el: BB.el({\n                        css: {\n                            width: this.gripSize + 'px',\n                            height: this.gripSize + 'px',\n                            background: '#fff',\n                            /*background: [\n                                '#ff0000',\n                                '#00ff00',\n                                '#0000ff',\n                                '#ff00ff',\n                            ][i],*/\n                            borderRadius: this.gripSize + 'px',\n                            position: 'absolute',\n                            boxShadow: 'inset 0 0 0 2px #000'\n                        }\n                    }),\n                    x: 0,\n                    y: 0,\n                    virtualPos: {\n                        x: 0,\n                        y: 0,\n                    },\n                    updateDOM: null,\n                    pointerListener: null,\n                };\n                g.updateDOM = () => {\n\n                    // grip position\n                    // if gets small, offset grips, so easier to handle\n                    const offsetArr = [[-1, -1], [1, -1], [1, 1], [-1, 1]].map(item => {\n                        item[0] *= this.transform.width > 0 ? 1 : -1;\n                        item[1] *= this.transform.height > 0 ? 1 : -1;\n                        return item;\n                    });\n                    const tinyOffset = Math.abs(this.scaled.width) < 20 || Math.abs(this.scaled.height) < 20 ? 10 : 0;\n\n                    BB.css(g.el, {\n                        left: (this.scaled.corners[g.i].x - this.gripSize / 2 + offsetArr[i][0] * tinyOffset) + 'px',\n                        top: (this.scaled.corners[g.i].y - this.gripSize / 2 + offsetArr[i][1] * tinyOffset) + 'px'\n                    });\n\n\n                    // cursor\n                    let angle = BB.pointsToAngleDeg(\n                        {\n                            x: this.transform.x,\n                            y: this.transform.y,\n                        },\n                        toImageSpace(g.x, g.y, this.transform),\n                    ) + 135; // offset so nw is 0\n                    while (angle < 0) {\n                        angle += 360;\n                    }\n                    let index = Math.round(angle / 45) % this.cornerCursors.length;\n                    BB.css(g.el, {\n                        cursor: this.cornerCursors[index] + '-resize',\n                    });\n                };\n\n                g.pointerListener = new BB.PointerListener({\n                    target: this.corners[i].el,\n                    fixScribble: true,\n                    onPointer: (event) => {\n                        event.eventPreventDefault();\n                        if (event.type === 'pointerdown' && event.button === 'left') {\n                            this.corners[i].virtualPos = toImageSpace(this.corners[i].x, this.corners[i].y, this.transform);\n\n                        } else if (event.type === 'pointermove' && event.button === 'left') {\n                            this.corners[i].virtualPos.x += event.dX / this.scale;\n                            this.corners[i].virtualPos.y += event.dY / this.scale;\n\n                            let iP = {\n                                x: this.corners[i].virtualPos.x,\n                                y: this.corners[i].virtualPos.y,\n                            };\n                            iP = this.constrainCorner(i, iP.x, iP.y);\n                            if (!this.isConstrained) {\n                                iP = this.snapCorner(iP.x, iP.y);\n                            }\n\n                            if (Math.abs(this.transform.angleDeg) % 90 === 0) {\n                                iP.x = Math.round(iP.x);\n                                iP.y = Math.round(iP.y);\n                            }\n\n                            const tP = toTransformSpace(iP.x, iP.y, this.transform);\n\n                            const dX = tP.x - this.corners[i].x;\n                            const dY = tP.y - this.corners[i].y;\n                            this.corners[i].x = tP.x;\n                            this.corners[i].y = tP.y;\n\n                            let indexes = [];\n                            if (i === 0) { // top left\n                                indexes = [3, 1, 2];\n                            } else if (i === 1) { // top right\n                                indexes = [2, 0, 3];\n                            } else if (i === 2) { // bottom right\n                                indexes = [1, 3, 0];\n                            } else if (i === 3) { // bottom left\n                                indexes = [0, 2, 1];\n                            }\n\n                            this.corners[indexes[0]].x = this.corners[i].x;\n                            this.corners[indexes[1]].y = this.corners[i].y;\n                            if (this.keyListener.isPressed('shift')) {\n                                this.corners[indexes[2]].x -= dX;\n                                this.corners[indexes[2]].y -= dY;\n                                this.corners[indexes[1]].x = this.corners[indexes[2]].x;\n                                this.corners[indexes[0]].y = this.corners[indexes[2]].y;\n                            }\n\n                            this.updateTransformViaCorners();\n\n                        }\n                    }\n                });\n\n            })(i);\n        }\n\n        this.updateCornerPositions();\n        this.updateScaled();\n\n        let isInverted: boolean;\n        for (let i = 0; i < 4; i++) {\n            ((i) => {\n                this.edges[i] = {\n                    el: BB.el({\n                        css: {\n                            width: this.edgeSize + 'px',\n                            height: this.edgeSize + 'px',\n                            /*background: [\n                                '#ff000044',\n                                '#00ff0044',\n                                '#0000ff44',\n                                '#ff00ff44',\n                            ][i],*/\n                            position: 'absolute',\n                        },\n                    }),\n                    updateDOM: null,\n                    pointerListener: null,\n                };\n                const g = this.edges[i];\n                g.updateDOM = () => {\n                    if (i === 0) {\n                        BB.css(g.el, {\n                            left: Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) + 'px',\n                            top: (Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) - this.edgeSize) + 'px',\n                            width: Math.abs(this.scaled.width) + 'px',\n                            height: this.edgeSize + 'px',\n                        });\n                    } else if (i === 1) {\n                        BB.css(g.el, {\n                            left: Math.max(this.scaled.corners[0].x, this.scaled.corners[1].x) + 'px',\n                            top: Math.min(this.scaled.corners[1].y, this.scaled.corners[2].y) + 'px',\n                            width: this.edgeSize + 'px',\n                            height: Math.abs(this.scaled.height) + 'px',\n                        });\n                    } else if (i === 2) {\n                        BB.css(g.el, {\n                            left: Math.min(this.scaled.corners[3].x, this.scaled.corners[2].x) + 'px',\n                            top: Math.max(this.scaled.corners[0].y,this.scaled.corners[3].y) + 'px',\n                            width: Math.abs(this.scaled.width) + 'px',\n                            height: this.edgeSize + 'px',\n                        });\n                    } else if (i === 3) {\n                        BB.css(g.el, {\n                            left: (Math.min(this.scaled.corners[0].x, this.scaled.corners[1].x) - this.edgeSize) + 'px',\n                            top: Math.min(this.scaled.corners[0].y, this.scaled.corners[3].y) + 'px',\n                            width: this.edgeSize + 'px',\n                            height: Math.abs(this.scaled.height) + 'px',\n                        });\n                    }\n                    let angleOffset = Math.round(this.transform.angleDeg / 45);\n                    while (angleOffset < 0)\n                        angleOffset += 8;\n                    angleOffset = (i * 2 + 1 + angleOffset) % this.cornerCursors.length;\n                    g.el.style.cursor = this.cornerCursors[angleOffset] + '-resize';\n\n                };\n\n                const isVertical = [0, 2].includes(i);\n                g.pointerListener = new BB.PointerListener({\n                    target: this.edges[i].el,\n                    fixScribble: true,\n                    onPointer: (event) => {\n                        event.eventPreventDefault();\n                        if (event.type === 'pointerdown' && event.button === 'left') {\n                            if (isVertical) { // top bottom\n                                isInverted = this.corners[0].y >= this.corners[3].y;\n                            } else { // left right\n                                isInverted = this.corners[0].x >= this.corners[1].x;\n                            }\n                            resetRemainder();\n                        }\n                        if (event.type === 'pointermove' && event.button === 'left') {\n                            const tfD = BB.rotateAround({x: 0, y: 0},\n                                {x: event.dX / this.scale, y: event.dY / this.scale},\n                                -this.transform.angleDeg);\n                            let ti = {\n                                dX: tfD.x,\n                                dY: tfD.y,\n                            };\n                            if (Math.abs(this.transform.angleDeg) % 90 === 0) {\n                                ti = BB.intDxy(pointerRemainder, tfD.x, tfD.y);\n                            }\n\n                            let indexes = [];\n                            if (i === 0) { // top\n                                indexes = [2, 3, 0, 1];\n                            } else if (i === 1) { // right\n                                indexes = [0, 3, 1, 2];\n                            } else if (i === 2) { // bottom\n                                indexes = [0, 1, 2, 3];\n                            } else if (i === 3) { // left\n                                indexes = [1, 2, 0, 3];\n                            }\n\n                            let dimension = isVertical ? 'y' : 'x';\n                            let d = isVertical ? ti.dY : ti.dX;\n\n                            if (isInverted) {\n                                this.corners[indexes[0]][dimension] += d;\n                                this.corners[indexes[1]][dimension] += d;\n                            } else {\n                                this.corners[indexes[2]][dimension] += d;\n                                this.corners[indexes[3]][dimension] += d;\n                            }\n                            if (this.keyListener.isPressed('shift')) {\n                                if (isInverted) {\n                                    this.corners[indexes[2]][dimension] -= d;\n                                    this.corners[indexes[3]][dimension] -= d;\n                                } else {\n                                    this.corners[indexes[0]][dimension] -= d;\n                                    this.corners[indexes[1]][dimension] -= d;\n                                }\n                            }\n\n                            if (isVertical) { // top bottom\n                                this.restoreRatio(false, true);\n                            } else { // left right\n                                this.restoreRatio(true, false);\n                            }\n\n                            this.updateTransformViaCorners();\n\n                        }\n                    }\n                });\n\n            })(i);\n        }\n\n        this.angleGrip = {\n            el: BB.el({\n                css: {\n                    cursor: 'url(' + rotateImg + ') 10 10, move',\n                    width: this.gripSize + 'px',\n                    height: this.gripSize + 'px',\n                    background: '#0ff',\n                    borderRadius: this.gripSize + 'px',\n                    position: 'absolute',\n                    boxShadow: 'inset 0 0 0 2px #000',\n                },\n            }),\n            x: 0,\n            y: 0,\n            snap: false,\n            updateDOM: () => {\n                BB.css(this.angleGrip.el, {\n                    left: (this.angleGrip.x - this.gripSize / 2) + 'px',\n                    top: (this.angleGrip.y - this.gripSize / 2) + 'px',\n                });\n            },\n        };\n        BB.el({\n            parent: this.angleGrip.el,\n            css: {\n                width: '2px',\n                height: '13px',\n                left: (this.gripSize / 2 - 1) + 'px',\n                top: this.gripSize + 'px',\n                background: '#0ff',\n                position: 'absolute'\n            }\n        });\n\n        this.anglePointerListener = new BB.PointerListener({\n            target: this.angleGrip.el,\n            fixScribble: true,\n            onPointer: (event) => {\n                event.eventPreventDefault();\n                if (event.type === 'pointermove' && event.button === 'left') {\n\n                    const bounds = this.rootEl.getBoundingClientRect();\n                    const offset = {\n                        x: bounds.left - this.rootEl.scrollLeft,\n                        y: bounds.top - this.rootEl.scrollTop,\n                    };\n                    const iP = {x: (event.clientX - offset.x) / this.scale, y: (event.clientY - offset.y) / this.scale};\n\n                    const a = BB.pointsToAngleDeg({x: this.transform.x, y: this.transform.y}, iP) + 90;\n                    this.transform.angleDeg = a;\n                    const snapDeg = Math.round(a / 360 * 8) * 45;\n                    if (this.keyListener.getComboStr() === 'shift') {\n                        this.transform.angleDeg = snapDeg;\n                    } else if (this.snappingEnabled && Math.abs(snapDeg - a) < 8) {\n                        this.transform.angleDeg = snapDeg;\n                    }\n                    this.updateDOM();\n\n                }\n                if (event.type === 'pointerup') {\n                    if (Math.abs(this.transform.angleDeg) % 90 === 0) {\n                        snapToPixel(this.transform);\n                        this.updateCornerPositions();\n                        this.updateDOM();\n                    }\n                }\n            }\n        });\n\n        snapToPixel(this.transform);\n        this.updateDOM(true);\n        BB.append(this.transEl, [\n            this.boundsEl,\n            this.edges[0].el,\n            this.edges[1].el,\n            this.edges[2].el,\n            this.edges[3].el,\n            this.corners[0].el,\n            this.corners[1].el,\n            this.corners[2].el,\n            this.corners[3].el,\n            this.angleGrip.el,\n        ]);\n\n\n    }\n\n\n\n    getTransform (): ITransform {\n        return copyTransform(this.transform);\n    }\n\n    setConstrained (b: boolean): void {\n        this.isConstrained = !!b;\n        if (b && this.transform.width !== 0 && this.transform.height !== 0) {\n            this.ratio = Math.abs(this.transform.width / this.transform.height);\n        }\n    }\n\n    setSnapping (s: boolean): void {\n        this.snappingEnabled = !!s;\n    }\n\n    setPos (p: IVector2D): void {\n        this.transform.x = p.x;\n        this.transform.y = p.y;\n        this.updateDOM(true);\n    }\n\n    move (dX: number, dY: number): void {\n        this.transform.x += dX;\n        this.transform.y += dY;\n        this.updateDOM(false);\n    }\n\n    setSize (w: number, h: number): void {\n        this.transform.width = w;\n        this.transform.height = h;\n        if (Math.abs(this.transform.angleDeg) % 90 === 0) {\n            snapToPixel(this.transform);\n        }\n        this.updateCornerPositions();\n        this.updateDOM(false);\n    }\n\n    setAngleDeg (a: number): void {\n        this.transform.angleDeg = a;\n        if (Math.abs(this.transform.angleDeg) % 90 === 0) {\n            snapToPixel(this.transform);\n            this.updateCornerPositions();\n        }\n        this.updateDOM(true);\n    }\n\n    getElement (): HTMLElement {\n        return this.rootEl;\n    }\n\n    getRatio (): number {\n        return this.ratio;\n    }\n\n    destroy (): void {\n        this.keyListener.destroy();\n        this.boundsPointerListener.destroy();\n        this.corners[0].pointerListener.destroy();\n        this.corners[1].pointerListener.destroy();\n        this.corners[2].pointerListener.destroy();\n        this.corners[3].pointerListener.destroy();\n        this.edges[0].pointerListener.destroy();\n        this.edges[1].pointerListener.destroy();\n        this.edges[2].pointerListener.destroy();\n        this.edges[3].pointerListener.destroy();\n        this.anglePointerListener.destroy();\n    }\n\n}\n","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"8BBCz\");","import {BB} from '../../../bb/bb';\nimport {KlCanvasPreview} from '../../canvas-ui/canvas-preview';\nimport {FreeTransform} from './free-transform';\nimport {IKlBasicLayer, IMixMode} from '../../kl.types';\n\n/**\n * a basic canvas where you can transform one layer(move around, rotate, scale)\n *\n * @param params\n * @returns {HTMLDivElement}\n * @constructor\n */\nexport function FreeTransformCanvas(params: {\n    elementWidth: number;\n    elementHeight: number;\n    imageWidth: number;\n    imageHeight: number;\n    layers: IKlBasicLayer[];\n    transformIndex: number;\n}) {\n    /*\n    div\n        innerWrapper\n            klCanvasPreview\n            transform.div\n    */\n\n    let previewFit = BB.fitInto(\n        params.imageWidth,\n        params.imageHeight,\n        params.elementWidth - 20,\n        params.elementHeight - 60,\n        1\n    );\n    let scale = previewFit.width / params.imageWidth;\n\n    let div = BB.el({\n        css: {\n            width: params.elementWidth + \"px\",\n            height: params.elementHeight + \"px\",\n            backgroundColor: \"#9e9e9e\",\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n            overflow: \"hidden\",\n            userSelect: \"none\",\n            position: \"relative\",\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            colorScheme: 'only light',\n        }\n    });\n    div.oncontextmenu = function () {\n        return false;\n    };\n\n    let innerWrapper = BB.el({\n        css: {\n            position: 'relative',\n            boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n            width: previewFit.width + 'px',\n            height: previewFit.height + 'px'\n        }\n    });\n    div.appendChild(innerWrapper);\n\n    let previewLayerArr = params.layers.map(item => {\n        return {\n            image: item.image,\n            mixModeStr: item.mixModeStr,\n            opacity: item.opacity,\n        }\n    });\n    previewLayerArr[previewLayerArr.length - 1].image = BB.canvas(\n        scale > 1 ? params.imageWidth : previewFit.width,\n        scale > 1 ? params.imageHeight : previewFit.height,\n    );\n    let klCanvasPreview = new KlCanvasPreview({\n        width: previewFit.width,\n        height: previewFit.height,\n        layers: previewLayerArr\n    });\n    innerWrapper.appendChild(klCanvasPreview.getElement());\n\n    let freeTransform;\n    let initTransform;\n    function updatePreview() {\n        if (!freeTransform) {\n            return;\n        }\n\n        let transform = freeTransform.getTransform();\n        if (scale < 1) {\n            transform.x *= scale;\n            transform.y *= scale;\n            transform.width *= scale;\n            transform.height *= scale;\n        }\n\n        let destCanvas = previewLayerArr[params.transformIndex].image;\n        let ctx = (destCanvas as HTMLCanvasElement).getContext('2d');\n        ctx.save();\n        ctx.clearRect(0, 0, destCanvas.width, destCanvas.height);\n        BB.drawTransformedImageWithBounds(\n            ctx,\n            params.layers[params.transformIndex].image,\n            transform,\n            null,\n            BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\n        );\n        ctx.restore();\n        klCanvasPreview.render();\n    }\n\n    {\n        let transformSize = {\n            width: params.layers[params.transformIndex].image.width * scale,\n            height: params.layers[params.transformIndex].image.height * scale\n        };\n        if (transformSize.width > previewFit.width || transformSize.height > previewFit.height) {\n            transformSize = BB.fitInto(\n                params.layers[params.transformIndex].image.width,\n                params.layers[params.transformIndex].image.height,\n                previewFit.width,\n                previewFit.height,\n                1\n            );\n        }\n        initTransform = {\n            x: params.imageWidth / 2,\n            y: params.imageHeight / 2,\n            width: params.layers[params.transformIndex].image.width,\n            height: params.layers[params.transformIndex].image.height,\n        };\n        freeTransform = new FreeTransform({\n            x: initTransform.x,\n            y: initTransform.y,\n            width: initTransform.width,\n            height: initTransform.height,\n            angleDeg: 0,\n            isConstrained: true,\n            snapX: [0, params.imageWidth],\n            snapY: [0, params.imageHeight],\n            scale: scale,\n            callback: (transform) => {\n                updatePreview();\n            },\n        });\n    }\n    BB.css(freeTransform.getElement(), {\n        position: 'absolute',\n        left: '0',\n        top: '0'\n    });\n    innerWrapper.appendChild(freeTransform.getElement());\n    setTimeout(updatePreview, 0);\n\n\n    // --- interface ---\n\n    this.move = function(dX, dY) {\n        freeTransform.move(dX, dY);\n    };\n    this.reset = function() {\n        let w = params.layers[params.transformIndex].image.width;\n        let h = params.layers[params.transformIndex].image.height;\n\n        freeTransform.setSize(w, h);\n        freeTransform.setPos({x: w / 2, y: h / 2});\n        freeTransform.setAngleDeg(0);\n        updatePreview();\n    };\n    this.setTransformFit = function() {\n\n        let fit = BB.fitInto(\n            params.layers[params.transformIndex].image.width,\n            params.layers[params.transformIndex].image.height,\n            params.imageWidth,\n            params.imageHeight,\n            1\n        );\n\n        freeTransform.setSize(fit.width, fit.height);\n        freeTransform.setPos({x: fit.width / 2, y: fit.height / 2});\n        freeTransform.setAngleDeg(0);\n        updatePreview();\n    };\n    this.setTransformCenter = function() {\n        freeTransform.setPos({x: params.imageWidth / 2, y: params.imageHeight / 2});\n        freeTransform.setAngleDeg(0);\n        updatePreview();\n    };\n    //gives you the transformation in the original scale\n    this.getTransformation = function () {\n        if (!freeTransform) {\n            return false;\n        }\n        return freeTransform.getTransform();\n    };\n    this.getIsPixelated = () => {\n        const transform = freeTransform.getTransform();\n        return BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height);\n    };\n    this.getElement = function() {\n        return div;\n    };\n    this.destroy = function() {\n        freeTransform.destroy();\n    };\n}","import {BB} from '../../../bb/bb';\n\n/*\n\tCropper params\n\t{\n\t\tx: int, //pos in relation zum bild\n\t\ty: int,\n\t\tw: int,\n\t\th: int,\n\t\tscale: float, //zoom\n\t\tcallback: function //wenn sich was ändert\n\t}\n\tthe div that you append this to must be relative\n*/\nexport function Cropper (params) {\n    let x = params.x,\n        y = params.y,\n        width = params.width,\n        height = params.height,\n        scale = params.scale,\n        callback = params.callback,\n        maxW = params.maxW,\n        maxH = params.maxH;\n    let div = document.createElement(\"div\");\n    let gripCursors = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];\n\n    let keyListener = new BB.KeyListener({});\n\n    BB.css(div, {\n        position: \"absolute\",\n        left: (x * scale) + \"px\",\n        top: (y * scale) + \"px\"\n    });\n\n    let outline = document.createElement(\"div\");\n    BB.css(outline, {\n        position: \"absolute\",\n        border: \"1px dashed #fff\",\n        cursor: \"move\"\n    });\n    (outline as any).update = function () {\n        BB.css(outline, {\n            left: (grips[0].x * scale - 1) + \"px\",\n            top: (grips[0].y * scale - 1) + \"px\",\n            width: ((grips[2].x - grips[0].x) * scale) + \"px\",\n            height: ((grips[2].y - grips[0].y) * scale) + \"px\"\n        });\n    };\n    let pointerRemainder = { // needs to be reset after dragging complete\n        x: 0,\n        y: 0,\n    };\n    let outlinePointerListener = new BB.PointerListener({\n        target: outline,\n        onPointer: function(event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n\n                grips[0].x += dX;\n                grips[0].y += dY;\n                grips[1].x += dX;\n                grips[1].y += dY;\n                grips[2].x += dX;\n                grips[2].y += dY;\n                grips[3].x += dX;\n                grips[3].y += dY;\n\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n\n    let thirdsHorizontal = document.createElement(\"div\");\n    BB.css(thirdsHorizontal, {\n        position: \"absolute\",\n        borderTop: \"1px solid #0ff\",\n        borderBottom: \"1px solid #0ff\"\n    });\n    (thirdsHorizontal as any).update = function () {\n        BB.css(thirdsHorizontal, {\n            left: (grips[0].x * scale) + \"px\",\n            top: ((grips[0].y + (grips[2].y - grips[0].y) / 3) * scale) + \"px\",\n            width: ((grips[2].x - grips[0].x) * scale) + \"px\",\n            height: ((grips[2].y - grips[0].y) / 3 * scale) + \"px\"\n\n        });\n    };\n    let thirdsVertical = document.createElement(\"div\");\n    BB.css(thirdsVertical, {\n        position: \"absolute\",\n        borderLeft: \"1px solid #0ff\",\n        borderRight: \"1px solid #0ff\"\n    });\n    (thirdsVertical as any).update = function () {\n        BB.css(thirdsVertical, {\n            left: ((grips[0].x + (grips[2].x - grips[0].x) / 3) * scale) + \"px\",\n            top: (grips[0].y * scale) + \"px\",\n            width: ((grips[2].x - grips[0].x) / 3 * scale) + \"px\",\n            height: ((grips[2].y - grips[0].y) * scale) + \"px\"\n\n        });\n    };\n\n    const gripSize = 40;\n    const gripOverlay = 10;\n\n    let grips: {\n        x: number; // int\n        y: number;\n    }[] = [ // aka corner coordinates\n        {x: 0, y: 0}, // top left\n        {x: width, y: 0}, // top right\n        {x: width, y: height}, // bottom right\n        {x: 0, y: height}, //bottom left\n    ];\n\n    function transformTop(dY) {\n        grips[0].y += dY;\n        grips[0].y = Math.max(grips[3].y - maxH, Math.min(grips[3].y - 1, grips[0].y));\n        grips[1].y = grips[0].y;\n    }\n    function transformRight(dX) {\n        grips[1].x += dX;\n        grips[1].x = Math.min(grips[0].x + maxW, Math.max(grips[0].x + 1, grips[1].x));\n        grips[2].x = grips[1].x;\n    }\n    function transformBottom(dY) {\n        grips[2].y += dY;\n        grips[2].y = Math.min(grips[1].y + maxH, Math.max(grips[1].y + 1, grips[2].y));\n        grips[3].y = grips[2].y;\n    }\n    function transformLeft(dX) {\n        grips[0].x += dX;\n        grips[0].x = Math.max(grips[1].x - maxW, Math.min(grips[1].x - 1, grips[0].x));\n        grips[3].x = grips[0].x;\n    }\n\n    function commit() {\n        pointerRemainder.x = 0;\n        pointerRemainder.y = 0;\n        callback(getTransform());\n    }\n\n\n\n\n    let edges = [];\n    for (let i = 0; i < 4; i++) {\n        (function (i) {\n            edges[i] = document.createElement(\"div\");\n            let g = edges[i];\n            g.style.width = gripSize + \"px\";\n            g.style.height = gripSize + \"px\";\n            //g.style.background = \"#0f0\";\n            g.style.position = \"absolute\";\n            g.update = function () {\n                if (i === 0) { //top\n                    g.style.left = (grips[0].x * scale + gripOverlay) + \"px\";\n                    g.style.top = (grips[0].y * scale - gripSize * 2 + gripOverlay) + \"px\";\n                    g.style.width = ((grips[1].x - grips[0].x) * scale - gripOverlay * 2) + \"px\";\n                    g.style.height = (gripSize * 2) + \"px\";\n                } else if (i === 1) { //right\n                    g.style.left = (grips[1].x * scale - gripOverlay) + \"px\";\n                    g.style.top = (grips[1].y * scale + gripOverlay) + \"px\";\n                    g.style.width = (gripSize * 2) + \"px\";\n                    g.style.height = ((grips[2].y - grips[1].y) * scale - gripOverlay * 2) + \"px\";\n                } else if (i === 2) { //bottom\n                    g.style.left = (grips[3].x * scale + gripOverlay) + \"px\";\n                    g.style.top = (grips[3].y * scale - gripOverlay) + \"px\";\n                    g.style.width = ((grips[2].x - grips[3].x) * scale - gripOverlay * 2) + \"px\";\n                    g.style.height = (gripSize * 2) + \"px\";\n                } else if (i === 3) { //left\n                    g.style.left = (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\";\n                    g.style.top = (grips[0].y * scale + gripOverlay) + \"px\";\n                    g.style.width = (gripSize * 2) + \"px\";\n                    g.style.height = ((grips[3].y - grips[0].y) * scale - gripOverlay * 2) + \"px\";\n                }\n                let angleOffset = i * 2 + 1;\n                g.style.cursor = gripCursors[angleOffset] + \"-resize\";\n\n            };\n        })(i);\n    }\n\n    let darken = [];\n    for (let i = 0; i < 4; i++) {\n        (function (i) {\n            darken[i] = document.createElement(\"div\");\n            let g = darken[i];\n            g.style.position = \"absolute\";\n            g.style.background = \"#000\";\n            g.style.opacity = \"0.5\";\n            g.update = function () {\n                if (i === 0) {\n                    g.style.left = (grips[0].x * scale) + \"px\";\n                    g.style.top = (grips[0].y * scale - 8000) + \"px\";\n                    g.style.width = ((grips[1].x - grips[0].x) * scale) + \"px\";\n                    g.style.height = \"8000px\";\n                } else if (i === 1) {\n                    g.style.left = (grips[1].x * scale) + \"px\";\n                    g.style.top = (grips[1].y * scale - 8000) + \"px\";\n                    g.style.width = \"8000px\";\n                    g.style.height = 16000 + \"px\";\n                } else if (i === 2) {\n                    g.style.left = (grips[3].x * scale) + \"px\";\n                    g.style.top = (grips[3].y * scale) + \"px\";\n                    g.style.width = ((grips[2].x - grips[3].x) * scale) + \"px\";\n                    g.style.height = \"8000px\";\n                } else if (i === 3) {\n                    g.style.left = (grips[0].x * scale - 8000) + \"px\";\n                    g.style.top = (grips[0].y * scale - 8000) + \"px\";\n                    g.style.width = \"8000px\";\n                    g.style.height = 16000 + \"px\";\n                }\n\n            };\n        })(i);\n    }\n\n    let edge0PointerListener = new BB.PointerListener({\n        target: edges[0],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformTop(dY);\n                if (keyListener.isPressed('shift')) {\n                    transformBottom(-dY);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n    let edge1PointerListener = new BB.PointerListener({\n        target: edges[1],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformRight(dX);\n                if (keyListener.isPressed('shift')) {\n                    transformLeft(-dX);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n    let edge2PointerListener = new BB.PointerListener({\n        target: edges[2],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformBottom(dY);\n                if (keyListener.isPressed('shift')) {\n                    transformTop(-dY);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n    let edge3PointerListener = new BB.PointerListener({\n        target: edges[3],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformLeft(dX);\n                if (keyListener.isPressed('shift')) {\n                    transformRight(-dX);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n\n\n    let cornerElArr = [];\n    (function() {\n        for (let i = 0; i < 4; i++) {\n            (function (i) {\n                cornerElArr[i] = document.createElement(\"div\");\n                let g = cornerElArr[i];\n                BB.css(g, {\n                    //background: '#f00',\n                    width: (gripSize * 2) + 'px',\n                    height: (gripSize * 2) + 'px',\n                    position: 'absolute'\n                });\n                g.style.cursor = ['nwse-resize', 'nesw-resize'][i % 2];\n                g.update = function () {\n                    if (i === 0) { //top left\n                        BB.css(g, {\n                            left: (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\",\n                            top: (grips[0].y * scale - gripSize * 2 + gripOverlay) + \"px\"\n                        });\n                    } else if (i === 1) { //top right\n                        BB.css(g, {\n                            left: (grips[1].x * scale - gripOverlay) + \"px\",\n                            top: (grips[1].y * scale - gripSize * 2 + gripOverlay) + \"px\"\n                        });\n                    } else if (i === 2) { //bottom right\n                        BB.css(g, {\n                            left: (grips[1].x * scale - gripOverlay) + \"px\",\n                            top: (grips[2].y * scale - gripOverlay) + \"px\"\n                        });\n                    } else if (i === 3) { //bottom left\n                        BB.css(g, {\n                            left: (grips[0].x * scale - gripSize * 2 + gripOverlay) + \"px\",\n                            top: (grips[2].y * scale - gripOverlay) + \"px\"\n                        });\n                    }\n                };\n            })(i);\n        }\n    })();\n    //top left\n    let corner0PointerListener = new BB.PointerListener({\n        target: cornerElArr[0],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformLeft(dX);\n                transformTop(dY);\n                if (keyListener.isPressed('shift')) {\n                    transformRight(-dX);\n                    transformBottom(-dY);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n    //top right\n    let corner1PointerListener = new BB.PointerListener({\n        target: cornerElArr[1],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformRight(dX);\n                transformTop(dY);\n                if (keyListener.isPressed('shift')) {\n                    transformLeft(-dX);\n                    transformBottom(-dY);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n    //bottom right\n    let corner2PointerListener = new BB.PointerListener({\n        target: cornerElArr[2],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformRight(dX);\n                transformBottom(dY);\n                if (keyListener.isPressed('shift')) {\n                    transformLeft(-dX);\n                    transformTop(-dY);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n    //bottom left\n    let corner3PointerListener = new BB.PointerListener({\n        target: cornerElArr[3],\n        fixScribble: true,\n        onPointer: function (event) {\n            event.eventPreventDefault();\n            if (event.type === 'pointermove' && event.button === 'left') {\n                const {dX, dY} = BB.intDxy(pointerRemainder, event.dX / scale, event.dY / scale);\n                transformLeft(dX);\n                transformBottom(dY);\n                if (keyListener.isPressed('shift')) {\n                    transformRight(-dX);\n                    transformTop(-dY);\n                }\n                update();\n            }\n            if (event.type === 'pointerup') {\n                commit();\n            }\n        }\n    });\n\n\n\n\n    function getTransform() {\n        grips[1].x -= grips[0].x;\n        grips[1].y -= grips[0].y;\n        grips[2].x -= grips[0].x;\n        grips[2].y -= grips[0].y;\n        grips[3].x -= grips[0].x;\n        grips[3].y -= grips[0].y;\n        x += grips[0].x;\n        y += grips[0].y;\n        grips[0].x = 0;\n        grips[0].y = 0;\n        return {\n            x: x,\n            y: y,\n            width: grips[1].x,\n            height: grips[2].y\n        };\n    }\n\n\n    div.append(\n        darken[1],\n        darken[0],\n        darken[2],\n        darken[3],\n        thirdsHorizontal,\n        thirdsVertical,\n        outline,\n\n        edges[1],\n        edges[0],\n        edges[2],\n        edges[3],\n\n        cornerElArr[0],\n        cornerElArr[1],\n        cornerElArr[2],\n        cornerElArr[3],\n    );\n\n\n    function update() {\n\n        edges[0].update();\n        edges[1].update();\n        edges[2].update();\n        edges[3].update();\n        cornerElArr[0].update();\n        cornerElArr[1].update();\n        cornerElArr[2].update();\n        cornerElArr[3].update();\n        darken[0].update();\n        darken[1].update();\n        darken[2].update();\n        darken[3].update();\n        (outline as any).update();\n        (thirdsHorizontal as any).update();\n        (thirdsVertical as any).update();\n    }\n\n    update();\n\n\n    // --- interface ---\n\n    this.getTransform = getTransform;\n\n    this.setTransform = function (p) {\n        x = p.x;\n        y = p.y;\n        width = p.width;\n        height = p.height;\n\n        BB.css(div, {\n            left: (x * scale) + \"px\",\n            top: (y * scale) + \"px\"\n        });\n\n        grips[0].x = 0;\n        grips[0].y = 0;\n        grips[1].x = width;\n        grips[1].y = 0;\n        grips[2].x = width;\n        grips[2].y = height;\n        grips[3].x = 0;\n        grips[3].y = height;\n\n        update();\n        commit();\n    };\n\n    this.setScale = function (s) {\n        scale = s;\n        BB.css(div, {\n            left: (x * scale) + \"px\",\n            top: (y * scale) + \"px\"\n        });\n        update();\n    };\n\n    this.showThirds = function (b) {\n        if (b) {\n            thirdsHorizontal.style.display = \"block\";\n            thirdsVertical.style.display = \"block\";\n        } else {\n            thirdsHorizontal.style.display = \"none\";\n            thirdsVertical.style.display = \"none\";\n        }\n    };\n\n    this.getElement = function() {\n        return div;\n    };\n\n    this.destroy = function() {\n        keyListener.destroy();\n        outlinePointerListener.destroy();\n        corner0PointerListener.destroy();\n        corner1PointerListener.destroy();\n        corner2PointerListener.destroy();\n        corner3PointerListener.destroy();\n        edge0PointerListener.destroy();\n        edge1PointerListener.destroy();\n        edge2PointerListener.destroy();\n        edge3PointerListener.destroy();\n    };\n\n}","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"g2W7q\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"7SFt9\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"2Vvkk\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"1zJpX\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"9cKp0\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"3iiTs\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"gGmfI\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"67aEJ\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"a2j2Q\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"gZhDT\");","import {BB} from '../../../bb/bb';\nimport {dialogCounter} from '../modals/modal-count';\n// @ts-ignore\nimport toolPaintImg from 'url:~/src/app/img/ui/tool-paint.svg';\n// @ts-ignore\nimport toolFillImg from 'url:~/src/app/img/ui/tool-fill.svg';\n// @ts-ignore\nimport toolTextImg from 'url:~/src/app/img/ui/tool-text.svg';\n// @ts-ignore\nimport toolShapeImg from 'url:~/src/app/img/ui/tool-shape.svg';\n// @ts-ignore\nimport caretDownImg from 'url:~/src/app/img/ui/caret-down.svg';\nimport {LANG} from '../../../language/language';\n\n/**\n * Toolrow Dropdown. The button where you select: brush, fill, select, transform, etc.\n *\n * p = {\n *     onChange: func(activeStr)\n * }\n *\n * activeStr = 'draw' | 'fill' | 'text'\n *\n * @param p\n * @constructor\n */\nexport function ToolDropdown(p) {\n\n    let optionArr = ['draw', 'fill', 'text', 'shape'];\n    let imArr = [\n        toolPaintImg,\n        toolFillImg,\n        toolTextImg,\n        toolShapeImg\n    ];\n    let titleArr = [\n        `${LANG('tool-brush')} [B]`,\n        `${LANG('tool-paint-bucket')} [G]`,\n        `${LANG('tool-text')} [T]`,\n        `${LANG('tool-shape')} [U]`,\n    ];\n    let currentActiveIndex = 0;\n    let isActive = true;\n    let isOpen = false;\n\n    //preload images\n    setTimeout(function() {\n        for (let i = 1; i < imArr.length; i++) {\n            let im = new Image();\n            im.src = imArr[i];\n        }\n    }, 100);\n\n    let smallMargin = '6px 0';\n    let div = BB.el({\n        css: {\n            position: 'relative',\n            flexGrow: '1'\n        }\n    });\n\n    let openTimeout;\n    let isDragging = false;\n    let startX, startY;\n    let pointerListener;\n    if (BB.hasPointerEvents) {\n        pointerListener = new BB.PointerListener({\n            target: div,\n            maxPointers: 1,\n            onPointer: function(event) {\n                if (event.type === 'pointerdown') {\n                    if (isOpen) {\n                        return;\n                    }\n\n                    openTimeout = setTimeout(function() {\n                        showDropdown();\n                    }, 400);\n                    isDragging = true;\n                    startX = event.pageX;\n                    startY = event.pageY;\n\n                } else if (event.type === 'pointermove') {\n                    if (isDragging && !isOpen && BB.dist(startX, startY, event.pageX, event.pageY) > 5) {\n                        clearTimeout(openTimeout);\n                        showDropdown();\n                    }\n\n                } else if (event.type === 'pointerup') {\n                    clearTimeout(openTimeout);\n                    if (isOpen && isDragging) {\n                        let target = document.elementFromPoint(event.pageX, event.pageY);\n                        for (let i = 0; i < dropdownBtnArr.length; i++) {\n                            if (target === dropdownBtnArr[i].wrapper) {\n                                closeDropdown();\n                                isActive = true;\n                                currentActiveIndex = i;\n                                updateButton();\n                                p.onChange(optionArr[currentActiveIndex]);\n                                break;\n                            }\n                        }\n                    }\n                    isDragging = false;\n                }\n            }\n        });\n    }\n\n    let activeButton = BB.el({\n        parent: div,\n        className: 'toolspace-row-button nohighlight toolspace-row-button-activated',\n        title: titleArr[currentActiveIndex],\n        onClick: function(e) {\n            if (isActive && !isOpen) {\n                e.preventDefault();\n                e.stopPropagation();\n                showDropdown();\n                return;\n            }\n\n            isActive = true;\n            p.onChange(optionArr[currentActiveIndex]);\n            if (isOpen) {\n                closeDropdown();\n            }\n        },\n        css: {\n            padding: '10px 0',\n            pointerEvents: 'auto',\n            height: '100%',\n            boxSizing: 'border-box'\n        }\n    });\n\n    let activeButtonIm = BB.el({\n        parent: activeButton,\n        css: {\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: 'center',\n            backgroundSize: 'contain',\n            width: 'calc(100% - 7px)',\n            height: '100%',\n            pointerEvents: 'none',\n            opacity: '0.75',\n        }\n    });\n\n    let arrowButton = BB.el({\n        parent: activeButton,\n        css: {\n            position: 'absolute',\n            right: '1px',\n            bottom: '1px',\n            width: '18px',\n            height: '18px',\n            //background: '#aaa',\n            //borderRadius: '2px',\n            cursor: 'pointer',\n\n            backgroundImage: 'url(\\'' + caretDownImg + '\\')',\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: 'center',\n            backgroundSize: '60%'\n        },\n        title: 'More Tools',\n        onClick: function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            showDropdown();\n        }\n    });\n\n\n    let overlay = BB.el({\n        css: {\n            position: 'absolute',\n            //background: 'rgba(255,0,0,0.5)',\n            left: '0',\n            top: '0',\n            right: '0',\n            bottom: '0'\n        }\n    });\n    let overlayPointerListener = new BB.PointerListener({\n        target: overlay,\n        pointers: 1,\n        onPointer: function(e) {\n            if (e.type === 'pointerdown') {\n                e.eventPreventDefault();\n                closeDropdown();\n            }\n        }\n    });\n\n    let dropdownWrapper = BB.el({\n        className: 'tool-dropdown-wrapper',\n        css: {\n            position: 'absolute',\n            width: '100%',\n            height: (100 * (optionArr.length - 1)) + '%',\n            top: '100%',\n            left: '0',\n            zIndex: '1',\n            boxSizing: 'border-box',\n            cursor: 'pointer',\n            transition: 'height 0.1s ease-in-out, opacity 0.1s ease-in-out',\n            borderBottomLeftRadius: '5px',\n            borderBottomRightRadius: '5px',\n            overflow: 'hidden',\n        }\n    });\n\n    let dropdownBtnArr = [];\n\n    function createDropdownButton(p) {\n        let result = {};\n\n        let wrapper = BB.el({\n            parent: dropdownWrapper,\n            className: 'tool-dropdown-button',\n            title: p.title,\n            css: {\n                padding: '10px 0',\n                height: (100 / (optionArr.length - 1)) + '%',\n                boxSizing: 'border-box'\n            },\n            onClick: function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n                p.onClick(p.index, p.id);\n            }\n        });\n        (result as any).wrapper = wrapper;\n        let im = BB.el({\n            parent: wrapper,\n            css: {\n                backgroundImage: 'url(\\'' + p.image + '\\')',\n                backgroundRepeat: 'no-repeat',\n                backgroundPosition: 'center',\n                backgroundSize: 'contain',\n                height: '100%',\n                pointerEvents: 'none',\n                opacity: '0.75'\n            }\n        });\n\n        // --- interface ---\n        (result as any).show = function(b) {\n            wrapper.style.display = b ? 'block' : 'none';\n        };\n\n        (result as any).setIsSmall = function(b) {\n            wrapper.style.padding = b ? smallMargin : '10px 0';\n        };\n\n        return result;\n    }\n\n    function onClickDropdownBtn(index, id) {\n        closeDropdown();\n\n        isActive = true;\n        currentActiveIndex = index;\n\n        updateButton();\n\n        p.onChange(optionArr[currentActiveIndex]);\n    }\n\n    for (let i = 0; i < optionArr.length; i++) {\n        dropdownBtnArr.push(createDropdownButton({\n            index: i,\n            id: optionArr[i],\n            image: imArr[i],\n            title: titleArr[i],\n            onClick: onClickDropdownBtn\n        }));\n    }\n\n    function showDropdown() {\n        dialogCounter.increase(0.5);\n        isOpen = true;\n\n        for (let i = 0; i < optionArr.length; i++) {\n            dropdownBtnArr[i].show(currentActiveIndex !== i);\n        }\n\n        arrowButton.style.display = 'none';\n        div.style.zIndex = '1';\n        document.body.appendChild(overlay);\n        div.appendChild(dropdownWrapper);\n    }\n\n    function closeDropdown() {\n        dialogCounter.decrease(0.5);\n        isOpen = false;\n        arrowButton.style.removeProperty('display');\n        div.style.removeProperty('z-index');\n        document.body.removeChild(overlay);\n\n        div.removeChild(dropdownWrapper);\n    }\n\n    function updateButton() {\n        activeButton.title = titleArr[currentActiveIndex];\n        activeButtonIm.style.backgroundImage = 'url(\\'' + imArr[currentActiveIndex] + '\\')';\n    }\n    updateButton();\n\n\n    // --- interface ---\n\n    this.setIsSmall = function(b) {\n        activeButton.style.padding = b ? smallMargin : '10px 0';\n        for (let i = 0; i < optionArr.length; i++) {\n            dropdownBtnArr[i].setIsSmall(b);\n        }\n        if (b) {\n            arrowButton.style.width = '14px';\n            arrowButton.style.height = '14px';\n        } else {\n            arrowButton.style.width = '18px';\n            arrowButton.style.height = '18px';\n        }\n    };\n\n    this.setActive = function(activeStr) {\n        if (optionArr.includes(activeStr)) {\n            isActive = true;\n            for (let i = 0; i < optionArr.length; i++) {\n                if (optionArr[i] === activeStr) {\n                    currentActiveIndex = i;\n                    break;\n                }\n            }\n            BB.addClassName(activeButton, 'toolspace-row-button-activated');\n            updateButton();\n        } else {\n            isActive = false;\n            BB.removeClassName(activeButton, 'toolspace-row-button-activated');\n        }\n    };\n\n    this.getActive = function() {\n        return optionArr[currentActiveIndex];\n    };\n\n    this.getElement = function() {\n        return div;\n    };\n}","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"48B5J\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"ksMx1\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"bReTA\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"i3X7V\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"j4HZO\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"jItzQ\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"ea7ga\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"gNPQL\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"9Mrdl\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"jc4S8\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"cgtA2\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"erfrN\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"kdJe6\");","import {createCanvas} from '../../bb/base/create-canvas';\nimport {Psd} from 'ag-psd/dist/psd';\nimport {IKlProject, IKlPsd, IMixMode} from '../kl.types';\nimport {LANG} from '../../language/language';\nimport {MAX_LAYERS} from '../canvas/kl-canvas';\n\nlet kl2PsdMap;\nlet psd2KlMap;\n\nfunction init() {\n    if (kl2PsdMap) {\n        return;\n    }\n\n    kl2PsdMap = {\n        'source-over': 'normal',\n\n        'darken': 'darken',\n        'multiply': 'multiply',\n        'color-burn': 'color burn',\n\n        'lighten': 'lighten',\n        'screen': 'screen',\n        'color-dodge': 'color dodge',\n\n        'overlay': 'overlay',\n        'soft-light': 'soft light',\n        'hard-light': 'hard light',\n\n        'difference': 'difference',\n        'exclusion': 'exclusion',\n\n        'hue': 'hue',\n        'saturation': 'saturation',\n        'color': 'color',\n        'luminosity': 'luminosity',\n    };\n\n    psd2KlMap = {};\n    let keys = Object.keys(kl2PsdMap);\n    for (let i = 0; i < keys.length; i++) {\n        psd2KlMap[kl2PsdMap[keys[i]]] = keys[i];\n    }\n}\n\nexport function blendPsdToKl(str: string): IMixMode {\n    init();\n    return psd2KlMap[str];\n}\n\nexport function blendKlToPsd(str: string): string {\n    init();\n    return kl2PsdMap[str];\n}\n\n\n/**\n * Converts ag-psd object into something that KlCanvas can represent\n * @param psdObj\n */\nexport function readPsd(psdObj: Psd): IKlPsd {\n    let result: IKlPsd = {\n        type: 'psd',\n        canvas: psdObj.canvas,\n        width: psdObj.width,\n        height: psdObj.height\n    };\n\n    function addWarning(warningStr) {\n        if (!result.warningArr) {\n            result.warningArr = [];\n        }\n        if (result.warningArr.includes(warningStr)) {\n            return;\n        }\n        result.warningArr.push(warningStr);\n    }\n\n    function getMixModeStr(blendMode): IMixMode {\n        let mixModeStr: IMixMode = blendPsdToKl(blendMode);\n        if (!mixModeStr) {\n            addWarning('blend-mode');\n            mixModeStr = 'source-over';\n        }\n        return mixModeStr;\n    }\n\n    if (psdObj.bitsPerChannel !== 8) {\n        addWarning('bits-per-channel');\n    }\n\n    if (!psdObj.children) {\n        result.error = true;\n        return result;\n    }\n\n    // count resulting layers\n    let maxLayers = MAX_LAYERS;\n    let layerCount = 0;\n    function countWithinGroup(groupObj) {\n        let result = 0;\n        if (groupObj.blendMode) {\n            let mixModeStr = blendPsdToKl(groupObj.blendMode);\n            if (mixModeStr && mixModeStr !== 'source-over') {\n                return 1;\n            }\n        }\n        for (let i = 0; i < groupObj.children.length; i++) {\n            let item = groupObj.children[i];\n            if (item.clipping || item.adjustment) {\n                continue;\n            }\n\n            if (item.children) {\n                addWarning('group');\n                result += countWithinGroup(item);\n            } else {\n                result++;\n            }\n        }\n        return result;\n    }\n    layerCount += countWithinGroup(psdObj);\n    if (layerCount > maxLayers) {\n        result.error = true;\n        return result;\n    }\n\n    result.layers = [];\n\n    function prepareMask(maskCanvas, defaultColor) {\n        const groupMaskCtx = maskCanvas.getContext('2d');\n        let imData = groupMaskCtx.getImageData(0, 0, maskCanvas.width, maskCanvas.height);\n        if (defaultColor === 0) {\n            for (let i = 0; i < imData.data.length; i += 4) {\n                imData.data[i + 3] = imData.data[i];\n            }\n        } else {\n            for (let i = 0; i < imData.data.length; i += 4) {\n                imData.data[i + 3] = 255 - imData.data[i];\n            }\n        }\n        groupMaskCtx.putImageData(imData, 0, 0);\n    }\n\n    function convertGroup(psdGroupObj): {\n        name: string;\n        mixModeStr: IMixMode;\n        opacity: number;\n        image: HTMLCanvasElement;\n    }[] {\n\n        let resultArr: {\n            name: string;\n            mixModeStr: IMixMode;\n            opacity: number;\n            image: HTMLCanvasElement;\n        }[] = [];\n        let groupOpacity = psdGroupObj.hidden ? 0 : psdGroupObj.opacity;\n        let groupMixModeStr = getMixModeStr(psdGroupObj.blendMode);\n        let groupCanvas;\n        let groupCtx;\n        if (groupMixModeStr !== 'source-over') {\n            groupCanvas = createCanvas(result.width, result.height);\n            groupCtx = groupCanvas.getContext('2d');\n        }\n\n\n        // prepare group mask\n        if (psdGroupObj.mask) {\n            addWarning('mask');\n            prepareMask(psdGroupObj.mask.canvas, psdGroupObj.mask.defaultColor);\n        }\n\n\n        for (let i = 0; i < psdGroupObj.children.length; i++) {\n            let item = psdGroupObj.children[i];\n            if (item.clipping) {\n                continue;\n            }\n            if (item.adjustment) {\n                addWarning('adjustment');\n                continue;\n            }\n\n            let hasClipping = (item.children || item.canvas) && psdGroupObj.children[i + 1] && psdGroupObj.children[i + 1].clipping;\n            if (hasClipping) {\n                addWarning('clipping');\n            }\n\n            if (item.children) {\n                let innerArr = convertGroup(item);\n\n                for (let e = 0; e < innerArr.length; e++) {\n                    let innerItem = innerArr[e];\n                    let innerCtx = innerItem.image.getContext('2d');\n\n                    // clipping\n                    if (hasClipping) {\n                        let clippingCanvas = createCanvas(result.width, result.height);\n                        let clippingCtx = clippingCanvas.getContext('2d');\n                        clippingCtx.drawImage(innerItem.image, 0, 0);\n\n                        for (let f = i + 1; f < psdGroupObj.children.length && psdGroupObj.children[f].clipping; f++) {\n                            let clippingItem = psdGroupObj.children[f];\n                            if (clippingItem.opacity === 0 || clippingItem.hidden) {\n                                continue;\n                            }\n                            clippingCtx.globalCompositeOperation = getMixModeStr(clippingItem.blendMode);\n                            clippingCtx.globalAlpha = clippingItem.opacity;\n                            clippingCtx.drawImage(clippingItem.canvas, clippingItem.left, clippingItem.top);\n                        }\n\n                        innerCtx.globalCompositeOperation = 'source-atop';\n                        innerCtx.drawImage(clippingCanvas, 0, 0);\n                    }\n\n\n\n                    // group mask\n                    if (psdGroupObj.mask) {\n                        innerCtx.globalCompositeOperation = psdGroupObj.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\n                        innerCtx.drawImage(psdGroupObj.mask.canvas, psdGroupObj.mask.left, psdGroupObj.mask.top);\n                    }\n\n                    if (groupCanvas) {\n                        groupCtx.globalCompositeOperation = innerItem.mixModeStr;\n                        groupCtx.globalAlpha = innerItem.opacity;\n                        groupCtx.drawImage(innerItem.image, 0, 0);\n\n                    } else {\n                        innerItem.opacity = innerItem.opacity * groupOpacity;\n                        resultArr.push(innerItem);\n                    }\n                }\n\n                continue;\n            }\n\n            let canvas = createCanvas(result.width, result.height);\n            let ctx = canvas.getContext('2d');\n            if (item.canvas) { // if a layer is empty it has no canvas\n                ctx.drawImage(item.canvas, item.left, item.top);\n            }\n\n            // effects\n            if (item.effects) {\n                addWarning('layer-effect');\n            }\n\n            // mask\n            if (item.mask) {\n                addWarning('mask');\n                prepareMask(item.mask.canvas, item.mask.defaultColor);\n\n                ctx.globalCompositeOperation = item.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\n                ctx.drawImage(item.mask.canvas, item.mask.left, item.mask.top);\n            }\n\n            // clipping\n            if (hasClipping) {\n                let clippingCanvas = createCanvas(item.right - item.left, item.bottom - item.top);\n                let clippingCtx = clippingCanvas.getContext('2d');\n                clippingCtx.drawImage(item.canvas, 0, 0);\n\n                for (let e = i + 1; e < psdGroupObj.children.length && psdGroupObj.children[e].clipping; e++) {\n                    let clippingItem = psdGroupObj.children[e];\n                    if (clippingItem.opacity === 0 || clippingItem.hidden) {\n                        continue;\n                    }\n                    clippingCtx.globalCompositeOperation = getMixModeStr(clippingItem.blendMode);\n                    clippingCtx.globalAlpha = clippingItem.opacity;\n                    clippingCtx.drawImage(clippingItem.canvas, clippingItem.left - item.left, clippingItem.top - item.top);\n                }\n\n                ctx.globalCompositeOperation = 'source-atop';\n                ctx.drawImage(clippingCanvas, item.left, item.top);\n            }\n\n            // group mask\n            if (psdGroupObj.mask) {\n                ctx.globalCompositeOperation = psdGroupObj.mask.defaultColor === 0 ? 'destination-in' : 'destination-out';\n                ctx.drawImage(psdGroupObj.mask.canvas, psdGroupObj.mask.left, psdGroupObj.mask.top);\n            }\n\n            if (groupCanvas) {\n                if (groupOpacity > 0) {\n                    groupCtx.globalCompositeOperation = getMixModeStr(item.blendMode);\n                    groupCtx.globalAlpha = item.hidden ? 0 : item.opacity;\n                    groupCtx.drawImage(canvas, 0, 0);\n                }\n\n            } else {\n                resultArr.push({\n                    name: item.name,\n                    opacity: (item.hidden ? 0 : item.opacity) * groupOpacity,\n                    mixModeStr: getMixModeStr(item.blendMode),\n                    image: canvas,\n                });\n            }\n        }\n\n        if (groupCanvas) {\n            resultArr = [\n                {\n                    name: psdGroupObj.name,\n                    opacity: groupOpacity,\n                    mixModeStr: groupMixModeStr,\n                    image: groupCanvas,\n                }\n            ];\n        }\n\n        return resultArr;\n    }\n\n    result.layers = convertGroup({\n        name: 'root',\n        opacity: 1,\n        blendMode: 'normal',\n        children: psdObj.children\n    });\n\n    return result;\n}\n\nexport function klPsdToKlProject(klPsd: IKlPsd): IKlProject {\n    // only share references to Canvas elements\n    const result: IKlProject = {\n        width: klPsd.width,\n        height: klPsd.height,\n        layers: [],\n    };\n    if (klPsd.layers) {\n        result.layers = result.layers.concat(klPsd.layers.map(item => {\n            return {\n                name: item.name,\n                opacity: item.opacity,\n                mixModeStr: item.mixModeStr,\n                image: item.image,\n            };\n        }));\n    } else {\n        // flattened\n        result.layers.push({\n            name: LANG('background'),\n            opacity: 1,\n            mixModeStr: 'source-over',\n            image: klPsd.canvas,\n        });\n    }\n    return result;\n}","//browser storage indexedDB\n\n\nimport {IKlStorageProject} from '../kl.types';\n\nconst indexedDbIsSupported = !!window.indexedDB;\nlet dbNameStr = 'Klecks';\nconst storageNameStr = 'ProjectStore';\n\nexport function setDbName(name: string) {\n    dbNameStr = '' + name;\n}\n\n/**\n * connects to db dbNameStr, then executes transaction on storageNameStr storage\n * with index 'id'\n *\n * @param actionFunction function(storeObj) - what you want to execute during transaction\n * @param successCallback function() - on succesful transaction\n * @param errorCallback function(errorStr) - on error\n */\nfunction execIndexedDBTransaction(actionFunction, successCallback, errorCallback) {\n\n    let hasFinished = false;\n\n    function onSuccess() {\n        if (hasFinished) {\n            return;\n        }\n        hasFinished = true;\n        successCallback();\n    }\n\n    function onError(errorStr) {\n        if (hasFinished) {\n            return;\n        }\n        hasFinished = true;\n        errorCallback(errorStr);\n    }\n\n    if (!indexedDbIsSupported) {\n        setTimeout(function () {\n            onError('no indexed db available');\n        }, 0);\n        return;\n    }\n    let requestObj;\n\n    try {\n        requestObj = window.indexedDB.open(dbNameStr, 1);\n    } catch (e) {\n        onError(e.message);\n        return;\n    }\n\n    requestObj.onupgradeneeded = function (e) {\n        try {\n            let db = requestObj.result;\n            let store = db.createObjectStore(storageNameStr, {keyPath: 'id'});\n            store.createIndex('id', 'id', {unique: true});\n        } catch (e) {\n            onError(e.message);\n        }\n    };\n    requestObj.onerror = function (e) {\n        onError('indexedDB.open failed, ' + requestObj.error);\n    };\n    requestObj.onsuccess = function (e) {\n        let databaseObj;\n        let transactionObj;\n        let storeObj;\n\n        try {\n            databaseObj = requestObj.result;\n            if (!databaseObj.objectStoreNames.contains(storageNameStr)) {\n                //someone maybe messed with the db, or creation failed earlier\n                //it's broken -> destroy\n                window.indexedDB.deleteDatabase(dbNameStr);\n                onError('object store ' + storageNameStr + ' missing. destroying db');\n                return;\n            }\n            transactionObj = databaseObj.transaction(storageNameStr, 'readwrite');\n            storeObj = transactionObj.objectStore(storageNameStr);\n            storeObj.index('id');\n        } catch (e) {\n            onError(e.message);\n            return;\n        }\n\n        databaseObj.onerror = function (e) {\n            onError('database error, ' + databaseObj.error);\n        };\n\n        try {\n            actionFunction(storeObj);\n        } catch (e) {\n            onError(e.message);\n            return;\n        }\n\n        transactionObj.oncomplete = function () {\n            onSuccess();\n            databaseObj.close();\n        };\n        transactionObj.onerror = function () {\n            onError('transaction error, ' + transactionObj.error);\n        };\n    };\n}\n\n/**\n * getKlProjectObj {\n *     width: int,\n *     height: int,\n *     layers: {\n *        name: string,\n *        opacity: float (0 - 1),\n *        mixModeStr: string,\n *        image: image object                <--------- image already loaded!\n *     }[]\n * }\n *\n * @param successCallback function - called when succesfully queried. passes KlProjectObj\n * @param errorCallback - function(errorStr) - called when error during query\n */\nexport function getKlProjectObj(successCallback, errorCallback) {\n    if (indexedDbIsSupported) {\n        let query;\n        execIndexedDBTransaction(function (storeObj) {\n            query = storeObj.get(1);\n        }, function () {\n            successCallback(query.result);\n        }, function (errorStr) {\n            errorCallback('execIndexedDBTransaction error, ' + errorStr);\n        });\n    } else {\n        successCallback(null);\n    }\n}\n\n/**\n * stores a klProjectObj into id = 1 in database:dbNameStr > storage: storageNameStr\n *\n * KlProjectObj {\n *     width: int,\n *     height: int,\n *     layers: {\n *        name: string,\n *        opacity: float (0 - 1),\n *        mixModeStr: string,\n *        blob: blob object                 <--------- blob!\n *     }[]\n * }\n *\n * @param storageProject IKlStorageProject - project to be stored\n * @param successCallback function() - on successful transaction\n * @param errorCallback function(errorStr) - on error\n */\nexport function storeKlProjectObj(storageProject: IKlStorageProject, successCallback, errorCallback) {\n    execIndexedDBTransaction(function (storeObj) {\n        storeObj.put(storageProject);\n    }, function () {\n        successCallback();\n    }, function (errorStr) {\n        errorCallback(errorStr);\n    });\n\n}\n\n/**\n * removes id = 1 from database:dbNameStr > storage: storageNameStr\n *\n * @param successCallback function() - on successful transaction\n * @param errorCallback function(error) - on error\n */\nexport function clear(successCallback, errorCallback) {\n    execIndexedDBTransaction(function (storeObj) {\n        storeObj.delete(1);\n    }, function () {\n        successCallback();\n    }, function (error) {\n        errorCallback(error);\n    });\n\n}\n","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"gJYYq\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"25BJB\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"fDGND\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"8f0bW\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"fAhTF\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"lTNVM\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"2mMxs\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"lkhcY\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"c9hFy\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"297B8\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"jxtUn\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"lfC0f\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"cDstS\");","import {IFilter} from '../kl.types';\n// @ts-ignore\nimport glBrightnessContrastImg from 'url:~/src/app/img/ui/edit-brightness-contrast.svg';\n// @ts-ignore\nimport cropExtendImg from 'url:~/src/app/img/ui/edit-crop.svg';\n// @ts-ignore\nimport glCurvesImg from 'url:~/src/app/img/ui/edit-curves.svg';\n// @ts-ignore\nimport flipImg from 'url:~/src/app/img/ui/edit-flip.svg';\n// @ts-ignore\nimport glHueSaturationImg from 'url:~/src/app/img/ui/edit-hue-saturation.svg';\n// @ts-ignore\nimport invertImg from 'url:~/src/app/img/ui/edit-invert.png';\n// @ts-ignore\nimport glPerspectiveImg from 'url:~/src/app/img/ui/edit-perspective.svg';\n// @ts-ignore\nimport resizeImg from 'url:~/src/app/img/ui/edit-resize.svg';\n// @ts-ignore\nimport rotateImg from 'url:~/src/app/img/ui/edit-rotate.svg';\n// @ts-ignore\nimport glTiltShiftImg from 'url:~/src/app/img/ui/edit-tilt-shift.png';\n// @ts-ignore\nimport toAlphaImg from 'url:~/src/app/img/ui/edit-to-alpha.svg';\n// @ts-ignore\nimport transformImg from 'url:~/src/app/img/ui/edit-transform.svg';\n// @ts-ignore\nimport glBlurImg from 'url:~/src/app/img/ui/edit-triangle-blur.png';\n// @ts-ignore\nimport glUnsharpMaskImg from 'url:~/src/app/img/ui/edit-unsharp-mask.png';\n// @ts-ignore\nimport aImg from 'url:~/src/app/img/ui/';\nimport {LANG, languageStrings} from '../../language/language';\n\n\nexport const filterLibStatus = {\n    isLoaded: false,\n};\nexport const filterLib: {\n    [key:string]: IFilter;\n} = {\n    glBrightnessContrast: {\n        lang: {name: 'filter-bright-contrast-title', button: 'filter-bright-contrast'},\n        name: '',\n        buttonLabel: '',\n        webgl: true,\n        updateContext: true,\n        icon: glBrightnessContrastImg,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    cropExtend: {\n        lang: {name: 'filter-crop-title', button: 'filter-crop-extend'},\n        name: '',\n        buttonLabel: '',\n        icon: cropExtendImg,\n        webgl: false,\n        neededWithWebGL: true,\n        updateContext: true,\n        updatePos: true,\n        getDialog: null,\n        apply: null,\n        inEmbed: false,\n    },\n    glCurves: {\n        lang: {name: 'filter-curves-title', button: 'filter-curves'},\n        name: '',\n        buttonLabel: '',\n        icon: glCurvesImg,\n        webgl: true,\n        updateContext: true,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    flip: {\n        lang: {name: 'filter-flip-title', button: 'filter-flip'},\n        name: '',\n        buttonLabel: '',\n        icon: flipImg,\n        webgl: false,\n        neededWithWebGL: true,\n        updateContext: true,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    glHueSaturation: {\n        lang: {name: 'filter-hue-sat-title', button: 'filter-hue-sat'},\n        name: '',\n        buttonLabel: '',\n        icon: glHueSaturationImg,\n        webgl: true,\n        updateContext: true,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    invert: {\n        lang: {name: 'filter-invert', button: 'filter-invert'},\n        name: '',\n        icon: invertImg,\n        webgl: true,\n        updateContext: true,\n        updatePos: false,\n        isInstant: true,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    glPerspective: {\n        lang: {name: 'filter-perspective-title', button: 'filter-perspective'},\n        name: '',\n        buttonLabel: '',\n        icon: glPerspectiveImg,\n        webgl: true,\n        updateContext: true,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    resize: {\n        lang: {name: 'filter-resize-title', button: 'filter-resize'},\n        name: '',\n        buttonLabel: '',\n        icon: resizeImg,\n        webgl: false,\n        neededWithWebGL: true,\n        updateContext: true,\n        updatePos: true,\n        getDialog: null,\n        apply: null,\n        inEmbed: false,\n    },\n    rotate: {\n        lang: {name: 'filter-rotate-title', button: 'filter-rotate'},\n        name: '',\n        buttonLabel: '',\n        icon: rotateImg,\n        webgl: false,\n        neededWithWebGL: true,\n        updateContext: true,\n        updatePos: true,\n        getDialog: null,\n        apply: null,\n        inEmbed: false,\n    },\n    glTiltShift: {\n        lang: {name: 'filter-tilt-shift-title', button: 'filter-tilt-shift'},\n        name: '',\n        buttonLabel: '',\n        icon: glTiltShiftImg,\n        webgl: true,\n        updateContext: true,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    toAlpha: {\n        lang: {name: 'filter-to-alpha-title', button: 'filter-to-alpha'},\n        name: '',\n        buttonLabel: '',\n        icon: toAlphaImg,\n        webgl: true,\n        updateContext: false,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    transform: {\n        lang: {name: 'filter-transform-title', button: 'filter-transform'},\n        name: '',\n        buttonLabel: '',\n        icon: transformImg,\n        webgl: false,\n        neededWithWebGL: true,\n        updateContext: true,\n        updatePos: false,\n        ieFails: true,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    glBlur: {\n        lang: {name: 'filter-triangle-blur-title', button: 'filter-triangle-blur'},\n        name: '',\n        buttonLabel: '',\n        icon: glBlurImg,\n        webgl: true,\n        updateContext: true,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    },\n    glUnsharpMask: {\n        lang: {name: 'filter-unsharp-mask-title', button: 'filter-unsharp-mask'},\n        name: '',\n        buttonLabel: '',\n        icon: glUnsharpMaskImg,\n        webgl: true,\n        updateContext: true,\n        updatePos: false,\n        getDialog: null,\n        apply: null,\n        inEmbed: true,\n    }\n};\n\nfunction updateNames() {\n    const keys = Object.keys(filterLib);\n    keys.forEach(item => {\n        filterLib[item].name = LANG(filterLib[item].lang.name);\n        filterLib[item].buttonLabel = LANG(filterLib[item].lang.button);\n    });\n}\nupdateNames();\n\nlanguageStrings.subscribe(() => {\n    updateNames();\n});","/*\n * A speed-improved perlin and simplex noise algorithms for 2D.\n *\n * Based on example code by Stefan Gustavson (stegu@itn.liu.se).\n * Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\n * Better rank ordering method by Stefan Gustavson in 2012.\n * Converted to Javascript by Joseph Gentle.\n *\n * Version 2012-03-09\n *\n * This code was placed in the public domain by its original author,\n * Stefan Gustavson. You may use it as you see fit, but\n * attribution is appreciated.\n *\n */\n\nconst myModule = {} as any;\n\n\nfunction Grad(x, y, z) {\n    this.x = x; this.y = y; this.z = z;\n}\n\nGrad.prototype.dot2 = function(x, y) {\n    return this.x*x + this.y*y;\n};\n/*\nGrad.prototype.dot3 = function(x, y, z) {\n    return this.x*x + this.y*y + this.z*z;\n};*/\n\nlet grad3 = [new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),\n    new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),\n    new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)];\n\nlet p = [151,160,137,91,90,15,\n    131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,\n    190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,\n    88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,\n    77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,\n    102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,\n    135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,\n    5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,\n    223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,\n    129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,\n    251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,\n    49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,\n    138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];\n// To remove the need for index wrapping, double the permutation table length\nlet perm = new Array(512);\nlet gradP = new Array(512);\n\n// This isn't a very good seeding function, but it works ok. It supports 2^16\n// different seed values. Write something better if you need more seeds.\nmyModule.seed = function(seed) {\n    if (seed > 0 && seed < 1) {\n        // Scale the seed out\n        seed *= 65536;\n    }\n\n    seed = Math.floor(seed);\n    if (seed < 256) {\n        seed |= seed << 8;\n    }\n\n    for (let i = 0; i < 256; i++) {\n        let v;\n        if (i & 1) {\n            v = p[i] ^ (seed & 255);\n        } else {\n            v = p[i] ^ ((seed>>8) & 255);\n        }\n\n        perm[i] = perm[i + 256] = v;\n        gradP[i] = gradP[i + 256] = grad3[v % 12];\n    }\n};\n\nmyModule.seed(0);\n\n/*\nfor (let i=0; i<256; i++) {\n  perm[i] = perm[i + 256] = p[i];\n  gradP[i] = gradP[i + 256] = grad3[perm[i] % 12];\n}*/\n\n// Skewing and unskewing factors for 2, 3, and 4 dimensions\nlet F2 = 0.5*(Math.sqrt(3)-1);\nlet G2 = (3-Math.sqrt(3))/6;\n\n/*let F3 = 1/3;\nlet G3 = 1/6;*/\n\n// 2D simplex noise\nmyModule.simplex2 = function(xin, yin) {\n    let n0, n1, n2; // Noise contributions from the three corners\n    // Skew the input space to determine which simplex cell we're in\n    let s = (xin+yin)*F2; // Hairy factor for 2D\n    let i = Math.floor(xin+s);\n    let j = Math.floor(yin+s);\n    let t = (i+j)*G2;\n    let x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\n    let y0 = yin-j+t;\n    // For the 2D case, the simplex shape is an equilateral triangle.\n    // Determine which simplex we are in.\n    let i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\n    if (x0>y0) { // lower triangle, XY order: (0,0)->(1,0)->(1,1)\n        i1=1; j1=0;\n    } else {    // upper triangle, YX order: (0,0)->(0,1)->(1,1)\n        i1=0; j1=1;\n    }\n    // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n    // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n    // c = (3-sqrt(3))/6\n    let x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n    let y1 = y0 - j1 + G2;\n    let x2 = x0 - 1 + 2 * G2; // Offsets for last corner in (x,y) unskewed coords\n    let y2 = y0 - 1 + 2 * G2;\n    // Work out the hashed gradient indices of the three simplex corners\n    i &= 255;\n    j &= 255;\n    let gi0 = gradP[i+perm[j]];\n    let gi1 = gradP[i+i1+perm[j+j1]];\n    let gi2 = gradP[i+1+perm[j+1]];\n    // Calculate the contribution from the three corners\n    let t0 = 0.5 - x0*x0-y0*y0;\n    if (t0<0) {\n        n0 = 0;\n    } else {\n        t0 *= t0;\n        n0 = t0 * t0 * gi0.dot2(x0, y0);  // (x,y) of grad3 used for 2D gradient\n    }\n    let t1 = 0.5 - x1*x1-y1*y1;\n    if (t1<0) {\n        n1 = 0;\n    } else {\n        t1 *= t1;\n        n1 = t1 * t1 * gi1.dot2(x1, y1);\n    }\n    let t2 = 0.5 - x2*x2-y2*y2;\n    if (t2<0) {\n        n2 = 0;\n    } else {\n        t2 *= t2;\n        n2 = t2 * t2 * gi2.dot2(x2, y2);\n    }\n    // Add contributions from each corner to get the final noise value.\n    // The result is scaled to return values in the interval [-1,1].\n    return 70 * (n0 + n1 + n2);\n};\n/*\n// 3D simplex noise\nmyModule.simplex3 = function(xin, yin, zin) {\n    let n0, n1, n2, n3; // Noise contributions from the four corners\n\n    // Skew the input space to determine which simplex cell we're in\n    let s = (xin+yin+zin)*F3; // Hairy factor for 2D\n    let i = Math.floor(xin+s);\n    let j = Math.floor(yin+s);\n    let k = Math.floor(zin+s);\n\n    let t = (i+j+k)*G3;\n    let x0 = xin-i+t; // The x,y distances from the cell origin, unskewed.\n    let y0 = yin-j+t;\n    let z0 = zin-k+t;\n\n    // For the 3D case, the simplex shape is a slightly irregular tetrahedron.\n    // Determine which simplex we are in.\n    let i1, j1, k1; // Offsets for second corner of simplex in (i,j,k) coords\n    let i2, j2, k2; // Offsets for third corner of simplex in (i,j,k) coords\n    if (x0 >= y0) {\n        if (y0 >= z0)      { i1=1; j1=0; k1=0; i2=1; j2=1; k2=0; }\n        else if (x0 >= z0) { i1=1; j1=0; k1=0; i2=1; j2=0; k2=1; }\n        else              { i1=0; j1=0; k1=1; i2=1; j2=0; k2=1; }\n    } else {\n        if (y0 < z0)      { i1=0; j1=0; k1=1; i2=0; j2=1; k2=1; }\n        else if (x0 < z0) { i1=0; j1=1; k1=0; i2=0; j2=1; k2=1; }\n        else             { i1=0; j1=1; k1=0; i2=1; j2=1; k2=0; }\n    }\n    // A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z),\n    // a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and\n    // a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where\n    // c = 1/6.\n    let x1 = x0 - i1 + G3; // Offsets for second corner\n    let y1 = y0 - j1 + G3;\n    let z1 = z0 - k1 + G3;\n\n    let x2 = x0 - i2 + 2 * G3; // Offsets for third corner\n    let y2 = y0 - j2 + 2 * G3;\n    let z2 = z0 - k2 + 2 * G3;\n\n    let x3 = x0 - 1 + 3 * G3; // Offsets for fourth corner\n    let y3 = y0 - 1 + 3 * G3;\n    let z3 = z0 - 1 + 3 * G3;\n\n    // Work out the hashed gradient indices of the four simplex corners\n    i &= 255;\n    j &= 255;\n    k &= 255;\n    let gi0 = gradP[i+   perm[j+   perm[k   ]]];\n    let gi1 = gradP[i+i1+perm[j+j1+perm[k+k1]]];\n    let gi2 = gradP[i+i2+perm[j+j2+perm[k+k2]]];\n    let gi3 = gradP[i+ 1+perm[j+ 1+perm[k+ 1]]];\n\n    // Calculate the contribution from the four corners\n    let t0 = 0.6 - x0*x0 - y0*y0 - z0*z0;\n    if (t0<0) {\n        n0 = 0;\n    } else {\n        t0 *= t0;\n        n0 = t0 * t0 * gi0.dot3(x0, y0, z0);  // (x,y) of grad3 used for 2D gradient\n    }\n    let t1 = 0.6 - x1*x1 - y1*y1 - z1*z1;\n    if (t1<0) {\n        n1 = 0;\n    } else {\n        t1 *= t1;\n        n1 = t1 * t1 * gi1.dot3(x1, y1, z1);\n    }\n    let t2 = 0.6 - x2*x2 - y2*y2 - z2*z2;\n    if (t2<0) {\n        n2 = 0;\n    } else {\n        t2 *= t2;\n        n2 = t2 * t2 * gi2.dot3(x2, y2, z2);\n    }\n    let t3 = 0.6 - x3*x3 - y3*y3 - z3*z3;\n    if (t3<0) {\n        n3 = 0;\n    } else {\n        t3 *= t3;\n        n3 = t3 * t3 * gi3.dot3(x3, y3, z3);\n    }\n    // Add contributions from each corner to get the final noise value.\n    // The result is scaled to return values in the interval [-1,1].\n    return 32 * (n0 + n1 + n2 + n3);\n\n};\n*/\n// ##### Perlin noise stuff\n/*\nfunction fade(t) {\n    return t*t*t*(t*(t*6-15)+10);\n}\n\nfunction lerp(a, b, t) {\n    return (1-t)*a + t*b;\n}\n\n// 2D Perlin Noise\nmyModule.perlin2 = function(x, y) {\n    // Find unit grid cell containing point\n    let X = Math.floor(x), Y = Math.floor(y);\n    // Get relative xy coordinates of point within that cell\n    x = x - X; y = y - Y;\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\n    X = X & 255; Y = Y & 255;\n\n    // Calculate noise contributions from each of the four corners\n    let n00 = gradP[X+perm[Y]].dot2(x, y);\n    let n01 = gradP[X+perm[Y+1]].dot2(x, y-1);\n    let n10 = gradP[X+1+perm[Y]].dot2(x-1, y);\n    let n11 = gradP[X+1+perm[Y+1]].dot2(x-1, y-1);\n\n    // Compute the fade curve value for x\n    let u = fade(x);\n\n    // Interpolate the four results\n    return lerp(\n        lerp(n00, n10, u),\n        lerp(n01, n11, u),\n        fade(y));\n};*/\n/*\n// 3D Perlin Noise\nmyModule.perlin3 = function(x, y, z) {\n    // Find unit grid cell containing point\n    let X = Math.floor(x), Y = Math.floor(y), Z = Math.floor(z);\n    // Get relative xyz coordinates of point within that cell\n    x = x - X; y = y - Y; z = z - Z;\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\n    X = X & 255; Y = Y & 255; Z = Z & 255;\n\n    // Calculate noise contributions from each of the eight corners\n    let n000 = gradP[X+  perm[Y+  perm[Z  ]]].dot3(x,   y,     z);\n    let n001 = gradP[X+  perm[Y+  perm[Z+1]]].dot3(x,   y,   z-1);\n    let n010 = gradP[X+  perm[Y+1+perm[Z  ]]].dot3(x,   y-1,   z);\n    let n011 = gradP[X+  perm[Y+1+perm[Z+1]]].dot3(x,   y-1, z-1);\n    let n100 = gradP[X+1+perm[Y+  perm[Z  ]]].dot3(x-1,   y,   z);\n    let n101 = gradP[X+1+perm[Y+  perm[Z+1]]].dot3(x-1,   y, z-1);\n    let n110 = gradP[X+1+perm[Y+1+perm[Z  ]]].dot3(x-1, y-1,   z);\n    let n111 = gradP[X+1+perm[Y+1+perm[Z+1]]].dot3(x-1, y-1, z-1);\n\n    // Compute the fade curve value for x, y, z\n    let u = fade(x);\n    let v = fade(y);\n    let w = fade(z);\n\n    // Interpolate\n    return lerp(\n        lerp(\n            lerp(n000, n100, u),\n            lerp(n001, n101, u), w),\n        lerp(\n            lerp(n010, n110, u),\n            lerp(n011, n111, u), w),\n        v);\n};*/\n\nexport const noise = myModule;","import {BB} from '../../../bb/bb';\nimport {noise} from '../../../bb/math/perlin';\nimport {IVector2D} from '../../../bb/bb.types';\n\n// chalk\nexport function genBrushAlpha01(w: number): HTMLCanvasElement {\n\n    const scaleFac = w / 500;\n    const h = w;\n    const canvas = BB.canvas(w, h);\n    const ctx = canvas.getContext('2d');\n    const imData = ctx.createImageData(w, h);\n    for (let x = 0; x < w; x++) {\n        for (let y = 0; y < h; y++) {\n            let i = (y * w + x) * 4;\n\n            // base noise\n            const sFac2 = scaleFac + noise.simplex2(x / 50 / scaleFac, y / 50 / scaleFac) * 0.04;\n            let noisePattern = 100 + (noise.simplex2(x / 50 / sFac2, y / 50 / sFac2) + 1) / 2 * 100;\n            noisePattern -= (noise.simplex2(x / 10 / scaleFac, y / 10 / scaleFac) + 1) / 2 * 100;\n\n            // fade out in circular shape\n            const centerDist = BB.dist(w / 2, h / 2, x, y);\n            let falloff = BB.clamp(\n                1 - ((centerDist - (w / 2.5)) / (w / 14) + noise.simplex2(x / 22 / sFac2, y / 22 / sFac2)),\n                0,\n                1);\n            noisePattern = noisePattern * falloff;\n\n            // make the middle darker\n            const falloff2 = BB.clamp(1 - centerDist / w, 0, 1) * 2;\n            noisePattern = noisePattern * falloff2;\n\n            imData.data[i] = 0;\n            imData.data[i + 1] = 0;\n            imData.data[i + 2] = 0;\n            imData.data[i + 3] = BB.clamp(noisePattern, 0, 255);\n        }\n    }\n\n    ctx.putImageData(imData, 0, 0);\n    return canvas;\n}\n\n// https://www.shadertoy.com/view/3tdSDj\nfunction udSegment( p: IVector2D, a: IVector2D, b: IVector2D ) {\n    let ba = BB.Vec2.sub(b, a);\n    let pa = BB.Vec2.sub(p, a);\n    let h = BB.clamp( BB.Vec2.dot(pa,ba) / BB.Vec2.dot(ba,ba), 0.0, 1.0 );\n    return BB.Vec2.len(BB.Vec2.sub(pa, BB.Vec2.mul(ba, h)));\n}\n\n// calligraphy\nexport function genBrushAlpha02(w: number): HTMLCanvasElement {\n\n    const pDist = 1 / 4;\n    let centerSize = 2 / 3;\n    let transitionSize = 1 / 3;\n    centerSize *= pDist;\n    transitionSize *= pDist;\n    const p1 = {x: pDist * w, y: w - (w * pDist)};\n    const p2 = {x: w - (w * pDist), y: pDist * w};\n\n    const h = w;\n    const canvas = BB.canvas(w, h);\n    let ctx = canvas.getContext('2d');\n    const imData = ctx.createImageData(w, h);\n    for (let x = 0; x < w; x++) {\n        for (let y = 0; y < h; y++) {\n            const i = (y * w + x) * 4;\n\n            let col = udSegment({x: x, y: y}, p1, p2);\n\n            col = BB.clamp(\n                255 - ((col - (w * centerSize)) / (w * transitionSize) * 255),\n                0,\n                255\n            );\n\n            imData.data[i] = 0;\n            imData.data[i + 1] = 0;\n            imData.data[i + 2] = 0;\n            imData.data[i + 3] = col;\n        }\n    }\n\n    ctx.putImageData(imData, 0, 0);\n    return canvas;\n}","import {genBrushAlpha01, genBrushAlpha02} from './alphas/brush-alphas';\n\nexport const alphaImArr = []; //used by default brush\nalphaImArr[1] = genBrushAlpha01(128);\nalphaImArr[2] = genBrushAlpha02(128);","import {BB} from '../../bb/bb';\nimport {IRGB, IRGBA} from '../kl.types';\nimport {IBounds, IPressureInput} from '../../bb/bb.types';\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\n\nconst cellSize = 256;\n\ninterface IDrawBufferItem {\n    x: number;\n    y: number;\n    size: number;\n    opacity: number;\n    x1: number;\n    y1: number;\n    x2: number;\n    y2: number;\n    r: number;\n    g: number;\n    b: number;\n}\n\n// faster than using BB.clamp somehow (in chrome)\nfunction clamp(num, min, max) {\n    return num <= min\n        ? min\n        : num >= max\n            ? max\n            : num\n}\n\nexport class BlendBrush {\n\n    private isTesting: boolean = false; // testing mode - context only gets updated when line is finished\n\n    private context: CanvasRenderingContext2D;\n    private color: IRGB;\n    private size: number = 29; // radius - 0.5 - 99999\n    private opacity: number = 0.6; // 0-1\n    private blending: number = 0.65; // 0-1\n\n    private settingLockLayerAlpha: boolean = false;\n    private settingSizePressure: boolean = true;\n    private settingOpacityPressure: boolean = false;\n\n    private blendCol: IRGBA = {r: 0, g: 0, b: 0, a: 1}; // todo docs\n    private blendMix: number = 0.45; // todo docs\n    private mixr: number; // todo docs\n    private mixg: number; // todo docs\n    private mixb: number; // todo docs\n    private localColOld: IRGBA; // todo docs\n\n    private isDrawing: boolean = false;\n    private lastInput: IPressureInput = {x: 0, y: 0, pressure: 0}; // todo docs\n    private lastInput2: IPressureInput = {x: 0, y: 0, pressure: 0}; // todo docs\n    private bezierLine: any; // todo type\n\n    private history: KlHistoryInterface | null;\n    private historyEntry: IHistoryEntry;\n    private redrawBounds: IBounds;\n    private cells: (ImageData | null)[];\n    private drawBuffer: IDrawBufferItem[];\n\n    private updateRedrawBounds (bounds: IBounds): void {\n        this.redrawBounds = BB.updateBounds(this.redrawBounds, bounds);\n    }\n\n    private getCellsWidth(): number {\n        return Math.ceil(this.context.canvas.width / cellSize);\n    }\n\n    /**\n     * draw changed cells (changed by brushstroke) onto context\n     * @private\n     */\n    private drawChangedCells(): void {\n        const cells = this.cells.map(item => null);\n        const touchedCells = this.getTouchedCells(this.redrawBounds);\n        touchedCells.forEach((isTouched, index) => {\n            if (isTouched) {\n                cells[index] = this.cells[index];\n            }\n        });\n        this.drawCells(cells);\n        this.redrawBounds = null;\n    }\n\n    private getTouchedCells(bounds: IBounds): boolean[] {\n        const touchedCells = this.cells.map(item => false);\n        const cellsW = this.getCellsWidth();\n        bounds = {\n            x1: Math.floor(bounds.x1 / cellSize),\n            y1: Math.floor(bounds.y1 / cellSize),\n            x2: Math.floor(bounds.x2 / cellSize),\n            y2: Math.floor(bounds.y2 / cellSize),\n        };\n        for (let i = bounds.x1; i <= bounds.x2; i++) {\n            for (let e = bounds.y1; e <= bounds.y2; e++) {\n                touchedCells[e * cellsW + i] = true;\n            }\n        }\n        return touchedCells;\n    }\n\n    /**\n     * Slice up bounds accordings to cells\n     * @param bounds\n     * @private\n     */\n    private sliceBounds(bounds: IBounds): {index: number; bounds: IBounds}[] {\n        const cellsW = this.getCellsWidth();\n        const result: {index: number; bounds: IBounds}[] = [];\n        const touchedCells = this.getTouchedCells(bounds);\n\n        touchedCells.forEach((cell, i) => {\n            if (!cell) {\n                return;\n            }\n\n            const cellOffsetX = (i % cellsW) * cellSize;\n            const cellOffsetY = Math.floor(i / cellsW) * cellSize;\n            const cellWidth = this.cells[i].width;\n            const cellHeight = this.cells[i].height;\n\n            const inCellBounds = {\n                x1: Math.max(0, bounds.x1 - cellOffsetX),\n                y1: Math.max(0, bounds.y1 - cellOffsetY),\n                x2: Math.min(cellWidth - 1, bounds.x2 - cellOffsetX),\n                y2: Math.min(cellHeight - 1, bounds.y2 - cellOffsetY),\n            }\n            if (inCellBounds.x1 > inCellBounds.x2 || inCellBounds.y1 > inCellBounds.y2) {\n                return;\n            }\n            result.push({\n                index: i,\n                bounds: inCellBounds,\n            });\n        });\n\n        return result;\n    }\n\n    /**\n     * update copyImageData. copy over new regions if needed\n     */\n    private copyFromCanvas(bounds: IBounds) {\n        if (!bounds) {\n            return;\n        }\n\n        const touchedCells = this.getTouchedCells(bounds);\n        const cellsW = this.getCellsWidth();\n\n        touchedCells.forEach((item, i) => {\n            if (!item || this.cells[i]) {\n                // not touched, or already copied\n                return;\n            }\n            const x = i % cellsW;\n            const y = Math.floor(i / cellsW);\n            const w = (Math.min(x * cellSize + cellSize, this.context.canvas.width) - 1) % cellSize + 1;\n            const h = (Math.min(y * cellSize + cellSize, this.context.canvas.height) - 1) % cellSize + 1;\n\n            // temp canvas to prevent main canvas from getting slowed down in chrome\n            const tmpCanvas = BB.canvas(w, h);\n            const tmpCtx = tmpCanvas.getContext('2d');\n            tmpCtx.drawImage(this.context.canvas, -x * cellSize, -y * cellSize);\n\n            this.cells[i] = tmpCtx.getImageData(0, 0, w, h);\n        });\n    }\n\n    private getAverage (x, y, size): IRGBA {\n\n        size = Math.max(0.5, size * 0.75);\n        const x1 = Math.max(0, Math.floor(x - size));\n        const y1 = Math.max(0, Math.floor(y - size));\n        const x2 = Math.min(this.context.canvas.width - 1, Math.ceil(x + size));\n        const y2 = Math.min(this.context.canvas.height - 1, Math.ceil(y + size));\n        if (x1 > x2 || y1 > y2) {\n            return {\n                r: 0,\n                g: 0,\n                b: 0,\n                a: 0,\n            };\n        }\n\n        let ar = 0, ag = 0, ab = 0, aa = 0, alpha;\n\n        const slicedBounds = this.sliceBounds({ x1, y1, x2, y2 });\n        slicedBounds.forEach(slice => {\n            const width = this.cells[slice.index].width;\n            const data = this.cells[slice.index].data;\n            const bounds = slice.bounds;\n\n            for (let i = bounds.y1; i <= bounds.y2; i += 4) {\n                for (let e = bounds.x1, e2 = i * width * 4 + bounds.x1 * 4; e <= bounds.x2; e += 4, e2 += 4 * 4) {\n                    alpha = data[e2 + 3];\n                    ar += data[e2] * alpha;\n                    ag += data[e2 + 1] * alpha;\n                    ab += data[e2 + 2] * alpha;\n                    aa += alpha;\n                }\n            }\n        });\n\n        if (aa !== 0) {\n            ar /= aa;\n            ag /= aa;\n            ab /= aa;\n            aa = Math.min(1, aa);\n        }\n        return {\n            r: ar,\n            g: ag,\n            b: ab,\n            a: aa\n        };\n    }\n\n    private prepDot (x: number, y: number, size: number): IBounds {\n        size = Math.max(0.5, size);\n        let x1 = Math.max(0, Math.floor(x - size));\n        let y1 = Math.max(0, Math.floor(y - size));\n        let x2 = Math.min(this.context.canvas.width - 1, Math.ceil(x + size));\n        let y2 = Math.min(this.context.canvas.height - 1, Math.ceil(y + size));\n        if (x1 > x2 || y1 > y2) {\n            return null;\n        }\n        return { x1, y1, x2, y2 };\n    }\n\n    private drawDot (params: IDrawBufferItem): void {\n        // array with random numbers. faster than Math.random()\n        let randI = 0;\n        const randLen = params.size > 30 ? 1024 : 512; // lower lengths lead to noticeable patterns\n        const randArr = [];\n        for (let i = 0; i < randLen; i++) {\n            randArr[i] = (Math.random() - 0.5) / 1.001 + 0.5;\n        }\n\n        // thin lines take more than just 1 sample\n        const sampleArr = [8,4,4,4,2,2,2,2,2,2]; // <0.5, 0.5, 1, 1.5, etc.\n        const samples = sampleArr[Math.floor(params.size * 2)];\n        const samplesSquared: number = samples ? samples * samples : 0;\n        const sampleOffsets = [];\n        if (samples) {\n            let i = 0;\n            for (let n = 0; n < samples; n++) {\n                for (let m = 0; m < samples; m++, i += 2) {\n                    sampleOffsets[i] = (n + 1) / samples; // x offset\n                    sampleOffsets[i + 1] = (m + 1) / samples; // y offset\n                }\n            }\n        }\n\n        const sharpness = Math.pow(params.opacity, 2) * 0.8;\n        // to optimize calculations\n        const invSharpness = 1 - sharpness;\n        const sharpnessSubtrahend = sharpness / invSharpness;\n        const sizeSquared = params.size * params.size;\n        const distDivisor = sizeSquared * invSharpness / params.opacity;\n        const alphaMinuend = (1 + sharpnessSubtrahend) * params.opacity;\n\n\n        const slicedBounds = this.sliceBounds({\n            x1: params.x1,\n            y1: params.y1,\n            x2: params.x2,\n            y2: params.y2,\n        });\n\n        const cellsW = this.getCellsWidth();\n        slicedBounds.forEach(slice => {\n            const cellOffsetX = (slice.index % cellsW) * cellSize;\n            const cellOffsetY = Math.floor(slice.index / cellsW) * cellSize;\n            const cellWidth = this.cells[slice.index].width;\n            const data = this.cells[slice.index].data;\n\n            // i - y index within cell\n            // e - x index within cell\n\n            // e2 - index in image data\n\n            // ri - y index within image relative to dot-center\n            // re - x index within image relative to dot-center\n\n            for (let i = slice.bounds.y1, ri = i + cellOffsetY - params.y; i <= slice.bounds.y2; i++, ri++) {\n                for (\n                    let e = slice.bounds.x1,\n                        e2 = i * cellWidth * 4 + slice.bounds.x1 * 4,\n                        re = e + cellOffsetX - params.x;\n                    e <= slice.bounds.x2;\n                    e++,\n                        e2 += 4,\n                        re++\n                ) {\n                    // O = over -> brush-dot\n                    // U = under -> image\n\n                    let alphaO = 0;\n                    if (samplesSquared) {\n                        for (let f = 0; f < sampleOffsets.length; f += 2) {\n                            const dist = BB.lenSquared(re + sampleOffsets[f], ri + sampleOffsets[f + 1]);\n                            if (dist >= sizeSquared) {\n                                continue;\n                            }\n                            alphaO += clamp(alphaMinuend - dist / distDivisor, 0, params.opacity);\n                        }\n                        if (!alphaO) {\n                            continue;\n                        }\n                        alphaO /= samplesSquared;\n                    } else {\n                        // technically needs + 0.5 offset, but not noticeable with large brush\n                        const dist = Math.pow(re, 2) + Math.pow(ri, 2);\n                        if (dist >= sizeSquared) {\n                            continue;\n                        }\n                        alphaO = clamp(alphaMinuend - dist / distDivisor, 0, params.opacity);\n                    }\n\n                    const invAlphaO = 1 - alphaO;\n                    const alphaU =data[e2 + 3] / 255;\n\n                    if (this.settingLockLayerAlpha) {\n                        const underR = (params.r * alphaO) + ((data[e2]) * invAlphaO);\n                        const underG = (params.g * alphaO) + ((data[e2 + 1]) * invAlphaO);\n                        const underB = (params.b * alphaO) + ((data[e2 + 2]) * invAlphaO);\n                        if (alphaU) {\n                            data[e2] = Math.floor(underR + randArr[randI]);\n                            data[e2 + 1] = Math.floor(underG + randArr[randI]);\n                            data[e2 + 2] = Math.floor(underB + randArr[randI]);\n                        }\n                    } else {\n                        const underR = (params.r * alphaO) + ((data[e2] * alphaU) * invAlphaO);\n                        const underG = (params.g * alphaO) + ((data[e2 + 1] * alphaU) * invAlphaO);\n                        const underB = (params.b * alphaO) + ((data[e2 + 2] * alphaU) * invAlphaO);\n\n                        let newAlpha = 1 - invAlphaO * (1 - alphaU);\n                        data[e2 + 3] = Math.floor(Math.min(255, newAlpha * 255) + 0.5);\n                        if (newAlpha) {\n                            data[e2] = Math.floor(underR / (newAlpha) + randArr[randI]);\n                            data[e2 + 1] = Math.floor(underG / (newAlpha) + randArr[randI]);\n                            data[e2 + 2] = Math.floor(underB / (newAlpha) + randArr[randI]);\n                        }\n                    }\n                    randI = (randI + 1) % randLen;\n\n                }\n            }\n\n        });\n    }\n\n    private calcSpacing (size: number): number {\n        return BB.mix(\n            (size * 2) / 2, // until size 5.3\n            (size * 2) / 9, // at size 24\n            BB.clamp((size - 2.7) / (12 - 2.7), 0, 1)\n        );\n    }\n\n    private continueLine (x: number, y: number, p: number, isCoalesced: boolean): void {\n\n        this.drawBuffer = [];\n\n        let localPressure;\n        let localOpacity;\n        let localSize = (this.settingSizePressure) ? Math.max(1, p * this.size) : Math.max(1, this.size);\n\n        let bdist = this.calcSpacing(localSize);\n\n        let avgX = x;\n        let avgY = y;\n        if (x === null) {\n            avgX = this.lastInput.x;\n            avgY = this.lastInput.y;\n        }\n\n        let localColNew;\n\n        if (this.blending === 0) {\n            this.mixr = this.color.r;\n            this.mixg = this.color.g;\n            this.mixb = this.color.b;\n        } else {\n            let average;\n            if (isCoalesced) {\n                average = {r: this.localColOld.r, g: this.localColOld.g, b: this.localColOld.b, a: 0};\n            } else {\n                const avgParams = [avgX, avgY, ((this.settingSizePressure) ? Math.max(0.5, p * this.size) : Math.max(0.5, this.size))];\n                const bounds = this.prepDot(avgParams[0], avgParams[1], avgParams[2]);\n                this.copyFromCanvas(bounds);\n                average = this.getAverage(avgParams[0], avgParams[1], avgParams[2]);\n            }\n            localColNew = {r: 0, g: 0, b: 0, a: 0};\n\n            if (average.a > 0 && this.blendCol.a === 0) {\n                this.blendCol.r = average.r;\n                this.blendCol.g = average.g;\n                this.blendCol.b = average.b;\n                this.blendCol.a = average.a;\n                localColNew.r = this.blendCol.r;\n                localColNew.g = this.blendCol.g;\n                localColNew.b = this.blendCol.b;\n                localColNew.a = this.blendCol.a;\n\n            } else {\n                if (average.a === 0) {\n                    average.r = this.color.r;\n                    average.g = this.color.g;\n                    average.b = this.color.b;\n                    average.a = 1 - this.blending;\n                }\n\n                this.blendCol.r = BB.mix(this.blendCol.r, BB.mix(this.blendCol.r, average.r, this.blendMix), average.a);\n                this.blendCol.g = BB.mix(this.blendCol.g, BB.mix(this.blendCol.g, average.g, this.blendMix), average.a);\n                this.blendCol.b = BB.mix(this.blendCol.b, BB.mix(this.blendCol.b, average.b, this.blendMix), average.a);\n                this.blendCol.a = Math.min(1, this.blendCol.a + average.a);\n                localColNew.r = this.blendCol.r;\n                localColNew.g = this.blendCol.g;\n                localColNew.b = this.blendCol.b;\n                localColNew.a = this.blendCol.a;\n            }\n\n        }\n\n\n        const bezierCallback = (val) => {\n            if (this.blending >= 1 && this.blendCol.a <= 0) {\n                return;\n            }\n            let factor = val.t;\n            localPressure = this.lastInput2.pressure * (1 - factor) + p * factor;\n            localOpacity = (this.settingOpacityPressure) ? (this.opacity * localPressure * localPressure) : this.opacity;\n            localSize = (this.settingSizePressure) ? Math.max(0.1, localPressure * this.size) : Math.max(0.1, this.size);\n            if (this.blending != 0) {\n                this.mixr = BB.mix(this.localColOld.r, localColNew.r, factor);\n                this.mixg = BB.mix(this.localColOld.g, localColNew.g, factor);\n                this.mixb = BB.mix(this.localColOld.b, localColNew.b, factor);\n            }\n            if (this.blending === 1 && this.localColOld.a === 0) {\n                this.mixr = localColNew.r;\n                this.mixg = localColNew.g;\n                this.mixb = localColNew.b;\n            }\n            const bounds = this.prepDot(val.x, val.y, localSize);\n            if (bounds) {\n                this.updateRedrawBounds(bounds);\n                this.drawBuffer.push({\n                    x: val.x,\n                    y: val.y,\n                    size: localSize,\n                    opacity: localOpacity,\n                    x1: bounds.x1,\n                    y1: bounds.y1,\n                    x2: bounds.x2,\n                    y2: bounds.y2,\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\n                })\n            }\n        };\n\n        if (x === null) {\n            this.bezierLine.addFinal(bdist, bezierCallback);\n        } else {\n            this.bezierLine.add(x, y, bdist, bezierCallback);\n        }\n\n        this.copyFromCanvas(this.redrawBounds);\n        this.drawBuffer.forEach(item => {\n            this.drawDot(item);\n        });\n        this.drawBuffer = [];\n\n        this.localColOld = localColNew;\n    }\n\n\n\n\n\n    // --- public ----\n    constructor () {\n    }\n\n    setHistory (h: KlHistoryInterface): void {\n        this.history = h;\n    }\n\n    getSize (): number {\n        return this.size;\n    }\n\n    setSize (s: number): void {\n        this.size = s;\n    }\n\n    getOpacity (): number {\n        return this.opacity;\n    }\n\n    setOpacity (o: number): void {\n        this.opacity = o;\n    }\n\n    getBlending (): number {\n        return this.blending;\n    }\n\n    setBlending (b: number) {\n        this.blending = b;\n    }\n\n    setColor (c: IRGB): void {\n        this.color = BB.copyObj(c);\n    }\n\n    setContext (c: CanvasRenderingContext2D) {\n        this.context = c;\n    }\n\n    setSizePressure (b: boolean): void {\n        this.settingSizePressure = !!b;\n    }\n\n    setOpacityPressure (b: boolean): void {\n        this.settingOpacityPressure = !!b;\n    }\n\n    getLockAlpha (): boolean {\n        return this.settingLockLayerAlpha;\n    }\n\n    setLockAlpha (b: boolean): void {\n        this.settingLockLayerAlpha = !!b;\n    }\n\n    getIsDrawing (): boolean {\n        return this.isDrawing;\n    }\n\n    setIsTesting (b: boolean): void {\n        this.isTesting = !!b;\n    }\n\n    startLine (x: number, y: number, p: number): void {\n        this.historyEntry = {\n            tool: [\"brush\", \"BlendBrush\"],\n            actions: []\n        };\n\n\n        const totalCells = Math.ceil(this.context.canvas.width / cellSize) * Math.ceil(this.context.canvas.height / cellSize);\n        this.cells = '0'.repeat(totalCells).split('').map(item => null);\n\n        this.isDrawing = true;\n\n        p = Math.max(0, Math.min(1, p));\n        let localOpacity = (this.settingOpacityPressure) ? (this.opacity * p * p) : this.opacity;\n        let localSize = (this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size);\n        if (this.blending === 0) {\n            this.mixr = this.color.r;\n            this.mixg = this.color.g;\n            this.mixb = this.color.b;\n        } else {\n            this.copyFromCanvas(this.prepDot(x, y, localSize));\n\n            let average = this.getAverage(\n                x,\n                y,\n                ((this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size))\n            );\n            if (average.a === 0) {\n                this.blendCol = {\n                    r: this.color.r,\n                    g: this.color.g,\n                    b: this.color.b,\n                    a: 1 - this.blending,\n                };\n            } else {\n                this.blendCol = {\n                    r: average.r,\n                    g: average.g,\n                    b: average.b,\n                    a: average.a,\n                };\n            }\n\n            this.mixr = this.blendCol.r;\n            this.mixg = this.blendCol.g;\n            this.mixb = this.blendCol.b;\n        }\n\n        this.localColOld = {r: this.mixr, g: this.mixg, b: this.mixb, a: this.blendCol.a};\n\n        this.redrawBounds = null;\n        this.drawBuffer = [];\n\n        if (this.blending < 1 || this.blendCol.a > 0) {\n            const bounds = this.prepDot(x, y, localSize);\n            if (bounds) {\n                this.updateRedrawBounds(bounds);\n                this.drawBuffer.push({\n                    x: x,\n                    y: y,\n                    size: localSize,\n                    opacity: localOpacity,\n                    x1: bounds.x1,\n                    y1: bounds.y1,\n                    x2: bounds.x2,\n                    y2: bounds.y2,\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\n                })\n            }\n        }\n\n        this.copyFromCanvas(this.redrawBounds);\n        this.drawBuffer.forEach(item => {\n            this.drawDot(item);\n        });\n        this.drawBuffer = [];\n\n        this.bezierLine = new BB.BezierLine();\n        this.bezierLine.add(x, y, 0, function () {\n        });\n\n        this.lastInput.x = x;\n        this.lastInput.y = y;\n        this.lastInput.pressure = p;\n        this.lastInput2 = BB.copyObj(this.lastInput);\n\n        if (this.redrawBounds && !this.isTesting) {\n            this.drawChangedCells();\n        }\n    }\n\n    goLine (x: number, y: number, p: number, isCoalesced: boolean): void {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.continueLine(x, y, this.lastInput.pressure, isCoalesced);\n\n        this.lastInput2 = BB.copyObj(this.lastInput);\n        this.lastInput.x = x;\n        this.lastInput.y = y;\n        this.lastInput.pressure = p;\n\n        if (this.redrawBounds && !this.isTesting) {\n            this.drawChangedCells();\n        }\n    }\n\n    endLine (): void {\n        if (this.bezierLine) {\n            this.continueLine(null, null, this.lastInput.pressure, false);\n        }\n\n        this.isDrawing = false;\n        this.bezierLine = null;\n\n        if (this.redrawBounds) {\n            this.drawChangedCells();\n        }\n\n        if (this.historyEntry && this.history && this.cells.find(item => !!item)) {\n            this.historyEntry.actions.push({\n                action: \"drawCells\",\n                params: [this.cells],\n            });\n            this.history.push(this.historyEntry);\n            this.historyEntry = null;\n        }\n        this.cells = null;\n    }\n\n    /**\n     * draw cells onto context\n     * @param cells\n     */\n    drawCells (cells: (ImageData | null)[]): void {\n        const cellsW = this.getCellsWidth();\n        cells.forEach((imageData, index) => {\n            if (!imageData) {\n                return;\n            }\n            const cellOffsetX = (index % cellsW) * cellSize;\n            const cellOffsetY = Math.floor(index / cellsW) * cellSize;\n            this.context.putImageData(imageData, cellOffsetX, cellOffsetY);\n        });\n    }\n\n    drawLineSegment (x1: number, y1: number, x2: number, y2: number): void {\n        this.lastInput.x = x2;\n        this.lastInput.y = y2;\n\n        if (this.isDrawing || x1 === undefined) {\n            return;\n        }\n\n        const totalCells = Math.ceil(this.context.canvas.width / cellSize) * Math.ceil(this.context.canvas.height / cellSize);\n        this.cells = '0'.repeat(totalCells).split('').map(item => null);\n        this.redrawBounds = null;\n        this.drawBuffer = [];\n\n        this.copyFromCanvas(this.prepDot(x1, y1, Math.max(0.1, this.size)));\n        let average = this.getAverage(x1, y1, Math.max(0.1, this.size));\n\n        if (average.a === 0) {\n            this.blendCol = {\n                r: this.color.r,\n                g: this.color.g,\n                b: this.color.b,\n                a: 1 - this.blending,\n            };\n        } else {\n            this.blendCol = {\n                r: average.r,\n                g: average.g,\n                b: average.b,\n                a: average.a,\n            };\n        }\n\n        this.mixr = this.color.r * (1 - this.blendCol.a) + (this.blending * this.blendCol.r + this.color.r * (1 - this.blending)) * this.blendCol.a;\n        this.mixg = this.color.g * (1 - this.blendCol.a) + (this.blending * this.blendCol.g + this.color.g * (1 - this.blending)) * this.blendCol.a;\n        this.mixb = this.color.b * (1 - this.blendCol.a) + (this.blending * this.blendCol.b + this.color.b * (1 - this.blending)) * this.blendCol.a;\n\n\n        const p = 1;\n        const localOpacity = (this.settingOpacityPressure) ? (this.opacity * p * p) : this.opacity;\n        const localSize = (this.settingSizePressure) ? Math.max(0.1, p * this.size) : Math.max(0.1, this.size);\n\n\n        const mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\n        const eX = (x2 - x1) / mouseDist;\n        const eY = (y2 - y1) / mouseDist;\n        const bdist = this.calcSpacing(localSize);\n        for (let loopDist = 0; loopDist <= mouseDist; loopDist += bdist) {\n            const bounds = this.prepDot(x1 + eX * loopDist, y1 + eY * loopDist, localSize);\n            if (bounds) {\n                this.copyFromCanvas(bounds);\n                this.drawBuffer.push({\n                    x: x1 + eX * loopDist,\n                    y: y1 + eY * loopDist,\n                    size: localSize,\n                    opacity: localOpacity,\n                    x1: bounds.x1,\n                    y1: bounds.y1,\n                    x2: bounds.x2,\n                    y2: bounds.y2,\n                    r: BB.mix(this.color.r, this.mixr, this.blending),\n                    g: BB.mix(this.color.g, this.mixg, this.blending),\n                    b: BB.mix(this.color.b, this.mixb, this.blending),\n                })\n            }\n        }\n        this.drawBuffer.forEach(item => {\n            this.drawDot(item);\n        });\n        this.drawBuffer = [];\n\n        if (this.history && this.cells.find(item => !!item)) {\n            this.drawCells(this.cells);\n            this.historyEntry = {\n                tool: [\"brush\", \"BlendBrush\"],\n                actions: [{\n                    action: \"drawCells\",\n                    params: [this.cells],\n                }],\n            };\n            this.history.push(this.historyEntry);\n            this.historyEntry = null;\n        }\n        this.cells = null;\n    }\n}\n","import {BB} from '../../bb/bb';\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\nimport {KL} from '../kl';\n\nconst sampleCanvas = BB.canvas(32, 32);\nconst sampleCtx = sampleCanvas.getContext('2d');\n\nexport function SketchyBrush() {\n    let context;\n    let settingColor;\n\n    let settingSize = 1, settingOpacity = 0.2;\n    let settingBlending = 0.5;\n    let settingScale = 1;\n\n    let lastX, lastY;\n    let isDrawing = false;\n    let lastInput = {x: 0, y: 0, pressure: 0};\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\n    let historyEntry: IHistoryEntry;\n    let sketchySeed = 0;\n    this.setHistory = function (l: KlHistoryInterface) {\n        history = l;\n    };\n    this.setSeed = function (s) {\n        sketchySeed = parseInt(s);\n    };\n    this.getSeed = function () {\n        return parseInt('' + sketchySeed);\n    };\n\n    function rand() {\n        sketchySeed++;\n        return Math.sin(6324634.2345 * Math.cos(sketchySeed * 5342.3423)) * 0.5 + 0.5;\n    }\n\n    let points = [];\n    let count = 0;\n    let mixmode = [\n        function (c1, c2) {\n            return c1;\n        },\n        function (c1, c2) {\n            let result = new BB.RGB(c1.r, c1.g, c1.b);\n            result.r *= c2.r / 255;\n            result.g *= c2.g / 255;\n            result.b *= c2.b / 255;\n            return result;\n        },\n        function (c1, c2) {\n            let result = new BB.RGB(c1.r, c1.g, c1.b);\n            result.r *= c2.r / 255;\n            result.g *= c2.g / 255;\n            result.b *= c2.b / 255;\n            return result;\n        }\n    ];\n\n    this.getSize = function () {\n        return settingSize / 2;\n    };\n    this.setColor = function (c) {\n        settingColor = c;\n    };\n    this.getOpacity = function () {\n        return settingOpacity;\n    };\n    this.setOpacity = function (o) {\n        settingOpacity = o;\n    };\n    this.getBlending = function () {\n        return settingBlending;\n    };\n    this.setBlending = function (b) {\n        settingBlending = b;\n    };\n    this.setSize = function (s) {\n        settingSize = s * 2;\n    };\n    this.getScale = function () {\n        return settingScale;\n    };\n    this.setScale = function (s) {\n        settingScale = s;\n    };\n    this.setContext = function (c) {\n        context = c;\n    };\n    this.startLine = function (x, y, pressure, shift) {\n        if (shift && lastInput.x) {\n            let lx = lastInput.x, ly = lastInput.y;\n            isDrawing = true;\n            //this.goLine(x,y,pressure);\n            this.endLine();\n        } else {\n            isDrawing = true;\n            lastX = x;\n            lastY = y;\n            lastInput.x = x;\n            lastInput.y = y;\n            historyEntry = {\n                tool: [\"brush\", \"SketchyBrush\"],\n                actions: []\n            };\n            historyEntry.actions.push({\n                action: \"setScale\",\n                params: [settingScale]\n            });\n            historyEntry.actions.push({\n                action: \"setSize\",\n                params: [settingSize / 2]\n            });\n            historyEntry.actions.push({\n                action: \"setOpacity\",\n                params: [settingOpacity]\n            });\n            historyEntry.actions.push({\n                action: \"setColor\",\n                params: [settingColor]\n            });\n            historyEntry.actions.push({\n                action: \"setBlending\",\n                params: [settingBlending]\n            });\n            historyEntry.actions.push({\n                action: \"startLine\",\n                params: [x, y, pressure]\n            });\n        }\n\n    };\n    this.goLine = function (p_x, p_y, pressure, preMixedColor) {\n        if (!isDrawing || (p_x === lastInput.x && p_y === lastInput.y)) {\n            return;\n        }\n\n        let e, b, a, g;\n        let x = parseInt(p_x);\n        let y = parseInt(p_y);\n        points.push([x, y]);\n\n        let mixr = settingColor.r;\n        let mixg = settingColor.g;\n        let mixb = settingColor.b;\n\n        if (preMixedColor !== null) {\n            mixr = preMixedColor.r;\n            mixg = preMixedColor.g;\n            mixb = preMixedColor.b;\n        } else {\n            if (settingBlending !== 0) {\n                if (x + 5 >= 0 && y + 5 >= 0 && x - 5 < context.canvas.width - 1 && y - 5 < context.canvas.height - 1) {\n                    mixr = 0;\n                    mixg = 0;\n                    mixb = 0;\n                    let mixx = Math.min(context.canvas.width - 1, Math.max(0, x - 5));\n                    let mixy = Math.min(context.canvas.height - 1, Math.max(0, y - 5));\n                    let mixw = Math.min(context.canvas.width - 1, Math.max(0, x + 5));\n                    let mixh = Math.min(context.canvas.height - 1, Math.max(0, y + 5));\n                    mixw -= mixx;\n                    mixh -= mixy;\n\n                    if (mixw > 0 && mixh > 0) {\n                        let imdat = context.getImageData(mixx, mixy, mixw, mixh);\n                        let countmix = 0;\n                        for (let i = 0; i < imdat.data.length; i += 4) {\n                            mixr += imdat.data[i + 0];\n                            mixg += imdat.data[i + 1];\n                            mixb += imdat.data[i + 2];\n                            countmix++;\n                        }\n                        mixr /= countmix;\n                        mixg /= countmix;\n                        mixb /= countmix;\n                    }\n\n                    let mixed = mixmode[0](new BB.RGB(mixr, mixg, mixb), settingColor);\n                    mixr = parseInt('' + BB.mix(settingColor.r, mixed.r, settingBlending));\n                    mixg = parseInt('' + BB.mix(settingColor.g, mixed.g, settingBlending));\n                    mixb = parseInt('' + BB.mix(settingColor.b, mixed.b, settingBlending));\n                }\n            }\n        }\n\n        context.save();\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\n        context.lineWidth = settingSize;\n\n        context.beginPath();\n        context.moveTo(lastX, lastY);\n        context.lineTo(x, y);\n\n        for (e = 0; e < points.length; e++) {\n            b = points[e][0] - points[count][0];\n            a = points[e][1] - points[count][1];\n            g = b * b + a * a;\n            if (g < 4000 * settingScale * settingScale && rand() > g / 2000 / settingScale / settingScale) {\n                context.moveTo(points[count][0] + (b * 0.3), points[count][1] + (a * 0.3));\n                context.lineTo(points[e][0] - (b * 0.3), points[e][1] - (a * 0.3));\n            }\n        }\n\n        context.stroke();\n        context.restore();\n\n\n        count++;\n        lastX = x;\n        lastY = y;\n        lastInput.x = x;\n        lastInput.y = y;\n        historyEntry.actions.push({\n            action: \"goLine\",\n            params: [p_x, p_y, pressure, {r: mixr, g: mixg, b: mixb}]\n        });\n    };\n    this.endLine = function () {\n        isDrawing = false;\n        count = 0;\n        points = [];\n        if (historyEntry) {\n            historyEntry.actions.push({\n                action: \"endLine\",\n                params: []\n            });\n            history.push(historyEntry);\n            historyEntry = undefined;\n        }\n    };\n    //cheap n' ugly\n    this.drawLineSegment = function (x1, y1, x2, y2) {\n        lastInput.x = x2;\n        lastInput.y = y2;\n\n        if (isDrawing || x1 === undefined) {\n            return;\n        }\n\n\n        context.save();\n        context.lineWidth = settingSize;\n\n        let mixr = settingColor.r, mixg = settingColor.g, mixb = settingColor.b;\n        if (x1 + 5 >= 0 && y1 + 5 >= 0 && x1 - 5 < context.canvas.width - 1 && y1 - 5 < context.canvas.height - 1) {\n            mixr = 0;\n            mixg = 0;\n            mixb = 0;\n            let mixx = Math.min(context.canvas.width - 1, Math.max(0, x1 - 5));\n            let mixy = Math.min(context.canvas.height - 1, Math.max(0, y1 - 5));\n            let mixw = Math.min(context.canvas.width - 1, Math.max(0, x1 + 5));\n            let mixh = Math.min(context.canvas.height - 1, Math.max(0, y1 + 5));\n            mixw -= mixx;\n            mixh -= mixy;\n            if (mixw > 0 && mixh > 0) {\n                let w = Math.min(sampleCanvas.width, mixw);\n                let h = Math.min(sampleCanvas.height, mixh);\n                sampleCtx.save();\n                sampleCtx.globalCompositeOperation = 'copy';\n                sampleCtx.drawImage(context.canvas, mixx, mixy, mixw, mixh, 0, 0, w, h);\n                sampleCtx.restore();\n\n                let imdat = sampleCtx.getImageData(mixx, mixy, mixw, mixh);\n                let countmix = 0;\n                for (let i = 0; i < imdat.data.length; i += 4) {\n                    mixr += imdat.data[i + 0];\n                    mixg += imdat.data[i + 1];\n                    mixb += imdat.data[i + 2];\n                    countmix++;\n                }\n                mixr /= countmix;\n                mixg /= countmix;\n                mixb /= countmix;\n            }\n        }\n        let mixed = mixmode[0](new BB.RGB(mixr, mixg, mixb), settingColor);\n        mixr = parseInt('' + (settingBlending * mixed.r + settingColor.r * (1 - settingBlending)));\n        mixg = parseInt('' + (settingBlending * mixed.g + settingColor.g * (1 - settingBlending)));\n        mixb = parseInt('' + (settingBlending * mixed.b + settingColor.b * (1 - settingBlending)));\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\n        context.beginPath();\n        context.moveTo(x1, y1);\n        context.lineTo(x2, y2);\n        context.stroke();\n        context.strokeStyle = \"rgba(\" + mixr + \", \" + mixg + \", \" + mixb + \", \" + settingOpacity + \")\";\n        context.restore();\n\n\n        let historyEntry = {\n            tool: [\"brush\", \"SketchyBrush\"],\n            actions: []\n        };\n        historyEntry.actions.push({\n            action: \"setScale\",\n            params: [settingScale]\n        });\n        historyEntry.actions.push({\n            action: \"setSize\",\n            params: [settingSize / 2]\n        });\n        historyEntry.actions.push({\n            action: \"setOpacity\",\n            params: [settingOpacity]\n        });\n        historyEntry.actions.push({\n            action: \"setColor\",\n            params: [settingColor]\n        });\n        historyEntry.actions.push({\n            action: \"setBlending\",\n            params: [settingBlending]\n        });\n\n        historyEntry.actions.push({\n            action: \"drawLineSegment\",\n            params: [x1, y1, x2, y2]\n        });\n        history.push(historyEntry);\n    };\n\n    this.isDrawing = function () {\n        return isDrawing;\n    };\n}","import {BB} from '../../bb/bb';\nimport {IBounds, IPressureInput, IVector2D} from '../../bb/bb.types';\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\nimport {KL} from '../kl';\nimport {IRGB} from '../kl.types';\n\n// let statCount = 1;\n// let statAcc = 0;\n// stats on win10, chrome, size 100, opacity 80, smudge()\n// unoptimized: 1 ms\n// minimal: 0.09 ms\n// minimal + circle: 0.5ms\n// minimal + circle + ix, iy: 0.23ms\n// unoptimized + ix, iy: 0.64 ms\n// unoptimized + ix, iy + sans rounding: 0.61 ms\n// ix, iy + sans rounding + sans random: 0.32ms\n// ix, iy + sans rounding + fast random: 0.46 ms\n// ix, iy + sans rounding + fast random + offset const: 0.48 ms\n\nconst CELL_SIZE = 256;\n\ninterface ISmudgeParams {\n    aP: IVector2D;\n    bP: IVector2D;\n    size: {\n        w: number;\n        h: number;\n    };\n    brush: {\n        center: IVector2D,\n        size: number;\n        opacity: number;\n        alphaLock: boolean;\n    };\n}\n\n\n/**\n * determine bounds of smudge\n * @param imWidth\n * @param imHeight\n * @param aP\n * @param bP\n * @param size\n */\nfunction prepSmudge(\n    imWidth: number,\n    imHeight: number,\n    aP: IVector2D, // top left of source, integers\n    bP: IVector2D, // top left of dest, integers\n    size: {w: number; h: number}, // size of both rectangles, integers\n): {\n    aP: IVector2D,\n    bP: IVector2D,\n    size: {w: number; h: number},\n} {\n\n    if (aP.x === bP.x && aP.y === bP.y) {\n        return null;\n    }\n\n    aP = BB.copyObj(aP);\n    bP = BB.copyObj(bP);\n    size = BB.copyObj(size);\n\n    // corner behavior\n    // cut down rectangles, if a or b go outside\n    // i.e. if user drags partially or fully outside the canvas\n    {\n        let top = 0;\n        let right = 0;\n        let bottom = 0;\n        let left = 0;\n\n        if (aP.x < 0) {\n            left = -aP.x;\n        }\n        if (aP.y < 0) {\n            top = -aP.y;\n        }\n        if (bP.x < 0) {\n            left = Math.max(left, -bP.x);\n        }\n        if (bP.y < 0) {\n            top = Math.max(top, -bP.y);\n        }\n        if (aP.x + size.w > imWidth) {\n            right = aP.x + size.w - imWidth;\n        }\n        if (aP.y + size.h > imHeight) {\n            bottom = aP.y + size.h - imHeight;\n        }\n        if (bP.x + size.w > imWidth) {\n            right = Math.max(right, bP.x + size.w - imWidth);\n        }\n        if (bP.y + size.h > imHeight) {\n            bottom = Math.max(bottom, bP.y + size.h - imHeight);\n        }\n\n        aP.x += left;\n        bP.x += left;\n        aP.y += top;\n        bP.y += top;\n\n        size.w = size.w - left - right;\n        size.h = size.h - top - bottom;\n        if (size.w <= 0 || size.h <= 0) {\n            return null;\n        }\n    }\n\n    return {\n        aP: {\n            x: aP.x,\n            y: aP.y,\n        },\n        bP: {\n            x: bP.x,\n            y: bP.y,\n        },\n        size: {\n            w: size.w,\n            h: size.h,\n        }\n    };\n}\n\n// faster than using BB.clamp somehow (in chrome)\nfunction clamp(num, min, max) {\n    return num <= min\n        ? min\n        : num >= max\n            ? max\n            : num\n}\n\n/**\n * Pixel operations that do the smudging via ImageData\n * @param imageData\n * @param p\n */\nfunction smudge(imageData: ImageData, p : ISmudgeParams): void {\n\n    p = BB.copyObj(p);\n\n    const cSize = p.brush.size;\n    const cX = p.brush.center.x;\n    const cY = p.brush.center.y;\n\n    /*if (statCount % 1000 === 0) {\n        console.log(statAcc / 1000);\n        statAcc = 0;\n    }\n    let start = performance.now();*/\n\n\n    // determine offset\n    let aIndex = p.aP.y * imageData.width + p.aP.x;\n    let bIndex = p.bP.y * imageData.width + p.bP.x;\n    const offset = (bIndex - aIndex) * 4;\n\n    // array with random numbers. faster than Math.random()\n    let randI = 0;\n    const randLen = cSize > 30 ? 1024 : 512; // lower lengths lead to noticeable patterns\n    const randArr = [];\n    for (let i = 0; i < randLen; i++) {\n        randArr[i] = (Math.random() - 0.5) / 1.001 + 0.5;\n    }\n\n    const softnessPx = Math.max(3, Math.min(8, p.brush.size - 8));\n\n    const pixel = (ai, bi, ix, iy) => {\n\n        const dist = BB.dist(cX, cY, ix, iy);\n        const fac = 1 - p.brush.opacity * (1 - clamp((dist - (cSize - softnessPx)) / softnessPx, 0, 1));\n\n        if (fac === 1) {\n            return;\n        }\n\n        if (!imageData.data[ai + 3]) {\n\n        } else if (!imageData.data[bi + 3]) { // don't mix if target fully transparent. pixel might have a strange color.\n            imageData.data[bi] = imageData.data[ai + 0];\n            imageData.data[bi + 1] = imageData.data[ai + 1];\n            imageData.data[bi + 2] = imageData.data[ai + 2];\n        } else {\n\n            // consider alpha ratio. If a has lower alpha than b, then b should be stronger, and vice versa\n            // not totally accurate. TODO same compositing as blend brush\n            let fac2;\n            if (imageData.data[ai + 3] < imageData.data[bi + 3]) {\n                fac2 = 1 - imageData.data[ai + 3] / imageData.data[bi + 3] * (1 - fac);\n            } else {\n                fac2 = imageData.data[bi + 3] / imageData.data[ai + 3] * fac;\n            }\n\n            // ImageData's Uint8ClampedArray rounds -> 0.5 becomes 1. But not in Safari, so needs to be done manually\n            // Offset mixed color by random number noise (-0.5, 0.5), so it doesn't get stuck while mixing.\n            // No +0.5, because it cancels out with rand.\n            imageData.data[bi] = Math.floor(BB.mix(imageData.data[ai], imageData.data[bi + 0], fac2) + randArr[randI]);\n            imageData.data[bi + 1] = Math.floor(BB.mix(imageData.data[ai + 1], imageData.data[bi + 1], fac2) + randArr[randI]);\n            imageData.data[bi + 2] = Math.floor(BB.mix(imageData.data[ai + 2], imageData.data[bi + 2], fac2) + randArr[randI]);\n\n            randI = (randI + 1) % randLen;\n        }\n        // Always mix alpha. unless alpha lock\n        if (!p.brush.alphaLock) {\n            imageData.data[bi + 3] = Math.floor(BB.mix(imageData.data[ai + 3], imageData.data[bi + 3], fac) + 0.5);\n        }\n\n    };\n\n    const bx1 = p.bP.x * 4;\n    const bx2 = bx1 + (p.size.w - 1) * 4;\n\n    // transfer of pixels depends on direction of smudging if there is overlap\n    if (p.aP.y < p.bP.y) {\n        for (let y = p.size.h - 1, iy = p.bP.y + p.size.h - 1; y >= 0; y--, iy--) {\n            const yStart = (y + p.bP.y) * imageData.width * 4;\n            for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\n                pixel(x2, x, ix, iy);\n            }\n        }\n    } else if (p.aP.y > p.bP.y) {\n        for (let y = 0, iy = p.bP.y; y < p.size.h; y++, iy++) {\n            const yStart = (y + p.bP.y) * imageData.width * 4;\n            for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\n                pixel(x2, x, ix, iy);\n            }\n        }\n    } else {\n        if (p.aP.x < p.bP.x) {\n            for (let y = p.size.h - 1, iy = p.bP.y + p.size.h - 1; y >= 0; y--, iy--) {\n                const yStart = (y + p.bP.y) * imageData.width * 4;\n                for (let x = bx2 + yStart, x2 = bx2 + yStart - offset, ix = p.bP.x + p.size.w - 1; x >= bx1 + yStart; x -= 4, x2 -= 4, ix--) {\n                    pixel(x2, x, ix, iy);\n                }\n            }\n        } else {\n            for (let y = 0, iy = p.bP.y; y < p.size.h; y++, iy++) {\n                const yStart = (y + p.bP.y) * imageData.width * 4;\n                for (let x = bx1 + yStart, x2 = bx1 + yStart - offset, ix = p.bP.x; x < bx2 + yStart; x += 4, x2 += 4, ix++) {\n                    pixel(x2, x, ix, iy);\n                }\n            }\n        }\n    }\n\n    //statCount++;\n    //statAcc += performance.now() - start;\n}\n\nexport class SmudgeBrush {\n\n    private context: CanvasRenderingContext2D;\n    private history: KlHistoryInterface = new KL.DecoyKlHistory();\n    private historyEntry: IHistoryEntry;\n\n    private settingColor: IRGB = {r: 0, g: 0, b: 0};\n    private settingSize: number = 35;\n    private settingSpacing: number = 0.20446882736951905;\n    private settingOpacity: number = 0.8;\n    private settingColorStr: string;\n    private settingHasSizePressure: boolean = false;\n    private settingHasOpacityPressure: boolean = false;\n    private settingLockLayerAlpha: boolean = false;\n\n    private lineToolLastDot: number;\n    private lastInput: IPressureInput = {x: 0, y: 0, pressure: 0};\n    private lastInput2: IPressureInput = {x: 0, y: 0, pressure: 0};\n    private lastDot: IVector2D;\n\n    private isDrawing: boolean = false;\n\n    private bezierLine: any = null; // todo type BezierLine\n\n    private redrawBounds: IBounds;\n    private completeRedrawBounds: IBounds;\n\n    private copyImageData: ImageData;\n\n    private drawBuffer: ISmudgeParams[] = [];\n\n    private copiedCells: boolean[];\n\n    updateRedrawBounds(bounds: IBounds): void {\n        this.redrawBounds = BB.updateBounds(this.redrawBounds, bounds);\n    }\n\n    updateCompleteRedrawBounds (x1, y1, x2, y2): void {\n        this.completeRedrawBounds = BB.updateBounds(\n            this.completeRedrawBounds,\n            { x1, y1, x2, y2 }\n        );\n    }\n\n    /**\n     * update copyImageData. copy over new regions if needed\n     */\n    copyFromCanvas(): void {\n\n        const touchedCells = this.copiedCells.map(item => false);\n\n        const bounds: IBounds[] = [];\n        const cellsW = Math.ceil(this.copyImageData.width / CELL_SIZE);\n\n        if (!this.redrawBounds) {\n            return;\n        }\n        bounds.push({\n            x1: Math.floor(this.redrawBounds.x1 / CELL_SIZE),\n            y1: Math.floor(this.redrawBounds.y1 / CELL_SIZE),\n            x2: Math.floor(this.redrawBounds.x2 / CELL_SIZE),\n            y2: Math.floor(this.redrawBounds.y2 / CELL_SIZE),\n        });\n        bounds.forEach(item => {\n            for (let i = item.x1; i <= item.x2; i++) {\n                for (let e = item.y1; e <= item.y2; e++) {\n                    touchedCells[e * cellsW + i] = true;\n                }\n            }\n        });\n\n        touchedCells.forEach((item, i) => {\n            if (!item || this.copiedCells[i]) {\n                // not touched, or already copied\n                return;\n            }\n            this.copiedCells[i] = true;\n            const x = i % cellsW;\n            const y = Math.floor(i / cellsW);\n            const w = (Math.min(x * CELL_SIZE + CELL_SIZE, this.copyImageData.width) - 1) % CELL_SIZE + 1;\n            const h = (Math.min(y * CELL_SIZE + CELL_SIZE, this.copyImageData.height) - 1) % CELL_SIZE + 1;\n\n            // temp canvas to prevent main canvas from getting slowed down in chrome\n            const tmpCanvas = BB.canvas(w, h);\n            const tmpCtx = tmpCanvas.getContext('2d');\n            tmpCtx.drawImage(this.context.canvas, -x * CELL_SIZE, -y * CELL_SIZE);\n\n            const data = tmpCtx.getImageData(0, 0, w, h);\n\n            for (let i = 0; i < h; i++) {\n                for (let e = 0, e2 = i * w * 4, e3 = ((y * CELL_SIZE + i) * this.copyImageData.width + x * CELL_SIZE) * 4; e < w; e++, e2 += 4, e3 += 4) {\n                    this.copyImageData.data[e3] = data.data[e2];\n                    this.copyImageData.data[e3 + 1] = data.data[e2 + 1];\n                    this.copyImageData.data[e3 + 2] = data.data[e2 + 2];\n                    this.copyImageData.data[e3 + 3] = data.data[e2 + 3];\n                }\n            }\n        });\n    }\n\n\n    /**\n     * fill drawBuffer with params about to be drawn\n     * @param x\n     * @param y\n     * @param size\n     * @param opacity\n     */\n    prepDot (x: number, y: number, size: number, opacity: number): void {\n        if (!this.lastDot) {\n            this.lastDot = {\n                x: x,\n                y: y,\n            };\n            return;\n        }\n\n        size = Math.round(size);\n\n\n        const w = Math.round(size * 2);\n        const h = Math.round(size * 2);\n\n        const bounds = prepSmudge(\n            this.copyImageData.width,\n            this.copyImageData.height,\n            {\n                x: Math.round(this.lastDot.x - size),\n                y: Math.round(this.lastDot.y - size),\n            },\n            {\n                x: Math.round(x - size),\n                y: Math.round(y - size),\n            },\n            {\n                w,\n                h,\n            },\n        );\n\n        if (bounds) {\n            const params: ISmudgeParams = {\n                aP: bounds.aP,\n                bP: bounds.bP,\n                size: bounds.size,\n                brush: {\n                    center: { x, y },\n                    size,\n                    opacity,\n                    alphaLock: this.settingLockLayerAlpha,\n                }\n            };\n            this.updateRedrawBounds({\n                x1: params.bP.x,\n                y1: params.bP.y,\n                x2: params.bP.x + params.brush.size * 2,\n                y2: params.bP.y + params.brush.size * 2,\n            });\n            this.drawBuffer.push(params);\n        }\n\n        this.lastDot = {\n            x: x,\n            y: y,\n        };\n    }\n\n    continueLine (x: number, y: number, size: number, pressure: number): void {\n        this.drawBuffer = [];\n\n        if (this.bezierLine === null) {\n            this.bezierLine = new BB.BezierLine();\n            this.bezierLine.add(this.lastInput.x, this.lastInput.y, 0, function(){});\n        }\n\n        const drawArr = []; //draw instructions. will be all drawn at once\n\n        const dotCallback = (val): void => {\n            const localPressure = BB.mix(this.lastInput2.pressure, pressure, val.t);\n            const localOpacity = this.settingOpacity * (this.settingHasOpacityPressure ? (localPressure * localPressure) : 1);\n            const localSize = Math.max(0.1, this.settingSize * (this.settingHasSizePressure ? localPressure : 1));\n            drawArr.push([val.x, val.y, localSize, localOpacity, val.angle]);\n        };\n\n        const localSpacing = size * this.settingSpacing / 3;\n        if (x === null) {\n            this.bezierLine.addFinal(localSpacing, dotCallback);\n        } else {\n            this.bezierLine.add(x, y, localSpacing, dotCallback);\n        }\n\n        // execute draw instructions\n        let before;\n        for (let i = 0; i < drawArr.length; i++) {\n            const item = drawArr[i];\n            this.prepDot(item[0], item[1], item[2], item[3]);\n            before = item;\n        }\n\n        this.copyFromCanvas();\n\n        for (let i = 0; i < this.drawBuffer.length; i++) {\n            smudge(this.copyImageData, this.drawBuffer[i]);\n        }\n    }\n\n\n\n    // ---- public ----\n\n    constructor () { }\n\n    startLine (x: number, y: number, p: number): void {\n        this.historyEntry = {\n            tool: [\"brush\", \"SmudgeBrush\"],\n            actions: []\n        };\n\n        p = BB.clamp(p, 0, 1);\n        const localOpacity = this.settingHasOpacityPressure ? (this.settingOpacity * p * p) : this.settingOpacity;\n        const localSize = this.settingHasSizePressure ? Math.max(0.1, p * this.settingSize) : Math.max(0.1, this.settingSize);\n\n        this.lastDot = null;\n        this.isDrawing = true;\n\n        this.copyImageData = new ImageData(this.context.canvas.width, this.context.canvas.height);\n        const totalCells = Math.ceil(this.context.canvas.width / CELL_SIZE) * Math.ceil(this.context.canvas.height / CELL_SIZE);\n        this.copiedCells = '0'.repeat(totalCells).split('').map(item => false);\n\n        this.prepDot(x, y, localSize, localOpacity);\n\n        this.lineToolLastDot = localSize * this.settingSpacing;\n        this.lastInput.x = x;\n        this.lastInput.y = y;\n        this.lastInput.pressure = p;\n        this.lastInput2.pressure = p;\n\n        this.completeRedrawBounds = null;\n    }\n\n    goLine (x: number, y: number, p: number): void {\n        if (!this.isDrawing) {\n            return;\n        }\n\n        this.redrawBounds = null;\n        const pressure = BB.clamp(p, 0, 1);\n        const localSize = this.settingHasSizePressure ?\n            Math.max(0.1, this.lastInput.pressure * this.settingSize) : Math.max(0.1, this.settingSize);\n\n        this.continueLine(x, y, localSize, this.lastInput.pressure);\n\n\n        if (this.redrawBounds) {\n            this.context.putImageData(\n                this.copyImageData,\n                0,\n                0,\n                this.redrawBounds.x1,\n                this.redrawBounds.y1,\n                this.redrawBounds.x2 - this.redrawBounds.x1 - 1,\n                this.redrawBounds.y2 - this.redrawBounds.y1 - 1\n            );\n            this.updateCompleteRedrawBounds(\n                this.redrawBounds.x1,\n                this.redrawBounds.y1,\n                this.redrawBounds.x2,\n                this.redrawBounds.y2\n            );\n        }\n\n        this.lastInput.x = x;\n        this.lastInput.y = y;\n        this.lastInput2.pressure = this.lastInput.pressure;\n        this.lastInput.pressure = pressure;\n    }\n\n    endLine (): void {\n        this.redrawBounds = null;\n        const localSize = this.settingHasSizePressure ?\n            Math.max(0.1, this.lastInput.pressure * this.settingSize) : Math.max(0.1, this.settingSize);\n        this.context.save();\n        this.continueLine(null, null, localSize, this.lastInput.pressure);\n        this.context.restore();\n\n        this.isDrawing = false;\n        this.bezierLine = null;\n\n        if (this.redrawBounds) {\n            this.context.putImageData(\n                this.copyImageData,\n                0,\n                0,\n                this.redrawBounds.x1,\n                this.redrawBounds.y1,\n                this.redrawBounds.x2 - this.redrawBounds.x1 - 1,\n                this.redrawBounds.y2 - this.redrawBounds.y1 - 1\n            );\n            this.updateCompleteRedrawBounds(\n                this.redrawBounds.x1,\n                this.redrawBounds.y1,\n                this.redrawBounds.x2,\n                this.redrawBounds.y2\n            );\n        }\n\n        if (this.historyEntry && this.completeRedrawBounds) {\n            let historyIm: ImageData | HTMLCanvasElement = this.copyImageData;\n            if (!(\n                this.completeRedrawBounds.x1 === 0 &&\n                this.completeRedrawBounds.y1 === 0 &&\n                this.completeRedrawBounds.x2 >= this.context.canvas.width - 1 &&\n                this.completeRedrawBounds.y2 >= this.context.canvas.height - 1\n            )) {\n\n                // temp canvas to prevent main canvas from getting slowed down in chrome\n                const tmpCanvas = BB.canvas(\n                    this.completeRedrawBounds.x2 - this.completeRedrawBounds.x1 + 1,\n                    this.completeRedrawBounds.y2 - this.completeRedrawBounds.y1 + 1\n                );\n                const tmpCtx = tmpCanvas.getContext('2d');\n                tmpCtx.drawImage(this.context.canvas, -this.completeRedrawBounds.x1, -this.completeRedrawBounds.y1);\n\n                historyIm = tmpCanvas; // faster than getting image data (measured on 2018 lenovo chromebook)\n            }\n            this.historyEntry.actions.push({\n                action: \"drawImage\",\n                params: [\n                    historyIm,\n                    this.completeRedrawBounds.x1,\n                    this.completeRedrawBounds.y1,\n                ],\n            });\n            this.history.push(this.historyEntry);\n            this.historyEntry = undefined;\n        }\n        this.copyImageData = null;\n    }\n\n    drawImage (im: ImageData | HTMLCanvasElement, x: number, y: number): void {\n        if (im instanceof ImageData) {\n            this.context.putImageData(im, x, y);\n        } else {\n            this.context.clearRect(x, y, im.width, im.height);\n            this.context.drawImage(im, x, y);\n        }\n    }\n\n    drawLineSegment (x1: number, y1: number, x2: number, y2: number): void {\n        return;\n        /*\n        // todo\n        lastInput.x = x2;\n        lastInput.y = y2;\n        lastInput.pressure = 1;\n\n        if (isDrawing || x1 === undefined) {\n            return;\n        }\n\n        let angle = BB.pointsToAngleDeg({x:x1, y:y1}, {x:x2, y:y2});\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\n        let eX = (x2 - x1) / mouseDist;\n        let eY = (y2 - y1) / mouseDist;\n        let loopDist;\n        let bdist = settingSize * settingSpacing;\n        lineToolLastDot = settingSize * settingSpacing;\n        for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity);\n        }\n\n\n        let historyEntry = {\n            tool: [\"brush\", \"SmudgeBrush\"],\n            actions: []\n        };\n        // todo\n        history.add(historyEntry);*/\n    }\n\n    getIsDrawing (): boolean {\n        return this.isDrawing;\n    }\n\n    setColor (c: IRGB): void {\n        if (this.settingColor.r === c.r && this.settingColor.g === c.g && this.settingColor.b === c.b) {\n            return;\n        }\n        this.settingColor = {r: c.r, g: c.g, b: c.b};\n        this.settingColorStr = BB.ColorConverter.toRgbStr(this.settingColor);\n    }\n\n    setContext (c: CanvasRenderingContext2D): void {\n        this.context = c;\n    }\n\n    setHistory (h: KlHistoryInterface): void {\n        this.history = h;\n    }\n\n    setSize (s: number): void {\n        this.settingSize = s;\n    }\n\n    setOpacity (o: number): void {\n        this.settingOpacity = o;\n    }\n\n    setSpacing (s: number): void {\n        this.settingSpacing = s;\n    }\n\n    sizePressure (b: boolean): void {\n        this.settingHasSizePressure = !!b;\n    }\n\n    opacityPressure (b: boolean): void {\n        this.settingHasOpacityPressure = !!b;\n    }\n\n    setLockAlpha (b: boolean): void {\n        this.settingLockLayerAlpha = !!b;\n    }\n\n    getSpacing (): number {\n        return this.settingSpacing;\n    }\n\n    getSize (): number {\n        return this.settingSize;\n    }\n\n    getOpacity (): number {\n        return this.settingOpacity;\n    }\n\n    getLockAlpha (): boolean {\n        return this.settingLockLayerAlpha;\n    }\n\n}\n","import {PenBrush} from './pen-brush';\nimport {BlendBrush} from './blend-brush';\nimport {SketchyBrush} from './sketchy-brush';\nimport {PixelBrush} from './pixel-brush';\nimport {EraserBrush} from './eraser-brush';\nimport {SmudgeBrush} from './smudge-brush';\nimport {ChemyBrush} from './chemy-brush';\n\nexport const brushes = {\n    PenBrush,\n    BlendBrush,\n    SketchyBrush,\n    PixelBrush,\n    ChemyBrush,\n    SmudgeBrush,\n    EraserBrush,\n}","import {BB} from '../../bb/bb';\nimport {alphaImArr} from './brushes-common';\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\nimport {KL} from '../kl';\n\n\nexport function PenBrush() {\n\n    let context;\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\n    let historyEntry: IHistoryEntry;\n\n    let settingColor, settingSize = 2, settingSpacing = 0.8489, settingOpacity = 1;\n    let settingColorStr;\n    let settingHasSizePressure = true, settingHasOpacityPressure = false;\n    let settingLockLayerAlpha = false;\n    let ALPHA_CIRCLE = 0, ALPHA_CHALK = 1, ALPHA_CAL = 2, ALPHA_SQUARE = 3;\n    let settingAlphaId = ALPHA_CIRCLE;\n\n    let lineToolLastDot;\n    let lastInput = {x: 0, y: 0, pressure: 0};\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\n\n    let isDrawing = false;\n    let alphaOpacityArr = [1, 0.9, 1, 1];\n\n    //mipmapping\n    let alphaCanvas128 = document.createElement(\"canvas\");\n    alphaCanvas128.width = 128;\n    alphaCanvas128.height = 128;\n    let alphaCanvas64 = document.createElement(\"canvas\");\n    alphaCanvas64.width = 64;\n    alphaCanvas64.height = 64;\n    let alphaCanvas32 = document.createElement(\"canvas\");\n    alphaCanvas32.width = 32;\n    alphaCanvas32.height = 32;\n\n    let bezierLine = null;\n\n    let twoPI = Math.PI * 2;\n\n    function updateAlphaCanvas() {\n        if (settingAlphaId === ALPHA_CIRCLE || settingAlphaId === ALPHA_SQUARE) {\n            return;\n        }\n\n        let instructionArr = [\n            [alphaCanvas128, 128],\n            [alphaCanvas64, 64],\n            [alphaCanvas32, 32]\n        ];\n\n        let ctx;\n\n        for (let i = 0; i < instructionArr.length; i++) {\n            ctx = (instructionArr[i][0] as any).getContext(\"2d\");\n\n            ctx.save();\n            ctx.clearRect(0, 0, instructionArr[i][1], instructionArr[i][1]);\n\n            ctx.fillStyle = \"rgba(\" + settingColor.r + \", \" + settingColor.g + \", \" + settingColor.b + \", \" + alphaOpacityArr[settingAlphaId] + \")\";\n            ctx.fillRect(0, 0, instructionArr[i][1], instructionArr[i][1]);\n\n            ctx.globalCompositeOperation = \"destination-in\";\n            ctx.imageSmoothingQuality = 'high';\n            ctx.drawImage(alphaImArr[settingAlphaId], 0, 0, instructionArr[i][1], instructionArr[i][1]);\n\n            ctx.restore();\n        }\n    }\n\n    /**\n     *\n     *\n     * @param x\n     * @param y\n     * @param size\n     * @param opacity\n     * @param angle\n     * @param before - [x, y, size, opacity, angle] the drawDot call before\n     */\n    function drawDot(x, y, size, opacity, angle?, before?) {\n        if (size <= 0) {\n            return;\n        }\n\n        if (settingLockLayerAlpha) {\n            context.globalCompositeOperation = \"source-atop\";\n        }\n\n        if (!before || before[3] !== opacity) {\n            context.globalAlpha = opacity;\n        }\n\n        if (!before && (settingAlphaId === ALPHA_CIRCLE || settingAlphaId === ALPHA_SQUARE)) {\n            context.fillStyle = settingColorStr;\n        }\n\n        if (settingAlphaId === ALPHA_CIRCLE) {\n            context.beginPath();\n            context.arc(x, y, size, 0, twoPI);\n            context.closePath();\n            context.fill();\n\n        } else if (settingAlphaId === ALPHA_SQUARE) {\n            if (angle !== undefined) {\n                context.save();\n                context.translate(x, y);\n                context.rotate(angle / 180 * Math.PI);\n                context.fillRect(-size, -size, size * 2, size * 2);\n                context.restore();\n            }\n\n        } else { // other brush alphas\n            context.save();\n            context.translate(x, y);\n            let targetMipmap = alphaCanvas128;\n            if (size <= 32 && size > 16) {\n                targetMipmap = alphaCanvas64;\n            } else if (size <= 16) {\n                targetMipmap = alphaCanvas32;\n            }\n            context.scale(size, size);\n            if (settingAlphaId === ALPHA_CHALK) {\n                context.rotate(((x + y) * 53123) % twoPI); // without mod it sometimes looks different\n            }\n            context.drawImage(targetMipmap, -1, -1, 2, 2);\n\n            context.restore();\n        }\n    }\n\n    function continueLine(x, y, size, pressure) {\n        if (bezierLine === null) {\n            bezierLine = new BB.BezierLine();\n            bezierLine.add(lastInput.x, lastInput.y, 0, function(){});\n        }\n\n        let drawArr = []; //draw instructions. will be all drawn at once\n\n        function dotCallback(val) {\n            let localPressure = BB.mix(lastInput2.pressure, pressure, val.t);\n            let localOpacity = settingOpacity * (settingHasOpacityPressure ? (localPressure * localPressure) : 1);\n            let localSize = Math.max(0.1, settingSize * (settingHasSizePressure ? localPressure : 1));\n            drawArr.push([val.x, val.y, localSize, localOpacity, val.angle]);\n        }\n\n        let localSpacing = size * settingSpacing;\n        if (x === null) {\n            bezierLine.addFinal(localSpacing, dotCallback);\n        } else {\n            bezierLine.add(x, y, localSpacing, dotCallback);\n        }\n\n        // execute draw instructions\n        context.save();\n        let before;\n        for (let i = 0; i < drawArr.length; i++) {\n            let item = drawArr[i];\n            drawDot(item[0], item[1], item[2], item[3], item[4], before);\n            before = item;\n        }\n        context.restore();\n    }\n\n    //------------------ interface ---------------------------------------------------\n\n\n    this.startLine = function (x, y, p) {\n        historyEntry = {\n            tool: [\"brush\", \"PenBrush\"],\n            actions: []\n        };\n        historyEntry.actions.push({\n            action: \"opacityPressure\",\n            params: [settingHasOpacityPressure]\n        });\n        historyEntry.actions.push({\n            action: \"sizePressure\",\n            params: [settingHasSizePressure]\n        });\n        historyEntry.actions.push({\n            action: \"setSize\",\n            params: [settingSize]\n        });\n        historyEntry.actions.push({\n            action: \"setSpacing\",\n            params: [settingSpacing]\n        });\n        historyEntry.actions.push({\n            action: \"setOpacity\",\n            params: [settingOpacity]\n        });\n        historyEntry.actions.push({\n            action: \"setColor\",\n            params: [settingColor]\n        });\n        historyEntry.actions.push({\n            action: \"setAlpha\",\n            params: [settingAlphaId]\n        });\n        historyEntry.actions.push({\n            action: \"setLockAlpha\",\n            params: [settingLockLayerAlpha]\n        });\n\n        p = BB.clamp(p, 0, 1);\n        let localOpacity = settingHasOpacityPressure ? (settingOpacity * p * p) : settingOpacity;\n        let localSize = settingHasSizePressure ? Math.max(0.1, p * settingSize) : Math.max(0.1, settingSize);\n\n        isDrawing = true;\n        context.save();\n        drawDot(x, y, localSize, localOpacity);\n        context.restore();\n\n        lineToolLastDot = localSize * settingSpacing;\n        lastInput.x = x;\n        lastInput.y = y;\n        lastInput.pressure = p;\n        lastInput2.pressure = p;\n\n        historyEntry.actions.push({\n            action: \"startLine\",\n            params: [x, y, p]\n        });\n    };\n\n    this.goLine = function (x, y, p) {\n        if (!isDrawing) {\n            return;\n        }\n        historyEntry.actions.push({\n            action: \"goLine\",\n            params: [x, y, p]\n        });\n\n        let pressure = BB.clamp(p, 0, 1);\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\n\n        context.save();\n        continueLine(x, y, localSize, lastInput.pressure);\n\n        /*context.fillStyle = 'red';\n        context.fillRect(Math.floor(x), Math.floor(y - 10), 1, 20);\n        context.fillRect(Math.floor(x - 10), Math.floor(y), 20, 1);*/\n\n        context.restore();\n\n        lastInput.x = x;\n        lastInput.y = y;\n        lastInput2.pressure = lastInput.pressure;\n        lastInput.pressure = pressure;\n    };\n\n    this.endLine = function (x, y) {\n\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\n        context.save();\n        continueLine(null, null, localSize, lastInput.pressure);\n        context.restore();\n\n        isDrawing = false;\n\n        bezierLine = null;\n\n        if (historyEntry) {\n            historyEntry.actions.push({\n                action: \"endLine\",\n                params: [x, y]\n            });\n            history.push(historyEntry);\n            historyEntry = undefined;\n        }\n    };\n    //cheap n' ugly\n    this.drawLineSegment = function (x1, y1, x2, y2) {\n        lastInput.x = x2;\n        lastInput.y = y2;\n        lastInput.pressure = 1;\n\n        if (isDrawing || x1 === undefined) {\n            return;\n        }\n\n        let angle = BB.pointsToAngleDeg({x:x1, y:y1}, {x:x2, y:y2});\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\n        let eX = (x2 - x1) / mouseDist;\n        let eY = (y2 - y1) / mouseDist;\n        let loopDist;\n        let bdist = settingSize * settingSpacing;\n        lineToolLastDot = settingSize * settingSpacing;\n        for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity, angle);\n        }\n\n\n        let historyEntry = {\n            tool: [\"brush\", \"PenBrush\"],\n            actions: []\n        };\n        historyEntry.actions.push({\n            action: \"opacityPressure\",\n            params: [settingHasOpacityPressure]\n        });\n        historyEntry.actions.push({\n            action: \"sizePressure\",\n            params: [settingHasSizePressure]\n        });\n        historyEntry.actions.push({\n            action: \"setSize\",\n            params: [settingSize]\n        });\n        historyEntry.actions.push({\n            action: \"setSpacing\",\n            params: [settingSpacing]\n        });\n        historyEntry.actions.push({\n            action: \"setOpacity\",\n            params: [settingOpacity]\n        });\n        historyEntry.actions.push({\n            action: \"setColor\",\n            params: [settingColor]\n        });\n        historyEntry.actions.push({\n            action: \"setAlpha\",\n            params: [settingAlphaId]\n        });\n        historyEntry.actions.push({\n            action: \"setLockAlpha\",\n            params: [settingLockLayerAlpha]\n        });\n\n        historyEntry.actions.push({\n            action: \"drawLineSegment\",\n            params: [x1, y1, x2, y2]\n        });\n        history.push(historyEntry);\n    };\n\n    //IS\n    this.isDrawing = function () {\n        return isDrawing;\n    };\n    //SET\n    this.setAlpha = function (a) {\n        if (settingAlphaId === a) {\n            return;\n        }\n        settingAlphaId = a;\n        updateAlphaCanvas();\n    };\n    this.setColor = function (c) {\n        if (settingColor === c) {\n            return;\n        }\n        settingColor = {r: c.r, g: c.g, b: c.b};\n        settingColorStr = \"rgb(\" + settingColor.r + \",\" + settingColor.g + \",\" + settingColor.b + \")\";\n        updateAlphaCanvas();\n    };\n    this.setContext = function (c) {\n        context = c;\n    };\n    this.setHistory = function (l: KlHistoryInterface) {\n        history = l;\n    };\n    this.setSize = function (s) {\n        settingSize = s;\n    };\n    this.setOpacity = function (o) {\n        settingOpacity = o;\n    };\n    this.setSpacing = function (s) {\n        settingSpacing = s;\n    };\n    this.sizePressure = function (b) {\n        settingHasSizePressure = b;\n    };\n    this.opacityPressure = function (b) {\n        settingHasOpacityPressure = b;\n    };\n    this.setLockAlpha = function (b) {\n        settingLockLayerAlpha = b;\n    };\n    //GET\n    this.getSpacing = function () {\n        return settingSpacing;\n    };\n    this.getSize = function () {\n        return settingSize;\n    };\n    this.getOpacity = function () {\n        return settingOpacity;\n    };\n    this.getLockAlpha = function (b) {\n        return settingLockLayerAlpha;\n    };\n}","import {BB} from '../../bb/bb';\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\nimport {KL} from '../kl';\n\nexport function PixelBrush() {\n\n    let context;\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\n    let historyEntry: IHistoryEntry;\n\n    let settingColor, settingSize = 0.5, settingSpacing = 0.9, settingOpacity = 1;\n    let settingColorStr;\n    let settingHasSizePressure = true, settingHasOpacityPressure = false;\n    let settingLockLayerAlpha = false;\n    let settingIsEraser = false;\n    let settingUseDither = true;\n\n    let lineToolLastDot;\n    let lastInput = {x: 0, y: 0, pressure: 0};\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\n\n    let isDrawing = false;\n    let bezierLine = null;\n    let twoPI = Math.PI * 2;\n\n\n    let ditherCanvas = BB.canvas(4, 4);\n    let ditherCtx = ditherCanvas.getContext('2d');\n    let ditherPattern;\n    let ditherArr = [\n        [3, 2],\n        [1, 0],\n        [3, 0],\n        [1, 2],\n        [2, 1],\n        [0, 3],\n        [0, 1],\n        [2, 3],\n\n        [2, 0],\n        [0, 2],\n        [0, 0],\n        [2, 2],\n        [1, 1],\n        [3, 3],\n        [3, 1],\n        [1, 3]\n    ];\n\n    function updateDither() {\n        ditherCtx.clearRect(0, 0, 4, 4);\n        ditherCtx.fillStyle = settingIsEraser ? '#fff' : settingColorStr;\n        for (let i = 0; i < Math.max(1, Math.round(settingOpacity * ditherArr.length)); i++) {\n            ditherCtx.fillRect(ditherArr[i][0], ditherArr[i][1], 1, 1);\n        }\n        ditherPattern = context.createPattern(ditherCanvas, 'repeat');\n    }\n\n\n    /**\n     * Tests p1->p2 or p3->p4 deviate in their direction more than max, compared to p1->p4\n     * @param p1\n     * @param p2\n     * @param p3\n     * @param p4\n     * @param maxAngleRad\n     */\n    function cubicCurveOverThreshold(p1, p2, p3, p4, max) {\n        let d = BB.Vec2.nor({\n            x: p4.x - p1.x,\n            y: p4.y - p1.y\n        });\n        let d2 = BB.Vec2.nor({\n            x: p2.x - p1.x,\n            y: p2.y - p1.y\n        });\n        let d3 = BB.Vec2.nor({\n            x: p4.x - p3.x,\n            y: p4.y - p3.y\n        });\n        let a2 = Math.abs(BB.Vec2.angle(d, d2) % Math.PI) / Math.PI * 180;\n        let a3 = Math.abs(BB.Vec2.angle(d, d3) % Math.PI) / Math.PI * 180;\n\n        return Math.max(BB.Vec2.dist(d, d2), BB.Vec2.dist(d, d3)) > max;\n    }\n\n    //bresenheim line drawing\n    function plotLine(x0, y0, x1, y1, skipFirst) {\n        context.save();\n\n        if (settingIsEraser) {\n            context.fillStyle = settingUseDither ? ditherPattern : '#fff';\n            if (settingLockLayerAlpha) {\n                context.globalCompositeOperation = \"source-atop\";\n            } else {\n                context.globalCompositeOperation = \"destination-out\";\n            }\n        } else {\n            context.fillStyle = settingUseDither ? ditherPattern : settingColorStr;\n            if (settingLockLayerAlpha) {\n                context.globalCompositeOperation = \"source-atop\";\n            }\n        }\n        context.globalAlpha = settingUseDither ? 1 : settingOpacity;\n\n        x0 = Math.floor(x0);\n        y0 = Math.floor(y0);\n        x1 = Math.floor(x1);\n        y1 = Math.floor(y1);\n\n        let dX = Math.abs(x1 - x0);\n        let sX = x0 < x1 ? 1 : -1;\n        let dY = -Math.abs(y1 - y0);\n        let sY = y0 < y1 ? 1 : -1;\n        let err = dX + dY;\n        while (true) {\n            if (skipFirst) {\n                skipFirst = false;\n            } else {\n                context.fillRect(x0, y0, 1, 1);\n            }\n            if (x0 === x1 && y0 === y1) {\n                break;\n            }\n            let e2 = 2 * err;\n            if (e2 >= dY) {\n                err += dY;\n                x0 += sX;\n            }\n            if (e2 <= dX) {\n                err += dX;\n                y0 += sY;\n            }\n        }\n\n        context.restore();\n    }\n\n    function plotCubicBezierLine(p1, p2, p3, p4) {\n\n        let isOverThreshold = cubicCurveOverThreshold(p1, p2, p3, p4, 0.1);\n\n        p1.x = Math.floor(p1.x);\n        p1.y = Math.floor(p1.y);\n        p4.x = Math.floor(p4.x);\n        p4.y = Math.floor(p4.y);\n\n        let dist = BB.dist(p1.x, p1.y, p4.x, p4.y);\n        if (!isOverThreshold || dist < 7) {\n            plotLine(p1.x, p1.y, p4.x, p4.y, true);\n            return;\n        }\n\n        let n = Math.max(2, Math.round(dist / 4));\n        let pointArr = [];\n        for (let i = 0; i <= n; i++) {\n            let t = i / n;\n            let a = Math.pow(1 - t, 3);\n            let b = 3 * t * Math.pow(1 - t, 2);\n            let c = 3 * Math.pow(t, 2) * (1 - t);\n            let d = Math.pow(t, 3);\n            pointArr.push({\n                x: a * p1.x + b * p2.x + c * p3.x + d * p4.x,\n                y: a * p1.y + b * p2.y + c * p3.y + d * p4.y\n            });\n        }\n\n        for (let i = 0; i < n; i++) {\n            plotLine(\n                Math.round(pointArr[i].x),\n                Math.round(pointArr[i].y),\n                Math.round(pointArr[i + 1].x),\n                Math.round(pointArr[i + 1].y),\n                true\n            );\n        }\n    }\n\n    function drawDot(x, y, size, opacity, angle?) {\n        context.save();\n        if (settingIsEraser) {\n            context.fillStyle = settingUseDither ? ditherPattern : '#fff';\n            if (settingLockLayerAlpha) {\n                context.globalCompositeOperation = \"source-atop\";\n            } else {\n                context.globalCompositeOperation = \"destination-out\";\n            }\n        } else {\n            context.fillStyle = settingUseDither ? ditherPattern : settingColorStr;\n            if (settingLockLayerAlpha) {\n                context.globalCompositeOperation = \"source-atop\";\n            }\n        }\n        context.globalAlpha = settingUseDither ? 1 : opacity;\n        context.fillRect(\n            Math.round(x + -size),\n            Math.round(y + -size),\n            Math.round(size * 2),\n            Math.round(size * 2)\n        );\n        context.restore();\n    }\n\n\n    function continueLine(x, y, size, pressure) {\n        if (bezierLine === null) {\n            bezierLine = new BB.BezierLine();\n            bezierLine.add(lastInput.x, lastInput.y, 0, function () {\n            });\n        }\n\n        context.save();\n\n        function dotCallback(val) {\n            let localPressure = BB.mix(lastInput2.pressure, pressure, val.t);\n            let localOpacity = settingOpacity * (settingHasOpacityPressure ? (localPressure * localPressure) : 1);\n            let localSize = Math.max(0.5, settingSize * (settingHasSizePressure ? localPressure : 1));\n            drawDot(val.x, val.y, localSize, localOpacity, val.angle);\n        }\n\n        function controlCallback(controlObj) {\n            plotCubicBezierLine(controlObj.p1, controlObj.p2, controlObj.p3, controlObj.p4);\n        }\n\n        if (Math.round(settingSize * 2) === 1) {\n            if (x === null) {\n                bezierLine.addFinal(4, null, controlCallback);\n            } else {\n                bezierLine.add(x, y, 4, null, controlCallback);\n            }\n\n        } else {\n            let localSpacing = size * settingSpacing;\n\n            if (x === null) {\n                bezierLine.addFinal(localSpacing, dotCallback);\n            } else {\n                bezierLine.add(x, y, localSpacing, dotCallback);\n            }\n        }\n\n        context.restore();\n    }\n\n    //------------------ interface ---------------------------------------------------\n\n\n    this.startLine = function (x, y, p) {\n        historyEntry = {\n            tool: [\"brush\", \"PixelBrush\"],\n            actions: []\n        };\n        historyEntry.actions.push({\n            action: \"sizePressure\",\n            params: [settingHasSizePressure]\n        });\n        historyEntry.actions.push({\n            action: \"setSize\",\n            params: [settingSize]\n        });\n        historyEntry.actions.push({\n            action: \"setSpacing\",\n            params: [settingSpacing]\n        });\n        historyEntry.actions.push({\n            action: \"setOpacity\",\n            params: [settingOpacity]\n        });\n        historyEntry.actions.push({\n            action: \"setColor\",\n            params: [settingColor]\n        });\n        historyEntry.actions.push({\n            action: \"setLockAlpha\",\n            params: [settingLockLayerAlpha]\n        });\n        historyEntry.actions.push({\n            action: \"setIsEraser\",\n            params: [settingIsEraser]\n        });\n        historyEntry.actions.push({\n            action: \"setUseDither\",\n            params: [settingUseDither]\n        });\n\n        if (settingUseDither) {\n            updateDither();\n        }\n\n        p = Math.max(0, Math.min(1, p));\n        let localOpacity = settingHasOpacityPressure ? (settingOpacity * p * p) : settingOpacity;\n        let localSize = settingHasSizePressure ? Math.max(0.5, p * settingSize) : Math.max(0.5, settingSize);\n\n        isDrawing = true;\n        drawDot(x, y, localSize, localOpacity);\n        lineToolLastDot = localSize * settingSpacing;\n        lastInput.x = x;\n        lastInput.y = y;\n        lastInput.pressure = p;\n        lastInput2 = BB.copyObj(lastInput);\n\n        historyEntry.actions.push({\n            action: \"startLine\",\n            params: [x, y, p]\n        });\n    };\n\n    this.goLine = function (x, y, p) {\n        if (!isDrawing) {\n            return;\n        }\n        historyEntry.actions.push({\n            action: \"goLine\",\n            params: [x, y, p]\n        });\n\n        //debug\n        //drawDot(x, y, 1, 0.5);\n\n        let pressure = BB.clamp(p, 0, 1);\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\n\n        continueLine(x, y, localSize, lastInput.pressure);\n\n        lastInput2 = BB.copyObj(lastInput);\n        lastInput.x = x;\n        lastInput.y = y;\n        lastInput.pressure = pressure;\n    };\n\n    this.endLine = function (x, y) {\n\n        let localSize = settingHasSizePressure ? Math.max(0.1, lastInput.pressure * settingSize) : Math.max(0.1, settingSize);\n        continueLine(null, null, localSize, lastInput.pressure);\n\n        //debug\n        //drawDot(lastInput.x, lastInput.y, 3, 1);\n        //drawDot(x, y, 10, 0.1);\n\n        isDrawing = false;\n\n        bezierLine = null;\n\n        if (historyEntry) {\n            historyEntry.actions.push({\n                action: \"endLine\",\n                params: [x, y]\n            });\n            history.push(historyEntry);\n            historyEntry = undefined;\n        }\n    };\n    //cheap n' ugly\n    this.drawLineSegment = function (x1, y1, x2, y2) {\n        lastInput.x = x2;\n        lastInput.y = y2;\n        lastInput.pressure = 1;\n\n        if (isDrawing || x1 === undefined) {\n            return;\n        }\n\n        if (settingUseDither) {\n            updateDither();\n        }\n\n        if (Math.round(settingSize * 2) === 1) {\n            plotLine(x1, y1, x2, y2, true);\n        } else {\n            let angle = BB.pointsToAngleDeg({x: x1, y: y1}, {x: x2, y: y2});\n            let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\n            let eX = (x2 - x1) / mouseDist;\n            let eY = (y2 - y1) / mouseDist;\n            let loopDist;\n            let bdist = settingSize * settingSpacing;\n            lineToolLastDot = settingSize * settingSpacing;\n            for (loopDist = lineToolLastDot; loopDist <= mouseDist; loopDist += bdist) {\n                drawDot(x1 + eX * loopDist, y1 + eY * loopDist, settingSize, settingOpacity, angle);\n            }\n        }\n\n        let historyEntry = {\n            tool: [\"brush\", \"PixelBrush\"],\n            actions: []\n        };\n        historyEntry.actions.push({\n            action: \"sizePressure\",\n            params: [settingHasSizePressure]\n        });\n        historyEntry.actions.push({\n            action: \"setSize\",\n            params: [settingSize]\n        });\n        historyEntry.actions.push({\n            action: \"setSpacing\",\n            params: [settingSpacing]\n        });\n        historyEntry.actions.push({\n            action: \"setOpacity\",\n            params: [settingOpacity]\n        });\n        historyEntry.actions.push({\n            action: \"setColor\",\n            params: [settingColor]\n        });\n        historyEntry.actions.push({\n            action: \"setLockAlpha\",\n            params: [settingLockLayerAlpha]\n        });\n        historyEntry.actions.push({\n            action: \"setIsEraser\",\n            params: [settingIsEraser]\n        });\n        historyEntry.actions.push({\n            action: \"setUseDither\",\n            params: [settingUseDither]\n        });\n\n        historyEntry.actions.push({\n            action: \"drawLineSegment\",\n            params: [x1, y1, x2, y2]\n        });\n        history.push(historyEntry);\n    };\n\n    //IS\n    this.isDrawing = function () {\n        return isDrawing;\n    };\n    //SET\n    this.setColor = function (c) {\n        if (settingColor === c) {\n            return;\n        }\n        settingColor = c;\n        settingColorStr = \"rgb(\" + settingColor.r + \",\" + settingColor.g + \",\" + settingColor.b + \")\";\n    };\n    this.setContext = function (c) {\n        context = c;\n    };\n    this.setHistory = function (l: KlHistoryInterface) {\n        history = l;\n    };\n    this.setSize = function (s) {\n        settingSize = s;\n    };\n    this.setOpacity = function (o) {\n        settingOpacity = o;\n    };\n    this.setSpacing = function (s) {\n        settingSpacing = s;\n    };\n    this.sizePressure = function (b) {\n        settingHasSizePressure = b;\n    };\n    this.opacityPressure = function (b) {\n        settingHasOpacityPressure = b;\n    };\n    this.setLockAlpha = function (b) {\n        settingLockLayerAlpha = b;\n    };\n    this.setIsEraser = function (b) {\n        settingIsEraser = !!b;\n    };\n    this.setUseDither = function (b) {\n        settingUseDither = !!b;\n    };\n    //GET\n    this.getSpacing = function () {\n        return settingSpacing;\n    };\n    this.getSize = function () {\n        return settingSize;\n    };\n    this.getOpacity = function () {\n        return settingOpacity;\n    };\n    this.getLockAlpha = function () {\n        return settingLockLayerAlpha;\n    };\n    this.getIsEraser = function () {\n        return settingIsEraser;\n    };\n    this.getUseDither = function () {\n        return settingUseDither;\n    };\n}","import {BB} from '../../bb/bb';\nimport {IRGB} from '../kl.types';\nimport {IBounds} from '../../bb/bb.types';\nimport {KlHistoryInterface} from '../history/kl-history';\n\ntype TChemyMode = 'fill' | 'stroke';\n\nexport class ChemyBrush {\n\n    private context: CanvasRenderingContext2D;\n    private settingColor: IRGB;\n    private settingSize: number = 0.25; // radius - 0.5 - 99999\n    private settingOpacity: number = 1; // 0-1\n    private settingLockLayerAlpha: boolean = false;\n    private settingIsEraser: boolean = false;\n    private settingMode: TChemyMode = 'fill';\n    private settingDistort: number = 0; // 0 - 1\n    private settingXSymmetry: boolean = false;\n    private settingYSymmetry: boolean = false;\n    private settingGradient: boolean = false;\n\n    private isDrawing: boolean = false;\n\n    private history: KlHistoryInterface;\n\n    private copyCanvas: HTMLCanvasElement;\n    private path: {x: number, y: number}[];\n    private minY: number;\n    private maxY: number;\n    private completeRedrawBounds: IBounds;\n\n    updateCompleteRedrawBounds (x, y): void {\n        let bounds = { x1: x, y1: y, x2: x, y2: y};\n        if (this.settingXSymmetry) {\n            bounds = BB.updateBounds(\n                bounds,\n                {\n                    x1: -x + this.copyCanvas.width,\n                    y1: y,\n                    x2: -x + this.copyCanvas.width,\n                    y2: y,\n                }\n                );\n        }\n        if (this.settingYSymmetry) {\n            bounds = BB.updateBounds(\n                bounds,\n                {\n                    x1: x,\n                    y1: -y + this.copyCanvas.height,\n                    x2: x,\n                    y2: -y + this.copyCanvas.height,\n                }\n            );\n        }\n        const buffer = this.settingMode === 'stroke' ? this.settingSize + 1 : 1;\n        bounds.x1 = Math.floor(bounds.x1 - buffer);\n        bounds.y1 = Math.floor(bounds.y1 - buffer);\n        bounds.x2 = Math.ceil(bounds.x2 + buffer);\n        bounds.y2 = Math.ceil(bounds.y2 + buffer);\n\n        this.completeRedrawBounds = BB.updateBounds(this.completeRedrawBounds, bounds);\n    }\n\n    private drawShape (): void {\n        this.context.save();\n        this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);\n        this.context.drawImage(this.copyCanvas, 0, 0);\n\n        let color = {...this.settingColor};\n        if (this.settingIsEraser) {\n            color.r = 255;\n            color.g = 255;\n            color.b = 255;\n            if (this.settingLockLayerAlpha) {\n                this.context.globalCompositeOperation = \"source-atop\";\n            } else {\n                this.context.globalCompositeOperation = \"destination-out\";\n            }\n        } else {\n            if (this.settingLockLayerAlpha) {\n                this.context.globalCompositeOperation = \"source-atop\";\n            }\n        }\n\n        if (this.path) {\n\n            // path\n            const path = new Path2D();\n            this.path.forEach((item, index) => {\n                if (index === 0) {\n                    path.moveTo(item.x, item.y);\n                } else {\n                    path.lineTo(item.x, item.y);\n                }\n            });\n\n            let style: string | CanvasGradient = BB.ColorConverter.toRgbaStr({\n                r: color.r,\n                g: color.g,\n                b: color.b,\n                a: this.settingOpacity,\n            });\n            if (this.settingGradient) {\n                const startAtTop = this.path[0].x > this.path[this.path.length - 1].x;\n                const gradient = this.context.createLinearGradient(\n                    0, startAtTop ? this.minY : this.maxY,\n                    0, startAtTop ? this.maxY : this.minY,\n                );\n                gradient.addColorStop(\n                    0,\n                    BB.ColorConverter.toRgbaStr({\n                        r: color.r,\n                        g: color.g,\n                        b: color.b,\n                        a: this.settingOpacity,\n                    })\n                );\n                gradient.addColorStop(\n                    1,\n                    BB.ColorConverter.toRgbaStr({\n                        r: color.r,\n                        g: color.g,\n                        b: color.b,\n                        a: 0,\n                    })\n                );\n                style = gradient;\n            }\n\n            // setup params\n            if (this.settingMode === 'fill') {\n                this.context.fillStyle = style;\n\n            } else {\n                this.context.lineWidth = this.settingSize * 2;\n                this.context.lineJoin = 'bevel';\n                this.context.strokeStyle = style;\n            }\n\n            // draw\n            const draw = () => {\n                if (this.settingMode === 'fill') {\n                    this.context.fill(path);\n                } else {\n                    this.context.stroke(path);\n                }\n            };\n\n            draw();\n            if (this.settingXSymmetry) {\n                this.context.save();\n                this.context.translate(this.context.canvas.width / 2, 0);\n                this.context.scale(-1, 1);\n                this.context.translate(-this.context.canvas.width / 2, 0);\n                draw();\n                this.context.restore();\n            }\n            if (this.settingYSymmetry) {\n                this.context.save();\n                this.context.translate(0, this.context.canvas.height / 2);\n                this.context.scale(1, -1);\n                this.context.translate(0, -this.context.canvas.height / 2);\n                draw();\n                this.context.restore();\n                if (this.settingXSymmetry) {\n                    this.context.save();\n                    this.context.translate(this.context.canvas.width / 2, this.context.canvas.height / 2);\n                    this.context.scale(-1, -1);\n                    this.context.translate(-this.context.canvas.width / 2, -this.context.canvas.height / 2);\n                    draw();\n                    this.context.restore();\n                }\n            }\n        }\n\n        this.context.restore();\n    }\n\n    // --- public ----\n    constructor () {\n    }\n\n    setHistory (h: KlHistoryInterface): void {\n        this.history = h;\n    }\n\n    getSize (): number {\n        return this.settingMode === 'stroke' ? this.settingSize : 0;\n    }\n\n    setSize (s: number): void {\n        this.settingSize = s;\n    }\n\n    getOpacity (): number {\n        return this.settingOpacity;\n    }\n\n    setOpacity (o: number): void {\n        this.settingOpacity = o;\n    }\n\n    setColor (c: IRGB): void {\n        this.settingColor = BB.copyObj(c);\n    }\n\n    setContext (c: CanvasRenderingContext2D) {\n        this.context = c;\n    }\n\n    setMode (mode: TChemyMode): void {\n        this.settingMode = mode;\n    }\n\n    getMode (): TChemyMode {\n        return this.settingMode;\n    }\n\n    setDistort (distort: number): void {\n        this.settingDistort = BB.clamp(distort, 0, 1);\n    }\n\n    getDistort (): number {\n        return this.settingDistort;\n    }\n\n    setXSymmetry (b: boolean): void {\n        this.settingXSymmetry = !!b;\n    }\n\n    getXSymmetry (): boolean {\n        return this.settingXSymmetry;\n    }\n\n    setYSymmetry (b: boolean): void {\n        this.settingYSymmetry = !!b;\n    }\n\n    getYSymmetry (): boolean {\n        return this.settingYSymmetry;\n    }\n\n    setGradient (b: boolean): void {\n        this.settingGradient = !!b;\n    }\n\n    getGradient (): boolean {\n        return this.settingGradient;\n    }\n\n    getLockAlpha (): boolean {\n        return this.settingLockLayerAlpha;\n    }\n\n    setLockAlpha (b: boolean): void {\n        this.settingLockLayerAlpha = !!b;\n    }\n\n    getIsEraser (): boolean {\n        return this.settingIsEraser;\n    }\n\n    setIsEraser (b: boolean): void {\n        this.settingIsEraser = !!b;\n    }\n\n    getIsDrawing (): boolean {\n        return this.isDrawing;\n    }\n\n    startLine (x: number, y: number): void {\n        this.isDrawing = true;\n        this.path = [{x, y}];\n        this.minY = y;\n        this.maxY = y;\n        this.copyCanvas = BB.canvas(this.context.canvas.width, this.context.canvas.height);\n        this.copyCanvas.getContext('2d').drawImage(this.context.canvas, 0, 0);\n        this.completeRedrawBounds = null;\n        this.updateCompleteRedrawBounds(x, y);\n    }\n\n    goLine (x: number, y: number): void {\n        if (!this.isDrawing) {\n            return;\n        }\n\n        let pos = { x, y };\n        if (this.settingDistort > 0) {\n            pos.x += (Math.random() - 0.5) * this.settingDistort * 80;\n            pos.y += (Math.random() - 0.5) * this.settingDistort * 80;\n        }\n\n        this.minY = Math.min(this.minY, pos.y);\n        this.maxY = Math.max(this.maxY, pos.y);\n        this.path.push(pos);\n        this.updateCompleteRedrawBounds(x, y);\n        this.drawShape();\n    }\n\n    endLine (): void {\n        this.isDrawing = false;\n        this.completeRedrawBounds = BB.boundsInArea(this.completeRedrawBounds, this.copyCanvas.width, this.copyCanvas.height);\n        if (this.path.length > 1 && this.completeRedrawBounds) {\n            const historyCanvas = BB.canvas(\n                this.completeRedrawBounds.x2 - this.completeRedrawBounds.x1 + 1,\n                this.completeRedrawBounds.y2 - this.completeRedrawBounds.y1 + 1\n            );\n            const historyCtx = historyCanvas.getContext('2d');\n            historyCtx.drawImage(this.context.canvas, -this.completeRedrawBounds.x1, -this.completeRedrawBounds.y1);\n\n            this.history.push({\n                tool: [\"brush\", \"ChemyBrush\"],\n                actions: [\n                    {\n                        action: \"drawImage\",\n                        params: [\n                            historyCanvas, // faster than getting image data (measured on 2018 lenovo chromebook)\n                            this.completeRedrawBounds.x1,\n                            this.completeRedrawBounds.y1,\n                        ],\n                    }\n                ]\n            });\n        }\n        this.path = null;\n        this.copyCanvas = null;\n    }\n\n    drawImage (im: HTMLCanvasElement, x: number, y: number): void {\n        this.context.save();\n        this.context.clearRect(x, y, im.width, im.height);\n        this.context.drawImage(im, x, y);\n        this.context.restore();\n    }\n\n    drawLineSegment (x1, y1, x2, y2): void {\n        // might make sense for stroke\n    }\n}\n","import {BB} from '../../bb/bb';\nimport {IHistoryEntry, KlHistoryInterface} from '../history/kl-history';\nimport {KL} from '../kl';\n\nexport function EraserBrush() {\n    let context;\n    let history: KlHistoryInterface = new KL.DecoyKlHistory();\n    let historyEntry: IHistoryEntry;\n\n    let size = 30, spacing = 0.4, opacity = 1;\n    let sizePressure = true, opacityPressure = false;\n    let lastDot, lastInput = {x: 0, y: 0, pressure: 0};\n    let lastInput2 = {x: 0, y: 0, pressure: 0};\n    let started = false;\n\n    let bezierLine;\n    let isBaseLayer = false;\n    let isTransparentBG = false;\n\n    function drawDot(x, y, size, opacity) {\n\n        context.save();\n        if (isBaseLayer) {\n            if (isTransparentBG) {\n                context.globalCompositeOperation = \"destination-out\";\n            } else {\n                context.globalCompositeOperation = \"source-atop\";\n            }\n        } else {\n            context.globalCompositeOperation = \"destination-out\";\n        }\n        let radgrad = context.createRadialGradient(size, size, 0, size, size, size);\n        let sharpness = Math.pow(opacity, 2);\n        sharpness = Math.max(0, Math.min((size - 1) / size, sharpness));\n        let oFac = Math.max(0, Math.min(1, opacity));\n        let localOpacity = 2 * oFac - oFac * oFac;\n        radgrad.addColorStop(sharpness, \"rgba(255, 255, 255, \" + localOpacity + \")\");\n        radgrad.addColorStop(1, \"rgba(255, 255, 255, 0)\");\n        context.fillStyle = radgrad;\n        context.translate(x - size, y - size);\n        context.fillRect(0, 0, size * 2, size * 2);\n        context.restore();\n    }\n\n    function continueLine(x, y, p) {\n        p = Math.max(0, Math.min(1, p));\n        let localPressure;\n        let localOpacity;\n        let localSize = (sizePressure) ? Math.max(0.1, p * size) : Math.max(0.1, size);\n\n        let bdist = Math.max(1, Math.max(0.5, 1 - opacity) * localSize * spacing);\n\n        function bezierCallback(val) {\n            let factor = val.t;\n            localPressure = lastInput2.pressure * (1 - factor) + p * factor;\n            localOpacity = (opacityPressure) ? (opacity * localPressure * localPressure) : opacity;\n            localSize = (sizePressure) ? Math.max(0.1, localPressure * size) : Math.max(0.1, size);\n\n            drawDot(val.x, val.y, localSize, localOpacity);\n        }\n\n        if (x === null) {\n            bezierLine.addFinal(bdist, bezierCallback);\n        } else {\n            bezierLine.add(x, y, bdist, bezierCallback);\n        }\n    }\n\n\n    this.startLine = function (x, y, p) {\n        historyEntry = {\n            tool: [\"brush\", \"EraserBrush\"],\n            actions: []\n        };\n        historyEntry.actions.push({\n            action: \"opacityPressure\",\n            params: [opacityPressure]\n        });\n        historyEntry.actions.push({\n            action: \"sizePressure\",\n            params: [sizePressure]\n        });\n        historyEntry.actions.push({\n            action: \"setSize\",\n            params: [size]\n        });\n        historyEntry.actions.push({\n            action: \"setOpacity\",\n            params: [opacity]\n        });\n        historyEntry.actions.push({\n            action: \"setTransparentBG\",\n            params: [isTransparentBG]\n        });\n\n        isBaseLayer = 0 === context.canvas.index;\n\n        p = Math.max(0, Math.min(1, p));\n        let localOpacity = (opacityPressure) ? (opacity * p * p) : opacity;\n        let localSize = (sizePressure) ? Math.max(0.1, p * size) : Math.max(0.1, size);\n\n        started = true;\n        if (localSize > 1) {\n            drawDot(x, y, localSize, localOpacity);\n        }\n        lastDot = localSize * spacing;\n        lastInput.x = x;\n        lastInput.y = y;\n        lastInput.pressure = p;\n        lastInput2 = BB.copyObj(lastInput);\n\n        bezierLine = new BB.BezierLine();\n        bezierLine.add(x, y, 0, function () {\n        });\n\n        historyEntry.actions.push({\n            action: \"startLine\",\n            params: [x, y, p]\n        });\n    };\n    this.goLine = function (x, y, p) {\n        if (!started) {\n            return;\n        }\n        historyEntry.actions.push({\n            action: \"goLine\",\n            params: [x, y, p]\n        });\n\n        continueLine(x, y, lastInput.pressure);\n\n        lastInput2 = BB.copyObj(lastInput);\n        lastInput.x = x;\n        lastInput.y = y;\n        lastInput.pressure = p;\n    };\n    this.endLine = function () {\n\n        if (bezierLine) {\n            continueLine(null, null, lastInput.pressure);\n        }\n\n        started = false;\n        bezierLine = undefined;\n\n        if (historyEntry) {\n            historyEntry.actions.push({\n                action: \"endLine\",\n                params: []\n            });\n            history.push(historyEntry);\n            historyEntry = undefined;\n        }\n    };\n    //cheap n' ugly\n    this.drawLineSegment = function (x1, y1, x2, y2) {\n\n        isBaseLayer = 0 === context.canvas.index;\n\n        lastInput.x = x2;\n        lastInput.y = y2;\n\n        if (started || x1 === undefined) {\n            return;\n        }\n\n        let mouseDist = Math.sqrt(Math.pow(x2 - x1, 2.0) + Math.pow(y2 - y1, 2.0));\n        let eX = (x2 - x1) / mouseDist;\n        let eY = (y2 - y1) / mouseDist;\n        let loopDist;\n        let bdist = Math.max(1, Math.max(0.5, 1 - opacity) * size * spacing);\n        lastDot = 0;\n        for (loopDist = lastDot; loopDist <= mouseDist; loopDist += bdist) {\n            drawDot(x1 + eX * loopDist, y1 + eY * loopDist, size, opacity);\n        }\n\n\n        let historyEntry = {\n            tool: [\"brush\", \"EraserBrush\"],\n            actions: []\n        };\n        historyEntry.actions.push({\n            action: \"opacityPressure\",\n            params: [opacityPressure]\n        });\n        historyEntry.actions.push({\n            action: \"sizePressure\",\n            params: [sizePressure]\n        });\n        historyEntry.actions.push({\n            action: \"setSize\",\n            params: [size]\n        });\n        historyEntry.actions.push({\n            action: \"setOpacity\",\n            params: [opacity]\n        });\n        historyEntry.actions.push({\n            action: \"setTransparentBG\",\n            params: [isTransparentBG]\n        });\n\n        historyEntry.actions.push({\n            action: \"drawLineSegment\",\n            params: [x1, y1, x2, y2]\n        });\n        history.push(historyEntry);\n    };\n\n    //IS\n    this.isDrawing = function () {\n        return started;\n    };\n    //SET\n    /*this.setAlpha = function(a) {\n        lastInput = {};\n        alpha = a;\n        updateAlphaCanvas();\n    };*/\n    this.setContext = function (c) {\n        context = c;\n    };\n    this.setHistory = function (l: KlHistoryInterface) {\n        history = l;\n    };\n    this.setSize = function (s) {\n        size = s;\n    };\n    this.setOpacity = function (o) {\n        opacity = o;\n    };\n    this.sizePressure = function (b) {\n        sizePressure = b;\n    };\n    this.opacityPressure = function (b) {\n        opacityPressure = b;\n    };\n    this.setTransparentBG = function (b) {\n        isTransparentBG = b == true;\n    };\n    //GET\n    this.getSize = function () {\n        return size;\n    };\n    this.getOpacity = function () {\n        return opacity;\n    };\n}","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"efRnq\");","import {BB} from '../../bb/bb';\nimport {brushes} from '../brushes/brushes';\nimport {eventResMs} from './brushes-consts';\nimport {klHistory} from '../history/kl-history';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\n// @ts-ignore\nimport brushIconImg from 'url:~/src/app/img/ui/brush-pen.svg';\nimport {genBrushAlpha01, genBrushAlpha02} from '../brushes/alphas/brush-alphas';\nimport {IBrushUi} from '../kl.types';\nimport {LANG, languageStrings} from '../../language/language';\n\nexport const penBrushUi = (function () {\n    let brushInterface: IBrushUi = {\n        image: brushIconImg,\n        tooltip: LANG('brush-pen'),\n        sizeSlider: {\n            min: 0.5,\n            max: 100,\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\n        },\n        opacitySlider: {\n            min: 0,\n            max: 1,\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\n        },\n        Ui: null,\n    };\n\n    let alphaNames = [\n        LANG('brush-pen-circle'),\n        LANG('brush-pen-chalk'),\n        LANG('brush-pen-calligraphy'),\n        LANG('brush-pen-square'),\n    ];\n    languageStrings.subscribe(() => {\n        brushInterface.tooltip = LANG('brush-pen');\n        alphaNames = [\n            LANG('brush-pen-circle'),\n            LANG('brush-pen-chalk'),\n            LANG('brush-pen-calligraphy'),\n            LANG('brush-pen-square'),\n        ];\n    });\n\n    brushInterface.Ui = function (p) {\n        let div = document.createElement(\"div\"); // the gui\n        let brush = new brushes.PenBrush();\n        brush.setHistory(klHistory);\n        p.onSizeChange(brush.getSize());\n        let sizeSlider;\n        let opacitySlider;\n\n        let alphas = [];\n        let currentAlpha = 0;\n        for (let i = 0; i < 4; i++) {\n            (function (i) {\n                let alpha = BB.el({\n                    title: alphaNames[i],\n                    onClick: () => {\n                        alphaClick(i);\n                    }\n                });\n                let canvas = BB.canvas(70, 70);\n                let ctx = canvas.getContext('2d');\n                if (i === 0 || i === 3) {\n                    if (i === 0) {\n                        ctx.beginPath();\n                        ctx.arc(35, 35, 30, 0, 2 * Math.PI);\n                        ctx.closePath();\n                        ctx.fill();\n                    } else {\n                        ctx.fillRect(5, 5, 60, 60);\n                    }\n                } else if (i === 1) {\n                    ctx.drawImage(genBrushAlpha01(60), 5, 5);\n                } else if (i === 2) {\n                    ctx.drawImage(genBrushAlpha02(60), 5, 5);\n                }\n                alpha.style.backgroundImage = 'url(' + canvas.toDataURL('image/png') + ')';\n\n                alphas.push(alpha);\n            }(i));\n        }\n\n        function updateAlphas() {\n            for (let i = 0; i < alphas.length; i++) {\n                if (i === currentAlpha) {\n                    alphas[i].className = 'brush-alpha-selected';\n                } else {\n                    alphas[i].className = 'brush-alpha';\n                }\n            }\n        }\n\n        updateAlphas();\n\n        function alphaClick(id) {\n            currentAlpha = id;\n            brush.setAlpha(id);\n            updateAlphas();\n        }\n\n        let lockAlphaToggle = new Checkbox({\n            init: brush.getLockAlpha(),\n            label: LANG('brush-lock-alpha'),\n            callback: function (b) {\n                brush.setLockAlpha(b);\n            },\n            doHighlight: true,\n            title: LANG('brush-lock-alpha-title'),\n            css: {\n                cssFloat: 'right',\n                textAlign: 'right',\n            }\n        });\n\n        let spacingSpline = new BB.SplineInterpolator([[0, 15], [8, 7], [14, 4], [30, 3], [50, 2.7], [100, 2]]);\n\n        function setSize(size) {\n            brush.setSize(size);\n            brush.setSpacing(Math.max(2, spacingSpline.interpolate(size)) / 15);\n        }\n\n        function init() {\n            sizeSlider = new KlSlider({\n                label: LANG('brush-size'),\n                width: 225,\n                height: 30,\n                min: brushInterface.sizeSlider.min,\n                max: brushInterface.sizeSlider.max,\n                initValue: brush.getSize(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    setSize(val);\n                    p.onSizeChange(val);\n                },\n                curve: brushInterface.sizeSlider.curve,\n                formatFunc: function (v) {\n                    v *= 2;\n                    if (v < 10) {\n                        return Math.round(v * 10) / 10;\n                    } else {\n                        return Math.round(v);\n                    }\n                }\n            });\n            opacitySlider = new KlSlider({\n                label: LANG('opacity'),\n                width: 225,\n                height: 30,\n                min: brushInterface.opacitySlider.min,\n                max: brushInterface.opacitySlider.max,\n                initValue: brushInterface.opacitySlider.max,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setOpacity(val);\n                    p.onOpacityChange(val);\n                },\n                curve: brushInterface.opacitySlider.curve,\n                formatFunc: function(v) {\n                    return Math.round(v * 100);\n                }\n            });\n\n            let pressureSizeToggle = penPressureToggle(false, function (b) {\n                brush.sizePressure(b);\n            });\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\n                brush.opacityPressure(b);\n            });\n\n            div.append(\n                BB.el({\n                    content: [\n                        sizeSlider.getElement(),\n                        pressureSizeToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        marginBottom: '10px',\n                    }\n                }),\n                BB.el({\n                    content: [\n                        opacitySlider.getElement(),\n                        pressureOpacityToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                    }\n                })\n            );\n\n            let alphaWrapper = document.createElement(\"div\");\n            for (let i = 0; i < alphas.length; i++) {\n                alphaWrapper.appendChild(alphas[i]);\n            }\n            alphaWrapper.style.marginTop = \"10px\";\n            div.appendChild(alphaWrapper);\n            alphaWrapper.appendChild(lockAlphaToggle.getElement());\n\n        }\n\n        init();\n\n        this.increaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.increaseValue(f);\n            }\n        };\n        this.decreaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.decreaseValue(f);\n            }\n        };\n\n        this.getSize = function () {\n            return brush.getSize();\n        };\n        this.setSize = function(size) {\n            setSize(size);\n            sizeSlider.setValue(size);\n        };\n        this.getOpacity = function () {\n            return brush.getOpacity();\n        };\n        this.setOpacity = function(opacity) {\n            brush.setOpacity(opacity);\n            opacitySlider.setValue(opacity);\n        };\n\n        this.setColor = function (c) {\n            brush.setColor(c);\n        };\n        this.setContext = function (c) {\n            brush.setContext(c);\n        };\n        this.startLine = function (x, y, p) {\n            brush.startLine(x, y, p);\n        };\n        this.goLine = function (x, y, p) {\n            brush.goLine(x, y, p);\n        };\n        this.endLine = function (x, y) {\n            brush.endLine(x, y);\n        };\n        this.getBrush = function () {\n            return brush;\n        };\n        this.isDrawing = function () {\n            return brush.isDrawing();\n        };\n        this.getElement = function () {\n            return div;\n        };\n    };\n    return brushInterface;\n})();","\nexport const eventResMs = 20;","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"lGY8s\");","import {BB} from '../../bb/bb';\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\nimport {eventResMs} from './brushes-consts';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {brushes} from '../brushes/brushes';\nimport {klHistory} from '../history/kl-history';\nimport {KlSlider} from '../ui/base-components/kl-slider';\n// @ts-ignore\nimport brushIconImg from 'url:~/src/app/img/ui/brush-blend.svg';\nimport {IBrushUi} from '../kl.types';\nimport {LANG, languageStrings} from '../../language/language';\n\nexport const blendBrushUi = (function () {\n    let brushInterface: IBrushUi = {\n        image: brushIconImg,\n        tooltip: LANG('brush-blend'),\n        sizeSlider: {\n            min: 0.5,\n            max: 100,\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\n        },\n        opacitySlider: {\n            min: 1 / 100,\n            max: 1\n        },\n        Ui: null,\n    };\n\n    languageStrings.subscribe(() => {\n        brushInterface.tooltip = LANG('brush-blend');\n    });\n\n    brushInterface.Ui = function (p) {\n        let div = document.createElement(\"div\"); // the gui\n        let brush = new brushes.BlendBrush();\n        brush.setHistory(klHistory);\n        p.onSizeChange(brush.getSize());\n\n        let sizeSlider;\n        let opacitySlider;\n\n        function setSize(size) {\n            brush.setSize(size);\n        }\n\n        function init() {\n            sizeSlider = new KlSlider({\n                label: LANG('brush-size'),\n                width: 225,\n                height: 30,\n                min: brushInterface.sizeSlider.min,\n                max: brushInterface.sizeSlider.max,\n                initValue: 58 / 2,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    setSize(val);\n                    p.onSizeChange(val);\n                },\n                curve: brushInterface.sizeSlider.curve,\n                formatFunc: function (v) {\n                    v *= 2;\n                    return Math.round(v);\n                }\n            });\n            opacitySlider = new KlSlider({\n                label: LANG('opacity'),\n                width: 225,\n                height: 30,\n                min: brushInterface.opacitySlider.min,\n                max: brushInterface.opacitySlider.max,\n                initValue: brush.getOpacity(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setOpacity(val);\n                    p.onOpacityChange(val);\n                },\n                formatFunc: function(v) {\n                    return Math.round(v * 100);\n                }\n            });\n            let blendingSlider = new KlSlider({\n                label: LANG('brush-blending'),\n                width: 225,\n                height: 30,\n                min: 0,\n                max: 100,\n                initValue: brush.getBlending() * 100,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setBlending(val / 100);\n                }\n            });\n            blendingSlider.getElement().style.marginTop = \"10px\";\n\n            let pressureSizeToggle = penPressureToggle(false, function (b) {\n                brush.setSizePressure(b);\n            });\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\n                brush.setOpacityPressure(b);\n            });\n\n            let lockAlphaToggle = new Checkbox({\n                init: brush.getLockAlpha(),\n                label: LANG('brush-lock-alpha'),\n                callback: function (b) {\n                    brush.setLockAlpha(b);\n                },\n                doHighlight: true,\n                title: LANG('brush-lock-alpha-title'),\n                css: {\n                    marginTop: '10px',\n                    display: 'inline-block',\n                }\n            });\n\n\n            div.append(\n                BB.el({\n                    content: [\n                        sizeSlider.getElement(),\n                        pressureSizeToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        marginBottom: '10px',\n                    }\n                }),\n                BB.el({\n                    content: [\n                        opacitySlider.getElement(),\n                        pressureOpacityToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                    }\n                }),\n                blendingSlider.getElement(),\n                lockAlphaToggle.getElement()\n            );\n        }\n\n        init();\n\n        this.increaseSize = function (f) {\n            if (!brush.getIsDrawing()) {\n                sizeSlider.increaseValue(f);\n            }\n        };\n        this.decreaseSize = function (f) {\n            if (!brush.getIsDrawing()) {\n                sizeSlider.decreaseValue(f);\n            }\n        };\n\n        this.getSize = function () {\n            return brush.getSize();\n        };\n        this.setSize = function(size) {\n            setSize(size);\n            sizeSlider.setValue(size);\n        };\n        this.getOpacity = function () {\n            return brush.getOpacity();\n        };\n        this.setOpacity = function(opacity) {\n            brush.setOpacity(opacity);\n            opacitySlider.setValue(opacity);\n        };\n\n        this.setColor = function (c) {\n            brush.setColor(c);\n        };\n        this.setContext = function (c) {\n            brush.setContext(c);\n        };\n        this.startLine = function (x, y, p) {\n            brush.startLine(x, y, p);\n        };\n        this.goLine = function (x, y, p, isCoalesced) {\n            brush.goLine(x, y, p, isCoalesced);\n        };\n        this.endLine = function () {\n            brush.endLine();\n        };\n        this.getBrush = function () {\n            return brush;\n        };\n        this.isDrawing = function () {\n            return brush.getIsDrawing();\n        };\n        this.getElement = function () {\n            return div;\n        };\n    };\n\n    return brushInterface;\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"jDXzO\");","import {brushes} from '../brushes/brushes';\nimport {eventResMs} from './brushes-consts';\nimport {klHistory} from '../history/kl-history';\nimport {KlSlider} from '../ui/base-components/kl-slider';\n// @ts-ignore\nimport brushIconImg from 'url:~/src/app/img/ui/brush-sketchy.png';\nimport {IBrushUi} from '../kl.types';\nimport {LANG, languageStrings} from '../../language/language';\n\nexport const sketchyBrushUi = (function () {\n    let brushInterface: IBrushUi = {\n        image: brushIconImg,\n        tooltip: LANG('brush-sketchy'),\n        sizeSlider: {\n            min: 0.5,\n            max: 10\n        },\n        opacitySlider: {\n            min: 1 / 100,\n            max: 1\n        },\n        Ui: null,\n    };\n\n    languageStrings.subscribe(() => {\n        brushInterface.tooltip = LANG('brush-sketchy');\n    });\n\n    brushInterface.Ui = function (p) {\n        let div = document.createElement(\"div\"); // the gui\n        let brush = new brushes.SketchyBrush();\n        brush.setHistory(klHistory);\n        p.onSizeChange(brush.getSize());\n        let sizeSlider;\n        let opacitySlider;\n\n        function setSize(size) {\n            brush.setSize(size);\n        }\n\n        function init() {\n            sizeSlider = new KlSlider({\n                label: LANG('brush-size'),\n                width: 250,\n                height: 30,\n                min: brushInterface.sizeSlider.min,\n                max: brushInterface.sizeSlider.max,\n                initValue: brush.getSize(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setSize(val);\n                    p.onSizeChange(brush.getSize());\n                },\n                formatFunc: function (v) {\n                    v *= 2;\n                    if (v < 10) {\n                        return Math.round(v * 10) / 10;\n                    } else {\n                        return Math.round(v);\n                    }\n                }\n            });\n            opacitySlider = new KlSlider({\n                label: LANG('opacity'),\n                width: 250,\n                height: 30,\n                min: brushInterface.opacitySlider.min,\n                max: brushInterface.opacitySlider.max,\n                initValue: brush.getOpacity(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setOpacity(val);\n                    p.onOpacityChange(val);\n                },\n                formatFunc: function(v) {\n                    return Math.round(v * 100);\n                }\n            });\n            let blendSlider = new KlSlider({\n                label: LANG('brush-blending'),\n                width: 250,\n                height: 30,\n                min: 0,\n                max: 100,\n                initValue: brush.getBlending() * 100,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setBlending(val / 100);\n                }\n            });\n            let scaleSlider = new KlSlider({\n                label: LANG('brush-sketchy-scale'),\n                width: 250,\n                height: 30,\n                min: 1,\n                max: 20,\n                initValue: brush.getScale(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setScale(val);\n                }\n            });\n            opacitySlider.getElement().style.marginTop = \"10px\";\n            blendSlider.getElement().style.marginTop = \"10px\";\n            scaleSlider.getElement().style.marginTop = \"10px\";\n            div.appendChild(sizeSlider.getElement());\n            div.appendChild(opacitySlider.getElement());\n            div.appendChild(blendSlider.getElement());\n            div.appendChild(scaleSlider.getElement());\n        }\n\n        init();\n\n        this.increaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.increaseValue(f);\n            }\n        };\n        this.decreaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.decreaseValue(f);\n            }\n        };\n        this.getSize = function () {\n            return brush.getSize();\n        };\n        this.setSize = function(size) {\n            setSize(size);\n            sizeSlider.setValue(size);\n        };\n        this.getOpacity = function () {\n            return brush.getOpacity();\n        };\n        this.setOpacity = function(opacity) {\n            brush.setOpacity(opacity);\n            opacitySlider.setValue(opacity);\n        };\n        this.setColor = function (c) {\n            brush.setColor(c);\n        };\n        this.setContext = function (c) {\n            brush.setContext(c);\n        };\n        this.startLine = function (x, y, pressure) {\n            brush.startLine(x, y, pressure);\n        };\n        this.goLine = function (x, y, pressure) {\n            brush.goLine(x, y, pressure, null);\n        };\n        this.endLine = function () {\n            brush.endLine();\n        };\n        this.getSeed = function () {\n            return parseInt(brush.getSeed());\n        };\n        this.setSeed = function (s) {\n            brush.setSeed(parseInt(s));\n        };\n        this.getBrush = function () {\n            return brush;\n        };\n        this.isDrawing = function () {\n            return brush.isDrawing();\n        };\n        this.getElement = function () {\n            return div;\n        };\n    };\n\n    return brushInterface;\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"hkoNI\");","import {BB} from '../../bb/bb';\nimport {brushes} from '../brushes/brushes';\nimport {eventResMs} from './brushes-consts';\nimport {klHistory} from '../history/kl-history';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\n// @ts-ignore\nimport brushIconImg from 'url:~/src/app/img/ui/brush-pixel.svg';\nimport {IBrushUi} from '../kl.types';\nimport {LANG, languageStrings} from '../../language/language';\n\nexport const pixelBrushUi = (function () {\n    let brushInterface: IBrushUi = {\n        image: brushIconImg,\n        tooltip: LANG('brush-pixel'),\n        sizeSlider: {\n            min: 0.5,\n            max: 100,\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\n        },\n        opacitySlider: {\n            min: 0,\n            max: 1,\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\n        },\n        Ui: null,\n    };\n\n    languageStrings.subscribe(() => {\n        brushInterface.tooltip = LANG('brush-pixel');\n    });\n\n    brushInterface.Ui = function (p) {\n        let div = document.createElement(\"div\"); // the gui\n        let brush = new brushes.PixelBrush();\n        brush.setHistory(klHistory);\n        p.onSizeChange(brush.getSize());\n        let sizeSlider;\n        let opacitySlider;\n\n        let lockAlphaToggle = new Checkbox({\n            init: brush.getLockAlpha(),\n            label: LANG('brush-lock-alpha'),\n            callback: function (b) {\n                brush.setLockAlpha(b);\n            },\n            doHighlight: true,\n            title: LANG('brush-lock-alpha-title'),\n            css: {\n                marginRight: '10px',\n            }\n        });\n\n        let eraserToggle = new Checkbox({\n            init: brush.getIsEraser(),\n            label: LANG('eraser'),\n            callback: function (b) {\n                brush.setIsEraser(b);\n            },\n            css: {\n                marginRight: '10px',\n            }\n        });\n\n        let ditherToggle = new Checkbox({\n            init: brush.getUseDither(),\n            label: LANG('brush-pixel-dither'),\n            callback: function (b) {\n                brush.setUseDither(b);\n            }\n        });\n\n        let spacingSpline = new BB.SplineInterpolator([[0.5, 0.45], [100, 4]]);\n\n        function setSize(size) {\n            brush.setSize(size);\n            brush.setSpacing(spacingSpline.interpolate(size) / size);\n        }\n\n        function init() {\n            sizeSlider = new KlSlider({\n                label: LANG('brush-size'),\n                width: 225,\n                height: 30,\n                min: brushInterface.sizeSlider.min,\n                max: brushInterface.sizeSlider.max,\n                initValue: brush.getSize(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    val = Math.round(val * 2) / 2;\n                    setSize(val);\n                    p.onSizeChange(val);\n                },\n                curve: brushInterface.sizeSlider.curve,\n                formatFunc: function (v) {\n                    v *= 2;\n                    return Math.round(v);\n                }\n            });\n            opacitySlider = new KlSlider({\n                label: LANG('opacity'),\n                width: 225,\n                height: 30,\n                min: brushInterface.opacitySlider.min,\n                max: brushInterface.opacitySlider.max,\n                initValue: brushInterface.opacitySlider.max,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setOpacity(val);\n                    p.onOpacityChange(val);\n                },\n                curve: brushInterface.opacitySlider.curve,\n                formatFunc: function(v) {\n                    return Math.round(v * 100);\n                }\n            });\n\n            let pressureSizeToggle = penPressureToggle(false, function (b) {\n                brush.sizePressure(b);\n            });\n\n            div.append(\n                BB.el({\n                    content: [\n                        sizeSlider.getElement(),\n                        pressureSizeToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        marginBottom: '10px',\n                    }\n                }),\n                opacitySlider.getElement()\n            );\n\n            let toggleRow = BB.el({\n                parent: div,\n                css: {\n                    display: 'flex',\n                    marginTop: '10px'\n                }\n            });\n\n            toggleRow.appendChild(lockAlphaToggle.getElement());\n            toggleRow.appendChild(eraserToggle.getElement());\n            toggleRow.appendChild(ditherToggle.getElement());\n        }\n\n        init();\n\n        this.increaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.increaseValue(f);\n            }\n        };\n        this.decreaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.decreaseValue(f);\n            }\n        };\n\n        this.getSize = function () {\n            return brush.getSize();\n        };\n        this.setSize = function(size) {\n            setSize(size);\n            sizeSlider.setValue(size);\n        };\n        this.getOpacity = function () {\n            return brush.getOpacity();\n        };\n        this.setOpacity = function(opacity) {\n            brush.setOpacity(opacity);\n            opacitySlider.setValue(opacity);\n        };\n\n        this.setColor = function (c) {\n            brush.setColor(c);\n        };\n        this.setContext = function (c) {\n            brush.setContext(c);\n        };\n        this.startLine = function (x, y, p) {\n            brush.startLine(x, y, p);\n        };\n        this.goLine = function (x, y, p) {\n            brush.goLine(x, y, p);\n        };\n        this.endLine = function (x, y) {\n            brush.endLine(x, y);\n        };\n        this.getBrush = function () {\n            return brush;\n        };\n        this.isDrawing = function () {\n            return brush.isDrawing();\n        };\n        this.getElement = function () {\n            return div;\n        };\n    };\n    return brushInterface;\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"baIZM\");","import {BB} from '../../bb/bb';\nimport {brushes} from '../brushes/brushes';\nimport {eventResMs} from './brushes-consts';\nimport {klHistory} from '../history/kl-history';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\nimport {Checkbox} from '../ui/base-components/checkbox';\n// @ts-ignore\nimport brushIconImg from 'url:~/src/app/img/ui/brush-eraser.svg';\nimport {IBrushUi} from '../kl.types';\nimport {LANG, languageStrings} from '../../language/language';\n\nexport const eraserBrushUi = (function () {\n    let brushInterface: IBrushUi = {\n        image: brushIconImg,\n        tooltip: LANG('eraser') + ' [E]',\n        sizeSlider: {\n            min: 0.5,\n            max: 200,\n            curve: BB.quadraticSplineInput(0.5, 200, 0.1)\n        },\n        opacitySlider: {\n            min: 1 / 100,\n            max: 1\n        },\n        Ui: null,\n    };\n\n    languageStrings.subscribe(() => {\n        brushInterface.tooltip = LANG('eraser') + ' [E]';\n    });\n\n    brushInterface.Ui = function (p) {\n        let div = document.createElement(\"div\"); // the gui\n        let brush = new brushes.EraserBrush();\n        brush.setHistory(klHistory);\n        p.onSizeChange(brush.getSize());\n\n        let sizeSlider;\n        let opacitySlider;\n        let isTransparentBg = false;\n\n        function setSize(size) {\n            brush.setSize(size);\n        }\n\n        function init() {\n            sizeSlider = new KlSlider({\n                label: LANG('brush-size'),\n                width: 225,\n                height: 30,\n                min: brushInterface.sizeSlider.min,\n                max: brushInterface.sizeSlider.max,\n                initValue: 30,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    setSize(val);\n                    p.onSizeChange(val);\n                },\n                curve: brushInterface.sizeSlider.curve,\n                formatFunc: function (v) {\n                    v *= 2;\n                    if (v < 10) {\n                        return Math.round(v * 10) / 10;\n                    } else {\n                        return Math.round(v);\n                    }\n                }\n            });\n            opacitySlider = new KlSlider({\n                label: LANG('opacity'),\n                width: 225,\n                height: 30,\n                min: brushInterface.opacitySlider.min,\n                max: brushInterface.opacitySlider.max,\n                initValue: 1,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setOpacity(val);\n                    p.onOpacityChange(val);\n                },\n                formatFunc: function(v) {\n                    return Math.round(v * 100);\n                }\n            });\n\n            let pressureSizeToggle = penPressureToggle(false, function (b) {\n                brush.sizePressure(b);\n            });\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\n                brush.opacityPressure(b);\n            });\n\n            div.append(\n                BB.el({\n                    content: [\n                        sizeSlider.getElement(),\n                        pressureSizeToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        marginBottom: '10px',\n                    }\n                }),\n                BB.el({\n                    content: [\n                        opacitySlider.getElement(),\n                        pressureOpacityToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                    }\n                })\n            );\n\n            let transparencyToggle = new Checkbox({\n                init: false,\n                label: LANG('brush-eraser-transparent-bg'),\n                callback: function (b) {\n                    isTransparentBg = b;\n                    brush.setTransparentBG(b);\n                },\n                css: {\n                    marginTop: \"10px\",\n                }\n            });\n            div.appendChild(transparencyToggle.getElement());\n        }\n\n        init();\n\n        function drawDot(x, y) {\n            brush.drawDot(x, y);\n        }\n\n        this.increaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.increaseValue(f);\n            }\n        };\n        this.decreaseSize = function (f) {\n            if (!brush.isDrawing()) {\n                sizeSlider.decreaseValue(f);\n            }\n        };\n        this.getSize = function () {\n            return brush.getSize();\n        };\n        this.setSize = function(size) {\n            setSize(size);\n            sizeSlider.setValue(size);\n        };\n        this.getOpacity = function () {\n            return brush.getOpacity();\n        };\n        this.setOpacity = function(opacity) {\n            brush.setOpacity(opacity);\n            opacitySlider.setValue(opacity);\n        };\n        this.setColor = function (c) {\n            //brush.setColor(c);\n        };\n        this.setContext = function (c) {\n            brush.setContext(c);\n        };\n        this.startLine = function (x, y, p) {\n            brush.startLine(x, y, p);\n        };\n        this.goLine = function (x, y, p) {\n            brush.goLine(x, y, p);\n        };\n        this.endLine = function () {\n            brush.endLine();\n        };\n        this.getBrush = function () {\n            return brush;\n        };\n        this.getIsTransparentBg = function () {\n            return isTransparentBg;\n        };\n        this.isDrawing = function () {\n            return brush.isDrawing();\n        };\n        this.getElement = function () {\n            return div;\n        }\n    };\n\n    return brushInterface;\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"91Av5\");","import {BB} from '../../bb/bb';\nimport {brushes} from '../brushes/brushes';\nimport {eventResMs} from './brushes-consts';\nimport {klHistory} from '../history/kl-history';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {penPressureToggle} from '../ui/base-components/pen-pressure-toggle';\n// @ts-ignore\nimport brushIconImg from 'url:~/src/app/img/ui/brush-smudge.svg';\nimport {IBrushUi} from '../kl.types';\nimport {LANG, languageStrings} from '../../language/language';\n\nexport const smudgeBrushUi = (function () {\n    let brushInterface: IBrushUi = {\n        image: brushIconImg,\n        tooltip: LANG('brush-smudge'),\n        sizeSlider: {\n            min: 0.5,\n            max: 100,\n            curve: BB.quadraticSplineInput(0.5, 100, 0.1)\n        },\n        opacitySlider: {\n            min: 0,\n            max: 1,\n            curve: [[0, 1 / 100], [0.5, 0.3], [1, 1]]\n        },\n        Ui: null,\n    };\n\n    languageStrings.subscribe(() => {\n        brushInterface.tooltip = LANG('brush-smudge');\n    });\n\n    brushInterface.Ui = function (p) {\n        let div = document.createElement(\"div\"); // the gui\n        let brush = new brushes.SmudgeBrush();\n        brush.setHistory(klHistory);\n        p.onSizeChange(brush.getSize());\n        let sizeSlider;\n        let opacitySlider;\n\n        let lockAlphaToggle = new Checkbox({\n            init: brush.getLockAlpha(),\n            label: LANG('brush-lock-alpha'),\n            callback: function (b) {\n                brush.setLockAlpha(b);\n            },\n            doHighlight: true,\n            title: LANG('brush-lock-alpha-title'),\n        });\n\n        let spacingSpline = new BB.SplineInterpolator([[0, 15], [8, 7], [14, 4], [30, 3], [50, 2.7], [100, 2]]);\n\n        function setSize(size) {\n            brush.setSize(size);\n            brush.setSpacing(Math.max(2, spacingSpline.interpolate(size)) / 15);\n        }\n\n        function init() {\n            sizeSlider = new KlSlider({\n                label: LANG('brush-size'),\n                width: 225,\n                height: 30,\n                min: brushInterface.sizeSlider.min,\n                max: brushInterface.sizeSlider.max,\n                initValue: brush.getSize(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    setSize(val);\n                    p.onSizeChange(val);\n                },\n                curve: brushInterface.sizeSlider.curve,\n                formatFunc: function (v) {\n                    v *= 2;\n                    if (v < 10) {\n                        return Math.round(v * 10) / 10;\n                    } else {\n                        return Math.round(v);\n                    }\n                }\n            });\n            opacitySlider = new KlSlider({\n                label: LANG('opacity'),\n                width: 225,\n                height: 30,\n                min: brushInterface.opacitySlider.min,\n                max: brushInterface.opacitySlider.max,\n                initValue: brush.getOpacity(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setOpacity(val);\n                    p.onOpacityChange(val);\n                },\n                curve: brushInterface.opacitySlider.curve,\n                formatFunc: function(v) {\n                    return Math.round(v * 100);\n                }\n            });\n\n            let pressureSizeToggle = penPressureToggle(false, function (b) {\n                brush.sizePressure(b);\n            });\n            let pressureOpacityToggle = penPressureToggle(false, function (b) {\n                brush.opacityPressure(b);\n            });\n\n            div.append(\n                BB.el({\n                    content: [\n                        sizeSlider.getElement(),\n                        pressureSizeToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        marginBottom: '10px',\n                    }\n                }),\n                BB.el({\n                    content: [\n                        opacitySlider.getElement(),\n                        pressureOpacityToggle\n                    ],\n                    css: {\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                    }\n                })\n            );\n\n            let bottomRow = BB.el({\n                parent: div,\n                css: {\n                    marginTop: '10px',\n                }\n            });\n            bottomRow.append(lockAlphaToggle.getElement());\n\n        }\n\n        init();\n\n        this.increaseSize = function (f) {\n            if (!brush.getIsDrawing()) {\n                sizeSlider.increaseValue(f);\n            }\n        };\n        this.decreaseSize = function (f) {\n            if (!brush.getIsDrawing()) {\n                sizeSlider.decreaseValue(f);\n            }\n        };\n\n        this.getSize = function () {\n            return brush.getSize();\n        };\n        this.setSize = function(size) {\n            setSize(size);\n            sizeSlider.setValue(size);\n        };\n        this.getOpacity = function () {\n            return brush.getOpacity();\n        };\n        this.setOpacity = function(opacity) {\n            brush.setOpacity(opacity);\n            opacitySlider.setValue(opacity);\n        };\n\n        this.setColor = function (c) {\n            brush.setColor(c);\n        };\n        this.setContext = function (c) {\n            brush.setContext(c);\n        };\n        this.startLine = function (x, y, p) {\n            brush.startLine(x, y, p);\n        };\n        this.goLine = function (x, y, p) {\n            brush.goLine(x, y, p);\n        };\n        this.endLine = function (x, y) {\n            brush.endLine();\n        };\n        this.getBrush = function () {\n            return brush;\n        };\n        this.isDrawing = function () {\n            return brush.getIsDrawing();\n        };\n        this.getElement = function () {\n            return div;\n        };\n    };\n    return brushInterface;\n})();","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"aI6cE\");","import {BB} from '../../../bb/bb';\n\nexport class BoxToggle {\n    el: HTMLElement;\n    value: boolean;\n\n    update (): void {\n        if (this.value) {\n            BB.addClassName(this.el, 'kl-box-toggle--active');\n        } else {\n            BB.removeClassName(this.el, 'kl-box-toggle--active');\n        }\n    }\n\n    // --- public ---\n    constructor (\n        p: {\n            label: string | HTMLElement | SVGElement;\n            title?: string;\n            init?: boolean;\n            onChange: (b: boolean) => void;\n        }\n    ) {\n        this.value = !!p.init;\n        this.el = BB.el({\n            content: p.label,\n            title: p.title,\n            className: (typeof p.label === 'string') ? 'kl-box-toggle' : 'kl-box-toggle kl-box-toggle--custom-el',\n            onClick: () => {\n                this.value = !this.value;\n                this.update();\n                p.onChange(this.value);\n            },\n            css: {\n                cursor: 'pointer',\n            }\n        });\n        if (typeof p.label !== 'string') {\n            BB.css(p.label, {\n                display: 'block',\n                pointerEvents: 'none',\n            });\n        }\n        this.update();\n    }\n\n    getValue (): boolean {\n        return this.value;\n    }\n\n    setValue (b: boolean): void {\n        this.value = !!b;\n        this.update();\n    }\n\n    getElement (): HTMLElement {\n        return this.el;\n    }\n\n    destroy (): void {\n        BB.destroyEl(this.el);\n    }\n}","import {BB} from '../../bb/bb';\nimport {eventResMs} from './brushes-consts';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {brushes} from '../brushes/brushes';\nimport {klHistory} from '../history/kl-history';\nimport {KlSlider} from '../ui/base-components/kl-slider';\n// @ts-ignore\nimport brushIconImg from 'url:~/src/app/img/ui/brush-chemy.svg';\nimport {IBrushUi} from '../kl.types';\nimport {Options} from '../ui/base-components/options';\nimport {BoxToggle} from '../ui/base-components/box-toggle';\nimport {LANG, languageStrings} from '../../language/language';\n\nexport const chemyBrushUi = (function () {\n    const brushInterface: IBrushUi = {\n        image: brushIconImg,\n        tooltip: LANG('brush-chemy'),\n        sizeSlider: {\n            min: 0.25,\n            max: 25,\n            curve: BB.quadraticSplineInput(0.25, 25, 0.1),\n            isDisabled: true,\n        },\n        opacitySlider: {\n            min: 1 / 100,\n            max: 1\n        },\n        Ui: null,\n    };\n\n    languageStrings.subscribe(() => {\n        brushInterface.tooltip = LANG('brush-chemy');\n    });\n\n    brushInterface.Ui = function (p) {\n        const div = document.createElement(\"div\"); // the gui\n        const brush = new brushes.ChemyBrush();\n        brush.setHistory(klHistory);\n        p.onSizeChange(brush.getSize());\n\n        let sizeSlider;\n        let opacitySlider;\n\n        function setSize(size) {\n            brush.setSize(size);\n        }\n\n        function init() {\n            sizeSlider = new KlSlider({\n                label: LANG('brush-size'),\n                width: 250,\n                height: 30,\n                min: brushInterface.sizeSlider.min,\n                max: brushInterface.sizeSlider.max,\n                initValue: brush.getSize(),\n                eventResMs: eventResMs,\n                isEnabled: brush.getMode() === 'stroke',\n                onChange: function (val) {\n                    setSize(val);\n                    p.onSizeChange(brush.getSize());\n                },\n                curve: brushInterface.sizeSlider.curve,\n                formatFunc: function (v) {\n                    v *= 2;\n                    return v < 5 ? (Math.round(v * 10) / 10) : Math.round(v);\n                }\n            });\n            opacitySlider = new KlSlider({\n                label: LANG('opacity'),\n                width: 250,\n                height: 30,\n                min: brushInterface.opacitySlider.min,\n                max: brushInterface.opacitySlider.max,\n                initValue: brush.getOpacity(),\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brush.setOpacity(val);\n                    p.onOpacityChange(val);\n                },\n                formatFunc: function(v) {\n                    return Math.round(v * 100);\n                }\n            });\n\n            BB.css(opacitySlider.getElement(), {\n                marginTop: '10px',\n            });\n\n            let eraserToggle = new Checkbox({\n                init: brush.getIsEraser(),\n                label: LANG('eraser'),\n                callback: function (b) {\n                    brush.setIsEraser(b);\n                },\n                css: {\n                    marginTop: '10px',\n                    marginLeft: '10px',\n                }\n            });\n\n            const lockAlphaToggle = new Checkbox({\n                init: brush.getLockAlpha(),\n                label: LANG('brush-lock-alpha'),\n                callback: function (b) {\n                    brush.setLockAlpha(b);\n                },\n                doHighlight: true,\n                title: LANG('brush-lock-alpha-title'),\n                css: {\n                    marginTop: '10px',\n                }\n            });\n\n            const toggleRow = BB.el({\n                css: {\n                    display: 'flex',\n                    marginTop: '10px',\n                }\n            });\n\n            const iconSize = 35;\n            const padding = 8;\n            const actualIconSize = iconSize - padding * 2;\n            const halfSize = actualIconSize / 2;\n\n            const modeOptions = new Options({\n                optionArr: [\n                    {\n                        id: 'fill',\n                        label: BB.createSvg({\n                            elementType: 'svg',\n                            width: iconSize + '',\n                            height: iconSize + '',\n                            childrenArr: [\n                                {\n                                    elementType: 'path',\n                                    fill: '#000',\n                                    style: `transform-origin: 0 0; transform: translate(-0.5px, -0.5px) scale(${actualIconSize}, ${actualIconSize}) translate(0.5px, 0.5px)`,\n                                    d: 'M 0,0 C 1.5,0 -0.5,1 1,1',\n                                },\n                            ],\n                        }),\n                        title: LANG('brush-chemy-fill'),\n                    },\n                    {\n                        id: 'stroke',\n                        label: BB.createSvg({\n                            elementType: 'svg',\n                            width: iconSize + '',\n                            height: iconSize + '',\n                            childrenArr: [\n                                {\n                                    elementType: 'path',\n                                    fill: 'none',\n                                    stroke: '#000',\n                                    style: `stroke-width: 0.12px; transform-origin: 0 0; transform: translate(-0.5px, -0.5px) scale(${actualIconSize}, ${actualIconSize}) translate(0.5px, 0.5px)`,\n                                    d: 'M 0,0 C 1.5,0 -0.5,1 1,1',\n                                },\n                            ],\n                        }),\n                        title: LANG('brush-chemy-stroke'),\n                    }\n                ],\n                initId: brush.getMode(),\n                onChange: (id: string): void => {\n                    brush.setMode(id as 'stroke' | 'fill');\n                    brushInterface.sizeSlider.isDisabled = brush.getMode() === 'fill';\n                    sizeSlider.setIsEnabled(!brushInterface.sizeSlider.isDisabled);\n                    sizeSlider.setValue(brush.getSize());\n                    p.onSizeChange(brush.getSize());\n                    p.onConfigChange();\n                }\n            });\n\n            const mirrorXToggle = new BoxToggle({\n                label: BB.createSvg({\n                    elementType: 'svg',\n                    width: iconSize + '',\n                    height: iconSize + '',\n                    childrenArr: [\n                        {\n                            elementType: 'path',\n                            fill: 'none',\n                            stroke: '#000',\n                            style: 'stroke-width: 1px',\n                            d: `M ${halfSize + padding},${padding} ${halfSize + padding},${actualIconSize + padding}`,\n                        },\n                    ]\n                }),\n                title: LANG('brush-chemy-mirror-x'),\n                init: brush.getXSymmetry(),\n                onChange: (b) => {\n                    brush.setXSymmetry(b);\n                },\n            });\n\n            const mirrorYToggle = new BoxToggle({\n                label: BB.createSvg({\n                    elementType: 'svg',\n                    width: iconSize + '',\n                    height: iconSize + '',\n                    childrenArr: [\n                        {\n                            elementType: 'path',\n                            fill: 'none',\n                            stroke: '#000',\n                            style: 'stroke-width: 1px',\n                            d: `M ${padding},${halfSize + padding} ${actualIconSize + padding},${halfSize + padding}`,\n                        },\n                    ]\n                }),\n                title: LANG('brush-chemy-mirror-y'),\n                init: brush.getYSymmetry(),\n                onChange: (b) => {\n                    brush.setYSymmetry(b);\n                },\n            });\n\n            const gradientToggle = new BoxToggle({\n                label: BB.createSvg({\n                    elementType: 'svg',\n                    width: iconSize + '',\n                    height: iconSize + '',\n                    childrenArr: [\n                        {\n                            elementType: 'defs',\n                            childrenArr: [\n                                {\n                                    elementType: 'linearGradient',\n                                    id: 'gradient',\n                                    x1: '0',\n                                    y1: '0',\n                                    x2: '0',\n                                    y2: '1',\n                                    childrenArr: [\n                                        {\n                                            elementType: 'stop',\n                                            offset: '0%',\n                                            'stop-color': 'rgba(0,0,0,0)',\n                                        },\n                                        {\n                                            elementType: 'stop',\n                                            offset: '100%',\n                                            'stop-color': 'rgba(0,0,0,1)',\n                                        }\n                                    ]\n                                }\n                            ]\n                        },\n                        {\n                            elementType: 'rect',\n                            fill: \"url('#gradient')\",\n                            x: '' + padding,\n                            y: '' + padding,\n                            width: '' + actualIconSize,\n                            height: '' + actualIconSize,\n                        },\n                    ]\n                }),\n                title: LANG('brush-chemy-gradient'),\n                init: brush.getGradient(),\n                onChange: (b) => {\n                    brush.setGradient(b);\n                },\n            });\n\n            BB.css(mirrorXToggle.getElement(), {\n                marginLeft: '10px',\n            });\n            {\n                const margin = {\n                    marginLeft: '4px',\n                };\n                BB.css(mirrorYToggle.getElement(), margin);\n                BB.css(gradientToggle.getElement(), margin);\n            }\n\n            toggleRow.append(\n                modeOptions.getElement(),\n                mirrorXToggle.getElement(),\n                mirrorYToggle.getElement(),\n                gradientToggle.getElement(),\n            );\n\n            div.append(\n                sizeSlider.getElement(),\n                opacitySlider.getElement(),\n                toggleRow,\n                BB.el({\n                    content: [\n                        lockAlphaToggle.getElement(),\n                        eraserToggle.getElement(),\n                    ],\n                    css: {\n                        display: 'flex',\n                    }\n                })\n            );\n        }\n\n        init();\n\n        this.increaseSize = function (f) {\n            if (!brush.getIsDrawing() && brush.getMode() === 'stroke') {\n                sizeSlider.increaseValue(f);\n            }\n        };\n        this.decreaseSize = function (f) {\n            if (!brush.getIsDrawing() && brush.getMode() === 'stroke') {\n                sizeSlider.decreaseValue(f);\n            }\n        };\n\n        this.getSize = function () {\n            return brush.getSize();\n        };\n        this.setSize = function(size) {\n            setSize(size);\n            sizeSlider.setValue(size);\n        };\n        this.getOpacity = function () {\n            return brush.getOpacity();\n        };\n        this.setOpacity = function(opacity) {\n            brush.setOpacity(opacity);\n            opacitySlider.setValue(opacity);\n        };\n\n        this.setColor = function (c) {\n            brush.setColor(c);\n        };\n        this.setContext = function (c) {\n            brush.setContext(c);\n        };\n        this.startLine = function (x, y, p) {\n            brush.startLine(x, y);\n        };\n        this.goLine = function (x, y, p, isCoalesced) {\n            brush.goLine(x, y);\n        };\n        this.endLine = function () {\n            brush.endLine();\n        };\n        this.getBrush = function () {\n            return brush;\n        };\n        this.isDrawing = function () {\n            return brush.getIsDrawing();\n        };\n        this.getElement = function () {\n            return div;\n        };\n    };\n\n    return brushInterface;\n})();","import {penBrushUi} from './pen-brush-ui';\nimport {blendBrushUi} from './blend-brush-ui';\nimport {sketchyBrushUi} from './sketchy-brush-ui';\nimport {pixelBrushUi} from './pixel-brush-ui';\nimport {eraserBrushUi} from './eraser-brush-ui';\nimport {smudgeBrushUi} from './smudge-brush-ui';\nimport {chemyBrushUi} from './chemy-brush-ui';\nimport {IBrushUi} from '../kl.types';\n\n/**\n * UI for brushes.\n * Each brush ui carries the brush with it.\n * So if you want to draw, you do it through the UI. should be changed sometime.\n */\n\nexport const brushesUI: {\n    [key: string]: IBrushUi;\n} = {\n    penBrush: penBrushUi,\n    blendBrush: blendBrushUi,\n    sketchyBrush: sketchyBrushUi,\n    pixelBrush: pixelBrushUi,\n    chemyBrush: chemyBrushUi,\n    smudgeBrush: smudgeBrushUi,\n    eraserBrush: eraserBrushUi,\n};\n","import {BB} from '../../../bb/bb';\nimport {Popup} from './popup';\nimport {LANG} from '../../../language/language';\n\nexport function showIframePopup(url, isEmbed) {\n    if (!isEmbed && (window.innerHeight < 500 || window.innerWidth < 700)) {\n        window.open(url);\n        return;\n    }\n\n    let iframe = BB.el({\n        tagName: 'iframe',\n        custom: {\n            src: url,\n        },\n        css: {\n            width: '100%',\n            height: '100%'\n        }\n    }) as HTMLIFrameElement;\n    let titleEl = BB.el({});\n\n    let linkEl;\n    if (!isEmbed) {\n        linkEl = BB.el({\n            tagName: 'a',\n            parent: titleEl,\n            content: LANG('modal-new-tab'),\n            custom: {\n                href: 'help',\n                target: '_blank',\n            },\n            onClick: function() {\n                popup.close();\n            }\n        }) as HTMLAnchorElement;\n        iframe.onload = function() {\n            BB.setAttributes(linkEl, {\n                href: '' + iframe.contentWindow.location,\n            });\n        };\n    }\n\n\n    let popup = new Popup({\n        title: titleEl,\n        content: iframe,\n        width: 880,\n        isMaxHeight: true,\n        onClose: () => {\n            if (linkEl) {\n                BB.destroyEl(linkEl);\n            }\n        }\n    });\n\n}","import {BB} from '../../../bb/bb';\n\n// @ts-ignore\nimport removeLayerImg from 'url:~/src/app/img/ui/remove-layer.svg';\nimport {IKlProject} from '../../kl.types';\nimport {showIframePopup} from '../modals/show-iframe-popup';\nimport {SaveReminder} from './save-reminder';\nimport {ProjectStore} from '../../storage/project-store';\nimport {KL} from '../../kl';\nimport {LANG} from '../../../language/language';\n\nexport class BrowserStorageUi {\n\n    private previewEl: HTMLDivElement;\n    private ageEl: HTMLDivElement;\n    private storeEl: HTMLButtonElement;\n    private clearEl: HTMLButtonElement;\n\n    private timestamp: number;\n\n    private updateAge() {\n        if (!this.timestamp) {\n            return;\n        }\n        let age = new Date().getTime() - this.timestamp;\n        let ageStr;\n        age = Math.floor(age / 1000 / 60);\n        ageStr = LANG('file-storage-min-ago').replace('{x}', '' + age);\n        if (age > 60) {\n            age = Math.floor(age / 60);\n            ageStr = LANG('file-storage-hours-ago').replace('{x}', '' + age);\n            if (age > 24) {\n                age = Math.floor(age / 24);\n                ageStr = LANG('file-storage-days-ago').replace('{x}', '' + age);\n                if (age > 31) {\n                    ageStr = LANG('file-storage-month-ago');\n                }\n            }\n        }\n        this.ageEl.textContent = ageStr;\n    }\n\n    private resetButtons() {\n        if (this.timestamp) {\n            this.storeEl.textContent = LANG('file-storage-overwrite');\n            this.storeEl.disabled = false;\n            this.clearEl.disabled = false;\n        } else {\n            this.storeEl.textContent = LANG('file-storage-store');\n            this.storeEl.disabled = false;\n            this.clearEl.disabled = true;\n        }\n    }\n\n    private updateThumb(timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) {\n        this.timestamp = timestamp;\n        if (this.timestamp) {\n            BB.css(thumbnail, {\n                display: 'block',\n                maxWidth: 'calc(100% - 2px)',\n                maxHeight: 'calc(100% - 2px)',\n                margin: '0 auto',\n                background: \"url('\" + BB.createCheckerCanvas(4).toDataURL('image/png') + \"')\",\n                boxShadow: '0 0 0 1px #aaa',\n                pointerEvents: 'none',\n            });\n            this.previewEl.innerHTML = '';\n            this.updateAge();\n            this.previewEl.append(thumbnail, this.ageEl);\n        } else {\n            this.previewEl.innerHTML = LANG('file-storage-empty');\n        }\n        this.resetButtons();\n    }\n\n    private async store() {\n        this.storeEl.textContent = LANG('file-storage-storing');\n        this.storeEl.disabled = true;\n        this.clearEl.disabled = true;\n        await new Promise((resolve) => {\n            setTimeout(() => resolve(null), 20);\n        });\n        try {\n            await this.projectStore.store(this.getProject());\n            this.saveReminder.reset();\n        } catch (e) {\n            this.resetButtons();\n            KL.popup({\n                target: this.klRootEl,\n                type: 'error',\n                message: [\n                    `${LANG('file-storage-failed-1')}<ul>`,\n                    `<li>${LANG('file-storage-failed-2')}</li>`,\n                    `<li>${LANG('file-storage-failed-3')}</li>`,\n                    `<li>${LANG('file-storage-failed-4')}</li>`,\n                    `</ul>`,\n                ].join(''),\n                buttons: ['Ok'],\n            });\n            setTimeout(() => {\n                throw new Error('storage-ui: failed to store browser storage, ' + e);\n            }, 0);\n        }\n    }\n\n    private async clear() {\n        this.storeEl.disabled = true;\n        this.clearEl.disabled = true;\n        try {\n            await this.projectStore.clear();\n        } catch (e) {\n            this.resetButtons();\n            KL.popup({\n                target: this.klRootEl,\n                type: 'error',\n                message: LANG('file-storage-failed-clear'),\n                buttons: ['Ok'],\n            });\n            setTimeout(() => {\n                throw new Error('storage-ui: failed to clear browser storage, ' + e);\n            }, 0);\n        }\n    }\n\n    element: HTMLDivElement;\n\n    constructor (\n        private projectStore: ProjectStore,\n        private getProject: () => IKlProject,\n        private saveReminder: SaveReminder,\n        private klRootEl: HTMLDivElement,\n    ) {\n        this.element = BB.el({\n            css: {\n                display: 'grid',\n                gridTemplateColumns: '1fr 0fr',\n                gridTemplateRows: '0fr 0fr 0fr',\n                gap: '0 0',\n                gridTemplateAreas: '\"title title\" \"preview store\" \"preview clear\"',\n            }\n        }) as HTMLDivElement;\n\n\n        const title = BB.el({\n            parent: this.element,\n            content: LANG('file-storage'),\n            css: {\n                gridArea: 'title',\n                display: 'flex',\n                margin: '-5px 0',\n                //background: '#f00',\n            }\n        });\n\n        const infoEl = BB.el({\n            parent: title,\n            content: '?',\n            title: LANG('file-storage-about'),\n            css: {\n                cursor: 'pointer',\n                marginLeft: '5px',\n                width: '19px',\n                height: '19px',\n                borderRadius: '100%',\n                textAlign: 'center',\n                lineHeight: '19px',\n                fontWeight: 'bold',\n                boxShadow: 'inset 0 0 0 1px #000',\n            },\n            onClick: () => {\n                showIframePopup('./help/#help-browser-storage', false);\n            }\n        });\n\n        if (this.projectStore.isBroken()) {\n            BB.el({\n                parent: this.element,\n                content: \"🔴 \" + LANG('file-storage-cant-access'),\n                css: {\n                    marginTop: '10px',\n                }\n            });\n            return;\n        }\n\n        this.previewEl = BB.el({\n            parent: this.element,\n            title: LANG('file-storage-thumb-title'),\n            css: {\n                gridArea: 'preview',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                marginTop: '10px',\n                position: 'relative',\n                boxShadow: 'inset 0 0 0 1px #aaa',\n                background: '#cdcdcd',\n                color: '#545454',\n                colorScheme: 'only light',\n            }\n        }) as HTMLDivElement;\n        this.ageEl = BB.el({\n            css: {\n                position: 'absolute',\n                right: '0',\n                bottom: '0',\n                width: '100%',\n                textAlign: 'center',\n                background: 'rgba(0,0,0,0.7)',\n                color: '#fff',\n                textSize: '13px',\n            }\n        }) as HTMLDivElement;\n        this.storeEl = BB.el({\n            parent: this.element,\n            tagName: 'button',\n            className: 'gridButton',\n            content: LANG('file-storage-store'),\n            css: {\n                gridArea: 'store',\n                //background: '#00f',\n            },\n            custom: {\n                tabIndex: -1,\n            },\n            onClick: () => this.store(),\n        }) as HTMLButtonElement;\n        this.storeEl.tabIndex = -1;\n        this.clearEl = BB.el({\n            parent: this.element,\n            tagName: 'button',\n            className: 'gridButton',\n            content: '<img src=\"' + removeLayerImg + '\" height=\"20\"/> ' + LANG('file-storage-clear'),\n            css: {\n                gridArea: 'clear',\n                //background: '#ff0',\n            },\n            custom: {\n                tabIndex: -1,\n            },\n            onClick: () => this.clear(),\n        }) as HTMLButtonElement;\n\n        this.projectStore.subscribe({\n            onUpdate: (timestamp, thumbnail) => {\n                this.updateThumb(timestamp, thumbnail);\n            },\n        });\n\n        setInterval(() => this.updateAge(), 1000 * 60);\n\n        (async () => {\n            try {\n                const readResult = await this.projectStore.read();\n                if (readResult) {\n                    this.updateThumb(readResult.timestamp, readResult.thumbnail);\n                } else {\n                    this.updateThumb();\n                }\n            } catch (e) {\n                setTimeout(() => {\n                    throw new Error('storage-ui: failed initial read browser storage, ' + e);\n                }, 0);\n            }\n        })();\n    }\n\n\n    getElement() {\n        return this.element;\n    }\n\n    show () {\n        // todo\n    }\n\n    hide () {\n        // todo\n    }\n}","\nexport function base64ToBlob(base64Str: string): Blob {\n    let parts = base64Str.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);\n    let binStr = atob(parts[3]);\n    let buf = new ArrayBuffer(binStr.length);\n    let view = new Uint8Array(buf);\n    for (let i = 0; i < view.length; i++) {\n        view[i] = binStr.charCodeAt(i);\n    }\n    return new Blob([view], {'type': parts[1]});\n}","import {IKlProject, IKlStorageProject} from '../kl.types';\nimport {BB} from '../../bb/bb';\nimport {drawProject} from '../canvas/draw-project';\nimport {base64ToBlob} from './base-64-to-blob';\n\n\nconst thumbSize = 240;\n\nfunction loadImage(blob: Blob): Promise<HTMLImageElement> {\n    return new Promise<HTMLImageElement>((resolve, reject) => {\n        const im = new Image();\n        try {\n            im.src = BB.imageBlobToUrl(blob);\n        } catch (e) {\n            reject('imageBlobToUrl, ' + e.message);\n            return;\n        }\n        im.onload = () => {\n            resolve(im);\n        }\n        im.onabort = function () {\n            reject('layer image failed loading');\n        };\n        im.onerror = function () {\n            reject('layer image failed loading');\n        };\n    });\n}\n\n/**\n * for:\n * - preparing project to be stored in ProjectStore\n * - reading a project that came out of the ProjectStore\n */\nexport class ProjectConverter {\n\n    private static createThumbnail(project): HTMLCanvasElement {\n        const size = BB.fitInto(project.width, project.height, thumbSize, thumbSize);\n        const factor = size.width / project.width;\n        return drawProject(project, factor);\n    }\n\n    static createStorageProject(project: IKlProject): IKlStorageProject {\n        return {\n            id: 1,\n            timestamp: new Date().getTime(),\n            thumbnail: base64ToBlob(ProjectConverter.createThumbnail(project).toDataURL('image/png')),\n            width: project.width,\n            height: project.height,\n            layers: project.layers.map(item => {\n                let blob;\n                if (item.image instanceof HTMLCanvasElement) {\n                    blob = base64ToBlob((item.image as HTMLCanvasElement).toDataURL('image/png'));\n                } else {\n                    // todo image\n                    throw new Error('Not implemented');\n                }\n                return {\n                    name: item.name,\n                    opacity: item.opacity,\n                    mixModeStr: item.mixModeStr,\n                    blob,\n                }\n            }),\n        };\n    }\n\n    static async readStorageProject(storageProject: IKlStorageProject): Promise<{\n        project: IKlProject,\n        timestamp: number,\n        thumbnail: HTMLImageElement | HTMLCanvasElement\n    }> {\n        const project: IKlProject = {\n            width: storageProject.width,\n            height: storageProject.height,\n            layers: (await Promise.all(storageProject.layers.map(layer => loadImage(layer.blob))))\n                .map((image, i) => {\n                    return {\n                        name: storageProject.layers[i].name,\n                        opacity: storageProject.layers[i].opacity,\n                        mixModeStr: storageProject.layers[i].mixModeStr,\n                        image,\n                    };\n                }),\n        };\n\n        let thumbnail;\n        if (storageProject.thumbnail) {\n            thumbnail = await loadImage(storageProject.thumbnail);\n        } else {\n            thumbnail = ProjectConverter.createThumbnail(project);\n        }\n\n        return {\n            project: project,\n            timestamp: storageProject.timestamp,\n            thumbnail: thumbnail,\n        };\n    }\n\n}","import {IKlProject, IKlStorageProject} from '../kl.types';\nimport {ProjectConverter} from './project-converter';\nimport {clear, getKlProjectObj, storeKlProjectObj} from './indexed-db';\nimport {LocalStorage} from '../../bb/base/local-storage';\n\n\nexport interface IProjectStoreListener {\n    onUpdate: (timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) => void,\n}\n\nfunction makeAsync(func): Promise<any> {\n    return new Promise((resolve, reject) => {\n        func(resolve, reject);\n    });\n}\n\n/**\n * simplified interface for storing projects into browser storage\n */\nexport class ProjectStore {\n\n    private listeners: IProjectStoreListener[] = [];\n    private accessHasFailed: boolean = false;\n\n    async lowLevelStore (project: IKlStorageProject): Promise<any> {\n        await new Promise((resolve, reject) => {\n            storeKlProjectObj(project, resolve, reject);\n        });\n    }\n\n    async lowLevelRead (): Promise<IKlStorageProject> {\n        return await makeAsync(getKlProjectObj) as IKlStorageProject;\n    }\n\n    async lowLevelClear (): Promise<any> {\n        await makeAsync(clear);\n    }\n\n\n\n    private emit(timestamp?: number, thumbnail?: HTMLImageElement | HTMLCanvasElement) {\n        this.listeners.forEach(item => {\n            item.onUpdate(timestamp, thumbnail);\n        });\n    }\n\n    private updateTimestamp() {\n        LocalStorage.setItem('indexedDbUpdatedAt', '' + new Date().getTime());\n    }\n\n    // --- public ---\n\n    constructor () {\n        window.addEventListener('storage', (e) => {\n            if (e.key !== 'indexedDbUpdatedAt' || this.listeners.length === 0) {\n                return;\n            }\n            try {\n                ( async () => {\n                    const readResult = await this.read();\n                    if (readResult) {\n                        this.emit(readResult.timestamp, readResult.thumbnail);\n                    } else {\n                        this.emit();\n                    }\n                })();\n            } catch (e) {\n                if (e.message === 'db-error') {\n                    this.accessHasFailed = true;\n                }\n            }\n\n        });\n    }\n\n    async read(): Promise<{\n        project: IKlProject,\n        timestamp: number,\n        thumbnail: HTMLImageElement | HTMLCanvasElement\n    } | null> {\n        let storageProject;\n        try {\n            storageProject = await this.lowLevelRead();\n        } catch (e) {\n            this.accessHasFailed = true;\n            throw new Error('db-error');\n        }\n        if (!storageProject) {\n            return null;\n        }\n        let result;\n        try {\n            result = await ProjectConverter.readStorageProject(storageProject);\n        } catch (e) {\n            throw new Error('format-error');\n        }\n        return result;\n    }\n\n    async store(project: IKlProject): Promise<void> {\n        try {\n            const storageProject = ProjectConverter.createStorageProject(project);\n            await this.lowLevelStore(storageProject);\n        } catch (e) {\n            this.accessHasFailed = true;\n            throw new Error('db-error');\n        }\n        {\n            // immediately test if it can be read\n            const storageProject = await this.lowLevelRead();\n            let readResult = null;\n            try {\n                readResult = await ProjectConverter.readStorageProject(storageProject);\n            } catch (e) {\n                await this.lowLevelClear();\n                this.updateTimestamp();\n                setTimeout(() => this.emit(), 0);\n                throw new Error('format-error');\n            }\n            this.updateTimestamp();\n            setTimeout(() => this.emit(readResult.timestamp, readResult.thumbnail), 0);\n        }\n    }\n\n    async clear(): Promise<void> {\n        await this.lowLevelClear();\n        this.updateTimestamp();\n        setTimeout(() => this.emit(), 0);\n    }\n\n    subscribe(listener: IProjectStoreListener) {\n        if (this.listeners.includes(listener)) {\n            return;\n        }\n        this.listeners.push(listener);\n    }\n\n    unsubscribe(listener: IProjectStoreListener) {\n        for (let i = 0; i < this.listeners.length; i++) {\n            if (listener === this.listeners[i]) {\n                this.listeners.splice(i, 1);\n                return;\n            }\n        }\n    }\n\n    isBroken() {\n        return this.accessHasFailed;\n    }\n\n}","import {BB} from '../../bb/bb';\n\nlet agPsdLazy;\nexport async function loadAgPsd() {\n    if (!agPsdLazy) {\n        agPsdLazy = await import('ag-psd');\n        BB.BbLog.emit({\n            type: 'loaded-agpsd',\n        });\n    }\n    return agPsdLazy;\n}","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"28TVy\");","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","import {IRGB, ISliderConfig} from '../kl.types';\n\nexport type TBrushSettingEmit = { type: 'color'; value: IRGB } |\n    { type: 'opacity'; value: number } |\n    { type: 'size'; value: number } |\n    { type: 'sliderConfig'; value: ISliderConfig };\n\nexport type TBrushSettingSubscriber = (p : TBrushSettingEmit) => void;\n\n/**\n * Central place to update brush settings, and to subscribe to changes.\n */\nexport class BrushSettingService {\n\n    private static instance: BrushSettingService;\n    subscriberArr: TBrushSettingSubscriber[] = [];\n\n    private emit (obj: TBrushSettingEmit, skipSubscriber?: TBrushSettingSubscriber): void {\n        for (let i = 0; i < this.subscriberArr.length; i++) {\n            if (this.subscriberArr[i] === skipSubscriber) {\n                continue;\n            }\n            this.subscriberArr[i](obj);\n        }\n    }\n\n    // --- public ---\n\n    constructor (\n        private onSetColor: (rgb: IRGB) => void,\n        private onSetSize: (size: number) => void,\n        private onSetOpacity: (opacity: number) => void,\n        private onGetColor: () => IRGB,\n        private onGetSize: () => number,\n        private onGetOpacity: () => number,\n        private onGetSliderConfig: () => ISliderConfig,\n    ) {\n        if (BrushSettingService.instance) {\n            throw new Error('BrushSettingService already instantiated');\n        }\n        BrushSettingService.instance = this;\n    }\n\n    emitColor (color: IRGB, skipSubscriber?: TBrushSettingSubscriber): void {\n        this.emit(\n            {\n                type: 'color',\n                value: color\n            },\n            skipSubscriber\n        );\n    }\n\n    emitSize (size: number, skipSubscriber?: TBrushSettingSubscriber): void {\n        this.emit(\n            {\n                type: 'size',\n                value: size\n            },\n            skipSubscriber\n        );\n    }\n\n    emitOpacity (opacity: number, skipSubscriber?: TBrushSettingSubscriber): void {\n        this.emit(\n            {\n                type: 'opacity',\n                value: opacity\n            },\n            skipSubscriber\n        );\n    }\n\n    emitSliderConfig (sliderConfig: ISliderConfig, skipSubscriber?: TBrushSettingSubscriber) {\n        this.emit(\n            {\n                type: 'sliderConfig',\n                value: sliderConfig\n            },\n            skipSubscriber\n        );\n    }\n\n    /**\n     * set current brush color\n     * @param color\n     * @param skipSubscriber\n     */\n    setColor (color: IRGB, skipSubscriber?: TBrushSettingSubscriber) {\n        this.onSetColor(color);\n        this.emitColor(color, skipSubscriber);\n    }\n\n    /**\n     * set current brush size\n     * @param size\n     * @param skipSubscriber\n     */\n    setSize (size: number, skipSubscriber?: TBrushSettingSubscriber) {\n        this.onSetSize(size);\n        // why not emitting?\n    }\n\n    /**\n     * set current opacity\n     * @param opacity\n     * @param skipSubscriber\n     */\n    setOpacity (opacity: number, skipSubscriber?: TBrushSettingSubscriber) {\n        this.onSetOpacity(opacity);\n        // why not emitting?\n    }\n\n    /**\n     * get current brush color\n     */\n    getColor (): IRGB {\n        return this.onGetColor();\n    }\n\n    getSize (): number {\n        return this.onGetSize();\n    }\n\n    getOpacity (): number {\n        return this.onGetOpacity();\n    }\n\n    getSliderConfig (): ISliderConfig {\n        return this.onGetSliderConfig();\n    }\n\n    /**\n     * subscribe to changes\n     * @param func\n     */\n    subscribe (func: TBrushSettingSubscriber): void {\n        if (this.subscriberArr.includes(func)) {\n            return;\n        }\n        this.subscriberArr.push(func);\n    }\n\n    unsubscribe (func: TBrushSettingSubscriber): void {\n        for (let i = 0; i < this.subscriberArr.length; i++) {\n            if (func === this.subscriberArr[i]) {\n                this.subscriberArr.splice(i, 1);\n                i--;\n            }\n        }\n    }\n}\n\n","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"8EUal\");","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"lQWO9\");","import {DecoyKlHistory, klHistory} from './history/kl-history';\nimport {Popup, popup} from './ui/modals/popup';\nimport {dialogCounter} from './ui/modals/modal-count';\nimport {Checkbox} from './ui/base-components/checkbox';\nimport {input} from './ui/base-components/input';\nimport {Select} from './ui/base-components/select';\nimport {ImageToggle} from './ui/base-components/image-toggle';\nimport {ImageRadioList} from './ui/base-components/image-radio-list';\nimport {penPressureToggle} from './ui/base-components/pen-pressure-toggle';\nimport {KlSlider} from './ui/base-components/kl-slider';\nimport {calcSliderFalloffFactor} from './ui/base-components/slider-falloff';\nimport {HexColorDialog} from './ui/modals/color-slider-hex-dialog';\nimport {KlColorSlider} from './ui/base-components/kl-color-slider';\nimport {KlSmallColorSlider} from './ui/base-components/kl-color-slider-small';\nimport {PointSlider} from './ui/base-components/point-slider';\nimport {ColorOptions} from './ui/base-components/color-options';\nimport {Options} from './ui/base-components/options';\nimport {StatusOverlay} from './ui/components/status-overlay';\nimport {exportDialog} from './ui/modals/export-dialog-deprecated';\nimport {CropCopy} from './ui/components/crop-copy';\nimport {clipboardDialog} from './ui/modals/clipboard-dialog';\nimport {klLayerManager} from './ui/tool-tabs/kl-layer-manager';\nimport {WorkspaceSvgOverlay} from './canvas-ui/workspace-svg-overlay';\nimport {KlCanvasWorkspace} from './canvas-ui/kl-canvas-workspace';\nimport {KlCanvasPreview} from './canvas-ui/canvas-preview';\nimport {FreeTransform} from './ui/components/free-transform';\nimport {FreeTransformCanvas} from './ui/components/free-transform-canvas';\nimport {Cropper} from './ui/components/cropper';\nimport {LayerPreview} from './ui/components/layer-preview';\nimport {showSaveReminderToast} from './ui/components/show-reminder-toast';\nimport {FittedImage} from './ui/components/fitted-image';\nimport {showImportAsLayerDialog} from './ui/modals/show-import-as-layer-dialog';\nimport {KlImageDropper} from './ui/components/kl-image-dropper';\nimport {OverlayToolspace} from './ui/components/overlay-toolspace';\nimport {ToolspaceTopRow} from './ui/components/toolspace-top-row';\nimport {ToolDropdown} from './ui/components/tool-dropdown';\nimport {ToolspaceToolRow} from './ui/components/toolspace-tool-row';\nimport {ToolspaceStabilizerRow} from './ui/components/toolspace-stabilizer-row';\nimport {TabRow} from './ui/components/tab-row';\nimport {HandUi} from './ui/tool-tabs/hand-ui';\nimport {FillUi} from './ui/tool-tabs/fill-ui';\nimport {TextUi} from './ui/tool-tabs/text-ui';\nimport {ShapeUi} from './ui/tool-tabs/shape-ui';\nimport {newImageDialog} from './ui/modals/new-image-dialog';\nimport {ToolspaceCollapser} from './ui/components/toolspace-collapser';\nimport {renderText} from './image-operations/render-text';\nimport {textToolDialog} from './ui/modals/text-tool-dialog';\nimport {showImportImageDialog} from './ui/modals/show-import-image-dialog';\nimport {floodFillBits} from './image-operations/flood-fill';\nimport * as PSD from './storage/psd';\nimport {drawShape, ShapeTool} from './image-operations/shape-tool';\nimport {KlCanvas} from './canvas/kl-canvas';\nimport * as indexedDb from './storage/indexed-db';\nimport {filterLib, filterLibStatus} from './filters/filters';\nimport {brushes} from './brushes/brushes';\nimport {brushesUI} from './brushes-ui/brushes-ui';\nimport {showIframePopup} from './ui/modals/show-iframe-popup';\nimport {RadioList} from './ui/base-components/radio-list';\nimport {BrowserStorageUi} from './ui/components/browser-storage-ui';\nimport {drawProject} from './canvas/draw-project';\nimport {ProjectStore} from './storage/project-store';\nimport {FileTab} from \"./ui/tool-tabs/file-tab\";\nimport {FilterTab} from \"./ui/tool-tabs/filter-tab\";\nimport {imgurUpload} from \"./ui/modals/imgur-upload\";\nimport {loadAgPsd} from \"./storage/ag-psd-wrapper\";\nimport {SaveReminder} from \"./ui/components/save-reminder\";\nimport {SaveToComputer} from \"./storage/save-to-computer\";\nimport {UndoRedoCatchup} from \"./history/undo-redo-catchup\";\nimport {setDbName} from './storage/indexed-db';\nimport {BrushSettingService} from './brushes-ui/brush-setting-service';\nimport {BoxToggle} from './ui/base-components/box-toggle';\nimport {SettingsTab} from './ui/tool-tabs/settings-tab';\nimport {ToolspaceScroller} from './ui/components/toolspace-scroller';\n\n/**\n * paint tool functionality\n */\nexport const KL = {\n\n    // --- brushes ---\n    brushes,\n    brushesUI,\n    BrushSettingService,\n\n    // --- canvas ---\n    KlCanvas,\n    drawProject,\n\n    // --- canvas ui ---\n    WorkspaceSvgOverlay,\n    KlCanvasWorkspace,\n    KlCanvasPreview,\n\n    // --- filters ---\n    filterLibStatus,\n    filterLib,\n\n    // --- history ---\n    UndoRedoCatchup,\n\n    // --- image operations ---\n    renderText,\n    floodFillBits,\n    ShapeTool,\n    drawShape,\n\n    // --- storage ---\n    PSD,\n    setDbName,\n    indexedDb,\n    ProjectStore,\n    loadAgPsd,\n    SaveToComputer,\n\n    // --- ui - base components ---\n    calcSliderFalloffFactor,\n    Checkbox,\n    input,\n    Select,\n    ImageToggle,\n    ImageRadioList,\n    RadioList,\n    penPressureToggle,\n    KlSlider,\n    HexColorDialog,\n    KlColorSlider,\n    KlSmallColorSlider,\n    PointSlider,\n    ColorOptions,\n    Options,\n    BoxToggle,\n\n    // --- ui - components ---\n    StatusOverlay,\n    CropCopy,\n    FreeTransform,\n    FreeTransformCanvas,\n    Cropper,\n    LayerPreview,\n    showSaveReminderToast,\n    FittedImage,\n    KlImageDropper,\n    OverlayToolspace,\n    ToolspaceTopRow,\n    ToolDropdown,\n    ToolspaceToolRow,\n    ToolspaceStabilizerRow,\n    TabRow,\n    ToolspaceCollapser,\n    BrowserStorageUi,\n    SaveReminder,\n    ToolspaceScroller,\n\n    // --- ui - modals ---\n    dialogCounter,\n    popup,\n    Popup,\n    exportDialog,\n    clipboardDialog,\n    showImportAsLayerDialog,\n    newImageDialog,\n    textToolDialog,\n    showImportImageDialog,\n    showIframePopup,\n    imgurUpload,\n\n    // --- ui - tool tabs ---\n    HandUi,\n    FillUi,\n    TextUi,\n    ShapeUi,\n    FileTab,\n    FilterTab,\n    SettingsTab,\n    klLayerManager,\n\n\n    klHistory,\n    DecoyKlHistory,\n};","import {KL} from '../kl';\nimport {IHistoryBroadcast, IHistoryEntry, klHistory} from './kl-history';\nimport {KlCanvasWorkspace} from '../canvas-ui/kl-canvas-workspace';\nimport {IFilterApply, IInitState} from '../kl.types';\nimport {KlCanvas} from '../canvas/kl-canvas';\n\nexport class UndoRedoCatchup {\n\n    private doIgnore = false;\n\n    /**\n     * Prevent multiple undo / redo getting triggered at once.\n     * Might be confusing if main thread is choking.\n     */\n    private ignoreTest (): boolean {\n        if (this.doIgnore) {\n            return false;\n        }\n        this.doIgnore = true;\n        setTimeout(() => {\n            this.doIgnore = false;\n        }, 0);\n        return true;\n    }\n\n    // ---- public ----\n\n    constructor (\n        private brushUiObj,\n        private layerPreview,\n        private layerManager,\n        private handUi,\n        private klCanvasWorkspace: KlCanvasWorkspace,\n        private getInitState: () => IInitState,\n        private getKlCanvas: () => KlCanvas,\n        private getCurrentLayerCtx,\n        private setCurrentLayerCtx,\n        private getCurrentBrush,\n    ) { }\n\n    undo (): boolean {\n        if (!this.ignoreTest()) {\n            return false;\n        }\n\n        if (!klHistory.canUndo()) { // || workspace.isPainting()) {\n            return false;\n        }\n        const actions: IHistoryEntry[] = klHistory.undo();\n        klHistory.pause(true);\n        const initState: IInitState = this.getInitState();\n        const oldSize = {w: this.getKlCanvas().getWidth(), h: this.getKlCanvas().getHeight()};\n        this.getKlCanvas().copy(initState.canvas);\n        let layerIndex = initState.focus;\n        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\n        const brushes: any = {};\n        for (let b in KL.brushes) {\n            if (KL.brushes.hasOwnProperty(b)) {\n                brushes[b] = new KL.brushes[b]();\n                brushes[b].setContext(this.getCurrentLayerCtx());\n            }\n        }\n        brushes.SketchyBrush.setSeed(initState.brushes.SketchyBrush.getSeed());\n        for (let i = 0; i < actions.length; i++) {\n            ((i) => {\n                if (actions[i].tool[0] === \"brush\") {\n                    const b = brushes[actions[i].tool[1]];\n                    if (actions[i].actions) {\n                        for (let e = 0; e < actions[i].actions.length; e++) {\n                            const p = actions[i].actions[e].params;\n                            b[actions[i].actions[e].action].apply(b, p);\n                        }\n                    } else {\n                        const p = actions[i].params;\n                        b[actions[i].action].apply(b, p);\n                    }\n                } else if (actions[i].tool[0] === \"canvas\") {\n                    const p = actions[i].params;\n                    const id = this.getKlCanvas()[actions[i].action].apply(this.getKlCanvas(), p);\n                    if (typeof id === 'number') {\n                        layerIndex = id;\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\n                        for (let b in brushes) {\n                            if (brushes.hasOwnProperty(b)) {\n                                brushes[b].setContext(this.getCurrentLayerCtx());\n                            }\n                        }\n                    }\n                } else if (actions[i].tool[0] === \"filter\") {\n                    const p = [{\n                        context: this.getCurrentLayerCtx(),\n                        canvas: this.getKlCanvas(),\n                        input: actions[i].params[0].input,\n                        history: new KL.DecoyKlHistory(),\n                    } as IFilterApply];\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\n\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\n                    layerIndex = actions[i].params[0];\n                    this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(actions[i].params[0]));\n                    for (let b in brushes) {\n                        if (brushes.hasOwnProperty(b)) {\n                            brushes[b].setContext(this.getCurrentLayerCtx());\n                        }\n                    }\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\n                    const id = this.getKlCanvas().addLayer();\n                    if (typeof id === 'number') {\n                        layerIndex = id;\n                        if (actions[i].params[1]) {\n                            this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\n                        }\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\n                        for (let b in brushes) {\n                            if (brushes.hasOwnProperty(b)) {\n                                brushes[b].setContext(this.getCurrentLayerCtx());\n                            }\n                        }\n                    }\n                    this.getCurrentLayerCtx().drawImage(actions[i].params[0], 0, 0);\n                }\n            })(i);\n        }\n        if (oldSize.w !== this.getKlCanvas().getWidth() || oldSize.h !== this.getKlCanvas().getHeight()) {\n            this.klCanvasWorkspace.resetView();\n            this.handUi.update(this.klCanvasWorkspace.getScale(), this.klCanvasWorkspace.getAngleDeg());\n        }\n        this.layerManager.update(layerIndex);\n        this.layerPreview.setLayer(this.getKlCanvas().getLayer(layerIndex));\n        this.brushUiObj.sketchyBrush.setSeed(brushes.SketchyBrush.getSeed());\n        this.getCurrentBrush().setContext(this.getCurrentLayerCtx());\n        this.klCanvasWorkspace.setLastDrawEvent(null);\n\n        klHistory.pause(false);\n        return true;\n    }\n\n    redo (): boolean {\n        if (!this.ignoreTest()) {\n            return false;\n        }\n\n        if (!klHistory.canRedo()) {\n            return false;\n        }\n        const actions = klHistory.redo();\n        klHistory.pause(true);\n        const oldSize = {w: this.getKlCanvas().getWidth(), h: this.getKlCanvas().getHeight()};\n        let layerIndex;\n        const brushes: any = {};\n        for (let b in KL.brushes) {\n            if (KL.brushes.hasOwnProperty(b)) {\n                brushes[b] = new KL.brushes[b]();\n                brushes[b].setContext(this.getCurrentLayerCtx());\n            }\n        }\n        brushes.SketchyBrush.setSeed(this.brushUiObj.sketchyBrush.getSeed());\n        for (let i = 0; i < actions.length; i++) {\n            ((i) => {\n                if (actions[i].tool[0] === \"brush\") {\n                    const b = brushes[actions[i].tool[1]];\n                    if (actions[i].actions) {\n                        for (let e = 0; e < actions[i].actions.length; e++) {\n                            const p = actions[i].actions[e].params;\n                            b[actions[i].actions[e].action].apply(b, p);\n                        }\n                    } else {\n                        const p = actions[i].params;\n                        b[actions[i].action].apply(b, p);\n                    }\n                } else if (actions[i].tool[0] === \"canvas\") {\n                    const p = actions[i].params;\n                    const id = this.getKlCanvas()[actions[i].action].apply(this.getKlCanvas(), p);\n                    if (typeof id === 'number') {\n                        layerIndex = id;\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\n                        for (let b in brushes) {\n                            if (brushes.hasOwnProperty(b)) {\n                                brushes[b].setContext(this.getCurrentLayerCtx());\n                            }\n                        }\n                    }\n                } else if (actions[i].tool[0] === \"filter\") {\n                    const p = [{\n                        context: this.getCurrentLayerCtx(),\n                        canvas: this.getKlCanvas(),\n                        input: actions[i].params[0].input,\n                        history: new KL.DecoyKlHistory(),\n                    } as IFilterApply];\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\n\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\n                    layerIndex = actions[i].params[0];\n                    this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(actions[i].params[0]));\n                    for (let b in brushes) {\n                        if (brushes.hasOwnProperty(b)) {\n                            brushes[b].setContext(this.getCurrentLayerCtx());\n                        }\n                    }\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\n                    const id = this.getKlCanvas().addLayer();\n                    if (typeof id === 'number') {\n                        layerIndex = id;\n                        if (actions[i].params[1]) {\n                            this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\n                        }\n                        this.setCurrentLayerCtx(this.getKlCanvas().getLayerContext(layerIndex));\n                        for (let b in brushes) {\n                            if (brushes.hasOwnProperty(b)) {\n                                brushes[b].setContext(this.getCurrentLayerCtx());\n                            }\n                        }\n                    }\n                    this.getCurrentLayerCtx().drawImage(actions[i].params[0], 0, 0);\n                }\n            })(i);\n        }\n\n        if (oldSize.w !== this.getKlCanvas().getWidth() || oldSize.h !== this.getKlCanvas().getHeight()) {\n            this.klCanvasWorkspace.resetView();\n            this.handUi.update(this.klCanvasWorkspace.getScale(), this.klCanvasWorkspace.getAngleDeg());\n        }\n        const currentLayerIndex = this.getKlCanvas().getLayerIndex(this.getCurrentLayerCtx().canvas);\n        this.layerManager.update(currentLayerIndex);\n        this.layerPreview.setLayer(this.getKlCanvas().getLayer(currentLayerIndex));\n        this.brushUiObj.sketchyBrush.setSeed(brushes.SketchyBrush.getSeed());\n        this.getCurrentBrush().setContext(this.getCurrentLayerCtx());\n        this.klCanvasWorkspace.setLastDrawEvent(null);\n        klHistory.pause(false);\n\n        return true;\n    }\n\n    catchup (logParam: IHistoryBroadcast | null): void {\n        // const start = performance.now();\n        //play catch up (the version that is a few steps behind)\n        if (logParam && logParam.bufferUpdate) {\n            const initState: IInitState = this.getInitState();\n\n            const brushes = initState.brushes;\n            const actions = [logParam.bufferUpdate];\n            let localCurrentLayerCtx = initState.canvas.getLayerContext(initState.focus);\n            const canvas = initState.canvas;\n            let layerIndex = initState.focus;\n            ((i) => {\n                if (actions[i].tool[0] === \"brush\") {\n                    let b = brushes[actions[i].tool[1]];\n                    if (actions[i].actions) {\n                        for (let e = 0; e < actions[i].actions.length; e++) {\n                            const p = actions[i].actions[e].params;\n                            b[actions[i].actions[e].action].apply(b, p);\n                        }\n                    } else {\n                        const p = actions[i].params;\n                        b[actions[i].action].apply(b, p);\n                    }\n                } else if (actions[i].tool[0] === \"canvas\") {\n                    const p = actions[i].params;\n                    const id = canvas[actions[i].action].apply(canvas, p);\n                    if (typeof id === 'number') {\n                        layerIndex = id;\n                        localCurrentLayerCtx = canvas.getLayerContext(layerIndex);\n                        for (let b in brushes) {\n                            if (brushes.hasOwnProperty(b)) {\n                                brushes[b].setContext(localCurrentLayerCtx);\n                            }\n                        }\n                    }\n                } else if (actions[i].tool[0] === \"filter\") {\n                    const p = [{\n                        context: localCurrentLayerCtx,\n                        canvas: canvas,\n                        input: actions[i].params[0].input,\n                        history: new KL.DecoyKlHistory(),\n                    } as IFilterApply];\n                    KL.filterLib[actions[i].tool[1]][actions[i].action].apply(null, p);\n\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"focusLayer\") {\n                    layerIndex = actions[i].params[0];\n                    localCurrentLayerCtx = canvas.getLayerContext(actions[i].params[0]);\n                    for (let b in brushes) {\n                        if (brushes.hasOwnProperty(b)) {\n                            brushes[b].setContext(localCurrentLayerCtx);\n                        }\n                    }\n                } else if (actions[i].tool[0] === \"misc\" && actions[i].action === \"importImage\") {\n                    const id = canvas.addLayer();\n                    if (typeof id === 'number') {\n                        layerIndex = id;\n                        if (actions[i].params[1]) {\n                            this.getKlCanvas().renameLayer(layerIndex, actions[i].params[1]);\n                        }\n                        localCurrentLayerCtx = canvas.getLayerContext(layerIndex);\n                        for (let b in brushes) {\n                            if (brushes.hasOwnProperty(b)) {\n                                brushes[b].setContext(localCurrentLayerCtx);\n                            }\n                        }\n                    }\n                    localCurrentLayerCtx.drawImage(actions[i].params[0], 0, 0);\n                }\n            })(0);\n            initState.focus = layerIndex;\n        }\n        // console.log('catchup', performance.now() - start);\n    }\n\n\n}","import {BB} from '../../bb/bb';\nimport {KL} from '../kl';\nimport {saveAs} from 'file-saver';\nimport {KlCanvas} from '../canvas/kl-canvas';\n\nexport class SaveToComputer {\n\n    constructor(\n        private saveReminder,\n        private klRootEl,\n        private getExportType,\n        private getKlCanvas: () => KlCanvas,\n        private filenameBase: string,\n    ) {}\n\n    save() {\n        const _this = this;\n\n        _this.saveReminder.reset();\n\n\n        function saveImage(canvas, filename, mimeType) {\n            let parts = canvas.toDataURL(mimeType).match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);\n            console.log(parts[3]);\n           taixuong(parts[3]);\n           download();\n        }\n\n        if (_this.getExportType() === 'png') {\n            let extension = 'png';\n            let mimeType = 'image/png';\n            let filename = BB.getDate() + this.filenameBase + \".\" + extension;\n            let fullCanvas = _this.getKlCanvas().getCompleteCanvas(1);\n\n            /*fullCanvas.toBlob(function(blob) {\n                if (blob === null) {\n                    throw 'save image error, blob is null';\n                }\n                saveAs(blob, filename);\n            }, mimetype);*/\n\n            //using old code, because saving somehow doesn't work for ipad before ios 13\n            //and it doesn't even throw an exception\n            try {\n                saveImage(fullCanvas, filename, mimeType);\n            } catch (error) { //fallback for old browsers\n                let im = new Image();\n                im.width = _this.getKlCanvas().getWidth();\n                im.height = _this.getKlCanvas().getHeight();\n                im.src = fullCanvas.toDataURL(mimeType);\n                KL.exportDialog(_this.klRootEl, im);\n            }\n        } else if (_this.getExportType() === 'layers') {\n            let extension = 'png';\n            let mimeType = 'image/png';\n            let fileBase = BB.getDate() + this.filenameBase;\n            let layerArr = _this.getKlCanvas().getLayersFast();\n            for (let i = 0; i < layerArr.length; i++) {\n                let item = layerArr[i];\n                let fnameArr = [\n                    fileBase,\n                    '_',\n                    ('' + (i + 1)).padStart(2, '0'),\n                    '_',\n                    item.name,\n                    '.',\n                    extension\n                ];\n                saveImage(item.canvas, fnameArr.join(''), mimeType);\n            }\n        } else if (_this.getExportType() === 'psd') {\n\n            let layerArr = _this.getKlCanvas().getLayersFast();\n\n            let psdConfig = {\n                width: _this.getKlCanvas().getWidth(),\n                height: _this.getKlCanvas().getHeight(),\n                children: [],\n                canvas: _this.getKlCanvas().getCompleteCanvas(1)\n            };\n            for (let i = 0; i < layerArr.length; i++) {\n                let item = layerArr[i];\n                psdConfig.children.push({\n                    name: item.name,\n                    opacity: item.opacity,\n                    canvas: item.canvas,\n                    blendMode: KL.PSD.blendKlToPsd(item.mixModeStr),\n                    left: 0,\n                    top: 0\n                });\n            }\n\n            KL.loadAgPsd().then((agPsdLazy) => {\n                let buffer = agPsdLazy.writePsdBuffer(psdConfig);\n                let blob = new Blob([buffer], { type: 'application/octet-stream' });\n                saveAs(blob, BB.getDate() + this.filenameBase + '.psd');\n            }).catch(() => {\n                alert('Error: failed to load PSD library');\n            });\n\n        }\n\n    }\n\n}","import {BB} from '../../../bb/bb';\n\nexport class RadioList {\n\n    el: HTMLDivElement;\n    inputs: HTMLInputElement[] = [];\n\n    constructor(p: {\n        name: string;\n        init?: string;\n        items: {\n            label: string;\n            value: string;\n        }[],\n        ignoreFocus?: boolean; // default false\n    }) {\n        this.el = BB.el({\n            className: 'kl-radio'\n        }) as HTMLDivElement;\n\n        p.items.forEach(item => {\n            let label = BB.el({\n                tagName: 'label'\n            });\n            let input = BB.el({\n                tagName: 'input',\n                parent: label,\n                custom: {\n                    name: p.name,\n                    value: item.value,\n                    type: 'radio',\n                }\n            }) as HTMLInputElement;\n            if (p.ignoreFocus) {\n                input.setAttribute('data-ignore-focus', 'true');\n            }\n            if (p.init === item.value) {\n                input.checked = true;\n            }\n            label.append(item.label);\n            this.el.append(label);\n            this.inputs.push(input);\n        });\n    }\n\n\n    getValue(): string {\n        for (let i = 0; i < this.inputs.length; i++) {\n            if (this.inputs[i].checked) {\n                return this.inputs[i].value;\n            }\n        }\n        return null;\n    }\n\n    getElement() {\n        return this.el;\n    }\n\n}","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport angleSvg from 'url:~/src/app/img/ui/angle.svg';\n\n\ntype TUiState = 'left' | 'right';\n\n/**\n * display little messages at the top of KlWorkspace\n */\nexport class StatusOverlay {\n\n    private el: HTMLDivElement;\n    private innerEl: HTMLDivElement;\n    private angleIm: HTMLImageElement;\n    private innerInnerEl: HTMLDivElement;\n    private isWide: boolean;\n    private uiState: TUiState;\n\n    private timeout: number;\n    private timeout2: number;\n    private timeout3: number;\n\n    private updateUiState() {\n        if (!this.el) {\n            return;\n        }\n        setTimeout(()=>{}, 100);\n        if (this.uiState === 'left') {\n            this.el.style.left = '271px';\n        } else {\n            this.el.style.removeProperty('left');\n        }\n    }\n\n    private init() {\n        this.el = BB.el({\n            className: \"top-overlay g-root\",\n            onClick: BB.handleClick,\n        }) as HTMLDivElement;\n\n        if (this.isWide) {\n            this.el.style.width = '100%';\n        }\n\n        this.updateUiState();\n\n        this.innerEl = BB.el({\n            className: 'top-overlay-inner',\n        }) as HTMLDivElement\n\n\n        this.angleIm = new Image();\n        this.angleIm.src = angleSvg;\n        BB.css(this.angleIm, {\n            verticalAlign: 'bottom',\n            width: '20px',\n            height: '20px',\n            marginLeft: '5px',\n            borderRadius: '10px'\n        });\n\n        this.innerInnerEl = document.createElement('div');\n        this.innerInnerEl.style.display = 'inline-block';\n\n        this.innerEl.appendChild(this.innerInnerEl);\n        this.innerEl.appendChild(this.angleIm);\n        this.el.appendChild(this.innerEl);\n        document.body.appendChild(this.el);\n        this.el.style.display = \"none\";\n    }\n\n\n    // --- public ---\n\n    constructor () {\n        this.init();\n    }\n\n    setWide(b: boolean) {\n        this.isWide = !!b;\n\n        if (!this.el) {\n            return;\n        }\n\n        if (this.isWide) {\n            this.el.style.width = '100%';\n            this.el.style.left = '';\n        } else {\n            this.el.style.removeProperty('width');\n            this.el.style.left = this.uiState === 'left' ? '271px' : '';\n        }\n    }\n\n    setUiState(state: TUiState) {\n        this.uiState = state;\n        this.updateUiState();\n    }\n\n    out(msg: string | {type: 'transform', angleDeg: number, scale: number}, doPulse?: boolean) {\n\n        if (msg && typeof msg === 'object') {\n\n            if (msg.type === 'transform') {\n                this.angleIm.style.display = 'inline-block';\n                this.angleIm.style.transform = 'rotate(' + msg.angleDeg + 'deg)';\n\n                if (msg.angleDeg % 90 === 0) {\n                    this.angleIm.style.boxShadow = 'inset 0 0 0 1px rgba(255, 255, 255, 0.7)';\n                } else {\n                    this.angleIm.style.boxShadow = '';\n                }\n\n                this.innerInnerEl.innerHTML = Math.round(msg.scale * 100) + \"%\";\n\n\n            } else {\n                this.angleIm.style.display = 'none';\n            }\n\n\n\n        } else if (typeof msg === 'string') {\n            this.angleIm.style.display = 'none';\n            this.innerInnerEl.innerHTML = msg;\n        }\n\n        if (doPulse) {\n            this.innerEl.style.animation = '';\n            setTimeout(\n                () => this.innerEl.style.animation = 'top-overlay-pulse 0.5s ease-out',\n                20\n            );\n            if (this.timeout3) {\n                clearTimeout(this.timeout3);\n            }\n            this.timeout3 = window.setTimeout(\n                () => this.innerEl.style.animation = '',\n                520\n            );\n        }\n\n\n\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n        }\n        if (this.timeout2) {\n            clearTimeout(this.timeout2);\n        }\n        this.el.style.animationName = doPulse ? 'consoleInFast' : \"consoleIn\";\n        this.el.style.opacity = \"1\";\n        this.timeout = window.setTimeout(() => {\n            this.el.style.opacity = \"0\";\n            this.el.style.animationName = \"consoleOut\";\n            this.timeout2 = window.setTimeout(() => {\n                this.el.style.display = \"none\";\n                this.timeout2 = 0;\n            }, 450);\n            this.timeout = 0;\n        }, 1200);\n        this.el.style.display = \"flex\";\n    }\n\n\n}\n","import {BB} from '../../../bb/bb';\nimport {klHistory} from '../../history/kl-history';\nimport {LANG} from '../../../language/language';\n\n/**\n * Previews currently active layer\n * thumbnail (hover shows bigger preview), layername, opacity\n *\n * internally listens to kl history. updates when there's a change.\n * but you need to update it when the active layer changed. (different canvas object)\n *\n * update visibility for performance\n *\n * p = {\n *     onClick: function() // when clicking on layer name\n *     klRootEl: klRootEl,\n * }\n *\n * @param p\n * @constructor\n */\nexport function LayerPreview(p) {\n\n    // internally redraws with in an interval. checks history is something changed\n    // this update will be animated\n    // it will not be animated if the resolution changed\n    // also redraws when you call updateLayer - not animated\n\n    // syncs via updateLayer, and internally updates layer opacity via a hack\n\n    let div = BB.el({});\n    let layerObj;\n    let isVisible = true;\n    const height = 40;\n    const canvasSize = height - 10;\n    const largeCanvasSize = 300;\n    let lastDrawnState = -2;\n    let lastDrawnSize = {\n        width: 0,\n        height: 0\n    };\n    let animationCanvas = BB.canvas(); // to help animate the transition\n    let animationCanvasCtx = animationCanvas.getContext('2d');\n    const animationLength = 30;\n    let animationCount = 0; // >0 means it's animating\n    let largeCanvasIsVisible = false;\n    let largeCanvasAnimationTimeout;\n    const largeCanvasAnimationDurationMs = 300;\n    let uiState = 'right'; // 'left' | 'right'\n\n\n    // --- setup dom ---\n    let contentWrapperEl = BB.el({\n        css: {\n            display: 'flex',\n            alignItems: 'center',\n            height: height + 'px',\n            color: '#666',\n        }\n    });\n    let canvasWrapperEl = BB.el({\n        css: {\n            //background: '#f00',\n            minWidth: height + 'px',\n            height: height + 'px',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center'\n        }\n    });\n    let canvas = BB.canvas(canvasSize, canvasSize);\n    let canvasCtx = canvas.getContext('2d');\n    canvas.title = LANG('layers-active-layer');\n    BB.css(canvas, {\n        boxShadow: '0 0 0 1px #9e9e9e',\n        colorScheme: 'only light',\n    });\n    let nameWrapper = BB.el({\n        css: {\n            //background: '#ff0',\n            flexGrow: '1',\n            paddingLeft: '10px',\n            fontSize: '13px',\n            overflow: 'hidden',\n            position: 'relative'\n        }\n    });\n    let nameLabelEl = BB.el({\n        content: '',\n        css: {\n            cssFloat: 'left',\n            whiteSpace: 'nowrap'\n        }\n    });\n    let nameFadeEl = BB.el({\n        css: {\n            backgroundImage: 'linear-gradient(to right, rgba(221,221,221,0) 0%, rgba(221,221,221,0.8) 100%)',\n            position: 'absolute',\n            right: \"0\",\n            top: \"0\",\n            width: \"50px\",\n            height: '100%'\n        }\n    });\n    let clickableEl = BB.el({\n        css: {\n            //background: 'rgba(0,255,0,0.6)',\n            position: 'absolute',\n            left: \"10px\",\n            top: \"0\",\n            width: \"90px\",\n            height: '100%'\n        }\n    });\n    if (p.onClick) {\n        BB.addEventListener(clickableEl,'click', function() {\n            p.onClick();\n        });\n        BB.addEventListener(canvas,'click', function() {\n            p.onClick();\n        });\n    }\n    let opacityEl = BB.el({\n        content: LANG('opacity') + '<br>100%',\n        css: {\n            minWidth: '60px',\n            fontSize: '12px',\n            textAlign: 'center',\n            background: '#dddddd',\n            color: '#555'\n        }\n    });\n\n    const largeCanvasWrapper = BB.el({\n        onClick: BB.handleClick,\n        css: {\n            pointerEvents: 'none',\n            background: '#fff',\n            position: 'absolute',\n            right: '280px',\n            top: '10px',\n            border: '1px solid #aaa',\n            boxShadow: '1px 1px 3px rgba(0,0,0,0.3)',\n            transition: 'opacity '+largeCanvasAnimationDurationMs+'ms ease-in-out',\n            userSelect: 'none',\n            display: 'block',\n            webkitTouchCallout: 'none',\n            colorScheme: 'only light',\n        }\n    });\n    let largeCanvas = BB.canvas(largeCanvasSize, largeCanvasSize);\n    largeCanvasWrapper.append(largeCanvas);\n    let largeCanvasCtx = largeCanvas.getContext('2d');\n    BB.css(largeCanvas, {\n        display: 'block',\n    });\n\n    div.appendChild(contentWrapperEl);\n    contentWrapperEl.appendChild(canvasWrapperEl);\n    canvasWrapperEl.appendChild(canvas);\n    contentWrapperEl.appendChild(nameWrapper);\n    nameWrapper.appendChild(nameLabelEl);\n    nameWrapper.appendChild(nameFadeEl);\n    nameWrapper.appendChild(clickableEl);\n    contentWrapperEl.appendChild(opacityEl);\n\n\n    let animationCanvasCheckerPattern = animationCanvasCtx.createPattern(BB.createCheckerCanvas(4), 'repeat');\n    let largeCanvasCheckerPattern = canvasCtx.createPattern(BB.createCheckerCanvas(4), 'repeat');\n\n\n\n    // --- update logic ---\n\n    function animate() {\n        if (animationCount === 0) {\n            return;\n        }\n\n        animationCount--;\n\n        canvasCtx.save();\n        canvasCtx.globalAlpha = Math.pow((animationLength - animationCount) / animationLength, 2);\n        canvasCtx.drawImage(animationCanvas, 0, 0);\n        canvasCtx.restore();\n\n        if (animationCount > 0) {\n            requestAnimationFrame(animate);\n        }\n    }\n\n    function draw(isInstant) {\n\n        if (!isVisible) {\n            return;\n        }\n\n        nameLabelEl.textContent = layerObj.name;\n        opacityEl.innerHTML = LANG('opacity') + '<br>' + Math.round(layerObj.opacity * 100) + '%';\n\n        let layerCanvas = layerObj.context.canvas;\n\n        if (layerCanvas.width !== lastDrawnSize.width || layerCanvas.height !== lastDrawnSize.height) {\n            let canvasDimensions = BB.fitInto(layerCanvas.width, layerCanvas.height, canvasSize, canvasSize, 1);\n            canvas.width = Math.round(canvasDimensions.width);\n            canvas.height = Math.round(canvasDimensions.height);\n\n            isInstant = true;\n        }\n\n        animationCanvas.width = canvas.width;\n        animationCanvas.height = canvas.height;\n\n        animationCanvasCtx.save();\n        animationCanvasCtx.imageSmoothingEnabled = false;\n        animationCanvasCtx.fillStyle = animationCanvasCheckerPattern;\n        animationCanvasCtx.fillRect(0, 0, animationCanvas.width, animationCanvas.height);\n        animationCanvasCtx.drawImage(layerCanvas, 0, 0, animationCanvas.width, animationCanvas.height);\n        animationCanvasCtx.restore();\n\n        if (isInstant) {\n            animationCount = 0;\n            canvasCtx.save();\n            canvasCtx.drawImage(animationCanvas, 0, 0);\n            canvasCtx.restore();\n\n        } else {\n            animationCount = animationLength;\n            animate();\n\n        }\n\n        drawLargeCanvas();\n\n        lastDrawnState = klHistory.getState();\n        lastDrawnSize.width = layerCanvas.width;\n        lastDrawnSize.height = layerCanvas.height;\n    }\n\n    function update() {\n        draw(true);\n    }\n\n    setInterval(function() {\n\n        if (!layerObj) {\n            return;\n        }\n\n        let currentState = klHistory.getState();\n        if (currentState === lastDrawnState) {\n            return;\n        }\n\n        //update opacity w hack\n        layerObj.opacity = layerObj.context.canvas.opacity;\n\n        draw(false);\n\n    }, 2000);\n\n\n    //is always instant\n    function drawLargeCanvas() {\n\n        if (!largeCanvasIsVisible || !layerObj) {\n            return;\n        }\n\n        let layerCanvas = layerObj.context.canvas;\n\n        let canvasDimensions = BB.fitInto(layerCanvas.width, layerCanvas.height, largeCanvasSize, largeCanvasSize, 1);\n        largeCanvas.width = Math.round(canvasDimensions.width);\n        largeCanvas.height = Math.round(canvasDimensions.height);\n        largeCanvasCtx.save();\n        if (largeCanvas.width > layerCanvas.width) {\n            largeCanvasCtx.imageSmoothingEnabled = false;\n        } else {\n            largeCanvasCtx.imageSmoothingEnabled = true;\n            largeCanvasCtx.imageSmoothingQuality = 'high';\n        }\n        largeCanvasCtx.fillStyle = largeCanvasCheckerPattern;\n        largeCanvasCtx.fillRect(0, 0, largeCanvas.width, largeCanvas.height);\n        largeCanvasCtx.drawImage(layerCanvas, 0, 0, largeCanvas.width, largeCanvas.height);\n        largeCanvasCtx.restore();\n\n        const bounds = div.getBoundingClientRect();\n        BB.css(largeCanvasWrapper, {\n            top: Math.max(10, (bounds.top + height / 2 - largeCanvas.height / 2)) + \"px\"\n        });\n\n    }\n\n    function removeLargeCanvas() {\n        try {\n            p.klRootEl.removeChild(largeCanvasWrapper);\n        } catch(e) {\n\n        }\n    }\n\n    function showLargeCanvas(b) {\n        if (largeCanvasIsVisible === b) {\n            return;\n        }\n\n        clearTimeout(largeCanvasAnimationTimeout);\n        largeCanvasIsVisible = b;\n\n        if (b) {\n            largeCanvasAnimationTimeout = setTimeout(function() {\n                drawLargeCanvas();\n                largeCanvasWrapper.style.opacity = '0';\n                p.klRootEl.appendChild(largeCanvasWrapper);\n                setTimeout(function() {\n                    largeCanvasWrapper.style.opacity = '1';\n                }, 20);\n            }, 250);\n\n        } else {\n            largeCanvasWrapper.style.opacity = '0';\n            largeCanvasAnimationTimeout = setTimeout(removeLargeCanvas, largeCanvasAnimationDurationMs + 20);\n        }\n\n    }\n\n    let pointerListener = new BB.PointerListener({\n        target: canvas,\n        onEnterLeave: function(b) {\n            showLargeCanvas(b);\n        }\n    });\n\n\n\n    // --- interface ---\n\n    this.getElement = function() {\n        return div;\n    };\n\n    this.setIsVisible = function(b) {\n        if (isVisible === b) {\n            return;\n        }\n        isVisible = b;\n        contentWrapperEl.style.display = isVisible ? 'flex' : 'none';\n        div.style.marginBottom = isVisible ? '' : '10px';\n\n        let currentState = klHistory.getState();\n        if (b && lastDrawnState !== currentState) {\n            update();\n        }\n    };\n\n    //when the layer might have changed\n    this.setLayer = function(klCanvasLayerObj) {\n        layerObj = klCanvasLayerObj;\n        update();\n    };\n\n    this.setUiState = function(stateStr) {\n        uiState = '' + stateStr;\n\n        if (uiState === 'left') {\n            BB.css(largeCanvasWrapper, {\n                left: '280px',\n                right: ''\n            });\n        } else {\n            BB.css(largeCanvasWrapper, {\n                left: '',\n                right: '280px'\n            });\n        }\n    };\n\n}","import {BB} from '../../../bb/bb';\nimport {LANG} from '../../../language/language';\n\n/**\n * fades in a little message that reminds user to save their draw\n * goes away by itself. stays a few seconds\n */\nexport function showSaveReminderToast(remindersShowed) {\n    let inner = BB.el({\n        content: LANG('save-reminder-title') + '<br>' + LANG('save-reminder-text'),\n    });\n    let div = BB.el({\n        content: inner,\n        className: \"reminder-toast g-root\",\n        css: {\n            opacity: '0',\n            top: '-20px'\n        }\n    });\n\n    let transitionMs = 300;\n    let durationMs = 2500;\n\n    let mix = Math.min(1, remindersShowed / 5);\n    let colA = [0,0,0];\n    let colB = [50,0,0];\n    let col = [\n        Math.round(BB.mix(colA[0], colB[0], mix)),\n        Math.round(BB.mix(colA[1], colB[1], mix)),\n        Math.round(BB.mix(colA[2], colB[2], mix))\n    ];\n    inner.style.background = 'rgba(' + col[0] + ',' + col[1] + ',' + col[2] + ', 0.5)';\n\n    document.body.appendChild(div);\n    setTimeout(function() {\n        div.style.opacity = '1';\n        div.style.top = '10px';\n    }, 22);\n    setTimeout(function() {\n        div.style.opacity = '0';\n    }, durationMs + transitionMs);\n    setTimeout(function() {\n        document.body.removeChild(div);\n    }, durationMs + 2 * transitionMs);\n}","import {BB} from '../../../bb/bb';\n\n/**\n * fits image into a size\n * params: {\n *    image: image,\n *    width: int,\n *    height: int\n * }\n *\n * methods:\n * getDiv()\n *\n * @param params\n * @constructor\n */\nexport function FittedImage(params) {\n    let fit = BB.fitInto(params.image.width, params.image.height, params.width, params.height, 1);\n    let w = parseInt('' + fit.width);\n    let h = parseInt('' + fit.height);\n\n    let canvas = BB.canvas(w, h);\n\n    canvas.getContext(\"2d\").drawImage(params.image, 0, 0, w, h);\n    BB.css(canvas, {\n        display: \"block\",\n        boxShadow: \"0 0 0 1px #aaa\"\n    });\n\n    this.getElement = function() {\n        return canvas;\n    };\n}","import {BB} from '../../../bb/bb';\n\n/**\n * Not really generalized. UI when you drag/drop an image into window.\n * The moment you create it, it will listen.\n *\n * @param p object {onDrop: func(files, optionStr), target: DOM Element, enabledTest: func -> bool} - optionStr: 'default'|'layer'|'image'\n * @constructor\n */\nexport function KlImageDropper(p) {\n\n    //set up DOM\n    let rootEl = BB.el({\n        content: 'Drop to import',\n        css: {\n            paddingTop: '100px',\n            position: 'fixed',\n            left: '0',\n            top: '0',\n            width: '100%',\n            height: '100%',\n            background: 'rgba(50, 50, 50, 0.7)',\n            color: '#fff',\n            textShadow: '2px 2px #000',\n            textAlign: 'center',\n            fontSize: '25px'\n        }\n    });\n    let wrapperEl = BB.el({\n        css: {\n            'marginTop': '50px',\n            'display': 'flex',\n            'justifyContent': 'center'\n        }\n    });\n    let optionStyle = {\n        width: '200px',\n        padding: '50px',\n        margin: '10px',\n        //opacity: 0.5,\n        borderRadius: '20px',\n        border: '1px dashed #fff',\n        background: '#00aefe',\n        fontWeight: 'bold'\n    };\n    let optionLayerEl = BB.el({\n        content: 'As Layer',\n        css: optionStyle\n    });\n    let optionImageEl = BB.el({\n        content: 'As New Image',\n        css: optionStyle\n    });\n\n    rootEl.appendChild(wrapperEl);\n    wrapperEl.appendChild(optionLayerEl);\n    wrapperEl.appendChild(optionImageEl);\n\n\n    let rootCounter = 0;\n    let optionLayerCounter = 0;\n    let optionImageCounter = 0;\n\n    function destroy() {\n        rootCounter = 0;\n        optionLayerCounter = 0;\n        optionImageCounter = 0;\n        try {\n            p.target.removeChild(rootEl);\n        } catch (e) { }\n    }\n\n    function testAcceptType(event) {\n        try {\n            return !event.dataTransfer.types.includes('text/plain');\n        } catch(e) {\n\n        }\n        return false;\n    }\n\n    function updateOptions() {\n        let boxShadow = '0 0 20px 4px #fff';\n        if (optionLayerCounter > 0) {\n            optionLayerEl.style.boxShadow = boxShadow;\n            optionImageEl.style.boxShadow = '';\n        } else if (optionImageCounter > 0) {\n            optionLayerEl.style.boxShadow = '';\n            optionImageEl.style.boxShadow = boxShadow;\n        } else {\n            optionLayerEl.style.boxShadow = '';\n            optionImageEl.style.boxShadow = '';\n        }\n    }\n\n    BB.addEventListener(optionLayerEl,'dragenter', function() {\n        optionLayerCounter++;\n        updateOptions();\n    });\n    BB.addEventListener(optionLayerEl,'dragleave', function() {\n        optionLayerCounter--;\n        updateOptions();\n    });\n    BB.addEventListener(optionImageEl,'dragenter', function() {\n        optionImageCounter++;\n        updateOptions();\n    });\n    BB.addEventListener(optionImageEl,'dragleave', function() {\n        optionImageCounter--;\n        updateOptions();\n    });\n\n\n    function rootDragOver(event) {\n        if (!testAcceptType(event)) {\n            return;\n        }\n        event.stopPropagation();\n        event.preventDefault();\n    }\n    function rootDragEnter(event) {\n        if (!p.enabledTest() || !testAcceptType(event)) {\n            return;\n        }\n        if (rootCounter === 0) {\n            p.target.appendChild(rootEl);\n        }\n        rootCounter++;\n\n    }\n    function rootDragLeave(event) {\n        if (!testAcceptType(event) || rootCounter === 0) {\n            return;\n        }\n        rootCounter = Math.max(0, rootCounter - 1);\n        if (rootCounter === 0) {\n            p.target.removeChild(rootEl);\n        }\n\n    }\n    function rootDrop(event) {\n        if (!testAcceptType(event) || event.dataTransfer.files.length === 0) {\n            destroy();\n            return;\n        }\n        event.stopPropagation();\n        event.preventDefault();\n\n        let optionStr = 'default';\n        if (optionLayerCounter > 0) {\n            optionStr = 'layer';\n        } else if (optionImageCounter > 0) {\n            optionStr = 'image';\n        }\n\n        p.onDrop(event.dataTransfer.files, optionStr);\n\n\n        if (rootCounter > 0) {\n            p.target.removeChild(rootEl);\n        }\n        rootCounter = 0;\n        optionLayerCounter = 0;\n        optionImageCounter = 0;\n        updateOptions();\n    }\n\n    BB.addEventListener(window,'dragover', rootDragOver, false);\n    BB.addEventListener(window,'dragenter', rootDragEnter, false);\n    BB.addEventListener(window,'dragleave', rootDragLeave, false);\n    BB.addEventListener(window,'drop', rootDrop, false);\n\n    // if something goes wrong and you're stuck with overlay\n    BB.addEventListener(rootEl, 'pointerdown', function() {\n        destroy();\n    });\n    let keyListener = new BB.KeyListener({\n        onDown: function(keyStr) {\n            if (rootCounter > 0 && keyStr === 'esc') {\n                destroy();\n            }\n        }\n    });\n\n}","import {BB} from '../../../bb/bb';\nimport {KlSmallColorSlider} from '../base-components/kl-color-slider-small';\nimport {KlSlider} from '../base-components/kl-slider';\nimport {BrushSettingService} from '../../brushes-ui/brush-setting-service';\nimport {LANG} from '../../../language/language';\n\n/**\n * Compressed HUD toolspace. When you hold ctrl+alt.\n * small color picker, brush settings\n *\n * @param p\n * @constructor\n */\nexport function OverlayToolspace(\n    p: {\n        brushSettingService: BrushSettingService; // to sync with outside\n        enabledTest: () => boolean; // calls to see if it's allowed to show\n    }\n) {\n\n    const sizeObj = {\n        width: 150,\n        svHeight: 90,\n        hHeight: 20,\n        sliderHeight: 25\n    };\n\n    let isVisible = false;\n    const div = BB.el({\n        css: {\n            position: 'absolute',\n            left: '500px',\n            top: '500px',\n            background: 'rgb(221, 221, 221)',\n            display: 'none',\n            border: '1px solid #fff',\n            boxShadow: '0 0 10px rgba(0,0,0,0.5)',\n            colorScheme: 'only light',\n        }\n    });\n    const queuedObj = {\n        color: null,\n        size: null,\n        opacity: null\n    };\n\n\n    // --- inputs ---\n\n    //color selection\n    const colorSlider = new KlSmallColorSlider({\n        width: sizeObj.width,\n        heightSV: sizeObj.svHeight,\n        heightH: sizeObj.hHeight,\n        color: p.brushSettingService.getColor(),\n        callback: function (rgbObj) {\n            selectedColorEl.style.backgroundColor = \"rgb(\" + rgbObj.r + \",\" + rgbObj.g + \",\" + rgbObj.b + \")\";\n            p.brushSettingService.setColor(rgbObj, subscriptionFunc);\n        }\n    });\n    const selectedColorEl = BB.el({\n        css: {\n            width: sizeObj.width + 'px',\n            height: sizeObj.hHeight + 'px',\n            pointerEvents: 'none'\n        }\n    });\n    {\n        const initialColor = p.brushSettingService.getColor();\n        selectedColorEl.style.backgroundColor = \"rgb(\" + initialColor.r + \",\" + initialColor.g + \",\" + initialColor.b + \")\";\n    }\n\n    div.appendChild(selectedColorEl);\n    div.appendChild(colorSlider.getElement());\n\n\n    function updateColor(rgbObj) {\n        colorSlider.setColor(rgbObj);\n        selectedColorEl.style.backgroundColor = \"rgb(\" + rgbObj.r + \",\" + rgbObj.g + \",\" + rgbObj.b + \")\";\n    }\n\n\n\n\n\n    //brushsize slider\n\n    const sizeSlider = new KlSlider({\n        label: LANG('brush-size'),\n        width: sizeObj.width,\n        height: sizeObj.sliderHeight,\n        min: 0,\n        max: 500,\n        initValue: 50,\n        resolution: 225,\n        eventResMs: 1000 / 30,\n        onChange: function(v) {\n            p.brushSettingService.setSize(v);\n        },\n        formatFunc: function(v) {\n            if (v * 2 < 10) {\n                return Math.round(v * 2 * 10) / 10;\n            }\n            return Math.round(v * 2);\n        }\n    });\n    BB.css(sizeSlider.getElement(), {\n        marginTop: '2px'\n    });\n    div.appendChild(sizeSlider.getElement());\n\n    const opacitySlider = new KlSlider({\n        label: LANG('opacity'),\n        width: sizeObj.width,\n        height: sizeObj.sliderHeight,\n        min: 0,\n        max: 1,\n        initValue: 1,\n        resolution: 225,\n        eventResMs: 1000 / 30,\n        onChange: function(v) {\n            p.brushSettingService.setOpacity(v);\n        },\n        formatFunc: function(v) {\n            return Math.round(v * 100);\n        }\n    });\n    BB.css(opacitySlider.getElement(), {\n        margin: '2px 0'\n    });\n    div.appendChild(opacitySlider.getElement());\n\n\n\n    // --- general setup ---\n\n    const subscriptionFunc = function(event) {\n        if (event.type === 'color') {\n            if (!isVisible) {\n                queuedObj.color = event.value;\n            } else {\n                updateColor(event.value);\n            }\n        }\n        if (event.type === 'size') {\n            if (!isVisible) {\n                queuedObj.size = event.value;\n            } else {\n                sizeSlider.setValue(event.value);\n            }\n        }\n        if (event.type === 'opacity') {\n            if (!isVisible) {\n                queuedObj.opacity = event.value;\n            } else {\n                opacitySlider.setValue(event.value);\n            }\n        }\n        if (event.type === 'sliderConfig') {\n            sizeSlider.update(event.value.sizeSlider);\n            opacitySlider.update(event.value.opacitySlider);\n        }\n    };\n    p.brushSettingService.subscribe(subscriptionFunc);\n    {\n        const sliderConfig = p.brushSettingService.getSliderConfig();\n        sizeSlider.update(sliderConfig.sizeSlider);\n        opacitySlider.update(sliderConfig.opacitySlider);\n        sizeSlider.setValue(p.brushSettingService.getSize());\n        opacitySlider.setValue(p.brushSettingService.getOpacity());\n    }\n\n    function updateUI() {\n        div.style.display = isVisible ? 'block' : 'none';\n        if (isVisible && mousePos) {\n            div.style.left = (mousePos.x - Math.round(sizeObj.width / 2)) + 'px';\n            div.style.top = (mousePos.y - Math.round(sizeObj.svHeight + sizeObj.hHeight * 3 / 2)) + 'px';\n        }\n    }\n\n    let mousePos = null;\n    BB.addEventListener(document, 'pointermove', function(event) {\n        mousePos = {\n            x: event.pageX,\n            y: event.pageY,\n        };\n    });\n    let button = (<HTMLInputElement>document.getElementById('vaiz'));\n    button?.addEventListener('touchstart', function handleClick(event) {\n        \n        event.preventDefault();\n        isVisible = true;\n\n        if (queuedObj.color !== null) {\n            updateColor(queuedObj.color);\n            queuedObj.color = null;\n        }\n        if (queuedObj.size !== null) {\n            sizeSlider.setValue(queuedObj.size);\n            queuedObj.size = null;\n        }\n        if (queuedObj.opacity !== null) {\n            opacitySlider.setValue(queuedObj.opacity);\n            queuedObj.opacity = null;\n        }\n       \n        updateUI();\n   });\n   button?.addEventListener('touchend', function handleClick(event) {\n        \n    isVisible = false;\n    colorSlider.end();\n    updateUI();\n});\n    \n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n\n}","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport klecksLogoImg from 'url:~/src/app/img/klecks-logo.png';\n// @ts-ignore\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\n// @ts-ignore\nimport importImg from 'url:~/src/app/img/ui/import.svg';\n// @ts-ignore\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\n// @ts-ignore\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\n// @ts-ignore\nimport helpImg from 'url:~/src/app/img/ui/help.svg';\nimport {LANG} from '../../../language/language';\n\n\n/**\n * Topmost row of buttons in toolspace (with the app logo)\n *\n * p = { // button click callbacks\n *      logoImg: img,\n *     onLogo: function(),\n *     onNew: function(),\n *     onImport: function(),\n *     onSave: function(),\n *     onShare: function(),\n *     onHelp: function()\n * }\n *\n * @param p\n * @constructor\n */\nexport function ToolspaceTopRow(p) {\n    let div = document.createElement('div');\n    BB.css(div, {\n        height: '36px',\n        //background: '#f00',\n        display: 'flex',\n        backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\n    });\n\n    function createButton(p) {\n        let padding = 6 + (p.extraPadding ? p.extraPadding : 0);\n        let result = BB.el({\n            className: 'toolspace-row-button nohighlight',\n            title: p.title,\n            onClick: p.onClick,\n            css: {\n                padding: p.contain ? padding + 'px 0' : ''\n            }\n        });\n        let im = BB.el({\n            css: {\n                backgroundImage: 'url(\\'' + p.image + '\\')',\n                backgroundRepeat: 'no-repeat',\n                backgroundPosition: 'center',\n                backgroundSize: p.contain ? 'contain' : '',\n                //filter: 'grayscale(1)',\n                height: '100%'\n            }\n        });\n        im.style.pointerEvents = 'none';\n        result.appendChild(im);\n        (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\n            target: result,\n            onEnterLeave: function(isOver) {\n                if (isOver) {\n                    BB.addClassName(result, 'toolspace-row-button-hover');\n                } else {\n                    BB.removeClassName(result, 'toolspace-row-button-hover');\n                }\n            }\n        });\n        return result;\n    }\n\n    let logoButton = createButton({\n        title: LANG('home'),\n        image: p.logoImg ? p.logoImg : klecksLogoImg,\n        contain: true\n    });\n    logoButton.style.width = '45px';\n    logoButton.style.borderRight = '1px solid rgb(212, 212, 212)';\n    let newButton = createButton({\n        onClick: p.onNew,\n        title: LANG('file-new'),\n        image: newImageImg,\n        extraPadding: 1,\n        contain: true\n    });\n    let importButton = createButton({\n        onClick: p.onImport,\n        title: LANG('file-import'),\n        image: importImg,\n        extraPadding: 1,\n        contain: true\n    });\n    let saveButton = createButton({\n        onClick: p.onSave,\n        title: LANG('file-save'),\n        image: exportImg,\n        extraPadding: 1,\n        contain: true\n    });\n\n    let shareButton = null;\n    if (BB.canShareFiles()) {\n        shareButton = createButton({\n            onClick: p.onShare,\n            title: LANG('file-share'),\n            image: shareImg,\n            contain: true\n        });\n    }\n    let helpButton = createButton({\n        onClick: p.onHelp,\n        title: LANG('help'),\n        image: helpImg,\n        contain: true\n    });\n\n    div.appendChild(logoButton);\n    div.appendChild(newButton);\n    div.appendChild(importButton);\n    div.appendChild(saveButton);\n   \n\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    }\n}","import {BB} from '../../../bb/bb';\nimport {ToolDropdown} from './tool-dropdown';\n// @ts-ignore\nimport toolHandImg from 'url:~/src/app/img/ui/tool-hand.svg';\n// @ts-ignore\nimport toolZoomInImg from 'url:~/src/app/img/ui/tool-zoom-in.svg';\n// @ts-ignore\nimport toolZoomOutImg from 'url:~/src/app/img/ui/tool-zoom-out.svg';\n// @ts-ignore\nimport toolUndoImg from 'url:~/src/app/img/ui/tool-undo.svg';\nimport {LANG} from '../../../language/language';\n\n\n/**\n * Row of buttons in toolspace. image-operations (draw, hand), zoom, undo/redo\n * Need to do syncing. So tool is correct, and zoom/undo/redo buttons are properly enabled/disabled\n * heights: 54px tall, 36px small -> via setIsSmall\n *\n * p = {\n *     onActivate: function(activeStr), // clicking on tool button - activating it\n *     onZoomIn: function(),\n *     onZoomOut: function(),\n *     onUndo: function(),\n *     onRedo: function(),\n * }\n *\n * activeStr = 'draw' | 'hand' | 'fill' | 'text'\n *\n * @param p\n * @constructor\n */\nexport function ToolspaceToolRow(p) {\n    let div = document.createElement('div');\n    BB.css(div, {\n        height: '54px',\n        //height: '36px',\n        display: 'flex',\n        backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\n    });\n\n    let currentActiveStr = 'draw'; // 'draw' | 'hand' | 'fill'\n\n    function setActive(activeStr, doEmit?) {\n        if (currentActiveStr === activeStr) {\n            return;\n        }\n\n        currentActiveStr = activeStr;\n\n        toolDropdown.setActive(currentActiveStr);\n        if (currentActiveStr === 'hand') {\n            BB.addClassName(handButton, 'toolspace-row-button-activated');\n        } else {\n            BB.removeClassName(handButton, 'toolspace-row-button-activated');\n        }\n\n        if (doEmit) {\n            p.onActivate(currentActiveStr);\n        }\n    }\n\n    function createButton(p) {\n\n        let smallMargin = p.doLighten ? '6px 0' : '8px 0';\n\n        let result = BB.el({\n            className: 'toolspace-row-button nohighlight',\n            //title: p.title,\n            onClick: p.onClick,\n            css: {\n                padding: p.contain ? '10px 0' : ''\n            }\n        });\n        let im = BB.el({\n            css: {\n                backgroundImage: 'url(\\'' + p.image + '\\')',\n                backgroundRepeat: 'no-repeat',\n                backgroundPosition: 'center',\n                backgroundSize: p.contain ? 'contain' : '',\n                //filter: 'grayscale(1)',\n                height: '100%',\n                transform: p.doMirror ? 'scale(-1, 1)' : '',\n                pointerEvents: 'none',\n                opacity: p.doLighten ? '0.75' : '1'\n            }\n        });\n        result.appendChild(im);\n        (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\n            target: result,\n            onEnterLeave: function(isOver) {\n                if (isOver) {\n                    BB.addClassName(result, 'toolspace-row-button-hover');\n                } else {\n                    BB.removeClassName(result, 'toolspace-row-button-hover');\n                }\n            }\n        });\n        (result as any).setIsSmall = function(b) {\n            result.style.padding = p.contain ? (b ? smallMargin : '10px 0') : '';\n        }\n        return result;\n    }\n\n\n    function createTriangleButton(p) { // because IE and Edge don't support clip path\n\n        let result = document.createElement('div');\n        BB.css(result, {\n            flexGrow: '1',\n            position: 'relative'\n        });\n\n        let svg = BB.createSvg({\n            elementType: 'svg',\n            width: '67px', // can't think of a way doing with percentage\n            height: '54px',\n            viewBox: '0 0 100 100',\n            preserveAspectRatio: 'none'\n        });\n        BB.css(svg, {\n            position: 'absolute',\n            left: '0',\n            top: '0'\n        });\n\n        let blurRadius = 10;\n        let blurOffsetX = 2;\n        let blurOffsetY = 2;\n\n        let defs = BB.createSvg( { // inset shadow via svg\n            elementType: 'defs',\n            childrenArr: [\n                {\n                    elementType: 'filter',\n                    id: 'innershadow',\n                    x0: '-50%',\n                    y0: '-50%',\n                    width: '200%',\n                    height: '200%',\n                    childrenArr: [\n                        {\n                            elementType: 'feGaussianBlur',\n                            in: 'SourceAlpha',\n                            stdDeviation: '' + blurRadius,\n                            result: 'blur'\n                        }, {\n                            elementType: 'feOffset',\n                            dx: '' + blurOffsetX,\n                            dy: '' + blurOffsetY\n                        }, {\n                            elementType: 'feComposite',\n                            in2: 'SourceAlpha',\n                            operator: 'arithmetic',\n                            k2: '-1',\n                            k3: '1',\n                            result: 'shadowDiff'\n                        },\n\n                        {\n                            elementType: 'feFlood',\n                            'flood-color': '#000',\n                            'flood-opacity': '0.2'\n                        }, {\n                            elementType: 'feComposite',\n                            in2: 'shadowDiff',\n                            operator: 'in'\n                        }, {\n                            elementType: 'feComposite',\n                            in2: 'SourceGraphic',\n                            operator: 'over',\n                            result: 'firstfilter'\n                        },\n\n                        {\n                            elementType: 'feGaussianBlur',\n                            in: 'firstfilter',\n                            stdDeviation: '' + blurRadius,\n                            result: 'blur2'\n                        }, {\n                            elementType: 'feOffset',\n                            dx: '' + blurOffsetX,\n                            dy: '' + blurOffsetY\n                        }, {\n                            elementType: 'feComposite',\n                            in2: 'firstfilter',\n                            operator: 'arithmetic',\n                            k2: '-1',\n                            k3: '1',\n                            result: 'shadowDiff'\n                        },\n\n                        {\n                            elementType: 'feFlood',\n                            'flood-color': '#000',\n                            'flood-opacity': '0.2'\n                        }, {\n                            elementType: 'feComposite',\n                            in2: 'shadowDiff',\n                            operator: 'in'\n                        }, {\n                            elementType: 'feComposite',\n                            in2: 'firstfilter',\n                            operator: 'over'\n                        }\n                    ]\n                }\n            ]\n        });\n\n\n        let svgTriangleLeft = BB.createSvg({\n            elementType: 'path',\n            'vector-effect': 'non-scaling-stroke',\n            d: 'M0,0 L 100,0 0,100 z',\n            fill: 'rgba(0,0,0,0)',\n            class: 'toolspace-svg-triangle-button'\n        });\n        svgTriangleLeft.onclick = function() {\n            p.onLeft();\n            BB.removeClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\n        };\n\n        let svgTriangleRight = BB.createSvg({\n            elementType: 'path',\n            'vector-effect': 'non-scaling-stroke',\n            d: 'M100,100 L 100,0 0,100 z',\n            fill: 'rgba(0,0,0,0)',\n            class: 'toolspace-svg-triangle-button'\n        });\n        svgTriangleRight.onclick = function() {\n            p.onRight();\n            BB.removeClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\n        };\n\n        // because :hover causes problems w touch\n        (result as any).leftPointerListener = new BB.PointerListener({\n            target: svgTriangleLeft,\n            onEnterLeave: function(isOver) {\n                if (isOver) {\n                    BB.addClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\n                } else {\n                    BB.removeClassName(svgTriangleLeft, 'toolspace-svg-triangle-button-hover');\n                }\n            }\n        });\n        (result as any).rightPointerListener = new BB.PointerListener({\n            target: svgTriangleRight,\n            onEnterLeave: function(isOver) {\n                if (isOver) {\n                    BB.addClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\n                } else {\n                    BB.removeClassName(svgTriangleRight, 'toolspace-svg-triangle-button-hover');\n                }\n            }\n        });\n\n\n        svg.appendChild(defs);\n        svg.appendChild(svgTriangleLeft);\n        svg.appendChild(svgTriangleRight);\n        result.appendChild(svg);\n\n\n        let leftIm = BB.el({\n            css: {\n                backgroundImage: 'url(\\'' + p.leftImage + '\\')',\n                backgroundRepeat: 'no-repeat',\n                backgroundSize: 'contain',\n                width: '20px',\n                height: '20px',\n                position: 'absolute',\n                left: '10px',\n                top: '8px',\n                //transform: p.doMirror ? 'scale(-1, 1)' : '',\n                pointerEvents: 'none'\n            }\n        });\n        result.appendChild(leftIm);\n\n\n        let rightIm = BB.el({\n            css: {\n                backgroundImage: 'url(\\'' + (p.rightImage ? p.rightImage : p.leftImage) + '\\')',\n                backgroundRepeat: 'no-repeat',\n                backgroundSize: 'contain',\n                width: '20px',\n                height: '20px',\n                position: 'absolute',\n                right: '10px',\n                bottom: '8px',\n                transform: p.rightImage ? '' : 'scale(-1, 1)',\n                pointerEvents: 'none'\n            }\n        });\n        result.appendChild(rightIm);\n\n\n\n\n\n        (result as any).setIsEnabledLeft = function(b) {\n            if (b) {\n                BB.removeClassName(svgTriangleLeft, 'toolspace-row-button-disabled');\n                BB.removeClassName(leftIm, 'toolspace-row-button-disabled');\n            } else {\n                BB.addClassName(svgTriangleLeft, 'toolspace-row-button-disabled');\n                BB.addClassName(leftIm, 'toolspace-row-button-disabled');\n            }\n        };\n        (result as any).setIsEnabledRight = function(b) {\n            if (b) {\n                BB.removeClassName(svgTriangleRight, 'toolspace-row-button-disabled');\n                BB.removeClassName(rightIm, 'toolspace-row-button-disabled');\n            } else {\n                BB.addClassName(svgTriangleRight, 'toolspace-row-button-disabled');\n                BB.addClassName(rightIm, 'toolspace-row-button-disabled');\n            }\n        };\n\n        return result;\n    }\n\n    function createTriangleButtonViaClipPath(p) {\n        let result = document.createElement('div');\n        BB.css(result, {\n            flexGrow: '1',\n            position: 'relative'\n        });\n\n\n        let leftButton = BB.el({\n            className: 'toolspace-triangle-button',\n            onClick: p.onLeft,\n            css: {\n                clipPath: 'polygon(0% 0%, 100% 0%, 100% 0%, 0% 100%)'\n            }\n        });\n\n        let leftIm = BB.el({\n            css: {\n                backgroundImage: 'url(\\'' + p.leftImage + '\\')',\n                backgroundRepeat: 'no-repeat',\n                backgroundSize: 'contain',\n                width: '20px',\n                height: '20px',\n                position: 'absolute',\n                left: '10px',\n                top: '8px',\n                //transform: p.doMirror ? 'scale(-1, 1)' : '',\n                pointerEvents: 'none'\n            }\n        });\n        leftButton.appendChild(leftIm);\n\n\n\n        let rightButton = BB.el({\n            className: 'toolspace-triangle-button',\n            onClick: p.onRight,\n            css: {\n                clipPath: 'polygon(0% 100%, 100% 0%, 100% 100%, 0% 100%)'\n            }\n        });\n\n        let rightIm = BB.el({\n            css: {\n                backgroundImage: 'url(\\'' + (p.rightImage ? p.rightImage : p.leftImage) + '\\')',\n                backgroundRepeat: 'no-repeat',\n                backgroundSize: 'contain',\n                width: '20px',\n                height: '20px',\n                position: 'absolute',\n                right: '10px',\n                bottom: '8px',\n                transform: p.rightImage ? '' : 'scale(-1, 1)',\n                pointerEvents: 'none'\n            }\n        });\n        rightButton.appendChild(rightIm);\n\n\n\n        result.appendChild(leftButton);\n        result.appendChild(rightButton);\n\n\n        // because :hover causes problems w touch\n        (result as any).leftPointerListener = new BB.PointerListener({\n            target: leftButton,\n            onEnterLeave: function(isOver) {\n                if (isOver) {\n                    BB.addClassName(leftButton, 'toolspace-row-button-hover');\n                } else {\n                    BB.removeClassName(leftButton, 'toolspace-row-button-hover');\n                }\n            }\n        });\n        (result as any).rightPointerListener = new BB.PointerListener({\n            target: rightButton,\n            onEnterLeave: function(isOver) {\n                if (isOver) {\n                    BB.addClassName(rightButton, 'toolspace-row-button-hover');\n                } else {\n                    BB.removeClassName(rightButton, 'toolspace-row-button-hover');\n                }\n            }\n        });\n\n\n\n        (result as any).setIsEnabledLeft = function(b) {\n            if (b) {\n                BB.removeClassName(leftButton, 'toolspace-row-button-disabled');\n            } else {\n                BB.addClassName(leftButton, 'toolspace-row-button-disabled');\n            }\n        };\n        (result as any).setIsEnabledRight = function(b) {\n            if (b) {\n                BB.removeClassName(rightButton, 'toolspace-row-button-disabled');\n            } else {\n                BB.addClassName(rightButton, 'toolspace-row-button-disabled');\n            }\n        };\n        return result;\n    }\n\n    /*let brushButton = createButton({\n        onClick: function() {\n            setActive('draw', true);\n        },\n        image: 'app/img/ui/paint.png',\n        contain: true,\n        doLighten: true\n    });\n    BB.addClassName(brushButton, 'toolspace-row-button-activated');\n    div.appendChild(brushButton);*/\n\n    let toolDropdown = new ToolDropdown({\n        onChange: function(activeStr) {\n            setActive(activeStr, true);\n        }\n    });\n    div.appendChild(toolDropdown.getElement());\n\n    let handButton = createButton({\n        onClick: function() {\n            setActive('hand', true);\n        },\n        image: toolHandImg,\n        contain: true,\n        doLighten: true\n    });\n    handButton.style.borderRight = '1px solid rgb(212, 212, 212)';\n    handButton.title = LANG('tool-hand');\n    div.appendChild(handButton);\n\n    let zoomInNOutButton = createTriangleButton({\n        onLeft: p.onZoomIn,\n        onRight: p.onZoomOut,\n        leftImage: toolZoomInImg,\n        rightImage: toolZoomOutImg,\n    });\n    zoomInNOutButton.title = LANG('tool-zoom');\n    div.appendChild(zoomInNOutButton);\n\n    let zoomInButton = createButton({\n        onClick: p.onZoomIn,\n        image: toolZoomInImg,\n        contain: true\n    });\n    zoomInButton.title = LANG('zoom-in');\n    div.appendChild(zoomInButton);\n\n    let zoomOutButton = createButton({\n        onClick: p.onZoomOut,\n        image: toolZoomOutImg,\n        contain: true\n    });\n    zoomOutButton.title = LANG('zoom-out');\n    div.appendChild(zoomOutButton);\n\n    let undoNRedoButton = createTriangleButton({\n        onLeft: p.onUndo,\n        onRight: p.onRedo,\n        leftImage: toolUndoImg,\n        rightImage: null,\n    });\n    undoNRedoButton.title = LANG('tool-undo-redo');\n    (undoNRedoButton as any).setIsEnabledLeft(false);\n    (undoNRedoButton as any).setIsEnabledRight(false);\n    div.appendChild(undoNRedoButton);\n\n    let undoButton = createButton({\n        onClick: p.onUndo,\n        image: toolUndoImg,\n        contain: true\n    });\n    undoButton.title = LANG('undo');\n    BB.addClassName(undoButton, 'toolspace-row-button-disabled');\n    div.appendChild(undoButton);\n\n    let redoButton = createButton({\n        onClick: p.onRedo,\n        image: toolUndoImg,\n        contain: true,\n        doMirror: true\n    });\n    redoButton.title = LANG('redo');\n    BB.addClassName(redoButton, 'toolspace-row-button-disabled');\n    div.appendChild(redoButton);\n\n    zoomInButton.style.display = 'none';\n    zoomOutButton.style.display = 'none';\n    undoButton.style.display = 'none';\n    redoButton.style.display = 'none';\n\n\n\n\n\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n    this.setIsSmall = function(b) {\n        BB.css(div, {\n            height: b ? '36px' : '54px'\n        });\n\n        toolDropdown.setIsSmall(b);\n        (handButton as any).setIsSmall(b);\n        (zoomInButton as any).setIsSmall(b);\n        (zoomOutButton as any).setIsSmall(b);\n        (undoButton as any).setIsSmall(b);\n        (redoButton as any).setIsSmall(b);\n\n        if (b) {\n            zoomInNOutButton.style.display = 'none';\n            undoNRedoButton.style.display = 'none';\n            zoomInButton.style.display = 'block';\n            zoomOutButton.style.display = 'block';\n            undoButton.style.display = 'block';\n            redoButton.style.display = 'block';\n        } else {\n            zoomInNOutButton.style.display = 'block';\n            undoNRedoButton.style.display = 'block';\n            zoomInButton.style.display = 'none';\n            zoomOutButton.style.display = 'none';\n            undoButton.style.display = 'none';\n            redoButton.style.display = 'none';\n        }\n\n    };\n\n    this.setEnableZoomIn = function(b) {\n        if (b) {\n            BB.removeClassName(zoomInButton, 'toolspace-row-button-disabled');\n        } else {\n            BB.addClassName(zoomInButton, 'toolspace-row-button-disabled');\n        }\n        (zoomInNOutButton as any).setIsEnabledLeft(b);\n    };\n    this.setEnableZoomOut = function(b) {\n        if (b) {\n            BB.removeClassName(zoomOutButton, 'toolspace-row-button-disabled');\n        } else {\n            BB.addClassName(zoomOutButton, 'toolspace-row-button-disabled');\n        }\n        (zoomInNOutButton as any).setIsEnabledRight(b);\n    };\n    this.setEnableUndo = function(b) {\n        if (b) {\n            BB.removeClassName(undoButton, 'toolspace-row-button-disabled');\n        } else {\n            BB.addClassName(undoButton, 'toolspace-row-button-disabled');\n        }\n        (undoNRedoButton as any).setIsEnabledLeft(b);\n    };\n    this.setEnableRedo = function(b) {\n        if (b) {\n            BB.removeClassName(redoButton, 'toolspace-row-button-disabled');\n        } else {\n            BB.addClassName(redoButton, 'toolspace-row-button-disabled');\n        }\n        (undoNRedoButton as any).setIsEnabledRight(b);\n    };\n    this.setActive = function(activeStr) {\n        setActive(activeStr);\n    };\n    this.getActive = function() {\n        return currentActiveStr;\n    };\n\n}","import {BB} from '../../../bb/bb';\nimport {Select} from '../base-components/select';\nimport {LANG} from '../../../language/language';\n\n/**\n * Ui to select stabilizer level. 4 options. returned as 0-3\n *\n * p = {\n *     smoothing: number, // initial level 0-3\n *     onSelect: function(level number) // 0-3, when level changes\n * }\n *\n * @param p\n * @constructor\n */\nexport function ToolspaceStabilizerRow(p) {\n\n    let div = BB.el({\n        tagName: 'label',\n        content: LANG('stabilizer') + '&nbsp;',\n        title: LANG('stabilizer-title'),\n        css: {\n            display: 'flex',\n            alignItems: 'center',\n            fontSize: '13px',\n            color: 'rgba(0,0,0,0.6)'\n        }\n    });\n\n    let strengthSelect = new Select({\n        optionArr: [\n            ['0', '0'],\n            ['1', '1'],\n            ['2', '2'],\n            ['3', '3'],\n            ['4', '4'],\n            ['5', '5']\n        ],\n        initValue: p.smoothing,\n        onChange: function(val) {\n            p.onSelect(parseInt(val));\n        }\n    });\n    div.appendChild(strengthSelect.getElement());\n\n    let pointerListener = new BB.PointerListener({\n        target: div,\n        onWheel: function(e) {\n            strengthSelect.setDeltaValue(e.deltaY);\n        }\n    });\n\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n}","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport invertedBorderImg from 'url:~/src/app/img/ui/inverted-border.svg';\n\n/**\n * row of tabs. uses css class .tabrow-tab\n *\n * p = {\n *     initialId: string, // e.g. 'draw'\n *     useAccent: boolean,\n *     tabArr: [\n *         {\n *             id: string, // e.g. 'draw',\n *             label: string, // optional\n *             image: string, // optional background image\n *             title: string, // optional\n *             isVisible: boolean, // optional - default is true\n *             onOpen: function(),\n *             onClose: function(),\n *             css: {...},\n *         }\n *     ]\n * }\n *\n * @param p\n * @constructor\n */\nexport function TabRow(p) {\n    let _this = this;\n    let height = 35;\n    let div = BB.el({\n        className: 'tabrow',\n        css: {\n            height: height + 'px'\n        }\n    });\n\n    let tabArr = []; //creates its own internal arr\n    let openedTabObj = null;\n\n    const roundSize = 10;\n    const roundRight = BB.el({\n        css: {\n            width: roundSize + 'px',\n            height: roundSize + 'px',\n            backgroundImage: `url('${invertedBorderImg}')`,\n            backgroundSize: 'cover',\n            position: 'absolute',\n            right: -roundSize + 'px',\n            bottom: '0',\n            pointerEvents: 'none',\n        }\n    });\n    const roundLeft = BB.el({\n        css: {\n            width: roundSize + 'px',\n            height: roundSize + 'px',\n            backgroundImage: `url('${invertedBorderImg}')`,\n            backgroundSize: 'cover',\n            position: 'absolute',\n            left: -roundSize + 'px',\n            bottom: '0',\n            transform: 'scale(-1,1)',\n            pointerEvents: 'none',\n        }\n    });\n\n    function createTab(pTabObj, initialId, useAccent) {\n        let result: any = {\n            id: pTabObj.id,\n            isVisible: 'isVisible' in pTabObj ? pTabObj.isVisible : true,\n            onOpen: pTabObj.onOpen,\n            onClose: pTabObj.onClose,\n            update: function(openedTabObj) {\n                tabDiv.className = openedTabObj === result ? (useAccent ? 'tabrow-tab tabrow-tab-opened-accented' : 'tabrow-tab tabrow-tab-opened') : 'tabrow-tab';\n                tabDiv.style.display = result.isVisible ? 'block' : 'none';\n            }\n        };\n        let tabDiv = BB.el({\n            content: 'label' in pTabObj ? pTabObj.label : '',\n            title: 'title' in pTabObj ? pTabObj.title : undefined,\n            className: initialId === result.id ? (useAccent ? 'tabrow-tab tabrow-tab-opened-accented' : 'tabrow-tab tabrow-tab-opened') : 'tabrow-tab',\n            css: {\n                lineHeight: height + 'px',\n                display: result.isVisible ? 'block' : 'none',\n                zIndex: '0',\n            },\n            onClick: function() {\n                if (openedTabObj === result) {\n                    return;\n                }\n                _this.open(result.id);\n            }\n        });\n        result.div = tabDiv;\n        if ('image' in pTabObj) {\n            BB.css(tabDiv, {\n                backgroundImage: 'url(\\'' + pTabObj.image + '\\')',\n                backgroundSize: (height - 7) + 'px'\n            });\n        }\n        if ('css' in pTabObj) {\n            BB.css(tabDiv, pTabObj.css);\n        }\n        div.appendChild(tabDiv);\n\n        let pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\n            target: tabDiv,\n            onEnterLeave: function(isOver) {\n                if (isOver) {\n                    BB.addClassName(tabDiv, 'tabrow-tab-hover');\n                } else {\n                    BB.removeClassName(tabDiv, 'tabrow-tab-hover');\n                }\n            }\n        });\n\n        if (initialId === result.id) {\n            result.onOpen();\n            result.div.appendChild(roundRight);\n            result.div.appendChild(roundLeft);\n        } else {\n            result.onClose();\n        }\n\n        return result;\n    }\n\n    for (let i = 0; i < p.tabArr.length; i++) {\n        tabArr.push(createTab(p.tabArr[i], p.initialId, p.useAccent));\n    }\n\n    for (let i = 0; i < tabArr.length; i++) {\n        if (tabArr[i].id === p.initialId) {\n            openedTabObj = tabArr[i];\n        }\n    }\n    if (openedTabObj === null) {\n        throw 'invalid initialId';\n    }\n\n    function update() {\n        for (let i = 0; i < tabArr.length; i++) {\n            tabArr[i].update(openedTabObj);\n        }\n    }\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n\n    this.open = function(tabId) {\n        for (let i = 0; i < tabArr.length; i++) {\n            if (tabArr[i].id === tabId) {\n                if (openedTabObj === tabArr[i]) { // already open\n                    return;\n                }\n                openedTabObj.onClose();\n                openedTabObj = tabArr[i];\n                openedTabObj.onOpen();\n                openedTabObj.div.appendChild(roundRight);\n                openedTabObj.div.appendChild(roundLeft);\n                update();\n                return;\n            }\n        }\n        throw 'TabRow.open - invalid tabId';\n    };\n\n    this.getOpenedTabId = function() {\n        return '' + openedTabObj.id;\n    };\n\n    this.setIsVisible = function(tabId, isVisible) {\n        for (let i = 0; i < tabArr.length; i++) {\n            if (tabArr[i].id === tabId) {\n                tabArr[i].isVisible = !!isVisible;\n                update();\n                return;\n            }\n        }\n        throw 'TabRow.setIsVisible - invalid tabId';\n    };\n}","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport collapseImg from 'url:~/src/app/img/ui/ui-collapse.svg';\nimport {LANG} from \"../../../language/language\";\n\n/**\n * button that allows to collapse toolspace (for mobile)\n *\n * p = {\n *     onChange: function()\n * }\n *\n * @param p\n * @constructor\n */\nexport function ToolspaceCollapser(p) {\n    let isOpen = true;\n    let directionStr = 'right'; // 'left' | 'right'\n\n    function update() {\n        if (directionStr === 'left') {\n            icon.style.transform = isOpen ? 'rotate(180deg)' : '';\n        } else {\n            icon.style.transform = isOpen ? '' : 'rotate(180deg)';\n        }\n    }\n\n    let div = BB.el({\n        css: {\n            width: '25px',\n            height: '25px',\n            background: '#5c67ff',\n            color: '#fff',\n            position: 'absolute',\n            top: '0',\n            textAlign: 'center',\n            lineHeight: '25px',\n            cursor: 'pointer',\n            userSelect: 'none',\n            padding: '2px',\n            boxSizing: 'border-box',\n           \n        },\n        title: LANG('toggle-show-tools'),\n        onClick: function(e) {\n            e.preventDefault();\n            isOpen = !isOpen;\n            update();\n            p.onChange();\n        },\n        id:\"ngungu\"\n    });\n\n    let icon = BB.el({\n        parent: div,\n        css: {\n            backgroundImage: `url(${collapseImg})`,\n            width: '100%',\n            height: '100%',\n            backgroundSize: 'contain',\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: 'center',\n            userSelect: 'none'\n        }\n    });\n    div.oncontextmenu = function () {\n        return false;\n    };\n\n    // --- interface ---\n    this.isOpen = function() {\n        return isOpen;\n    };\n\n    /**\n     *\n     * @param dirStr\n     */\n    this.setDirection = function(dirStr) {\n        directionStr = dirStr;\n        update();\n    };\n\n    this.getElement = function() {\n        return div;\n    };\n}","import {KL} from '../../kl';\nimport {BB} from '../../../bb/bb';\nimport {KlHistoryInterface} from '../../history/kl-history';\nimport {LANG} from '../../../language/language';\n\n/**\n * remind user of saving, keep user aware of save state\n */\nexport class SaveReminder {\n    private oldActionNumber: number = null;\n    private remindersShowed: number = 0;\n    private unsavedInterval;\n    private lastReminderResetAt: number;\n\n    constructor (\n        private history: KlHistoryInterface,\n        private showReminder: boolean,\n        private changeTitle: boolean,\n        private title: string = 'Klecks'\n    ) { }\n\n    init (): void {\n        if (this.oldActionNumber !== null) { // already initialized\n            return;\n        }\n        this.oldActionNumber = this.history.getActionNumber();\n\n        if (this.showReminder) {\n            setInterval(() => {\n                if (document.visibilityState !== 'visible') {\n                    return;\n                }\n\n                let reminderTimelimitMs = 1000 * 60 * 20; // 20 minutes\n\n                let actionNumber = this.history.getActionNumber();\n                //number of actions that were done since last reminder\n                let historyDist = Math.abs(actionNumber - this.oldActionNumber);\n\n                if (this.lastReminderResetAt + reminderTimelimitMs < (performance.now()) && historyDist >= 30) {\n                    this.reset(true);\n                    KL.showSaveReminderToast(this.remindersShowed++);\n                }\n            }, 1000 * 60);\n        }\n\n        // confirmation dialog when closing tab\n        function onBeforeUnload(e) {\n            e.preventDefault();\n            e.returnValue = '';\n        }\n\n        this.history.addListener(() => {\n            let actionNumber = this.history.getActionNumber();\n            if (this.oldActionNumber !== actionNumber) {\n                BB.setEventListener(window, 'onbeforeunload', onBeforeUnload);\n            } else {\n                BB.setEventListener(window, 'onbeforeunload', null);\n            }\n        });\n\n        if (this.changeTitle) {\n            document.addEventListener(\"visibilitychange\", () => {\n                if (document.visibilityState === 'visible') {\n                    document.title = this.title;\n                    clearInterval(this.unsavedInterval);\n                } else {\n                    let actionNumber = this.history.getActionNumber();\n                    if (this.oldActionNumber !== actionNumber) {\n                        document.title = LANG('unsaved') + ' - ' + this.title;\n                        let state = 0;\n                        this.unsavedInterval = setInterval(() => {\n                            state = (state + 1) % 2;\n                            if (state === 1) {\n                                document.title = LANG('unsaved') + ' · ' + this.title;\n                            } else {\n                                document.title = LANG('unsaved') + ' - ' + this.title;\n                            }\n                        }, 1000 * 60 * 3);\n                    }\n                }\n            });\n        }\n    }\n\n    reset (isSoft?: boolean): void {\n        if (this.oldActionNumber === null) { // not initialized\n            return;\n        }\n        if (!isSoft) {\n            this.remindersShowed = 0;\n        }\n        this.lastReminderResetAt = performance.now();\n        this.oldActionNumber = this.history.getActionNumber();\n        BB.setEventListener(window, 'onbeforeunload', null);\n    }\n}\n","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport caretImg from 'url:~/src/app/img/ui/caret-down.svg';\nimport {IKeyString} from '../../../bb/bb.types';\nimport {LANG} from '../../../language/language';\nimport {dialogCounter} from '../modals/modal-count';\n\n/**\n * Scroll buttons at the top and bottom of toolspace\n * Show up when window is very small.\n * Allow user to scroll up and down toolspace.\n */\nexport class ToolspaceScroller {\n\n    private toolspace: HTMLElement;\n    private upBtn: HTMLElement;\n    private downBtn: HTMLElement;\n    private downInterval: any;\n    private upInterval: any;\n\n    private update(): void {\n        if (this.toolspace.scrollHeight > this.toolspace.offsetHeight + 3) { // small buffer where it's not worth it\n            if (!this.upInterval) {\n                this.upBtn.style.display = this.toolspace.scrollTop === 0 ? 'none' : 'block';\n            }\n            if (!this.downInterval) {\n                this.downBtn.style.display = (\n                    this.toolspace.scrollTop + this.toolspace.offsetHeight + 1 >= this.toolspace.scrollHeight ?\n                        'none' : 'block'\n                );\n            }\n        } else {\n            this.upBtn.style.display = 'none';\n            this.downBtn.style.display = 'none';\n        }\n    }\n\n    // --- public ---\n    constructor(p: {toolspace: HTMLElement, uiState: 'left' | 'right'}) {\n        this.toolspace = p.toolspace;\n        this.upBtn = BB.el({\n            parent: this.toolspace,\n            title: LANG('scroll'),\n            className: 'kl-scroller',\n            css: {\n                top: '0',\n                transform: 'rotate(180deg)',\n            }\n        });\n        this.downBtn = BB.el({\n            parent: this.toolspace,\n            title: LANG('scroll'),\n            className: 'kl-scroller',\n            css: {\n                bottom: '0',\n            }\n        });\n        this.updateUiState(p.uiState);\n\n        const upListener = new BB.PointerListener({\n            target: this.upBtn,\n            onPointer: (e) => {\n                if (e.type === 'pointerdown') {\n                    this.upInterval = setInterval(() => {\n                        this.toolspace.scrollBy(0, -10);\n                        this.update();\n                    }, 20);\n                }\n                if (e.type === 'pointerup') {\n                    clearInterval(this.upInterval);\n                    setTimeout(() => { // prevent ff pressing anything underneath\n                        this.upInterval = null;\n                        this.update()\n                    }, 50);\n                }\n            },\n            onWheel: (e) => {\n                this.toolspace.scrollBy(0, 20 * e.deltaY);\n                this.update();\n            },\n        });\n        const downListener = new BB.PointerListener({\n            target: this.downBtn,\n            onPointer: (e) => {\n                if (e.type === 'pointerdown') {\n                    this.downInterval = setInterval(() => {\n                        this.toolspace.scrollBy(0, 10);\n                        this.update();\n                    }, 20);\n                }\n                if (e.type === 'pointerup') {\n                    clearInterval(this.downInterval);\n                    setTimeout(() => { // prevent ff pressing anything underneath\n                        this.downInterval = null;\n                        this.update()\n                    }, 50);\n                }\n            },\n            onWheel: (e) => {\n                this.toolspace.scrollBy(0, 20 * e.deltaY);\n                this.update();\n            },\n        });\n\n        this.update();\n\n        const observer = new MutationObserver(() => this.update());\n        observer.observe(\n            this.toolspace,\n            {\n                attributes: true,\n                childList: true,\n                subtree: true,\n            }\n        );\n        window.addEventListener('resize', () => this.update());\n\n        // hide if in dialog because that can have its own scrollbar\n        dialogCounter.subscribe((v) => {\n            // ignores the 0.5 by tool dropdown\n            this.upBtn.style.opacity = v >= 1 ? '0' : '';\n            this.downBtn.style.opacity = v >= 1 ? '0' : '';\n        });\n    }\n\n    updateUiState (uiState: 'left' | 'right'): void {\n        BB.css(this.upBtn, {\n            left: uiState === 'left' ? '0' : null,\n            right: uiState === 'right' ? '0' : null,\n        });\n        BB.css(this.downBtn, {\n            left: uiState === 'left' ? '0' : null,\n            right: uiState === 'right' ? '0' : null,\n        });\n    }\n}","import {BB} from '../../../bb/bb';\nimport {popup} from './popup';\n\nexport function exportDialog(parent, image) {\n    let boxSize, aboutCloseFunc, aboutDiv, closed, aniToggle, imageContainer, coverImage, coverSize,\n        text, holding, aniTimeout, halfBoxSize;\n    boxSize = 22 * 2;\n    halfBoxSize = 22;\n    aboutCloseFunc = function () {\n    };\n    closed = false;\n    aniToggle = false;\n    aboutDiv = document.createElement(\"div\");\n    BB.css(aboutDiv, {\n        width: (7 * boxSize) + \"px\"\n    });\n\n    imageContainer = document.createElement(\"div\");\n    coverImage = new Image();\n    coverImage.src = image.src;\n\n    imageContainer.appendChild(coverImage);\n    imageContainer.appendChild(image);\n\n    BB.css(imageContainer, {\n        width: (6 * boxSize) + \"px\",\n        height: (4 * boxSize) + \"px\",\n        marginTop: (boxSize / 2 - 1) + \"px\",\n        marginLeft: (boxSize / 2 - 1) + \"px\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        boxShadow: \"0 0 10px 4px rgba(255,255,255, 0)\",\n        border: \"1px solid rgba(255, 255, 255, 1)\",\n        transition: \"box-shadow 0.7s linear\"\n    });\n    BB.css(image, {\n        position: \"absolute\",\n        left: '0',\n        top: '0',\n        width: (6 * boxSize) + \"px\",\n        height: (4 * boxSize) + \"px\",\n        opacity: '0'\n    });\n    coverSize = {\n        width: (6 * boxSize),\n        height: (6 * boxSize / image.width) * image.height\n    };\n    if (coverSize.height < (4 * boxSize)) {\n        coverSize.height = (4 * boxSize);\n        coverSize.width = (coverSize.height / image.height) * image.width;\n    }\n    BB.css(coverImage, {\n        position: \"absolute\",\n        top: (2 * boxSize) + \"px\",\n        left: (3 * boxSize) + \"px\",\n        width: coverSize.width + \"px\",\n        height: coverSize.height + \"px\",\n        marginLeft: (-coverSize.width / 2) + \"px\",\n        marginTop: (-coverSize.height / 2) + \"px\"\n    });\n\n    function animation() {\n        if (closed) {\n            return;\n        }\n        aniToggle = !aniToggle;\n        if (aniToggle) {\n            BB.css(imageContainer, {\n                border: \"1px solid rgba(0, 0, 0, 1)\"\n            });\n        } else {\n            BB.css(imageContainer, {\n                border: \"1px solid rgba(200, 200, 200, 1)\"\n            });\n        }\n        setTimeout(animation, 510);\n    }\n\n    animation();\n\n    text = document.createElement(\"div\");\n    text.innerHTML = \"Right-Click or Press-Hold on the image, then save.\";\n    text.ontouchstart = function () {\n        return false;\n    };\n    BB.css(text, {\n        fontSize: (boxSize / 2.5) + \"px\",\n        color: \"#666\",\n        padding: \"10px\",\n        textAlign: \"center\"\n    });\n\n    aboutDiv.appendChild(imageContainer);\n    aboutDiv.appendChild(text);\n\n    holding = false;\n    image.ontouchstart = function () {\n        BB.css(imageContainer, {\n            boxShadow: \"0 0 10px 8px rgba(0,255,255, 1)\"\n        });\n        holding = true;\n        aniTimeout = setTimeout(function () {\n            holding = false;\n            BB.css(imageContainer, {\n                boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\n            });\n        }, 1500);\n    };\n    image.ontouchmove = function () {\n        BB.css(imageContainer, {\n            boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\n        });\n        holding = false;\n        clearTimeout(aniTimeout);\n    };\n    image.ontouchend = function () {\n        BB.css(imageContainer, {\n            boxShadow: \"0 0 10px 4px rgba(0,255,255, 0)\"\n        });\n        holding = false;\n        clearTimeout(aniTimeout);\n    };\n\n    popup({\n        target: parent,\n        message: \"<b>Save Image</b>\",\n        div: aboutDiv,\n        buttons: [\"Close\"],\n        callback: function (result) {\n            closed = true;\n        }\n    });\n}","import {BB} from '../../../bb/bb';\nimport {popup} from './popup';\nimport {CropCopy} from '../components/crop-copy';\nimport {LANG} from '../../../language/language';\n\n/// <reference path=\"./types.d.ts\" />\n\n/**\n *\n * @param parent\n * @param fullCanvas\n * @param cropCallback\n * @param output - BB.Output\n * @param showCrop - boolean - show crop button\n */\nexport function clipboardDialog(parent, fullCanvas, cropCallback, output, showCrop) {\n    const div = document.createElement(\"div\");\n    const isSmall = window.innerWidth < 550 || window.innerHeight < 550;\n\n    let topWrapper = BB.el({\n        content: LANG('crop-drag-to-crop'),\n        css: {\n            textAlign: 'center'\n        }\n    });\n    div.appendChild(topWrapper);\n\n\n    let cropCopy = new CropCopy({\n        width: isSmall ? 340 : 540,\n        height: isSmall ? 300 : 350,\n        canvas: fullCanvas\n    });\n    BB.css(cropCopy.getEl(), {\n        marginTop: '10px',\n        marginLeft: '-20px',\n        borderTop: '1px solid #bbb',\n        borderBottom: '1px solid #bbb'\n    });\n    div.appendChild(cropCopy.getEl());\n\n    function toClipboard() {\n        const imgURL = cropCopy.getCroppedImage().toDataURL('image/png');\n        setTimeout(async function() {\n            try {\n                const data = await fetch(imgURL);\n                const blob = await data.blob();\n                await (navigator.clipboard as any).write([\n                    new ClipboardItem({\n                        [blob.type]: blob\n                    } as any) // todo check is possible?\n                ]);\n                setTimeout(function() {\n                    output.out(LANG('cropcopy-copied'), true);\n                }, 200);\n            } catch (err) {\n                console.error(err.name, err.message);\n            }\n        }, 0);\n    }\n\n    let keyListener = new BB.KeyListener({\n        onDown: function(keyStr, KeyEvent, comboStr) {\n            if (comboStr === 'ctrl+c') {\n                toClipboard();\n                closefunc();\n            }\n        }\n    });\n\n    let closefunc;\n    function blur() {\n        closefunc();\n    }\n    BB.addEventListener(window, \"blur\", blur);\n    popup({\n        target: parent,\n        message: '<b>' + (showCrop ? `${LANG('cropcopy-title-copy')} / ${LANG('cropcopy-title-crop')}` : `${LANG('cropcopy-title-copy')}`) + '</b>',\n        div: div,\n        style: isSmall ? {} : {\n            width: \"500px\"\n        },\n        buttons: showCrop ? [LANG('cropcopy-btn-copy'), LANG('cropcopy-btn-crop'), 'Cancel'] : [LANG('cropcopy-btn-copy'), 'Cancel'],\n        primaries: [LANG('cropcopy-btn-copy')],\n        callback: function (result) {\n            if (result === LANG('cropcopy-btn-copy')) {\n                toClipboard();\n            } else if (result === LANG('cropcopy-btn-crop')) {\n                let rectObj = cropCopy.getRect();\n                cropCallback({\n                    left: Math.round(-rectObj.x),\n                    right: Math.round(rectObj.x + rectObj.width - fullCanvas.width),\n                    top: Math.round(-rectObj.y),\n                    bottom: Math.round(rectObj.y + rectObj.height - fullCanvas.height)\n                });\n            }\n            BB.removeEventListener(window, \"blur\", blur);\n            cropCopy.destroy();\n            keyListener.destroy();\n        },\n        clickOnEnter: LANG('cropcopy-btn-copy'),\n        closefunc: function (func) {\n            closefunc = func;\n        }\n    });\n}","import {BB} from '../../../bb/bb';\nimport {FreeTransformCanvas} from '../components/free-transform-canvas';\nimport {popup} from './popup';\nimport {KlCanvas} from '../../canvas/kl-canvas';\nimport {IKlBasicLayer} from '../../kl.types';\nimport {LANG} from '../../../language/language';\n\nexport function showImportAsLayerDialog(\n    params: {\n        target: HTMLElement;\n        klCanvas: KlCanvas;\n        importImage: HTMLImageElement | HTMLCanvasElement;\n        callback: (\n            p?: {x: number, y: number, width:number, height: number, angleDeg: number},\n            isPixelated?: boolean\n        ) => void;\n    }\n): void {\n\n    let div = document.createElement(\"div\");\n    BB.appendTextDiv(div, LANG('import-as-layer-description'));\n    if (params.klCanvas.isLayerLimitReached()) {\n        let noteEl = BB.el({\n            content: LANG('import-as-layer-limit-reached'),\n            css: {\n                background: '#ff0',\n                padding: '10px',\n                marginTop: '5px',\n                marginBottom: '5px',\n                border: '1px solid #e7d321',\n                borderRadius: '5px'\n            }\n        });\n        div.appendChild(noteEl);\n    }\n    let isSmall = window.innerWidth < 550;\n\n    let buttonRowEl = BB.el({\n        css: {\n            display: 'flex'\n        }\n    });\n    let originalSizeBtn = BB.el({\n        tagName: 'button',\n        content: '1:1',\n        css: {\n            marginRight: '10px'\n        },\n        onClick: function() {\n            freeTransformCanvas.reset();\n        }\n    });\n    let fitSizeBtn = BB.el({\n        tagName: 'button',\n        content: LANG('import-as-layer-fit'),\n        css: {\n            marginRight: '10px'\n        },\n        onClick: function() {\n            freeTransformCanvas.setTransformFit();\n        }\n    });\n    let centerBtn = BB.el({\n        tagName: 'button',\n        content: LANG('center'),\n        css: {\n            marginRight: '10px'\n        },\n        onClick: function() {\n            freeTransformCanvas.setTransformCenter();\n        }\n    });\n    buttonRowEl.appendChild(originalSizeBtn);\n    buttonRowEl.appendChild(fitSizeBtn);\n    buttonRowEl.appendChild(centerBtn);\n    div.appendChild(buttonRowEl);\n\n\n\n    let layers: IKlBasicLayer[] = [];\n    {\n        let klCanvasLayerArr = params.klCanvas.getLayers();\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\n            layers.push({\n                image: klCanvasLayerArr[i].context.canvas,\n                opacity: klCanvasLayerArr[i].opacity,\n                mixModeStr: klCanvasLayerArr[i].mixModeStr\n            });\n        }\n    }\n    layers.push({\n        image: params.importImage,\n        opacity: 1,\n        mixModeStr: 'source-over'\n    });\n\n\n    let freeTransformCanvas = new FreeTransformCanvas({\n        elementWidth: isSmall ? 340 : 540,\n        elementHeight: isSmall ? 280 : 350,\n        imageWidth: params.klCanvas.getLayerContext(0).canvas.width,\n        imageHeight: params.klCanvas.getLayerContext(0).canvas.height,\n        layers: layers,\n        transformIndex: layers.length - 1,\n    });\n    BB.css(freeTransformCanvas.getElement(), {\n        marginTop: '10px',\n        marginLeft: '-20px',\n    });\n    div.appendChild(freeTransformCanvas.getElement());\n\n    function move(x, y) {\n        freeTransformCanvas.move(x, y);\n    }\n\n    let keyListener = new BB.KeyListener({\n        onDown: function(keyStr) {\n            if (keyStr === 'left') {\n                move(-1, 0);\n            }\n            if (keyStr === 'right') {\n                move(1, 0);\n            }\n            if (keyStr === 'up') {\n                move(0, -1);\n            }\n            if (keyStr === 'down') {\n                move(0, 1);\n            }\n        }\n    });\n\n    popup({\n        target: params.target,\n        message: `<b>${LANG('import-as-layer-title')}</b>`,\n        div: div,\n        style: isSmall ? null : {\n            width: '500px'\n        },\n        buttons: [\"Ok\", \"Cancel\"],\n        clickOnEnter: 'Ok',\n        callback: function(buttonStr) {\n            keyListener.destroy();\n            freeTransformCanvas.destroy();\n            BB.destroyEl(originalSizeBtn);\n            BB.destroyEl(fitSizeBtn);\n            BB.destroyEl(centerBtn);\n            if (buttonStr === 'Ok') {\n                params.callback(freeTransformCanvas.getTransformation(), freeTransformCanvas.getIsPixelated());\n            } else {\n                params.callback();\n            }\n        }\n    });\n\n}","import {BB} from '../../../bb/bb';\nimport {Select} from '../base-components/select';\nimport {ColorOptions} from '../base-components/color-options';\nimport {popup} from './popup';\nimport {LANG} from '../../../language/language';\n\n/**\n * P = {\n *     currentColor: RGB, // current color\n *     secondaryColor: RGB,\n *     maxCanvasSize: number,\n *     canvasWidth: number, // current canvas size\n *     canvasHeight: number, // current canvas size\n *     workspaceWidth: number,\n *     workspaceHeight: number,\n *     onConfirm: function(width number, height number, color RGBA),\n *     onCancel: function()\n * }\n *\n * @param p\n */\nexport function newImageDialog(p) {\n\n    let currentColor = p.currentColor;\n    let secondaryColor = p.secondaryColor;\n    let maxCanvasSize = p.maxCanvasSize;\n    let canvasWidth = p.canvasWidth;\n    let canvasHeight = p.canvasHeight;\n    let workspaceWidth = p.workspaceWidth;\n    let workspaceHeight = p.workspaceHeight;\n    let onConfirm = p.onConfirm;\n    let onCancel = p.onCancel;\n\n\n    function createRatioSize(ratioX, ratioY, width, height, padding) {\n        return BB.fitInto(ratioX, ratioY, Math.min(maxCanvasSize, width - padding), Math.min(maxCanvasSize, height - padding), 1);\n    }\n\n    let newImDiv = document.createElement(\"div\");\n    let widthWrapper = document.createElement(\"div\");\n    let heightWrapper = document.createElement(\"div\");\n    let widthInput = document.createElement(\"input\");\n    let widthUnit = document.createElement(\"div\");\n    let heightInput = document.createElement(\"input\");\n    let heightUnit = document.createElement(\"div\");\n    widthWrapper.style.position = \"relative\";\n    widthWrapper.style.width = \"145px\";\n    widthWrapper.style.height = \"35px\";\n    widthWrapper.style.lineHeight = \"30px\";\n    heightWrapper.style.width = \"145px\";\n    heightWrapper.style.height = \"35px\";\n    heightWrapper.style.lineHeight = \"30px\";\n\n    widthUnit.innerText = LANG('new-px');\n    widthUnit.style.color = '#888';\n    widthUnit.style.fontSize = \"12px\";\n    widthUnit.style.marginLeft = \"5px\";\n    widthUnit.style.cssFloat = \"right\";\n\n    heightUnit.innerText = LANG('new-px');\n    heightUnit.style.color = '#888';\n    heightUnit.style.fontSize = \"12px\";\n    heightUnit.style.marginLeft = \"5px\";\n    heightUnit.style.cssFloat = \"right\";\n\n    widthInput.setAttribute('data-ignore-focus', 'true');\n    heightInput.setAttribute('data-ignore-focus', 'true');\n\n    widthInput.type = 'number';\n    widthInput.min = '1';\n    widthInput.max = maxCanvasSize;\n    widthInput.style.cssFloat = \"right\";\n    widthInput.style.width = \"70px\";\n\n    heightInput.type = 'number';\n    heightInput.min = '1';\n    heightInput.max = maxCanvasSize;\n    heightInput.style.cssFloat = \"right\";\n    heightInput.style.width = \"70px\";\n    widthInput.value = canvasWidth;\n    heightInput.value = canvasHeight;\n    widthInput.onclick = function () {\n        (this as any).focus();\n        updateRatio();\n    };\n    heightInput.onclick = function () {\n        (this as any).focus();\n        updateRatio();\n    };\n    widthWrapper.appendChild(widthUnit);\n    widthWrapper.appendChild(widthInput);\n    BB.appendTextDiv(widthWrapper, LANG('width') + \": \");\n    heightWrapper.appendChild(heightUnit);\n    heightWrapper.appendChild(heightInput);\n    BB.appendTextDiv(heightWrapper, LANG('height') + \": \");\n    let ratioWrapper = document.createElement(\"div\");\n    ratioWrapper.style.marginTop = '5px';\n    ratioWrapper.style.color = '#888';\n\n    let templateWrapper = document.createElement(\"div\");\n    //BB.appendTextDiv(templateWrapper, \"Preset Resolutions: <br />\");\n    let presetFitBtn = document.createElement(\"button\");\n    templateWrapper.style.marginBottom = \"10px\";\n    let presetCurrentBtn = document.createElement(\"button\");\n    let presetSquareBtn = document.createElement(\"button\");\n    let presetLandscapeBtn = document.createElement(\"button\");\n    let presetPortraitBtn = document.createElement(\"button\");\n    let presetOversizeBtn = document.createElement(\"button\");\n\n    presetCurrentBtn.textContent = LANG('new-current');\n    presetFitBtn.textContent = LANG('new-fit');\n    presetOversizeBtn.textContent = LANG('new-oversize');\n    presetLandscapeBtn.textContent = LANG('new-landscape');\n    presetPortraitBtn.textContent = LANG('new-portrait');\n    presetSquareBtn.textContent = LANG('new-square');\n\n    presetCurrentBtn.style.marginRight = \"5px\";\n    presetFitBtn.style.marginRight = \"5px\";\n    presetOversizeBtn.style.marginRight = \"5px\";\n    presetLandscapeBtn.style.marginTop = \"5px\";\n    presetLandscapeBtn.style.marginRight = \"5px\";\n    presetPortraitBtn.style.marginTop = \"5px\";\n    presetPortraitBtn.style.marginRight = \"5px\";\n\n    templateWrapper.appendChild(presetCurrentBtn);\n    templateWrapper.appendChild(presetFitBtn);\n    templateWrapper.appendChild(presetOversizeBtn);\n    templateWrapper.appendChild(presetSquareBtn);\n    templateWrapper.appendChild(presetLandscapeBtn);\n    templateWrapper.appendChild(presetPortraitBtn);\n\n    let templatePadding = 50;\n\n    presetCurrentBtn.onclick = function () {\n        widthInput.value = canvasWidth;\n        heightInput.value = canvasHeight;\n        updateRatio();\n    };\n    presetFitBtn.onclick = function () {\n        widthInput.value = workspaceWidth;\n        heightInput.value = workspaceHeight;\n        updateRatio();\n    };\n    presetOversizeBtn.onclick = function () {\n        widthInput.value = workspaceWidth + 500;\n        heightInput.value = workspaceHeight + 500;\n        updateRatio();\n    };\n    presetSquareBtn.onclick = function () {\n        let sizeObj = createRatioSize(1, 1, workspaceWidth, workspaceHeight, templatePadding);\n        widthInput.value = '' + Math.round(sizeObj.width);\n        heightInput.value = '' + Math.round(sizeObj.height);\n        updateRatio();\n    };\n    presetLandscapeBtn.onclick = function () {\n        let sizeObj = createRatioSize(4, 3, workspaceWidth, workspaceHeight, templatePadding);\n        widthInput.value = '' + Math.round(sizeObj.width);\n        heightInput.value = '' + Math.round(sizeObj.height);\n        updateRatio();\n    };\n    presetPortraitBtn.onclick = function () {\n        let sizeObj = createRatioSize(3, 4, workspaceWidth, workspaceHeight, templatePadding);\n        widthInput.value = '' + Math.round(sizeObj.width);\n        heightInput.value = '' + Math.round(sizeObj.height);\n        updateRatio();\n    };\n\n    let select = new Select({\n        isFocusable: true,\n        optionArr: [\n            ['screen', LANG('new-screen')],\n            ['16 9', LANG('new-video') + ' 16:9'],\n            ['3 2', '3:2'],\n            ['5 3', '5:3'],\n            ['2 1', '2:1'],\n            ['paper', LANG('new-din-paper') + ' √2:1'],\n            ['9 16', '9:16'],\n            ['2 3', '2:3'],\n            ['3 5', '3:5'],\n            ['1 2', '1:2'],\n            ['1 1.4142135623730951', '1:√2']\n        ],\n        onChange: function(val) {\n            if (val === 'screen') {\n                widthInput.value = '' + window.screen.width;\n                heightInput.value = '' + window.screen.height;\n            } else if (val === 'paper') {\n                let sizeObj = createRatioSize(Math.sqrt(2), 1, workspaceWidth, workspaceHeight, templatePadding);\n                widthInput.value = '' + Math.round(sizeObj.width);\n                heightInput.value = '' + Math.round(sizeObj.height);\n            } else {\n                let split = val.split(' ');\n                let sizeObj = createRatioSize(parseFloat(split[0]), parseFloat(split[1]), workspaceWidth, workspaceHeight, templatePadding);\n                widthInput.value = '' + Math.round(sizeObj.width);\n                heightInput.value = '' + Math.round(sizeObj.height);\n            }\n            updateRatio();\n            select.setValue(null);\n        }\n    });\n    setTimeout(() => {\n        // safari: not empty without also setting it to null via timeout\n        select.setValue(null);\n    }, 0);\n    BB.css(select.getElement(), {\n        width: '80px',\n    });\n    templateWrapper.appendChild(select.getElement());\n\n\n\n    let backgroundRGBA = {r: 255, g: 255, b: 255, a: 1};\n\n    let colorOptionsArr = [\n        {r: 255, g: 255, b: 255, a: 1},\n        {r: 0, g: 0, b: 0, a: 1},\n        {r: 0, g: 0, b: 0, a: 0}\n    ];\n    colorOptionsArr.push({\n        r: currentColor.r,\n        g: currentColor.g,\n        b: currentColor.b,\n        a: 1\n    });\n    colorOptionsArr.push({\n        r: secondaryColor.r,\n        g: secondaryColor.g,\n        b: secondaryColor.b,\n        a: 1\n    });\n\n    let colorOptions = new ColorOptions({\n        colorArr: colorOptionsArr,\n        onChange: function(rgbaObj) {\n            backgroundRGBA = rgbaObj;\n            preview.style.backgroundColor = \"rgba(\" + rgbaObj.r + \",\" + rgbaObj.g + \",\" + rgbaObj.b + \", \" + rgbaObj.a + \")\";\n        }\n    });\n\n    let previewWrapper = document.createElement(\"div\");\n    BB.css(previewWrapper, {\n        boxSizing: 'border-box',\n        width: '340px',\n        height: '140px',\n        display: 'table',\n        backgroundColor: '#9e9e9e',\n        padding: '10px',\n        marginTop: '10px',\n        boxShadow: 'rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset',\n        marginLeft: '-20px',\n        colorScheme: 'only light',\n    });\n    let preview = document.createElement(\"div\");\n    BB.css(preview, {\n        width: 200 + \"px\",\n        height: 100 + \"px\",\n        backgroundColor: \"#fff\",\n        marginLeft: \"auto\",\n        marginRight: \"auto\",\n        color: \"#aaa\",\n        fontSize: \"16px\",\n        fontWeight: \"bold\",\n        textAlign: \"center\",\n        verticalAlign: \"center\",\n        display: \"table\",\n        overflow: \"hidden\",\n        boxShadow: \"0px 0px 3px rgba(0,0,0,0.5)\"\n    });\n    let previewcell = document.createElement(\"div\");\n    previewcell.style.display = \"table-cell\";\n    previewcell.style.verticalAlign = \"middle\";\n    previewcell.appendChild(preview);\n    previewWrapper.appendChild(previewcell);\n    let cell = BB.appendTextDiv(preview, \"\");\n    //let ratio = BB.appendTextDiv(cell, \"1:2\");\n    cell.style.display = \"table-cell\";\n    cell.style.verticalAlign = \"middle\";\n    let prevW = parseInt(widthInput.value);\n    let prevH = parseInt(heightInput.value);\n\n    function updateRatio() {\n        widthInput.value = '' + Math.min(maxCanvasSize, parseInt(widthInput.value));\n        heightInput.value = '' + Math.min(maxCanvasSize, parseInt(heightInput.value));\n\n        function HCF(u, v) {\n            let U = u, V = v;\n            while (true) {\n                if (!(U %= V))\n                    return V;\n                if (!(V %= U))\n                    return U;\n            }\n        }\n\n        let w = parseInt(widthInput.value);\n        let h = parseInt(heightInput.value);\n        if (w < 1 || w > maxCanvasSize || h < 1 || h > maxCanvasSize) {\n            if (w > maxCanvasSize)\n                w = maxCanvasSize;\n            else if (h > maxCanvasSize)\n                h = maxCanvasSize;\n\n            widthInput.value = '' + w;\n            heightInput.value = '' + h;\n        }\n\n        //generated canvas size doesn't always match ratio. so check if a common ratio is very close\n        let commonRatios = [\n            [1, 2], [2, 1],\n            [2, 3], [3, 2],\n            [3, 4], [4, 3],\n            [4, 5], [5, 4],\n            [16, 9], [9, 16],\n            [3, 2], [2, 3],\n            [5, 3], [3, 5],\n            [2, 1], [1, 2],\n            [1.414, 1], [1, 1.414],\n        ];\n        let reducedArr = BB.reduce(w, h);\n        let closestRatio = null;\n        let closestDistance = null;\n        for (let i = 0; i < commonRatios.length; i++) {\n            if (i === 0 || Math.abs(commonRatios[i][0] / commonRatios[i][1] - reducedArr[0] / reducedArr[1]) < closestDistance) {\n                closestRatio = commonRatios[i];\n                closestDistance = Math.abs(commonRatios[i][0] / commonRatios[i][1] - reducedArr[0] / reducedArr[1]);\n            }\n        }\n        //display ratio\n        if (closestDistance > 0 && closestDistance < 0.005) {\n            ratioWrapper.innerText = LANG('new-ratio') + ': ~' + closestRatio[0] + ':' + closestRatio[1];\n        } else {\n            ratioWrapper.innerText = LANG('new-ratio') + ': ' + reducedArr[0] + ':' + reducedArr[1];\n        }\n\n        prevW = w;\n        prevH = h;\n        let realw = w;\n        let T = HCF(w, h);\n        w /= T;\n        h /= T;\n        w *= 260;\n        h *= 260;\n        if (w > 260) {\n            h = 260 / w * h;\n            w = 260;\n        }\n        if (h > 100) {\n            w = 100 / h * w;\n            h = 100;\n\n        }\n\n        preview.style.width = w + \"px\";\n        preview.style.height = h + \"px\";\n        BB.createCheckerDataUrl(parseInt('' + (30 * (w / realw))), function (url) {\n            previewWrapper.style.background = \"url(\" + url + \")\";\n        });\n    }\n\n    widthInput.onchange = function () {\n        if (widthInput.value === '' || parseInt(widthInput.value) < 0) {\n            widthInput.value = '1';\n        }\n        updateRatio();\n    };\n    widthInput.onkeyup = function () {\n        updateRatio();\n    };\n    heightInput.onchange = function () {\n        if (heightInput.value === '' || parseFloat(heightInput.value) < 0) {\n            heightInput.value = '1';\n        }\n        updateRatio();\n    };\n    heightInput.onkeyup = function () {\n        updateRatio();\n    };\n    updateRatio();\n\n    newImDiv.appendChild(templateWrapper);\n    let secondRow = BB.el({\n        parent: newImDiv,\n        css: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'flex-end'\n        }\n    });\n    let secondRowLeft = BB.el({\n        parent: secondRow\n    });\n    secondRowLeft.appendChild(widthWrapper);\n    secondRowLeft.appendChild(heightWrapper);\n    secondRowLeft.appendChild(ratioWrapper);\n    secondRow.appendChild(colorOptions.getElement());\n\n    newImDiv.appendChild(previewWrapper);\n\n    popup({\n        target: document.body,\n        message: `<b>${LANG('new-title')}</b>`,\n        div: newImDiv,\n        buttons: ['Ok', 'Cancel'],\n        callback: function (result) {\n            widthInput.onclick = null;\n            heightInput.onclick = null;\n            presetCurrentBtn.onclick = null;\n            presetFitBtn.onclick = null;\n            presetOversizeBtn.onclick = null;\n            presetSquareBtn.onclick = null;\n            presetLandscapeBtn.onclick = null;\n            presetPortraitBtn.onclick = null;\n            widthInput.onchange = null;\n            widthInput.onkeyup = null;\n            heightInput.onchange = null;\n            heightInput.onkeyup = null;\n            select.destroy();\n            colorOptions.destroy();\n\n            if (result === \"Cancel\" || parseInt(widthInput.value) <= 0 || parseInt(heightInput.value) <= 0 || isNaN(parseInt(widthInput.value)) || isNaN(parseInt(heightInput.value))) {\n                onCancel();\n                return;\n            }\n            onConfirm(parseInt(widthInput.value), parseInt(heightInput.value), backgroundRGBA);\n        },\n        clickOnEnter: 'Ok'\n    });\n\n}","import {BB} from '../../../bb/bb';\nimport {renderText} from '../../image-operations/render-text';\nimport {ColorOptions} from '../base-components/color-options';\nimport {Select} from '../base-components/select';\nimport {ImageRadioList} from '../base-components/image-radio-list';\nimport {ImageToggle} from '../base-components/image-toggle';\nimport {KlSlider} from '../base-components/kl-slider';\nimport {popup} from './popup';\n// @ts-ignore\nimport alignLeftImg from 'url:~/src/app/img/ui/align-left.svg';\n// @ts-ignore\nimport alignCenterImg from 'url:~/src/app/img/ui/align-center.svg';\n// @ts-ignore\nimport alignRightImg from 'url:~/src/app/img/ui/align-right.svg';\n// @ts-ignore\nimport typoItalicImg from 'url:~/src/app/img/ui/typo-italic.svg';\n// @ts-ignore\nimport typoBoldImg from 'url:~/src/app/img/ui/typo-bold.svg';\n// @ts-ignore\nimport toolZoomInImg from 'url:~/src/app/img/ui/tool-zoom-in.svg';\n// @ts-ignore\nimport toolZoomOutImg from 'url:~/src/app/img/ui/tool-zoom-out.svg';\nimport {IRGB} from '../../kl.types';\nimport {KlCanvas} from '../../canvas/kl-canvas';\nimport {LANG} from '../../../language/language';\n\n/**\n * Text Tool dialog\n *\n * confirmP = {\n *     x: number,\n *     y: number,\n *     textStr: string,\n *     align: 'left' | 'center' | 'right',\n *     isItalic: boolean,\n *     isBold: boolean,\n *     color: rgb,\n *     size: number, // px\n *     font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy',\n *     opacity: number, // 0 - 1\n * }\n *\n * @param p\n */\nexport function textToolDialog(\n    p: {\n        klCanvas: KlCanvas;\n        layerIndex: number;\n        x: number;\n        y: number;\n        angleRad: number;\n        color: IRGB;\n        secondaryColor: IRGB;\n        size: number; // px\n        align: 'left' | 'center' | 'right'; // default 'left'\n        isBold: boolean; // default false\n        isItalic: boolean; // default false\n        font: 'serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy'; // default sans-serif\n        opacity: number; // 0 - 1; default 1\n        onConfirm: (confirmP) => void;\n    }\n) {\n\n    let div = BB.el({});\n\n    let isSmallWidth = window.innerWidth < 550;\n    let isSmallHeight = window.innerHeight < 630;\n\n    // --- preview ---\n    // Text drawn on klCanvas-sized canvas: textCanvas\n    // LayerArr[target].canvas & textCanvas then drawn on targetCanvas\n    //      they are transformed. canvas size of final preview\n    // All layers and targetCanvas drawn on layersCanvas. transformed and size of final preview\n    // Checkerboard, layersCanvas, and outline then drawn on previewCanvas\n\n    let width = isSmallWidth ? 340 : 540;\n    let height = isSmallWidth ? (isSmallHeight ? 210 : 260) : (isSmallHeight ? 230 : 350);\n    let scale = 1;\n\n    let layerArr = p.klCanvas.getLayersFast();\n    let textCanvas = BB.canvas(p.klCanvas.getWidth(), p.klCanvas.getHeight());\n    let textCtx = textCanvas.getContext('2d');\n    let targetCanvas = BB.canvas(width, height);\n    let targetCtx = targetCanvas.getContext('2d');\n    let layersCanvas = BB.canvas(width, height);\n    let layersCtx = layersCanvas.getContext('2d');\n    let previewCanvas = BB.canvas(width, height); // the one that is visible\n    let previewCtx = previewCanvas.getContext('2d');\n    BB.css(previewCanvas, {\n        display: 'block'\n    });\n    let previewWrapper = BB.el({\n        parent: div,\n        css: {\n            position: 'relative',\n            width: width + 'px',\n            marginLeft: '-20px',\n            cursor: 'move',\n            colorScheme: 'only light',\n            touchAction: 'none',\n        },\n        onClick: function() {\n            textInput.focus();\n        }\n    });\n    BB.el({ // inset shadow on preview\n        parent: previewWrapper,\n        css: {\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            right: '0',\n            bottom: '0',\n            boxShadow: 'rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset',\n            pointerEvents: 'none',\n        }\n    });\n    previewWrapper.appendChild(previewCanvas);\n    let checkerPattern = previewCtx.createPattern(BB.createCheckerCanvas(8), 'repeat');\n    let emptyCanvas = BB.canvas(1, 1);\n    {\n        let ctx = emptyCanvas.getContext('2d');\n        ctx.fillRect(0, 0, 1, 1);\n    }\n\n    function updatePreview() {\n\n        // try to draw very much like klCanvasWorkspace\n\n        // --- draw text ---\n        textCtx.clearRect(0, 0, textCanvas.width, textCanvas.height);\n        let colorRGBA = {\n            ...p.color,\n            a: opacitySlider.getValue(),\n        };\n        let bounds = renderText(textCanvas, {\n            x: p.x,\n            y: p.y,\n            textStr: textInput.value,\n            align: alignRadioList.getValue(),\n            isItalic: italicToggle.getValue(),\n            isBold: boldToggle.getValue(),\n            size: parseFloat(sizeInput.value),\n            font: fontSelect.getValue(),\n            color: BB.ColorConverter.toRgbaStr(colorRGBA),\n            angleRad: p.angleRad\n        });\n\n\n        // --- determine transformation of viewport ---\n        // text should always be visible\n        bounds.width = Math.max(bounds.width, 1);\n        bounds.height = Math.max(bounds.height, 1);\n        let rotatedXY = BB.rotate(bounds.x, bounds.y, -p.angleRad / Math.PI * 180);\n        let rotatedWH = BB.rotate(bounds.width, bounds.height, -p.angleRad / Math.PI * 180);\n        let centerX = p.x + rotatedXY.x + rotatedWH.x / 2;\n        let centerY = p.y + rotatedXY.y + rotatedWH.y / 2;\n\n        let padding = 100;\n        let fitBounds = BB.fitInto(bounds.width, bounds.height, width - padding, height - padding);\n        scale = Math.min(1, fitBounds.width / bounds.width);\n        scale = Math.min(4, scale * Math.pow(2, zoomFac));\n\n\n        // --- compose text and target layer ---\n        targetCtx.save();\n\n        if (scale >= 4) {\n            targetCtx.imageSmoothingEnabled = false;\n        } else {\n            targetCtx.imageSmoothingEnabled = true;\n            targetCtx.imageSmoothingQuality  = scale >= 1 ? 'low' : 'medium';\n        }\n\n        targetCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);\n        targetCtx.translate(width / 2, height / 2);\n        targetCtx.scale(scale, scale);\n        targetCtx.rotate(p.angleRad);\n        targetCtx.drawImage(layerArr[p.layerIndex].canvas, -centerX, -centerY);\n        targetCtx.drawImage(textCanvas, -centerX, -centerY);\n        targetCtx.restore();\n\n\n        // --- layers ---\n        layersCtx.save();\n\n        layersCtx.fillStyle = 'rgb(158,158,158)';\n        layersCtx.fillRect(0, 0, width, height);\n\n        { // bg\n            layersCtx.save();\n\n            layersCtx.translate(width / 2, height / 2);\n            layersCtx.scale(scale, scale);\n            layersCtx.rotate(p.angleRad);\n\n            layersCtx.imageSmoothingEnabled = false;\n\n            //outline\n            let borderSize = 1 / scale;\n            layersCtx.globalAlpha = 0.2;\n            layersCtx.drawImage(emptyCanvas, -centerX - borderSize, -centerY - borderSize, textCanvas.width + borderSize * 2, textCanvas.height + borderSize * 2);\n            layersCtx.globalAlpha = 1;\n\n            //erase\n            layersCtx.globalCompositeOperation = 'destination-out';\n            layersCtx.drawImage(emptyCanvas, -centerX, -centerY, textCanvas.width, textCanvas.height);\n\n            layersCtx.restore();\n        }\n\n        { // individual layers\n\n            if (scale >= 4) {\n                layersCtx.imageSmoothingEnabled = false;\n            } else {\n                layersCtx.imageSmoothingEnabled = true;\n                layersCtx.imageSmoothingQuality  = scale >= 1 ? 'low' : 'medium';\n            }\n\n            // layers below\n            layersCtx.save();\n            layersCtx.translate(width / 2, height / 2);\n            layersCtx.scale(scale, scale);\n            layersCtx.rotate(p.angleRad);\n            for (var i = 0; i < p.layerIndex; i++) {\n                if (layerArr[i].opacity > 0) {\n                    layersCtx.globalAlpha = layerArr[i].opacity;\n                    layersCtx.globalCompositeOperation = layerArr[i].mixModeStr;\n                    layersCtx.drawImage(layerArr[i].canvas, -centerX, -centerY);\n                }\n            }\n            layersCtx.restore();\n\n            // target layer\n            layersCtx.globalAlpha = layerArr[p.layerIndex].opacity;\n            layersCtx.globalCompositeOperation = layerArr[p.layerIndex].mixModeStr;\n            layersCtx.drawImage(targetCanvas, 0, 0);\n\n            // layers above\n            layersCtx.save();\n            layersCtx.translate(width / 2, height / 2);\n            layersCtx.scale(scale, scale);\n            layersCtx.rotate(p.angleRad);\n            for (let i = p.layerIndex + 1; i < layerArr.length; i++) {\n                if (layerArr[i].opacity > 0) {\n                    layersCtx.globalAlpha = layerArr[i].opacity;\n                    layersCtx.globalCompositeOperation = layerArr[i].mixModeStr;\n                    layersCtx.drawImage(layerArr[i].canvas, -centerX, -centerY);\n                }\n            }\n            layersCtx.restore();\n\n        }\n\n        layersCtx.restore();\n\n\n\n        // --- final composite ---\n        previewCtx.save();\n        previewCtx.fillStyle = checkerPattern;\n        previewCtx.fillRect(0, 0, previewCanvas.width, previewCanvas.height);\n        previewCtx.drawImage(layersCanvas, 0, 0);\n        previewCtx.restore();\n\n        // bounds\n        previewCtx.save();\n        previewCtx.globalCompositeOperation = 'difference';\n        previewCtx.strokeStyle = '#fff';\n        previewCtx.lineWidth = 1;\n        // centerX = p.x + bounds.x + bounds.width / 2;\n        // centerY = p.y + bounds.y + bounds.height / 2;\n        previewCtx.strokeRect(\n            Math.round(width / 2 - (bounds.width / 2) * scale),\n            Math.round(height / 2 - (bounds.height / 2) * scale),\n            Math.round(bounds.width * scale),\n            Math.round(bounds.height * scale)\n        );\n        previewCtx.restore();\n\n    }\n\n    function move(x, y) {\n        let rotated = BB.rotate(x, y, -p.angleRad / Math.PI * 180);\n        p.x += rotated.x / scale;\n        p.y += rotated.y / scale;\n        updatePreview();\n    }\n\n    let previewPointerListener = new BB.PointerListener({\n        target: previewCanvas,\n        pointers: 1,\n        onPointer: function(e) {\n            if (e.type === 'pointermove' && e.button) {\n                e.eventPreventDefault();\n                move(-e.dX, -e.dY);\n            }\n        },\n        onWheel: function(e) {\n            changeZoomFac(-e.deltaY);\n        }\n    });\n\n    const wheelPrevent = (event) => {\n        event.preventDefault();\n    }\n    BB.addEventListener(previewCanvas, 'wheel', wheelPrevent);\n\n\n\n    let row1 = BB.el({\n        parent: div,\n        css: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginTop: '10px'\n        }\n    });\n    let row2n3Wrapper = BB.el({\n        parent: div,\n        css: isSmallWidth ? {} : {\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between'\n        }\n    });\n    let row2 = BB.el({\n        parent: row2n3Wrapper,\n        css: {\n            display: 'flex',\n            alignItems: 'center',\n            marginTop: '5px'\n        }\n    });\n    let row3 = BB.el({\n        parent: row2n3Wrapper,\n        css: {\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            marginTop: '5px',\n            width: isSmallWidth ? '' : '300px'\n        }\n    });\n\n    // --- row 1 ---\n\n    // color\n    let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 1};\n    let colorOptionsArr = [\n        {r: 0, g: 0, b: 0, a: 1},\n        {r: 255, g: 255, b: 255, a: 1}\n    ];\n    colorOptionsArr.unshift({\n        r: p.secondaryColor.r,\n        g: p.secondaryColor.g,\n        b: p.secondaryColor.b,\n        a: 1,\n    });\n    colorOptionsArr.unshift({\n        r: p.color.r,\n        g: p.color.g,\n        b: p.color.b,\n        a: 1,\n    });\n\n    let colorOptions = new ColorOptions({\n        colorArr: colorOptionsArr,\n        initialIndex: 0,\n        onChange: function(rgbaObj) {\n            p.color = rgbaObj;\n            updatePreview();\n        }\n    });\n    colorOptions.getElement().title = LANG('text-color');\n    colorOptions.getElement().style.marginLeft = '-5px';\n    row1.appendChild(colorOptions.getElement());\n\n\n    let zoomFac = 0;\n    function changeZoomFac(d) {\n        zoomFac = Math.min(2, Math.max(-2, zoomFac + d));\n        updatePreview();\n        zoomInBtn.disabled = !canZoom(1);\n        zoomOutBtn.disabled = !canZoom(-1);\n    }\n    function canZoom(d) {\n        return zoomFac !== Math.min(2, Math.max(-2, zoomFac + d));\n    }\n\n    let zoomWrapper = BB.el({\n        parent: row1,\n        css: {\n\n        }\n    })\n\n    let zoomInBtn = BB.el({\n        parent: zoomWrapper,\n        content: `<img height=\"20\" src=\"${toolZoomInImg}\">`,\n        title: LANG('zoom-in'),\n        tagName: 'button',\n        onClick: function() {\n            changeZoomFac(1);\n        },\n        css: {\n            fontWeight: 'bold'\n        }\n    }) as HTMLButtonElement;\n    let zoomOutBtn = BB.el({\n        parent: zoomWrapper,\n        content: `<img height=\"20\" src=\"${toolZoomOutImg}\">`,\n        title: LANG('zoom-out'),\n        tagName: 'button',\n        onClick: function() {\n            changeZoomFac(-1);\n        },\n        css: {\n            fontWeight: 'bold',\n            marginLeft: '5px'\n        }\n    }) as HTMLButtonElement;\n\n\n\n    // --- row 2 ---\n    let sizeInput = BB.el({\n        parent: row2,\n        tagName: 'input',\n        title: LANG('text-size'),\n        custom: {\n            type: 'number',\n            min: 1,\n            max: 10000,\n            value: p.size\n        },\n        css: {\n            width: '60px'\n        },\n        onChange: function() {\n            sizeInput.value = '' + Math.max(1, Math.min(10000, parseInt(sizeInput.value)));\n            updatePreview();\n        }\n    }) as HTMLInputElement;\n    let sizePointerListener = new BB.PointerListener({\n        target: sizeInput,\n        onWheel: function(e) {\n            sizeInput.value = '' + Math.max(1, Math.min(1000, parseInt(sizeInput.value) - e.deltaY));\n            updatePreview();\n        }\n    });\n\n    let modeWrapper;\n    let fontSelect;\n    let fontPointerListener;\n    {\n        modeWrapper = BB.el({\n            css: {\n                fontSize: '15px',\n                marginLeft: '10px'\n            }\n        });\n        fontSelect = new Select({\n            isFocusable: true,\n            optionArr: [\n                ['sans-serif', 'Sans-serif'],\n                ['serif', 'Serif'],\n                ['monospace', 'Monospace'],\n                ['cursive', 'Cursive'],\n                ['fantasy', 'Fantasy'],\n            ],\n            initValue: p.font,\n            onChange: function(val) {\n                updatePreview();\n            },\n        });\n\n        modeWrapper.appendChild(fontSelect.getElement());\n        row2.appendChild(modeWrapper);\n\n        fontPointerListener = new BB.PointerListener({\n            target: fontSelect.getElement(),\n            onWheel: function(e) {\n                fontSelect.setDeltaValue(e.deltaY);\n            }\n        });\n\n    }\n\n\n    // --- row 3 ---\n\n    let alignRadioList = new ImageRadioList({\n        optionArr: [\n            {\n                id: 'left',\n                title: LANG('text-left'),\n                image: alignLeftImg,\n            },\n            {\n                id: 'center',\n                title: LANG('text-center'),\n                image: alignCenterImg,\n            },\n            {\n                id: 'right',\n                title: LANG('text-right'),\n                image: alignRightImg,\n            }\n        ],\n        initId: p.align,\n        onChange: function(id) {\n            updatePreview();\n        }\n    });\n    row3.appendChild(alignRadioList.getElement());\n\n    let italicToggle = new ImageToggle({\n        image: typoItalicImg,\n        title: LANG('text-italic'),\n        initValue: p.isItalic,\n        onChange: function(b) {\n            updatePreview();\n        }\n    });\n    row3.appendChild(italicToggle.getElement());\n\n    let boldToggle = new ImageToggle({\n        image: typoBoldImg,\n        title: LANG('text-bold'),\n        initValue: p.isBold,\n        onChange: function(b) {\n            updatePreview();\n        }\n    });\n    row3.appendChild(boldToggle.getElement());\n\n\n\n    let opacitySlider = new KlSlider({\n        label: LANG('opacity'),\n        width: 150,\n        height: 30,\n        min: 0,\n        max: 1,\n        initValue: p.opacity,\n        resolution: 225,\n        eventResMs: 1000 / 30,\n        onChange: function(v) {\n            updatePreview();\n        },\n        formatFunc: function(v) {\n            return Math.round(v * 100);\n        }\n    });\n    row3.appendChild(opacitySlider.getElement());\n\n\n\n    let textInput = BB.el({\n        parent: div,\n        tagName: 'textarea',\n        custom: {\n            placeholder: LANG('text-placeholder'),\n            'data-ignore-focus': 'true',\n        },\n        css: {\n            whiteSpace: 'nowrap',\n            overflow: 'auto',\n            width: '100%',\n            height: '70px',\n            resize: 'vertical',\n            marginTop: '10px'\n        },\n        onChange: function() {\n            updatePreview();\n        }\n    }) as HTMLTextAreaElement;\n    textInput.addEventListener('input', updatePreview);\n    setTimeout(function() {\n        textInput.focus();\n        textInput.select();\n    });\n    let closefunc;\n    let keyListener = new BB.KeyListener({\n        onDown: function(keyStr, e, comboStr) {\n            if (BB.isInputFocused(true)) {\n                return;\n            }\n            if (keyStr === 'left') {\n                move(-1, 0);\n            }\n            if (keyStr === 'right') {\n                move(1, 0);\n            }\n            if (keyStr === 'up') {\n                move(0, -1);\n            }\n            if (keyStr === 'down') {\n                move(0, 1);\n            }\n        }\n    });\n\n    // prevent mobile keyboards scrolling page\n    function onScroll() {\n        window.scrollTo(0, 0);\n    }\n    window.addEventListener('scroll', onScroll);\n\n\n    popup({\n        target: document.body,\n        message: `<b>${LANG('text-title')}</b>`,\n        div: div,\n        buttons: [\"Ok\", \"Cancel\"],\n        style: isSmallWidth ? {} : {\n            width: '500px'\n        },\n        callback: function(val) {\n            window.removeEventListener('scroll', onScroll);\n            previewPointerListener.destroy();\n            sizePointerListener.destroy();\n            fontPointerListener.destroy();\n            BB.removeEventListener(previewCanvas, 'wheel', wheelPrevent);\n            keyListener.destroy();\n            if (val === 'Ok') {\n                p.onConfirm({\n                    x: p.x,\n                    y: p.y,\n                    textStr: textInput.value,\n                    align: alignRadioList.getValue(),\n                    isItalic: italicToggle.getValue(),\n                    isBold: boldToggle.getValue(),\n                    color: p.color,\n                    size: sizeInput.value,\n                    font: fontSelect.getValue(),\n                    opacity: opacitySlider.getValue()\n                });\n            }\n        },\n        autoFocus: false,\n        clickOnEnter: 'Ok',\n        ignoreBackground: true,\n        closefunc: function (func) {\n            closefunc = func;\n        },\n    });\n\n    updatePreview();\n\n}","import {BB} from '../../../bb/bb';\nimport {CropCopy} from '../components/crop-copy';\nimport {Checkbox} from '../base-components/checkbox';\nimport {popup} from './popup';\nimport {LANG} from '../../../language/language';\n\n/**\n *\n * p = {\n *     image: convertedPsd | {type: 'image', width: number, height: number, canvas: image | canvas},\n *     maxSize: number,\n *     target: htmlElement,\n *     callback: func(\n *         {\n *             type: 'as-image',\n *             image: image | canvas,\n *         } | {\n *             type: 'as-image-psd',\n *             image: convertedPsd,\n *             cropObj: {x: number, y: number, width: number, height: number}\n *         } | {\n *             type: 'as-layer',\n *             image: image | canvas,\n *         } | {\n *             type: 'cancel',\n *         }\n *     )\n * }\n *\n * @param p {}\n */\nexport function showImportImageDialog(p) {\n    const div = BB.el({});\n\n    const isSmall = window.innerWidth < 550 || window.innerHeight < 550;\n    const style = isSmall ? {} : { width: '500px' };\n    let resolutionEl;\n    const cropCopy = new CropCopy({\n        width: isSmall ? 340 : 540,\n        height: isSmall ? 300 : 400,\n        canvas: p.image.canvas,\n        isNotCopy: true,\n        onChange: function(width, height) {\n            if (!resolutionEl) {\n                return;\n            }\n            updateResolution(width, height);\n        }\n    });\n    BB.css(cropCopy.getEl(), {\n        marginLeft: '-20px',\n        borderTop: '1px solid #bbb',\n        borderBottom: '1px solid #bbb'\n    });\n    cropCopy.getEl().title = LANG('crop-drag-to-crop');\n    div.appendChild(cropCopy.getEl());\n\n\n    resolutionEl = BB.el({\n        parent: div,\n        css: {\n            marginTop: '10px',\n            textAlign: 'center',\n            color: '#888',\n            lineHeight: '20px',\n        }\n    });\n    function updateResolution(w: number, h: number) {\n        const fit = BB.fitInto(w, h, p.maxSize, p.maxSize);\n\n        if (fit.width < w) {\n            resolutionEl.innerHTML = `<span style=\"color:#f00\">${w} X ${h}</span> ⟶ ${Math.round(fit.width)} X ${Math.round(fit.height)}`;\n            resolutionEl.title = LANG('import-too-large');\n        } else {\n            resolutionEl.innerHTML = `${w} X ${h}`;\n            resolutionEl.title = '';\n        }\n    }\n    updateResolution(p.image.width, p.image.height);\n\n\n    let doFlatten = false;\n    function showWarnings(psdWarningArr) {\n        let contentArr = [];\n        let warningMap = {\n            'mask': 'Masks not supported. Mask was applied.',\n            'clipping': 'Clipping not supported. Clipping layers were merged.',\n            'group': 'Groups not supported. Layers were ungrouped.',\n            'adjustment': 'Adjustment layers not supported.',\n            'layer-effect': 'Layer effects not supported.',\n            'smart-object': 'Smart objects not supported.',\n            'blend-mode': 'Unsupported layer blend mode.',\n            'bits-per-channel': 'Unsupported color depth. Only 8bit per channel supported.',\n        };\n        for (let i = 0; i < psdWarningArr.length; i++) {\n            contentArr.push('- ' + warningMap[psdWarningArr[i]]);\n        }\n        alert(contentArr.join(\"\\n\"));\n    }\n\n    let flattenCheckbox;\n    if (p.image.type === 'psd') {\n        const noteStyle = {\n            background: 'rgba(255,255,0,0.5)',\n            padding: '10px',\n            marginTop: '5px',\n            marginBottom: '5px',\n            border: '1px solid #e7d321',\n            borderRadius: '5px'\n        };\n        if (p.image.layers) {\n            flattenCheckbox = new Checkbox({\n                init: doFlatten,\n                label: LANG('import-flatten'),\n                callback: function(b) {\n                    doFlatten = b;\n                }\n            });\n            div.appendChild(flattenCheckbox.getElement());\n\n            if (p.image.warningArr) {\n                const noteEl = BB.el({\n                    content: LANG('import-psd-limited-support'),\n                    css: noteStyle\n                });\n                noteEl.appendChild(BB.el({\n                    tagName: 'a',\n                    content: 'Details',\n                    onClick: function() {\n                        showWarnings(p.image.warningArr);\n                    }\n                }));\n                div.appendChild(noteEl);\n            }\n        } else {\n            const noteEl = BB.el({\n                content: LANG('import-psd-unsupported'),\n                css: noteStyle\n            });\n            div.appendChild(noteEl);\n        }\n    }\n\n    function callback(result) {\n        const croppedImage = cropCopy.getCroppedImage();\n        const cropRect = cropCopy.getRect();\n        cropCopy.destroy();\n        if (flattenCheckbox) {\n            flattenCheckbox.destroy();\n        }\n\n        if (result === LANG('import-btn-as-layer')) {\n            p.callback({\n                type: 'as-layer',\n                image: croppedImage\n            });\n\n        } else if (result === LANG('import-btn-as-image')) {\n            if (p.image.type === 'psd') {\n                if (doFlatten) {\n                    p.image.layers = null;\n                }\n                p.callback({\n                    type: 'as-image-psd',\n                    image: p.image,\n                    cropObj: cropRect\n                });\n            } else if (p.image.type === 'image') {\n                p.callback({\n                    type: 'as-image',\n                    image: croppedImage\n                });\n            }\n        } else {\n            p.callback({\n                type: 'cancel'\n            });\n        }\n    }\n    popup({\n        target: p.target,\n        message: `<b>${LANG('import-title')}</b>`,\n        div: div,\n        style,\n        buttons: [LANG('import-btn-as-layer'), LANG('import-btn-as-image'), \"Cancel\"],\n        callback: callback,\n        autoFocus: 'As Image'\n    });\n}","import {BB} from '../../../bb/bb';\nimport {KL} from '../../kl';\n// @ts-ignore\nimport loadingImg from 'url:~/src/app/img/ui/loading.gif';\nimport {SaveReminder} from '../components/save-reminder';\nimport {base64ToBlob} from '../../storage/base-64-to-blob';\nimport {KlCanvas} from '../../canvas/kl-canvas';\nimport {LANG} from '../../../language/language';\n\n\nasync function upload(canvas, title, description, type: 'png' | 'jpeg', imgurKey: string): Promise<{deletehash: string}> {\n    let img = base64ToBlob(canvas.toDataURL(\"image/\" + type));\n\n    let w = window.open();\n    let label = w.document.createElement(\"div\");\n    let gif = w.document.createElement(\"img\");\n    gif.src = loadingImg;\n    label.appendChild(gif);\n    BB.css(gif, {\n        filter: \"invert(1)\"\n    });\n    w.document.body.style.backgroundColor = \"#121211\";\n    w.document.body.style.backgroundImage = \"linear-gradient(#2b2b2b 0%, #121211 50%)\";\n    w.document.body.style.backgroundRepeat = \"no-repeat\";\n    let labelText = w.document.createElement(\"div\");\n    labelText.style.marginTop = \"10px\";\n    label.appendChild(labelText);\n    labelText.textContent = LANG('upload-uploading');\n\n    w.document.body.appendChild(label);\n    BB.css(label, {\n        marginLeft: \"auto\",\n        marginRight: \"auto\",\n        marginTop: \"100px\",\n        fontFamily: \"Arial, sans-serif\",\n        fontSize: \"20px\",\n        textAlign: \"center\",\n        transition: \"opacity 0.3s ease-in-out\",\n        opacity: '0',\n        color: \"#ccc\"\n    });\n    setTimeout(function () {\n        label.style.opacity = '1';\n    }, 20);\n\n    let response;\n    try {\n        const formData = new FormData();\n        formData.append('title', title);\n        formData.append('description', description);\n        formData.append('image', img);\n        response = await fetch('https://api.imgur.com/3/image',  {\n            method: 'POST',\n            headers: {\n                Authorization: 'Client-ID ' + imgurKey,\n            },\n            body: formData\n        });\n\n    } catch (e) {\n        w.close();\n        throw new Error(e);\n    }\n    if (!response.ok) {\n        w.close();\n        throw new Error();\n    }\n    let data = (await response.json()).data;\n\n    w.location.href = (data as any).link.replace(/\\.(jpg|png)/, '');\n\n    return data;\n}\n\n\nexport function imgurUpload(klCanvas: KlCanvas, klRootEl, saveReminder: SaveReminder, imgurKey: string) {\n    if (!imgurKey) {\n        throw new Error('imgur key missing');\n    }\n\n    let inputTitle = document.createElement(\"input\");\n    inputTitle.type = \"text\";\n    inputTitle.value = LANG('upload-title-untitled');\n    let inputDescription = BB.el({\n        tagName: 'textarea',\n        custom: {\n            rows: 2,\n        },\n        css: {\n            width: '100%',\n            maxWidth: '100%',\n        },\n    }) as HTMLTextAreaElement;\n\n    let labelTitle = document.createElement(\"div\");\n    labelTitle.textContent = LANG('upload-name') + \":\";\n    let labelDescription = BB.el({\n        content: LANG('upload-caption') + ':',\n        css: {\n            marginTop: '10px',\n        }\n    });\n\n    let tos = document.createElement(\"div\");\n    tos.innerHTML = `<br/><a href=\"https://imgur.com/tos\" target=\"_blank\" rel=\"noopener noreferrer\">${LANG('upload-tos')}</a> ${LANG('upload-tos-2')}`;\n\n    const typeRadio = new KL.RadioList({\n        name: 'filetype',\n        init: 'jpeg',\n        items: [\n            { label: 'JPG', value: 'jpeg' },\n            { label: 'PNG', value: 'png' },\n        ],\n        ignoreFocus: true,\n    });\n    BB.css(typeRadio.getElement(), {\n        marginBottom: '10px',\n    });\n\n\n    let outDiv = document.createElement(\"div\");\n    let infoHint = document.createElement(\"div\");\n    infoHint.className = \"info-hint\";\n    infoHint.textContent = LANG('upload-link-notice');\n    outDiv.append(\n        infoHint,\n        typeRadio.getElement(),\n        labelTitle,\n        inputTitle,\n        labelDescription,\n        inputDescription,\n        tos\n    );\n    KL.popup({\n        target: klRootEl,\n        message: `<b>${LANG('upload-title')}</b>`,\n        type: \"upload\",\n        div: outDiv,\n        buttons: [LANG('upload-submit'), \"Cancel\"],\n        clickOnEnter: LANG('upload-submit'),\n        primaries: [LANG('upload-submit')],\n        autoFocus: LANG('upload-submit'),\n        callback: async function (val) {\n            if (val === LANG('upload-submit') || val === \"Yes\" || val === \"Ok\") {\n                try {\n                    const result = await upload(\n                        klCanvas.getCompleteCanvas(1),\n                        inputTitle.value,\n                        inputDescription.value,\n                        typeRadio.getValue() as 'png' | 'jpeg',\n                        imgurKey,\n                    );\n\n                    KL.popup({\n                        target: klRootEl,\n                        type: \"ok\",\n                        message: `<h3>${LANG('upload-success')}</h3><br>${LANG('upload-delete')}<br><a target='_blank' rel=\"noopener noreferrer\" href='https://imgur.com/delete/${result.deletehash}'>imgur.com/<b>delete</b>/${result.deletehash}</a><br><br>`,\n                        buttons: [\"Ok\"]\n                    });\n                    saveReminder.reset();\n\n                } catch(e) {\n                    KL.popup({\n                        target: klRootEl,\n                        type: \"error\",\n                        message: LANG('upload-failed'),\n                        buttons: [\"Ok\"]\n                    });\n                }\n            }\n        }\n    });\n}","import {BB} from '../../../bb/bb';\n// @ts-ignore\nimport angleImg from 'url:~/src/app/img/ui/angle.svg';\n// @ts-ignore\nimport rotateImg from 'url:~/src/app/img/ui/edit-rotate.svg';\nimport {LANG} from '../../../language/language';\n\n/**\n * Ui, when hand tool tab is open.\n *\n * p = {\n *     scale: number, // initial value\n *     angleDeg: number, // initial value\n *     onReset: function(),\n *     onFit: function(),\n *     onAngleChange: function(angleDeg number, isRelative number)\n * }\n *\n * @param p\n * @constructor\n */\nexport function HandUi(p) {\n    let div = BB.el({\n        css: {\n            margin: '10px'\n        }\n    });\n    let isVisible = true;\n    let scale = p.scale;\n    let angleDeg = p.angleDeg;\n\n    let row1 = BB.el({\n        css: {\n            marginBottom: '10px',\n            display: 'flex'\n        }\n    });\n    let row2 = BB.el({\n        css: {\n            display: 'flex',\n            marginBottom: '10px',\n        }\n    });\n    let row3 = BB.el({\n        css: {\n            display: 'flex'\n        }\n    });\n    div.append(row1, row2, row3);\n\n\n    let scaleEl = BB.el({\n        css: {\n            width: '55px',\n            userSelect: 'none'\n        }\n    });\n    row1.appendChild(scaleEl);\n\n    let angleIm = new Image();\n    angleIm.src = angleImg;\n    BB.css(angleIm, {\n        verticalAlign: 'bottom',\n        width: '20px',\n        height: '20px',\n        marginRight: '5px',\n        borderRadius: '10px',\n        background: 'rgba(0,0,0,0.2)',\n        userSelect: 'none'\n    });\n    row1.appendChild(angleIm);\n\n    let angleEl = BB.el({\n        css: {\n            userSelect: 'none'\n        }\n    });\n    row1.appendChild(angleEl);\n\n\n    function update() {\n        scaleEl.innerHTML = Math.round(scale * 100) + '%';\n        angleEl.innerHTML =  Math.round(angleDeg) + '°';\n\n\n        angleIm.style.transform = 'rotate(' + angleDeg + 'deg)';\n        if (angleDeg % 90 === 0) {\n            angleIm.style.boxShadow = 'inset 0 0 0 1px rgba(255,255,255, 1), 0 0 0 1px rgba(0, 0, 0, 0.3)';\n        } else {\n            angleIm.style.boxShadow = '';\n        }\n    }\n    update();\n\n\n    let resetButton = BB.el({\n        tagName: 'button',\n        content: LANG('hand-reset'),\n        onClick: p.onReset\n    });\n    BB.makeUnfocusable(resetButton);\n\n    let fitButton = BB.el({\n        tagName: 'button',\n        content: LANG('hand-fit'),\n        css: {\n            marginLeft: '10px'\n        },\n        onClick: p.onFit\n    });\n    BB.makeUnfocusable(fitButton);\n    row2.append(resetButton, fitButton);\n\n    let leftRotateButton = BB.el({\n        tagName: 'button',\n        content: '<img height=\"20\" src=\"' + rotateImg + '\" alt=\"Rotate\" style=\"transform: scale(-1, 1)\"/>',\n        onClick: function() {\n            p.onAngleChange(-15, true);\n        }\n    });\n    BB.makeUnfocusable(leftRotateButton);\n\n    let resetAngleButton = BB.el({\n        tagName: 'button',\n        content: '0°',\n        css: {\n            marginLeft: '10px'\n        },\n        onClick: function() {\n            p.onAngleChange(0);\n        }\n    });\n    BB.makeUnfocusable(resetAngleButton);\n\n    let rightRotateButton = BB.el({\n        tagName: 'button',\n        content: '<img height=\"20\" src=\"' + rotateImg + '\" alt=\"Rotate\"/>',\n        css: {\n            marginLeft: '10px'\n        },\n        onClick: function() {\n            p.onAngleChange(15, true);\n        }\n    });\n    BB.makeUnfocusable(rightRotateButton);\n    row3.append(leftRotateButton, resetAngleButton, rightRotateButton);\n\n\n\n    // --- interface ---\n    this.getElement = function() {\n        return div;\n    };\n    this.setIsVisible = function(pIsVisible) {\n        isVisible = !!pIsVisible;\n        div.style.display = isVisible ? 'block' : 'none';\n        if (isVisible) {\n            update();\n        }\n    };\n    this.update = function(pScale, pAngleDeg) {\n        scale = pScale;\n        angleDeg = pAngleDeg;\n        if (isVisible) {\n            update();\n        }\n    };\n}","import {BB} from '../../../bb/bb';\nimport {KlSlider} from '../base-components/kl-slider';\nimport {Select} from '../base-components/select';\nimport {Checkbox} from '../base-components/checkbox';\nimport {LANG} from '../../../language/language';\n\n/**\n * Paint Bucket tab contents (color slider, opacity slider, etc)\n *\n * p = {\n *     colorSlider: KlColorSlider// when opening tab, inserts it (snatches it from where else it was)\n * }\n *\n * @param p\n * @constructor\n */\nexport function FillUi(p) {\n    let div = BB.el({\n        css: {\n            margin: '10px'\n        }\n    });\n    let isVisible = true;\n\n    let colorDiv = BB.el({\n        parent: div,\n        css: {\n            marginBottom: '10px'\n        }\n    });\n\n    let opacitySlider = new KlSlider({\n        label: LANG('opacity'),\n        width: 250,\n        height: 30,\n        min: 0,\n        max: 1,\n        initValue: 1,\n        onChange: function (val) {\n        },\n        formatFunc: function(v) {\n            return Math.round(v * 100);\n        }\n    });\n    div.appendChild(opacitySlider.getElement());\n\n    let toleranceSlider = new KlSlider({\n        label: LANG('bucket-tolerance'),\n        width: 250,\n        height: 30,\n        min: 0,\n        max: 255,\n        initValue: 255 / 100 * 20,\n        onChange: function (val) {\n        },\n        formatFunc: function(v) {\n            return Math.round(v / 255 * 100);\n        }\n    });\n    BB.css(toleranceSlider.getElement(), {\n        marginTop: '10px'\n    });\n    div.appendChild(toleranceSlider.getElement());\n\n    let selectRow = BB.el({\n        parent: div,\n        css: {\n            display: 'flex',\n            marginTop: '10px'\n        }\n    });\n\n    let modeWrapper;\n    let modeSelect;\n    modeWrapper = BB.el({\n        content: LANG('bucket-sample') + '&nbsp;',\n        title: LANG('bucket-sample-title'),\n        css: {\n            fontSize: '15px'\n        }\n    });\n    modeSelect = new Select({\n        optionArr: [\n            ['all', LANG('bucket-sample-all')],\n            ['current', LANG('bucket-sample-active')],\n            ['above', LANG('bucket-sample-above')]\n        ],\n        initValue: 'all',\n        onChange: function(val) {}\n    });\n    let modePointerListener = new BB.PointerListener({\n        target: modeSelect.getElement(),\n        onWheel: function(e) {\n            modeSelect.setDeltaValue(e.deltaY);\n        }\n    });\n    modeWrapper.appendChild(modeSelect.getElement());\n    selectRow.appendChild(modeWrapper);\n\n    let growWrapper;\n    let growSelect;\n    growWrapper = BB.el({\n        content: LANG('bucket-grow') + '&nbsp;',\n        title: LANG('bucket-grow-title'),\n        css: {\n            fontSize: '15px',\n            marginLeft: '10px'\n        }\n    });\n    growSelect = new Select({\n        optionArr: [\n            ['0', '0'],\n            ['1', '1'],\n            ['2', '2'],\n            ['3', '3'],\n            ['4', '4'],\n            ['5', '5'],\n            ['6', '6'],\n            ['7', '7'],\n        ],\n        initValue: '0',\n        onChange: function(val) {}\n    });\n    let growPointerListener = new BB.PointerListener({\n        target: growSelect.getElement(),\n        onWheel: function(e) {\n            growSelect.setDeltaValue(e.deltaY);\n        }\n    });\n    growWrapper.appendChild(growSelect.getElement());\n    selectRow.appendChild(growWrapper);\n\n\n    let isContiguous = true;\n    let contiguousToggle = new Checkbox({\n        init: true,\n        label: LANG('bucket-contiguous'),\n        title: LANG('bucket-contiguous-title'),\n        callback: function (b) {\n            isContiguous = b;\n        },\n        css: {\n            marginTop: '10px',\n            paddingRight: '5px',\n            display: 'inline-block',\n        }\n    });\n    div.appendChild(contiguousToggle.getElement());\n\n\n\n\n    // --- interface ---\n\n    this.getElement = function() {\n        return div;\n    };\n\n    this.setIsVisible = function(pIsVisible) {\n        isVisible = !!pIsVisible;\n        div.style.display = isVisible ? 'block' : 'none';\n        if (isVisible) {\n            colorDiv.appendChild(p.colorSlider.getElement());\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\n        }\n    };\n\n    this.getTolerance = function() {\n        return toleranceSlider.getValue();\n    };\n\n    this.getOpacity = function() {\n        return opacitySlider.getValue();\n    };\n\n    /**\n     * returns string 'current' | 'all' | 'above'\n     */\n    this.getSample = function() {\n        return modeSelect.getValue();\n    };\n\n    this.getGrow = function() {\n        return parseInt(growSelect.getValue(), 10);\n    }\n\n    this.getContiguous = function() {\n        return isContiguous;\n    };\n\n}","import {BB} from '../../../bb/bb';\nimport {LANG} from '../../../language/language';\n\n/**\n * Text Tool tab contents (color slider)\n *\n * p = {\n *     colorSlider: KlColorSlider// when opening tab, inserts it (snatches it from where else it was)\n * }\n *\n * @param p\n * @constructor\n */\nexport function TextUi(p) {\n    let div = BB.el({\n        css: {\n            margin: '10px'\n        }\n    });\n    let isVisible = true;\n\n    let colorDiv = BB.el({\n        parent: div,\n        css: {\n            marginBottom: '10px'\n        }\n    });\n\n    let hint = BB.el({\n        parent: div,\n        content: LANG('text-instruction'),\n    });\n\n\n    // --- interface ---\n\n    this.getElement = function() {\n        return div;\n    };\n\n    this.setIsVisible = function(pIsVisible) {\n        isVisible = !!pIsVisible;\n        div.style.display = isVisible ? 'block' : 'none';\n        if (isVisible) {\n            colorDiv.appendChild(p.colorSlider.getElement());\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\n            //update();\n        }\n    };\n\n}","import {BB} from '../../../bb/bb';\nimport {Options} from '../base-components/options';\nimport {Checkbox} from '../base-components/checkbox';\nimport {KlSlider} from '../base-components/kl-slider';\nimport {LANG} from '../../../language/language';\n\n/**\n * Shape Tool tab contents\n *\n * p = {\n *     colorSlider: KlColorSlider// when opening tab, inserts it (snatches it from where else it was)\n * }\n *\n * @param p\n * @constructor\n */\nexport function ShapeUi(p) {\n    let div = BB.el({\n        css: {\n            margin: '10px'\n        }\n    });\n    let isVisible = true;\n\n    let colorDiv = BB.el({\n        parent: div,\n        css: {\n            marginBottom: '10px'\n        }\n    });\n\n    let previewSize = 35;\n    let previewPadding = 8;\n    let shape; // 'rect'|'ellipse'|'line'\n    let mode; // 'stroke'|'fill'\n\n\n    let rectStrokeSvgRect = BB.createSvg({\n        elementType: 'rect',\n        x: '' + previewPadding,\n        width: '' + (previewSize - previewPadding * 2)\n    });\n    let rectStrokeSvg = BB.createSvg({\n        elementType: 'svg',\n        width: '' + previewSize,\n        height: '' + previewSize\n    });\n    rectStrokeSvg.appendChild(rectStrokeSvgRect);\n    BB.css(rectStrokeSvg, {\n        display: 'block'\n    });\n\n    let rectFilledSvgRect = BB.createSvg({\n        elementType: 'rect',\n        x: '' + previewPadding,\n        width: '' + (previewSize - previewPadding * 2)\n    });\n    let rectFilledSvg = BB.createSvg({\n        elementType: 'svg',\n        width: '' + previewSize,\n        height: '' + previewSize\n    });\n    rectFilledSvg.appendChild(rectFilledSvgRect);\n    BB.css(rectFilledSvg, {\n        display: 'block'\n    });\n\n\n    let ellipseStrokeSvgEllipse = BB.createSvg({\n        elementType: 'ellipse',\n        cx: '' + (previewSize / 2),\n        cy: '' + (previewSize / 2),\n        rx: '' + (previewSize / 2 - previewPadding)\n    });\n    let ellipseStrokeSvg = BB.createSvg({\n        elementType: 'svg',\n        width: '' + previewSize,\n        height: '' + previewSize,\n    });\n    ellipseStrokeSvg.appendChild(ellipseStrokeSvgEllipse);\n    BB.css(ellipseStrokeSvg, {\n        display: 'block'\n    });\n\n    let ellipseFilledSvgEllipse = BB.createSvg({\n        elementType: 'ellipse',\n        cx: '' + (previewSize / 2),\n        cy: '' + (previewSize / 2),\n        rx: '' + (previewSize / 2 - previewPadding)\n    });\n    let ellipseFilledSvg = BB.createSvg({\n        elementType: 'svg',\n        width: '' + previewSize,\n        height: '' + previewSize,\n    });\n    ellipseFilledSvg.appendChild(ellipseFilledSvgEllipse);\n    BB.css(ellipseFilledSvg, {\n        display: 'block'\n    });\n\n\n    let lineSvgLine = BB.createSvg({\n        elementType: 'line',\n        x1: '' + previewPadding,\n        x2: '' + (previewSize - previewPadding)\n    });\n    let lineSvg = BB.createSvg({\n        elementType: 'svg',\n        width: '' + previewSize,\n        height: '' + previewSize\n    });\n    lineSvg.appendChild(lineSvgLine);\n    BB.css(lineSvg, {\n        display: 'block'\n    });\n\n    function updatePreviews() {\n        let strokeWidth = BB.clamp(Math.round(lineWidthSlider.getValue() / 10), 1, 10) + 'px';\n\n        let squish = 1.35;\n\n        BB.css(rectStrokeSvgRect, { fill: 'none', stroke: 'black', strokeWidth: strokeWidth });\n        BB.css(rectFilledSvgRect, { fill: 'black', stroke: 'none' });\n\n        BB.css(ellipseStrokeSvgEllipse, { fill: 'none', stroke: 'black', strokeWidth: strokeWidth });\n        BB.css(ellipseFilledSvgEllipse, { fill: 'black', stroke: 'none' });\n\n        BB.css(\n            lineSvgLine,\n            { fill: 'none', stroke: 'black', strokeWidth: strokeWidth }\n        );\n\n        if ((fixedToggle as any).getValue()) {\n            rectStrokeSvgRect.setAttribute('y', '' + previewPadding);\n            rectStrokeSvgRect.setAttribute('height', '' + (previewSize - previewPadding * 2));\n            rectFilledSvgRect.setAttribute('y', '' + previewPadding);\n            rectFilledSvgRect.setAttribute('height', '' + (previewSize - previewPadding * 2));\n\n            ellipseStrokeSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding));\n            ellipseFilledSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding));\n        } else {\n            rectStrokeSvgRect.setAttribute('y', '' + (previewPadding * squish));\n            rectStrokeSvgRect.setAttribute('height', '' + (previewSize - previewPadding * squish * 2));\n            rectFilledSvgRect.setAttribute('y', '' + (previewPadding * squish));\n            rectFilledSvgRect.setAttribute('height', '' + (previewSize - previewPadding * squish * 2));\n\n            ellipseStrokeSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding * squish));\n            ellipseFilledSvgEllipse.setAttribute('ry', '' + (previewSize / 2 - previewPadding * squish));\n        }\n\n        if ((snapToggle as any).getValue()) {\n            lineSvgLine.setAttribute('y1', '' + (previewSize - previewPadding));\n            lineSvgLine.setAttribute('y2', '' + previewPadding);\n        } else {\n            lineSvgLine.setAttribute('y1', '' + (previewSize - previewPadding * squish));\n            lineSvgLine.setAttribute('y2', '' + (previewPadding * squish));\n        }\n    }\n\n    let row1 = BB.el({\n        parent: div,\n        css: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'start'\n        }\n    });\n\n    let shapeOptions = new Options({\n        optionArr: [\n            {\n                id: 'rect-stroke',\n                label: rectStrokeSvg,\n                title: LANG('shape-rect') + ' ' + LANG('shape-stroke'),\n            },\n            {\n                id: 'ellipse-stroke',\n                label: ellipseStrokeSvg,\n                title: LANG('shape-ellipse') + ' ' + LANG('shape-stroke'),\n            },\n            {\n                id: 'line',\n                label: lineSvg,\n                title: LANG('shape-line'),\n            },\n            {\n                id: 'rect-fill',\n                label: rectFilledSvg,\n                title: LANG('shape-rect') + ' ' + LANG('shape-fill'),\n            },\n            {\n                id: 'ellipse-fill',\n                label: ellipseFilledSvg,\n                title: LANG('shape-ellipse') + ' ' + LANG('shape-fill'),\n            },\n        ],\n        initId: 'rect',\n        onChange: function(id) {\n            let split = id.split('-');\n            shape = split[0];\n            mode = split[1];\n\n            BB.css(fixedToggle.getElement(), {\n                display: shape === 'line' ? 'none' : null\n            });\n            BB.css(snapToggle.getElement(), {\n                display: shape === 'line' ? null : 'none'\n            });\n            BB.css(lineWidthSlider.getElement(), {\n                display: (shape !== 'line' && mode === 'fill') ? 'none' : null\n            });\n        },\n        changeOnInit: true\n    });\n    shapeOptions.getElement().style.width = '120px';\n    row1.appendChild(shapeOptions.getElement());\n\n    let eraserToggle = new Checkbox({\n        init: false,\n        label: LANG('eraser'),\n        callback: function(b) {\n            updatePreviews();\n        }\n    });\n    row1.appendChild(eraserToggle.getElement());\n\n    let lineWidthSlider = new KlSlider({\n        label: LANG('shape-line-width'),\n        width: 250,\n        height: 30,\n        min: 1,\n        max: 200,\n        initValue: 4,\n        curve: 'quadratic',\n        onChange: function (val) {\n            updatePreviews();\n        },\n        formatFunc: function (v) {\n            return Math.round(v);\n        }\n    });\n    BB.css(lineWidthSlider.getElement(), {\n        marginTop: '10px'\n    });\n    div.appendChild(lineWidthSlider.getElement());\n\n    let opacitySlider = new KlSlider({\n        label: LANG('opacity'),\n        width: 250,\n        height: 30,\n        min: 0,\n        max: 1,\n        initValue: 1,\n        onChange: function (val) {\n        },\n        formatFunc: function (v) {\n            return Math.round(v * 100);\n        }\n    });\n    BB.css(opacitySlider.getElement(), {\n        marginTop: '10px'\n    });\n    div.appendChild(opacitySlider.getElement());\n\n    let row2 = BB.el({\n        parent: div,\n        css: {\n            display: 'flex',\n            alignItems: 'center',\n            marginTop: '10px'\n        }\n    });\n\n    let outwardsToggle = new Checkbox({\n        init: false,\n        label: LANG('shape-outwards'),\n        callback: function(b) {},\n        css: {\n            width: '50%',\n            marginRight: '10px',\n        }\n    });\n    row2.appendChild(outwardsToggle.getElement());\n\n    let fixedToggle = new Checkbox({\n        init: false,\n        label: LANG('shape-fixed'),\n        callback: function(b) {\n            updatePreviews();\n        },\n        css: {\n            flexGrow: '1',\n        }\n    });\n    row2.appendChild(fixedToggle.getElement());\n\n    let snapToggle = new Checkbox({\n        init: false,\n        label: LANG('shape-snap'),\n        title: LANG('shape-snap-title'),\n        callback: function(b) {\n            updatePreviews();\n        },\n        css: {\n            flexGrow: '1',\n        }\n    });\n    row2.appendChild(snapToggle.getElement());\n\n\n\n    updatePreviews();\n\n    // --- interface ---\n\n    this.getElement = function() {\n        return div;\n    };\n\n    this.setIsVisible = function(pIsVisible) {\n        isVisible = !!pIsVisible;\n        div.style.display = isVisible ? 'block' : 'none';\n        if (isVisible) {\n            colorDiv.appendChild(p.colorSlider.getElement());\n            colorDiv.appendChild(p.colorSlider.getOutputElement());\n            //update();\n        }\n    };\n\n    this.getShape = function() {\n        return shape;\n    };\n\n    this.getMode = function() {\n        return mode;\n    };\n\n    this.getIsEraser = function() {\n        return (eraserToggle as any).getValue();\n    };\n\n    this.getOpacity = function() {\n        return opacitySlider.getValue();\n    };\n\n    this.getLineWidth = function() {\n        return lineWidthSlider.getValue();\n    };\n\n    this.getIsOutwards = function() {\n        return (outwardsToggle as any).getValue();\n    };\n\n    this.getIsFixed = function() {\n        return (fixedToggle as any).getValue();\n    };\n\n    this.getIsSnap = function() {\n        return (snapToggle as any).getValue();\n    };\n\n}","import {BB} from '../../../bb/bb';\nimport {KL} from '../../kl';\n// @ts-ignore\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\n// @ts-ignore\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\n// @ts-ignore\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\n// @ts-ignore\nimport uploadImg from 'url:~/src/app/img/ui/upload.svg';\n// @ts-ignore\nimport importImg from 'url:~/src/app/img/ui/import.svg';\n// @ts-ignore\nimport copyImg from 'url:~/src/app/img/ui/copy.svg';\nimport {BrowserStorageUi} from '../components/browser-storage-ui';\nimport {IKlProject} from '../../kl.types';\nimport {SaveReminder} from '../components/save-reminder';\nimport {ProjectStore} from '../../storage/project-store';\nimport {LANG} from '../../../language/language';\n\nexport type exportType = 'png' | 'layers' | 'psd';\n\n\n\n\n\n\n\n\nexport class FileTab {\n\n    private readonly div: HTMLDivElement;\n    private importButton: HTMLInputElement;\n    private fileBrowserStorage: BrowserStorageUi;\n\n    constructor(\n        klRootEl,\n        projectStore: ProjectStore,\n        getProject: () => IKlProject,\n        private exportType,\n        onExportTypeChange,\n        onFileSelect,\n        onSaveImageToComputer,\n        onNewImage,\n        onShareImage,\n        onUpload,\n        onCopyToClipboard,\n        saveReminder: SaveReminder,\n    ) {\n        const _this = this;\n        this.div = document.createElement(\"div\");\n\n        const asyncCreation = () => {\n            let filemenu = document.createElement(\"div\");\n            let newButton = document.createElement(\"button\");\n            let saveButton = document.createElement(\"button\");\n          \n         \n\n            newButton.style.cssFloat = 'left';\n            BB.css(saveButton, {\n                \n                cssFloat: 'left',\n                clear: 'both',\n            });\n          \n\n            newButton.tabIndex = -1;\n            saveButton.tabIndex = -1;\n    \n\n            newButton.innerHTML = `<img src='${newImageImg}' alt='icon' height='20'/>${LANG('file-new')}`;\n            saveButton.innerHTML = `<img src='${exportImg}' alt='icon' height='20'/>${LANG('file-save')}`;\n            newButton.className = \"gridButton\";\n            saveButton.className = \"gridButton\";\n\n\n            this.importButton = document.createElement(\"input\");\n            this.importButton.tabIndex = -1;\n            this.importButton.type = \"file\";\n            this.importButton.multiple = true;\n            this.importButton.accept = \"image\";\n            (this.importButton as any).size = \"71\";\n            this.importButton.textContent = \"Import\";\n            let importWrapper: any = this.importButton;\n\n            function createImportButton() {\n                importWrapper = document.createElement(\"div\");\n                importWrapper.className = \"gridButton\";\n                importWrapper.style.position = \"relative\";\n                importWrapper.style.cursor = \"pointer\";\n                importWrapper.style.cssFloat = \"left\";\n\n                let innerMask = document.createElement(\"div\");\n                innerMask.style.width = \"120px\";\n                innerMask.style.height = \"28px\";\n                innerMask.style.overflow = \"hidden\";\n                innerMask.style.cursor = \"pointer\";\n                innerMask.style.position = \"relative\";\n\n                importWrapper.appendChild(innerMask);\n                innerMask.appendChild(_this.importButton);\n\n                let importFakeButton = document.createElement(\"button\");\n                importFakeButton.innerHTML = \"<img style='float:left' height='20' src='\" + importImg + \"' alt='icon'/>\" + LANG('file-import');\n                importFakeButton.tabIndex = -1;\n\n                BB.css(importFakeButton, {\n               \n                    width: \"120px\",\n                    display: \"box\",\n                    position: \"absolute\",\n                    left: '0',\n                    top: '0',\n                    cursor: \"pointer\"\n                });\n                BB.css(_this.importButton, {\n                    display: 'none'\n                });\n                importWrapper.appendChild(importFakeButton);\n\n                importFakeButton.onclick = function() {\n                    _this.importButton.click();\n                }\n            }\n\n            createImportButton();\n\n            this.importButton.onchange = function (e) {\n                onFileSelect(_this.importButton.files, 'default');\n                _this.importButton.value = \"\";\n\n            };\n\n\n            // --- export filetype dropdown ---\n            let exportTypeWrapper;\n            let exportTypeSelect;\n            {\n                exportTypeWrapper = BB.el({\n                    css: {\n                        display:'none',\n                        fontSize: '15px',\n                        marginLeft: '10px',\n                        marginTop: '10px',\n                        cssFloat: 'left',\n                        width: 'calc(50% - 15px)',\n                        height: '30px'\n                    }\n                });\n                exportTypeSelect = new KL.Select({\n                    optionArr: [\n                        ['png', LANG('file-save-png')],\n                        ['psd', LANG('file-save-psd')],\n                        ['layers', LANG('file-save-layers')],\n                    ],\n                    initValue: exportType,\n                    onChange: function(val) {\n                        exportType = val;\n                        onExportTypeChange(exportType);\n                        onSaveImageToComputer();\n                    }\n                });\n                BB.css(exportTypeSelect.getElement(), {\n                    width: '120px',\n                    height: '30px'\n                });\n                exportTypeWrapper.appendChild(exportTypeSelect.getElement());\n\n            }\n\n\n\n            newButton.onclick = onNewImage;\n            saveButton.onclick = function () {\n                onSaveImageToComputer();\n            };\n       \n       \n\n            let saveNote = document.createElement(\"div\");\n            saveNote.textContent = \"⚠️ \" + LANG('file-no-autosave');\n            BB.css(saveNote, {\n                textAlign: \"center\",\n                marginTop: \"10px\",\n                background: \"rgb(243, 243, 161)\",\n                padding: \"5px 0px\",\n                color: 'rgba(0,0,0,0.65)',\n                fontSize: '15px',\n            });\n\n            function createSpacer() {\n                let el = document.createElement(\"div\");\n                let clearer = document.createElement(\"div\");\n                let line = document.createElement(\"div\");\n                el.appendChild(clearer);\n                el.appendChild(line);\n                BB.css(clearer, {\n                    clear: 'both'\n                });\n                BB.css(line, {\n                    display:'none',\n                    marginLeft: \"10px\",\n                    marginRight: \"10px\",\n                    marginTop: \"10px\",\n                    borderBottom: \"1px solid rgba(0,0,0,0.2)\",\n                    clear: 'both'\n                });\n                return el;\n            }\n\n            _this.fileBrowserStorage = new BrowserStorageUi(projectStore, getProject, saveReminder, klRootEl);\n            BB.css(_this.fileBrowserStorage.getElement(), {\n                //background: 'red',\n                display:'none',\n                margin: '10px',\n            });\n\n\n            //actual structure\n            BB.append(filemenu, [\n                saveNote,\n                newButton,\n                importWrapper,\n                BB.el({css: {clear: 'both'}}),\n\n                saveButton,\n                exportTypeWrapper,\n                BB.el({css: {clear: 'both'}}),\n\n              \n                BB.el({css: {clear: 'both'}}),\n\n                createSpacer(),\n                _this.fileBrowserStorage.getElement(),\n                createSpacer(),\n             \n            ]);\n\n            this.div.appendChild(filemenu);\n        };\n\n        setTimeout(asyncCreation, 1);\n    }\n\n    refresh() {\n    }\n\n    getElement() {\n        return this.div;\n    }\n\n    setIsVisible(isVisible: boolean) {\n        if (isVisible) {\n            this.refresh();\n        }\n    }\n\n    triggerImport() {\n        this.importButton.click();\n    }\n}\n","import {BB} from '../../../bb/bb';\nimport {KL} from '../../kl';\nimport {klHistory} from '../../history/kl-history';\nimport {IKeyString} from '../../../bb/bb.types';\nimport {StatusOverlay} from '../components/status-overlay';\nimport {KlCanvasWorkspace} from '../../canvas-ui/kl-canvas-workspace';\nimport {KlCanvas} from '../../canvas/kl-canvas';\nimport {LANG} from '../../../language/language';\n\n\nexport class FilterTab {\n\n    private readonly div: HTMLDivElement;\n    private isInit = false;\n\n    constructor (\n        private klRootEl,\n        private klColorSlider,\n        private layerManager,\n        private setCurrentLayer,\n        private klCanvasWorkspace: KlCanvasWorkspace,\n        private handUi,\n        private getCurrentColor,\n        private getKlMaxCanvasSize,\n        private getKlCanvas: () => KlCanvas,\n        private getCurrentLayerCtx,\n        private isEmbed: boolean,\n        private statusOverlay: StatusOverlay,\n    ) {\n        this.div = document.createElement(\"div\");\n    }\n\n    private init() {\n        const _this = this;\n        let hasWebGl = BB.hasWebGl();\n        let filters = KL.filterLib;\n        let buttons = [];\n\n        BB.BbLog.emit({\n            type: 'init-filters',\n        });\n\n        if (!KL.filterLibStatus.isLoaded) {\n            throw new Error('filters not loaded');\n        }\n\n        function createButton(filterKey, filterArr) {\n            let button = document.createElement(\"button\");\n            let buttonLabel = filterArr[filterKey].buttonLabel ? filterArr[filterKey].buttonLabel : filterArr[filterKey].name;\n            let im = '<img height=\"20\" width=\"18\" src=\"' + filterArr[filterKey].icon + '\" alt=\"icon\" />';\n            button.innerHTML = im + buttonLabel;\n            button.className = \"gridButton\";\n            BB.css(button, {\n                lineHeight: '20px',\n                fontSize: '12px',\n            });\n            button.tabIndex = -1;\n            button.onclick = function () {\n\n                function finishedDialog(result, filterDialog) {\n                    if (result == \"Cancel\") {\n                        if (filterDialog.destroy) {\n                            filterDialog.destroy();\n                        }\n                        return;\n                    }\n                    let input;\n                    try {\n                        input = filterDialog.getInput(); // also destroys\n                    } catch (e) {\n                        if (e.message.indexOf('.getInput is not a function') !== -1) {\n                            throw 'filterDialog.getInput is not a function, filter: ' + filterArr[filterKey].name;\n                        } else {\n                            throw e;\n                        }\n                    }\n                    applyFilter(input);\n                }\n\n                if (!('apply' in filterArr[filterKey])) {\n                    alert('Application not fully loaded');\n                    return;\n                }\n\n                function applyFilter(input) {\n                    let filterResult = filterArr[filterKey].apply({\n                        context: _this.getCurrentLayerCtx(),\n                        canvas: _this.getKlCanvas(),\n                        history: klHistory,\n                        input: input\n                    });\n                    if (filterResult === false) {\n                        alert(\"Couldn't apply the edit action\");\n                    }\n                    if (filterArr[filterKey].updateContext === true) {\n                        _this.setCurrentLayer(_this.getKlCanvas().getLayer(_this.layerManager.getSelected()));\n                    }\n                    if (filterArr[filterKey].updatePos === true) {\n                        _this.klCanvasWorkspace.resetView();\n                        _this.handUi.update(_this.klCanvasWorkspace.getScale(), _this.klCanvasWorkspace.getAngleDeg());\n                    }\n                    _this.layerManager.update();\n                }\n\n                if (filterArr[filterKey].isInstant){\n                    button.blur();\n                    applyFilter(null);\n                    _this.statusOverlay.out('\"' + filterArr[filterKey].name + '\" ' + LANG('filter-applied'), true);\n                } else {\n                    let secondaryColorRGB = _this.klColorSlider.getSecondaryRGB();\n                    let filterDialog = filterArr[filterKey].getDialog({\n                        context: _this.getCurrentLayerCtx(),\n                        canvas: _this.getKlCanvas(),\n                        maxWidth: _this.getKlMaxCanvasSize(),\n                        maxHeight: _this.getKlMaxCanvasSize(),\n                        currentColorRgb: {r: _this.getCurrentColor().r, g: _this.getCurrentColor().g, b: _this.getCurrentColor().b},\n                        secondaryColorRgb: {r: secondaryColorRGB.r, g: secondaryColorRGB.g, b: secondaryColorRGB.b}\n                    });\n\n                    if (!filterDialog) {\n                        return;\n                        //alert('Error: could not perform action');\n                        //throw('filter['+filterKey+'].getDialog returned '+filterDialog+'. ctx:' + currentLayerCtx + ' klCanvas:' + klCanvas);\n                    }\n\n                    let closefunc;\n                    filterDialog.errorCallback = function(e) {\n                        setTimeout(function() {\n                            alert('Error: could not perform action');\n                            throw e;\n                        }, 0);\n                        closefunc();\n                    };\n\n\n                    let style: IKeyString = {};\n                    if ('width' in filterDialog) {\n                        style.width = filterDialog.width + 'px'\n                    }\n\n                    KL.popup({\n                        target: _this.klRootEl,\n                        message: \"<b>\" + filterArr[filterKey].name + \"</b>\",\n                        div: filterDialog.element,\n                        style: style,\n                        buttons: [\"Ok\", \"Cancel\"],\n                        clickOnEnter: 'Ok',\n                        callback: function(result) {\n                            finishedDialog(result, filterDialog);\n                        },\n                        closefunc: function (func) {\n                            closefunc = func;\n                        }\n                    });\n                }\n            }\n            buttons[buttons.length] = button;\n            return button;\n        }\n\n        function createDisabledButton(filterKey, filterArr) {\n            if (!filterArr[filterKey].webgl && !filterArr[filterKey].ieFails) {\n                return;\n            }\n            if (filterArr[filterKey].ieFails && navigator.appName !== 'Microsoft Internet Explorer') {\n                return;\n            }\n            let buttonLabel = filterArr[filterKey].buttonLabel ? filterArr[filterKey].buttonLabel : filterArr[filterKey].name;\n            let button = document.createElement(\"button\");\n            let im = '<img style=\"opacity: 0.5\" src=\"img/' + filterArr[filterKey].icon + '\" />';\n            let name = filterArr[filterKey].name;\n            if (name.length > 11) {\n                name = \"<span style='font-size: 12px'>\" + buttonLabel + \"</span>\";\n            }\n            button.innerHTML = im + name;\n            button.className = \"gridButton\";\n            button.disabled = true;\n            return button;\n        }\n\n        function addGroup(groupArr, filterArr, targetEl) {\n            for (let filterKey in filterArr) {\n                if (filterArr.hasOwnProperty[filterKey] || !groupArr.includes(filterKey)) {\n                    continue;\n                }\n                if (_this.isEmbed && !filterArr[filterKey].inEmbed) {\n                    continue;\n                }\n                if ((filterArr[filterKey].webgl && hasWebGl)\n                    || (filterArr[filterKey].neededWithWebGL)\n                    || (!filterArr[filterKey].webgl && !hasWebGl)\n                    && !(filterArr[filterKey].ieFails && navigator.appName == 'Microsoft Internet Explorer')) {\n\n                    targetEl.appendChild(createButton(filterKey, filterArr));\n\n                } else {\n                    targetEl.appendChild(createDisabledButton(filterKey, filterArr));\n                    filterArr[filterKey] = undefined;\n                }\n            }\n        }\n\n        let groupA = [\n            'cropExtend',\n            'flip',\n            'glPerspective',\n            'resize',\n            'rotate',\n            'transform'\n        ];\n        let groupB = [];\n        for (let filterKey in filters) {\n            if (filters.hasOwnProperty[filterKey] || groupA.includes(filterKey)) {\n                continue;\n            }\n            groupB.push(filterKey);\n        }\n\n        addGroup(groupA, filters, _this.div);\n        let hrEl = document.createElement(\"div\");\n        hrEl.className = \"gridHr\";\n        _this.div.appendChild(hrEl);\n        addGroup(groupB, filters, _this.div);\n\n\n        if (!hasWebGl) {\n            let webglnote = BB.appendTextDiv(_this.div, \"Some actions are disabled because WebGL isn't working.\");\n            webglnote.style.margin = \"10px\";\n            BB.css(webglnote, {\n                fontSize: \"11px\",\n                color: \"#555\",\n                background: \"#ffe\",\n                padding: \"10px\",\n                borderRadius: \"10px\",\n                textAlign: \"center\"\n            });\n        }\n\n        this.isInit = true;\n    }\n\n    getElement() {\n        return this.div;\n    }\n\n    show() {\n        if (!this.isInit) {\n            this.init();\n        }\n        this.div.style.display = 'block';\n    }\n\n    hide() {\n        this.div.style.display = 'none';\n    }\n\n}","import {BB} from '../../../bb/bb';\nimport {LANG, languageStrings, LS_LANGUAGE_KEY} from '../../../language/language';\nimport {KL} from '../../kl';\nimport {languages} from '../../../../languages/languages';\nimport {Popup} from '../modals/popup';\n// @ts-ignore\nimport bitbofLogoImg from 'url:~/src/app/img/bitbof-logo.svg';\n// @ts-ignore\nimport klecksLogoImg from 'url:~/src/app/img/klecks-logo.png';\n// @ts-ignore\nimport uiSwapImg from 'url:~/src/app/img/ui/ui-swap-lr.svg';\nimport {LocalStorage} from '../../../bb/base/local-storage';\n\nexport class SettingsTab {\n\n    private el: HTMLElement;\n\n    // --- public ---\n    constructor (\n        onLeftRight: () => void,\n        customAbout?: HTMLElement,\n    ) {\n\n\n\n\n        // ---- language ----\n        const language = languageStrings.getLanguage();\n\n        this.el = BB.el({\n            content: `\n${LANG('settings-language')}: ${language.name} (${language.code})\n            `,\n            css: {\n                margin: '10px',\n            }\n        });\n\n        const preferredLanguageRow = BB.el({\n            content: LANG('settings-preferred-language') + ':<br>',\n            css: {\n                marginTop: '10px',\n            }\n        });\n        const options: [string, string][] = [\n            ['auto', LANG('auto')] as [string, string]\n        ].concat(\n            languages.map(item => {\n                return [item.code, item.name + ` (${item.code})`];\n            })\n        );\n        const languageSelect = new KL.Select({\n            initValue: LocalStorage.getItem(LS_LANGUAGE_KEY) ? LocalStorage.getItem(LS_LANGUAGE_KEY) : 'auto',\n            optionArr: options,\n            onChange: (val) => {\n                if (val === 'auto') {\n                    LocalStorage.removeItem(LS_LANGUAGE_KEY);\n                } else {\n                    LocalStorage.setItem(LS_LANGUAGE_KEY, val);\n                }\n                languageHint.style.display = 'block';\n            },\n        });\n        const languageHint = BB.el({\n            content: LANG('settings-language-reload'),\n            css: {\n                display: 'none',\n                marginTop: '5px',\n            }\n        });\n\n        preferredLanguageRow.append(\n            languageSelect.getElement(),\n            languageHint,\n        );\n\n        this.el.append(preferredLanguageRow);\n\n        // ---- flip ui ----\n        BB.el({\n            tagName: 'button',\n            parent: this.el,\n            content: '<img height=\"20\" width=\"18\" src=\"' + uiSwapImg + '\" alt=\"icon\" style=\"margin-right: 5px\"/>' + LANG('switch-ui-left-right'),\n            onClick: () => onLeftRight(),\n            css: {\n                marginTop: '20px',\n            },\n            custom: {\n                tabIndex: '-1',\n            }\n        });\n\n\n        // ---- about ----\n        this.el.append(BB.el({className: 'gridHr', css: {margin: '10px 0'}}));\n\n        function makeLicenses() {\n            return BB.el({\n                tagName: 'a',\n                content: LANG('licenses'),\n                onClick: () => {\n                    import('./licenses').then(result => {\n                        new Popup({\n                            title: BB.el({\n                                content: LANG('licenses'),\n                            }),\n                            content: BB.el({\n                                content: BB.el({\n                                    content: result.licenses.replace(/\\n/g, '<br>'),\n                                    css: {\n                                        padding: '20px',\n                                    }\n                                }),\n                                css: {\n                                    height: '100%',\n                                    overflowY: 'scroll',\n                                }\n                            }),\n                            width: 800,\n                            isMaxHeight: true,\n                        });\n                    });\n                },\n            });\n        }\n\n        if (customAbout) {\n            this.el.append(customAbout);\n            if (!customAbout.innerHTML) {\n                const minimalAbout = BB.el({\n                    parent: customAbout,\n                    css: {\n                       textAlign: 'center',\n                   }\n                });\n                minimalAbout.append(\n                    BB.el({\n                        content: `<img alt=\"icon\" height=\"20\" style=\"vertical-align:middle\" src=\"${bitbofLogoImg}\"> <a href=\"https://bitbof.com\" target=\"_blank\" tabIndex=\"-1\">bitbof</a> © 2022<br>`,\n                    }),\n                    makeLicenses(),\n                );\n            }\n        } \n\n        window.addEventListener('storage', (e) => {\n            if (e.key !== LS_LANGUAGE_KEY) {\n                return;\n            }\n            languageSelect.setValue(\n                LocalStorage.getItem(LS_LANGUAGE_KEY) ? LocalStorage.getItem(LS_LANGUAGE_KEY) : 'auto'\n            );\n        });\n\n    }\n\n    getElement (): HTMLElement {\n        return this.el;\n    }\n\n}","import {BB} from '../../../bb/bb';\nimport {popup} from '../modals/popup';\nimport {klHistory} from '../../history/kl-history';\nimport {Options} from '../base-components/options';\nimport {Select} from '../base-components/select';\nimport {PointSlider} from '../base-components/point-slider';\n// @ts-ignore\nimport addLayerImg from 'url:~/src/app/img/ui/add-layer.svg';\n// @ts-ignore\nimport duplicateLayerImg from 'url:~/src/app/img/ui/duplicate-layer.svg';\n// @ts-ignore\nimport mergeLayerImg from 'url:~/src/app/img/ui/merge-layers.svg';\n// @ts-ignore\nimport removeLayerImg from 'url:~/src/app/img/ui/remove-layer.svg';\n// @ts-ignore\nimport renameLayerImg from 'url:~/src/app/img/ui/rename-layer.svg';\nimport {KlCanvas, MAX_LAYERS} from '../../canvas/kl-canvas';\nimport {IMixMode} from '../../kl.types';\nimport {LANG} from '../../../language/language';\nimport {translateBlending} from '../../canvas/translate-blending';\n\n\nexport function klLayerManager(p_canvas: KlCanvas, p_func, p_rootDiv) {\n    let klCanvas: KlCanvas = p_canvas;\n    let layerElArr = [];\n    let layerHeight = 35;\n    let layerSpacing = 0;\n    let width = 250;\n    let oldHistoryState;\n    let updatefunc = p_func;\n    let uiState = 'right'; // 'left | 'right'\n\n\n    let largeThumbDiv = BB.el({\n        onClick: BB.handleClick,\n        css: {\n            position: \"absolute\",\n            right: \"280px\",\n            top: \"500px\",\n            background: \"#aaa\",\n            boxShadow: \"1px 1px 3px rgba(0,0,0,0.3)\",\n            pointerEvents: \"none\",\n            padding: '0',\n            border: \"1px solid #aaa\",\n            transition: \"opacity 0.3s ease-out\",\n            userSelect: 'none',\n            colorScheme: 'only light',\n        }\n    });\n    BB.createCheckerDataUrl(4, function(url) {\n        largeThumbDiv.style.backgroundImage = \"url(\" + url + \")\";\n    });\n    let largeThumbCanvas = document.createElement(\"canvas\");\n    largeThumbCanvas.style.display = \"block\";\n    largeThumbCanvas.width = 200;\n    largeThumbCanvas.height = 200;\n    largeThumbDiv.appendChild(largeThumbCanvas);\n    let largeThumbTimeout, largeThumbInTimeout;\n    let largeThumbInDocument = false;\n\n\n    let klCanvasLayerArr = klCanvas.getLayers();\n    let selectedSpotIndex = klCanvasLayerArr.length - 1;\n    let div = document.createElement(\"div\");\n    div.style.marginRight = \"10px\";\n    div.style.marginBottom = \"10px\";\n    div.style.marginLeft = \"10px\";\n    div.style.marginTop = \"10px\";\n    div.style.cursor = \"default\";\n\n    let listdiv = document.createElement(\"div\");\n    BB.css(listdiv, {\n        width: width + \"px\",\n        position: \"relative\"\n\n    });\n\n\n    function renameLayer(layer) {\n        let div = document.createElement('div');\n\n        let label = BB.el({\n            content: LANG('layers-rename-name') + ':',\n            css: {\n                marginRight: '5px'\n            }\n        });\n\n        const row = BB.el({\n            css: {\n                display: 'flex',\n            }\n        });\n        let input = document.createElement('input');\n        input.value = klCanvas.getLayer(layer).name;\n        input.setAttribute('data-ignore-focus', 'true');\n        const clearBtn = BB.el({\n            tagName: 'Button',\n            content: '<img src=\"' + removeLayerImg + '\" height=\"20\"/>',\n            title: LANG('layers-rename-clear'),\n            css: {\n                marginLeft: '10px',\n            },\n            onClick: () => {\n                input.value = '';\n                input.focus();\n            }\n        });\n        const suggestions = [\n            LANG('layers-rename-sketch'),\n            LANG('layers-rename-colors'),\n            LANG('layers-rename-lines'),\n            LANG('background'),\n            LANG('layers-rename-foreground'),\n        ];\n        const suggestionBtns = [];\n        const row2 = BB.el({\n            css: {\n                display: 'flex',\n                flexWrap: 'wrap',\n                marginTop: '5px',\n                marginLeft: '-5px',\n            }\n        }) as HTMLDivElement;\n        suggestions.forEach(item => {\n            const btn = BB.el({\n                parent: row2,\n                tagName: 'Button',\n                content: item,\n                onClick: () => {\n                    input.value = btn.textContent;\n                },\n                css: {\n                    margin: '5px 0 0 5px',\n                }\n            });\n            suggestionBtns.push(btn);\n        });\n\n        div.appendChild(label);\n        label.append(row, row2);\n        row.append(input, clearBtn);\n\n        setTimeout(function() {\n            input.focus();\n            input.select();\n        }, 10);\n\n        popup({\n            target: p_rootDiv,\n            message: `<b>${LANG('layers-rename-title')}</b>`,\n            div: div,\n            buttons: [LANG('layers-rename'), 'Cancel'],\n            primaries: [LANG('layers-rename')],\n            callback: function (val) {\n                BB.destroyEl(clearBtn);\n                suggestionBtns.forEach(item => {\n                    BB.destroyEl(item);\n                });\n                suggestionBtns.splice(0, suggestionBtns.length);\n                if (val === LANG('layers-rename')) {\n                    if (input.value === klCanvas.getLayer(layer).name) {\n                        return;\n                    }\n                    klCanvas.renameLayer(layer, input.value);\n                    createLayerList();\n                    klHistory.pause(true);\n                    updatefunc(layer);\n                    klHistory.pause(false);\n                }\n            },\n            clickOnEnter: LANG('layers-rename')\n        });\n    }\n\n\n    let layerListEl = BB.el({});\n\n    (div as any).disableButtons = function(){}; //probably remove\n    (div as any).enableButtons = function(){}; //probably remove\n    let addnewBtn = document.createElement(\"button\");\n    let duplicateBtn = document.createElement(\"button\");\n    let mergeBtn = document.createElement(\"button\");\n    let removeBtn = document.createElement(\"button\");\n    let renameBtn = document.createElement(\"button\");\n\n    function createButtons() {\n        let div = document.createElement(\"div\");\n        function async() {\n            BB.makeUnfocusable(addnewBtn);\n            BB.makeUnfocusable(duplicateBtn);\n            BB.makeUnfocusable(mergeBtn);\n            BB.makeUnfocusable(removeBtn);\n            BB.makeUnfocusable(renameBtn);\n\n            addnewBtn.style.cssFloat = 'left';\n            duplicateBtn.style.cssFloat = 'left';\n            mergeBtn.style.cssFloat = 'left';\n            removeBtn.style.cssFloat = 'left';\n            renameBtn.style.cssFloat = 'left';\n\n            addnewBtn.title = LANG('layers-new');\n            duplicateBtn.title = LANG('layers-duplicate');\n            removeBtn.title = LANG('layers-remove');\n            mergeBtn.title = LANG('layers-merge');\n            renameBtn.title = LANG('layers-rename-title');\n\n            addnewBtn.style.paddingLeft = \"5px\";\n            addnewBtn.style.paddingRight = \"3px\";\n\n            removeBtn.style.paddingLeft = \"5px\";\n            removeBtn.style.paddingRight = \"3px\";\n\n            duplicateBtn.style.paddingLeft = \"5px\";\n            duplicateBtn.style.paddingRight = \"3px\";\n\n            mergeBtn.style.paddingLeft = \"5px\";\n            mergeBtn.style.paddingRight = \"3px\";\n\n            renameBtn.style.height = \"30px\";\n            renameBtn.style.lineHeight = \"20px\";\n\n            addnewBtn.innerHTML = \"<img src='\" + addLayerImg + \"' height='20'/>\";\n            duplicateBtn.innerHTML = \"<img src='\" + duplicateLayerImg + \"' height='20'/>\";\n            mergeBtn.innerHTML = \"<img src='\" + mergeLayerImg + \"' height='20'/>\";\n            removeBtn.innerHTML = \"<img src='\" + removeLayerImg + \"' height='20'/>\";\n            renameBtn.innerHTML = \"<img src='\" + renameLayerImg + \"' height='20'/>\";\n            addnewBtn.style.marginRight = \"5px\";\n            removeBtn.style.marginRight = \"5px\";\n            duplicateBtn.style.marginRight = \"5px\";\n            mergeBtn.style.marginRight = \"5px\";\n            div.appendChild(addnewBtn);\n            div.appendChild(removeBtn);\n            div.appendChild(duplicateBtn);\n            div.appendChild(mergeBtn);\n            div.appendChild(renameBtn);\n            div.appendChild(BB.el({\n                css: {\n                    clear: 'both'\n                }\n            }));\n\n            let clearboth = document.createElement(\"div\");\n            clearboth.style.clear = \"both\";\n            clearboth.style.height = \"10px\";\n            div.appendChild(clearboth);\n\n\n            addnewBtn.onclick = function () {\n                if (klCanvas.addLayer(selectedSpotIndex) === false) {\n                    return;\n                }\n                klCanvasLayerArr = klCanvas.getLayers();\n\n                if (klCanvasLayerArr.length === MAX_LAYERS) {\n                    addnewBtn.disabled = true;\n                    duplicateBtn.disabled = true;\n                }\n                removeBtn.disabled = false;\n                selectedSpotIndex = selectedSpotIndex + 1;\n                createLayerList();\n                klHistory.pause(true);\n                updatefunc(selectedSpotIndex);\n                klHistory.pause(false);\n            };\n            duplicateBtn.onclick = function () {\n                if (klCanvas.duplicateLayer(selectedSpotIndex) === false) {\n                    return;\n                }\n                klCanvasLayerArr = klCanvas.getLayers();\n                if (klCanvasLayerArr.length === MAX_LAYERS) {\n                    addnewBtn.disabled = true;\n                    duplicateBtn.disabled = true;\n                }\n                removeBtn.disabled = false;\n                selectedSpotIndex++;\n                createLayerList();\n                klHistory.pause(true);\n                updatefunc(selectedSpotIndex);\n                klHistory.pause(false);\n            };\n            removeBtn.onclick = function () {\n                if (layerElArr.length <= 1) {\n                    return;\n                }\n\n                klCanvas.removeLayer(selectedSpotIndex);\n                if (selectedSpotIndex > 0) {\n                    selectedSpotIndex--;\n                }\n                klCanvasLayerArr = klCanvas.getLayers();\n                createLayerList();\n                klHistory.pause(true);\n                updatefunc(selectedSpotIndex);\n                klHistory.pause(false);\n                if (klCanvasLayerArr.length === 1) {\n                    removeBtn.disabled = true;\n                }\n                if (klCanvasLayerArr.length < MAX_LAYERS) {\n                    addnewBtn.disabled = false;\n                    duplicateBtn.disabled = false;\n                }\n            };\n            mergeBtn.onclick = function () {\n                if (selectedSpotIndex <= 0) {\n                    return;\n                }\n\n                function mergeDialog(p) {\n                    let div = document.createElement(\"div\");\n                    div.innerHTML = LANG('layers-merge-description');\n\n                    let options = new Options({\n                        optionArr: [\n                            {id: p.mixModeStr, label: translateBlending(p.mixModeStr)},\n                            {id: 'source-in', label: 'source-in'},\n                            {id: 'source-out', label: 'source-out'},\n                            {id: 'source-atop', label: 'source-atop'},\n                            {id: 'destination-in', label: 'destination-in'},\n                            {id: 'destination-out', label: 'destination-out'},\n                            {id: 'destination-atop', label: 'destination-atop'},\n                            {id: 'xor', label: 'xor'}\n                        ],\n                        initId: p.mixModeStr,\n                        onChange: function(id) {\n                            update();\n                        },\n                        isSmall: true\n                    });\n                    options.getElement().style.marginTop = '5px';\n                    div.appendChild(options.getElement());\n\n                    let preview = document.createElement(\"canvas\");\n                    preview.title = LANG('preview');\n                    let spacer = document.createElement(\"div\");\n                    spacer.innerHTML = \"<br/>\";\n                    spacer.style.clear = \"both\";\n                    div.appendChild(spacer);\n                    div.appendChild(preview);\n                    let thumbDimensions = BB.fitInto(p.topCanvas.width, p.topCanvas.height, 200, 200, 1);\n                    preview.width = thumbDimensions.width;\n                    preview.height = thumbDimensions.height;\n                    BB.css(preview, {\n                        display: \"block\",\n                        marginLeft: \"auto\",\n                        marginRight: \"auto\",\n                        colorScheme: 'only light',\n                    });\n                    preview.style.boxShadow = \"0 0 3px rgba(0,0,0,0.5)\";\n                    BB.createCheckerDataUrl(4, function(url) {\n                        preview.style.backgroundImage = \"url(\" + url + \")\";\n                    });\n\n                    let alphaCanvas = BB.copyCanvas(preview);\n                    alphaCanvas.getContext(\"2d\").drawImage(p.topCanvas, 0, 0, alphaCanvas.width, alphaCanvas.height);\n                    BB.convertToAlphaChannelCanvas(alphaCanvas);\n\n                    function update() {\n                        let ctx = preview.getContext(\"2d\");\n                        ctx.save();\n                        ctx.clearRect(0, 0, preview.width, preview.height);\n                        if (preview.width > p.topCanvas.width) {\n                            ctx.imageSmoothingEnabled = false;\n                        }\n                        ctx.drawImage(p.bottomCanvas, 0, 0, preview.width, preview.height);\n\n                        if (options.getValue() === 'as-alpha') {\n                            ctx.globalCompositeOperation = 'destination-in';\n                            ctx.globalAlpha = p.topOpacity;\n                            ctx.drawImage(alphaCanvas, 0, 0, preview.width, preview.height);\n                        } else {\n                            ctx.globalCompositeOperation = options.getValue();\n                            ctx.globalAlpha = p.topOpacity;\n                            ctx.drawImage(p.topCanvas, 0, 0, preview.width, preview.height);\n                        }\n                        ctx.restore();\n                    }\n\n                    update();\n\n\n                    let keyListener = new BB.KeyListener({\n                        onDown: function(keyStr) {\n                            if (keyStr === 'right') {\n                                options.next();\n                            }\n                            if (keyStr === 'left') {\n                                options.previous();\n                            }\n                        }\n                    });\n\n                    popup({\n                        target: p_rootDiv,\n                        message: `<b>${LANG('layers-merge-modal-title')}</b>`,\n                        div: div,\n                        buttons: [\"Ok\", \"Cancel\"],\n                        clickOnEnter: 'Ok',\n                        callback: function (val) {\n                            keyListener.destroy();\n                            options.destroy();\n                            if (val === \"Ok\") {\n                                p.callback(options.getValue());\n                            }\n                        }\n                    });\n                }\n                mergeDialog({\n                    topCanvas: klCanvasLayerArr[selectedSpotIndex].context.canvas,\n                    bottomCanvas: klCanvasLayerArr[selectedSpotIndex - 1].context.canvas,\n                    topOpacity: klCanvas.getLayer(selectedSpotIndex).opacity,\n                    mixModeStr: klCanvasLayerArr[selectedSpotIndex].mixModeStr,\n                    callback: function (mode) {\n                        klCanvas.mergeLayers(selectedSpotIndex, selectedSpotIndex - 1, mode);\n                        klCanvasLayerArr = klCanvas.getLayers();\n                        selectedSpotIndex--;\n                        if (klCanvasLayerArr.length === 1) {\n                            removeBtn.disabled = true;\n                        }\n                        if (klCanvasLayerArr.length < MAX_LAYERS) {\n                            addnewBtn.disabled = false;\n                            duplicateBtn.disabled = false;\n                        }\n                        createLayerList();\n                        klHistory.pause(true);\n                        updatefunc(selectedSpotIndex);\n                        klHistory.pause(false);\n                    }\n                });\n            };\n\n            renameBtn.onclick = function () {\n                renameLayer(selectedSpotIndex);\n            };\n        }\n        setTimeout(async, 1);\n        return div;\n    }\n    div.appendChild(createButtons());\n\n    let modeWrapper;\n    let modeSelect;\n    {\n        modeWrapper = BB.el({\n            content: LANG('layers-blending') + '&nbsp;',\n            css: {\n                fontSize: '15px'\n            }\n        });\n\n        modeSelect = new Select({\n            optionArr: [\n                'source-over',\n                null,\n                'darken',\n                'multiply',\n                'color-burn',\n                null,\n                'lighten',\n                'screen',\n                'color-dodge',\n                null,\n                'overlay',\n                'soft-light',\n                'hard-light',\n                null,\n                'difference',\n                'exclusion',\n                null,\n                'hue',\n                'saturation',\n                'color',\n                'luminosity',\n            ].map((item: IMixMode) => {\n                return item ? [item, translateBlending(item)] : null;\n            }),\n            onChange: function(val) {\n                klCanvas.setMixMode(selectedSpotIndex, val as IMixMode);\n                (div as any).update(selectedSpotIndex);\n            },\n            css: {\n                marginBottom: '10px'\n            }\n        });\n\n        modeWrapper.appendChild(modeSelect.getElement());\n        div.appendChild(modeWrapper);\n\n    }\n\n\n    function createLayerList() {\n        oldHistoryState = klHistory.getState();\n        function createLayerEntry(index) {\n            let layerName = klCanvas.getLayer(index).name;\n            let opacity = klCanvasLayerArr[index].opacity;\n            let layercanvas = klCanvasLayerArr[index].context.canvas;\n\n            let layer = document.createElement(\"div\");\n            layer.className = \"layerBox\";\n            layerElArr[index] = layer;\n            (layer as any).posY = ((klCanvasLayerArr.length - 1) * 35 - index * 35);\n            BB.css(layer, {\n                width: \"250px\",\n                height: \"34px\",\n                backgroundColor: \"rgb( 220, 220, 220)\",\n                border: \"1px solid #aaa\",\n                position: \"absolute\",\n                left: \"0 px\",\n                top: (layer as any).posY + \"px\",\n                transition: \"all 0.1s linear\",\n                borderRadius: \"5px\",\n                boxSizing: 'border-box'\n            });\n            let innerLayer = document.createElement(\"div\");\n            BB.css(innerLayer, {\n                position: \"relative\"\n            });\n\n            let container1 = document.createElement(\"div\");\n            BB.css(container1, {\n                width: \"250px\",\n                height: \"34px\"\n            });\n            let container2 = document.createElement(\"div\");\n            layer.appendChild(innerLayer);\n            innerLayer.appendChild(container1);\n            innerLayer.appendChild(container2);\n\n            (layer as any).spot = index;\n\n            //thumb\n            {\n                let thumbDimensions = BB.fitInto(layercanvas.width, layercanvas.height, 30, 30, 1);\n                let thumb = (layer as any).thumb = BB.canvas(thumbDimensions.width, thumbDimensions.height);\n\n                let thc = thumb.getContext(\"2d\");\n                thc.save();\n                if (thumb.width > layercanvas.width) {\n                    thc.imageSmoothingEnabled = false;\n                }\n                thc.drawImage(layercanvas, 0, 0, thumb.width, thumb.height);\n                thc.restore();\n                BB.css((layer as any).thumb, {\n                    position: \"absolute\",\n                    left: ((32 - (layer as any).thumb.width) / 2) + \"px\",\n                    top: ((32 - (layer as any).thumb.height) / 2) + \"px\",\n                    colorScheme: 'only light',\n                });\n                BB.createCheckerDataUrl(4, function(url) {\n                    thumb.style.backgroundImage = \"url(\" + url + \")\";\n                });\n            }\n\n            //layerlabel\n            {\n                (layer as any).label = document.createElement(\"div\");\n                (layer as any).lname = layerName;\n                (layer as any).label.append((layer as any).lname);\n\n                BB.css((layer as any).label, {\n                    position: \"absolute\",\n                    left: (1 + 32 + 5) + \"px\",\n                    top: 1 + \"px\",\n                    fontSize: \"13px\",\n                    width: \"170px\",\n                    height: \"20px\",\n                    overflow: \"hidden\",\n                    color: \"#666\",\n                    whiteSpace: 'nowrap'\n                });\n\n                (layer as any).label.ondblclick = function() {\n                    renameLayer((layer as any).spot);\n                };\n            }\n            //layerlabel\n            {\n                (layer as any).opacityLabel = document.createElement(\"div\");\n                (layer as any).opacity = opacity;\n                (layer as any).opacityLabel.append(parseInt('' + ((layer as any).opacity * 100)) + \"%\");\n\n                BB.css((layer as any).opacityLabel, {\n                    position: \"absolute\",\n                    left: (250 - 1 - 5 - 50) + \"px\",\n                    top: 1 + \"px\",\n                    fontSize: \"13px\",\n                    textAlign: \"right\",\n                    width: \"50px\",\n                    color: \"#666\",\n                    transition: \"color 0.2s ease-in-out\"\n                });\n            }\n\n            let oldOpacity;\n            let opacitySlider = new PointSlider({\n                init: (layer as any).opacity,\n                width: 204,\n                pointSize: 14,\n                callback: function(sliderValue, isFirst, isLast) {\n                    if (isFirst) {\n                        oldOpacity = klCanvas.getLayer((layer as any).spot).opacity;\n                        klHistory.pause(true);\n                        return;\n                    }\n                    if (isLast) {\n                        klHistory.pause(false);\n                        if (oldOpacity !== sliderValue) {\n                            klCanvas.layerOpacity((layer as any).spot, sliderValue);\n                        }\n                        return;\n                    }\n                    (layer as any).opacityLabel.innerHTML = Math.round(sliderValue * 100) + \"%\";\n                    klCanvas.layerOpacity((layer as any).spot, sliderValue);\n                }\n            });\n            BB.css(opacitySlider.getEl(), {\n                position: 'absolute',\n                left: '39px',\n                top: '17px'\n            });\n            (layer as any).opacitySlider = opacitySlider;\n\n            //larger layer preview - hover\n            BB.setEventListener((layer as any).thumb, 'onpointerover', function (e) {\n                if (e.buttons !== 0 && (!e.pointerType || e.pointerType !== 'touch')) { //shouldn't show while dragging\n                    return;\n                }\n\n                let thumbDimensions = BB.fitInto(layercanvas.width, layercanvas.height, 250, 250, 1);\n\n                if (largeThumbCanvas.width !== thumbDimensions.width || largeThumbCanvas.height !== thumbDimensions.height) {\n                    largeThumbCanvas.width = thumbDimensions.width;\n                    largeThumbCanvas.height = thumbDimensions.height;\n                }\n                let ctx = largeThumbCanvas.getContext(\"2d\");\n                ctx.save();\n                if (largeThumbCanvas.width > layercanvas.width) {\n                    ctx.imageSmoothingEnabled = false;\n                }\n                ctx.imageSmoothingQuality = 'high';\n                ctx.clearRect(0, 0, largeThumbCanvas.width, largeThumbCanvas.height);\n                ctx.drawImage(layercanvas, 0, 0, largeThumbCanvas.width, largeThumbCanvas.height);\n                ctx.restore();\n                BB.css(largeThumbDiv, {\n                    top: (e.clientY - largeThumbCanvas.height / 2) + \"px\",\n                    opacity: '0'\n                });\n                if (largeThumbInDocument === false) {\n                    document.body.appendChild(largeThumbDiv);\n                    largeThumbInDocument = true;\n                }\n                clearTimeout(largeThumbInTimeout);\n                largeThumbInTimeout = setTimeout(function () {\n                    BB.css(largeThumbDiv, {\n                        opacity: '1'\n                    });\n                }, 20);\n                clearTimeout(largeThumbTimeout);\n            });\n            BB.setEventListener((layer as any).thumb, 'onpointerout', function () {\n                clearTimeout(largeThumbInTimeout);\n                BB.css(largeThumbDiv, {\n                    opacity: '0'\n                });\n                clearTimeout(largeThumbTimeout);\n                largeThumbTimeout = setTimeout(function () {\n                    if (!largeThumbInDocument) {\n                        return;\n                    }\n                    document.body.removeChild(largeThumbDiv);\n                    largeThumbInDocument = false;\n                }, 300);\n            });\n\n            container1.appendChild((layer as any).thumb);\n            container1.appendChild((layer as any).label);\n            container1.appendChild((layer as any).opacityLabel);\n            container1.appendChild(opacitySlider.getEl());\n            let dragstart = false;\n            let freshSelection = false;\n\n            //events for moving layers up and down\n            function dragEventHandler(event) {\n                if (event.type === 'pointerdown' && event.button === 'left') {\n                    BB.css(layer, {\n                        transition: \"box-shadow 0.3s ease-in-out\"\n                    });\n                    //dragContainer.appendChild(layer);\n                    layer.style.zIndex = '1';\n                    lastpos = (layer as any).spot;\n                    freshSelection = false;\n                    if (!(layer as any).isSelected) {\n                        freshSelection = true;\n                        (div as any).activateLayer((layer as any).spot);\n                    }\n                    dragstart = true;\n\n                } else if (event.type === 'pointermove' && event.button === 'left') {\n\n                    if (dragstart) {\n                        dragstart = false;\n                        BB.css(layer, {\n                            boxShadow: \"1px 3px 5px rgba(0,0,0,0.4)\"\n                        });\n                    }\n                    (layer as any).posY += event.dY;\n                    let corrected = Math.max(0, Math.min((klCanvasLayerArr.length - 1) * (35), (layer as any).posY));\n                    layer.style.top = corrected + \"px\";\n                    updateLayersVerticalPosition((layer as any).spot, posToSpot((layer as any).posY));\n\n                }\n                if (event.type === 'pointerup') {\n                    BB.css(layer, {\n                        transition: \"all 0.1s linear\"\n                    });\n                    setTimeout(function () {\n                        BB.css(layer, {\n                            boxShadow: \"\"\n                        });\n                    }, 20);\n                    (layer as any).posY = Math.max(0, Math.min((klCanvasLayerArr.length - 1) * (35), (layer as any).posY));\n                    //regularContainer.appendChild(layer);\n                    layer.style.zIndex = \"\";\n                    let newSpot = posToSpot((layer as any).posY);\n                    let oldSpot = (layer as any).spot;\n                    move((layer as any).spot, newSpot);\n                    if (oldSpot != newSpot) {\n                        klHistory.pause(true);\n                        updatefunc(selectedSpotIndex);\n                        klHistory.pause(false);\n                    }\n                    if (oldSpot === newSpot && freshSelection) {\n                        updatefunc(selectedSpotIndex);\n                    }\n                    freshSelection = false;\n                }\n            }\n\n            (layer as any).pointerListener = new BB.PointerListener({\n                target: container1,\n                maxPointers: 1,\n                onPointer: dragEventHandler\n            });\n\n            layerListEl.appendChild(layer);\n        }\n        layerElArr = [];\n        while (layerListEl.firstChild) {\n            let child = layerListEl.firstChild;\n            (child as any).pointerListener.destroy();\n            (child as any).opacitySlider.destroy();\n            layerListEl.removeChild(child);\n        }\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\n            createLayerEntry(i);\n        }\n        (div as any).activateLayer(selectedSpotIndex);\n        updateHeight();\n    }\n\n\n    listdiv.appendChild(layerListEl);\n    div.appendChild(listdiv);\n\n\n    function posToSpot(p) {\n        let result = parseInt('' + ((p) / (layerHeight + layerSpacing) + 0.5));\n        result = Math.min(klCanvasLayerArr.length - 1, Math.max(0, result));\n        result = klCanvasLayerArr.length - result - 1;\n        return result;\n    }\n\n    let lastpos = 0;\n\n    //update css position of all layers that are not being dragged, while dragging\n    function updateLayersVerticalPosition(id, newspot) {\n        newspot = Math.min(klCanvasLayerArr.length - 1, Math.max(0, newspot));\n        if (newspot === lastpos) {\n            return;\n        }\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\n            if (layerElArr[i].spot === id) { // <- here\n                continue;\n            }\n            let posy = layerElArr[i].spot;\n            if (layerElArr[i].spot > id) {\n                posy--;\n            }\n            if (posy >= newspot) {\n                posy++;\n            }\n            layerElArr[i].posY = (layerHeight + layerSpacing) * (klCanvasLayerArr.length - posy - 1);\n            layerElArr[i].style.top = layerElArr[i].posY + \"px\";\n        }\n        lastpos = newspot;\n    }\n\n    function move(oldSpotIndex, newSpotIndex) {\n        if (isNaN(oldSpotIndex) || isNaN(newSpotIndex)) {\n            throw 'layermanager - invalid move';\n        }\n        for (let i = 0; i < klCanvasLayerArr.length; i++) {\n            (function (i) {\n                let posy = layerElArr[i].spot; // <- here\n                if (layerElArr[i].spot === oldSpotIndex) {\n                    posy = newSpotIndex;\n                } else {\n                    if (layerElArr[i].spot > oldSpotIndex)\n                        posy--;\n                    if (posy >= newSpotIndex)\n                        posy++;\n                }\n                layerElArr[i].spot = posy;\n                layerElArr[i].posY = (layerHeight + layerSpacing) * (klCanvasLayerArr.length - posy - 1);\n                layerElArr[i].style.top = layerElArr[i].posY + \"px\";\n            }(i));\n        }\n        if (oldSpotIndex === newSpotIndex) {\n            return;\n        }\n        klCanvas.moveLayer(selectedSpotIndex, newSpotIndex - oldSpotIndex);\n        klCanvasLayerArr = klCanvas.getLayers();\n        selectedSpotIndex = newSpotIndex;\n        mergeBtn.disabled = selectedSpotIndex === 0;\n    }\n\n\n    //updating the thumbs in interval\n    //don't update when: manager not visible || layer didn't change || is drawing\n    let updateThumbsInterval = setInterval(function() {\n        if (div.style.display !== \"block\") {\n            return;\n        }\n\n        let historyState = klHistory.getState();\n        if (historyState === oldHistoryState) {\n            return;\n        }\n        oldHistoryState = historyState;\n\n        for (let i = 0; i < layerElArr.length; i++) {\n            if (selectedSpotIndex === layerElArr[i].spot && klCanvasLayerArr[layerElArr[i].spot]) { // second check, because might be out of date\n                let ctx = layerElArr[i].thumb.getContext(\"2d\");\n                ctx.save();\n                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n                if (klCanvasLayerArr[layerElArr[i].spot].context.canvas.width < layerElArr[i].thumb.width) {\n                    ctx.imageSmoothingEnabled = false;\n                }\n                ctx.drawImage(klCanvasLayerArr[layerElArr[i].spot].context.canvas, 0, 0, layerElArr[i].thumb.width, layerElArr[i].thumb.height);\n                ctx.restore();\n            }\n        }\n\n    }, 1);\n\n    function updateHeight() {\n        layerListEl.style.height = (layerElArr.length * 35) + 'px';\n    }\n\n    // ---- interface ----\n\n    (div as any).update = function (activeLayerSpotIndex) {\n        klCanvasLayerArr = klCanvas.getLayers();\n        if (activeLayerSpotIndex || activeLayerSpotIndex === 0) {\n            selectedSpotIndex = activeLayerSpotIndex;\n        }\n        removeBtn.disabled = klCanvasLayerArr.length === 1;\n        if (klCanvasLayerArr.length === MAX_LAYERS) {\n            addnewBtn.disabled = true;\n            duplicateBtn.disabled = true;\n        } else {\n            addnewBtn.disabled = false;\n            duplicateBtn.disabled = false;\n        }\n        setTimeout(function() {\n            createLayerList();\n        }, 1);\n    };\n    (div as any).getSelected = function () {\n        return selectedSpotIndex;\n    };\n    (div as any).activateLayer = function (spotIndex) {\n        if (spotIndex < 0 || spotIndex > layerElArr.length - 1) {\n            throw 'invalid spotIndex ' + spotIndex + ', layerElArr.length ' + layerElArr.length;\n        }\n        selectedSpotIndex = spotIndex;\n        modeSelect.setValue(klCanvasLayerArr[selectedSpotIndex].mixModeStr);\n        for (let i = 0; i < layerElArr.length; i++) {\n            if (selectedSpotIndex === layerElArr[i].spot) {\n                layerElArr[i].style.backgroundColor = \"rgb( 250, 250, 250)\";\n                layerElArr[i].label.style.color = \"#000\";\n                layerElArr[i].style.boxShadow = \"\";\n                layerElArr[i].style.border = \"1px solid var(--active-highlight-color)\";\n                layerElArr[i].opacitySlider.setActive(true);\n                layerElArr[i].isSelected = true;\n            } else {\n                layerElArr[i].style.backgroundColor = \"rgb( 220, 220, 220)\";\n                layerElArr[i].label.style.color = \"#666\";\n                layerElArr[i].style.boxShadow = \"\";\n                layerElArr[i].style.border = \"1px solid rgb(158, 158, 158)\";\n                layerElArr[i].opacitySlider.setActive(false);\n                layerElArr[i].isSelected = false;\n            }\n        }\n        mergeBtn.disabled = selectedSpotIndex === 0;\n    };\n    (div as any).setUiState = function(stateStr) {\n        uiState = '' + stateStr;\n\n        if (uiState === 'left') {\n            BB.css(largeThumbDiv, {\n                left: '280px',\n                right: ''\n            });\n        } else {\n            BB.css(largeThumbDiv, {\n                left: '',\n                right: '280px'\n            });\n        }\n    };\n\n    createLayerList();\n\n    return div;\n}\n","/**\n * Topmost row of buttons in toolspace\n *\n * p = { // button click callbacks\n *     onSubmit: function(),\n *     onLeftRight: function(),\n *     onHelp: function()\n * }\n *\n * @param p\n * @constructor\n */\nimport {BB} from \"../bb/bb\";\n// @ts-ignore\nimport uiSwapImg from 'url:~/src/app/img/ui/ui-swap-lr.svg';\n// @ts-ignore\nimport helpImg from 'url:~/src/app/img/ui/help.svg';\nimport {LANG} from '../language/language';\n\nexport class ToolspaceTopRow {\n    el: HTMLDivElement;\n\n    constructor(p: {onSubmit: () => void, onLeftRight: () => void, onHelp: () => void}) {\n        let div = document.createElement('div');\n        this.el = div;\n        BB.css(div, {\n            height: '36px',\n            //background: '#f00',\n            display: 'flex',\n            backgroundImage: 'linear-gradient(to top, rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.6) 100%)'\n        });\n\n        function createButton(p) {\n            let padding = 6 + (p.extraPadding ? p.extraPadding : 0);\n            let result = BB.el({\n                className: 'toolspace-row-button nohighlight',\n                title: p.title,\n                onClick: p.onClick,\n                css: {\n                    padding: p.content ? '' : (p.contain ? padding + 'px 0' : ''),\n                }\n            });\n            if (p.content) {\n                result.appendChild(p.content);\n            } else {\n                let im = BB.el({\n                    css: {\n                        backgroundImage: 'url(\\'' + p.image + '\\')',\n                        backgroundRepeat: 'no-repeat',\n                        backgroundPosition: 'center',\n                        backgroundSize: p.contain ? 'contain' : '',\n                        //filter: 'grayscale(1)',\n                        height: '100%'\n                    }\n                });\n                im.style.pointerEvents = 'none';\n                result.appendChild(im);\n            }\n            (result as any).pointerListener = new BB.PointerListener({ // because :hover causes problems w touch\n                target: result,\n                onEnterLeave: function(isOver) {\n                    if (isOver) {\n                        BB.addClassName(result, 'toolspace-row-button-hover');\n                    } else {\n                        BB.removeClassName(result, 'toolspace-row-button-hover');\n                    }\n                }\n            });\n            return result;\n        }\n\n        let submitButton = createButton({\n            onClick: p.onSubmit,\n            title: LANG('submit-title'),\n            content: BB.el({\n                content: LANG('submit'),\n                className: 'toolspace-row-button__submit',\n                css: {\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    width: '100%',\n                    height: '100%'\n                }\n            }),\n            contain: true\n        });\n        submitButton.style.width = '45px';\n\n        let helpButton = createButton({\n            onClick: p.onHelp,\n            title: LANG('help'),\n            image: helpImg,\n            contain: true\n        });\n\n        let leftRightButton = createButton({\n            onClick: p.onLeftRight,\n            title: LANG('switch-ui-left-right'),\n            image: uiSwapImg,\n            contain: true\n        });\n\n        div.appendChild(submitButton);\n        div.appendChild(leftRightButton);\n        div.appendChild(helpButton);\n    }\n\n    getElement() {\n        return this.el;\n    }\n}\n","\nexport const eventResMs = 60;","/*\n * glfx.script\n * http://evanw.github.com/glfx.js/\n *\n * Copyright 2011 Evan Wallace\n * Released under the MIT license\n *\n * modifications by bitbof\n */\nexport const fx = (function() {\nlet exports: any = {};\n\n// src/OES_texture_float_linear-polyfill.script\n// From: https://github.com/evanw/OES_texture_float_linear-polyfill\n(function() {\n  // Uploads a 2x2 floating-point texture where one pixel is 2 and the other\n  // three pixels are 0. Linear filtering is only supported if a sample taken\n  // from the center of that texture is (2 + 0 + 0 + 0) / 4 = 0.5.\n  function supportsOESTextureFloatLinear(gl) {\n    // Need floating point textures in the first place\n    if (!gl.getExtension('OES_texture_float')) {\n      return false;\n    }\n\n    // Create a render target\n    let framebuffer = gl.createFramebuffer();\n    let byteTexture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, byteTexture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, byteTexture, 0);\n\n    // Create a simple floating-point texture with value of 0.5 in the center\n    let rgba = [\n      2, 0, 0, 0,\n      0, 0, 0, 0,\n      0, 0, 0, 0,\n      0, 0, 0, 0\n    ];\n    let floatTexture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, floatTexture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 2, 2, 0, gl.RGBA, gl.FLOAT, new Float32Array(rgba));\n\n    // Create the test shader\n    let program = gl.createProgram();\n    let vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    let fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(vertexShader, '\\\n      attribute vec2 vertex;\\\n      void main() {\\\n        gl_Position = vec4(vertex, 0.0, 1.0);\\\n      }\\\n    ');\n    gl.shaderSource(fragmentShader, '\\\n      uniform sampler2D texture;\\\n      void main() {\\\n        gl_FragColor = texture2D(texture, vec2(0.5));\\\n      }\\\n    ');\n    gl.compileShader(vertexShader);\n    gl.compileShader(fragmentShader);\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n\n    // Create a buffer containing a single point\n    let buffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0]), gl.STREAM_DRAW);\n    gl.enableVertexAttribArray(0);\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);\n\n    // Render the point and read back the rendered pixel\n    let pixel = new Uint8Array(4);\n    gl.useProgram(program);\n    gl.viewport(0, 0, 1, 1);\n    gl.bindTexture(gl.TEXTURE_2D, floatTexture);\n    gl.drawArrays(gl.POINTS, 0, 1);\n    gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixel);\n\n    // The center sample will only have a value of 0.5 if linear filtering works\n    return pixel[0] === 127 || pixel[0] === 128;\n  }\n\n  // The constructor for the returned extension object\n  function OESTextureFloatLinear() {\n  }\n\n  // Cache the extension so it's specific to each context like extensions should be\n  function getOESTextureFloatLinear(gl) {\n    if (gl.$OES_texture_float_linear$ === void 0) {\n      Object.defineProperty(gl, '$OES_texture_float_linear$', {\n        enumerable: false,\n        configurable: false,\n        writable: false,\n        value: new OESTextureFloatLinear()\n      });\n    }\n    return gl.$OES_texture_float_linear$;\n  }\n\n  // This replaces the real getExtension()\n  function getExtension(name) {\n    return name === 'OES_texture_float_linear'\n      ? getOESTextureFloatLinear(this)\n      : oldGetExtension.call(this, name);\n  }\n\n  // This replaces the real getSupportedExtensions()\n  function getSupportedExtensions() {\n    let extensions = oldGetSupportedExtensions.call(this);\n    if (extensions.indexOf('OES_texture_float_linear') === -1) {\n      extensions.push('OES_texture_float_linear');\n    }\n    return extensions;\n  }\n\n  // Get a WebGL context\n  try {\n    let gl = document.createElement('canvas').getContext('experimental-webgl');\n  } catch (e) {\n  }\n\n  // Don't install the polyfill if the browser already supports it or doesn't have WebGL\n  if (!gl || (gl as any).getSupportedExtensions().indexOf('OES_texture_float_linear') !== -1) {\n    return;\n  }\n\n  // Install the polyfill if linear filtering works with floating-point textures\n  let oldGetExtension;\n  let oldGetSupportedExtensions;\n  if (supportsOESTextureFloatLinear(gl)) {\n    oldGetExtension = WebGLRenderingContext.prototype.getExtension;\n    oldGetSupportedExtensions = WebGLRenderingContext.prototype.getSupportedExtensions;\n    WebGLRenderingContext.prototype.getExtension = getExtension;\n    WebGLRenderingContext.prototype.getSupportedExtensions = getSupportedExtensions;\n  }\n}());\n\n// src/core\\canvas.script\nvar gl;\n\nfunction clamp(lo, value, hi) {\n    return Math.max(lo, Math.min(value, hi));\n}\n\nfunction wrapTexture(texture) {\n    return {\n        _: texture,\n        loadContentsOf: function(element) {\n            // Make sure that we're using the correct global WebGL context\n            gl = this._.gl;\n            this._.loadContentsOf(element);\n        },\n        destroy: function() {\n            // Make sure that we're using the correct global WebGL context\n            gl = this._.gl;\n            this._.destroy();\n        }\n    };\n}\n\nfunction texture(element) {\n    return wrapTexture(Texture.fromElement(element));\n}\n\nfunction initialize(width, height) {\n    let type = gl.UNSIGNED_BYTE;\n\n    // Go for floating point buffer textures if we can, it'll make the bokeh\n    // filter look a lot better. Note that on Windows, ANGLE does not let you\n    // render to a floating-point texture when linear filtering is enabled.\n    // See http://crbug.com/172278 for more information.\n    if (gl.getExtension('OES_texture_float') && gl.getExtension('OES_texture_float_linear')) {\n        let testTexture = new Texture(100, 100, gl.RGBA, gl.FLOAT);\n        try {\n            // Only use gl.FLOAT if we can render to it\n            testTexture.drawTo(function() { type = gl.FLOAT; });\n        } catch (e) {\n        }\n        testTexture.destroy();\n    }\n\n    if (this._.texture) this._.texture.destroy();\n    if (this._.spareTexture) this._.spareTexture.destroy();\n    this.width = width;\n    this.height = height;\n    this._.texture = new Texture(width, height, gl.RGBA, type);\n    this._.spareTexture = new Texture(width, height, gl.RGBA, type);\n    this._.extraTexture = this._.extraTexture || new Texture(0, 0, gl.RGBA, type);\n    this._.flippedShader = this._.flippedShader || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));\\\n        }\\\n    ', 'flippedShader');\n    this._.isInitialized = true;\n}\n\n/*\n   Draw a texture to the canvas, with an optional width and height to scale to.\n   If no width and height are given then the original texture width and height\n   are used.\n*/\nfunction draw(texture, width, height) {\n    if (!this._.isInitialized || texture._.width != this.width || texture._.height != this.height) {\n        initialize.call(this, width ? width : texture._.width, height ? height : texture._.height);\n    }\n\n    texture._.use();\n    this._.texture.drawTo(function() {\n        Shader.getDefaultShader().drawRect();\n    });\n\n    return this;\n}\n\nfunction update() {\n    this._.texture.use();\n    this._.flippedShader.drawRect();\n    return this;\n}\n\nfunction simpleShader(shader, uniforms, textureIn, textureOut) {\n    (textureIn || this._.texture).use();\n    this._.spareTexture.drawTo(function() {\n        shader.uniforms(uniforms).drawRect();\n    });\n    this._.spareTexture.swapWith(textureOut || this._.texture);\n}\n\nfunction replace(node) {\n    node.parentNode.insertBefore(this, node);\n    node.parentNode.removeChild(node);\n    return this;\n}\n\nfunction contents() {\n    let texture = new Texture(this._.texture.width, this._.texture.height, gl.RGBA, gl.UNSIGNED_BYTE);\n    this._.texture.use();\n    texture.drawTo(function() {\n        Shader.getDefaultShader().drawRect();\n    });\n    return wrapTexture(texture);\n}\n\n/*\n   Get a Uint8 array of pixel values: [r, g, b, a, r, g, b, a, ...]\n   Length of the array will be width * height * 4.\n*/\nfunction getPixelArray() {\n    let w = this._.texture.width;\n    let h = this._.texture.height;\n    let array = new Uint8Array(w * h * 4);\n    this._.texture.drawTo(function() {\n        gl.readPixels(0, 0, w, h, gl.RGBA, gl.UNSIGNED_BYTE, array);\n    });\n    return array;\n}\n\nfunction wrap(func) {\n    return function() {\n        // Make sure that we're using the correct global WebGL context\n        gl = this._.gl;\n\n        // Now that the context has been switched, we can call the wrapped function\n        return func.apply(this, arguments);\n    };\n}\n\nexports.canvas = function() {\n    let canvas: any = document.createElement('canvas');\n    try {\n        gl = canvas.getContext('experimental-webgl', { premultipliedAlpha: false });\n    } catch (e) {\n        gl = null;\n    }\n    if (!gl) {\n        throw 'This browser does not support WebGL';\n    }\n    canvas._ = {\n        gl: gl,\n        isInitialized: false,\n        texture: null,\n        spareTexture: null,\n        flippedShader: null\n    };\n\n    // Core methods\n    canvas.texture = wrap(texture);\n    canvas.draw = wrap(draw);\n    canvas.update = wrap(update);\n    canvas.replace = wrap(replace);\n    canvas.contents = wrap(contents);\n    canvas.getPixelArray = wrap(getPixelArray);\n\n    // Filter methods\n    canvas.brightnessContrast = wrap(brightnessContrast);\n    canvas.hexagonalPixelate = wrap(hexagonalPixelate);\n    canvas.hueSaturation = wrap(hueSaturation);\n    canvas.colorHalftone = wrap(colorHalftone);\n    canvas.triangleBlur = wrap(triangleBlur);\n    canvas.unsharpMask = wrap(unsharpMask);\n    canvas.perspective = wrap(perspective);\n    canvas.matrixWarp = wrap(matrixWarp);\n    canvas.bulgePinch = wrap(bulgePinch);\n    canvas.tiltShift = wrap(tiltShift);\n    canvas.dotScreen = wrap(dotScreen);\n    canvas.edgeWork = wrap(edgeWork);\n    canvas.lensBlur = wrap(lensBlur);\n    canvas.zoomBlur = wrap(zoomBlur);\n    canvas.noise = wrap(noise);\n    canvas.denoise = wrap(denoise);\n    canvas.curves = wrap(curves);\n    canvas.swirl = wrap(swirl);\n    canvas.ink = wrap(ink);\n    canvas.vignette = wrap(vignette);\n    canvas.vibrance = wrap(vibrance);\n    canvas.sepia = wrap(sepia);\n    canvas.invert = wrap(invert);\n    canvas.toAlpha = wrap(toAlpha);\n\n    return canvas;\n};\nexports.splineInterpolate = splineInterpolate;\n\n// src/core\\matrix.script\n// from javax.media.jai.PerspectiveTransform\n\nfunction getSquareToQuad(x0, y0, x1, y1, x2, y2, x3, y3) {\n    let dx1 = x1 - x2;\n    let dy1 = y1 - y2;\n    let dx2 = x3 - x2;\n    let dy2 = y3 - y2;\n    let dx3 = x0 - x1 + x2 - x3;\n    let dy3 = y0 - y1 + y2 - y3;\n    let det = dx1*dy2 - dx2*dy1;\n    let a = (dx3*dy2 - dx2*dy3) / det;\n    let b = (dx1*dy3 - dx3*dy1) / det;\n    return [\n        x1 - x0 + a*x1, y1 - y0 + a*y1, a,\n        x3 - x0 + b*x3, y3 - y0 + b*y3, b,\n        x0, y0, 1\n    ];\n}\n\nfunction getInverse(m) {\n    let a = m[0], b = m[1], c = m[2];\n    let d = m[3], e = m[4], f = m[5];\n    let g = m[6], h = m[7], i = m[8];\n    let det = a*e*i - a*f*h - b*d*i + b*f*g + c*d*h - c*e*g;\n    return [\n        (e*i - f*h) / det, (c*h - b*i) / det, (b*f - c*e) / det,\n        (f*g - d*i) / det, (a*i - c*g) / det, (c*d - a*f) / det,\n        (d*h - e*g) / det, (b*g - a*h) / det, (a*e - b*d) / det\n    ];\n}\n\nfunction multiply(a, b) {\n    return [\n        a[0]*b[0] + a[1]*b[3] + a[2]*b[6],\n        a[0]*b[1] + a[1]*b[4] + a[2]*b[7],\n        a[0]*b[2] + a[1]*b[5] + a[2]*b[8],\n        a[3]*b[0] + a[4]*b[3] + a[5]*b[6],\n        a[3]*b[1] + a[4]*b[4] + a[5]*b[7],\n        a[3]*b[2] + a[4]*b[5] + a[5]*b[8],\n        a[6]*b[0] + a[7]*b[3] + a[8]*b[6],\n        a[6]*b[1] + a[7]*b[4] + a[8]*b[7],\n        a[6]*b[2] + a[7]*b[5] + a[8]*b[8]\n    ];\n}\n\n// src/core\\shader.script\nvar Shader = (function() {\n    function isArray(obj) {\n        return Object.prototype.toString.call(obj) == '[object Array]';\n    }\n\n    function isNumber(obj) {\n        return Object.prototype.toString.call(obj) == '[object Number]';\n    }\n\n    function compileSource(type, source, nameStr) {\n        let shader = gl.createShader(type);\n        gl.shaderSource(shader, source);\n        gl.compileShader(shader);\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n            throw 'compile error: ' + nameStr + ' - ' + gl.getShaderInfoLog(shader);\n        }\n        return shader;\n    }\n\n    let defaultVertexSource = '\\\n    attribute vec2 vertex;\\\n    attribute vec2 _texCoord;\\\n    varying vec2 texCoord;\\\n    void main() {\\\n        texCoord = _texCoord;\\\n        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);\\\n    }';\n\n    let defaultFragmentSource = '\\\n    uniform sampler2D texture;\\\n    varying vec2 texCoord;\\\n    void main() {\\\n        gl_FragColor = texture2D(texture, texCoord);\\\n    }';\n\n    // added test 2020-04-27 bitbof\n    let floatPrecision = null;\n    function testPrecisionSupport(precisionType) {\n        let format = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, precisionType);\n        return format !== null && format.precision !== 0;\n    }\n\n    function Shader(vertexSource?, fragmentSource?, nameStr?) {\n        this.vertexAttribute = null;\n        this.texCoordAttribute = null;\n        this.program = gl.createProgram();\n        vertexSource = vertexSource || defaultVertexSource;\n        fragmentSource = fragmentSource || defaultFragmentSource;\n        if (floatPrecision === null) {\n            floatPrecision = testPrecisionSupport(gl.HIGH_FLOAT) ? 'highp' : (testPrecisionSupport(gl.MEDIUM_FLOAT) ? 'mediump' : 'lowp');\n        }\n        fragmentSource = 'precision ' + floatPrecision + ' float;' + fragmentSource; // annoying requirement is annoying\n        gl.attachShader(this.program, compileSource(gl.VERTEX_SHADER, vertexSource, nameStr + '(vertex)'));\n        gl.attachShader(this.program, compileSource(gl.FRAGMENT_SHADER, fragmentSource, nameStr + '(fragment)'));\n        gl.linkProgram(this.program);\n        if (!gl.getProgramParameter(this.program, gl.LINK_STATUS)) {\n            throw 'link error: ' + gl.getProgramInfoLog(this.program);\n        }\n    }\n\n    Shader.prototype.destroy = function() {\n        gl.deleteProgram(this.program);\n        this.program = null;\n    };\n\n    Shader.prototype.uniforms = function(uniforms) {\n        gl.useProgram(this.program);\n        for (var name in uniforms) {\n            if (!uniforms.hasOwnProperty(name)) continue;\n            let location = gl.getUniformLocation(this.program, name);\n            if (location === null) continue; // will be null if the uniform isn't used in the shader\n            let value = uniforms[name];\n            if (isArray(value)) {\n                switch (value.length) {\n                    case 1: gl.uniform1fv(location, new Float32Array(value)); break;\n                    case 2: gl.uniform2fv(location, new Float32Array(value)); break;\n                    case 3: gl.uniform3fv(location, new Float32Array(value)); break;\n                    case 4: gl.uniform4fv(location, new Float32Array(value)); break;\n                    case 9: gl.uniformMatrix3fv(location, false, new Float32Array(value)); break;\n                    case 16: gl.uniformMatrix4fv(location, false, new Float32Array(value)); break;\n                    default: throw 'dont\\'t know how to load uniform \"' + name + '\" of length ' + value.length;\n                }\n            } else if (isNumber(value)) {\n                gl.uniform1f(location, value);\n            } else {\n                throw 'attempted to set uniform \"' + name + '\" to invalid value ' + (value || 'undefined').toString();\n            }\n        }\n        // allow chaining\n        return this;\n    };\n\n    // textures are uniforms too but for some reason can't be specified by gl.uniform1f,\n    // even though floating point numbers represent the integers 0 through 7 exactly\n    Shader.prototype.textures = function(textures) {\n        gl.useProgram(this.program);\n        for (var name in textures) {\n            if (!textures.hasOwnProperty(name)) continue;\n            gl.uniform1i(gl.getUniformLocation(this.program, name), textures[name]);\n        }\n        // allow chaining\n        return this;\n    };\n\n    Shader.prototype.drawRect = function(left, top, right, bottom) {\n        let undefined;\n        let viewport = gl.getParameter(gl.VIEWPORT);\n        top = top !== undefined ? (top - viewport[1]) / viewport[3] : 0;\n        left = left !== undefined ? (left - viewport[0]) / viewport[2] : 0;\n        right = right !== undefined ? (right - viewport[0]) / viewport[2] : 1;\n        bottom = bottom !== undefined ? (bottom - viewport[1]) / viewport[3] : 1;\n        if (gl.vertexBuffer == null) {\n            gl.vertexBuffer = gl.createBuffer();\n        }\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.vertexBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([ left, top, left, bottom, right, top, right, bottom ]), gl.STATIC_DRAW);\n        if (gl.texCoordBuffer == null) {\n            gl.texCoordBuffer = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, gl.texCoordBuffer);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([ 0, 0, 0, 1, 1, 0, 1, 1 ]), gl.STATIC_DRAW);\n        }\n        if (this.vertexAttribute == null) {\n            this.vertexAttribute = gl.getAttribLocation(this.program, 'vertex');\n            gl.enableVertexAttribArray(this.vertexAttribute);\n        }\n        if (this.texCoordAttribute == null) {\n            this.texCoordAttribute = gl.getAttribLocation(this.program, '_texCoord');\n            gl.enableVertexAttribArray(this.texCoordAttribute);\n        }\n        gl.useProgram(this.program);\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.vertexBuffer);\n        gl.vertexAttribPointer(this.vertexAttribute, 2, gl.FLOAT, false, 0, 0);\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.texCoordBuffer);\n        gl.vertexAttribPointer(this.texCoordAttribute, 2, gl.FLOAT, false, 0, 0);\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n\n    Shader.getDefaultShader = function() {\n        gl.defaultShader = gl.defaultShader || new Shader();\n        return gl.defaultShader;\n    };\n\n    return Shader;\n})();\n\n// src/core\\spline.script\n// from SplineInterpolator.cs in the Paint.NET source code\n\nfunction SplineInterpolator(points) {\n    let n = points.length;\n    this.xa = [];\n    this.ya = [];\n    this.u = [];\n    this.y2 = [];\n\n    points.sort(function(a, b) {\n        return a[0] - b[0];\n    });\n    for (var i = 0; i < n; i++) {\n        this.xa.push(points[i][0]);\n        this.ya.push(points[i][1]);\n    }\n\n    this.u[0] = 0;\n    this.y2[0] = 0;\n\n    for (var i = 1; i < n - 1; ++i) {\n        // This is the decomposition loop of the tridiagonal algorithm. \n        // y2 and u are used for temporary storage of the decomposed factors.\n        let wx = this.xa[i + 1] - this.xa[i - 1];\n        let sig = (this.xa[i] - this.xa[i - 1]) / wx;\n        let p = sig * this.y2[i - 1] + 2.0;\n\n        this.y2[i] = (sig - 1.0) / p;\n\n        let ddydx = \n            (this.ya[i + 1] - this.ya[i]) / (this.xa[i + 1] - this.xa[i]) - \n            (this.ya[i] - this.ya[i - 1]) / (this.xa[i] - this.xa[i - 1]);\n\n        this.u[i] = (6.0 * ddydx / wx - sig * this.u[i - 1]) / p;\n    }\n\n    this.y2[n - 1] = 0;\n\n    // This is the backsubstitution loop of the tridiagonal algorithm\n    for (var i = n - 2; i >= 0; --i) {\n        this.y2[i] = this.y2[i] * this.y2[i + 1] + this.u[i];\n    }\n}\n\nSplineInterpolator.prototype.interpolate = function(x) {\n    let n = this.ya.length;\n    let klo = 0;\n    let khi = n - 1;\n\n    // We will find the right place in the table by means of\n    // bisection. This is optimal if sequential calls to this\n    // routine are at random values of x. If sequential calls\n    // are in order, and closely spaced, one would do better\n    // to store previous values of klo and khi.\n    while (khi - klo > 1) {\n        let k = (khi + klo) >> 1;\n\n        if (this.xa[k] > x) {\n            khi = k; \n        } else {\n            klo = k;\n        }\n    }\n\n    let h = this.xa[khi] - this.xa[klo];\n    let a = (this.xa[khi] - x) / h;\n    let b = (x - this.xa[klo]) / h;\n\n    // Cubic spline polynomial is now evaluated.\n    return a * this.ya[klo] + b * this.ya[khi] + \n        ((a * a * a - a) * this.y2[klo] + (b * b * b - b) * this.y2[khi]) * (h * h) / 6.0;\n};\n\n// src/core\\texture.script\nvar Texture = (function() {\n    Texture.fromElement = function(element) {\n        let texture = new Texture(0, 0, gl.RGBA, gl.UNSIGNED_BYTE);\n        texture.loadContentsOf(element);\n        return texture;\n    };\n\n    function Texture(width, height, format, type) {\n        this.gl = gl;\n        this.id = gl.createTexture();\n        this.width = width;\n        this.height = height;\n        this.format = format;\n        this.type = type;\n\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        if (width && height) gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, this.type, null);\n    }\n\n    Texture.prototype.loadContentsOf = function(element) {\n        this.width = element.width || element.videoWidth;\n        this.height = element.height || element.videoHeight;\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.format, this.type, element);\n    };\n\n    Texture.prototype.initFromBytes = function(width, height, data) {\n        this.width = width;\n        this.height = height;\n        this.format = gl.RGBA;\n        this.type = gl.UNSIGNED_BYTE;\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, this.type, new Uint8Array(data));\n    };\n\n    Texture.prototype.destroy = function() {\n        gl.deleteTexture(this.id);\n        this.id = null;\n    };\n\n    Texture.prototype.use = function(unit) {\n        gl.activeTexture(gl.TEXTURE0 + (unit || 0));\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\n    };\n\n    Texture.prototype.unuse = function(unit) {\n        gl.activeTexture(gl.TEXTURE0 + (unit || 0));\n        gl.bindTexture(gl.TEXTURE_2D, null);\n    };\n\n    Texture.prototype.ensureFormat = function(width, height, format, type) {\n        // allow passing an existing texture instead of individual arguments\n        if (arguments.length == 1) {\n            let texture = arguments[0];\n            width = texture.width;\n            height = texture.height;\n            format = texture.format;\n            type = texture.type;\n        }\n\n        // change the format only if required\n        if (width != this.width || height != this.height || format != this.format || type != this.type) {\n            this.width = width;\n            this.height = height;\n            this.format = format;\n            this.type = type;\n            gl.bindTexture(gl.TEXTURE_2D, this.id);\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, this.type, null);\n        }\n    };\n\n    Texture.prototype.drawTo = function(callback) {\n        // start rendering to this texture\n        gl.framebuffer = gl.framebuffer || gl.createFramebuffer();\n        gl.bindFramebuffer(gl.FRAMEBUFFER, gl.framebuffer);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.id, 0);\n        if (gl.checkFramebufferStatus(gl.FRAMEBUFFER) !== gl.FRAMEBUFFER_COMPLETE) {\n            throw new Error('incomplete framebuffer');\n        }\n        gl.viewport(0, 0, this.width, this.height);\n\n        // do the drawing\n        callback();\n\n        // stop rendering to this texture\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    };\n\n    let canvas = null;\n\n    function getCanvas(texture) {\n        if (canvas == null) canvas = document.createElement('canvas');\n        canvas.width = texture.width;\n        canvas.height = texture.height;\n        let c = canvas.getContext('2d');\n        c.clearRect(0, 0, canvas.width, canvas.height);\n        return c;\n    }\n\n    Texture.prototype.fillUsingCanvas = function(callback) {\n        callback(getCanvas(this));\n        this.format = gl.RGBA;\n        this.type = gl.UNSIGNED_BYTE;\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n        return this;\n    };\n\n    Texture.prototype.toImage = function(image) {\n        this.use();\n        Shader.getDefaultShader().drawRect();\n        let size = this.width * this.height * 4;\n        let pixels = new Uint8Array(size);\n        let c = getCanvas(this);\n        let data = c.createImageData(this.width, this.height);\n        gl.readPixels(0, 0, this.width, this.height, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\n        for (var i = 0; i < size; i++) {\n            data.data[i] = pixels[i];\n        }\n        c.putImageData(data, 0, 0);\n        image.src = canvas.toDataURL();\n    };\n\n    Texture.prototype.swapWith = function(other) {\n        let temp;\n        temp = other.id; other.id = this.id; this.id = temp;\n        temp = other.width; other.width = this.width; this.width = temp;\n        temp = other.height; other.height = this.height; this.height = temp;\n        temp = other.format; other.format = this.format; this.format = temp;\n    };\n\n    return Texture;\n})();\n\n// src/filters\\common.script\nfunction warpShader(uniforms, warp) {\n    return new Shader(null, uniforms + '\\\n    uniform sampler2D texture;\\\n    uniform vec2 texSize;\\\n    varying vec2 texCoord;\\\n    void main() {\\\n        vec2 coord = texCoord * texSize;\\\n        ' + warp + '\\\n        gl_FragColor = texture2D(texture, coord / texSize);\\\n        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);\\\n        if (coord != clampedCoord) {\\\n            /* fade to transparent if we are outside the image */\\\n            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));\\\n        }\\\n    }', 'warp');\n}\n\n// returns a random number between 0 and 1\nvar randomShaderFunc = '\\\n    float random(vec3 scale, float seed) {\\\n        /* use the fragment position for a different seed per-pixel */\\\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\\\n    }\\\n';\n\n// src/filters\\adjust\\brightnesscontrast.script\n/**\n * @filter           Brightness / Contrast\n * @description      Provides additive brightness and multiplicative contrast control.\n * @param brightness -1 to 1 (-1 is solid black, 0 is no change, and 1 is solid white)\n * @param contrast   -1 to 1 (-1 is solid gray, 0 is no change, and 1 is maximum contrast)\n */\nfunction brightnessContrast(brightness, contrast) {\n    gl.brightnessContrast = gl.brightnessContrast || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float brightness;\\\n        uniform float contrast;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            color.rgb += brightness;\\\n            if (contrast > 0.0) {\\\n                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\\\n            } else {\\\n                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\\\n            }\\\n            gl_FragColor = color;\\\n        }\\\n    ', 'brightnessContrast');\n\n    simpleShader.call(this, gl.brightnessContrast, {\n        brightness: clamp(-1, brightness, 1),\n        contrast: clamp(-1, contrast, 1)\n    });\n\n    return this;\n}\n\n// src/filters\\adjust\\curves.script\nfunction splineInterpolate(points) {\n    let interpolator = new SplineInterpolator(points);\n    let array = [];\n    for (var i = 0; i < 256; i++) {\n        array.push(clamp(0, Math.floor(interpolator.interpolate(i / 255) * 256), 255));\n    }\n    return array;\n}\n\n/**\n * @filter      Curves\n * @description A powerful mapping tool that transforms the colors in the image\n *              by an arbitrary function. The function is interpolated between\n *              a set of 2D points using splines. The curves filter can take\n *              either one or three arguments which will apply the mapping to\n *              either luminance or RGB values, respectively.\n * @param red   A list of points that define the function for the red channel.\n *              Each point is a list of two values: the value before the mapping\n *              and the value after the mapping, both in the range 0 to 1. For\n *              example, [[0,1], [1,0]] would invert the red channel while\n *              [[0,0], [1,1]] would leave the red channel unchanged. If green\n *              and blue are omitted then this argument also applies to the\n *              green and blue channels.\n * @param green (optional) A list of points that define the function for the green\n *              channel (just like for red).\n * @param blue  (optional) A list of points that define the function for the blue\n *              channel (just like for red).\n */\nfunction curves(red, green, blue) {\n    // Create the ramp texture\n    red = splineInterpolate(red);\n    if (arguments.length == 1) {\n        green = blue = red;\n    } else {\n        green = splineInterpolate(green);\n        blue = splineInterpolate(blue);\n    }\n    let array = [];\n    for (var i = 0; i < 256; i++) {\n        array.splice(array.length, 0, red[i], green[i], blue[i], 255);\n    }\n    this._.extraTexture.initFromBytes(256, 1, array);\n    this._.extraTexture.use(1);\n\n    gl.curves = gl.curves || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform sampler2D map;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            color.r = texture2D(map, vec2(color.r)).r;\\\n            color.g = texture2D(map, vec2(color.g)).g;\\\n            color.b = texture2D(map, vec2(color.b)).b;\\\n            gl_FragColor = color;\\\n        }\\\n    ', 'curves');\n\n    gl.curves.textures({\n        map: 1\n    });\n    simpleShader.call(this, gl.curves, {});\n\n    return this;\n}\n\n// src/filters\\adjust\\denoise.script\n/**\n * @filter         Denoise\n * @description    Smooths over grainy noise in dark images using an 9x9 box filter\n *                 weighted by color intensity, similar to a bilateral filter.\n * @param exponent The exponent of the color intensity difference, should be greater\n *                 than zero. A value of zero just gives an 9x9 box blur and high values\n *                 give the original image, but ideal values are usually around 10-20.\n */\nfunction denoise(exponent) {\n    // Do a 9x9 bilateral box filter\n    gl.denoise = gl.denoise || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float exponent;\\\n        uniform float strength;\\\n        uniform vec2 texSize;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 center = texture2D(texture, texCoord);\\\n            vec4 color = vec4(0.0);\\\n            float total = 0.0;\\\n            for (float x = -4.0; x <= 4.0; x += 1.0) {\\\n                for (float y = -4.0; y <= 4.0; y += 1.0) {\\\n                    vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);\\\n                    float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));\\\n                    weight = pow(weight, exponent);\\\n                    color += sample * weight;\\\n                    total += weight;\\\n                }\\\n            }\\\n            gl_FragColor = color / total;\\\n        }\\\n    ', 'denoise');\n\n    // Perform two iterations for stronger results\n    for (var i = 0; i < 2; i++) {\n        simpleShader.call(this, gl.denoise, {\n            exponent: Math.max(0, exponent),\n            texSize: [this.width, this.height]\n        });\n    }\n\n    return this;\n}\n\n// src/filters\\adjust\\huesaturation.script\n/**\n * @filter           Hue / Saturation\n * @description      Provides rotational hue and multiplicative saturation control. RGB color space\n *                   can be imagined as a cube where the axes are the red, green, and blue color\n *                   values. Hue changing works by rotating the color vector around the grayscale\n *                   line, which is the straight line from black (0, 0, 0) to white (1, 1, 1).\n *                   Saturation is implemented by scaling all color channel values either toward\n *                   or away from the average color channel value.\n * @param hue        -1 to 1 (-1 is 180 degree rotation in the negative direction, 0 is no change,\n *                   and 1 is 180 degree rotation in the positive direction)\n * @param saturation -1 to 1 (-1 is solid gray, 0 is no change, and 1 is maximum contrast)\n */\nfunction hueSaturation(hue, saturation) {\n    gl.hueSaturation = gl.hueSaturation || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float hue;\\\n        uniform float saturation;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            \\\n            /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */\\\n            float angle = hue * 3.14159265;\\\n            float s = sin(angle), c = cos(angle);\\\n            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\\\n            float len = length(color.rgb);\\\n            color.rgb = vec3(\\\n                dot(color.rgb, weights.xyz),\\\n                dot(color.rgb, weights.zxy),\\\n                dot(color.rgb, weights.yzx)\\\n            );\\\n            \\\n            /* saturation adjustment */\\\n            float average = (color.r + color.g + color.b) / 3.0;\\\n            if (saturation > 0.0) {\\\n                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\\\n            } else {\\\n                color.rgb += (average - color.rgb) * (-saturation);\\\n            }\\\n            \\\n            gl_FragColor = color;\\\n        }\\\n    ', 'hueSaturation');\n\n    simpleShader.call(this, gl.hueSaturation, {\n        hue: clamp(-1, hue, 1),\n        saturation: clamp(-1, saturation, 1)\n    });\n\n    return this;\n}\n\n// src/filters\\adjust\\noise.script\n/**\n * @filter         Noise\n * @description    Adds black and white noise to the image.\n * @param amount   0 to 1 (0 for no effect, 1 for maximum noise)\n */\nfunction noise(amount) {\n    gl.noise = gl.noise || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float amount;\\\n        varying vec2 texCoord;\\\n        float rand(vec2 co) {\\\n            return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\\n        }\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            \\\n            float diff = (rand(texCoord) - 0.5) * amount;\\\n            color.r += diff;\\\n            color.g += diff;\\\n            color.b += diff;\\\n            \\\n            gl_FragColor = color;\\\n        }\\\n    ', 'noise');\n\n    simpleShader.call(this, gl.noise, {\n        amount: clamp(0, amount, 1)\n    });\n\n    return this;\n}\n\n// src/filters\\adjust\\sepia.script\n/**\n * @filter         Sepia\n * @description    Gives the image a reddish-brown monochrome tint that imitates an old photograph.\n * @param amount   0 to 1 (0 for no effect, 1 for full sepia coloring)\n */\nfunction sepia(amount) {\n    gl.sepia = gl.sepia || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float amount;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            float r = color.r;\\\n            float g = color.g;\\\n            float b = color.b;\\\n            \\\n            color.r = min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));\\\n            color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));\\\n            color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));\\\n            \\\n            gl_FragColor = color;\\\n        }\\\n    ', 'sepia');\n\n    simpleShader.call(this, gl.sepia, {\n        amount: clamp(0, amount, 1)\n    });\n\n    return this;\n}\n\n// src/filters\\adjust\\unsharpmask.script\n/**\n * @filter         Unsharp Mask\n * @description    A form of image sharpening that amplifies high-frequencies in the image. It\n *                 is implemented by scaling pixels away from the average of their neighbors.\n * @param radius   The blur radius that calculates the average of the neighboring pixels.\n * @param strength A scale factor where 0 is no effect and higher values cause a stronger effect.\n */\nfunction unsharpMask(radius, strength) {\n    gl.unsharpMask = gl.unsharpMask || new Shader(null, '\\\n        uniform sampler2D blurredTexture;\\\n        uniform sampler2D originalTexture;\\\n        uniform float strength;\\\n        uniform float threshold;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 blurred = texture2D(blurredTexture, texCoord);\\\n            vec4 original = texture2D(originalTexture, texCoord);\\\n            gl_FragColor = mix(blurred, original, 1.0 + strength);\\\n        }\\\n    ', 'unsharpMask');\n\n    // Store a copy of the current texture in the second texture unit\n    this._.extraTexture.ensureFormat(this._.texture);\n    this._.texture.use();\n    this._.extraTexture.drawTo(function() {\n        Shader.getDefaultShader().drawRect();\n    });\n\n    // Blur the current texture, then use the stored texture to detect edges\n    this._.extraTexture.use(1);\n    this.triangleBlur(radius);\n    gl.unsharpMask.textures({\n        originalTexture: 1\n    });\n    simpleShader.call(this, gl.unsharpMask, {\n        strength: strength\n    });\n    this._.extraTexture.unuse(1);\n\n    return this;\n}\n\n// src/filters\\adjust\\vibrance.script\n/**\n * @filter       Vibrance\n * @description  Modifies the saturation of desaturated colors, leaving saturated colors unmodified.\n * @param amount -1 to 1 (-1 is minimum vibrance, 0 is no change, and 1 is maximum vibrance)\n */\nfunction vibrance(amount) {\n    gl.vibrance = gl.vibrance || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float amount;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            float average = (color.r + color.g + color.b) / 3.0;\\\n            float mx = max(color.r, max(color.g, color.b));\\\n            float amt = (mx - average) * (-amount * 3.0);\\\n            color.rgb = mix(color.rgb, vec3(mx), amt);\\\n            gl_FragColor = color;\\\n        }\\\n    ', 'vibrance');\n\n    simpleShader.call(this, gl.vibrance, {\n        amount: clamp(-1, amount, 1)\n    });\n\n    return this;\n}\n\n// src/filters\\adjust\\vignette.script\n/**\n * @filter         Vignette\n * @description    Adds a simulated lens edge darkening effect.\n * @param size     0 to 1 (0 for center of frame, 1 for edge of frame)\n * @param amount   0 to 1 (0 for no effect, 1 for maximum lens darkening)\n */\nfunction vignette(size, amount) {\n    gl.vignette = gl.vignette || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float size;\\\n        uniform float amount;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            \\\n            float dist = distance(texCoord, vec2(0.5, 0.5));\\\n            color.rgb *= smoothstep(0.8, size * 0.799, dist * (amount + size));\\\n            \\\n            gl_FragColor = color;\\\n        }\\\n    ', 'vignette');\n\n    simpleShader.call(this, gl.vignette, {\n        size: clamp(0, size, 1),\n        amount: clamp(0, amount, 1)\n    });\n\n    return this;\n}\n\n// src/filters\\blur\\lensblur.script\n/**\n * @filter           Lens Blur\n * @description      Imitates a camera capturing the image out of focus by using a blur that generates\n *                   the large shapes known as bokeh. The polygonal shape of real bokeh is due to the\n *                   blades of the aperture diaphragm when it isn't fully open. This blur renders\n *                   bokeh from a 6-bladed diaphragm because the computation is more efficient. It\n *                   can be separated into three rhombi, each of which is just a skewed box blur.\n *                   This filter makes use of the floating point texture WebGL extension to implement\n *                   the brightness parameter, so there will be severe visual artifacts if brightness\n *                   is non-zero and the floating point texture extension is not available. The\n *                   idea was from John White's SIGGRAPH 2011 talk but this effect has an additional\n *                   brightness parameter that fakes what would otherwise come from a HDR source.\n * @param radius     the radius of the hexagonal disk convolved with the image\n * @param brightness -1 to 1 (the brightness of the bokeh, negative values will create dark bokeh)\n * @param angle      the rotation of the bokeh in radians\n */\nfunction lensBlur(radius, brightness, angle) {\n    // All averaging is done on values raised to a power to make more obvious bokeh\n    // (we will raise the average to the inverse power at the end to compensate).\n    // Without this the image looks almost like a normal blurred image. This hack is\n    // obviously not realistic, but to accurately simulate this we would need a high\n    // dynamic range source photograph which we don't have.\n    gl.lensBlurPrePass = gl.lensBlurPrePass || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float power;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            color = pow(color, vec4(power));\\\n            gl_FragColor = vec4(color);\\\n        }\\\n    ', 'lensBlurPrePass');\n\n    let common = '\\\n        uniform sampler2D texture0;\\\n        uniform sampler2D texture1;\\\n        uniform vec2 delta0;\\\n        uniform vec2 delta1;\\\n        uniform float power;\\\n        varying vec2 texCoord;\\\n        ' + randomShaderFunc + '\\\n        vec4 sample(vec2 delta) {\\\n            /* randomize the lookup values to hide the fixed number of samples */\\\n            float offset = random(vec3(delta, 151.7182), 0.0);\\\n            \\\n            vec4 color = vec4(0.0);\\\n            float total = 0.0;\\\n            for (float t = 0.0; t <= 30.0; t++) {\\\n                float percent = (t + offset) / 30.0;\\\n                color += texture2D(texture0, texCoord + delta * percent);\\\n                total += 1.0;\\\n            }\\\n            return color / total;\\\n        }\\\n    ';\n\n    gl.lensBlur0 = gl.lensBlur0 || new Shader(null, common + '\\\n        void main() {\\\n            gl_FragColor = sample(delta0);\\\n        }\\\n    ', 'lensBlur0');\n    gl.lensBlur1 = gl.lensBlur1 || new Shader(null, common + '\\\n        void main() {\\\n            gl_FragColor = (sample(delta0) + sample(delta1)) * 0.5;\\\n        }\\\n    ', 'lensBlur1');\n    gl.lensBlur2 = gl.lensBlur2 || new Shader(null, common + '\\\n        void main() {\\\n            vec4 color = (sample(delta0) + 2.0 * texture2D(texture1, texCoord)) / 3.0;\\\n            gl_FragColor = pow(color, vec4(power));\\\n        }\\\n    ', 'lensBlur2').textures({ texture1: 1 });\n\n    // Generate\n    let dir = [];\n    for (var i = 0; i < 3; i++) {\n        let a = angle + i * Math.PI * 2 / 3;\n        dir.push([radius * Math.sin(a) / this.width, radius * Math.cos(a) / this.height]);\n    }\n    let power = Math.pow(10, clamp(-1, brightness, 1));\n\n    // Remap the texture values, which will help make the bokeh effect\n    simpleShader.call(this, gl.lensBlurPrePass, {\n        power: power\n    });\n\n    // Blur two rhombi in parallel into extraTexture\n    this._.extraTexture.ensureFormat(this._.texture);\n    simpleShader.call(this, gl.lensBlur0, {\n        delta0: dir[0]\n    }, this._.texture, this._.extraTexture);\n    simpleShader.call(this, gl.lensBlur1, {\n        delta0: dir[1],\n        delta1: dir[2]\n    }, this._.extraTexture, this._.extraTexture);\n\n    // Blur the last rhombus and combine with extraTexture\n    simpleShader.call(this, gl.lensBlur0, {\n        delta0: dir[1]\n    });\n    this._.extraTexture.use(1);\n    simpleShader.call(this, gl.lensBlur2, {\n        power: 1 / power,\n        delta0: dir[2]\n    });\n\n    return this;\n}\n\n// src/filters\\blur\\tiltshift.script\n/**\n * @filter               Tilt Shift\n * @description          Simulates the shallow depth of field normally encountered in close-up\n *                       photography, which makes the scene seem much smaller than it actually\n *                       is. This filter assumes the scene is relatively planar, in which case\n *                       the part of the scene that is completely in focus can be described by\n *                       a line (the intersection of the focal plane and the scene). An example\n *                       of a planar scene might be looking at a road from above at a downward\n *                       angle. The image is then blurred with a blur radius that starts at zero\n *                       on the line and increases further from the line.\n * @param startX         The x coordinate of the start of the line segment.\n * @param startY         The y coordinate of the start of the line segment.\n * @param endX           The x coordinate of the end of the line segment.\n * @param endY           The y coordinate of the end of the line segment.\n * @param blurRadius     The maximum radius of the pyramid blur.\n * @param gradientRadius The distance from the line at which the maximum blur radius is reached.\n */\nfunction tiltShift(startX, startY, endX, endY, blurRadius, gradientRadius) {\n    gl.tiltShift = gl.tiltShift || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float blurRadius;\\\n        uniform float gradientRadius;\\\n        uniform vec2 start;\\\n        uniform vec2 end;\\\n        uniform vec2 delta;\\\n        uniform vec2 texSize;\\\n        varying vec2 texCoord;\\\n        ' + randomShaderFunc + '\\\n        void main() {\\\n            vec4 color = vec4(0.0);\\\n            float total = 0.0;\\\n            \\\n            /* randomize the lookup values to hide the fixed number of samples */\\\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\n            \\\n            vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\\\n            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\\\n            for (float t = -30.0; t <= 30.0; t++) {\\\n                float percent = (t + offset - 0.5) / 30.0;\\\n                float weight = 1.0 - abs(percent);\\\n                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);\\\n                \\\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\n                sample.rgb *= sample.a;\\\n                \\\n                color += sample * weight;\\\n                total += weight;\\\n            }\\\n            \\\n            gl_FragColor = color / total;\\\n            \\\n            /* switch back from pre-multiplied alpha */\\\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\n        }\\\n    ', 'tiltShift');\n\n    let dx = endX - startX;\n    let dy = endY - startY;\n    let d = Math.sqrt(dx * dx + dy * dy);\n    simpleShader.call(this, gl.tiltShift, {\n        blurRadius: blurRadius,\n        gradientRadius: gradientRadius,\n        start: [startX, startY],\n        end: [endX, endY],\n        delta: [dx / d, dy / d],\n        texSize: [this.width, this.height]\n    });\n    simpleShader.call(this, gl.tiltShift, {\n        blurRadius: blurRadius,\n        gradientRadius: gradientRadius,\n        start: [startX, startY],\n        end: [endX, endY],\n        delta: [-dy / d, dx / d],\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\blur\\triangleblur.script\n/**\n * @filter       Triangle Blur\n * @description  This is the most basic blur filter, which convolves the image with a\n *               pyramid filter. The pyramid filter is separable and is applied as two\n *               perpendicular triangle filters.\n * @param radius The radius of the pyramid convolved with the image.\n */\nfunction triangleBlur(radius) {\n    gl.triangleBlur = gl.triangleBlur || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform vec2 delta;\\\n        varying vec2 texCoord;\\\n        ' + randomShaderFunc + '\\\n        void main() {\\\n            vec4 color = vec4(0.0);\\\n            float total = 0.0;\\\n            \\\n            /* randomize the lookup values to hide the fixed number of samples */\\\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\n            \\\n            for (float t = -30.0; t <= 30.0; t++) {\\\n                float percent = (t + offset - 0.5) / 30.0;\\\n                float weight = 1.0 - abs(percent);\\\n                vec4 sample = texture2D(texture, texCoord + delta * percent);\\\n                \\\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\n                sample.rgb *= sample.a;\\\n                \\\n                color += sample * weight;\\\n                total += weight;\\\n            }\\\n            \\\n            gl_FragColor = color / total;\\\n            \\\n            /* switch back from pre-multiplied alpha */\\\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\n        }\\\n    ', 'triangleBlur');\n\n    simpleShader.call(this, gl.triangleBlur, {\n        delta: [radius / this.width, 0]\n    });\n    simpleShader.call(this, gl.triangleBlur, {\n        delta: [0, radius / this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\blur\\zoomblur.script\n/**\n * @filter         Zoom Blur\n * @description    Blurs the image away from a certain point, which looks like radial motion blur.\n * @param centerX  The x coordinate of the blur origin.\n * @param centerY  The y coordinate of the blur origin.\n * @param strength The strength of the blur. Values in the range 0 to 1 are usually sufficient,\n *                 where 0 doesn't change the image and 1 creates a highly blurred image.\n */\nfunction zoomBlur(centerX, centerY, strength) {\n    gl.zoomBlur = gl.zoomBlur || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform vec2 center;\\\n        uniform float strength;\\\n        uniform vec2 texSize;\\\n        varying vec2 texCoord;\\\n        ' + randomShaderFunc + '\\\n        void main() {\\\n            vec4 color = vec4(0.0);\\\n            float total = 0.0;\\\n            vec2 toCenter = center - texCoord * texSize;\\\n            \\\n            /* randomize the lookup values to hide the fixed number of samples */\\\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\n            \\\n            for (float t = 0.0; t <= 40.0; t++) {\\\n                float percent = (t + offset) / 40.0;\\\n                float weight = 4.0 * (percent - percent * percent);\\\n                vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);\\\n                \\\n                /* switch to pre-multiplied alpha to correctly blur transparent images */\\\n                sample.rgb *= sample.a;\\\n                \\\n                color += sample * weight;\\\n                total += weight;\\\n            }\\\n            \\\n            gl_FragColor = color / total;\\\n            \\\n            /* switch back from pre-multiplied alpha */\\\n            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\\\n        }\\\n    ', 'zoomBlur');\n\n    simpleShader.call(this, gl.zoomBlur, {\n        center: [centerX, centerY],\n        strength: strength,\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\fun\\colorhalftone.script\n/**\n * @filter        Color Halftone\n * @description   Simulates a CMYK halftone rendering of the image by multiplying pixel values\n *                with a four rotated 2D sine wave patterns, one each for cyan, magenta, yellow,\n *                and black.\n * @param centerX The x coordinate of the pattern origin.\n * @param centerY The y coordinate of the pattern origin.\n * @param angle   The rotation of the pattern in radians.\n * @param size    The diameter of a dot in pixels.\n */\nfunction colorHalftone(centerX, centerY, angle, size) {\n    gl.colorHalftone = gl.colorHalftone || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform vec2 center;\\\n        uniform float angle;\\\n        uniform float scale;\\\n        uniform vec2 texSize;\\\n        varying vec2 texCoord;\\\n        \\\n        float pattern(float angle) {\\\n            float s = sin(angle), c = cos(angle);\\\n            vec2 tex = texCoord * texSize - center;\\\n            vec2 point = vec2(\\\n                c * tex.x - s * tex.y,\\\n                s * tex.x + c * tex.y\\\n            ) * scale;\\\n            return (sin(point.x) * sin(point.y)) * 4.0;\\\n        }\\\n        \\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            vec3 cmy = 1.0 - color.rgb;\\\n            float k = min(cmy.x, min(cmy.y, cmy.z));\\\n            cmy = (cmy - k) / (1.0 - k);\\\n            cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(angle + 0.26179), pattern(angle + 1.30899), pattern(angle)), 0.0, 1.0);\\\n            k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539), 0.0, 1.0);\\\n            gl_FragColor = vec4(1.0 - cmy - k, color.a);\\\n        }\\\n    ', 'colorHalftone');\n\n    simpleShader.call(this, gl.colorHalftone, {\n        center: [centerX, centerY],\n        angle: angle,\n        scale: Math.PI / size,\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\fun\\dotscreen.script\n/**\n * @filter        Dot Screen\n * @description   Simulates a black and white halftone rendering of the image by multiplying\n *                pixel values with a rotated 2D sine wave pattern.\n * @param centerX The x coordinate of the pattern origin.\n * @param centerY The y coordinate of the pattern origin.\n * @param angle   The rotation of the pattern in radians.\n * @param size    The diameter of a dot in pixels.\n */\nfunction dotScreen(centerX, centerY, angle, size) {\n    gl.dotScreen = gl.dotScreen || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform vec2 center;\\\n        uniform float angle;\\\n        uniform float scale;\\\n        uniform vec2 texSize;\\\n        varying vec2 texCoord;\\\n        \\\n        float pattern() {\\\n            float s = sin(angle), c = cos(angle);\\\n            vec2 tex = texCoord * texSize - center;\\\n            vec2 point = vec2(\\\n                c * tex.x - s * tex.y,\\\n                s * tex.x + c * tex.y\\\n            ) * scale;\\\n            return (sin(point.x) * sin(point.y)) * 4.0;\\\n        }\\\n        \\\n        void main() {\\\n            vec4 color = texture2D(texture, texCoord);\\\n            float average = (color.r + color.g + color.b) / 3.0;\\\n            gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\\\n        }\\\n    ', 'dotScreen');\n\n    simpleShader.call(this, gl.dotScreen, {\n        center: [centerX, centerY],\n        angle: angle,\n        scale: Math.PI / size,\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\fun\\edgework.script\n/**\n * @filter       Edge Work\n * @description  Picks out different frequencies in the image by subtracting two\n *               copies of the image blurred with different radii.\n * @param radius The radius of the effect in pixels.\n */\nfunction edgeWork(radius) {\n    gl.edgeWork1 = gl.edgeWork1 || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform vec2 delta;\\\n        varying vec2 texCoord;\\\n        ' + randomShaderFunc + '\\\n        void main() {\\\n            vec2 color = vec2(0.0);\\\n            vec2 total = vec2(0.0);\\\n            \\\n            /* randomize the lookup values to hide the fixed number of samples */\\\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\n            \\\n            for (float t = -30.0; t <= 30.0; t++) {\\\n                float percent = (t + offset - 0.5) / 30.0;\\\n                float weight = 1.0 - abs(percent);\\\n                vec3 sample = texture2D(texture, texCoord + delta * percent).rgb;\\\n                float average = (sample.r + sample.g + sample.b) / 3.0;\\\n                color.x += average * weight;\\\n                total.x += weight;\\\n                if (abs(t) < 15.0) {\\\n                    weight = weight * 2.0 - 1.0;\\\n                    color.y += average * weight;\\\n                    total.y += weight;\\\n                }\\\n            }\\\n            gl_FragColor = vec4(color / total, 0.0, 1.0);\\\n        }\\\n    ', 'edgeWork1');\n    gl.edgeWork2 = gl.edgeWork2 || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform vec2 delta;\\\n        varying vec2 texCoord;\\\n        ' + randomShaderFunc + '\\\n        void main() {\\\n            vec2 color = vec2(0.0);\\\n            vec2 total = vec2(0.0);\\\n            \\\n            /* randomize the lookup values to hide the fixed number of samples */\\\n            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\\\n            \\\n            for (float t = -30.0; t <= 30.0; t++) {\\\n                float percent = (t + offset - 0.5) / 30.0;\\\n                float weight = 1.0 - abs(percent);\\\n                vec2 sample = texture2D(texture, texCoord + delta * percent).xy;\\\n                color.x += sample.x * weight;\\\n                total.x += weight;\\\n                if (abs(t) < 15.0) {\\\n                    weight = weight * 2.0 - 1.0;\\\n                    color.y += sample.y * weight;\\\n                    total.y += weight;\\\n                }\\\n            }\\\n            float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\\\n            gl_FragColor = vec4(c, c, c, 1.0);\\\n        }\\\n    ', 'edgeWork2');\n\n    simpleShader.call(this, gl.edgeWork1, {\n        delta: [radius / this.width, 0]\n    });\n    simpleShader.call(this, gl.edgeWork2, {\n        delta: [0, radius / this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\fun\\hexagonalpixelate.script\n/**\n * @filter        Hexagonal Pixelate\n * @description   Renders the image using a pattern of hexagonal tiles. Tile colors\n *                are nearest-neighbor sampled from the centers of the tiles.\n * @param centerX The x coordinate of the pattern center.\n * @param centerY The y coordinate of the pattern center.\n * @param scale   The width of an individual tile, in pixels.\n */\nfunction hexagonalPixelate(centerX, centerY, scale) {\n    gl.hexagonalPixelate = gl.hexagonalPixelate || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform vec2 center;\\\n        uniform float scale;\\\n        uniform vec2 texSize;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec2 tex = (texCoord * texSize - center) / scale;\\\n            tex.y /= 0.866025404;\\\n            tex.x -= tex.y * 0.5;\\\n            \\\n            vec2 a;\\\n            if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) a = vec2(floor(tex.x), floor(tex.y));\\\n            else a = vec2(ceil(tex.x), ceil(tex.y));\\\n            vec2 b = vec2(ceil(tex.x), floor(tex.y));\\\n            vec2 c = vec2(floor(tex.x), ceil(tex.y));\\\n            \\\n            vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\\\n            vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\\\n            vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\\\n            vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\\\n            \\\n            float alen = length(TEX - A);\\\n            float blen = length(TEX - B);\\\n            float clen = length(TEX - C);\\\n            \\\n            vec2 choice;\\\n            if (alen < blen) {\\\n                if (alen < clen) choice = a;\\\n                else choice = c;\\\n            } else {\\\n                if (blen < clen) choice = b;\\\n                else choice = c;\\\n            }\\\n            \\\n            choice.x += choice.y * 0.5;\\\n            choice.y *= 0.866025404;\\\n            choice *= scale / texSize;\\\n            gl_FragColor = texture2D(texture, choice + center / texSize);\\\n        }\\\n    ', 'hexagonalPixelate');\n\n    simpleShader.call(this, gl.hexagonalPixelate, {\n        center: [centerX, centerY],\n        scale: scale,\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\fun\\ink.script\n/**\n * @filter         Ink\n * @description    Simulates outlining the image in ink by darkening edges stronger than a\n *                 certain threshold. The edge detection value is the difference of two\n *                 copies of the image, each blurred using a blur of a different radius.\n * @param strength The multiplicative scale of the ink edges. Values in the range 0 to 1\n *                 are usually sufficient, where 0 doesn't change the image and 1 adds lots\n *                 of black edges. Negative strength values will create white ink edges\n *                 instead of black ones.\n */\nfunction ink(strength) {\n    gl.ink = gl.ink || new Shader(null, '\\\n        uniform sampler2D texture;\\\n        uniform float strength;\\\n        uniform vec2 texSize;\\\n        varying vec2 texCoord;\\\n        void main() {\\\n            vec2 dx = vec2(1.0 / texSize.x, 0.0);\\\n            vec2 dy = vec2(0.0, 1.0 / texSize.y);\\\n            vec4 color = texture2D(texture, texCoord);\\\n            float bigTotal = 0.0;\\\n            float smallTotal = 0.0;\\\n            vec3 bigAverage = vec3(0.0);\\\n            vec3 smallAverage = vec3(0.0);\\\n            for (float x = -2.0; x <= 2.0; x += 1.0) {\\\n                for (float y = -2.0; y <= 2.0; y += 1.0) {\\\n                    vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\\\n                    bigAverage += sample;\\\n                    bigTotal += 1.0;\\\n                    if (abs(x) + abs(y) < 2.0) {\\\n                        smallAverage += sample;\\\n                        smallTotal += 1.0;\\\n                    }\\\n                }\\\n            }\\\n            vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\\\n            gl_FragColor = vec4(color.rgb - dot(edge, edge) * strength * 100000.0, color.a);\\\n        }\\\n    ', 'ink');\n\n    simpleShader.call(this, gl.ink, {\n        strength: strength * strength * strength * strength * strength,\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\warp\\bulgepinch.script\n/**\n * @filter         Bulge / Pinch\n * @description    Bulges or pinches the image in a circle.\n * @param centerX  The x coordinate of the center of the circle of effect.\n * @param centerY  The y coordinate of the center of the circle of effect.\n * @param radius   The radius of the circle of effect.\n * @param strength -1 to 1 (-1 is strong pinch, 0 is no effect, 1 is strong bulge)\n */\nfunction bulgePinch(centerX, centerY, radius, strength) {\n    gl.bulgePinch = gl.bulgePinch || warpShader('\\\n        uniform float radius;\\\n        uniform float strength;\\\n        uniform vec2 center;\\\n    ', '\\\n        coord -= center;\\\n        float distance = length(coord);\\\n        if (distance < radius) {\\\n            float percent = distance / radius;\\\n            if (strength > 0.0) {\\\n                coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\\\n            } else {\\\n                coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\\\n            }\\\n        }\\\n        coord += center;\\\n    ');\n\n    simpleShader.call(this, gl.bulgePinch, {\n        radius: radius,\n        strength: clamp(-1, strength, 1),\n        center: [centerX, centerY],\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n// src/filters\\warp\\matrixwarp.script\n/**\n * @filter                Matrix Warp\n * @description           Transforms an image by a 2x2 or 3x3 matrix. The coordinates used in\n *                        the transformation are (x, y) for a 2x2 matrix or (x, y, 1) for a\n *                        3x3 matrix, where x and y are in units of pixels.\n * @param matrix          A 2x2 or 3x3 matrix represented as either a list or a list of lists.\n *                        For example, the 3x3 matrix [[2,0,0],[0,3,0],[0,0,1]] can also be\n *                        represented as [2,0,0,0,3,0,0,0,1] or just [2,0,0,3].\n * @param inverse         A boolean value that, when true, applies the inverse transformation\n *                        instead. (optional, defaults to false)\n * @param useTextureSpace A boolean value that, when true, uses texture-space coordinates\n *                        instead of screen-space coordinates. Texture-space coordinates range\n *                        from -1 to 1 instead of 0 to width - 1 or height - 1, and are easier\n *                        to use for simple operations like flipping and rotating.\n */\nfunction matrixWarp(matrix, inverse, useTextureSpace) {\n    gl.matrixWarp = gl.matrixWarp || warpShader('\\\n        uniform mat3 matrix;\\\n        uniform bool useTextureSpace;\\\n    ', '\\\n        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;\\\n        vec3 warp = matrix * vec3(coord, 1.0);\\\n        coord = warp.xy / warp.z;\\\n        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;\\\n    ');\n\n    // Flatten all members of matrix into one big list\n    matrix = Array.prototype.concat.apply([], matrix);\n\n    // Extract a 3x3 matrix out of the arguments\n    if (matrix.length == 4) {\n        matrix = [\n            matrix[0], matrix[1], 0,\n            matrix[2], matrix[3], 0,\n            0, 0, 1\n        ];\n    } else if (matrix.length != 9) {\n        throw 'can only warp with 2x2 or 3x3 matrix';\n    }\n\n    simpleShader.call(this, gl.matrixWarp, {\n        matrix: inverse ? getInverse(matrix) : matrix,\n        texSize: [this.width, this.height],\n        useTextureSpace: useTextureSpace | 0\n    });\n\n    return this;\n}\n\n// src/filters\\warp\\perspective.script\n/**\n * @filter       Perspective\n * @description  Warps one quadrangle to another with a perspective transform. This can be used to\n *               make a 2D image look 3D or to recover a 2D image captured in a 3D environment.\n * @param before The x and y coordinates of four points before the transform in a flat list. This\n *               would look like [ax, ay, bx, by, cx, cy, dx, dy] for four points (ax, ay), (bx, by),\n *               (cx, cy), and (dx, dy).\n * @param after  The x and y coordinates of four points after the transform in a flat list, just\n *               like the other argument.\n */\nfunction perspective(before, after) {\n    let a = getSquareToQuad.apply(null, after);\n    let b = getSquareToQuad.apply(null, before);\n    let c = multiply(getInverse(a), b);\n    return this.matrixWarp(c);\n}\n\n// src/filters\\warp\\swirl.script\n/**\n * @filter        Swirl\n * @description   Warps a circular region of the image in a swirl.\n * @param centerX The x coordinate of the center of the circular region.\n * @param centerY The y coordinate of the center of the circular region.\n * @param radius  The radius of the circular region.\n * @param angle   The angle in radians that the pixels in the center of\n *                the circular region will be rotated by.\n */\nfunction swirl(centerX, centerY, radius, angle) {\n    gl.swirl = gl.swirl || warpShader('\\\n        uniform float radius;\\\n        uniform float angle;\\\n        uniform vec2 center;\\\n    ', '\\\n        coord -= center;\\\n        float distance = length(coord);\\\n        if (distance < radius) {\\\n            float percent = (radius - distance) / radius;\\\n            float theta = percent * percent * angle;\\\n            float s = sin(theta);\\\n            float c = cos(theta);\\\n            coord = vec2(\\\n                coord.x * c - coord.y * s,\\\n                coord.x * s + coord.y * c\\\n            );\\\n        }\\\n        coord += center;\\\n    ');\n\n    simpleShader.call(this, gl.swirl, {\n        radius: radius,\n        center: [centerX, centerY],\n        angle: angle,\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n/**\n * @filter        Invert\n * @description   Inverts color of each pixel\n */\nfunction invert() {\n    gl.invert = gl.invert || new Shader(null, '\\\n    uniform sampler2D texture;\\\n    uniform vec2 texSize;\\\n    varying vec2 texCoord;\\\n    \\\n    void main() {\\\n        vec4 color = texture2D(texture, texCoord);\\\n        gl_FragColor = vec4(1.0 - color.r, 1.0 - color.g, 1.0 - color.b, color.a);\\\n    }\\\n', 'invert');\n\n    simpleShader.call(this, gl.invert, {\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n/**\n * @filter        To Alpha\n * @description   Generates alpha channel from luminance (r+g+b)\n * @param isInverted    boolean - invert luminance\n * @param replaceRGBA    rgba - color to replace rgb with. if a = 0 -> keep orig color\n */\nfunction toAlpha(isInverted, replaceRGBA) {\n    gl.toAlpha = gl.toAlpha || new Shader(null, '\\\n    uniform bool isInverted;\\\n    uniform vec4 replace;\\\n    uniform sampler2D texture;\\\n    uniform vec2 texSize;\\\n    varying vec2 texCoord;\\\n    \\\n    void main() {\\\n        vec4 color = texture2D(texture, texCoord);\\\n        float alpha = (color.r + color.g + color.b) / 3.0;\\\n        if (isInverted) alpha = 1.0 - alpha;\\\n        alpha = min(color.a, alpha);\\\n        if (replace.a > 0.0) color = replace;\\\n        gl_FragColor = vec4(color.r, color.g, color.b, alpha);\\\n    }\\\n', 'toAlpha');\n\n    simpleShader.call(this, gl.toAlpha, {\n        isInverted: isInverted ? 1 : 0,\n        replace: replaceRGBA ? [replaceRGBA.r / 255, replaceRGBA.g / 255, replaceRGBA.b / 255, replaceRGBA.a] : [0,0,0,0],\n        texSize: [this.width, this.height]\n    });\n\n    return this;\n}\n\n\nreturn exports;\n})();\n","import {fx} from '../../../script-vendor/glfx';\n\nlet fxCanvas = null\ntry {\n    fxCanvas = fx.canvas();\n} catch (e) {\n}\n\nexport function getSharedFx() {\n    if (!fxCanvas || fxCanvas._.gl.isContextLost()) {\n        try {\n            fxCanvas = fx.canvas();\n        } catch (e) {\n        }\n    }\n    return fxCanvas;\n}","import {BB} from '../../bb/bb';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {eventResMs} from './filters-consts';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const glBrightnessContrast = {\n    getDialog(params: IFilterGetDialogParam) {\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n\n\n        let context = params.context; //2d context of canvas\n        let canvas = params.canvas; //the klCanvas and dom element\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (tempCanvas.width > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n\n\n        function finishInit() {\n\n            let brightness = 0, contrast = 0;\n            div.innerHTML = LANG('filter-bright-contrast-description') + \"<br/><br/>\";\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n\n            let brightnessSlider = new KlSlider({\n                label: LANG('filter-bright-contrast-brightness'),\n                width: 300,\n                height: 30,\n                min: 0,\n                max: 100,\n                initValue: (brightness + 1) * 50,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    brightness = val / 50 - 1;\n                    glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\n                    klCanvasPreview.render();\n                }\n            });\n            let contrastSlider = new KlSlider({\n                label: LANG('filter-bright-contrast-contrast'),\n                width: 300,\n                height: 30,\n                min: 0,\n                max: 100,\n                initValue: (contrast + 1) * 50,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    contrast = val / 50 - 1;\n                    glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\n                    klCanvasPreview.render();\n                }\n            });\n            brightnessSlider.getElement().style.marginBottom = \"10px\";\n            div.appendChild(brightnessSlider.getElement());\n            div.appendChild(contrastSlider.getElement());\n\n\n\n            let previewWrapper = document.createElement(\"div\");\n            BB.css(previewWrapper, {\n                width: \"340px\",\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    previewLayerArr.push({\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            let klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + w),\n                height: parseInt('' + h),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + w) + 'px',\n                    height: parseInt('' + h) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n            div.appendChild(previewWrapper);\n\n            try {\n                glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\n                klCanvasPreview.render();\n            } catch(e) {\n                (div as any).errorCallback(e);\n            }\n\n            result.destroy = () => {\n                brightnessSlider.destroy();\n                contrastSlider.destroy();\n                texture.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    brightness: brightness,\n                    contrast: contrast\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1); // the canvas isn't ready for some reason\n\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let brightness = params.input.brightness;\n        let contrast = params.input.contrast;\n        let history = params.history;\n        if (!context || brightness === null || contrast === null || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).brightnessContrast(brightness, contrast).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"glBrightnessContrast\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n\n        return true;\n    }\n}","import {BB} from '../../bb/bb';\nimport {input} from '../ui/base-components/input';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {ColorOptions} from '../ui/base-components/color-options';\nimport {Cropper} from '../ui/components/cropper';\nimport {IFilterApply, IFilterGetDialogParam} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const cropExtend = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        const canvas = params.canvas;\n        if (!canvas)\n            return false;\n        const tempCanvas = BB.canvas();\n        {\n            let fit = BB.fitInto(canvas.getWidth(), canvas.getHeight(), 560, 400, 1);\n            let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n            let previewFactor = w / canvas.getWidth();\n            tempCanvas.width = w;\n            tempCanvas.height = h;\n            tempCanvas.style.display = 'block';\n            tempCanvas.getContext(\"2d\").drawImage(canvas.getCompleteCanvas(previewFactor), 0, 0, w, h);\n        }\n\n        const div = document.createElement(\"div\");\n        const result: any = {\n            element: div\n        };\n        div.innerHTML = LANG('filter-crop-description') + \"<br/><br/>\";\n        let left = 0, right = 0, top = 0, bottom = 0;\n        let leftChanged = false, rightChanged = false, topChanged = false, bottomChanged = false;\n        const maxWidth = params.maxWidth, maxHeight = params.maxHeight;\n        let scale;\n\n\n\n        // --- input elements ---\n\n        const lrWrapper = BB.el({\n            css: {lineHeight: '30px', height: '35px'}\n        });\n        const tbWrapper = BB.el({\n            css: {lineHeight: '30px', height: '35px'}\n        });\n        div.appendChild(lrWrapper);\n        div.appendChild(tbWrapper);\n\n        const leftInput = input({\n            init: 0,\n            type: 'number',\n            min: -canvas.getWidth(),\n            max: maxWidth,\n            css: {width: '75px', marginRight: '20px'},\n            callback: function(v) {\n                leftChanged = true;\n                updateInput();\n            }\n        });\n        const rightInput = input({\n            init: 0,\n            type: 'number',\n            min: -canvas.getWidth(),\n            max: maxWidth,\n            css: {width: '75px'},\n            callback: function(v) {\n                rightChanged = true;\n                updateInput();\n            }\n        });\n        const topInput = input({\n            init: 0,\n            type: 'number',\n            min: -canvas.getHeight(),\n            max: maxHeight,\n            css: {width: '75px', marginRight: '20px'},\n            callback: function(v) {\n                topChanged = true;\n                updateInput();\n            }\n        });\n        const bottomInput = input({\n            init: 0,\n            type: 'number',\n            min: -canvas.getHeight(),\n            max: maxHeight,\n            css: {width: '75px'},\n            callback: function(v) {\n                bottomChanged = true;\n                updateInput();\n            }\n        });\n\n        const labelStyle = {\n            display: 'inline-block',\n            width: '60px'\n        };\n        lrWrapper.append(\n            BB.el({content: LANG('filter-crop-left') + ':', css: labelStyle}),\n            leftInput,\n            BB.el({content: LANG('filter-crop-right') + ':', css: labelStyle}),\n            rightInput\n        );\n        tbWrapper.append(\n            BB.el({content: LANG('filter-crop-top') + ':', css: labelStyle}),\n            topInput,\n            BB.el({content: LANG('filter-crop-bottom') + ':', css: labelStyle}),\n            bottomInput\n        );\n\n        function updateInput() {\n            left = parseInt(leftInput.value);\n            right = parseInt(rightInput.value);\n            top = parseInt(topInput.value);\n            bottom = parseInt(bottomInput.value);\n            let newWidth = canvas.getWidth() + left + right;\n            let newHeight = canvas.getHeight() + top + bottom;\n\n            if (newWidth <= 0) {\n                if (leftChanged) {\n                    left = -canvas.getWidth() - right + 1;\n                    leftInput.value = '' + left;\n                }\n                if (rightChanged) {\n                    right = -canvas.getWidth() - left + 1;\n                    rightInput.value = '' + right;\n                }\n                newWidth = 1;\n            }\n            if (newWidth > maxWidth) {\n                if (leftChanged) {\n                    left = -canvas.getWidth() - right + maxWidth;\n                    leftInput.value = '' + left;\n                }\n                if (rightChanged) {\n                    right = -canvas.getWidth() - left + maxWidth;\n                    rightInput.value = '' + right;\n                }\n                newWidth = maxWidth;\n            }\n            if (newHeight <= 0) {\n                if (topChanged) {\n                    top = -canvas.getHeight() - bottom + 1;\n                    topInput.value = '' + top;\n                }\n                if (bottomChanged) {\n                    bottom = -canvas.getHeight() - top + 1;\n                    bottomInput.value = '' + bottom;\n                }\n                newHeight = 1;\n            }\n            if (newHeight > maxHeight) {\n                if (topChanged) {\n                    top = -canvas.getHeight() - bottom + maxHeight;\n                    topInput.value = '' + top;\n                }\n                if (bottomChanged) {\n                    bottom = -canvas.getHeight() - top + maxHeight;\n                    bottomInput.value = '' + bottom;\n                }\n                newHeight = maxHeight;\n            }\n            cropper.setTransform({\n                x: -left,\n                y: -top,\n                width: newWidth,\n                height: newHeight\n            });\n\n\n            leftChanged = false;\n            rightChanged = false;\n            topChanged = false;\n            bottomChanged = false;\n        }\n\n        let useRuleOfThirds = true;\n        let ruleOThirdsCheckbox = new Checkbox({\n            init: true,\n            label: LANG('filter-crop-rule-thirds'),\n            allowTab: true,\n            callback: function(b) {\n                useRuleOfThirds = b;\n                cropper.showThirds(useRuleOfThirds);\n            }\n        });\n        div.appendChild(BB.el({\n            css: {\n                clear: 'both'\n            }\n        }));\n\n        let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 0};\n        const colorOptionsArr = [\n            {r: 0, g: 0, b: 0, a: 0},\n            {r: 255, g: 255, b: 255, a: 1},\n            {r: 0, g: 0, b: 0, a: 1}\n        ];\n        colorOptionsArr.push({\n            r: params.currentColorRgb.r,\n            g: params.currentColorRgb.g,\n            b: params.currentColorRgb.b,\n            a: 1,\n        });\n        colorOptionsArr.push({\n            r: params.secondaryColorRgb.r,\n            g: params.secondaryColorRgb.g,\n            b: params.secondaryColorRgb.b,\n            a: 1,\n        });\n\n        const colorOptions = new ColorOptions({\n            label: LANG('filter-crop-fill'),\n            colorArr: colorOptionsArr,\n            onChange: function(rgbaObj) {\n                selectedRgbaObj = rgbaObj;\n                updateBg(rgbaObj);\n            }\n        });\n\n\n        const flexRow = BB.el({\n            css: {\n                display: 'flex',\n                justifyContent: 'space-between'\n            }\n        });\n        div.appendChild(flexRow);\n        flexRow.appendChild(ruleOThirdsCheckbox.getElement());\n        flexRow.appendChild(colorOptions.getElement());\n\n\n        // when input field changed, or dragging in preview finished\n        // adjusts the zoom\n        function update(transform) {\n            const fit = BB.fitInto(transform.width, transform.height, 260, 180, 1);\n            scale = fit.width / transform.width;\n\n            const offset = BB.centerWithin(340, 220, fit.width, fit.height);\n\n            tempCanvas.style.width = canvas.getWidth() * scale + \"px\";\n            tempCanvas.style.height = canvas.getHeight() * scale + \"px\";\n\n            offsetWrapper.style.left = (offset.x - transform.x * scale) + \"px\";\n            offsetWrapper.style.top = (offset.y - transform.y * scale) + \"px\";\n\n            left = parseInt('' + -transform.x);\n            top = parseInt('' + -transform.y);\n            right = parseInt('' + (transform.x + transform.width - canvas.getWidth()));\n            bottom = parseInt('' + (transform.y + transform.height - canvas.getHeight()));\n            leftInput.value = '' + left;\n            topInput.value = '' + top;\n            rightInput.value = '' + right;\n            bottomInput.value = '' + bottom;\n\n            BB.createCheckerDataUrl(parseInt('' + (50 * scale)), function (url) {\n                previewWrapper.style.background = \"url(\" + url + \")\";\n                if (selectedRgbaObj.a !== 0) {\n                    tempCanvas.style.background = \"url(\" + url + \")\";\n                }\n            });\n            previewWrapper.style.backgroundPosition = (offset.x) + \"px \" + (offset.y) + \"px\";\n\n            cropper.setScale(scale);\n        }\n\n        const previewWrapper = BB.el({\n            css: {\n                width: \"340px\",\n                marginTop: '10px',\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                position: \"relative\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                userSelect: 'none',\n                colorScheme: 'only light',\n                touchAction: 'none',\n            }\n        });\n        previewWrapper.oncontextmenu = function () {\n            return false;\n        };\n        const bgColorOverlay = BB.el({\n            css: {\n                position: 'absolute',\n                left: '0',\n                top: '0',\n                bottom: '0',\n                right: '0'\n            }\n        });\n        previewWrapper.appendChild(bgColorOverlay);\n\n        const offsetWrapper = document.createElement(\"div\");\n        offsetWrapper.style.position = \"absolute\";\n        offsetWrapper.style.left = \"0px\";\n        offsetWrapper.style.top = \"0px\";\n        previewWrapper.appendChild(offsetWrapper);\n\n\n        const canvasWrapper = BB.appendTextDiv(offsetWrapper, \"\");\n        canvasWrapper.appendChild(tempCanvas);\n        //tempCanvas.style.width = w + \"px\";\n        //tempCanvas.style.height = h + \"px\";\n        tempCanvas.style.boxShadow = \"0 0 3px 1px rgba(0,0,0,0.5)\";\n        tempCanvas.style.position = \"absolute\";\n        tempCanvas.style.left = \"0px\";\n        tempCanvas.style.top = \"0px\";\n\n        div.appendChild(previewWrapper);\n        const cropper = new Cropper({\n            x: 0,\n            y: 0,\n            width: canvas.getWidth(),\n            height: canvas.getHeight(),\n            scale: scale,\n            callback: update,\n            maxW: maxWidth,\n            maxH: maxHeight\n        });\n        update(cropper.getTransform());\n        offsetWrapper.appendChild(cropper.getElement());\n\n        function updateBg(rgbaObj) {\n\n            let borderColor;\n            if (rgbaObj.a === 0) {\n                borderColor = 'rgba(0,0,0,0.5)';\n                bgColorOverlay.style.background = '';\n                tempCanvas.style.background = '';\n            } else {\n                borderColor = (rgbaObj.r + rgbaObj.g + rgbaObj.b < 255 * 3 / 2) ? 'rgba(255,255,255,0.5)' : 'rgba(0,0,0,0.5)'\n                bgColorOverlay.style.background = BB.ColorConverter.toRgbStr(rgbaObj);\n\n                BB.createCheckerDataUrl(parseInt('' + (50 * scale)), function (url) {\n                    tempCanvas.style.background = \"url(\" + url + \")\";\n                });\n            }\n            tempCanvas.style.boxShadow = \"0 0 3px 1px \" + borderColor;\n        }\n\n        result.destroy = () => {\n            cropper.destroy();\n            ruleOThirdsCheckbox.destroy();\n        };\n        result.getInput = function () {\n            result.destroy();\n            return {\n                left: left,\n                right: right,\n                top: top,\n                bottom: bottom,\n                fillColor: selectedRgbaObj.a === 0 ? null : selectedRgbaObj\n            };\n        };\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        const canvas = params.canvas;\n        const history = params.history;\n        if (!canvas || !history || isNaN(params.input.left) || isNaN(params.input.right) || isNaN(params.input.top) || isNaN(params.input.bottom)) {\n            return false;\n        }\n        history.pause(true);\n        canvas.resizeCanvas(params.input);\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"cropExtend\"],\n            action: \"apply\",\n            params: [{\n                input: JSON.parse(JSON.stringify(params.input))\n            }]\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {Options} from '../ui/base-components/options';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const glCurves = {\n\n    getDialog(params: IFilterGetDialogParam) {\n\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (tempCanvas.width > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div,\n        };\n        let klCanvasPreview;\n\n        function finishInit() {\n\n            let previewFactor = w / context.canvas.width;\n            let brightness = 0, contrast = 0;\n\n            div.innerHTML = LANG('filter-curves-description') + \"<br/><br/>\";\n\n            let curves = {\n                r: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\n                g: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\n                b: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\n            };\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n\n            function update() {\n                try {\n                    glCanvas.draw(texture).curves(curves.r, curves.g, curves.b).update();\n                    if (klCanvasPreview) {\n                        klCanvasPreview.render();\n                    }\n                } catch(e) {\n                    (div as any).errorCallback(e);\n                }\n            }\n\n            let modeButtons;\n\n            function CurvesInput(p) {\n                let div = document.createElement(\"div\");\n                div.oncontextmenu = function () {\n                    return false;\n                };\n                div.style.position = \"relative\";\n                div.style.marginBottom = \"10px\";\n                let mode = \"All\";\n                let curves = p.curves;\n                modeButtons = new Options( {\n                    optionArr: [\n                        {\n                            id: 'All',\n                            label: LANG('filter-curves-all')\n                        },\n                        {\n                            id: 'Red',\n                            label: LANG('red')\n                        },\n                        {\n                            id: 'Green',\n                            label: LANG('green')\n                        },\n                        {\n                            id: 'Blue',\n                            label: LANG('blue')\n                        },\n                    ],\n                    initialId: 'All',\n                    onChange: function(id) {\n                        mode = id;\n                        if (mode === \"All\") {\n                            curves = {\n                                r: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\n                                g: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\n                                b: [[0, 0], [1 / 3, 1 / 3], [2 / 3, 2 / 3], [1, 1]],\n                            };\n                        }\n                        let curve = curves.r;\n                        if (mode === \"Green\") {\n                            curve = curves.g;\n                        }\n                        if (mode === \"Blue\") {\n                            curve = curves.b;\n                        }\n                        (p0 as any).setPos(0, areah - curve[0][1] * areah);\n                        (p1 as any).setPos(curve[1][0] * areaw, areah - curve[1][1] * areah);\n                        (p2 as any).setPos(curve[2][0] * areaw, areah - curve[2][1] * areah);\n                        (p3 as any).setPos(areaw, areah - curve[3][1] * areah);\n\n                        update();\n                    }\n                });\n                div.appendChild(modeButtons.getElement());\n\n                let curveArea = document.createElement(\"div\");\n                BB.css(curveArea, {\n                    position: 'relative',\n                    marginTop: '10px',\n                    colorScheme: 'only light',\n                })\n                div.appendChild(curveArea);\n\n                let areaw = 300, areah = 100;\n                let canvas = document.createElement(\"canvas\");\n                canvas.width = areaw;\n                canvas.height = areah;\n                BB.css(canvas, {\n                    background: \"#c6c6c6\",\n                    boxShadow: \"0 0 0 1px rgba(0,0,0,0.3)\"\n                });\n                let ctx = canvas.getContext(\"2d\");\n                curveArea.appendChild(canvas);\n\n                let points = {\n                    r: [],\n                    g: [],\n                    b: []\n                };\n\n                function fit(v) {\n                    return Math.max(0, Math.min(1, v));\n                }\n\n                function createPoint(x, y, callback, lock?) {\n                    let gripSize = 14;\n                    let internalY = y, internalX = x;\n                    let point = document.createElement(\"div\");\n                    BB.css(point, {\n                        position: \"absolute\",\n                        left: (x - gripSize / 2) + \"px\",\n                        top: (y - gripSize / 2) + \"px\",\n                        width: gripSize + \"px\",\n                        height: gripSize + \"px\",\n                        background: \"#fff\",\n                        cursor: \"move\",\n                        borderRadius: gripSize + \"px\",\n                        boxShadow: \"inset 0 0 0 2px #000\",\n                        userSelect: 'none',\n                        touchAction: 'none',\n                    });\n\n                    function update() {\n                        BB.css(point, {\n                            left: (x - gripSize / 2) + \"px\",\n                            top: (y - gripSize / 2) + \"px\"\n                        });\n                    }\n\n                    (point as any).pointerListener = new BB.PointerListener({\n                        target: point,\n                        maxPointers: 1,\n                        onPointer: function(event) {\n                            event.eventPreventDefault();\n                            if (event.type === 'pointerdown') {\n                                internalX = x;\n                                internalY = y;\n                            }\n                            if (event.button === 'left' && event.type === 'pointermove') {\n                                if (!lock) {\n                                    internalX += event.dX;\n                                }\n                                x = Math.max(0, Math.min(areaw, internalX));\n                                internalY += event.dY;\n                                y = Math.max(0, Math.min(areah, internalY));\n                                update();\n                                callback({\n                                    x: x,\n                                    y: y\n                                });\n                            }\n                        }\n                    });\n\n                    curveArea.appendChild(point);\n\n                    (point as any).setPos = function (newX, newY) {\n                        x = newX;\n                        y = newY;\n                        internalY = y;\n                        internalX = x;\n                        BB.css(point, {\n                            left: (x - gripSize / 2) + \"px\",\n                            top: (y - gripSize / 2) + \"px\"\n                        });\n                    };\n\n                    return point;\n                }\n\n                function updateControl(i, x, y) {\n                    if (mode === \"All\") {\n                        curves.r[i] = [fit(x / areaw), fit(1 - y / areah)];\n                        curves.g[i] = [fit(x / areaw), fit(1 - y / areah)];\n                        curves.b[i] = [fit(x / areaw), fit(1 - y / areah)];\n                    }\n                    if (mode === \"Red\") {\n                        curves.r[i] = [fit(x / areaw), fit(1 - y / areah)];\n                    }\n                    if (mode === \"Green\") {\n                        curves.g[i] = [fit(x / areaw), fit(1 - y / areah)];\n                    }\n                    if (mode === \"Blue\") {\n                        curves.b[i] = [fit(x / areaw), fit(1 - y / areah)];\n                    }\n                }\n\n                let p0 = createPoint(0, areah, function (val) {\n                    updateControl(0, val.x, val.y);\n                    update();\n                }, true);\n                let p1 = createPoint(areaw / 3, areah / 3 * 2, function (val) {\n                    updateControl(1, val.x, val.y);\n                    update();\n                });\n                let p2 = createPoint(areaw / 3 * 2, areah / 3, function (val) {\n                    updateControl(2, val.x, val.y);\n                    update();\n                });\n                let p3 = createPoint(areaw, 0, function (val) {\n                    updateControl(3, val.x, val.y);\n                    update();\n                }, true);\n\n\n                function update() {\n                    canvas.width = canvas.width;\n                    ctx = canvas.getContext(\"2d\");\n\n                    let outCurves = {\n                        r: [],\n                        g: [],\n                        b: []\n                    };\n                    for (let i = 0; i < curves.r.length; i++) {\n                        outCurves.r.push(curves.r[i]);\n                        outCurves.g.push(curves.g[i]);\n                        outCurves.b.push(curves.b[i]);\n                    }\n\n                    function drawCurve(curve) {\n                        ctx.beginPath();\n                        let spline = new BB.SplineInterpolator(curve);\n                        for (let i = 0; i < 100; i++) {\n                            let y = spline.interpolate(i / 100);\n                            y = Math.max(0, Math.min(1, y));\n\n                            if (i === 0) {\n                                ctx.moveTo(i / 100 * areaw, areah - y * areah);\n                            } else {\n                                ctx.lineTo(i / 100 * areaw, areah - y * areah);\n                            }\n                        }\n                        ctx.stroke();\n                    }\n\n                    ctx.save();\n                    if (mode === \"All\") {\n                        ctx.strokeStyle = \"black\";\n                        drawCurve(outCurves.r);\n                    } else {\n                        ctx.globalAlpha = 0.5;\n                        ctx.strokeStyle = \"red\";\n                        drawCurve(outCurves.r);\n                        ctx.strokeStyle = \"green\";\n                        drawCurve(outCurves.g);\n                        ctx.strokeStyle = \"blue\";\n                        drawCurve(outCurves.b);\n                    }\n                    ctx.restore();\n                    p.callback(outCurves);\n                }\n\n                update();\n\n\n                this.getDiv = function () {\n                    return div;\n                };\n                this.destroy = function() {\n                    (p0 as any).pointerListener.destroy();\n                    (p1 as any).pointerListener.destroy();\n                    (p2 as any).pointerListener.destroy();\n                    (p3 as any).pointerListener.destroy();\n                };\n            }\n\n            let input = new CurvesInput({\n                curves: curves,\n                callback: function (val) {\n                    curves = val;\n                    update();\n                }\n            });\n\n\n            div.appendChild(input.getDiv());\n\n\n\n            let previewWrapper = document.createElement(\"div\");\n            BB.css(previewWrapper, {\n                width: \"340px\",\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    previewLayerArr.push({\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + w),\n                height: parseInt('' + h),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + w) + 'px',\n                    height: parseInt('' + h) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n\n            div.appendChild(previewWrapper);\n\n            result.destroy = () => {\n                input.destroy();\n                texture.destroy();\n                modeButtons.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    curves: curves\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1);\n\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let curves = params.input.curves;\n        let history = params.history;\n        if (!context || curves === null || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).curves(curves.r, curves.g, curves.b).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"glCurves\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n\n        return true;\n    }\n\n\n};","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"grSoY\");","import {BB} from '../../bb/bb';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\n// @ts-ignore\nimport checkmarkImg from 'url:~/src/app/img/ui/checkmark.svg';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer, IMixMode} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const flip = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n        let isHorizontal = true;\n        let isVertical = false;\n        let doFlipCanvas = true;\n        div.innerHTML = LANG('filter-flip-description') + \"<br/><br/>\";\n\n\n        let horizontalCheckbox = new Checkbox({\n            init: isHorizontal,\n            label: LANG('filter-flip-horizontal') + ' ⟷',\n            allowTab: true,\n            callback: function(v) {\n                isHorizontal = v;\n                updatePreview();\n            },\n            css: {\n                marginBottom: '10px'\n            }\n        });\n        let verticalCheckbox = new Checkbox({\n            init: isVertical,\n            label: LANG('filter-flip-vertical') + ' ↕',\n            allowTab: true,\n            callback: function(v) {\n                isVertical = v;\n                updatePreview();\n            },\n            css: {\n                marginBottom: '10px'\n            }\n        });\n        div.appendChild(horizontalCheckbox.getElement());\n        div.appendChild(verticalCheckbox.getElement());\n\n\n\n\n\n        let fcOption = document.createElement(\"div\");\n        BB.setEventListener(fcOption, 'onpointerdown', function () {\n            return false;\n        });\n        fcOption.textContent = LANG('filter-flip-image');\n        fcOption.style.width = \"150px\";\n        fcOption.style.height = \"30px\";\n        fcOption.style.paddingTop = \"10px\";\n        fcOption.style.textAlign = \"center\";\n        fcOption.style.cssFloat = \"left\";\n        fcOption.style.paddingBottom = \"0px\";\n        fcOption.style.borderTopLeftRadius = \"10px\";\n        fcOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\n        fcOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\n        fcOption.style.backgroundSize = '8%';\n        fcOption.style.backgroundColor = \"#9e9e9e\";\n\n        let flOption = document.createElement(\"div\");\n        BB.setEventListener(flOption, 'onpointerdown', function () {\n            return false;\n        });\n        flOption.textContent = LANG('filter-flip-layer');\n        flOption.style.width = \"150px\";\n        flOption.style.height = \"30px\";\n        flOption.style.paddingTop = \"10px\";\n        flOption.style.textAlign = \"center\";\n        flOption.style.cssFloat = \"left\";\n        flOption.style.paddingBottom = \"0px\";\n        flOption.style.borderTopRightRadius = \"10px\";\n        flOption.style.cursor = \"pointer\";\n        flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n        flOption.style.backgroundSize = '8%';\n\n        BB.setEventListener(fcOption, 'onpointerover', function () {\n            if (doFlipCanvas === false)\n                fcOption.style.backgroundColor = \"#ccc\";\n        });\n        BB.setEventListener(fcOption, 'onpointerout', function () {\n            if (doFlipCanvas === false)\n                fcOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n        });\n        BB.setEventListener(flOption, 'onpointerover', function () {\n            if (doFlipCanvas === true)\n                flOption.style.backgroundColor = \"#ccc\";\n        });\n        BB.setEventListener(flOption, 'onpointerout', function () {\n            if (doFlipCanvas === true)\n                flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n        });\n\n        fcOption.onclick = function () {\n            doFlipCanvas = true;\n\n            flOption.style.background = \"\";\n            flOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n            flOption.style.boxShadow = \"\";\n            flOption.style.cursor = \"pointer\";\n\n            fcOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\n            fcOption.style.backgroundSize = '8%';\n            fcOption.style.backgroundColor = \"#9e9e9e\";\n            fcOption.style.cursor = \"default\";\n            fcOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\n\n            updatePreview();\n        };\n        flOption.onclick = function () {\n            doFlipCanvas = false;\n\n            fcOption.style.background = \"\";\n            fcOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n            fcOption.style.boxShadow = \"\";\n            fcOption.style.cursor = \"pointer\";\n\n            flOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\n            flOption.style.backgroundSize = '8%';\n            flOption.style.backgroundColor = \"#9e9e9e\";\n            flOption.style.cursor = \"default\";\n            flOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\n\n            updatePreview();\n        };\n\n        let optionWrapper = document.createElement(\"div\");\n        optionWrapper.appendChild(fcOption);\n        optionWrapper.appendChild(flOption);\n        div.appendChild(optionWrapper);\n\n\n        let previewWrapper = document.createElement(\"div\");\n        BB.css(previewWrapper, {\n            width: \"340px\",\n            marginLeft: \"-20px\",\n            height: \"220px\",\n            backgroundColor: \"#9e9e9e\",\n            marginTop: \"10px\",\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n            overflow: \"hidden\",\n            position: \"relative\",\n            userSelect: 'none',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            colorScheme: 'only light',\n        });\n\n        let previewLayer: IKlBasicLayer = {\n            image: BB.canvas(Math.round(w), Math.round(h)),\n            opacity: 1,\n            mixModeStr: 'source-over' as IMixMode,\n        };\n        let klCanvasPreview = new KlCanvasPreview({\n            width: Math.round(w),\n            height: Math.round(h),\n            layers: [previewLayer]\n        });\n\n        let previewInnerWrapper = BB.el({\n            css: {\n                position: 'relative',\n                boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                width: parseInt('' + w) + 'px',\n                height: parseInt('' + h) + 'px'\n            }\n        });\n        previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n        previewWrapper.appendChild(previewInnerWrapper);\n\n        function updatePreview() {\n            let ctx = (previewLayer.image as HTMLCanvasElement).getContext('2d');\n            ctx.save();\n            ctx.clearRect(0, 0, previewLayer.image.width, previewLayer.image.height);\n\n            if (doFlipCanvas) {\n                if (isHorizontal) {\n                    ctx.translate(previewLayer.image.width, 0);\n                    ctx.scale(-1, 1);\n                }\n                if (isVertical) {\n                    ctx.translate(0, previewLayer.image.height);\n                    ctx.scale(1, -1);\n                }\n            }\n\n            for (let i = 0; i < layers.length; i++) {\n                ctx.save();\n                if (!doFlipCanvas && selectedLayerIndex === i) {\n                    if (isHorizontal) {\n                        ctx.translate(previewLayer.image.width, 0);\n                        ctx.scale(-1, 1);\n                    }\n                    if (isVertical) {\n                        ctx.translate(0, previewLayer.image.height);\n                        ctx.scale(1, -1);\n                    }\n                }\n                if (ctx.canvas.width > layers[i].context.canvas.width) {\n                    ctx.imageSmoothingEnabled = false;\n                }\n                ctx.globalAlpha = layers[i].opacity;\n                ctx.globalCompositeOperation = layers[i].mixModeStr;\n                ctx.drawImage(layers[i].context.canvas, 0, 0, previewLayer.image.width, previewLayer.image.height);\n                ctx.restore();\n            }\n            klCanvasPreview.render();\n            ctx.restore();\n        }\n        setTimeout(updatePreview, 0);\n\n\n        div.appendChild(previewWrapper);\n        result.destroy = () => {\n            horizontalCheckbox.destroy();\n            verticalCheckbox.destroy();\n        };\n        result.getInput = function () {\n            result.destroy();\n            return {\n                horizontal: isHorizontal,\n                vertical: isVertical,\n                flipCanvas: doFlipCanvas\n            };\n        };\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let canvas = params.canvas;\n        let history = params.history;\n        let horizontal = params.input.horizontal;\n        let vertical = params.input.vertical;\n        let flipCanvas = params.input.flipCanvas;\n        if (!context || !canvas || !history) {\n            return false;\n        }\n\n        history.pause(true);\n        canvas.flip(horizontal, vertical, flipCanvas ? null : canvas.getLayerIndex(context.canvas));\n        history.pause(false);\n\n        history.push({\n            tool: [\"filter\", \"flip\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    },\n\n};","import {BB} from '../../bb/bb';\nimport {eventResMs} from './filters-consts';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const glHueSaturation = {\n\n    getDialog(params: IFilterGetDialogParam) {\n\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height,280, 200,  1);\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (tempCanvas.width > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n\n        function finishInit() {\n            let hue = 0, Saturation = 0;\n            div.innerHTML = LANG('filter-hue-sat-description') + \"<br/><br/>\";\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n\n            let hueSlider = new KlSlider({\n                label: LANG('filter-hue-sat-hue'),\n                width: 300,\n                height: 30,\n                min: -100,\n                max: 100,\n                initValue: hue * 100,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    hue = val / 100;\n                    glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\n                    klCanvasPreview.render();\n                }\n            });\n            let saturationSlider = new KlSlider({\n                label: LANG('filter-hue-sat-saturation'),\n                width: 300,\n                height: 30,\n                min: 0,\n                max: 100,\n                initValue: (Saturation + 1) * 50,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    Saturation = val / 50 - 1;\n                    glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\n                    klCanvasPreview.render();\n                }\n            });\n            hueSlider.getElement().style.marginBottom = \"10px\";\n            div.appendChild(hueSlider.getElement());\n            div.appendChild(saturationSlider.getElement());\n\n\n            let previewWrapper = document.createElement(\"div\");\n            BB.css(previewWrapper, {\n                width: \"340px\",\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    previewLayerArr.push({\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            let klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + w),\n                height: parseInt('' + h),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + w) + 'px',\n                    height: parseInt('' + h) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n\n            div.appendChild(previewWrapper);\n\n            try {\n                glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\n                klCanvasPreview.render();\n            } catch(e) {\n                (div as any).errorCallback(e);\n            }\n\n            result.destroy = () => {\n                hueSlider.destroy();\n                saturationSlider.destroy();\n                texture.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    hue: hue,\n                    Saturation: Saturation\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1);\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let hue = params.input.hue;\n        let history = params.history;\n        let Saturation = params.input.Saturation;\n        if (!context || hue === null || Saturation === null || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).hueSaturation(hue, Saturation).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"glHueSaturation\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply} from '../kl.types';\n\nexport const invert = {\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let history = params.history;\n        if (!context || !history) {\n            return false;\n        }\n        history.pause(true);\n\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false;\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).invert().update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"invert\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\n// @ts-ignore\nimport checkmarkImg from 'url:~/src/app/img/ui/checkmark.svg';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const glPerspective = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let isSmall = window.innerWidth < 550;\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, isSmall ? 280 : 490, isSmall ? 200 : 240, 1);\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\n        let w = Math.min(displayW, context.canvas.width);\n        let h = Math.min(displayH, context.canvas.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (w > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n        let displayPreviewFactor = displayW / context.canvas.width;\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n        if (!isSmall) {\n            result.width = 500;\n        }\n\n        let pointerListenerArr = [];\n\n        function finishInit() {\n            div.innerHTML = LANG('filter-perspective-description') + \"<br/><br/>\";\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n            let ba, bb, bc, bd; //before\n            let aa, ab, ac, ad; //after\n            function update() {\n                try {\n                    glCanvas.draw(texture).perspective(\n                        [ba.x, ba.y, bb.x, bb.y, bc.x, bc.y, bd.x, bd.y].map((item, i) => {\n                            if (i % 2 === 0) {\n                                return item / displayW * w;\n                            } else {\n                                return item / displayH * h;\n                            }\n                        }),\n                        [aa.x, aa.y, ab.x, ab.y, ac.x, ac.y, ad.x, ad.y].map((item, i) => {\n                            if (i % 2 === 0) {\n                                return item / displayW * w;\n                            } else {\n                                return item / displayH * h;\n                            }\n                        })\n                    ).update();\n                    klCanvasPreview.render();\n                } catch(e) {\n                    (div as any).errorCallback(e);\n                }\n            }\n\n            function nob(x, y, callback?) {\n                let nobSize = 14;\n                let div = document.createElement(\"div\");\n                (div as any).x = x;\n                (div as any).y = y;\n                BB.css(div, {\n                    width: nobSize + \"px\",\n                    height: nobSize + \"px\",\n                    backgroundColor: \"#fff\",\n                    boxShadow: \"inset 0 0 0 2px #000\",\n                    borderRadius: nobSize + \"px\",\n                    position: \"absolute\",\n                    cursor: \"move\",\n                    left: ((div as any).x - nobSize / 2) + \"px\",\n                    top: ((div as any).y - nobSize / 2) + \"px\",\n                    userSelect: 'none',\n                    touchAction: 'none',\n                });\n\n                let pointerListener = new BB.PointerListener({\n                    target: div,\n                    maxPointers: 1,\n                    onPointer: function(event) {\n                        event.eventPreventDefault();\n                        if (event.button === 'left' && event.type === 'pointermove') {\n                            (div as any).x += event.dX;\n                            (div as any).y += event.dY;\n                            div.style.left = ((div as any).x - nobSize / 2) + \"px\";\n                            div.style.top = ((div as any).y - nobSize / 2) + \"px\";\n                            if (callback) {\n                                callback();\n                            }\n                            update();\n                        }\n                    }\n                });\n                (div as any).copy = function (p) {\n                    (div as any).x = p.x;\n                    (div as any).y = p.y;\n                    div.style.left = ((div as any).x - nobSize / 2) + \"px\";\n                    div.style.top = ((div as any).y - nobSize / 2) + \"px\";\n                };\n                pointerListenerArr.push(pointerListener);\n                return div;\n            }\n\n            function updateAfter() {\n                aa.copy(ba);\n                ab.copy(bb);\n                ac.copy(bc);\n                ad.copy(bd);\n            }\n\n            ba = nob(0, 0, updateAfter);\n            bb = nob(displayW, 0, updateAfter);\n            bc = nob(displayW, displayH, updateAfter);\n            bd = nob(0, displayH, updateAfter);\n            aa = nob(0, 0);\n            ab = nob(displayW, 0);\n            ac = nob(displayW, displayH);\n            ad = nob(0, displayH);\n\n            let before = false;\n            let beforeOption = document.createElement(\"div\");\n            BB.setEventListener(beforeOption, 'onpointerdown', function () {\n                return false;\n            });\n            beforeOption.textContent = LANG('filter-perspective-before');\n            beforeOption.style.width = \"150px\";\n            beforeOption.style.height = \"30px\";\n            beforeOption.style.marginLeft = isSmall ? '0' : \"100px\";\n            beforeOption.style.paddingTop = \"10px\";\n            beforeOption.style.textAlign = \"center\";\n            beforeOption.style.cssFloat = \"left\";\n            beforeOption.style.paddingBottom = \"0px\";\n            beforeOption.style.borderTopLeftRadius = \"10px\";\n            beforeOption.style.cursor = \"pointer\";\n            beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n            beforeOption.style.backgroundSize = '8%';\n\n            let afterOption = document.createElement(\"div\");\n            BB.setEventListener(afterOption, 'onpointerdown', function () {\n                return false;\n            });\n            afterOption.textContent = LANG('filter-perspective-after');\n            afterOption.style.width = \"150px\";\n            afterOption.style.height = \"30px\";\n            afterOption.style.paddingTop = \"10px\";\n            afterOption.style.textAlign = \"center\";\n            afterOption.style.cssFloat = \"left\";\n            afterOption.style.paddingBottom = \"0px\";\n            afterOption.style.borderTopRightRadius = \"10px\";\n            afterOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\n            afterOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\n            afterOption.style.backgroundSize = '8%';\n            afterOption.style.backgroundColor = \"#9e9e9e\";\n\n\n            BB.setEventListener(beforeOption, 'onpointerover', function () {\n                if (before === false)\n                    beforeOption.style.backgroundColor = \"#ccc\";\n            });\n            BB.setEventListener(beforeOption, 'onpointerout', function () {\n                if (before === false)\n                    beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n            });\n            BB.setEventListener(afterOption, 'onpointerover', function () {\n                if (before === true)\n                    afterOption.style.backgroundColor = \"#ccc\";\n            });\n            BB.setEventListener(afterOption, 'onpointerout', function () {\n                if (before === true)\n                    afterOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n            });\n\n            beforeOption.onclick = function () {\n\n                beforeOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\n                beforeOption.style.backgroundSize = '8%';\n                beforeOption.style.backgroundColor = \"#9e9e9e\";\n                beforeOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\n                beforeOption.style.cursor = \"default\";\n\n                afterOption.style.background = \"\";\n                afterOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n                afterOption.style.boxShadow = \"\";\n                afterOption.style.cursor = \"pointer\";\n\n                aa.style.display = \"none\";\n                ab.style.display = \"none\";\n                ac.style.display = \"none\";\n                ad.style.display = \"none\";\n\n                ba.style.display = \"block\";\n                bb.style.display = \"block\";\n                bc.style.display = \"block\";\n                bd.style.display = \"block\";\n                ba.copy(aa);\n                bb.copy(ab);\n                bc.copy(ac);\n                bd.copy(ad);\n                before = true;\n                update();\n            };\n            afterOption.onclick = function () {\n                before = false;\n\n                afterOption.style.background = \"url(\" + checkmarkImg + \") no-repeat 12px 16px\";\n                afterOption.style.backgroundSize = '8%';\n                afterOption.style.backgroundColor = \"#9e9e9e\";\n                afterOption.style.boxShadow = \"inset 0px 5px 10px rgba(0,0,0,0.5)\";\n                afterOption.style.cursor = \"default\";\n\n                beforeOption.style.background = \"\";\n                beforeOption.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n                beforeOption.style.boxShadow = \"\";\n                beforeOption.style.cursor = \"pointer\";\n\n                ba.style.display = \"none\";\n                bb.style.display = \"none\";\n                bc.style.display = \"none\";\n                bd.style.display = \"none\";\n\n                aa.style.display = \"block\";\n                ab.style.display = \"block\";\n                ac.style.display = \"block\";\n                ad.style.display = \"block\";\n                aa.copy(ba);\n                ab.copy(bb);\n                ac.copy(bc);\n                ad.copy(bd);\n            };\n\n            let optionWrapper = document.createElement(\"div\");\n            optionWrapper.appendChild(beforeOption);\n            optionWrapper.appendChild(afterOption);\n            div.appendChild(optionWrapper);\n\n\n            let previewWrapper = document.createElement(\"div\");\n            previewWrapper.oncontextmenu = function () {\n                return false;\n            };\n            BB.css(previewWrapper, {\n                width: isSmall ? '340px' : '540px',\n                marginLeft: \"-20px\",\n                height: isSmall ? '260px' : '300px',\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    let canvas = i === selectedLayerIndex ? glCanvas : layers[i].context.canvas;\n                    previewLayerArr.push({\n                        image: canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            let klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + displayW),\n                height: parseInt('' + displayH),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + displayW) + 'px',\n                    height: parseInt('' + displayH) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n            previewInnerWrapper.appendChild(aa);\n            previewInnerWrapper.appendChild(ab);\n            previewInnerWrapper.appendChild(ac);\n            previewInnerWrapper.appendChild(ad);\n\n            ba.style.display = \"none\";\n            bb.style.display = \"none\";\n            bc.style.display = \"none\";\n            bd.style.display = \"none\";\n            previewInnerWrapper.appendChild(ba);\n            previewInnerWrapper.appendChild(bb);\n            previewInnerWrapper.appendChild(bc);\n            previewInnerWrapper.appendChild(bd);\n\n\n            div.appendChild(previewWrapper);\n            update();\n            result.destroy = () => {\n                for (let i = 0; i < pointerListenerArr.length; i++) {\n                    pointerListenerArr[i].destroy();\n                }\n                texture.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    before: [\n                        ba.x / displayPreviewFactor,\n                        ba.y / displayPreviewFactor,\n\n                        bb.x / displayPreviewFactor,\n                        bb.y / displayPreviewFactor,\n\n                        bc.x / displayPreviewFactor,\n                        bc.y / displayPreviewFactor,\n\n                        bd.x / displayPreviewFactor,\n                        bd.y / displayPreviewFactor,\n                    ],\n                    after: [\n                        aa.x / displayPreviewFactor,\n                        aa.y / displayPreviewFactor,\n\n                        ab.x / displayPreviewFactor,\n                        ab.y / displayPreviewFactor,\n\n                        ac.x / displayPreviewFactor,\n                        ac.y / displayPreviewFactor,\n\n                        ad.x / displayPreviewFactor,\n                        ad.y / displayPreviewFactor,\n                    ]\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1);\n\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let history = params.history;\n        let before = params.input.before;\n        let after = params.input.after;\n        if (!context || !before || !after || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        let w = context.canvas.width;\n        let h = context.canvas.height;\n        glCanvas.draw(texture).perspective(before, after).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"glPerspective\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"2xc61\");","import {BB} from '../../bb/bb';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {Select} from '../ui/base-components/select';\n// @ts-ignore\nimport constrainImg from 'url:~/src/app/img/ui/constrain.svg';\nimport {IFilterApply, IFilterGetDialogParam} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const resize = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        //BB.centerWithin\n        let canvas = params.canvas;\n        if (!canvas)\n            return false;\n\n        let fit = BB.fitInto( canvas.getWidth(), canvas.getHeight(), 280, 200,1);\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n\n        let previewFactor = w / canvas.getWidth();\n        let tempCanvas = canvas.getCompleteCanvas(1);\n\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n        let newWidth = canvas.getWidth(), newHeight = canvas.getHeight();\n\n        div.innerHTML = LANG('filter-resize-description') + \"<br/><br/>\";\n\n\n        let maxWidth = params.maxWidth, maxHeight = params.maxHeight;\n\n        let widthWrapper = BB.el({\n            css: {\n                width: '150px',\n                height: '35px',\n                lineHeight: '30px',\n            }\n        });\n        let heightWrapper = BB.el({\n            css: {\n                width: '150px',\n                height: '35px',\n                lineHeight: '30px',\n            }\n        });\n        let widthInput = BB.el({\n            tagName: 'input',\n            css: {\n                cssFloat: 'right',\n                width: '90px',\n            },\n            custom: {\n                type: 'number',\n                min: '1',\n                max: '' + maxWidth,\n                value: '' + canvas.getWidth(),\n            }\n        }) as HTMLInputElement;\n        let heightInput = BB.el({\n            tagName: 'input',\n            css: {\n                cssFloat: 'right',\n                width: '90px',\n            },\n            custom: {\n                type: 'number',\n                min: '1',\n                max: '' + maxHeight,\n                value: '' + canvas.getHeight(),\n            }\n        }) as HTMLInputElement;\n        widthInput.onclick = function () {\n            (this as any).focus();\n            widthChanged = true;\n            update();\n        };\n        heightInput.onclick = function () {\n            (this as any).focus();\n            heightChanged = true;\n            update();\n        };\n        widthInput.onchange = function () {\n            widthChanged = true;\n            update();\n        };\n        heightInput.onchange = function () {\n            heightChanged = true;\n            update();\n        };\n        widthWrapper.append(LANG('width') + \": \", widthInput);\n        heightWrapper.append(LANG('height') + \": \", heightInput);\n        let inputWrapper = BB.el({\n            css: {\n                background: \"url(\" + constrainImg + \") no-repeat 140px 5px\",\n                backgroundSize: '50px 52px',\n            }\n        });\n        inputWrapper.append(widthWrapper, heightWrapper);\n        div.appendChild(inputWrapper);\n\n        //contrain checkbox\n        let heightChanged = false, widthChanged = false;\n        let ratio = canvas.getWidth() / canvas.getHeight();\n\n        function updateConstrain() {\n            if (isConstrained) {\n                widthInput.value = '' + canvas.getWidth();\n                heightInput.value = '' + canvas.getHeight();\n                inputWrapper.style.background = \"url(\" + constrainImg + \") no-repeat 140px 5px\";\n                inputWrapper.style.backgroundSize = '50px 52px';\n                update();\n            } else {\n                inputWrapper.style.background = \"\";\n            }\n        }\n\n        let isConstrained = true;\n        let constrainCheckbox = new Checkbox({\n            init: true,\n            label: LANG('constrain-proportions'),\n            allowTab: true,\n            callback: function(b) {\n                isConstrained = b;\n                updateConstrain();\n            }\n        });\n        div.appendChild(BB.el({\n            css: {\n                clear: 'both'\n            }\n        }));\n\n\n        let algorithmSelect = new Select({\n            isFocusable: true,\n            optionArr: [\n                ['smooth', LANG('algorithm-smooth')],\n                ['pixelated', LANG('algorithm-pixelated')]\n            ],\n            title: LANG('scaling-algorithm'),\n            initValue: 'smooth',\n            onChange: function() {\n                update();\n            },\n        });\n\n        let secondRowElement = BB.el({\n            parent: div,\n            css: {\n                display: 'flex',\n                justifyContent: 'space-between'\n            }\n        });\n        secondRowElement.appendChild(constrainCheckbox.getElement());\n        secondRowElement.appendChild(algorithmSelect.getElement());\n\n        let previewCanvas = BB.canvas(w, h);\n        previewCanvas.style.imageRendering = 'pixelated';\n\n\n        let previewCtx = previewCanvas.getContext('2d');\n\n\n        function draw() {\n            if (algorithmSelect.getValue() === 'smooth') {\n                previewCanvas.style.imageRendering = previewFactor > 1 ? 'pixelated' : '';\n\n                previewCanvas.width = canvas.getWidth();\n                previewCanvas.height = canvas.getHeight();\n\n                previewCtx.save();\n                previewCtx.imageSmoothingQuality = 'high';\n                previewCtx.drawImage(tempCanvas, 0, 0);\n                BB.resizeCanvas(previewCanvas, newWidth, newHeight);\n                previewCtx.restore();\n\n            } else {\n                previewCanvas.style.imageRendering = 'pixelated';\n\n                previewCanvas.width = newWidth;\n                previewCanvas.height = newHeight;\n                previewCtx.save();\n                previewCtx.imageSmoothingEnabled = false;\n                previewCtx.drawImage(tempCanvas, 0, 0, previewCanvas.width, previewCanvas.height);\n                previewCtx.restore();\n            }\n\n        }\n\n        function update() {\n            if ((widthInput.value.length === 0 && widthChanged) || (heightInput.value.length === 0 && heightChanged)) {\n                heightChanged = false;\n                widthChanged = false;\n                return;\n            }\n            widthInput.value = '' + Math.max(1, parseInt(widthInput.value));\n            heightInput.value = '' + Math.max(1, parseInt(heightInput.value));\n            if (isConstrained) {\n                if (heightChanged) {\n                    widthInput.value = '' + parseInt('' + (parseInt(heightInput.value) * ratio));\n                }\n                if (widthChanged) {\n                    heightInput.value = '' + parseInt('' + (parseInt(widthInput.value) / ratio));\n                }\n\n                if (parseInt(widthInput.value) > maxWidth || parseInt(heightInput.value) > maxHeight) {\n                    let fit = BB.fitInto(parseInt(widthInput.value), parseInt(heightInput.value), maxWidth, maxHeight, 1);\n                    widthInput.value = '' + parseInt('' + fit.width);\n                    heightInput.value = '' + parseInt('' + fit.height);\n                }\n            }\n\n            if (parseInt(widthInput.value) > maxWidth) {\n                widthInput.value = '' + maxWidth;\n            }\n            if (parseInt(heightInput.value) > maxHeight) {\n                heightInput.value = '' + maxHeight;\n            }\n\n            heightChanged = false;\n            widthChanged = false;\n\n            newWidth = parseInt(widthInput.value);\n            newHeight = parseInt(heightInput.value);\n\n            let preview = BB.fitInto(newWidth, newHeight, 280, 200, 1);\n            let previewW = parseInt('' + preview.width), previewH = parseInt('' + preview.height);\n            previewFactor = previewW / newWidth;\n\n            let offset = BB.centerWithin(340, 220, previewW, previewH);\n\n            draw();\n\n            previewCanvas.style.width = Math.max(1, previewW) + \"px\";\n            previewCanvas.style.height = Math.max(1, previewH) + \"px\";\n            canvasWrapper.style.left = offset.x + \"px\";\n            canvasWrapper.style.top = offset.y + \"px\";\n            canvasWrapper.style.width = Math.max(1, previewW) + \"px\";\n            canvasWrapper.style.height = Math.max(1, previewH) + \"px\";\n        }\n\n        let previewWrapper = document.createElement(\"div\");\n        BB.css(previewWrapper, {\n            width: \"340px\",\n            marginLeft: \"-20px\",\n            height: \"220px\",\n            display: \"table\",\n            backgroundColor: \"#9e9e9e\",\n            marginTop: \"10px\",\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n            position: \"relative\",\n            userSelect: 'none',\n            colorScheme: 'only light',\n        });\n\n\n        let canvasWrapper = BB.appendTextDiv(previewWrapper, \"\");\n        canvasWrapper.appendChild(previewCanvas);\n        canvasWrapper.style.width = w + \"px\";\n        canvasWrapper.style.height = h + \"px\";\n        canvasWrapper.style.position = \"absolute\";\n        canvasWrapper.style.overflow = \"hidden\";\n        canvasWrapper.style.boxShadow = \"0 0 5px rgba(0,0,0,0.8)\";\n        canvasWrapper.style.overflow = \"hidden\";\n        BB.createCheckerDataUrl(8, function (url) {\n            previewWrapper.style.background = \"url(\" + url + \")\";\n        });\n\n        div.appendChild(previewWrapper);\n        update();\n\n        result.destroy = () => {\n            constrainCheckbox.destroy();\n        };\n        result.getInput = function () {\n            result.destroy();\n            return {\n                width: newWidth,\n                height: newHeight,\n                algorithm: algorithmSelect.getValue()\n            };\n        };\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let canvas = params.canvas;\n        let history = params.history;\n        let width = params.input.width;\n        let height = params.input.height;\n        let algorithm = params.input.algorithm;\n        if (!canvas || !history) {\n            return false;\n        }\n        history.pause(true);\n        canvas.resize(width, height, algorithm);\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"resize\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {IFilterApply, IFilterGetDialogParam} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const rotate = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let canvas = params.canvas;\n        if (!canvas)\n            return false;\n\n        let fit = BB.fitInto(canvas.getWidth(), canvas.getHeight(), 280, 200, 1);\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n\n        let previewFactor = w / canvas.getWidth();\n        let tempCanvas = BB.canvas(w, h);\n        tempCanvas.style.display = 'block';\n        tempCanvas.getContext(\"2d\").drawImage(canvas.getCompleteCanvas(previewFactor), 0, 0, w, h);\n\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n        let deg = 0;\n        div.innerHTML = LANG('filter-rotate-description') + \"<br/><br/>\";\n\n        let first = true;\n\n        function update() {\n            (canvasWrapper.style as any).WebkitTransform = \"rotate(\" + deg + \"deg)\";\n            (canvasWrapper.style as any).MozTransform = \"rotate(\" + deg + \"deg)\";\n            (canvasWrapper.style as any).OTransform = \"rotate(\" + deg + \"deg)\";\n            (canvasWrapper.style as any).msTransform = \"rotate(\" + deg + \"deg)\";\n            if (Math.abs(deg % 180) === 90) {\n                //height has to fit width because of rotation\n                let fit = BB.fitInto(h, w, 280, 200, 1);\n                let scale = parseInt('' + fit.height) / w;\n                (canvasWrapper.style as any).WebkitTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\n                (canvasWrapper.style as any).MozTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\n                (canvasWrapper.style as any).OTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\n                (canvasWrapper.style as any).msTransform = \"rotate(\" + deg + \"deg) scale(\" + scale + \")\";\n            }\n        }\n\n        let btnPlus = document.createElement(\"button\");\n        btnPlus.innerHTML = \"<span style='font-size: 1.3em'>⟳</span> 90°\";\n        let btnMinus = document.createElement(\"button\");\n        btnMinus.innerHTML = \"<span style='font-size: 1.3em'>⟲</span> 90°\";\n        btnMinus.style.marginRight = '5px';\n\n\n        btnPlus.onclick = function () {\n            deg += 90;\n            update();\n        };\n        btnMinus.onclick = function () {\n            deg -= 90;\n            update();\n        };\n\n        div.appendChild(btnMinus);\n        div.appendChild(btnPlus);\n\n        let previewWrapper = document.createElement(\"div\");\n        BB.css(previewWrapper, {\n            width: \"340px\",\n            marginLeft: \"-20px\",\n            height: \"220px\",\n            display: \"table\",\n            backgroundColor: \"#9e9e9e\",\n            marginTop: \"10px\",\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n            overflow: \"hidden\",\n            position: \"relative\",\n            userSelect: 'none',\n            colorScheme: 'only light',\n        });\n\n        let previewcell = document.createElement(\"div\");\n        previewcell.style.display = \"table-cell\";\n        previewcell.style.verticalAlign = \"middle\";\n        let canvasWrapper = BB.appendTextDiv(previewcell, \"\");\n        canvasWrapper.appendChild(tempCanvas);\n        previewWrapper.appendChild(previewcell);\n        canvasWrapper.style.width = w + \"px\";\n        canvasWrapper.style.height = h + \"px\";\n        canvasWrapper.style.marginLeft = \"auto\";\n        canvasWrapper.style.marginRight = \"auto\";\n        canvasWrapper.style.boxShadow = \"0 0 5px rgba(0,0,0,0.8)\";\n        canvasWrapper.style.overflow = \"hidden\";\n        BB.createCheckerDataUrl(4, function (url) {\n            canvasWrapper.style.background = \"url(\" + url + \")\";\n        });\n        canvasWrapper.style.transition = \"all 0.2s ease-out\";\n\n        div.appendChild(previewWrapper);\n        update();\n\n        result.getInput = function () {\n            return {\n                deg: deg\n            };\n        };\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let canvas = params.canvas;\n        let history = params.history;\n        let deg = params.input.deg;\n        if (!canvas || !history)\n            return false;\n        history.pause(true);\n        canvas.rotate(deg);\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"rotate\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {eventResMs} from './filters-consts';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const glTiltShift = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\n        let w = Math.min(displayW, context.canvas.width);\n        let h = Math.min(displayH, context.canvas.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (w > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n        let previewFactor = w / context.canvas.width;\n        let displayPreviewFactor = displayW / context.canvas.width;\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n\n        let pointerListenerArr = [];\n\n        function finishInit() {\n            let blur = 20, gradient = 200;\n            div.innerHTML = LANG('filter-tilt-shift-description') + \"<br/><br/>\";\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n            let fa, fb; // focus line\n            function update() {\n                try {\n                    glCanvas.draw(texture).tiltShift(\n                        fa.x / displayPreviewFactor * previewFactor,\n                        fa.y / displayPreviewFactor * previewFactor,\n                        fb.x / displayPreviewFactor * previewFactor,\n                        fb.y / displayPreviewFactor * previewFactor,\n                        blur * previewFactor,\n                        gradient * previewFactor\n                    ).update();\n                    klCanvasPreview.render();\n                } catch(e) {\n                    (div as any).errorCallback(e);\n                }\n            }\n\n            function nob(x, y) {\n                let nobSize = 14;\n                let div = BB.el({\n                    css: {\n                        width: nobSize + \"px\",\n                        height: nobSize + \"px\",\n                        backgroundColor: '#fff',\n                        boxShadow: \"inset 0 0 0 2px #000\",\n                        borderRadius: nobSize + \"px\",\n                        position: \"absolute\",\n                        cursor: 'move',\n                        left: (x - nobSize / 2) + \"px\",\n                        top: (y - nobSize / 2) + \"px\",\n                        userSelect: 'none',\n                        touchAction: 'none',\n                    }\n                });\n                (div as any).x = x;\n                (div as any).y = y;\n                let pointerListener = new BB.PointerListener({\n                    target: div,\n                    maxPointers: 1,\n                    onPointer: function(event) {\n                        event.eventPreventDefault();\n                        if (event.button === 'left' && event.type === 'pointermove') {\n                            (div as any).x += event.dX;\n                            (div as any).y += event.dY;\n                            div.style.left = ((div as any).x - nobSize / 2) + \"px\";\n                            div.style.top = ((div as any).y - nobSize / 2) + \"px\";\n                            update();\n                        }\n                    }\n                });\n                pointerListenerArr.push(pointerListener);\n                return div;\n            }\n\n            fa = nob(parseInt('' + (displayW / 6)), parseInt('' + (displayH / 2)));\n            fb = nob(parseInt('' + (displayW - displayW / 6)), parseInt('' + (displayH - displayH / 3)));\n\n            let blurSlider = new KlSlider({\n                label: LANG('filter-tilt-shift-blur'),\n                width: 300,\n                height: 30,\n                min: 0,\n                max: 200,\n                initValue: blur,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    blur = val;\n                    update();\n                }\n            });\n            blurSlider.getElement().style.marginBottom = \"10px\";\n            div.appendChild(blurSlider.getElement());\n            let gradientSlider = new KlSlider({\n                label: LANG('filter-tilt-shift-gradient'),\n                width: 300,\n                height: 30,\n                min: 0,\n                max: 1000,\n                initValue: gradient,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    gradient = val;\n                    update();\n                }\n            });\n            div.appendChild(gradientSlider.getElement());\n\n\n            let previewWrapper = document.createElement(\"div\");\n            previewWrapper.oncontextmenu = function () {\n                return false;\n            };\n            BB.css(previewWrapper, {\n                width: \"340px\",\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    previewLayerArr.push({\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            let klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + displayW),\n                height: parseInt('' + displayH),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + displayW) + 'px',\n                    height: parseInt('' + displayH) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n            previewInnerWrapper.appendChild(fa);\n            previewInnerWrapper.appendChild(fb);\n\n\n            div.appendChild(previewWrapper);\n            update();\n            result.destroy = () => {\n                for (let i = 0; i < pointerListenerArr.length; i++) {\n                    pointerListenerArr[i].destroy();\n                }\n                blurSlider.destroy();\n                gradientSlider.destroy();\n                texture.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    a: {x: fa.x / displayPreviewFactor, y: fa.y / displayPreviewFactor},\n                    b: {x: fb.x / displayPreviewFactor, y: fb.y / displayPreviewFactor},\n                    blur: blur,\n                    gradient: gradient\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1);\n\n\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let history = params.history;\n        let a = params.input.a;\n        let b = params.input.b;\n        let blur = params.input.blur;\n        let gradient = params.input.gradient;\n        if (!context || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).tiltShift(a.x, a.y, b.x, b.y, blur, gradient).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"glTiltShift\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {Checkbox} from '../ui/base-components/checkbox';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {FreeTransform, ITransform} from '../ui/components/free-transform';\nimport {Select} from '../ui/base-components/select';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\ninterface IFilterTransformInput {\n    bounds: {x: number, y: number, width: number, height: number};\n    transform: ITransform;\n    isPixelated: boolean;\n}\n\nexport const transform = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let i;\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let isSmall = window.innerWidth < 550;\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, isSmall ? 280 : 490, isSmall ? 200 : 240, 1);\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\n        let w = Math.min(displayW, context.canvas.width);\n        let h = Math.min(displayH, context.canvas.height);\n        let freeTransform: FreeTransform;\n        let displayPreviewFactor = displayW / context.canvas.width;\n\n        // determine bounds and initial transformation\n        let boundsObj: {\n            x: number;\n            y: number;\n            width: number;\n            height: number;\n        } = { x: 0, y: 0, width: 0, height: 0 };\n        {\n            let tempBounds: any = {\n                x1: null,\n                y1: null,\n                x2: null,\n                y2: null\n            };\n            let imdat = context.getImageData(0, 0, context.canvas.width, context.canvas.height);\n\n            if (imdat.data[3] > 0 && imdat.data[imdat.data.length - 1] > 0) {\n                tempBounds.x1 = 0;\n                tempBounds.y1 = 0;\n                tempBounds.x2 = context.canvas.width - 1;\n                tempBounds.y2 = context.canvas.height - 1;\n            } else {\n                for (i = 3; i < imdat.data.length; i += 4) {\n                    if (imdat.data[i] > 0 ) {\n                        let x = ((i - 3) / 4) %  context.canvas.width;\n                        let y = Math.floor((i - 3) / 4 / context.canvas.width);\n                        if (tempBounds.x1 > x || tempBounds.x1 === null) {\n                            tempBounds.x1 = x;\n                        }\n                        if (tempBounds.y1 === null) {\n                            tempBounds.y1 = y;\n                        }\n                        if (tempBounds.x2 < x || tempBounds.x2 === null) {\n                            tempBounds.x2 = x;\n                        }\n                        if (tempBounds.y2 < y || tempBounds.y2 === null) {\n                            tempBounds.y2 = y;\n                        }\n                    }\n                }\n            }\n            if (tempBounds.x1 === null || tempBounds.y1 === null) {\n                alert(LANG('filter-transform-empty'));\n                return false;\n            }\n            boundsObj.x = tempBounds.x1;\n            boundsObj.y = tempBounds.y1;\n            boundsObj.width = tempBounds.x2 - tempBounds.x1 + 1;\n            boundsObj.height = tempBounds.y2 - tempBounds.y1 + 1;\n        }\n\n        const initTransform = {\n            x: boundsObj.x + boundsObj.width / 2,\n            y: boundsObj.y + boundsObj.height / 2,\n            width: boundsObj.width,\n            height: boundsObj.height,\n            angleDeg: 0,\n        };\n\n\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n        if (!isSmall) {\n            result.width = 500;\n        }\n        div.innerHTML = LANG('filter-transform-description');\n\n        let keyListener = new BB.KeyListener({\n            onDown: function(keyStr) {\n                if (BB.isInputFocused(true)) {\n                    return;\n                }\n\n                if (keyStr === 'left') {\n                    inputX.value = '' + (parseFloat(inputX.value) - 1);\n                    onInputsChanged();\n                }\n                if (keyStr === 'right') {\n                    inputX.value = '' + (parseFloat(inputX.value) + 1);\n                    onInputsChanged();\n                }\n                if (keyStr === 'up') {\n                    inputY.value = '' + (parseFloat(inputY.value) - 1);\n                    onInputsChanged();\n                }\n                if (keyStr === 'down') {\n                    inputY.value = '' + (parseFloat(inputY.value) + 1);\n                    onInputsChanged();\n                }\n            }\n\n        });\n\n        let leftWrapper = document.createElement(\"div\");\n        let rightWrapper = document.createElement(\"div\");\n        let rotWrapper = document.createElement(\"div\");\n        let inputY = document.createElement(\"input\");\n        let inputX = document.createElement(\"input\");\n        let inputR = document.createElement(\"input\");\n        leftWrapper.style.width = \"100px\";\n        leftWrapper.style.height = \"30px\";\n        rightWrapper.style.width = \"100px\";\n        rightWrapper.style.height = \"30px\";\n        rightWrapper.style.display = \"inline-block\";\n        leftWrapper.style.display = \"inline-block\";\n        rotWrapper.style.display = \"inline-block\";\n        rotWrapper.style.width = \"150px\";\n        rotWrapper.style.height = \"30px\";\n        inputY.type = \"number\";\n        inputX.type = \"number\";\n        inputR.type = \"number\";\n        inputX.style.width = 70 + \"px\";\n        inputY.style.width = 70 + \"px\";\n        inputR.style.width = 70 + \"px\";\n        inputY.value = '0';\n        inputX.value = '0';\n        inputR.value = '0';\n        inputY.onclick = function () {\n            (this as any).focus();\n            onInputsChanged();\n        };\n        inputX.onclick = function () {\n            (this as any).focus();\n            onInputsChanged();\n        };\n        inputR.onclick = function () {\n            (this as any).focus();\n            onInputsChanged();\n        };\n        inputY.onchange = function () {\n            onInputsChanged();\n        };\n        inputX.onchange = function () {\n            onInputsChanged();\n        };\n        inputR.onchange = function () {\n            onInputsChanged();\n        };\n        inputY.onkeyup = function () {\n            onInputsChanged();\n        };\n        inputX.onkeyup = function () {\n            onInputsChanged();\n        };\n        inputR.onkeyup = function () {\n            onInputsChanged();\n        };\n        leftWrapper.append(\"X: \", inputX);\n        rightWrapper.append(\"Y: \", inputY);\n        rotWrapper.append(LANG('filter-transform-rotation') + ': ', inputR);\n        if (!isSmall) {\n            const inputRow = BB.el({\n                parent: div,\n                css: {\n                    marginTop: '10px',\n                }\n            });\n            inputRow.append(leftWrapper, rightWrapper, rotWrapper);\n        }\n\n        // buttons\n        const actionBtnCss = {\n            marginLeft: '10px',\n            marginTop: '10px',\n        };\n        const buttonRow = BB.el ({\n            parent: div,\n            css: {\n                display: 'flex',\n                flexWrap: 'wrap',\n                marginLeft: '-10px',\n            }\n        });\n        const flipXBtn = BB.el ({\n            parent: buttonRow,\n            tagName: 'button',\n            content: LANG('filter-transform-flip') + ' X',\n            onClick: () => {\n                const t = freeTransform.getTransform();\n                freeTransform.setSize(-t.width, t.height);\n            },\n            css: actionBtnCss,\n        });\n        const flipYBtn = BB.el ({\n            parent: buttonRow,\n            tagName: 'button',\n            content: LANG('filter-transform-flip') + ' Y',\n            onClick: () => {\n                const t = freeTransform.getTransform();\n                freeTransform.setSize(t.width, -t.height);\n            },\n            css: actionBtnCss,\n        });\n        const scaleRotLeftBtn = BB.el ({\n            parent: buttonRow,\n            tagName: 'button',\n            content: '-90°',\n            onClick: () => {\n                const t = freeTransform.getTransform();\n                t.angleDeg -= 90;\n                t.angleDeg %= 360;\n                freeTransform.setAngleDeg(t.angleDeg);\n                inputR.value = '' + Math.round(t.angleDeg);\n                updatePreview();\n            },\n            css: actionBtnCss,\n        });\n        const scaleRotRightBtn = BB.el ({\n            parent: buttonRow,\n            tagName: 'button',\n            content: '+90°',\n            onClick: () => {\n                const t = freeTransform.getTransform();\n                t.angleDeg += 90;\n                t.angleDeg %= 360;\n                freeTransform.setAngleDeg(t.angleDeg);\n                inputR.value = '' + Math.round(t.angleDeg);\n                updatePreview();\n            },\n            css: actionBtnCss,\n        });\n        const scaleDoubleBtn = BB.el ({\n            parent: buttonRow,\n            tagName: 'button',\n            content: '2x',\n            onClick: () => {\n                const t = freeTransform.getTransform();\n                if (constrainCheckbox.getValue()) {\n                    freeTransform.setSize(freeTransform.getRatio() * t.height * 2, t.height * 2);\n                } else {\n                    freeTransform.setSize(t.width * 2, t.height * 2);\n                }\n            },\n            css: actionBtnCss,\n        });\n        const scaleHalfBtn = BB.el ({\n            parent: buttonRow,\n            tagName: 'button',\n            content: '1/2x',\n            onClick: () => {\n                const t = freeTransform.getTransform();\n                freeTransform.setSize(Math.round(t.width / 2), Math.round(t.height / 2));\n            },\n            css: actionBtnCss,\n        });\n        const centerBtn = BB.el ({\n            parent: buttonRow,\n            tagName: 'button',\n            content: LANG('center'),\n            onClick: () => {\n                const t = freeTransform.getTransform();\n                freeTransform.setPos({ x: context.canvas.width / 2, y: context.canvas.height / 2 });\n                freeTransform.setAngleDeg(t.angleDeg);\n                updatePreview();\n            },\n            css: actionBtnCss,\n        });\n\n\n\n\n\n        let isConstrained = true;\n        let constrainCheckbox = new Checkbox({\n            init: true,\n            label: LANG('filter-transform-constrain'),\n            title: LANG('constrain-proportions'),\n            allowTab: true,\n            callback: function(b) {\n                isConstrained = b;\n                freeTransform.setConstrained(isConstrained);\n            },\n            css: {\n                display: 'inline-block'\n            }\n        });\n        let isSnapping = false;\n        let snappingCheckbox = new Checkbox({\n            init: true,\n            label: LANG('filter-transform-snap'),\n            title: LANG('filter-transform-snap-title'),\n            allowTab: true,\n            callback: function(b) {\n                isSnapping = b;\n                freeTransform.setSnapping(isSnapping);\n            },\n            css: {\n                display: 'inline-block',\n                marginLeft: '10px',\n            }\n        });\n        const checkboxWrapper = BB.el({});\n        checkboxWrapper.append(constrainCheckbox.getElement(), snappingCheckbox.getElement());\n\n        div.appendChild(BB.el({\n            css: {\n                clear: 'both',\n                height: '10px'\n            }\n        }));\n\n        const bottomRow = BB.el({\n            parent: div,\n            css: {\n                display: 'flex',\n                justifyContent: 'space-between',\n            }\n        });\n\n        let algorithmSelect = new Select({\n            isFocusable: true,\n            optionArr: [\n                ['smooth', LANG('algorithm-smooth')],\n                ['pixelated', LANG('algorithm-pixelated')]\n            ],\n            initValue: 'smooth',\n            title: LANG('scaling-algorithm'),\n            onChange: function() {\n                updatePreview(true);\n            },\n        });\n        bottomRow.append(checkboxWrapper, algorithmSelect.getElement());\n\n\n        let previewWrapper = document.createElement(\"div\");\n        previewWrapper.oncontextmenu = function () {\n            return false;\n        };\n        BB.css(previewWrapper, {\n            width: isSmall ? '340px' : '540px',\n            marginLeft: \"-20px\",\n            height: isSmall ? '260px' : '300px',\n            backgroundColor: \"#9e9e9e\",\n            marginTop: \"10px\",\n            boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n            overflow: \"hidden\",\n            position: \"relative\",\n            userSelect: 'none',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            colorScheme: 'only light',\n        });\n\n        let previewLayerArr: IKlBasicLayer[] = [];\n        {\n            for (let i = 0; i < layers.length; i++) {\n                let canvas;\n                if (i === selectedLayerIndex) {\n                    canvas = BB.canvas(parseInt('' + w), parseInt('' + h));\n                    let ctx = canvas.getContext('2d');\n                    ctx.drawImage(layers[i].context.canvas, 0, 0, canvas.width, canvas.height);\n                } else {\n                    canvas = layers[i].context.canvas;\n                }\n                previewLayerArr.push({\n                    image: canvas,\n                    opacity: layers[i].opacity,\n                    mixModeStr: layers[i].mixModeStr\n                });\n            }\n        }\n        let klCanvasPreview = new KlCanvasPreview({\n            width: parseInt('' + displayW),\n            height: parseInt('' + displayH),\n            layers: previewLayerArr\n        });\n\n        let previewInnerWrapper = BB.el({\n            css: {\n                position: 'relative',\n                boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                width: parseInt('' + displayW) + 'px',\n                height: parseInt('' + displayH) + 'px'\n            }\n        });\n        previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n        previewWrapper.appendChild(previewInnerWrapper);\n\n        let lastDrawnTransformStr;\n        function updatePreview(doForce: boolean = false) {\n            if (!freeTransform) {\n                return;\n            }\n            let transform = freeTransform.getTransform();\n            if (JSON.stringify(transform) === lastDrawnTransformStr && !doForce) {\n                return;\n            }\n            lastDrawnTransformStr = JSON.stringify(transform);\n            if (displayPreviewFactor < 1) {\n                transform.x *= displayPreviewFactor;\n                transform.y *= displayPreviewFactor;\n                transform.width *= displayPreviewFactor;\n                transform.height *= displayPreviewFactor;\n            }\n            let transformLayerCanvas = previewLayerArr[selectedLayerIndex].image as HTMLCanvasElement;\n            let ctx = transformLayerCanvas.getContext('2d');\n            ctx.save();\n            ctx.clearRect(0, 0, transformLayerCanvas.width, transformLayerCanvas.height);\n            BB.drawTransformedImageWithBounds(\n                ctx,\n                layers[selectedLayerIndex].context.canvas,\n                transform,\n                boundsObj,\n                algorithmSelect.getValue() === 'pixelated' ||\n                BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\n            );\n            ctx.restore();\n            klCanvasPreview.render();\n        }\n\n        freeTransform = new FreeTransform({\n            x: initTransform.x,\n            y: initTransform.y,\n            width: initTransform.width,\n            height: initTransform.height,\n            angleDeg: initTransform.angleDeg,\n            isConstrained: true,\n            snapX: [0, context.canvas.width],\n            snapY: [0, context.canvas.height],\n            callback: function (t) {\n                inputX.value = '' + Math.round(t.x - initTransform.x);\n                inputY.value = '' + Math.round(t.y - initTransform.y);\n                inputR.value = '' + Math.round(t.angleDeg);\n                updatePreview();\n            },\n            scale: displayPreviewFactor\n        });\n        BB.css(freeTransform.getElement(), {\n            position: 'absolute',\n            left: '0',\n            top: '0'\n        });\n        previewInnerWrapper.appendChild(freeTransform.getElement());\n\n        function onInputsChanged() {\n            freeTransform.setPos({\n                x: parseInt(inputX.value) + initTransform.x,\n                y: parseInt(inputY.value) + initTransform.y}\n            );\n            freeTransform.setAngleDeg(parseInt(inputR.value));\n            updatePreview();\n        }\n\n        updatePreview();\n\n        div.appendChild(previewWrapper);\n        result.destroy = () => {\n            keyListener.destroy();\n            freeTransform.destroy();\n            constrainCheckbox.destroy();\n            snappingCheckbox.destroy();\n        };\n        result.getInput = function () {\n            const transform = freeTransform.getTransform();\n            let input = {\n                transform,\n                bounds: boundsObj,\n                isPixelated: algorithmSelect.getValue() === 'pixelated' ||\n                    BB.testShouldPixelate(transform, transform.width / initTransform.width, transform.height / initTransform.height),\n            } as IFilterTransformInput;\n            result.destroy();\n            return JSON.parse(JSON.stringify(input));\n        };\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        const context = params.context;\n        const history = params.history;\n        if (!context || !history) {\n            return false;\n        }\n        history.pause(true);\n\n        const input: IFilterTransformInput = params.input;\n\n        let copyCanvas = BB.copyCanvas(context.canvas);\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        BB.drawTransformedImageWithBounds(\n            context,\n            copyCanvas,\n            input.transform,\n            input.bounds,\n            input.isPixelated,\n        );\n\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"transform\"],\n            action: \"apply\",\n            params: [{input}],\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {eventResMs} from './filters-consts';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const glBlur = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let canvas = params.canvas;\n        let context = params.context;\n        if (!canvas || !context) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\n        let w = Math.min(displayW, context.canvas.width);\n        let h = Math.min(displayH, context.canvas.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (w > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n        let previewFactor = w / context.canvas.width;\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n\n\n        function finishInit() {\n            let radius = 10;\n            div.innerHTML = LANG('filter-triangle-blur-description') + \"<br/><br/>\";\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n\n            let radiusSlider = new KlSlider({\n                label: LANG('radius'),\n                width: 300,\n                height: 30,\n                min: 1,\n                max: 200,\n                initValue: radius,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    radius = val;\n                    glCanvas.draw(texture).triangleBlur(radius * previewFactor).update();\n                    klCanvasPreview.render();\n                }\n            });\n            div.appendChild(radiusSlider.getElement());\n\n\n            let previewWrapper = document.createElement(\"div\");\n            BB.css(previewWrapper, {\n                width: \"340px\",\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    previewLayerArr.push({\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            let klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + displayW),\n                height: parseInt('' + displayH),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + displayW) + 'px',\n                    height: parseInt('' + displayH) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n            div.appendChild(previewWrapper);\n\n            try {\n                glCanvas.draw(texture).triangleBlur(radius * previewFactor).update();\n                klCanvasPreview.render();\n            } catch(e) {\n                (div as any).errorCallback(e);\n            }\n\n            result.destroy = () => {\n                texture.destroy();\n                radiusSlider.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    radius: radius\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1);\n\n        return result;\n    },\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let history = params.history;\n        let radius = params.input.radius;\n        if (!context || !radius || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).triangleBlur(radius).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"glBlur\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {eventResMs} from './filters-consts';\nimport {KlSlider} from '../ui/base-components/kl-slider';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const glUnsharpMask = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\n        let displayW = parseInt('' + fit.width), displayH = parseInt('' + fit.height);\n        let w = Math.min(displayW, context.canvas.width);\n        let h = Math.min(displayH, context.canvas.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (w > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n        let previewFactor = w / context.canvas.width;\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n\n        function finishInit() {\n            let radius = 2, strength = 5.1 / 10;\n            div.innerHTML = LANG('filter-unsharp-mask-description') + \"<br/><br/>\";\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n\n            let radiusSlider = new KlSlider({\n                label: LANG('radius'),\n                width: 300,\n                height: 30,\n                min: 0,\n                max: 200,\n                initValue: 2,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    radius = val;\n                    glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\n                    klCanvasPreview.render();\n                },\n                curve: [[0, 0], [0.1, 2], [0.5, 50], [1, 200]]\n            });\n            let strengthSlider = new KlSlider({\n                label: LANG('filter-unsharp-mask-strength'),\n                width: 300,\n                height: 30,\n                min: 0,\n                max: 50,\n                initValue: 5.1,\n                eventResMs: eventResMs,\n                onChange: function (val) {\n                    strength = val / 10;\n                    glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\n                    klCanvasPreview.render();\n                },\n                curve: [[0, 0], [0.1, 2], [0.5, 10], [1, 50]]\n            });\n            radiusSlider.getElement().style.marginBottom = \"10px\";\n            div.appendChild(radiusSlider.getElement());\n            div.appendChild(strengthSlider.getElement());\n\n\n            let previewWrapper = document.createElement(\"div\");\n            BB.css(previewWrapper, {\n                width: \"340px\",\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    previewLayerArr.push({\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            let klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + displayW),\n                height: parseInt('' + displayH),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + displayW) + 'px',\n                    height: parseInt('' + displayH) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n\n            div.appendChild(previewWrapper);\n\n            try {\n                glCanvas.draw(texture).unsharpMask(radius * previewFactor, strength).update();\n                klCanvasPreview.render();\n            } catch(e) {\n                (div as any).errorCallback(e);\n            }\n\n            result.destroy = () => {\n                radiusSlider.destroy();\n                strengthSlider.destroy();\n                texture.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    radius: radius,\n                    strength: strength\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1);\n\n        return result;\n    },\n\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let history = params.history;\n        let radius = params.input.radius;\n        let strength = params.input.strength;\n        if (!context || radius === null || strength === null || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).unsharpMask(radius, strength).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"glUnsharpMask\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {BB} from '../../bb/bb';\nimport {Options} from '../ui/base-components/options';\nimport {ColorOptions} from '../ui/base-components/color-options';\nimport {KlCanvasPreview} from '../canvas-ui/canvas-preview';\nimport {getSharedFx} from './shared-gl-fx';\nimport {IFilterApply, IFilterGetDialogParam, IKlBasicLayer} from '../kl.types';\nimport {LANG} from '../../language/language';\n\nexport const toAlpha = {\n\n    getDialog(params: IFilterGetDialogParam) {\n        let context = params.context;\n        let canvas = params.canvas;\n        if (!context || !canvas) {\n            return false;\n        }\n\n        let layers = canvas.getLayers();\n        let selectedLayerIndex = canvas.getLayerIndex(context.canvas);\n\n        let fit = BB.fitInto(context.canvas.width, context.canvas.height, 280, 200, 1);\n        let w = parseInt('' + fit.width), h = parseInt('' + fit.height);\n\n        let tempCanvas = BB.canvas(w, h);\n        {\n            const ctx = tempCanvas.getContext(\"2d\");\n            ctx.save();\n            if (tempCanvas.width > context.canvas.width) {\n                ctx.imageSmoothingEnabled = false;\n            }\n            ctx.drawImage(context.canvas, 0, 0, w, h);\n            ctx.restore();\n        }\n\n        let div = document.createElement(\"div\");\n        let result: any = {\n            element: div\n        };\n\n        function finishInit() {\n            let radius = 2, strength = 5.1 / 10;\n            div.appendChild(BB.el({\n                content: LANG('filter-to-alpha-description'),\n                css: {\n                    marginBottom: '5px'\n                }\n            }));\n\n            let glCanvas = getSharedFx();\n            if (!glCanvas) {\n                return; // todo throw?\n            }\n            let texture = glCanvas.texture(tempCanvas);\n            glCanvas.draw(texture).update(); // update glCanvas size\n\n            function updatePreview() {\n                glCanvas.draw(texture).toAlpha(sourceId === 'inverted-luminance', selectedRgbaObj).update();\n                klCanvasPreview.render();\n            }\n\n            // source\n            let sourceId = 'inverted-luminance';\n            let sourceOptions = new Options({\n                optionArr: [\n                    {\n                        id: 'inverted-luminance',\n                        label: LANG('filter-to-alpha-inverted-lum')\n                    },\n                    {\n                        id: 'luminance',\n                        label: LANG('filter-to-alpha-lum')\n                    }\n                ],\n                initialId: sourceId,\n                onChange: function(id) {\n                    sourceId = id;\n                    updatePreview();\n                }\n            });\n            div.appendChild(sourceOptions.getElement());\n\n            // color\n            let selectedRgbaObj = {r: 0, g: 0, b: 0, a: 1};\n            let colorOptionsArr = [\n                null,\n                {r: 0, g: 0, b: 0, a: 1},\n                {r: 255, g: 255, b: 255, a: 1}\n            ];\n            colorOptionsArr.push({\n                r: params.currentColorRgb.r,\n                g: params.currentColorRgb.g,\n                b: params.currentColorRgb.b,\n                a: 1,\n            });\n            colorOptionsArr.push({\n                r: params.secondaryColorRgb.r,\n                g: params.secondaryColorRgb.g,\n                b: params.secondaryColorRgb.b,\n                a: 1,\n            });\n\n            let colorOptions = new ColorOptions({\n                label: LANG('filter-to-alpha-replace'),\n                colorArr: colorOptionsArr,\n                initialIndex: 1,\n                onChange: function(rgbaObj) {\n                    selectedRgbaObj = rgbaObj;\n                    updatePreview();\n                }\n            });\n            colorOptions.getElement().style.marginTop = '10px';\n            div.appendChild(colorOptions.getElement());\n\n\n            let previewWrapper = document.createElement(\"div\");\n            BB.css(previewWrapper, {\n                width: \"340px\",\n                marginLeft: \"-20px\",\n                height: \"220px\",\n                backgroundColor: \"#9e9e9e\",\n                marginTop: \"10px\",\n                boxShadow: \"rgba(0, 0, 0, 0.2) 0px 1px inset, rgba(0, 0, 0, 0.2) 0px -1px inset\",\n                overflow: \"hidden\",\n                position: \"relative\",\n                userSelect: 'none',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                colorScheme: 'only light',\n            });\n\n            let previewLayerArr: IKlBasicLayer[] = [];\n            {\n                for (let i = 0; i < layers.length; i++) {\n                    previewLayerArr.push({\n                        image: i === selectedLayerIndex ? glCanvas : layers[i].context.canvas,\n                        opacity: layers[i].opacity,\n                        mixModeStr: layers[i].mixModeStr\n                    });\n                }\n            }\n            let klCanvasPreview = new KlCanvasPreview({\n                width: parseInt('' + w),\n                height: parseInt('' + h),\n                layers: previewLayerArr\n            });\n\n            let previewInnerWrapper = BB.el({\n                css: {\n                    position: 'relative',\n                    boxShadow: '0 0 5px rgba(0,0,0,0.5)',\n                    width: parseInt('' + w) + 'px',\n                    height: parseInt('' + h) + 'px'\n                }\n            });\n            previewInnerWrapper.appendChild(klCanvasPreview.getElement());\n            previewWrapper.appendChild(previewInnerWrapper);\n\n\n            div.appendChild(previewWrapper);\n\n            setTimeout(function() { //ie has a problem otherwise...\n                try {\n                    updatePreview();\n                } catch(e) {\n                    (div as any).errorCallback(e);\n                }\n            }, 1);\n\n            result.destroy = () => {\n                texture.destroy();\n                sourceOptions.destroy();\n            };\n            result.getInput = function () {\n                result.destroy();\n                return {\n                    sourceId: sourceId,\n                    selectedRgbaObj: selectedRgbaObj\n                };\n            };\n        }\n\n        setTimeout(finishInit, 1);\n\n        return result;\n    },\n\n\n    apply(params: IFilterApply) {\n        let context = params.context;\n        let history = params.history;\n        let sourceId = params.input.sourceId;\n        let selectedRgbaObj = params.input.selectedRgbaObj;\n        if (!context || !sourceId || !history)\n            return false;\n        history.pause(true);\n        let glCanvas = getSharedFx();\n        if (!glCanvas) {\n            return false; // todo more specific error?\n        }\n        let texture = glCanvas.texture(context.canvas);\n        glCanvas.draw(texture).toAlpha(sourceId === 'inverted-luminance', selectedRgbaObj).update();\n        context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        context.drawImage(glCanvas, 0, 0);\n        texture.destroy();\n        history.pause(false);\n        history.push({\n            tool: [\"filter\", \"toAlpha\"],\n            action: \"apply\",\n            params: [{\n                input: params.input\n            }]\n        });\n        return true;\n    }\n\n};","import {filterLib, filterLibStatus} from './filters';\nimport {glBrightnessContrast} from './gl-brightness-contrast';\nimport {cropExtend} from './crop-extend';\nimport {glCurves} from './gl-curves';\nimport {flip} from './flip';\nimport {glHueSaturation} from './gl-hue-saturation';\nimport {invert} from './invert';\nimport {glPerspective} from './gl-perspective';\nimport {resize} from './resize';\nimport {rotate} from './rotate';\nimport {glTiltShift} from './gl-tilt-shift';\nimport {transform} from './transform';\nimport {glBlur} from './gl-blur';\nimport {glUnsharpMask} from './gl-unsharp-mask';\nimport {toAlpha} from './to-alpha';\n\nlet embed: boolean;\nfunction importFilter(libObj, moduleObj): void {\n    if (moduleObj.getDialog) {\n        libObj.getDialog = moduleObj.getDialog;\n    }\n    libObj.apply = moduleObj.apply;\n}\n\n\nexport function importFilters(isEmbed?: boolean) {\n    if (filterLibStatus.isLoaded) {\n        return;\n    }\n    embed = isEmbed\n\n    importFilter(filterLib.glBrightnessContrast, glBrightnessContrast);\n    importFilter(filterLib.cropExtend, cropExtend);\n    importFilter(filterLib.glCurves, glCurves);\n    importFilter(filterLib.flip, flip);\n    importFilter(filterLib.glHueSaturation, glHueSaturation);\n    importFilter(filterLib.invert, invert);\n    importFilter(filterLib.glPerspective, glPerspective);\n    importFilter(filterLib.resize, resize);\n    importFilter(filterLib.rotate, rotate);\n    importFilter(filterLib.glTiltShift, glTiltShift);\n    importFilter(filterLib.transform, transform);\n    importFilter(filterLib.glBlur, glBlur);\n    importFilter(filterLib.glUnsharpMask, glUnsharpMask);\n    importFilter(filterLib.toAlpha, toAlpha);\n\n    filterLibStatus.isLoaded = true;\n}","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"gXLuy\");","import {KL} from '../klecks/kl';\nimport {klHistory} from '../klecks/history/kl-history';\nimport {BB} from '../bb/bb';\nimport {showIframePopup} from '../klecks/ui/modals/show-iframe-popup';\n// @ts-ignore\nimport newImageImg from 'url:~/src/app/img/ui/new-image.svg';\n// @ts-ignore\nimport exportImg from 'url:~/src/app/img/ui/export.svg';\n// @ts-ignore\nimport shareImg from 'url:~/src/app/img/ui/share.svg';\n// @ts-ignore\nimport uploadImg from 'url:~/src/app/img/ui/upload.svg';\n// @ts-ignore\nimport importImg from 'url:~/src/app/img/ui/import.svg';\nimport {exportType} from '../klecks/ui/tool-tabs/file-tab';\nimport {ToolspaceTopRow} from \"../embed/toolspace-top-row\";\nimport {IInitState, IKlProject, IKlPsd} from '../klecks/kl.types';\nimport {importFilters} from '../klecks/filters/filters-lazy';\nimport {base64ToBlob} from '../klecks/storage/base-64-to-blob';\nimport {klCanvasToPsdBlob} from '../klecks/storage/kl-canvas-to-psd-blob';\nimport {ProjectStore} from '../klecks/storage/project-store';\nimport {SaveReminder} from \"../klecks/ui/components/save-reminder\";\nimport {KlCanvasWorkspace} from '../klecks/canvas-ui/kl-canvas-workspace';\nimport {KlCanvas} from '../klecks/canvas/kl-canvas';\nimport {LANG} from '../language/language';\n// @ts-ignore\nimport toolPaintImg from 'url:~/src/app/img/ui/tool-paint.svg';\n// @ts-ignore\nimport toolHandImg from 'url:~/src/app/img/ui/tool-hand.svg';\n// @ts-ignore\nimport toolFillImg from 'url:~/src/app/img/ui/tool-fill.svg';\n// @ts-ignore\nimport toolTextImg from 'url:~/src/app/img/ui/tool-text.svg';\n// @ts-ignore\nimport toolShapeImg from 'url:~/src/app/img/ui/tool-shape.svg';\n// @ts-ignore\nimport tabSettingsImg from 'url:~/src/app/img/ui/tab-settings.svg';\n// @ts-ignore\nimport tabLayersImg from 'url:~/src/app/img/ui/tab-layers.svg';\nimport {LocalStorage} from '../bb/base/local-storage';\n\n\ninterface IKlAppOptions {\n    saveReminder?: SaveReminder;\n    projectStore?: ProjectStore;\n    logoImg?: any; // app logo\n    bottomBar?: HTMLElement; // row at bottom of toolspace\n    embed?: {\n        url: string;\n        onSubmit: (onSuccess: () => void, onError: () => void) => void;\n    };\n    app?: {\n        filenameBase?: string; // part of filename when downloading drawing\n        imgurKey?: string; // for imgur uploads\n    };\n    aboutEl?: HTMLElement; // replaces info about Klecks in settings tab\n}\n\nimportFilters();\n\nexport function KlApp(pProject: IKlProject | null, pOptions: IKlAppOptions) {\n    // default 2048, unless your screen is bigger than that (that computer then probably has the horsepower for that)\n    // but not larger than 4096 - a fairly arbitrary decision\n    let klMaxCanvasSize = Math.min(4096, Math.max(2048, Math.max(window.screen.width, window.screen.height)));\n    let collapseThreshold = 820;\n    let uiState: 'left' | 'right' = (pOptions.embed ? 'left' : (LocalStorage.getItem('uiState') ? LocalStorage.getItem('uiState') : 'left')) as any;\n    const filenameBase = (pOptions.app && pOptions.app.filenameBase) ? pOptions.app.filenameBase : 'Klecks';\n    const projectStore = pOptions.projectStore;\n    let klRootEl = document.createElement(\"div\");\n    klRootEl.className = 'g-root kl-initialized';\n    let uiWidth: number = Math.max(0, window.innerWidth);\n    let uiHeight: number = Math.max(0, window.innerHeight);\n    const toolWidth = 271;\n    let exportType: exportType = 'png';\n    let klCanvas: KlCanvas = new KL.KlCanvas(\n        pProject ? {\n            projectObj: pProject\n        } : {\n            width: Math.min(klMaxCanvasSize, window.innerWidth < collapseThreshold ? uiWidth : uiWidth - toolWidth),\n            height: Math.min(klMaxCanvasSize, uiHeight)\n        }, pOptions.embed ? -1 : 0);\n    klCanvas.setHistory(klHistory);\n    let initState: IInitState = null;\n    let mainTabRow;\n\n    if (!pOptions.saveReminder) {\n        pOptions.saveReminder = {init: () => {}, reset: () => {}} as SaveReminder;\n    }\n\n    function translateSmoothing(s: number): number {\n        if (s == 1) {\n            return 1 - 0.5;\n        }\n        if (s == 2) {\n            return 1 - 0.16;\n        }\n        if (s == 3) {\n            return 1 - 0.035;\n        }\n        if (s == 4) {\n            return 1 - 0.0175;\n        }\n        if (s == 5) {\n            return 1 - 0.00875;\n        }\n        return s;\n    }\n    \n\n    let isFirstImage = true;\n\n    if (pProject) {\n        pProject = null;\n    } else {\n        klHistory.pause(true);\n        klCanvas.addLayer();\n        klCanvas.layerFill(0, { r: 255, g: 255, b: 255});\n        klHistory.pause(false);\n    }\n    initState = {\n        canvas: new KL.KlCanvas({copy: klCanvas}, pOptions.embed ? -1 : 0),\n        focus: klCanvas.getLayerCount() - 1,\n        brushes: {},\n    };\n    for (let b in KL.brushes) {\n        if (KL.brushes.hasOwnProperty(b)) {\n            initState.brushes[b] = new KL.brushes[b]();\n            if (initState.canvas) {\n                initState.brushes[b].setContext(initState.canvas.getLayerContext(initState.focus));\n            }\n        }\n    }\n\n\n    let currentColor = new BB.RGB(0, 0, 0);\n    let currentBrush, currentBrushId;\n    let lastNonEraserBrushId = 0;\n    let currentLayerCtx = klCanvas.getLayerContext(klCanvas.getLayerCount() - 1);\n\n    function sizeWatcher(val) {\n        brushSettingService.emitSize(val);\n        if (klCanvasWorkspace) {\n            klCanvasWorkspace.setCursorSize(val * 2);\n        }\n    }\n\n    const brushSettingService = new KL.BrushSettingService(\n        (color) => {\n            klColorSlider.setColor(color);\n            currentBrush.setColor(color);\n            currentColor = BB.copyObj(color);\n        },\n        (size) => {\n            currentBrush.setSize(size);\n            klCanvasWorkspace.setCursorSize(size * 2);\n        },\n        (opacity) => {\n            currentBrush.setOpacity(opacity);\n        },\n        () => klColorSlider.getColor(),\n        () => brushUiObj[currentBrushId].getSize(),\n        () => brushUiObj[currentBrushId].getOpacity(),\n        () => {\n            return {\n                sizeSlider: KL.brushesUI[currentBrushId].sizeSlider,\n                opacitySlider: KL.brushesUI[currentBrushId].opacitySlider,\n            };\n        }\n    );\n\n    let lineSmoothing = new BB.EventChain.LineSmoothing({\n        smoothing: translateSmoothing(1),\n    });\n    let lineSanitizer = new BB.EventChain.LineSanitizer();\n\n    let drawEventChain = new BB.EventChain.EventChain({\n        chainArr: [\n            lineSanitizer,\n            lineSmoothing\n        ],\n    });\n\n    drawEventChain.setChainOut(function(event) {\n        if (event.type === 'down') {\n            toolspace.style.pointerEvents = 'none';\n            currentBrush.startLine(event.x, event.y, event.pressure);\n            klCanvasWorkspace.requestFrame();\n        }\n        if (event.type === 'move') {\n            currentBrush.goLine(event.x, event.y, event.pressure, false, event.isCoalesced)\n            klCanvasWorkspace.setLastDrawEvent(event.x, event.y, event.pressure);\n            klCanvasWorkspace.requestFrame();\n        }\n        if (event.type === 'up') {\n            toolspace.style.pointerEvents = '';\n            currentBrush.endLine();\n            klCanvasWorkspace.requestFrame();\n        }\n        if (event.type === 'line') {\n            currentBrush.getBrush().drawLineSegment(event.x0, event.y0, event.x1, event.y1);\n            klCanvasWorkspace.requestFrame();\n        }\n    });\n\n    let textToolSettings = {\n        size: 20,\n        align: 'left' as ('left' | 'center' | 'right'),\n        isBold: false,\n        isItalic: false,\n        font: 'sans-serif' as ('serif' | 'monospace' | 'sans-serif' | 'cursive' | 'fantasy'),\n        opacity: 1\n    };\n\n    const klCanvasWorkspace: KlCanvasWorkspace = new KL.KlCanvasWorkspace({\n        klCanvas: klCanvas,\n        width: Math.max(0, uiWidth - toolWidth),\n        height: uiHeight,\n        onDraw: drawEventChain.chainIn,\n        onPick: function(rgbObj, isDragDone) {\n            brushSettingService.setColor(rgbObj);\n            if (isDragDone) {\n                klColorSlider.pickingDone();\n                klCanvasWorkspace.setMode(toolspaceToolRow.getActive());\n            }\n        },\n        onFill: function(canvasX, canvasY) {\n            let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\n            klCanvas.floodFill(layerIndex, canvasX, canvasY, klColorSlider.getColor(), fillUi.getOpacity(), fillUi.getTolerance(), fillUi.getSample(), fillUi.getGrow(), fillUi.getContiguous());\n            klCanvasWorkspace.requestFrame();\n        },\n        onText: function(canvasX, canvasY, angleRad) {\n            if (KL.dialogCounter.get() > 0) {\n                return;\n            }\n\n            KL.textToolDialog({\n                klCanvas: klCanvas,\n                layerIndex: klCanvas.getLayerIndex(currentLayerCtx.canvas),\n                x: canvasX,\n                y: canvasY,\n                angleRad: angleRad,\n                color: klColorSlider.getColor(),\n                secondaryColor: klColorSlider.getSecondaryRGB(),\n                size: textToolSettings.size,\n                align: textToolSettings.align,\n                isBold: textToolSettings.isBold,\n                isItalic: textToolSettings.isItalic,\n                font: textToolSettings.font,\n                opacity: textToolSettings.opacity,\n                onConfirm: function(val) {\n\n                    let colorRGBA = val.color;\n                    colorRGBA.a = val.opacity;\n\n                    textToolSettings.size = val.size;\n                    textToolSettings.align = val.align;\n                    textToolSettings.isBold = val.isBold;\n                    textToolSettings.isItalic = val.isItalic;\n                    textToolSettings.font = val.font;\n                    textToolSettings.opacity = val.opacity;\n\n                    let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\n                    klCanvas.text(layerIndex, {\n                        textStr: val.textStr,\n                        x: val.x,\n                        y: val.y,\n                        size: val.size,\n                        font: val.font,\n                        align: val.align,\n                        isBold: val.isBold,\n                        isItalic: val.isItalic,\n                        angleRad: angleRad,\n                        color: BB.ColorConverter.toRgbaStr(colorRGBA)\n                    });\n                    klCanvasWorkspace.requestFrame();\n                }\n            });\n\n        },\n        onShape: function(typeStr, canvasX, canvasY, angleRad) {\n            if (typeStr === 'down') {\n                shapeTool.onDown(canvasX, canvasY, angleRad);\n            }\n            if (typeStr === 'move') {\n                shapeTool.onMove(canvasX, canvasY);\n            }\n            if (typeStr === 'up') {\n                shapeTool.onUp(canvasX, canvasY);\n            }\n        },\n\n        onViewChange: function(viewChangeObj) {\n\n            if (viewChangeObj.changed.includes('scale')) {\n                statusOverlay.out({\n                    type: 'transform',\n                    scale: viewChangeObj.scale,\n                    angleDeg: viewChangeObj.angle * 180 / Math.PI\n                });\n            }\n\n            toolspaceToolRow.setEnableZoomIn(viewChangeObj.scale !== klCanvasWorkspace.getMaxScale());\n            toolspaceToolRow.setEnableZoomOut(viewChangeObj.scale !== klCanvasWorkspace.getMinScale());\n\n            handUi.update(viewChangeObj.scale, viewChangeObj.angle * 180 / Math.PI);\n        },\n        onUndo: function() {\n            if (klHistory.canUndo()) {\n                if (undoRedoCatchup.undo()) {\n                    statusOverlay.out(LANG('undo'), true);\n                }\n            }\n        },\n        onRedo: function() {\n            if (klHistory.canRedo()) {\n                if (undoRedoCatchup.redo()) {\n                    statusOverlay.out(LANG('redo'), true);\n                }\n            }\n        },\n    });\n   ;\n  let button1 = (<HTMLInputElement>document.getElementById('vaiz1'));\n   button1?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('draw');\n                toolspaceToolRow.setActive('draw');\n                mainTabRow.open('draw');\n                updateMainTabVisibility();\n                brushTabRow.open('penBrush');\n  });\n  let button2 = (<HTMLInputElement>document.getElementById('vaiz2'));\n   button2?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('draw');\n                toolspaceToolRow.setActive('draw');\n                mainTabRow.open('draw');\n                updateMainTabVisibility();\n                brushTabRow.open('eraserBrush');\n  });\n  let button3 = (<HTMLInputElement>document.getElementById('vaiz3'));\n   button3?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('draw');\n                toolspaceToolRow.setActive('draw');\n                mainTabRow.open('draw');\n                updateMainTabVisibility();\n                brushTabRow.open('pixelBrush');\n  });\n  let button4 = (<HTMLInputElement>document.getElementById('vaiz4'));\n   button4?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('draw');\n                toolspaceToolRow.setActive('draw');\n                mainTabRow.open('draw');\n                updateMainTabVisibility();\n                brushTabRow.open('chemyBrush');\n  });\n  let button5 = (<HTMLInputElement>document.getElementById('vaiz5'));\n   button5?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('draw');\n                toolspaceToolRow.setActive('draw');\n                mainTabRow.open('draw');\n                updateMainTabVisibility();\n                brushTabRow.open('smudgeBrush');\n  });\n  let button6 = (<HTMLInputElement>document.getElementById('vaiz6'));\n   button6?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('draw');\n                toolspaceToolRow.setActive('draw');\n                mainTabRow.open('draw');\n                updateMainTabVisibility();\n                brushTabRow.open('sketchyBrush');\n  });\n  let button7 = (<HTMLInputElement>document.getElementById('vaiz7'));\n   button7?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('draw');\n                toolspaceToolRow.setActive('draw');\n                mainTabRow.open('draw');\n                updateMainTabVisibility();\n                brushTabRow.open('blendBrush');\n  });\n  let button8 = (<HTMLInputElement>document.getElementById('vaiz8'));\n  button8?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n    klCanvasWorkspace.setMode('text');\n    toolspaceToolRow.setActive('text');\n    mainTabRow.open('text');\n    updateMainTabVisibility();\n });\n let button9 = (<HTMLInputElement>document.getElementById('vaiz9'));\n button9?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n    klCanvasWorkspace.setMode('shape');\n    toolspaceToolRow.setActive('shape');\n    mainTabRow.open('shape');\n    updateMainTabVisibility()\n});\nlet button10 = (<HTMLInputElement>document.getElementById('vaiz10'));\nbutton10?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n                klCanvasWorkspace.setMode('fill');\n                toolspaceToolRow.setActive('fill');\n                mainTabRow.open('fill');\n                updateMainTabVisibility();\n});\nlet button11 = (<HTMLInputElement>document.getElementById('vaiz11'));\nbutton11?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n\n    (async () => {\n        let success = true;\n        try {\n            await projectStore.store(klCanvas.getProject());\n        } catch (e) {\n            success = false;\n            setTimeout(() => {\n                throw new Error('keyboard-shortcut: failed to store browser storage, ' + e);\n            }, 0);\n            statusOverlay.out('❌ ' + LANG('file-storage-failed'), true);\n        }\n        if (success) {\n            pOptions.saveReminder.reset();\n            statusOverlay.out(LANG('file-storage-stored'), true);\n        }\n    })();\n});\nlet button12 = (<HTMLInputElement>document.getElementById('vaiz12'));\nbutton12?.addEventListener('touchstart', function handleClick(event) {\n    event.preventDefault();\n    undoRedoCatchup.undo();\n\n});\n  \n   \n    /**\n     *\n     * @param importedImage - convertedPsd | {type: 'image', width: number, height: number, canvas: image | canvas}\n     * @param filename - string e.g. 'drawing.psd'\n     * @param optionStr? - 'default' | 'layer' | 'image'\n     */\n    function importFinishedLoading(\n        importedImage: IKlPsd | {\n            type: 'image';\n            width: number;\n            height: number;\n            canvas: HTMLCanvasElement | HTMLImageElement;\n        },\n        filename: string,\n        optionStr: 'default' | 'layer' | 'image',\n    ) {\n        if (!importedImage || isNaN(importedImage.width) || isNaN(importedImage.height) || importedImage.width <= 0 || importedImage.height <= 0) {\n            KL.popup({\n                target: klRootEl,\n                type: \"error\",\n                message: LANG('import-broken-file'),\n                buttons: [\"Ok\"],\n            });\n            return;\n        }\n\n        function getResizedDimensions(width, height) {\n            let w = parseInt(width);\n            let h = parseInt(height);\n            if (w > klMaxCanvasSize) {\n                h = klMaxCanvasSize / w * h;\n                w = klMaxCanvasSize;\n            }\n            if (h > klMaxCanvasSize) {\n                w = klMaxCanvasSize / h * w;\n                h = klMaxCanvasSize;\n            }\n            w = parseInt('' + w);\n            h = parseInt('' + h);\n            return {\n                width: w,\n                height: h\n            }\n        }\n\n        function importAsImage(canvas) {\n            let resizedDimensions = getResizedDimensions(canvas.width, canvas.height);\n\n            //resize first\n            let tempCanvas = BB.canvas(canvas.width, canvas.height);\n            let tempCanvasCtx = tempCanvas.getContext('2d');\n            tempCanvasCtx.drawImage(canvas, 0, 0);\n\n            BB.resizeCanvas(tempCanvas, resizedDimensions.width, resizedDimensions.height);\n\n            klCanvas.reset({\n                width: resizedDimensions.width,\n                height: resizedDimensions.height,\n                image: tempCanvas,\n                layerName: filename\n            });\n\n            layerManager.update(0);\n            setCurrentLayer(klCanvas.getLayer(0));\n            klCanvasWorkspace.resetView();\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\n\n            isFirstImage = false;\n        }\n\n        /**\n         *\n         * @param convertedPsdObj - if flattened then without layers\n         * @param cropObj? - {x: number, y: number, width: number, height: number}\n         */\n        function importAsImagePsd(convertedPsdObj: IKlPsd, cropObj?) {\n\n            // crop\n            function crop(targetCanvas, cropCanvas, cropObj) {\n                cropCanvas.width = cropCanvas.width;\n                cropCanvas.getContext('2d').drawImage(targetCanvas, -cropObj.x, -cropObj.y);\n                targetCanvas.width = cropObj.width;\n                targetCanvas.height = cropObj.height;\n                targetCanvas.getContext('2d').drawImage(cropCanvas, 0, 0);\n            }\n            if (cropObj && (cropObj.width !== convertedPsdObj.width ||cropObj.height !== convertedPsdObj.height)) {\n                let cropCanvas = BB.canvas(cropObj.width, cropObj.height);\n                convertedPsdObj.width = cropObj.width;\n                convertedPsdObj.height = cropObj.height;\n\n                if (!convertedPsdObj.layers) {\n                    crop(convertedPsdObj.canvas, cropCanvas, cropObj);\n                }\n                if (convertedPsdObj.layers) {\n                    for (let i = 0; i < convertedPsdObj.layers.length; i++) {\n                        let item = convertedPsdObj.layers[i];\n                        crop(item.image, cropCanvas, cropObj);\n                    }\n                }\n            }\n\n            // resize\n            let resizedDimensions = getResizedDimensions(convertedPsdObj.width, convertedPsdObj.height);\n            convertedPsdObj.width = resizedDimensions.width;\n            convertedPsdObj.height = resizedDimensions.height;\n            if (!convertedPsdObj.layers) {\n                BB.resizeCanvas(convertedPsdObj.canvas, convertedPsdObj.width, convertedPsdObj.height);\n            }\n            if (convertedPsdObj.layers) {\n                for (let i = 0; i < convertedPsdObj.layers.length; i++) {\n                    let item = convertedPsdObj.layers[i];\n                    BB.resizeCanvas(item.image, convertedPsdObj.width, convertedPsdObj.height);\n                }\n            }\n\n            let layerIndex;\n            if (convertedPsdObj.layers) {\n                layerIndex = klCanvas.reset({\n                    width: convertedPsdObj.width,\n                    height: convertedPsdObj.height,\n                    layers: convertedPsdObj.layers\n                });\n            } else {\n                layerIndex = klCanvas.reset({\n                    width: convertedPsdObj.width,\n                    height: convertedPsdObj.height,\n                    image: convertedPsdObj.canvas\n                });\n            }\n            layerManager.update(layerIndex);\n            setCurrentLayer(klCanvas.getLayer(layerIndex));\n            klCanvasWorkspace.resetView();\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\n\n            isFirstImage = false;\n        }\n\n        function importAsLayer(canvas) {\n            KL.showImportAsLayerDialog({\n                target: klRootEl,\n                klCanvas: klCanvas,\n                importImage: canvas,\n                callback: function(transformObj, isPixelated: boolean) {\n                    if (!transformObj) {\n                        return;\n                    }\n\n                    klHistory.pause(true);\n                    klCanvas.addLayer();\n                    let layers = klCanvas.getLayers();\n                    let activeLayerIndex = layers.length - 1;\n                    if (filename) {\n                        klCanvas.renameLayer(activeLayerIndex, filename);\n                    }\n                    let activeLayerContext = klCanvas.getLayerContext(activeLayerIndex);\n                    BB.drawTransformedImageWithBounds(activeLayerContext, canvas, transformObj, null, isPixelated);\n                    setCurrentLayer(klCanvas.getLayer(activeLayerIndex));\n                    layerManager.update(activeLayerIndex);\n\n                    klHistory.pause(false);\n\n                    klHistory.push({\n                        tool: [\"misc\"],\n                        action: \"importImage\",\n                        params: [BB.copyCanvas(activeLayerContext.canvas), filename]\n                    });\n                }\n            });\n        }\n\n\n        if (optionStr === 'default' || !optionStr) {\n            KL.showImportImageDialog({\n                image: importedImage,\n                target: klRootEl,\n                maxSize: klMaxCanvasSize,\n                callback: function(res) {\n                    if (res.type === 'as-image') {\n                        importAsImage(res.image);\n                    } else if (res.type === 'as-image-psd') {\n                        importAsImagePsd(res.image, res.cropObj);\n                    } else if (res.type === 'as-layer') {\n                        importAsLayer(res.image);\n                    } else if (res.type === 'cancel') {\n                        // nothing to do\n                    }\n                }\n            });\n        }\n\n        if (optionStr === 'layer') {\n            importAsLayer(importedImage.canvas);\n        }\n        if (optionStr === 'image') {\n            if (importedImage.type === 'psd') {\n                importAsImagePsd(importedImage);\n            } else {\n                importAsImage(importedImage.canvas);\n            }\n        }\n\n    }\n\n    function onPaste(e) {\n        if (KL.dialogCounter.get() > 0) {\n            return;\n        }\n\n        function retrieveImageFromClipboardAsBlob(pasteEvent, callback) {\n            if (pasteEvent.clipboardData == false) {\n                if (typeof (callback) == \"function\") {\n                    callback(undefined);\n                }\n            }\n\n            let items = pasteEvent.clipboardData.items;\n\n            if (items == undefined) {\n                if (typeof (callback) == \"function\") {\n                    callback(undefined);\n                }\n            } else {\n                for (let i = 0; i < items.length; i++) {\n                    if (items[i].type.indexOf(\"image\") == -1) {\n                        continue;\n                    }\n                    let blob = items[i].getAsFile();\n\n                    if (typeof (callback) == \"function\") {\n                        callback(blob);\n                    }\n                }\n            }\n\n        }\n\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (e.clipboardData.files[0]) {\n            retrieveImageFromClipboardAsBlob(e, function (imageBlob) {\n                // If there's an image, display it in the canvas\n                if (imageBlob) {\n                    let img = new Image();\n                    img.onload = function () {\n                        importFinishedLoading({\n                            type: 'image',\n                            width: img.width,\n                            height: img.height,\n                            canvas: img\n                        }, null, 'default');\n                    };\n                    let URLObj = window.URL || window.webkitURL;\n                    img.src = URLObj.createObjectURL(imageBlob);\n                }\n            });\n        } else if (e.clipboardData.items[0]) {\n            e.clipboardData.items[0].getAsString(function(pasteStr) {\n                pasteStr = pasteStr.trim();\n                if (pasteStr.match(/^https?/)) {\n                    // url\n                    let img = new Image();\n                    img.onload = function () {\n                        importFinishedLoading({\n                            type: 'image',\n                            width: img.width,\n                            height: img.height,\n                            canvas: img\n                        }, null, 'default');\n                    };\n                    img.onerror = function (e) {\n                        console.log('error loading', e);\n                    };\n                    img.crossOrigin = 'Anonymous';\n                    img.src = pasteStr;\n\n                } else if (pasteStr.match(/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/)) {\n                    // url\n                    let rgbObj = BB.ColorConverter.hexToRGB(pasteStr.replace('#', ''));\n                    brushSettingService.setColor(rgbObj);\n                }\n            });\n\n        }\n    }\n\n    function handleFileSelect(files, optionStr) {\n\n        function showWarningPsdFlattened() {\n            KL.popup({\n                target: klRootEl,\n                type: \"warning\",\n                message: LANG('import-psd-unsupported') + \"<br /><br />\",\n                buttons: [\"Ok\"],\n            });\n        }\n\n        let hasUnsupportedFile = false;\n        for (let i = 0, file; file = files[i]; i++) {\n            let extension = file.name.split(\".\");\n            extension = extension[extension.length - 1].toLowerCase();\n            if (extension === \"psd\") {\n\n                (function(f) {\n                    let loaderSizeBytes = 1024 * 1024 * 25; // 25mb\n                    let maxSizeBytes = 1024 * 1024 * 1024; // 1gb\n                    let maxResolution = 4096;\n\n                    if (f.size >= maxSizeBytes) { // pretty likely to break stuff\n                        KL.popup({\n                            target: klRootEl,\n                            type: \"error\",\n                            message: \"File too big. Unable to import.<br /><br />\",\n                            buttons: [\"Ok\"],\n                        });\n                        return;\n                    }\n\n                    let doShowLoader = files.length === 1 && f.size >= loaderSizeBytes;\n                    let loaderIsOpen = true;\n                    let closeLoader;\n\n                    if (doShowLoader) {\n                        KL.popup({\n                            target: klRootEl,\n                            message: LANG('import-opening'),\n                            callback: function (result) {\n                                loaderIsOpen = false;\n                                closeLoader = null;\n                            },\n                            closefunc: function (f) {\n                                closeLoader = f;\n                            }\n                        });\n                    }\n\n\n                    let reader = new FileReader();\n                    reader.onload = function (readerResult) {\n\n                        KL.loadAgPsd().then(function(agPsdLazy) {\n\n                            if (doShowLoader && !loaderIsOpen) {\n                                return;\n                            }\n\n                            try {\n                                let psd;\n\n                                // first pass, only read metadata\n                                psd = agPsdLazy.readPsd(\n                                    (readerResult.target.result as any),\n                                    {\n                                        skipLayerImageData: true,\n                                        skipThumbnail: true,\n                                        skipCompositeImageData: true\n                                    });\n                                if (psd.width > maxResolution || psd.height > maxResolution) {\n                                    if (closeLoader) {\n                                        closeLoader();\n                                    }\n                                    KL.popup({\n                                        target: klRootEl,\n                                        type: \"error\",\n                                        //message: \"Image exceeds maximum dimensions of \" + maxResolution + \" x \" + maxResolution + \" pixels. Unable to import.\"\n                                        message: LANG('import-psd-too-large').replace(/{x}/g, '' + maxResolution)\n                                            + \"<br /><br />\"\n                                            + LANG('import-psd-size') + \": \" + psd.width + \" x \" + psd.height + ' pixels'\n                                            + \"<br /><br />\"\n                                        ,\n                                        buttons: [\"Ok\"],\n                                    });\n                                    return;\n                                }\n\n\n                                // second pass, now load actual data.\n                                psd = null;\n\n                                try {\n                                    psd = agPsdLazy.readPsd((readerResult.target.result as any));\n                                } catch (e) {\n                                    //console.log('failed regular psd import', e);\n                                }\n                                if (psd) {\n                                    //console.log('psd', psd);\n                                    let convertedPsd = KL.PSD.readPsd(psd);\n                                    //console.log('converted', convertedPsd);\n                                    if (optionStr === 'image' && convertedPsd.error) {\n                                        showWarningPsdFlattened();\n                                    }\n\n                                    if (closeLoader) {\n                                        closeLoader();\n                                    }\n                                    importFinishedLoading(convertedPsd, f.name, optionStr);\n                                } else {\n                                    psd = agPsdLazy.readPsd((readerResult.target.result as any), { skipLayerImageData: true, skipThumbnail: true });\n                                    if (optionStr === 'image') {\n                                        showWarningPsdFlattened();\n                                    }\n\n                                    if (closeLoader) {\n                                        closeLoader();\n                                    }\n                                    importFinishedLoading({\n                                        type: 'psd',\n                                        width: psd.width,\n                                        height: psd.height,\n                                        canvas: psd.canvas,\n                                        error: true\n                                    }, f.name, optionStr);\n                                }\n\n\n                            } catch (e) {\n                                if (closeLoader) {\n                                    closeLoader();\n                                }\n                                KL.popup({\n                                    target: klRootEl,\n                                    type: \"error\",\n                                    message: \"Failed to load PSD.<br /><br />\",\n                                    buttons: [\"Ok\"],\n                                });\n                            }\n                        }).catch(() => {\n                            closeLoader();\n                            alert('Error: failed to load PSD library');\n                        });\n\n                    };\n                    reader.readAsArrayBuffer(f);\n                })(file);\n\n            } else if (file.type.match('image.*')) {\n                (function (f) {\n                    window.URL = window.URL || window.webkitURL;\n                    let url = window.URL.createObjectURL(f);\n                    let im = new Image();\n                    im.src = url;\n                    BB.loadImage(im, function () {\n                        importFinishedLoading({\n                            type: 'image',\n                            width: im.width,\n                            height: im.height,\n                            canvas: im\n                        }, f.name, optionStr);\n                    });\n                })(file);\n            } else {\n                hasUnsupportedFile = true;\n            }\n        }\n        if (hasUnsupportedFile) {\n            KL.popup({\n                target: klRootEl,\n                message: LANG('import-unsupported-file'),\n                type: 'error',\n                buttons: ['OK'],\n            });\n        }\n    }\n\n    if (!pOptions.embed) {\n        new KL.KlImageDropper({\n            target: document.body,\n            onDrop: function(files, optionStr) {\n                if (KL.dialogCounter.get() > 0) {\n                    return;\n                }\n                handleFileSelect(files, optionStr);\n            },\n            enabledTest: function() {\n                return KL.dialogCounter.get() === 0;\n            }\n        });\n\n        BB.addEventListener(window, 'paste', onPaste, false);\n    }\n\n    const brushUiObj: any = {};\n\n    // create brush UIs\n    for (let b in KL.brushesUI) {\n        if (KL.brushesUI.hasOwnProperty(b)) {\n            let ui = new KL.brushesUI[b].Ui({\n                onSizeChange: sizeWatcher,\n                onOpacityChange: function(opacity) {\n                    brushSettingService.emitOpacity(opacity);\n                },\n                onConfigChange: () => {\n                    brushSettingService.emitSliderConfig({\n                        sizeSlider: KL.brushesUI[currentBrushId].sizeSlider,\n                        opacitySlider: KL.brushesUI[currentBrushId].opacitySlider\n                    });\n                }\n            });\n            brushUiObj[b] = ui;\n            ui.getElement().style.padding = 10 + 'px';\n        }\n    }\n\n\n    BB.css(klRootEl, {\n        position: 'absolute',\n        left: '0',\n        top: '0',\n        right: '0',\n        bottom: '0'\n    });\n\n    let statusOverlay = new KL.StatusOverlay();\n\n    const toolspace = BB.el({});\n    const toolspaceInner = BB.el({\n        parent: toolspace,\n    });\n    toolspace.oncontextmenu = function () {\n        return false;\n    };\n    toolspace.onclick = BB.handleClick;\n\n\n    let toolspaceCollapser = new KL.ToolspaceCollapser({\n        onChange: function() {\n            updateCollapse();\n        }\n    });\n    function updateCollapse() {\n\n        //collapser\n        if (uiWidth < collapseThreshold) {\n            toolspaceCollapser.getElement().style.display = 'block';\n\n            toolspaceCollapser.setDirection(uiState);\n            if (toolspaceCollapser.isOpen()) {\n                if (uiState === 'left') {\n                    BB.css(toolspaceCollapser.getElement(), {\n                        left: '271px',\n                        right: '',\n                    });\n                    BB.css(klCanvasWorkspace.getElement(), {\n                        left: '271px'\n                    });\n                } else {\n                    BB.css(toolspaceCollapser.getElement(), {\n                        left: '',\n                        right: '271px'\n                    });\n                    BB.css(klCanvasWorkspace.getElement(), {\n                        left: '0'\n                    });\n                }\n                toolspace.style.display = 'block';\n                klCanvasWorkspace.setSize(Math.max(0, uiWidth - toolWidth), uiHeight);\n                statusOverlay.setWide(false);\n\n            } else {\n                if (uiState === 'left') {\n                    BB.css(toolspaceCollapser.getElement(), {\n                        left: '0',\n                        right: '',\n                    });\n                    BB.css(klCanvasWorkspace.getElement(), {\n                        left: '0'\n                    });\n                } else {\n                    BB.css(toolspaceCollapser.getElement(), {\n                        left: '',\n                        right: '0'\n                    });\n                    BB.css(klCanvasWorkspace.getElement(), {\n                        left: '0'\n                    });\n                }\n                toolspace.style.display = 'none';\n                klCanvasWorkspace.setSize(Math.max(0, uiWidth), uiHeight);\n                statusOverlay.setWide(true);\n\n            }\n\n        } else {\n            toolspaceCollapser.getElement().style.display = 'none';\n            if (uiState === 'left') {\n                BB.css(klCanvasWorkspace.getElement(), {\n                    left: '271px'\n                });\n            } else {\n                BB.css(klCanvasWorkspace.getElement(), {\n                    left: '0'\n                });\n            }\n            toolspace.style.display = 'block';\n            klCanvasWorkspace.setSize(Math.max(0, uiWidth - toolWidth), uiHeight);\n            statusOverlay.setWide(false);\n\n        }\n    }\n    updateCollapse();\n\n    function updateUi() {\n        if (uiState === 'left') {\n            BB.css(toolspace, {\n                left: '0',\n                right: '',\n                borderLeft: 'none',\n                borderRight: '1px solid rgb(135, 135, 135)'\n            });\n            BB.css(klCanvasWorkspace.getElement(), {\n                left: '271px'\n            });\n        } else {\n            BB.css(toolspace, {\n                left: '',\n                right: '0',\n                borderLeft: '1px solid rgb(135, 135, 135)',\n                borderRight: 'none'\n            });\n            BB.css(klCanvasWorkspace.getElement(), {\n                left: '0'\n            });\n        }\n        statusOverlay.setUiState(uiState);\n        layerPreview.setUiState('' + uiState);\n        layerManager.setUiState('' + uiState);\n        updateCollapse();\n        toolspaceScroller.updateUiState(uiState);\n    }\n\n\n\n    let overlayToolspace;\n    setTimeout(function() {\n        overlayToolspace = new KL.OverlayToolspace({\n            enabledTest: function() {\n                return KL.dialogCounter.get() === 0 && !lineSanitizer.getIsDrawing();\n            },\n            brushSettingService,\n        });\n        klRootEl.appendChild(overlayToolspace.getElement());\n    }, 0);\n\n    BB.append(klRootEl, [klCanvasWorkspace.getElement(), toolspace, toolspaceCollapser.getElement()]);\n\n    BB.css(toolspace, {\n        position: \"absolute\",\n        right: '0',\n        top: '0',\n        bottom: '0',\n        width: (toolWidth - 1) + \"px\",\n\n        overflow: \"hidden\",\n        backgroundColor: \"#ddd\",\n        borderLeft: \"1px solid rgb(135, 135, 135)\",\n        userSelect: 'none',\n        touchAction: 'none'\n    });\n\n    let toolspaceTopRow;\n    if (pOptions.embed) {\n        toolspaceTopRow = new ToolspaceTopRow({\n            onHelp: () => {\n                showIframePopup(pOptions.embed.url + '/help.html', !!pOptions.embed);\n            },\n            onSubmit: () => {\n                KL.popup({\n                    target: klRootEl,\n                    message: LANG('submit-prompt'),\n                    buttons: [LANG('submit'), 'Cancel'],\n                    callback: async (result) => {\n                        if (result !== LANG('submit')) {\n                            return;\n                        }\n\n                        let overlay = BB.el({\n                            parent: klRootEl,\n                            className: 'upload-overlay',\n                            content: '<div class=\"spinner\"></div> ' + LANG('submit-submitting'),\n                        });\n\n                        pOptions.embed.onSubmit(\n                            () => {\n                                pOptions.saveReminder.reset();\n                                klRootEl.removeChild(overlay);\n                            },\n                            () => {\n                                klRootEl.removeChild(overlay);\n                            });\n                    }\n                });\n            },\n            onLeftRight: () => {\n                uiState = uiState === 'left' ? 'right' : 'left';\n                updateUi();\n            },\n        });\n    } else {\n        toolspaceTopRow = new KL.ToolspaceTopRow({\n            logoImg: pOptions.logoImg,\n            onLogo: function() {\n                showIframePopup('./home/', !!pOptions.embed);\n            },\n            onNew: function() {\n                showNewImageDialog();\n            },\n            onImport: function() {\n                fileTab.triggerImport();\n            },\n            onSave: function() {\n                saveToComputer.save();\n            },\n            onShare: function() {\n                shareImage();\n            },\n            onHelp: function() {\n                showIframePopup('./help/', !!pOptions.embed);\n            },\n        });\n    }\n    BB.addClassName(toolspaceTopRow.getElement(), 'toolspace-row-shadow');\n    toolspaceTopRow.getElement().style.marginBottom = '10px';\n  \n\n    let toolspaceToolRow = new KL.ToolspaceToolRow({\n        onActivate: function(activeStr) {\n            if (activeStr === 'draw') {\n                klCanvasWorkspace.setMode('draw');\n            } else if (activeStr === 'hand') {\n                klCanvasWorkspace.setMode('hand');\n            } else if (activeStr === 'fill') {\n                klCanvasWorkspace.setMode('fill');\n            } else if (activeStr === 'text') {\n                klCanvasWorkspace.setMode('text');\n            } else if (activeStr === 'shape') {\n                klCanvasWorkspace.setMode('shape');\n            } else {\n                throw new Error('unknown activeStr');\n            }\n            mainTabRow.open(activeStr);\n            updateMainTabVisibility();\n            klColorSlider.pickingDone();\n        },\n        onZoomIn: function() {\n            klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? 1/8 : 1/2);\n        },\n        onZoomOut: function() {\n            klCanvasWorkspace.zoomByStep(keyListener.isPressed('shift') ? -1/8 : -1/2);\n        },\n        onUndo: function() {\n            undoRedoCatchup.undo();\n        },\n        onRedo: function() {\n            undoRedoCatchup.redo();\n        }\n    });\n    toolspaceToolRow.setIsSmall(uiHeight < 540);\n    klHistory.addListener(function() {\n        toolspaceToolRow.setEnableUndo(klHistory.canUndo());\n        toolspaceToolRow.setEnableRedo(klHistory.canRedo());\n    });\n    BB.addClassName(toolspaceToolRow.getElement(), 'toolspace-row-shadow');\n   \n\n    let klColorSlider;\n\n    function setCurrentBrush(brushId) {\n        if (brushId !== 'eraserBrush') {\n            lastNonEraserBrushId = brushId;\n        }\n\n        if (klColorSlider) {\n            if (brushId === 'eraserBrush') {\n                klColorSlider.enable(false);\n            } else {\n                klColorSlider.enable(true);\n            }\n        }\n\n        currentBrushId = brushId;\n        currentBrush = brushUiObj[brushId];\n        currentBrush.setColor(currentColor);\n        currentBrush.setContext(currentLayerCtx);\n        klCanvasWorkspace.setMode('draw');\n        toolspaceToolRow.setActive('draw');\n        updateMainTabVisibility();\n    }\n\n    function setCurrentLayer(layer) { //BrushContext(p_context) {\n        currentLayerCtx = layer.context;\n        currentBrush.setContext(layer.context);\n        layerPreview.setLayer(layer);\n    }\n\n    function setBrushColor(p_color) {\n        currentColor = p_color;\n        currentBrush.setColor(p_color);\n        brushSettingService.emitColor(p_color);\n        klColorSlider.pickingDone();\n    }\n\n    klColorSlider = new KL.KlColorSlider({\n        width: 250,\n        height: 30,\n        svHeight: 100,\n        startValue: new BB.RGB(0, 0, 0),\n        onPick: setBrushColor\n    });\n    klColorSlider.setHeight(Math.max(163, Math.min(400, uiHeight - 505)));\n    klColorSlider.setPickCallback(function (doPick) {\n\n        if (doPick) {\n            klCanvasWorkspace.setMode('pick');\n        } else {\n            klCanvasWorkspace.setMode(toolspaceToolRow.getActive());\n            updateMainTabVisibility();\n        }\n\n    });\n    let brushDiv = document.createElement(\"div\");\n    let colorDiv = document.createElement(\"div\");\n    BB.css(colorDiv, {\n        margin: '10px',\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'space-between',\n        alignItems: 'flex-end'\n    });\n    let toolspaceStabilizerRow = new KL.ToolspaceStabilizerRow({\n        smoothing: 1,\n        onSelect: function(v) {\n            lineSmoothing.setSmoothing(translateSmoothing(v));\n        }\n    });\n    brushDiv.appendChild(colorDiv);\n  \n\n\n    \n    BB.append(\n        colorDiv,\n        [klColorSlider.getElement(), klColorSlider.getOutputElement(), toolspaceStabilizerRow.getElement()]\n    );\n\n    let brushTabRow = new KL.TabRow({\n        initialId: 'penBrush',\n        useAccent: true,\n        tabArr: (function () {\n            let result = [];\n\n            function createTab(keyStr) {\n                return {\n                    id: keyStr,\n                    image: KL.brushesUI[keyStr].image,\n                    title: KL.brushesUI[keyStr].tooltip,\n                    onOpen: function() {\n                        brushUiObj[keyStr].getElement().style.display = 'block';\n                        setCurrentBrush(keyStr);\n                        klColorSlider.pickingDone();\n                        brushSettingService.emitSliderConfig({\n                            sizeSlider: KL.brushesUI[keyStr].sizeSlider,\n                            opacitySlider: KL.brushesUI[keyStr].opacitySlider\n                        });\n                        sizeWatcher(brushUiObj[keyStr].getSize());\n                        brushSettingService.emitOpacity(brushUiObj[keyStr].getOpacity());\n                    },\n                    onClose: function() {\n                        brushUiObj[keyStr].getElement().style.display = 'none';\n                    }\n                };\n            }\n\n            let keyArr = Object.keys(brushUiObj);\n            for (let i = 0; i < keyArr.length; i++) {\n                result.push(createTab(keyArr[i]));\n            }\n            return result;\n        })()\n    });\n  \n    for (let b in KL.brushesUI) {\n        if (KL.brushesUI.hasOwnProperty(b)) {\n            brushDiv.appendChild(brushUiObj[b].getElement());\n        }\n    }\n\n    const handUi = new KL.HandUi({\n        scale: 1,\n        angleDeg: 0,\n        onReset: function() {\n            klCanvasWorkspace.resetView(true);\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\n        },\n        onFit: function() {\n            klCanvasWorkspace.fitView();\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\n        },\n        onAngleChange: function(angleDeg, isRelative) {\n            klCanvasWorkspace.setAngle(angleDeg, isRelative);\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\n        },\n    });\n\n    let fillUi = new KL.FillUi({\n        colorSlider: klColorSlider\n    });\n\n    let textUi = new KL.TextUi({\n        colorSlider: klColorSlider\n    });\n\n    let shapeUi = new KL.ShapeUi({\n        colorSlider: klColorSlider\n    });\n\n    let shapeTool = new KL.ShapeTool({\n        onShape: function(isDone, x1, y1, x2, y2, angleRad) {\n\n            let layerIndex = klCanvas.getLayerIndex(currentLayerCtx.canvas);\n\n            let shapeObj: any = {\n                type: shapeUi.getShape(),\n                x1: x1,\n                y1: y1,\n                x2: x2,\n                y2: y2,\n                angleRad: angleRad,\n                isOutwards: shapeUi.getIsOutwards(),\n                opacity: shapeUi.getOpacity(),\n                isEraser: shapeUi.getIsEraser()\n            };\n            if (shapeUi.getShape() === 'line') {\n                shapeObj.strokeRgb = klColorSlider.getColor();\n                shapeObj.lineWidth = shapeUi.getLineWidth();\n            } else {\n                if (shapeUi.getMode() === 'stroke') {\n                    shapeObj.strokeRgb = klColorSlider.getColor();\n                    shapeObj.lineWidth = shapeUi.getLineWidth();\n                } else {\n                    shapeObj.fillRgb = klColorSlider.getColor();\n                }\n            }\n\n            if (isDone) {\n                klCanvas.setComposite(layerIndex, null);\n                klCanvas.drawShape(layerIndex, shapeObj);\n            } else {\n                klCanvas.setComposite(layerIndex, {\n                    draw: function(ctx) {\n                        KL.drawShape(ctx, shapeObj);\n                    }\n                });\n            }\n            klCanvasWorkspace.requestFrame();\n\n        }\n    });\n\n    const layerManager = KL.klLayerManager(klCanvas, function (val) {\n        setCurrentLayer(klCanvas.getLayer(val));\n        klHistory.push({\n            tool: [\"misc\"],\n            action: \"focusLayer\",\n            params: [val]\n        });\n    }, klRootEl) as any;\n    const layerPreview = new KL.LayerPreview({\n        klRootEl: klRootEl,\n        onClick: function () {\n            mainTabRow.open('layers');\n        }\n    });\n    layerPreview.setIsVisible(uiHeight >= 579);\n    layerPreview.setLayer(klCanvas.getLayer(klCanvas.getLayerIndex(currentLayerCtx.canvas)));\n\n    const filterTab = new KL.FilterTab(\n        klRootEl,\n        klColorSlider,\n        layerManager,\n        setCurrentLayer,\n        klCanvasWorkspace,\n        handUi,\n        () => { //get current color\n            return currentColor;\n        },\n        () => { // get max canvas size\n            return klMaxCanvasSize;\n        },\n        () => { // get kl canvas\n            return klCanvas;\n        },\n        () => { // get current layer ctx\n            return currentLayerCtx;\n        },\n        !!pOptions.embed,\n        statusOverlay,\n    );\n\n    const undoRedoCatchup = new KL.UndoRedoCatchup(\n        brushUiObj,\n        layerPreview,\n        layerManager,\n        handUi,\n        klCanvasWorkspace,\n        () => {\n            if (!initState) {\n                throw new Error('initState not initialized');\n            }\n            return initState;\n        },\n        () => klCanvas,\n        () => currentLayerCtx,\n        (clctx) => {\n            currentLayerCtx = clctx;\n        },\n        () => currentBrush,\n    );\n    klHistory.addListener((p) => {\n        undoRedoCatchup.catchup(p);\n    });\n\n    function showNewImageDialog() {\n        KL.newImageDialog({\n            currentColor: currentColor,\n            secondaryColor: klColorSlider.getSecondaryRGB(),\n            maxCanvasSize: klMaxCanvasSize,\n            canvasWidth: klCanvas.getWidth(),\n            canvasHeight: klCanvas.getHeight(),\n            workspaceWidth: window.innerWidth < collapseThreshold ? uiWidth : uiWidth - toolWidth,\n            workspaceHeight: uiHeight,\n            onConfirm: function(width, height, color) {\n                klCanvas.reset({\n                    width: width,\n                    height: height,\n                    color: color.a === 1 ? color : null\n                });\n\n                layerManager.update(0);\n                setCurrentLayer(klCanvas.getLayer(0));\n                klCanvasWorkspace.resetView();\n                handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\n\n                isFirstImage = false;\n            },\n            onCancel: function() {}\n        });\n    }\n\n    function shareImage(callback?) {\n        BB.shareCanvas({\n            canvas: klCanvas.getCompleteCanvas(1),\n            fileName: BB.getDate() + filenameBase + '.png',\n            title: BB.getDate() + filenameBase + '.png',\n            callback: callback ? callback : function() {}\n        });\n    }\n\n    const saveToComputer = new KL.SaveToComputer(\n        pOptions.saveReminder,\n        klRootEl,\n        () => exportType,\n        () => klCanvas,\n        filenameBase,\n    );\n\n    const fileTab = pOptions.embed ? null : new KL.FileTab(\n        klRootEl,\n        projectStore,\n        () => klCanvas.getProject(),\n        exportType,\n        (type) => {\n            exportType = type;\n        },\n        handleFileSelect,\n        () => {\n            saveToComputer.save();\n        },\n        showNewImageDialog,\n        shareImage,\n        () => { // on upload\n            KL.imgurUpload(klCanvas, klRootEl, pOptions.saveReminder, pOptions.app && pOptions.app.imgurKey ? pOptions.app.imgurKey : null, );\n        },\n        copyToClipboard,\n        pOptions.saveReminder,\n    );\n\n    const settingsTab = new KL.SettingsTab(\n        () => {\n            uiState = uiState === 'left' ? 'right' : 'left';\n            updateUi();\n            if (!pOptions.embed) {\n                LocalStorage.setItem('uiState', uiState);\n            }\n        },\n        pOptions.aboutEl\n    );\n\n    mainTabRow = new KL.TabRow({\n        initialId: 'draw',\n        tabArr: [\n            {\n                id: 'draw',\n                title: LANG('tool-brush'),\n                image: toolPaintImg,\n                onOpen: function() {\n                    if (currentBrushId === 'eraserBrush') {\n                        klColorSlider.enable(false);\n                    }\n                    BB.append(\n                        colorDiv,\n                        [klColorSlider.getElement(), klColorSlider.getOutputElement(), toolspaceStabilizerRow.getElement()]\n                    );\n                    brushDiv.style.display = 'block';\n                },\n                onClose: function() {\n                    brushDiv.style.display = 'none';\n                },\n                css: {\n                    minWidth: '45px',\n                }\n            },\n            {\n                id: 'hand',\n                title: LANG('tool-hand'),\n                image: toolHandImg,\n                isVisible: false,\n                onOpen: function() {\n                    handUi.setIsVisible(true);\n                },\n                onClose: function() {\n                    handUi.setIsVisible(false);\n                },\n                css: {\n                    minWidth: '45px',\n                }\n            },\n            {\n                id: 'fill',\n                title: LANG('tool-paint-bucket'),\n                image: toolFillImg,\n                isVisible: false,\n                onOpen: function() {\n                    klColorSlider.enable(true);\n                    fillUi.setIsVisible(true);\n                },\n                onClose: function() {\n                    fillUi.setIsVisible(false);\n                },\n                css: {\n                    minWidth: '45px',\n                }\n            },\n            {\n                id: 'text',\n                title: LANG('tool-text'),\n                image: toolTextImg,\n                isVisible: false,\n                onOpen: function() {\n                    klColorSlider.enable(true);\n                    textUi.setIsVisible(true);\n                },\n                onClose: function() {\n                    textUi.setIsVisible(false);\n                },\n                css: {\n                    minWidth: '45px',\n                }\n            },\n            {\n                id: 'shape',\n                title: LANG('tool-shape'),\n                image: toolShapeImg,\n                isVisible: false,\n                onOpen: function() {\n                    klColorSlider.enable(true);\n                    shapeUi.setIsVisible(true);\n                },\n                onClose: function() {\n                    shapeUi.setIsVisible(false);\n                },\n                css: {\n                    minWidth: '45px',\n                }\n            },\n            {\n                id: 'layers',\n                title: LANG('tab-layers'),\n                image: tabLayersImg,\n                onOpen: function() {\n                    layerManager.update();\n                    layerManager.style.display = 'block';\n                },\n                onClose: function() {\n                    layerManager.style.display = 'none';\n                },\n                css: {\n                    minWidth: '45px',\n                }\n            },\n            {\n                id: 'edit',\n                label: LANG('tab-edit'),\n                onOpen: function() {\n                    filterTab.show();\n                },\n                onClose: function() {\n                    filterTab.hide();\n                },\n                css: {\n                    padding: '0 7px',\n                },\n            },\n            {\n                id: 'file',\n                label: LANG('tab-file'),\n                isVisible: !!fileTab,\n                onOpen: function() {\n                    if (!fileTab) {\n                        return;\n                    }\n                    fileTab.getElement().style.display = 'block';\n                    fileTab.setIsVisible(true);\n                },\n                onClose: function() {\n                    if (!fileTab) {\n                        return;\n                    }\n                    fileTab.getElement().style.display = 'none';\n                    fileTab.setIsVisible(false);\n                },\n                css: {\n                    padding: '0 7px',\n                },\n            },\n            {\n                id: 'settings',\n                title: LANG('tab-settings'),\n                image: tabSettingsImg,\n                onOpen: function() {\n                    settingsTab.getElement().style.display = 'block';\n                    // settingsTab.setIsVisible(true);\n                },\n                onClose: function() {\n                    settingsTab.getElement().style.display = 'none';\n                    // settingsTab.setIsVisible(false);\n                },\n                css: {\n                    minWidth: '45px',\n                }\n            }\n        ]\n    });\n    function updateMainTabVisibility() {\n        if (!mainTabRow) {\n            return;\n        }\n\n        let toolObj = {\n            'draw': {},\n            'hand': {},\n            'fill': {},\n            'text': {},\n            'shape': {}\n        };\n\n        let activeStr = toolspaceToolRow.getActive();\n        let oldTabId = mainTabRow.getOpenedTabId();\n\n        let keysArr = Object.keys(toolObj);\n        for (let i = 0; i < keysArr.length; i++) {\n            if (activeStr === keysArr[i]) {\n                mainTabRow.setIsVisible(keysArr[i], true);\n            } else {\n                mainTabRow.setIsVisible(keysArr[i], false);\n                if (oldTabId === keysArr[i]) {\n                    mainTabRow.open(activeStr);\n                }\n            }\n        }\n\n    }\n\n    function copyToClipboard(showCrop?) {\n        KL.clipboardDialog(klRootEl, klCanvas.getCompleteCanvas(1), function (inputObj) {\n            if (inputObj.left === 0 && inputObj.right === 0 && inputObj.top === 0 && inputObj.bottom === 0) {\n                return;\n            }\n            //do a crop\n            let p = {\n                context: currentLayerCtx,\n                canvas: klCanvas,\n                input: inputObj, //{left,right,top,bottom}\n                history: klHistory\n            };\n            KL.filterLib.cropExtend.apply(p);\n            layerManager.update();\n            klCanvasWorkspace.resetView();\n            handUi.update(klCanvasWorkspace.getScale(), klCanvasWorkspace.getAngleDeg());\n        }, statusOverlay, showCrop);\n    }\n\n    const bottomBarWrapper = BB.el({\n        css: {\n            width: \"270px\",\n            position: \"absolute\",\n            bottom: '0',\n            left: '0'\n        },\n    });\n    if (pOptions.bottomBar) {\n        bottomBarWrapper.append(pOptions.bottomBar);\n        const observer = new MutationObserver(() => updateBottomBar());\n        observer.observe(\n            toolspaceInner,\n            {\n                attributes: true,\n                childList: true,\n                subtree: true,\n            }\n        );\n    }\n    function updateBottomBar() {\n        if (!pOptions.bottomBar) {\n            return;\n        }\n        const threshold = 617; //590\n        const isVisible = (\n            threshold < window.innerHeight &&\n            toolspaceInner.scrollHeight + 50 < window.innerHeight\n        );\n        bottomBarWrapper.style.display = isVisible ? '' : 'none';\n    }\n\n\n\n    BB.append(toolspaceInner, [\n        layerPreview.getElement(),\n        mainTabRow.getElement(),\n        brushDiv,\n        handUi.getElement(),\n        fillUi.getElement(),\n        textUi.getElement(),\n        shapeUi.getElement(),\n        layerManager,\n        filterTab.getElement(),\n        fileTab ? fileTab.getElement() : null,\n        settingsTab.getElement(),\n        BB.el({\n            css: {\n                height: '10px', // a bit of spacing at the bottom\n            }\n        }),\n        bottomBarWrapper ? bottomBarWrapper : null\n    ]);\n\n    const toolspaceScroller = new KL.ToolspaceScroller({\n        toolspace,\n        uiState,\n    });\n\n    // --- interface ---\n\n    this.getEl = () => {\n        return klRootEl;\n    };\n\n    this.resize = (w, h) => {\n\n        // iPad scrolls down when increasing text zoom\n        if (window.scrollY > 0) {\n            window.scrollTo(0, 0);\n        }\n\n        if (uiWidth === Math.max(0, w) && uiHeight === Math.max(0, h)) {\n            return;\n        }\n\n        uiWidth = Math.max(0, w);\n        uiHeight = Math.max(0, h);\n\n        updateCollapse();\n        updateBottomBar();\n\n        layerPreview.setIsVisible(uiHeight >= 579);\n        klColorSlider.setHeight(Math.max(163, Math.min(400, uiHeight - 505)));\n        toolspaceToolRow.setIsSmall(uiHeight < 540);\n    };\n\n    this.out = (msg) => {\n        statusOverlay.out(msg);\n    };\n\n    this.getPNG = function(): Blob {\n        return base64ToBlob(klCanvas.getCompleteCanvas(1).toDataURL('image/png'));\n    };\n\n    this.getPSD = async function() {\n        return await klCanvasToPsdBlob(klCanvas);\n    };\n\n    this.swapUiLeftRight = () => {\n        uiState = uiState === 'left' ? 'right' : 'left';\n        if (!pOptions.embed) {\n            LocalStorage.setItem('uiState', uiState);\n        }\n        updateUi();\n    };\n\n    // --- end interface ---\n\n    this.resize(uiWidth, uiHeight);\n    updateUi();\n\n    {\n        BB.addEventListener(window, 'resize', () => {\n            this.resize(window.innerWidth, window.innerHeight);\n        });\n        BB.addEventListener(window, 'orientationchange', () => {\n            this.resize(window.innerWidth, window.innerHeight);\n        });\n\n        // iPad doesn't trigger 'resize' event when using text zoom, although it's resizing the window.\n        // Workaround: place a div in the body that fills the window, and use a ResizeObserver\n        const windowResizeWatcher = BB.el({\n            parent: document.body,\n            css: {\n                position: 'fixed',\n                left: '0',\n                top: '0',\n                right: '0',\n                bottom: '0',\n                pointerEvents: 'none',\n                zIndex: '-1',\n                userSelect: 'none',\n            }\n        });\n        const observer = new ResizeObserver(() => this.resize(window.innerWidth, window.innerHeight));\n        observer.observe(windowResizeWatcher);\n\n        // prevent ctrl scroll -> zooming page\n        BB.addEventListener(this.getEl(), 'wheel', (event) => {\n            event.preventDefault();\n        });\n        //maybe prevent zooming on safari mac os - I can't test it\n        const prevent = (e) => {\n            e.preventDefault();\n        }\n        window.addEventListener('gesturestart', prevent);\n        window.addEventListener('gesturechange', prevent);\n        window.addEventListener('gestureend', prevent);\n    }\n}","import {KL} from '../kl';\nimport {KlCanvas} from '../canvas/kl-canvas';\n\nexport async function klCanvasToPsdBlob(klCanvas: KlCanvas): Promise<Blob> {\n    let layerArr = klCanvas.getLayersFast();\n\n    let psdConfig = {\n        width: klCanvas.getWidth(),\n        height: klCanvas.getHeight(),\n        //canvas: klCanvas.getCompleteCanvas(1), // preview, can be skipped\n        children: []\n    };\n    for (let i = 0; i < layerArr.length; i++) {\n        // todo - can be optimized if layer mostly empty\n        let item = layerArr[i];\n        psdConfig.children.push({\n            name: item.name,\n            opacity: item.opacity,\n            canvas: item.canvas,\n            blendMode: KL.PSD.blendKlToPsd(item.mixModeStr),\n            left: 0,\n            top: 0\n        });\n    }\n\n    let agPsd = await import('ag-psd');\n    let buffer = agPsd.writePsdBuffer(psdConfig);\n    return new Blob([buffer], { type: 'application/octet-stream' });\n}","module.exports = require('./helpers/bundle-url').getBundleURL('lrLBb') + require('./helpers/bundle-manifest').resolve(\"ll6eH\");","/**\n * by bitbof (bitbof.com)\n */\n\nimport './polyfills';\nimport {BB} from './bb/bb';\nimport {KL} from './klecks/kl';\nimport {klHistory} from './klecks/history/kl-history';\nimport {KlApp} from './app/kl-app';\nimport {IKlProject} from './klecks/kl.types';\nimport {ProjectStore} from './klecks/storage/project-store';\nimport {initLANG, LANG} from './language/language';\n\n(async () => {\n    let klApp;\n\n    let domIsLoaded = false;\n    BB.addEventListener(window, 'DOMContentLoaded', () => {\n        domIsLoaded = true;\n    });\n    await initLANG();\n\n    function onProjectLoaded(project: IKlProject, projectStore: ProjectStore) {\n        if (klApp) {\n            throw 'onKlProjectObjLoaded called more than once';\n        }\n        let loadingScreenEl = document.getElementById(\"loading-screen\");\n        try {\n            // in case an extension screwed with the page\n            loadingScreenEl.parentNode.removeChild(loadingScreenEl);\n        } catch(e) {}\n\n        const saveReminder = new KL.SaveReminder(klHistory, true, true);\n        klApp = new KlApp(\n            project,\n            {\n                saveReminder,\n                projectStore,\n            }\n        );\n        saveReminder.init();\n        if (project) {\n            setTimeout(() => {\n                klApp.out(LANG('file-storage-restored'));\n            }, 100);\n        }\n\n        document.body.appendChild(klApp.getEl());\n    }\n\n    async function onDomLoaded() {\n        BB.removeEventListener(window, 'DOMContentLoaded', onDomLoaded);\n        let projectStore = new KL.ProjectStore();\n        let project: IKlProject = null;\n        try {\n            const readResult = await projectStore.read();\n            if (readResult) {\n                project = readResult.project;\n            }\n        } catch(e) {\n            let message;\n            if (e.message === 'db-error') {\n                message = 'Failed to access Browser Storage';\n            } else if (e.message === 'format-error') {\n                message = 'Failed to restore from Browser Storage';\n            }\n            if (message) {\n                setTimeout(function() {\n                    klApp && klApp.out(message);\n                    throw new Error('Initial browser storage error, ' + e);\n                }, 100);\n            }\n        }\n        onProjectLoaded(project, projectStore);\n    }\n    if (domIsLoaded) {\n        onDomLoaded();\n    } else {\n        BB.addEventListener(window, 'DOMContentLoaded', onDomLoaded);\n    }\n})();\n\n"],"names":["$eb0b43ccb27274c6$export$6503ec6e8aabbaf","$eb0b43ccb27274c6$export$f7ad0328861e2f03","$eb0b43ccb27274c6$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","$9d9981d69fbe6f4e$export$bdfd709ae4826697","$9d9981d69fbe6f4e$var$bundleURL","$9d9981d69fbe6f4e$var$getBaseURL","url","replace","value","err","matches","stack","match","$9d9981d69fbe6f4e$var$getBundleURL","module","exports","parcelRequire","getBundleURL","resolve","then","$20Uq9","bundle","Promise","reject","globalName","concat","Math","random","slice","$parcel$global","m","cleanup","script","onerror","remove","document","createElement","async","type","charset","textContent","e","head","appendChild","$177758dc750d50ea$var$cachedBundles","$177758dc750d50ea$var$cachedPreloads","$177758dc750d50ea$var$cachedPrefetches","$177758dc750d50ea$var$getCache","loader","cache","apply","arguments","catch","register","JSON","parse","$c50ffc0f2e583988$export$2d1720544b23b823","$0834d030a56df41c$var$check","it","$0834d030a56df41c$exports","globalThis","window","self","this","Function","$25ce2bf09e87d4f5$exports","$e811b8b8bcc3d0cc$exports","exec","error","defineProperty","get","$2131d32f017a3f2d$exports","test","bind","hasOwnProperty","$d96801109e977ba8$export$2d1720544b23b823","$5a792ef50f72f49f$var$call","prototype","call","$5a792ef50f72f49f$exports","$d96801109e977ba8$var$$propertyIsEnumerable","propertyIsEnumerable","$d96801109e977ba8$var$getOwnPropertyDescriptor","getOwnPropertyDescriptor","$d96801109e977ba8$var$NASHORN_BUG","V","descriptor","enumerable","$c5280afb79d6ceb9$exports","bitmap","configurable","writable","$e8d1494caa6f3e30$var$FunctionPrototype","$e8d1494caa6f3e30$var$bind","$e8d1494caa6f3e30$var$call","$e8d1494caa6f3e30$var$uncurryThis","$29aec266c4e1007e$var$toString","$e8d1494caa6f3e30$exports","fn","toString","$29aec266c4e1007e$var$stringSlice","$29aec266c4e1007e$exports","$397fe5e22a52d2d8$var$Object","$397fe5e22a52d2d8$var$split","split","$397fe5e22a52d2d8$exports","$76324429da950a1e$var$TypeError","TypeError","$76324429da950a1e$exports","undefined","$db675da45eb7478d$exports","$85af20a0b86b0d7d$exports","argument","$07a9402424762194$exports","$bb490ceccf6c6432$var$aFunction","$bb490ceccf6c6432$exports","namespace","method","$0b5963bcf723f9d9$exports","isPrototypeOf","$f32f65d2867e53dd$exports","$5fa271f1782463cb$var$match","$5fa271f1782463cb$var$version","$5fa271f1782463cb$var$process","process","$5fa271f1782463cb$var$Deno","Deno","$5fa271f1782463cb$var$versions","versions","version","$5fa271f1782463cb$var$v8","v8","$5fa271f1782463cb$exports","$c28cb00a6ca1e7be$exports","getOwnPropertySymbols","symbol","Symbol","String","sham","$0763518f9ca8fa24$exports","iterator","$1288776eef284c81$var$Object","$1288776eef284c81$exports","$Symbol","$6b4dfbe1204467ac$var$String","$6b4dfbe1204467ac$exports","$681965fe94d39091$var$TypeError","$681965fe94d39091$exports","$684a1bf188da9aad$exports","P","func","$909043b23fc49417$var$TypeError","$909043b23fc49417$exports","input","pref","val","valueOf","$9c607bf4a6aad7b2$var$defineProperty","$9c607bf4a6aad7b2$exports","key","$eeaec1c05e1ebbea$var$store","$eeaec1c05e1ebbea$exports","$692cf982eab82779$exports","push","mode","copyright","license","source","$b361577c359ef967$var$Object","$b361577c359ef967$exports","$a39be1d1ed57c1f4$var$hasOwnProperty","$a39be1d1ed57c1f4$exports","hasOwn","$f657a72046bed17a$var$id","$f657a72046bed17a$var$postfix","$f657a72046bed17a$var$toString","$f657a72046bed17a$exports","$6219bb8b2c212ee1$var$WellKnownSymbolsStore","$6219bb8b2c212ee1$var$Symbol","$6219bb8b2c212ee1$var$symbolFor","$6219bb8b2c212ee1$var$createWellKnownSymbol","withoutSetter","$6219bb8b2c212ee1$exports","name","description","$c97772a710dc1559$var$TypeError","$c97772a710dc1559$var$TO_PRIMITIVE","$c97772a710dc1559$exports","result","exoticToPrim","$7985486ff540527a$exports","$59664ad2154ee9ad$var$document","$59664ad2154ee9ad$var$EXISTS","$59664ad2154ee9ad$exports","$03bcf9b1d73f6db6$exports","a","$921317afb9b16431$export$2d1720544b23b823","$c50ffc0f2e583988$var$$getOwnPropertyDescriptor","O","$98a4761418b8b643$exports","$da3ea208b511b64a$var$String","$da3ea208b511b64a$var$TypeError","$da3ea208b511b64a$exports","$921317afb9b16431$var$TypeError","$921317afb9b16431$var$$defineProperty","$921317afb9b16431$var$$getOwnPropertyDescriptor","Attributes","current","$cd655e7303aa16d0$exports","object","$017720353ff41745$var$functionToString","inspectSource","$017720353ff41745$exports","$1d06022dec31acbc$var$WeakMap","WeakMap","$1d06022dec31acbc$exports","$8ee7add59f21acdb$var$keys","$8ee7add59f21acdb$exports","$f611d1eb6b8893bb$exports","$e1be46aae5c689b1$var$set","$e1be46aae5c689b1$var$get","$e1be46aae5c689b1$var$has","$e1be46aae5c689b1$var$TypeError","$e1be46aae5c689b1$var$WeakMap","state","$e1be46aae5c689b1$var$store","$e1be46aae5c689b1$var$wmget","$e1be46aae5c689b1$var$wmhas","has","$e1be46aae5c689b1$var$wmset","set","metadata","facade","$e1be46aae5c689b1$var$STATE","$e1be46aae5c689b1$exports","enforce","getterFor","TYPE","$835335ee56737e1d$var$FunctionPrototype","$835335ee56737e1d$var$getDescriptor","$835335ee56737e1d$var$EXISTS","$835335ee56737e1d$exports","EXISTS","PROPER","CONFIGURABLE","$df23d35b1920ffed$var$getInternalState","$df23d35b1920ffed$var$enforceInternalState","$df23d35b1920ffed$var$TEMPLATE","$df23d35b1920ffed$exports","options","unsafe","simple","noTargetGet","$df23d35b1920ffed$require$CONFIGURABLE_FUNCTION_NAME","join","$e2ae44a6e8d25e73$export$2d1720544b23b823","$e14fa9a5919cfd28$var$ceil","ceil","$e14fa9a5919cfd28$var$floor","floor","$e14fa9a5919cfd28$exports","number","$f26ec54d097b1e6f$var$max","max","$f26ec54d097b1e6f$var$min","min","$f26ec54d097b1e6f$exports","index","integer","$a05e262d7c0a542d$var$min","$a05e262d7c0a542d$exports","$56d770ac66710483$exports","obj","$99baa53f15cb70ef$var$createMethod","IS_INCLUDES","$this","el","fromIndex","includes","indexOf","$cb16e4f4041c8238$var$push","$cb16e4f4041c8238$exports","names","$cb16e4f4041c8238$require$indexOf","$10f7392dc6753067$export$2d1720544b23b823","$e2ae44a6e8d25e73$var$hiddenKeys","$433e22460e7610e3$exports","getOwnPropertyNames","$58571dd52d641ded$var$concat","$58571dd52d641ded$exports","$ccfbfe34673e060d$exports","target","exceptions","$cf5fb9660f0697a6$var$replacement","$cf5fb9660f0697a6$var$isForced","feature","detection","$cf5fb9660f0697a6$var$data","$cf5fb9660f0697a6$var$normalize","$cf5fb9660f0697a6$var$POLYFILL","$cf5fb9660f0697a6$var$NATIVE","normalize","string","toLowerCase","data","NATIVE","POLYFILL","$cf5fb9660f0697a6$exports","$93d92c20a6fade44$exports","targetProperty","sourceProperty","TARGET","GLOBAL","global","STATIC","stat","$93d92c20a6fade44$require$getOwnPropertyDescriptor","forced","$607ba71428f7c909$var$test","$607ba71428f7c909$exports","$7239ff1d75c3f183$var$TO_STRING_TAG","$7239ff1d75c3f183$var$Object","$7239ff1d75c3f183$var$CORRECT_ARGUMENTS","$7239ff1d75c3f183$exports","tag","$7239ff1d75c3f183$var$tryGet","callee","$51f1d218ff647efc$var$String","$51f1d218ff647efc$exports","$ec545ba6a42e9d60$var$NativeSymbol","$ec545ba6a42e9d60$var$SymbolPrototype","$ec545ba6a42e9d60$var$EmptyStringDescriptionStore","$ec545ba6a42e9d60$var$SymbolWrapper","constructor","$ec545ba6a42e9d60$var$NATIVE_SYMBOL","$ec545ba6a42e9d60$var$symbolToString","$ec545ba6a42e9d60$var$symbolValueOf","$ec545ba6a42e9d60$var$regexp","$ec545ba6a42e9d60$var$replace","$ec545ba6a42e9d60$var$stringSlice","desc","$f1801f1577a4a115$export$2d1720544b23b823","$f9bd8ee345b28f6f$exports","$6abfdcece8b9c5ff$exports","NAME","$6abfdcece8b9c5ff$require$defineProperty","$5e82cc3b8d170bb1$exports","Array","isArray","$f6298065d477468c$var$bind","$f6298065d477468c$exports","that","$6b20beb86e567068$var$TypeError","$6b20beb86e567068$var$flattenIntoArray","original","sourceLen","start","depth","mapper","thisArg","element","elementLen","targetIndex","sourceIndex","mapFn","$6b20beb86e567068$exports","$56c4b64aef31f56d$var$noop","$56c4b64aef31f56d$var$empty","$56c4b64aef31f56d$var$construct","$56c4b64aef31f56d$var$constructorRegExp","$56c4b64aef31f56d$var$exec","$56c4b64aef31f56d$var$INCORRECT_TO_STRING","$56c4b64aef31f56d$var$isConstructorModern","$56c4b64aef31f56d$var$isConstructorLegacy","$56c4b64aef31f56d$exports","called","$2dc1a39b5161e4d9$var$SPECIES","$2dc1a39b5161e4d9$var$Array","$2dc1a39b5161e4d9$exports","originalArray","C","$fc2ac8f6ad676018$exports","proto","flat","depthArg","A","flatMap","callbackfn","$e6a5d55127ec2009$export$2d1720544b23b823","$82c4870d9b134a08$exports","defineProperties","Properties","props","$e6c61058dd5a6660$exports","$a5003d04237f6bf7$var$activeXDocument","$a5003d04237f6bf7$var$IE_PROTO","$a5003d04237f6bf7$var$EmptyConstructor","$a5003d04237f6bf7$var$scriptTag","content","$a5003d04237f6bf7$var$LT","$a5003d04237f6bf7$var$NullProtoObjectViaActiveX","activeXDocument","write","close","temp","parentWindow","$a5003d04237f6bf7$var$NullProtoObject","ActiveXObject","iframeDocument","iframe","domain","style","display","src","contentWindow","open","F","$a5003d04237f6bf7$exports","create","$b5e1615f7c7a86b5$var$UNSCOPABLES","$b5e1615f7c7a86b5$var$ArrayPrototype","$b5e1615f7c7a86b5$exports","$87dda791a8543f84$exports","$bb06a71e5acdfaf0$exports","getPrototypeOf","$b3023042947da65f$var$IE_PROTO","$b3023042947da65f$var$Object","$b3023042947da65f$var$ObjectPrototype","$b3023042947da65f$exports","$4fe854906a7ec949$var$IteratorPrototype","$4fe854906a7ec949$var$PrototypeOfArrayIteratorPrototype","$4fe854906a7ec949$var$arrayIterator","$4fe854906a7ec949$var$ITERATOR","$4fe854906a7ec949$var$BUGGY_SAFARI_ITERATORS","$4fe854906a7ec949$exports","IteratorPrototype","BUGGY_SAFARI_ITERATORS","$6ea1d760ea288787$var$TO_STRING_TAG","$6ea1d760ea288787$exports","TAG","$6ea1d760ea288787$require$defineProperty","$c59434f49e4d4ee0$var$returnThis","$c59434f49e4d4ee0$exports","IteratorConstructor","next","ENUMERABLE_NEXT","TO_STRING_TAG","$c59434f49e4d4ee0$require$IteratorPrototype","$ed2e4f47ee706e63$var$String","$ed2e4f47ee706e63$var$TypeError","$ed2e4f47ee706e63$exports","$880c77221cf309e5$exports","setPrototypeOf","setter","CORRECT_SETTER","__proto__","$22d2d86cea4e9f62$var$PROPER_FUNCTION_NAME","$22d2d86cea4e9f62$var$CONFIGURABLE_FUNCTION_NAME","$22d2d86cea4e9f62$var$IteratorPrototype","$22d2d86cea4e9f62$var$BUGGY_SAFARI_ITERATORS","$22d2d86cea4e9f62$var$ITERATOR","$22d2d86cea4e9f62$var$returnThis","$22d2d86cea4e9f62$exports","Iterable","DEFAULT","IS_SET","FORCED","CurrentIteratorPrototype","methods","KEY","getIterationMethod","KIND","defaultIterator","IterablePrototype","INCORRECT_VALUES_NAME","nativeIterator","anyNativeIterator","entries","values","$98ab8484383902e0$var$setInternalState","$98ab8484383902e0$var$getInternalState","$98ab8484383902e0$exports","iterated","kind","done","$98ab8484383902e0$var$values","Arguments","$f7fb835badd5f736$var$TypeError","$f7fb835badd5f736$var$createMethod","IS_RIGHT","argumentsLength","memo","$f7fb835badd5f736$exports","left","right","$4b98fa4539f5349d$exports","METHOD_NAME","$fa9dea5135c0b49f$exports","$4160f36196692563$var$STRICT_METHOD","reduce","$4160f36196692563$require$$reduce","$770b8c39ada15692$var$STRICT_METHOD","reduceRight","$770b8c39ada15692$require$$reduceRight","$1f2016a07c81dc46$exports","propertyKey","$5c417cf1c2478282$var$Array","$5c417cf1c2478282$var$max","$5c417cf1c2478282$exports","end","k","fin","n","$36307cb70177d55d$var$floor","$36307cb70177d55d$var$mergeSort","array","comparefn","middle","$36307cb70177d55d$var$insertionSort","$36307cb70177d55d$var$merge","j","llength","rlength","lindex","rindex","$36307cb70177d55d$exports","$c18cd9327a66cced$var$firefox","$c18cd9327a66cced$exports","$d8315db7c5261e19$exports","$e52082938e23fff4$var$webkit","$e52082938e23fff4$exports","$56c9cf99eddba78b$var$test","$56c9cf99eddba78b$var$un$Sort","sort","$56c9cf99eddba78b$var$push","$56c9cf99eddba78b$var$FAILS_ON_UNDEFINED","$56c9cf99eddba78b$var$FAILS_ON_NULL","$56c9cf99eddba78b$var$STRICT_METHOD","$56c9cf99eddba78b$var$STABLE_SORT","code","chr","fromCharCode","v","b","charAt","itemsLength","items","arrayLength","x","y","$56c9cf99eddba78b$var$getSortCompare","$a5aea2aa9c054f69$var$$hypot","hypot","$a5aea2aa9c054f69$var$abs","abs","$a5aea2aa9c054f69$var$sqrt","sqrt","$a5aea2aa9c054f69$var$BUGGY","Infinity","NaN","value1","value2","arg","div","sum","aLen","larg","$6bee8d22f27ee10a$exports","__defineSetter__","__defineGetter__","getter","$d0dcf39c5498e0cf$var$ITERATOR","$d0dcf39c5498e0cf$var$ArrayPrototype","$d0dcf39c5498e0cf$exports","$50af9303c5fe059d$var$ITERATOR","$50af9303c5fe059d$exports","$9c7ab1fefe31f2b0$var$TypeError","$9c7ab1fefe31f2b0$exports","usingIterator","iteratorMethod","$c1ce4c878cdb2999$exports","innerResult","innerError","$e3cc63c992bbcb4b$var$TypeError","$e3cc63c992bbcb4b$var$Result","stopped","$e3cc63c992bbcb4b$var$ResultPrototype","$e3cc63c992bbcb4b$exports","iterable","unboundFunction","iterFn","step","AS_ENTRIES","IS_ITERATOR","INTERRUPTED","stop","condition","callFn","fromEntries","__lookupGetter__","$371b0c21efbea015$require$getOwnPropertyDescriptor","__lookupSetter__","$ead1aa88360a202e$require$getOwnPropertyDescriptor","$32b41cb92269d8e9$exports","$f5f39d577d4e1b93$exports","$84656614c9d12a9c$var$SPECIES","$84656614c9d12a9c$exports","CONSTRUCTOR_NAME","Constructor","$93dedddb8be73ad2$var$TypeError","$93dedddb8be73ad2$exports","Prototype","$b58a5132f06b385c$var$ITERATOR","$b58a5132f06b385c$var$SAFE_CLOSING","$b58a5132f06b385c$var$called","$b58a5132f06b385c$var$iteratorWithReturn","return","from","$b58a5132f06b385c$exports","SKIP_CLOSING","ITERATION_SUPPORT","$736f3e88c24761aa$var$TypeError","$736f3e88c24761aa$exports","$ab0d48903c351d84$var$SPECIES","$ab0d48903c351d84$exports","defaultConstructor","S","$af68e0d99ca904cf$var$FunctionPrototype","$af68e0d99ca904cf$var$apply","$af68e0d99ca904cf$var$call","$af68e0d99ca904cf$exports","Reflect","$63ef49c03046ed9e$exports","$d598dd1280776497$exports","$361962603a83c7a9$var$location","$361962603a83c7a9$var$defer","$361962603a83c7a9$var$channel","$361962603a83c7a9$var$port","$361962603a83c7a9$var$set","setImmediate","$361962603a83c7a9$var$clear","clearImmediate","$361962603a83c7a9$var$process","$361962603a83c7a9$var$Dispatch","Dispatch","$361962603a83c7a9$var$Function","$361962603a83c7a9$var$MessageChannel","MessageChannel","$361962603a83c7a9$var$String","$361962603a83c7a9$var$counter","$361962603a83c7a9$var$queue","location","$361962603a83c7a9$var$run","$361962603a83c7a9$var$runner","$361962603a83c7a9$var$listener","event","$361962603a83c7a9$var$post","postMessage","protocol","host","args","nextTick","now","port2","port1","onmessage","addEventListener","importScripts","removeChild","setTimeout","$361962603a83c7a9$exports","clear","$05d76897d6b34e8a$exports","Pebble","$0aa6cb7c66fede8b$exports","$87f4609f14bbf4e8$var$flush","$87f4609f14bbf4e8$var$head","$87f4609f14bbf4e8$var$last","$87f4609f14bbf4e8$var$notify","$87f4609f14bbf4e8$var$toggle","$87f4609f14bbf4e8$var$node","$87f4609f14bbf4e8$var$promise","$87f4609f14bbf4e8$var$then","$87f4609f14bbf4e8$var$MutationObserver","MutationObserver","WebKitMutationObserver","$87f4609f14bbf4e8$var$document","$87f4609f14bbf4e8$var$process","$87f4609f14bbf4e8$var$Promise","$87f4609f14bbf4e8$var$queueMicrotaskDescriptor","$87f4609f14bbf4e8$require$getOwnPropertyDescriptor","$87f4609f14bbf4e8$var$queueMicrotask","parent","exit","enter","$87f4609f14bbf4e8$require$macrotask","createTextNode","observe","characterData","$87f4609f14bbf4e8$exports","task","$b6e35258dd138f72$export$2d1720544b23b823","$b6e35258dd138f72$var$PromiseCapability","promise","$$resolve","$$reject","$1a4abcefad91f5a7$exports","promiseCapability","$28a25c57260a8f10$exports","console","$6f377e5854b32404$exports","$da73dc307965ce25$var$Queue","tail","add","item","entry","$da73dc307965ce25$exports","$e366cfbaebfd8a14$exports","$57293e293a28daa4$var$Internal","$57293e293a28daa4$var$OwnPromiseCapability","$57293e293a28daa4$var$PromiseWrapper","$57293e293a28daa4$var$nativeThen","$57293e293a28daa4$var$SPECIES","$57293e293a28daa4$var$getInternalState","$57293e293a28daa4$var$setInternalState","$57293e293a28daa4$var$getInternalPromiseState","$57293e293a28daa4$var$NativePromisePrototype","$57293e293a28daa4$var$PromiseConstructor","$57293e293a28daa4$var$PromisePrototype","$57293e293a28daa4$var$TypeError","$57293e293a28daa4$var$document","$57293e293a28daa4$var$process","$57293e293a28daa4$var$newPromiseCapability","$57293e293a28daa4$var$newGenericPromiseCapability","$57293e293a28daa4$var$DISPATCH_EVENT","createEvent","dispatchEvent","$57293e293a28daa4$var$NATIVE_REJECTION_EVENT","PromiseRejectionEvent","$57293e293a28daa4$var$SUBCLASSING","$57293e293a28daa4$var$FORCED","PROMISE_CONSTRUCTOR_SOURCE","GLOBAL_CORE_JS_PROMISE","FakePromise","$57293e293a28daa4$var$INCORRECT_ITERATION","all","$57293e293a28daa4$var$isThenable","$57293e293a28daa4$var$callReaction","reaction","exited","ok","handler","fail","rejection","$57293e293a28daa4$var$onHandleUnhandled","$57293e293a28daa4$var$notify","isReject","notified","reactions","$57293e293a28daa4$var$onUnhandled","$57293e293a28daa4$var$dispatchEvent","reason","initEvent","$57293e293a28daa4$require$task","$57293e293a28daa4$var$isUnhandled","emit","$57293e293a28daa4$var$bind","unwrap","$57293e293a28daa4$var$internalReject","$57293e293a28daa4$var$internalResolve","wrapper","executor","onFulfilled","onRejected","wrap","r","capability","$promiseResolve","counter","remaining","alreadyCalled","race","$c8bfbe299ad9061b$var$NON_GENERIC","real","finally","onFinally","isFunction","$c8bfbe299ad9061b$var$method","$7fabfa3e4025b96d$exports","ignoreCase","multiline","dotAll","unicode","sticky","$ec061c6fb61a2573$var$$RegExp","RegExp","$ec061c6fb61a2573$var$UNSUPPORTED_Y","re","lastIndex","$ec061c6fb61a2573$var$MISSED_STICKY","$ec061c6fb61a2573$exports","BROKEN_CARET","MISSED_STICKY","UNSUPPORTED_Y","$c50b88bfd94134ec$var$$RegExp","$c50b88bfd94134ec$exports","flags","$3ebeb6c993393c1b$var$$RegExp","$3ebeb6c993393c1b$exports","groups","re1","re2","$fd859ea0d5bf625e$var$nativeReplace","$fd859ea0d5bf625e$var$nativeExec","$fd859ea0d5bf625e$var$patchedExec","$fd859ea0d5bf625e$var$charAt","$fd859ea0d5bf625e$var$indexOf","$fd859ea0d5bf625e$var$replace","$fd859ea0d5bf625e$var$stringSlice","$fd859ea0d5bf625e$var$UPDATES_LAST_INDEX_WRONG","$fd859ea0d5bf625e$var$UNSUPPORTED_Y","$fd859ea0d5bf625e$var$NPCG_INCLUDED","reCopy","group","$fd859ea0d5bf625e$require$getInternalState","str","raw","charsAdded","strCopy","$fd859ea0d5bf625e$exports","$4f692e06bb044978$var$SPECIES","$4f692e06bb044978$var$RegExpPrototype","$4f692e06bb044978$exports","SHAM","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","uncurriedNativeRegExpMethod","nativeMethod","regexp","arg2","forceStringMethod","uncurriedNativeMethod","$exec","$31fc646e468c8f55$var$charAt","$31fc646e468c8f55$var$charCodeAt","charCodeAt","$31fc646e468c8f55$var$stringSlice","$31fc646e468c8f55$var$createMethod","CONVERT_TO_STRING","pos","first","second","position","size","$31fc646e468c8f55$exports","codeAt","$8c202125e2dcf498$exports","$8c202125e2dcf498$require$charAt","$a868b805471c9a94$var$floor","$a868b805471c9a94$var$charAt","$a868b805471c9a94$var$replace","$a868b805471c9a94$var$stringSlice","$a868b805471c9a94$var$SUBSTITUTION_SYMBOLS","$a868b805471c9a94$var$SUBSTITUTION_SYMBOLS_NO_NAMED","$a868b805471c9a94$exports","matched","captures","namedCaptures","replacement","tailPos","symbols","ch","capture","f","$80df0611638c2384$var$TypeError","$80df0611638c2384$exports","R","$d91ccced954bbec5$var$REPLACE","$d91ccced954bbec5$var$max","$d91ccced954bbec5$var$min","$d91ccced954bbec5$var$concat","$d91ccced954bbec5$var$push","$d91ccced954bbec5$var$stringIndexOf","$d91ccced954bbec5$var$stringSlice","$d91ccced954bbec5$var$REPLACE_KEEPS_$0","$d91ccced954bbec5$var$REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE","_","nativeReplace","maybeCallNative","UNSAFE_SUBSTITUTE","searchValue","replaceValue","replacer","rx","res","functionalReplace","fullUnicode","results","accumulatedResult","nextSourcePosition","replacerArgs","$208224989c6b0546$var$replace","$208224989c6b0546$var$ltrim","$208224989c6b0546$var$rtrim","$208224989c6b0546$var$whitespace","$208224989c6b0546$var$createMethod","$208224989c6b0546$exports","trim","$3e34a15f41be88d5$var$FORCED","$5d1e15787a8998d3$exports","$5d1e15787a8998d3$require$PROPER_FUNCTION_NAME","$3e34a15f41be88d5$var$trimEnd","$3e34a15f41be88d5$require$$trimEnd","trimEnd","trimRight","$2fd8526d2a3757f9$var$FORCED","$2fd8526d2a3757f9$var$trimStart","$2fd8526d2a3757f9$require$$trimStart","trimStart","trimLeft","$ad700ad89892e7d1$exports","ArrayBuffer","DataView","$2f56d21004e6c689$var$NAME","$2f56d21004e6c689$var$Constructor","$2f56d21004e6c689$var$Prototype","$2f56d21004e6c689$var$Int8Array","Int8Array","$2f56d21004e6c689$var$Int8ArrayPrototype","$2f56d21004e6c689$var$Uint8ClampedArray","Uint8ClampedArray","$2f56d21004e6c689$var$Uint8ClampedArrayPrototype","$2f56d21004e6c689$var$TypedArray","$2f56d21004e6c689$var$TypedArrayPrototype","$2f56d21004e6c689$var$ObjectPrototype","$2f56d21004e6c689$var$TypeError","$2f56d21004e6c689$var$TO_STRING_TAG","$2f56d21004e6c689$var$TYPED_ARRAY_TAG","$2f56d21004e6c689$var$TYPED_ARRAY_CONSTRUCTOR","$2f56d21004e6c689$var$NATIVE_ARRAY_BUFFER_VIEWS","opera","$2f56d21004e6c689$var$TYPED_ARRAY_TAG_REQUIRED","$2f56d21004e6c689$var$TypedArrayConstructorsList","Uint8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","$2f56d21004e6c689$var$BigIntArrayConstructorsList","BigInt64Array","BigUint64Array","$2f56d21004e6c689$var$isTypedArray","klass","$2f56d21004e6c689$exports","NATIVE_ARRAY_BUFFER_VIEWS","TYPED_ARRAY_CONSTRUCTOR","TYPED_ARRAY_TAG","aTypedArray","aTypedArrayConstructor","exportTypedArrayMethod","property","ARRAY","TypedArrayConstructor","error2","exportTypedArrayStaticMethod","isView","isTypedArray","TypedArray","TypedArrayPrototype","$5a6c1bc5ecdb40ae$var$ArrayBuffer","$5a6c1bc5ecdb40ae$var$Int8Array","$5a6c1bc5ecdb40ae$exports","$5a6c1bc5ecdb40ae$require$NATIVE_ARRAY_BUFFER_VIEWS","$404845ead99bf4cc$var$RangeError","RangeError","$404845ead99bf4cc$exports","$2750968780302fa8$var$Array","$2750968780302fa8$var$abs","$2750968780302fa8$var$pow","pow","$2750968780302fa8$var$floor","$2750968780302fa8$var$log","log","$2750968780302fa8$var$LN2","LN2","$2750968780302fa8$exports","pack","mantissaLength","bytes","exponent","mantissa","c","buffer","exponentLength","eMax","eBias","rt","sign","unpack","nBits","$2c080fbb76bb4668$exports","endPos","$57faed75f63d075d$var$PROPER_FUNCTION_NAME","$57faed75f63d075d$var$CONFIGURABLE_FUNCTION_NAME","$57faed75f63d075d$var$getInternalState","$57faed75f63d075d$var$setInternalState","$57faed75f63d075d$var$NativeArrayBuffer","$57faed75f63d075d$var$$ArrayBuffer","$57faed75f63d075d$var$ArrayBufferPrototype","$57faed75f63d075d$var$$DataView","$57faed75f63d075d$var$DataViewPrototype","$57faed75f63d075d$var$ObjectPrototype","$57faed75f63d075d$var$Array","$57faed75f63d075d$var$RangeError","$57faed75f63d075d$var$fill","$57faed75f63d075d$var$reverse","reverse","$57faed75f63d075d$var$packIEEE754","$57faed75f63d075d$var$unpackIEEE754","$57faed75f63d075d$var$packInt8","$57faed75f63d075d$var$packInt16","$57faed75f63d075d$var$packInt32","$57faed75f63d075d$var$unpackInt32","$57faed75f63d075d$var$packFloat32","$57faed75f63d075d$var$packFloat64","$57faed75f63d075d$var$addGetter","$57faed75f63d075d$var$get","view","count","isLittleEndian","intIndex","store","byteLength","byteOffset","$57faed75f63d075d$var$set","conversion","$57faed75f63d075d$var$INCORRECT_ARRAY_BUFFER_NAME","$57faed75f63d075d$var$key","$57faed75f63d075d$var$keys","$57faed75f63d075d$require$getOwnPropertyNames","$57faed75f63d075d$var$j","$57faed75f63d075d$var$testView","$57faed75f63d075d$var$$setInt8","setInt8","getInt8","setUint8","bufferLength","offset","getUint8","getInt16","getUint16","getInt32","getUint32","getFloat32","getFloat64","setInt16","setUint16","setInt32","setUint32","setFloat32","setFloat64","$57faed75f63d075d$exports","$3fa6c25618d16b48$var$floor","$3fa6c25618d16b48$exports","Number","isInteger","isFinite","$7ffee227155b1e8e$var$RangeError","$7ffee227155b1e8e$exports","$265ad86f00e5a948$var$RangeError","$265ad86f00e5a948$exports","BYTES","$60fb9d3919467d18$exports","mapfn","mapping","$60fb9d3919467d18$require$aTypedArrayConstructor","$9ffeca66c6dd7e57$var$push","$9ffeca66c6dd7e57$var$createMethod","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","IS_FILTER_REJECT","NO_HOLES","specificCreate","boundFunction","$9ffeca66c6dd7e57$exports","forEach","map","filter","some","every","find","findIndex","filterReject","$0fdafc8eeeabc5ab$exports","dummy","Wrapper","NewTarget","NewTargetPrototype","$f83fa68c6e44c632$var$getInternalState","$f83fa68c6e44c632$var$setInternalState","$f83fa68c6e44c632$var$nativeDefineProperty","$f83fa68c6e44c632$var$nativeGetOwnPropertyDescriptor","$f83fa68c6e44c632$var$round","round","$f83fa68c6e44c632$var$RangeError","$f83fa68c6e44c632$var$ArrayBuffer","$f83fa68c6e44c632$var$ArrayBufferPrototype","$f83fa68c6e44c632$var$DataView","$f83fa68c6e44c632$var$NATIVE_ARRAY_BUFFER_VIEWS","$f83fa68c6e44c632$var$TYPED_ARRAY_CONSTRUCTOR","$f83fa68c6e44c632$var$TYPED_ARRAY_TAG","$f83fa68c6e44c632$var$TypedArray","$f83fa68c6e44c632$var$TypedArrayPrototype","$f83fa68c6e44c632$var$aTypedArrayConstructor","$f83fa68c6e44c632$var$isTypedArray","$f83fa68c6e44c632$var$fromList","list","$f83fa68c6e44c632$var$addGetter","$f83fa68c6e44c632$var$isArrayBuffer","$f83fa68c6e44c632$var$isTypedArrayIndex","$f83fa68c6e44c632$var$wrappedGetOwnPropertyDescriptor","$f83fa68c6e44c632$var$wrappedDefineProperty","$f83fa68c6e44c632$exports","CLAMPED","GETTER","SETTER","NativeTypedArrayConstructor","TypedArrayConstructorPrototype","exported","addElement","typedArrayOffset","$length","$len","init","$fb76657900a14479$var$aTypedArrayConstructor","$fb76657900a14479$var$exportTypedArrayStaticMethod","$b86279a51a99aee0$var$replace","$b86279a51a99aee0$var$TEST","$b86279a51a99aee0$var$V8_OR_CHAKRA_STACK_ENTRY","$b86279a51a99aee0$var$IS_V8_OR_CHAKRA_STACK","$b86279a51a99aee0$exports","dropEntries","$31e8bb05f545deef$exports","cause","$572dcac943cff4b3$exports","$default","$0286b167145f9bcc$exports","$57eb454ddab9d661$var$TO_STRING_TAG","$57eb454ddab9d661$var$Error","$57eb454ddab9d661$var$push","$57eb454ddab9d661$var$$AggregateError","errors","message","isInstance","$57eb454ddab9d661$var$AggregateErrorPrototype","errorsArray","AggregateError","len","$06f0bdad5c01ae13$export$2d1720544b23b823","$06f0bdad5c01ae13$var$windowNames","$06f0bdad5c01ae13$require$$getOwnPropertyNames","$06f0bdad5c01ae13$var$getWindowNames","$81e96f2bb64d4afe$exports","isExtensible","$f8248ff95771e4f9$var$$isExtensible","$f8248ff95771e4f9$var$FAILS_ON_PRIMITIVES","$f8248ff95771e4f9$exports","$59cb404ee3da04d6$exports","preventExtensions","$359a5f750579b239$var$REQUIRED","$359a5f750579b239$var$METADATA","$359a5f750579b239$var$id","$359a5f750579b239$var$setMetadata","objectID","weakData","$359a5f750579b239$var$meta","$359a5f750579b239$exports","enable","splice","fastKey","getWeakData","onFreeze","$e155b94ae107d02b$exports","common","IS_WEAK","ADDER","NativeConstructor","NativePrototype","fixMethod","getConstructor","instance","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","BUGGY_ZERO","$instance","setStrong","$532619c8e359f89d$var$setInternalState","$532619c8e359f89d$var$internalStateGetterFor","last","getInternalState","define","previous","getEntry","$532619c8e359f89d$require$fastKey","removed","delete","prev","$532619c8e359f89d$require$defineProperty","ITERATOR_NAME","getInternalCollectionState","getInternalIteratorState","$b85f7d5d27b58ded$var$setInternalState","$b85f7d5d27b58ded$var$internalStateGetterFor","$b85f7d5d27b58ded$var$find","$b85f7d5d27b58ded$var$findIndex","$b85f7d5d27b58ded$var$splice","$b85f7d5d27b58ded$var$id","$b85f7d5d27b58ded$var$uncaughtFrozenStore","frozen","$b85f7d5d27b58ded$var$UncaughtFrozenStore","$b85f7d5d27b58ded$var$findUncaughtFrozen","$b85f7d5d27b58ded$exports","$b85f7d5d27b58ded$require$getWeakData","$ef27c6e545a44903$var$InternalWeakMap","$ef27c6e545a44903$var$IS_IE11","$ef27c6e545a44903$var$wrapper","$ef27c6e545a44903$var$$WeakMap","$ef27c6e545a44903$var$WeakMapPrototype","$ef27c6e545a44903$var$nativeDelete","$ef27c6e545a44903$var$nativeHas","$ef27c6e545a44903$var$nativeGet","$ef27c6e545a44903$var$nativeSet","$ef27c6e545a44903$require$enforceInternalState","$16e72ad28c2390a9$var$Object","$16e72ad28c2390a9$var$TypeError","$16e72ad28c2390a9$var$Map","$16e72ad28c2390a9$var$WeakMap","$16e72ad28c2390a9$var$Node","primitives","objectsByIndex","initializer","IS_OBJECT","$16e72ad28c2390a9$var$root","$16e72ad28c2390a9$exports","active","$0fc53c98f77b9156$var$Object","$0fc53c98f77b9156$var$initializer","freeze","compositeKey","compositeSymbol","deleteAll","$c5ad81df5097641a$exports","wasDeleted","collection","remover","allDeleted","$4f15284f41029002$exports","Map","newMap","findKey","$7730a70e2989f06c$var$push","$7730a70e2989f06c$exports","nextItem","$ac6984669a100647$var$push","groupBy","keyDerivative","derivedKey","$d09f69bbac292979$exports","searchElement","keyBy","keyOf","mapKeys","mapValues","merge","of","$0f83507fa746c8e6$exports","$d081f913e33c6900$var$TypeError","noInitial","accumulator","$e82224dea21612dd$var$TypeError","update","callback","isPresentInMap","$4c0e6f987dabb0d0$var$min","$4c0e6f987dabb0d0$var$max","clamp","lower","upper","DEG_PER_RAD","PI","$d505f7cbb2338831$var$RAD_PER_DEG","degrees","radians","$fd112c6f0f316130$exports","scale","inLow","inHigh","outLow","outHigh","nx","nInLow","nInHigh","nOutLow","nOutHigh","$a268ca7504169691$exports","$9b50ede693f1efbd$var$abs","$9b50ede693f1efbd$var$pow","$9b50ede693f1efbd$var$EPSILON","$9b50ede693f1efbd$var$EPSILON32","$9b50ede693f1efbd$var$MAX32","$9b50ede693f1efbd$var$MIN32","$9b50ede693f1efbd$exports","fround","$abs","$sign","fscale","iaddh","x0","x1","y0","y1","$x0","$y0","imulh","u","UINT16","$u","$v","u0","v0","u1","v1","t","isubh","RAD_PER_DEG","$ed2f2d7f2abbb859$var$DEG_PER_RAD","$d3799f1d6dc093b9$var$globalIsFinite","$d3799f1d6dc093b9$exports","$96f59aeb2ba2a990$var$setInternalState","$96f59aeb2ba2a990$var$getInternalState","$96f59aeb2ba2a990$var$SEEDED_RANDOM","$96f59aeb2ba2a990$var$TypeError","$96f59aeb2ba2a990$var$$SeededRandomGenerator","seed","seededPRNG","signbit","umulh","$1574e9e3d509647f$var$$parseInt","parseInt","$1574e9e3d509647f$var$Symbol","$1574e9e3d509647f$var$ITERATOR","$1574e9e3d509647f$var$hex","$1574e9e3d509647f$var$exec","$1574e9e3d509647f$var$FORCED","$eafd053af751400c$exports","$1574e9e3d509647f$exports","radix","$1574e9e3d509647f$require$trim","$f51e829a2446ddf1$var$RangeError","$f51e829a2446ddf1$var$SyntaxError","SyntaxError","$f51e829a2446ddf1$var$TypeError","$f51e829a2446ddf1$var$valid","$f51e829a2446ddf1$var$charAt","$f51e829a2446ddf1$var$exec","$f51e829a2446ddf1$var$numberToString","$f51e829a2446ddf1$var$stringSlice","fromString","mathNum","$d20bf9c3c9a62f46$var$$$OBSERVABLE","$d20bf9c3c9a62f46$var$getterFor","$d20bf9c3c9a62f46$var$setInternalState","$d20bf9c3c9a62f46$var$getObservableInternalState","$d20bf9c3c9a62f46$var$getSubscriptionInternalState","$d20bf9c3c9a62f46$var$getSubscriptionObserverInternalState","$d20bf9c3c9a62f46$var$Array","$d20bf9c3c9a62f46$var$SubscriptionState","observer","subscriptionObserver","clean","subscription","closed","isClosed","$d20bf9c3c9a62f46$var$Subscription","subscriber","subscriptionState","$d20bf9c3c9a62f46$var$SubscriptionObserver","unsubscribe","error1","$d20bf9c3c9a62f46$require$defineProperty","nextMethod","errorMethod","complete","completeMethod","$d20bf9c3c9a62f46$var$$Observable","$d20bf9c3c9a62f46$var$ObservablePrototype","subscribe","observableMethod","observable","Observable","allSettled","promiseResolve","status","any","alreadyResolved","alreadyRejected","try","$d1f927d5ba654267$var$Map","$d1f927d5ba654267$var$WeakMap","$d1f927d5ba654267$var$push","$d1f927d5ba654267$var$metadata","$d1f927d5ba654267$var$store","$d1f927d5ba654267$var$getOrCreateMetadataMap","targetKey","targetMetadata","keyMetadata","$43640f88dff75539$var$toMetadataKey","$d1f927d5ba654267$exports","getMap","MetadataKey","metadataMap","MetadataValue","toKey","$43640f88dff75539$var$ordinaryDefineOwnMetadata","defineMetadata","metadataKey","metadataValue","$41ddd4c4b15b9353$var$toMetadataKey","$41ddd4c4b15b9353$var$getOrCreateMetadataMap","$41ddd4c4b15b9353$var$store","deleteMetadata","$f92b7d60ba245589$var$ordinaryHasOwnMetadata","$f92b7d60ba245589$var$ordinaryGetOwnMetadata","$f92b7d60ba245589$var$toMetadataKey","$f92b7d60ba245589$var$ordinaryGetMetadata","getMetadata","$ea61d7b939561e38$var$Map","$ea61d7b939561e38$var$MapPrototype","$ea61d7b939561e38$var$mapForEach","$ea61d7b939561e38$var$mapHas","$ea61d7b939561e38$var$mapSet","$ea61d7b939561e38$var$push","$b555998ca90e6a04$var$arrayUniqueBy","resolver","resolverFunction","$b555998ca90e6a04$var$concat","$b555998ca90e6a04$var$ordinaryOwnMetadataKeys","$b555998ca90e6a04$var$toMetadataKey","$b555998ca90e6a04$var$ordinaryMetadataKeys","oKeys","pKeys","getMetadataKeys","$08417406c54ad6a0$var$ordinaryGetOwnMetadata","$08417406c54ad6a0$var$toMetadataKey","getOwnMetadata","$feca233b89a45107$var$ordinaryOwnMetadataKeys","$feca233b89a45107$var$toMetadataKey","getOwnMetadataKeys","$f825a1c1d2ae90fb$var$ordinaryHasOwnMetadata","$f825a1c1d2ae90fb$var$toMetadataKey","$f825a1c1d2ae90fb$var$ordinaryHasMetadata","hasMetadata","$f1382efb0498938f$var$ordinaryHasOwnMetadata","$f1382efb0498938f$var$toMetadataKey","hasOwnMetadata","$5e1fd6792cd3285c$var$toMetadataKey","$5e1fd6792cd3285c$var$ordinaryDefineOwnMetadata","addAll","$6a5e6c7debc75731$exports","adder","difference","newSet","$2f471df389c2e67d$exports","Set","intersection","hasCheck","isDisjointFrom","isSubsetOf","otherSet","isSupersetOf","$e9a867210cefb754$var$arrayJoin","$e9a867210cefb754$var$push","separator","sep","$7fde191fb87ad6ab$var$TypeError","symmetricDifference","union","$023e50350748e6dd$var$FORCED","at","relativeIndex","$023e50350748e6dd$require$charAt","$2d166344170d7df5$var$codeAt","$2d166344170d7df5$var$charAt","$2d166344170d7df5$var$setInternalState","$2d166344170d7df5$var$getInternalState","$2d166344170d7df5$var$$StringIterator","point","codePoint","codePoints","$5dcfe2bca8a05ea7$var$MATCH","$5dcfe2bca8a05ea7$exports","isRegExp","$b705a82dcd307b5f$var$MATCH_ALL","$b705a82dcd307b5f$var$setInternalState","$b705a82dcd307b5f$var$getInternalState","$b705a82dcd307b5f$var$REGEXP_STRING","$b705a82dcd307b5f$var$RegExpPrototype","$b705a82dcd307b5f$var$TypeError","$b705a82dcd307b5f$var$getFlags","$b705a82dcd307b5f$var$stringIndexOf","$b705a82dcd307b5f$var$un$MatchAll","matchAll","$b705a82dcd307b5f$var$WORKS_WITH_NON_GLOBAL_REGEX","$b705a82dcd307b5f$var$$RegExpStringIterator","$global","$b705a82dcd307b5f$var$$matchAll","flagsValue","matcher","$804b4910026e44b2$var$REPLACE","$804b4910026e44b2$var$RegExpPrototype","$804b4910026e44b2$var$TypeError","$804b4910026e44b2$var$getFlags","$804b4910026e44b2$var$indexOf","$804b4910026e44b2$var$stringSlice","$804b4910026e44b2$var$max","$804b4910026e44b2$var$stringIndexOf","replaceAll","searchString","searchLength","advanceBy","endOfLastMatch","$0052f2811b962aff$exports","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","$92b1e927c6c30006$var$classList","classList","$92b1e927c6c30006$var$DOMTokenListPrototype","$92b1e927c6c30006$exports","$66547d8b70b36371$var$ITERATOR","$66547d8b70b36371$var$TO_STRING_TAG","$66547d8b70b36371$var$ArrayValues","$66547d8b70b36371$var$handlePrototype","CollectionPrototype","COLLECTION_NAME","$66547d8b70b36371$var$COLLECTION_NAME","$ad3b98d827b7de42$var$FORCED","$5529b4430b6c2b8d$var$process","queueMicrotask","$f747a427fa95d549$var$setInternalState","$f747a427fa95d549$var$getInternalState","$f747a427fa95d549$require$charAt","$d7e7b7746452924b$var$ITERATOR","$d7e7b7746452924b$exports","URL","searchParams","pathname","href","URLSearchParams","username","hash","$45603a3e64bdc8dc$var$$assign","assign","$45603a3e64bdc8dc$var$defineProperty","$45603a3e64bdc8dc$var$concat","$45603a3e64bdc8dc$exports","B","alphabet","T","$9ece1d330d581d5d$exports","ENTRIES","$9907f7b745b9abf3$var$Array","$9907f7b745b9abf3$exports","arrayLike","IS_CONSTRUCTOR","$d1b6e292725f88fd$var$regexNonASCII","$d1b6e292725f88fd$var$regexSeparators","$d1b6e292725f88fd$var$RangeError","$d1b6e292725f88fd$var$exec","$d1b6e292725f88fd$var$floor","$d1b6e292725f88fd$var$fromCharCode","$d1b6e292725f88fd$var$charCodeAt","$d1b6e292725f88fd$var$join","$d1b6e292725f88fd$var$push","$d1b6e292725f88fd$var$replace","$d1b6e292725f88fd$var$split","$d1b6e292725f88fd$var$toLowerCase","$d1b6e292725f88fd$var$digitToBasic","digit","$d1b6e292725f88fd$var$adapt","delta","numPoints","firstTime","$d1b6e292725f88fd$var$baseMinusTMin","$d1b6e292725f88fd$var$base","$d1b6e292725f88fd$var$encode","output","extra","$d1b6e292725f88fd$var$ucs2decode","currentValue","inputLength","bias","basicLength","handledCPCount","handledCPCountPlusOne","q","qMinusT","baseMinusT","$d1b6e292725f88fd$exports","label","encoded","labels","$816e69ae047480ee$var$TypeError","$816e69ae047480ee$exports","passed","required","$e0bd5abd983ff6e1$var$ITERATOR","$e0bd5abd983ff6e1$var$setInternalState","$e0bd5abd983ff6e1$var$getInternalParamsState","$e0bd5abd983ff6e1$var$getInternalIteratorState","$e0bd5abd983ff6e1$var$URL_SEARCH_PARAMS","$e0bd5abd983ff6e1$var$n$Fetch","$e0bd5abd983ff6e1$var$N$Request","$e0bd5abd983ff6e1$var$Headers","$e0bd5abd983ff6e1$var$RequestPrototype","$e0bd5abd983ff6e1$var$HeadersPrototype","$e0bd5abd983ff6e1$var$RegExp","$e0bd5abd983ff6e1$var$TypeError","$e0bd5abd983ff6e1$var$decodeURIComponent","decodeURIComponent","$e0bd5abd983ff6e1$var$encodeURIComponent","encodeURIComponent","$e0bd5abd983ff6e1$var$charAt","$e0bd5abd983ff6e1$var$join","$e0bd5abd983ff6e1$var$push","$e0bd5abd983ff6e1$var$replace","$e0bd5abd983ff6e1$var$shift","shift","$e0bd5abd983ff6e1$var$splice","$e0bd5abd983ff6e1$var$split","$e0bd5abd983ff6e1$var$stringSlice","$e0bd5abd983ff6e1$var$plus","$e0bd5abd983ff6e1$var$sequences","$e0bd5abd983ff6e1$var$percentSequence","$e0bd5abd983ff6e1$var$percentDecode","sequence","$e0bd5abd983ff6e1$var$deserialize","$e0bd5abd983ff6e1$var$find","$e0bd5abd983ff6e1$var$replacements","$e0bd5abd983ff6e1$var$replacer","$e0bd5abd983ff6e1$var$serialize","$e0bd5abd983ff6e1$var$URLSearchParamsIterator","params","$e0bd5abd983ff6e1$var$URLSearchParamsState","parseObject","parseQuery","bindURL","entryIterator","entryNext","query","attribute","attributes","serialize","updateURL","$e0bd5abd983ff6e1$var$URLSearchParamsConstructor","$e0bd5abd983ff6e1$var$URLSearchParamsPrototype","append","getAll","found","$e0bd5abd983ff6e1$var$headersHas","$e0bd5abd983ff6e1$var$headersSet","$e0bd5abd983ff6e1$var$wrapRequestOptions","headers","body","fetch","$e0bd5abd983ff6e1$var$RequestConstructor","Request","$e0bd5abd983ff6e1$exports","getState","$3c92c0ceb4bdee7e$var$setInternalState","$3c92c0ceb4bdee7e$var$getInternalURLState","$3c92c0ceb4bdee7e$var$URLSearchParams","$3c92c0ceb4bdee7e$var$getInternalSearchParamsState","$3c92c0ceb4bdee7e$var$NativeURL","$3c92c0ceb4bdee7e$var$TypeError","$3c92c0ceb4bdee7e$var$parseInt","$3c92c0ceb4bdee7e$var$floor","$3c92c0ceb4bdee7e$var$pow","$3c92c0ceb4bdee7e$var$charAt","$3c92c0ceb4bdee7e$var$exec","$3c92c0ceb4bdee7e$var$join","$3c92c0ceb4bdee7e$var$numberToString","$3c92c0ceb4bdee7e$var$pop","pop","$3c92c0ceb4bdee7e$var$push","$3c92c0ceb4bdee7e$var$replace","$3c92c0ceb4bdee7e$var$shift","$3c92c0ceb4bdee7e$var$split","$3c92c0ceb4bdee7e$var$stringSlice","$3c92c0ceb4bdee7e$var$toLowerCase","$3c92c0ceb4bdee7e$var$unshift","unshift","$3c92c0ceb4bdee7e$var$ALPHA","$3c92c0ceb4bdee7e$var$ALPHANUMERIC","$3c92c0ceb4bdee7e$var$DIGIT","$3c92c0ceb4bdee7e$var$HEX_START","$3c92c0ceb4bdee7e$var$OCT","$3c92c0ceb4bdee7e$var$DEC","$3c92c0ceb4bdee7e$var$HEX","$3c92c0ceb4bdee7e$var$FORBIDDEN_HOST_CODE_POINT","$3c92c0ceb4bdee7e$var$FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT","$3c92c0ceb4bdee7e$var$LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE","$3c92c0ceb4bdee7e$var$TAB_AND_NEW_LINE","$3c92c0ceb4bdee7e$var$serializeHost","compress","ignore0","ipv6","maxIndex","maxLength","currStart","currLength","$3c92c0ceb4bdee7e$var$findLongestZeroSequence","$3c92c0ceb4bdee7e$var$C0ControlPercentEncodeSet","$3c92c0ceb4bdee7e$var$fragmentPercentEncodeSet","$3c92c0ceb4bdee7e$var$pathPercentEncodeSet","$3c92c0ceb4bdee7e$var$userinfoPercentEncodeSet","$3c92c0ceb4bdee7e$var$percentEncode","$3c92c0ceb4bdee7e$require$codeAt","$3c92c0ceb4bdee7e$var$specialSchemes","ftp","file","http","https","ws","wss","$3c92c0ceb4bdee7e$var$isWindowsDriveLetter","normalized","$3c92c0ceb4bdee7e$var$startsWithWindowsDriveLetter","third","$3c92c0ceb4bdee7e$var$isSingleDot","segment","$3c92c0ceb4bdee7e$var$SCHEME_START","$3c92c0ceb4bdee7e$var$SCHEME","$3c92c0ceb4bdee7e$var$NO_SCHEME","$3c92c0ceb4bdee7e$var$SPECIAL_RELATIVE_OR_AUTHORITY","$3c92c0ceb4bdee7e$var$PATH_OR_AUTHORITY","$3c92c0ceb4bdee7e$var$RELATIVE","$3c92c0ceb4bdee7e$var$RELATIVE_SLASH","$3c92c0ceb4bdee7e$var$SPECIAL_AUTHORITY_SLASHES","$3c92c0ceb4bdee7e$var$SPECIAL_AUTHORITY_IGNORE_SLASHES","$3c92c0ceb4bdee7e$var$AUTHORITY","$3c92c0ceb4bdee7e$var$HOST","$3c92c0ceb4bdee7e$var$HOSTNAME","$3c92c0ceb4bdee7e$var$PORT","$3c92c0ceb4bdee7e$var$FILE","$3c92c0ceb4bdee7e$var$FILE_SLASH","$3c92c0ceb4bdee7e$var$FILE_HOST","$3c92c0ceb4bdee7e$var$PATH_START","$3c92c0ceb4bdee7e$var$PATH","$3c92c0ceb4bdee7e$var$CANNOT_BE_A_BASE_URL_PATH","$3c92c0ceb4bdee7e$var$QUERY","$3c92c0ceb4bdee7e$var$FRAGMENT","$3c92c0ceb4bdee7e$var$URLState","isBase","base","baseState","failure","urlString","stateOverride","bufferCodePoints","pointer","seenAt","seenBracket","seenPasswordToken","scheme","password","port","path","fragment","cannotBeABaseURL","isSpecial","includesCredentials","$3c92c0ceb4bdee7e$var$EOF","encodedCodePoints","parseHost","shortenPath","numbersSeen","ipv4Piece","swaps","swap","address","pieceIndex","$3c92c0ceb4bdee7e$var$parseIPv6","partsLength","numbers","part","ipv4","parts","$3c92c0ceb4bdee7e$var$parseIPv4","cannotHaveUsernamePasswordPort","pathSize","setHref","getOrigin","$3c92c0ceb4bdee7e$var$URLConstructor","origin","getProtocol","setProtocol","getUsername","setUsername","getPassword","setPassword","getHost","setHost","getHostname","setHostname","hostname","getPort","setPort","getPathname","setPathname","getSearch","setSearch","search","getSearchParams","getHash","setHash","$3c92c0ceb4bdee7e$var$URLPrototype","$3c92c0ceb4bdee7e$var$accessorDescriptor","$3c92c0ceb4bdee7e$require$defineProperties","$3c92c0ceb4bdee7e$var$nativeCreateObjectURL","createObjectURL","$3c92c0ceb4bdee7e$var$nativeRevokeObjectURL","revokeObjectURL","toJSON","t1","e1","createDocumentFragment","Node","Element","Document","DocumentFragment","scrollLeft","scrollTop","getItem","setItem","removeItem","$9f64dcf89d8f9132$export$cd3d1f114b139967","w","h","width","height","$604d9bbf77127967$export$b7d78993b74f766d","navigator","userAgent","$604d9bbf77127967$export$4ec3bfbae69fbb50","Event","timeStamp","$604d9bbf77127967$export$ebcc19037a7ab076","mouseEvent","MouseEvent","$604d9bbf77127967$export$b7b64c480b083ae0","PointerEvent","$604d9bbf77127967$export$9cbe517943afd6db","hasWebgl","canvas","getContext","premultipliedAlpha","$604d9bbf77127967$export$96cd70eaafd80100","visitor","chrome","gl","app","stringify","$604d9bbf77127967$export$fe0a7220ab4eecad","top","offsetLeft","$ac331f543f9a5577$var$listenerFuncObj","$ac331f543f9a5577$export$3f65cefe8380dbea","DomEl","listener","$ac331f543f9a5577$export$8ff9f68337b520c0","removeEventListener","$fc4403c8ee6a33dc$export$dbf350e5966cf602","styleObj","keyArr","keyStr","alignContent","webkitUserSelect","$fc4403c8ee6a33dc$export$f81847884871263e","$fc4403c8ee6a33dc$export$533b26079ad0b4b","numerator","denominator","g","$08e838e8af75c5e2$var$globalKey","keyStrToKeyObj","space","alt","ctrl","cmd","esc","backspace","sqbr_open","sqbr_close","s","z","plus","minus","up","down","home","keyToKeyStrArr","isDownObj","keyToKeyStrObj","comboArr","codeIsDownObj","listenerArr","i1","emitDown","d","emitUp","keyDown","keyCode","keyUp","oldComboStr","blur","eventArr","i2","preventDefault","stopPropagation","keyListener","getIsDown","getCombo","$9414f5ea41e9cf25$export$2c9e8a9632a706b2","$9414f5ea41e9cf25$export$6c4a311cc157c764","ax","ay","bx","by","$9414f5ea41e9cf25$export$627023b405ba5028","p1","p2","atan2","$9414f5ea41e9cf25$export$c03a8450eabc2532","$9414f5ea41e9cf25$export$7d15b64cf5a3a4c4","num","$9414f5ea41e9cf25$export$bb628a54ab399bc9","deg","theta","cs","cos","sn","sin","$a07742141701d1f2$var$WheelCleaner","knownUnitArr","endSequenceTimeout","sequenceLength","sequenceUnit","toEmitDelta","deltaY","pageX","pageY","clientX","clientY","endSequence","clearTimeout","deltaMode","absDelta","$a07742141701d1f2$export$9371bd96776f4e82","pointerArr","pressureNormalizeAvgCount","pressureNormalizeAvgPressure","pressureNormalizeIsComplete","pressureNormalizeFactor","p","targetElement","onPointerCallback","onPointer","onWheelCallback","onWheel","onEnterLeaveCallback","onEnterLeave","maxPointers","buttonsToStr","wheelCleaner","wheelEvent","isDestroyed","bounds","getBoundingClientRect","relX","relY","timeStampOffset","performance","timing","navigationStart","lastPointerType","didSkip","dragObjArr","dragPointerIdArr","getDragObj","pointerId","removeDragObj","removedDragObj","normalizePressure","pressure","correctPointerEvent","corrected","correctedObj","pointerType","movementX","movementY","buttons","button","coalescedArr","eventPreventDefault","eventStopPropagation","customPressure","coalescedEventArr","getCoalescedEvents","pointerObj","getPointer","lastPageX","lastPageY","addPointer","totalLastX","totalLastY","eventItem","createPointerOutEvent","typeStr","correctedEvent","custom","dX","dY","time","coalescedItem","createTouchOutEvent","touchListItem","touchEvent","identifier","destroyDocumentListeners","onGlobalPointerMove","onGlobalPointerUp","onGlobalPointerLeave","onTouchstart","onTouchmove","onTouchend","isOverCounter","onPointerEnter","onPointerLeave","onPointermove","tempLastPointerType","outEvent","onPointerdown","dragObj","downPageX","downPageY","lastTimeStamp","setTouchTimeout","clearTouchTimeout","touchTimeout","onTouchTimeout","fixScribble","touchArr","changedTouches","touchObj","isCoalesced","isOver","destroy","$01c70160099c271e$export$649a211db9812745","chainArr","chainOut","continueChain","chainIn","setChainOut","$01c70160099c271e$export$db3963a21c01d803","allowedPointerTypeArr","allowedButtonArr","sequenceArr","pointersDownIdArr","lastUpTime","nowTime","eventQueueArr","timeoutObj","maxUntilSecondDown","success","lastSequenceItem","onDoubleTap","setupTimeout","timeoutStr","targetFunc","timeMS","diff","isDown","isUp","processEvent","setAllowedPointerTypeArr","arr","setAllowedButtonArr","$01c70160099c271e$export$510622b8aed00381","fingers","firstDownTime","fingerArr","lastEventTime","firstLastDownTimeout","tapTimeout","tempLastEventTime","downTime","fingerObj","allAreUp","onTap","$01c70160099c271e$export$d62358ac2d82abb3","gestureObj1","doSwallow","secondFingerTimeout","touchPointerArr","isInProgress","continuePinch","beginPinch","otherPointerIdArr","downRelX","downRelY","endPinch","touchPointerObj","pincherArr","gestureObj","angleRad","onPinch","actionObj","startDist","distance","startAngle","angle","$01c70160099c271e$export$fe11e0afe623a677","eventCopy","$01c70160099c271e$export$71ff2f51bf1f4062","pointers","downPointerId","ignorePointerIdArr","$01c70160099c271e$export$d429e21f52463d17","downEvent","eventQueue","direction","shiftIsPressed","onDraw","pressure0","pressure1","$01c70160099c271e$export$91dcf4209534d21f","isDrawing","getIsDrawing","$01c70160099c271e$export$c57e2ed65bcf4d6a","lastMixedInput","interval","timeout","smoothing","clearInterval","inputX","inputY","inputPressure","setInterval","setSmoothing","$13d5aa49e37e2734$export$754559b36e94ea2f","ctx","fillStyle","fillRect","$13d5aa49e37e2734$export$42af33c76b681867","size1","toDataURL","$1460f8c17429a8fd$export$5b12bf1653c0dd85","multiplyMatrixAndPoint","matrix","getIdentity","multiplyMatrices","matrixA","matrixB","row0","row1","row2","row3","result0","result1","result2","result3","createTranslationMatrix","createRotationMatrix","createScaleMatrix","$2890e4902986ac94$export$ac4bca90992eed1","sub","nor","dist","mul","dot","aArr","bArr","$4e47553489a532e8$export$8b36a4a83269a640","segmentArr","_this","points","getAtDist","remainder","getLength","fac","$4e47553489a532e8$export$80967b1eb9fd6eb4","xa","ya","y2","wx","sig","ddydx","getFirstX","getLastX","interpolate","klo","khi","findX","resolution","tempX","tempY","tempDist","$b68f66663c02a5d5$export$d2edaecd208aed43","$b68f66663c02a5d5$export$8f9ece5a47764b93","$b68f66663c02a5d5$export$89d3f85304bf0767","$b68f66663c02a5d5$export$fb7efcd2e153af6e","_RGBtoHSV","minVal","maxVal","del_R","del_G","del_B","_HSVtoRGB","var_h","var_i","var_1","var_2","var_3","var_r","var_g","var_b","_CMYKtoRGB","_RGBtoCMYK","toRGB","o","toHSV","toCMYK","toHexString","ha","hb","hc","toRgbStr","rgbObj","toRgbaStr","rgbaObj","hexToRGB","hexStr","$52ad4d7a7d6372c1$export$6bd63bfceaafae0c","preventFocus","didFocusRelated","relatedTarget","focus","currentTarget","$52ad4d7a7d6372c1$export$c3da0dad1b44eea9","setAttribute","$52ad4d7a7d6372c1$var$els","$e0f57e18e675096c$export$9860cd9e09e6f8ba","listeners","msg","$0ecef66681b62a8c$export$19fffca37ef3e106","localStorage","$d9f9f4926aa80a1c$export$921068d8846a1559","referenceNode","newNode","parentNode","insertBefore","nextSibling","im","check","alert","attrObj","classStr","classAttr","getAttribute","splitArr","els","aw","ah","bw","bh","date","Date","getFullYear","getMonth","padStart","getDate","getHours","getMinutes","decimalNumber","blobObj","Blob","fauxBlob","encoding","dateA","dateB","setHours","getTime","mimetype","toBlob","blob","filesArray","File","fileName","share","title","files","clickEvent","tagName","allowClick","$fc4403c8ee6a33dc$export$c54fe3b9ecaa84cf","createElementNS","elementType","childrenArr","center","rot","fDx","fDy","above","below","x2","lineStart","lineEnd","pointArr","lastPoint","lastCallbackPoint","lastAngle","lastDot","lastSpacing","spacing","controlsCallback","dir","pointM1","pointM2","pointM3","isNaN","p3","p4","pointLine","curvePoints","getBezierPoints","tempSpacing","dAngle","addFinal","newP","startVal","endVal","stepSize","dec","resultArr","resultCanvas","drawImage","transform","scaleX","scaleY","angleDeg","whSwapped","destCtx","transformImage","pixelated","save","imageSmoothingEnabled","imageSmoothingQuality","translate","rotate","restore","baseCanvas","transformObj","angleDegree","$13d5aa49e37e2734$export$59b33278b5b2fc8a","tmp1","tmp2","base2","oldW","oldH","newW","newH","oldWidthEx","log2","oldHeightEx","newWidthEx","newHeightEx","getBase2Obj","ew","eh","buffer1","buffer2","bufferCtx","globalCompositeOperation","currentWidth","currentHeight","newWidth","newHeight","tmp","canvasCtx","tmp1Ctx","imdat","getImageData","putImageData","text","innerHTML","getSelection","sel","empty","removeAllRanges","selection","css","className","onClick","onChange","customKeyArr","item1","isInputFocused","activeElement","setEventListener","isPressed","getComboStr","comboOnlyContains","keyStrArr","ref","onDown","onUp","onBlur","comboAStr","comboBStr","$01c70160099c271e$exports","$d2dccce11beb16cf$var$historyInstance","$d2dccce11beb16cf$export$2a772a91f059c0f9","pause","addListener","l","undo","redo","canRedo","canUndo","getActionNumber","$d2dccce11beb16cf$export$28b6f4d98dde9845","broadcast","pauseStack","actionNumber","dataArr","action","maxBefore","maxState","bufferUpdate","$6b37b427615ca1fa$export$17eb8275e0c4cab8","increase","decrease","$b1d2c4b96578d312$exports","$3b55b6f8b7ea8559$exports","$970d7af44d8b8038$export$33e6c23ebe2ee669","$parcel$interopDefault","$970d7af44d8b8038$export$d0d68bb9ed2c643d","$970d7af44d8b8038$export$f02cbd868e2f57cf","$63d0b335c576c718$var$activeLanguageCode","langs","languages","language","lang","$63d0b335c576c718$export$ea44c9eff2c31da6","langCode","documentElement","getLanguage","getCode","$63d0b335c576c718$export$ce37e184d908d785","$2067db88dbfa1944$export$63b4813c5280c707","rootRootEl","bottom","overflow","rootEl","scrollContent","minHeight","flexDirection","justifyContent","alignItems","bgEl","ignoreBackground","zIndex","xButton","titleHeight","lineHeight","background","boxShadow","boxClasses","boxEl","marginBottom","marginRight","flex","addClassName","KeyListener","comboStr","clickOnEnterBtn","click","wheelPrevent","onclick","handleClick","autoFocus","buttonRowEl","flexWrap","marginTop","marginLeft","btnElArr","clearSelection","destroyEl","buttonName","btnClasses","iconUrl","primaries","iconImg","btn","scrollTo","clickOnEnter","closefunc","onscroll","$2067db88dbfa1944$export$129a32eedafa97c5","animationName","animationDuration","animationTimingFunction","updateInterval","updatePos","onClose","popupEl","isCssMinMaxSupported","borderRadius","elW","offsetWidth","elH","offsetHeight","innerWidth","innerHeight","titleEl","paddingLeft","tabindex","contentEl","$2e71cc442ffc5ce0$export$48513f6b9f8ce62d","getValue","checked","getElement","onchange","innerEl","doHighlight","allowTab","tabIndex","removeClassName","$37a9819ee770ba2c$export$b7e3ae3d7c15e42e","$4cac5ef46fe586d2$export$ef9b1a59e592288f","setValue","selectEl","setDeltaValue","optionArr","changeListener","cursor","fontSize","padding","colorScheme","isFocusable","option","initValue","$aae82f96977355fd$export$b6d053cded550773","isActive","backgroundImage","image","isRadio","$045b165580eabc9f$export$7cc1012a658e6ad8","activeIndex","createOption","initId","radioEl","select","$7e9c6045bff31b90$exports","$0a0decde8e1ca62e$export$77219f67585650fa","isChecked","changeCallback","toggleDiv","cssFloat","backgroundSize","backgroundRepeat","boxSizing","redraw","backgroundColor","opacity","border","hasPointerEvents","$55eb816934eb3257$export$f8e41e222e32615d","isRightButton","$e11f9651dcb0bf99$export$a1855b925e534de7","splineInterpolator","isEnabled","useSpline","curve","elementWidth","elementHeight","isChangeOnFinal","formatFunc","eventResMs","curveArr","quadraticSplineInput","SplineInterpolator","toLinearValue","userSelect","labelCaption","control","controlInner","linearValue","oncontextmenu","labelFontSize","updateEnable","pointerEvents","getOutsideVal","updateLabel","outVal","pLinearValue","toValue","toLocaleString","virtualVal","pointerListener","lastCallbackTime","isFinal","deltaX","pointerListenerTimeout","PointerListener","increaseValue","decreaseValue","config","setIsEnabled","isDisabled","$f114b155106d4dea$exports","$49ce344532144fcf$export$cc42e119007cb939","lastValidRgb","RGB","color","previewEl","ColorConverter","hexRowEl","hexLabel","hexInput","rgbArr","copyButton","execCommand","createRgbInputRow","labelStr","attributeStr","rowEl","labelEl","inputEl","parseFloat","resultStr","$c9c5dc083604c2cb$exports","$134e4e0b82b8a538$export$dcd33f7653c95f09","canvasSV","updateSV","gradient1","createLinearGradient","colleft","HSV","colright","addColorStop","heightSV","canvasH","heightH","gradH","col","pointerSV","pointerH","updateSVPointer","updateHPointer","borderLeft","borderRight","virtualHSV","svPointerId","svPointerListener","factor","hPointerId","hPointerListener","cleardiv","setColor","getColor","$4498403702db3039$export$ac00cea56cec3037","param","sliderLine","sliderPoint","sliderPos","isDragging","pointSize","margin","redrawPoint","isFirst","imaginaryPos","transition","getEl","setActive","$365af18d79e5d813$export$24ba9b81662d4366","selectedIndex","colorArr","buttonArr","checkerUrl","createCheckerDataUrl","sItem","initialIndex","colorButton","buttonSize","textAlign","setIsSelected","$76000e01ed982a67$export$c019608e5b5bb4cb","wrapperEl","selectedId","initialId","optionObj","classArr","isSmall","getIndex","changeOnInit","$56401b6578f0a226$exports","$c5a9090dbc3ef918$export$40175a5948a88a57","crop","resetCrop","updateCroppedCanvas","croppedCanvas","croppedImage","updateSelectionRect","selectionRect","thumbX","scaleW","thumbY","scaleH","eventTarget","isNotCopy","Image","previewWrapper","thumbSize","fitInto","thumbCanvas","imageRendering","thumbCtx","toOriginalSpace","genCrop","topLeftP","bottomRightP","origTopLeftP","origBottomRightP","isReset","startP","updateCropTimeout","startCrop","didMove","rect","isInsideSelectionRect","doUpdate","reset","removeProperty","getRect","getCroppedImage","$1303231b2601d391$exports","$9d810a768d57555d$exports","$d3a41777dab1fe38$exports","$56a09ddd0e1bebb4$exports","$469fa98e1403db53$var$fillRect","$469fa98e1403db53$var$mx","$469fa98e1403db53$var$my","$469fa98e1403db53$var$moveIndex","$469fa98e1403db53$var$testAndFill","srcArr","targetArr","initRgba","tolerance","$469fa98e1403db53$export$13d50f258a8034f","rgbaArr","grow","isContiguous","px","py","tl","tr","br","bl","$469fa98e1403db53$var$floodFill","$583d130d11db85ad$export$71b514a25c47df50","shapeObj","lineWidth","globalAlpha","isEraser","fillRgb","strokeRgb","strokeStyle","isAngleSnap","r1","r2","pAngleDeg","pointsToAngleDeg","pAngleDegSnapped","rotated","rotateAround","isFixedRatio","ry","rdX","rdY","isOutwards","x1r","y1r","x2r","y2r","x1f","y1f","x2f","y2f","beginPath","moveTo","lineTo","stroke","strokeRect","ellipse","fill","$67e715fe604c9329$export$482c90f94eb9717c","textStr","outer","align","fontFamily","font","fontWeight","isBold","fontStyle","isItalic","spanStr","whiteSpace","children","offsetTop","fillText","innerText","isDebug","$2b8bf7b32e5ba51f$export$5f63a7b18dc4503a","project","layers","mixModeStr","$f9745064e7206ec5$exports","$d26b85e649dca02a$var$allowedMixModes","$326f2f7e3662b29f$export$6e1bedb2a6cdff30","blendMode","codes","darken","multiply","lighten","screen","overlay","exclusion","hue","saturation","luminosity","$336ce3ce60e7688c$export$6b9252711ea5997f","rootElement","setSize","compass","updateCursor","brushCircleOuter","brushCircleInner","radius","isVisible","updateColorPreview","pickerPreviewCol","pickerPreviewBorder","borderColor","testIsWhiteBestContrast","updateCompass","compassInner","compassLineCircle","createSvg","compassSize","compassBaseCircle","cx","cy","compassUpperTriangle","compassLowerTriangle","$0c4a157f14b91d8b$exports","$8ef0bf7b869e454c$exports","$ae7a81b29eb08bb7$exports","$a2c7a574ff5d8021$exports","TMode","$3a2f95de72e4a634$var$TMode","$f48eb0413169e026$export$e258ade1648009b7","render","clearRect","$d42d1384577ab84d$var$snapToPixel","$d42d1384577ab84d$var$copyTransform","$d42d1384577ab84d$var$toTransformSpace","$d42d1384577ab84d$var$toImageSpace","$0dd23a5e16bda1ff$exports","$d42d1384577ab84d$export$79a74567acf241b0","updateScaled","scaled","corners","snapCorner","iX","iY","snappingEnabled","snap","snapX","minSnapDist","snapY","constrainCorner","cornerIndex","isConstrained","flip","projectPointOnLine","ratio","updateCornerPositions","restoreRatio","widthChanged","heightChanged","angle90","roundEven","roundUneven","updateTransformViaCorners","updateDOM","skipCallback","transEl","transformOrigin","boundsEl","edges","angleGrip","getTransform","setConstrained","setSnapping","setPos","move","setAngleDeg","getRatio","boundsPointerListener","anglePointerListener","cornerCursors","gripSize","edgeSize","pointerRemainder","isInverted","boundsStartP","iP","distX","distY","projected","virtualPos","offsetArr","tinyOffset","tP","indexes","angleOffset","isVertical","tfD","ti","intDxy","dimension","snapDeg","$1fee4e0c7c231d15$export$205c2dd29f8a66b5","previewFit","imageWidth","imageHeight","innerWrapper","previewLayerArr","freeTransform","initTransform","klCanvasPreview","updatePreview","destCanvas","transformIndex","drawTransformedImageWithBounds","testShouldPixelate","transformSize","setTransformFit","fit","setTransformCenter","getTransformation","getIsPixelated","$c4e8a5b20c195c16$export$71ed2b85d4ca43d3","maxW","maxH","gripCursors","outline","grips","outlinePointerListener","commit","thirdsHorizontal","borderTop","borderBottom","thirdsVertical","gripOverlay","transformTop","transformRight","transformBottom","transformLeft","edge0PointerListener","edge1PointerListener","edge2PointerListener","edge3PointerListener","cornerElArr","i3","corner0PointerListener","corner1PointerListener","corner2PointerListener","corner3PointerListener","setTransform","setScale","showThirds","$d9709eed32267a05$exports","$6df9a8d15bee5f38$exports","$055f6ff51abe6c83$exports","$2817af22308abc6b$exports","$aee61e83b7f856a4$exports","$280edd36f8eadb24$exports","$cb474253632556cd$exports","$c13146edb105e0e4$exports","$5a10b171579aa071$exports","$7ef6253361ba8076$exports","$d199831ecec4fae4$export$a0a40f8a0b8fee15","imArr","titleArr","currentActiveIndex","isOpen","openTimeout","startX","startY","smallMargin","flexGrow","showDropdown","elementFromPoint","dropdownBtnArr","closeDropdown","updateButton","activeButton","activeButtonIm","backgroundPosition","arrowButton","$ca8f28e296c9c4ba$exports","dropdownWrapper","borderBottomLeftRadius","borderBottomRightRadius","createDropdownButton","show","setIsSmall","onClickDropdownBtn","activeStr","getActive","$5f5b434174f4babb$exports","$5b08169cac2b4671$exports","$8310100e620b3a7c$exports","$aed18526327077fd$exports","$2fa2f65a5aceea66$exports","$df265814e0ffadf6$exports","$d86783c9f9bd8391$exports","$765f60c172cdc9a9$exports","$9ad8636d87d356c2$exports","$b161bbb9de62d8e3$exports","$69f763be744aedb5$exports","$2e8981ce95927494$exports","$e9d04a247aa46c18$var$kl2PsdMap","$e9d04a247aa46c18$var$psd2KlMap","$e9d04a247aa46c18$var$init","$e9d04a247aa46c18$export$6df36f0c42d2440f","$e9d04a247aa46c18$export$4e3b1f7d3ad623b4","$e9d04a247aa46c18$export$3d649861c4b13fa2","psdObj","addWarning","warningStr","warningArr","getMixModeStr","bitsPerChannel","layerCount","countWithinGroup","groupObj","clipping","adjustment","prepareMask","maskCanvas","defaultColor","groupMaskCtx","imData","convertGroup","psdGroupObj","groupCanvas","groupCtx","groupOpacity","hidden","groupMixModeStr","mask","hasClipping","innerArr","innerItem","innerCtx","clippingCanvas","clippingCtx","clippingItem","effects","$e9d04a247aa46c18$export$56493bf279c387b3","klPsd","$c122457b67184bc9$var$indexedDbIsSupported","indexedDB","$c122457b67184bc9$var$dbNameStr","$c122457b67184bc9$export$1347f8be1f25c479","$c122457b67184bc9$var$execIndexedDBTransaction","actionFunction","successCallback","errorCallback","requestObj","hasFinished","onError","errorStr","onupgradeneeded","createObjectStore","keyPath","createIndex","unique","onsuccess","databaseObj","transactionObj","storeObj","objectStoreNames","contains","deleteDatabase","transaction","objectStore","e2","e3","oncomplete","$c122457b67184bc9$export$1448a0dd0d3fde8e","$c122457b67184bc9$export$21ade4eb935254aa","storageProject","put","$c122457b67184bc9$export$42ffd38884aecdac","$353334092447f12d$exports","$f308e35a2d2c89ee$exports","$e65b2c60cc5eebd9$exports","$23df8fae5f4ace93$exports","$92309ab85b31fb7c$exports","$c5c41443527f1fb6$exports","$fec05d33b1bdb9a5$exports","$63c4079b777d6e1b$exports","$232aaeff90b345e8$exports","$392d520f9d86a04f$exports","$e3dcbac4d4d2e4e5$exports","$aa7fc8aedd4491f5$exports","$20a710e537a1108c$exports","$aa2ca71db1de8ae6$export$7a4e0b62a5d854bc","isLoaded","$aa2ca71db1de8ae6$export$395d33c8e06b92c9","glBrightnessContrast","buttonLabel","webgl","updateContext","icon","getDialog","inEmbed","cropExtend","neededWithWebGL","glCurves","glHueSaturation","invert","isInstant","glPerspective","resize","glTiltShift","toAlpha","ieFails","glBlur","glUnsharpMask","$aa2ca71db1de8ae6$var$updateNames","$f49636f27554dab5$var$myModule","$f49636f27554dab5$var$Grad","dot2","$f49636f27554dab5$var$grad3","$f49636f27554dab5$var$p","$f49636f27554dab5$var$perm","$f49636f27554dab5$var$gradP","$f49636f27554dab5$var$F2","$f49636f27554dab5$var$G2","simplex2","xin","yin","n0","n1","n2","j1","gi0","gi1","gi2","t0","t2","$f49636f27554dab5$export$d3022aad56692482","$be08c7e8caa49ffa$export$74a44bbc21d06a28","scaleFac","createImageData","sFac2","noisePattern","centerDist","$be08c7e8caa49ffa$var$udSegment","ba","Vec2","pa","$be08c7e8caa49ffa$export$eaa218d5d17c8f1c","pDist","centerSize","transitionSize","$f1a560137f603778$export$d116ae91f77f1f19","$2beac24702a6836b$var$clamp","$ec1ed8bc550ccd88$var$sampleCanvas","$ec1ed8bc550ccd88$var$sampleCtx","$baef4a032d46c3b8$var$smudge","imageData","cSize","copyObj","brush","cX","cY","aIndex","aP","bP","randI","randLen","randArr","softnessPx","pixel","ai","bi","ix","iy","fac2","mix","alphaLock","bx1","bx2","iy2","yStart","iy1","iy3","$8baf89d70f3487eb$export$7d68cd8857639377","context","historyEntry1","settingColor","settingColorStr","lineToolLastDot","history","$49faab2330529a96$export$6e4a713ddcda1e5e","DecoyKlHistory","settingSize","settingSpacing","settingOpacity","settingHasSizePressure","settingHasOpacityPressure","settingLockLayerAlpha","settingAlphaId","lastInput","lastInput2","alphaOpacityArr","alphaCanvas128","alphaCanvas64","alphaCanvas32","bezierLine","twoPI","updateAlphaCanvas","instructionArr","drawDot","before","arc","closePath","targetMipmap","continueLine","BezierLine","drawArr","dotCallback","localPressure","localOpacity","localSize","localSpacing","startLine","tool","actions","goLine","endLine","drawLineSegment","loopDist","mouseDist","eX","eY","bdist","historyEntry","setAlpha","setContext","setHistory","setOpacity","setSpacing","sizePressure","opacityPressure","setLockAlpha","getSpacing","getSize","getOpacity","getLockAlpha","updateRedrawBounds","redrawBounds","updateBounds","getCellsWidth","drawChangedCells","cells","getTouchedCells","isTouched","drawCells","touchedCells","cellsW","sliceBounds","cell","cellOffsetX","cellOffsetY","cellWidth","cellHeight","inCellBounds","copyFromCanvas","tmpCtx","getAverage","alpha","ar","ag","ab","aa","prepDot","samples","samplesSquared","sampleOffsets","sharpness","invSharpness","sharpnessSubtrahend","sizeSquared","distDivisor","alphaMinuend","slicedBounds","ri","alphaO","lenSquared","invAlphaO","alphaU","underR","underG","underB","newAlpha","calcSpacing","drawBuffer","localColNew","settingSizePressure","avgX","avgY","blending","mixr","mixg","mixb","average","localColOld","avgParams","blendCol","blendMix","bezierCallback","settingOpacityPressure","getBlending","setBlending","setSizePressure","setOpacityPressure","setIsTesting","isTesting","totalCells","repeat","lastX","lastY","settingBlending","settingScale","sketchySeed","setSeed","getSeed","mixmode","c1","c2","getScale","p_x","p_y","preMixedColor","mixx","mixy","mixw","mixh","countmix","mixed","ditherPattern","settingIsEraser","settingUseDither","ditherCanvas","ditherCtx","ditherArr","updateDither","createPattern","plotLine","skipFirst","sX","sY","plotCubicBezierLine","isOverThreshold","d2","d3","cubicCurveOverThreshold","controlCallback","controlObj","setIsEraser","setUseDither","getIsEraser","getUseDither","updateCompleteRedrawBounds","settingXSymmetry","copyCanvas","settingYSymmetry","settingMode","completeRedrawBounds","drawShape","Path2D","settingGradient","startAtTop","gradient","minY","maxY","lineJoin","draw","setMode","getMode","setDistort","distort","settingDistort","getDistort","setXSymmetry","getXSymmetry","setYSymmetry","getYSymmetry","setGradient","getGradient","boundsInArea","historyCanvas","copiedCells","copyImageData","imWidth","imHeight","$baef4a032d46c3b8$var$prepSmudge","ImageData","historyIm","tmpCanvas","opacity1","started","isBaseLayer","isTransparentBG","radgrad","createRadialGradient","oFac","setTransparentBG","$8a37fb27aea9dd77$exports","$74487dc42eb45244$export$a0d4983f3b0b5c8e","brushInterface","tooltip","sizeSlider","opacitySlider","Ui","alphaNames","PenBrush","onSizeChange","alphas","currentAlpha","alphaClick","updateAlphas","lockAlphaToggle","spacingSpline","onOpacityChange","pressureSizeToggle","pressureOpacityToggle","alphaWrapper","increaseSize","decreaseSize","getBrush","$e7eb2038c725d551$exports","$389b24b4f03b3a27$export$156bb4fe8f4bcb4b","BlendBrush","blendingSlider","$c1bd110c043f70c3$exports","$ed2b11ff6c0e7481$export$ffae56164d1bde68","SketchyBrush","blendSlider","scaleSlider","$6773be6d830b36d7$exports","$c8f3acddc3f49bc0$export$d001f3406562d07","PixelBrush","eraserToggle","ditherToggle","toggleRow","$8dae75d308eda067$exports","$411f23605301883c$export$cf481ecf227135a8","EraserBrush","isTransparentBg","transparencyToggle","getIsTransparentBg","$14d6b11dd0eaae40$exports","$4218d17c2806f1f8$export$84831662ba707e7a","SmudgeBrush","$bc66d8b716ea9ef7$exports","$d63be912aa21b22d$export$2358c75ad3c15b2d","$720edf36b0105568$export$80819a93636ebb04","ChemyBrush","modeOptions","iconSize","onConfigChange","mirrorXToggle","mirrorYToggle","gradientToggle","$b2f1ee6bcab52d93$export$f1561c72be54c6a7","penBrush","blendBrush","sketchyBrush","pixelBrush","chemyBrush","smudgeBrush","eraserBrush","$8f0482777f309396$export$5334e08b3589fc5c","isEmbed","linkEl","popup","onload","setAttributes","isMaxHeight","$1a83f3b0ed28fe18$export$9c72cf485ef46673","updateAge","timestamp","ageStr","age","ageEl","resetButtons","storeEl","disabled","clearEl","updateThumb","thumbnail","maxWidth","maxHeight","createCheckerCanvas","projectStore","getProject","saveReminder","klRootEl","hide","gridTemplateColumns","gridTemplateRows","gap","gridTemplateAreas","gridArea","isBroken","textSize","onUpdate","readResult","read","$dda762a0c02e643a$export$b3fb17ae4345ac8f","base64Str","binStr","atob","buf","$c39dea662ab37110$var$loadImage","imageBlobToUrl","onabort","$c39dea662ab37110$export$f3c1ac6650038646","createThumbnail","HTMLCanvasElement","layer","$e42d359db0fc5c76$var$makeAsync","$9e3399a936aff30a$var$agPsdLazy","$0574a336c2824b09$exports","$ba558600c32aaedf$exports","XMLHttpRequest","responseType","g1","response","send","d1","a2","initMouseEvent","f1","a1","saveAs","HTMLAnchorElement","webkitURL","download","rel","msSaveOrOpenBlob","autoBom","warn","HTMLElement","safari","FileReader","onloadend","readAsDataURL","amd","FileSaver","$2cc9052c3f36f7f1$export$272bfd3ef9ef2f48","skipSubscriber","subscriberArr","emitColor","emitSize","emitOpacity","emitSliderConfig","sliderConfig","onSetColor","onSetSize","onSetOpacity","onGetColor","onGetSize","onGetOpacity","getSliderConfig","onGetSliderConfig","$a21adcb24ed7fb4c$exports","$f57b060bf49249ea$exports","emitChange","changeListenerArr","updateIndices","layerCanvasArr","addLayer","layerOpacity","layerName","layerFill","isLayerLimitReached","getWidth","getHeight","copy","toCopyCanvas","origLayers","getLayers","removeLayer","getLayerCount","algorithm","layerCanvas","resizeCanvas","offX","offY","ctemp","layerCtx","fillColor","selected","layerNrOffset","duplicateLayer","getLayerContext","doReturnNull","renameLayer","moveLayer","mergeLayers","layerBottomIndex","layerTopIndex","topOpacity","convertToAlphaChannelCanvas","isHorizontal","layerIndex","tempCtx","colorObj","compositeOperation","floodFill","rgb","sampleStr","srcCtx","srcImageData","srcData","targetCtx","targetImageData","targetData","srcCanvas","getCompleteCanvas","srcIndex","replaceLayer","clearLayer","getLayersFast","getLayerIndex","canvasObj","getLayer","getColorAt","pickCanvas","addChangeListener","removeChangeListener","setMixMode","setComposite","compositeObj","projectObj","getRenderedTransform","renderedTransformObj","highResTransformObj","updateChangeListener","klCanvas","lastRenderedState","reqFrame","modeInt","doForce","currentMode","oldMode","Draw","Hand","HandGrabbing","Pick","Zoom","Rotate","Rotating","Fill","Text","Shape","globalMode","oldIsHand","currentIsHand","mainDoubleTapper","svgOverlay","internalZoomByStep","stepNum","centerX","centerY","newStep","targetTransformObj","newScale","effectiveFactor","Matrix","transformIsDirty","mixTransformObj","transformA","transformB","blendFactor","centerPosA","canvasToWorkspaceCoord","centerPosB","mixedPos","doResizeCanvas","renderTargetCanvas","renderWidth","renderHeight","renderContext","renderTargetCtx","testBgVisible","workspacePointArr","art","coords","bgVisible","borderSize","emptyCanvas","layerArr","compositeCanvas","compositeCtx","workspaceToCanvasCoord","snapAngleRad","snapDegIncrement","maxDistDeg","modDeg","minimizeAngleRad","resetInputProcessor","currentInputProcessor","doRedrawCanvas","animationFrameRequested","updateLoop","requestAnimationFrame","newState","doRender","elapsedFrames","lastRenderTime","checkChange","doAnimateTranslate","brushRadius","usesCssCursor","renderTime","setCanvas","klC","lastDrawEvent","resetView","oldWidth","oldHeight","modeStr","setEnabled","setCursorSize","diameter","hideBrushCursorTimeout","zoomByStep","onViewChange","changed","doAnimate","fitView","canvasPointsArr","boundsObj","boundsWidth","boundsHeight","setAngle","isRelative","centerObj","oldAngleRad","translateView","tx","ty","getAngleDeg","getMaxScale","getMinScale","requestFrame","setLastDrawEvent","oldTransformObj","cursorPos","isRepeat","onKeyDown","inputProcessorObj","spaceHand","altPicker","zoom","onKeyUp","linetoolProcessor","EventChain","LinetoolProcessor","getMatrix","coord","onFill","onText","shape","onShape","hand","offsetX","offsetY","picker","pickedColor","onPick","startAngleRad","dAngleRad","angleIsExtraSticky","pinchZoomer","PinchZoomer","oldTransform","DoubleTapper","middleDoubleTapper","twoFingerTap","NFingerTapper","onUndo","threeFingerTap","onRedo","pointerEventChain","OnePointerLimiter","CoalescedExploder","ignoreTest","doIgnore","initState","getInitState","oldSize","getKlCanvas","setCurrentLayerCtx","brushes","b1","getCurrentLayerCtx","filterLib","klCanvasWorkspace","handUi","layerManager","layerPreview","setLayer","brushUiObj","getCurrentBrush","b2","currentLayerIndex","catchup","logParam","localCurrentLayerCtx","downX","downY","downAngleRad","onMove","$e9d04a247aa46c18$exports","$c122457b67184bc9$exports","updateTimestamp","lowLevelRead","accessHasFailed","readStorageProject","createStorageProject","lowLevelStore","lowLevelClear","BbLog","saveImage","filename","mimeType","taixuong","getExportType","extension","fullCanvas","filenameBase","exportDialog","fileBase","fnameArr","psdConfig","PSD","blendKlToPsd","loadAgPsd","agPsdLazy","writePsdBuffer","inputs","ignoreFocus","pickCallback","outputDiv","svHeight","primaryColorRGB","startValue","primaryColorHSV","secondaryColorRGB","secondaryColorHSV","svWrapper","svSvg","DOMParser","parseFromString","hueStop","getElementById","divH","divPreview","controlH","updatePrimaryHSV","hsv","updateSVCanvas","setColPreview","pickerButton","hexButton","SVContainer","isPicking","pickingDone","targetEl","cv","createHueBg","secondaryColorBtn","swapColors","updateSecondaryColor","getSecondaryRGB","setPickCallback","setHeight","getOutputElement","updateUiState","uiState","isWide","angleIm","verticalAlign","innerInnerEl","setWide","setUiState","out","doPulse","animation","timeout3","timeout2","layerObj","largeCanvasSize","largeCanvasAnimationTimeout","lastDrawnState","lastDrawnSize","animationCanvas","animationCanvasCtx","animationCount","largeCanvasIsVisible","contentWrapperEl","canvasWrapperEl","minWidth","nameWrapper","nameLabelEl","nameFadeEl","clickableEl","opacityEl","largeCanvasWrapper","webkitTouchCallout","largeCanvas","largeCanvasCtx","animationCanvasCheckerPattern","largeCanvasCheckerPattern","animate","canvasDimensions","drawLargeCanvas","removeLargeCanvas","largeCanvasAnimationDurationMs","showLargeCanvas","setIsVisible","currentState","klCanvasLayerObj","stateStr","remindersShowed","inner","colA","colB","durationMs","paddingTop","textShadow","optionStyle","optionLayerEl","optionImageEl","rootCounter","optionLayerCounter","optionImageCounter","testAcceptType","dataTransfer","types","updateOptions","enabledTest","optionStr","onDrop","sizeObj","queuedObj","colorSlider","brushSettingService","selectedColorEl","subscriptionFunc","initialColor","updateColor","updateUI","mousePos","createButton","extraPadding","contain","logoButton","logoImg","newButton","onNew","importButton","onImport","saveButton","onSave","canShareFiles","onShare","onHelp","currentActiveStr","doEmit","toolDropdown","handButton","onActivate","doLighten","doMirror","createTriangleButton","svg","viewBox","preserveAspectRatio","defs","in","stdDeviation","dx","dy","in2","operator","k2","k3","svgTriangleLeft","class","onLeft","svgTriangleRight","onRight","leftPointerListener","rightPointerListener","leftIm","leftImage","rightIm","rightImage","setIsEnabledLeft","setIsEnabledRight","zoomInNOutButton","onZoomIn","onZoomOut","zoomInButton","zoomOutButton","undoNRedoButton","undoButton","redoButton","setEnableZoomIn","setEnableZoomOut","setEnableUndo","setEnableRedo","strengthSelect","onSelect","tabArr","openedTabObj1","roundRight","roundSize","roundLeft","createTab","pTabObj","useAccent","onOpen","openedTabObj","tabDiv","tabId","getOpenedTabId","directionStr","setDirection","dirStr","onBeforeUnload","returnValue","oldActionNumber","showReminder","visibilityState","historyDist","lastReminderResetAt","showSaveReminderToast","changeTitle","unsavedInterval","isSoft","toolspace","scrollHeight","upInterval","upBtn","downInterval","downBtn","scrollBy","childList","subtree","boxSize","aboutCloseFunc","aboutDiv","aniToggle","imageContainer","coverImage","coverSize","holding","aniTimeout","halfBoxSize","ontouchstart","ontouchmove","ontouchend","cropCallback","showCrop","topWrapper","cropCopy","toClipboard","imgURL","clipboard","ClipboardItem","KeyEvent","rectObj","appendTextDiv","noteEl","originalSizeBtn","freeTransformCanvas","fitSizeBtn","centerBtn","klCanvasLayerArr","importImage","buttonStr","currentColor","secondaryColor","maxCanvasSize","canvasWidth","canvasHeight","workspaceWidth","workspaceHeight","onConfirm","onCancel","createRatioSize","ratioX","ratioY","newImDiv","widthWrapper","heightWrapper","widthInput","widthUnit","heightInput","heightUnit","updateRatio","ratioWrapper","templateWrapper","presetFitBtn","presetCurrentBtn","presetSquareBtn","presetLandscapeBtn","presetPortraitBtn","presetOversizeBtn","backgroundRGBA","colorOptionsArr","colorOptions","preview","previewcell","prevW","prevH","commonRatios","reducedArr","closestRatio","closestDistance","realw","U","HCF","onkeyup","secondRow","secondRowLeft","isSmallWidth","isSmallHeight","textCanvas","textCtx","targetCanvas","layersCanvas","layersCtx","previewCanvas","previewCtx","touchAction","textInput","checkerPattern","colorRGBA","alignRadioList","italicToggle","boldToggle","sizeInput","fontSelect","rotatedXY","rotatedWH","fitBounds","zoomFac","previewPointerListener","changeZoomFac","row2n3Wrapper","zoomInBtn","canZoom","zoomOutBtn","modeWrapper","fontPointerListener","zoomWrapper","sizePointerListener","placeholder","onScroll","resolutionEl","updateResolution","maxSize","flattenCheckbox","doFlatten","noteStyle","psdWarningArr","contentArr","warningMap","showWarnings","cropRect","cropObj","imgurKey","inputTitle","inputDescription","rows","labelTitle","labelDescription","tos","typeRadio","RadioList","outDiv","infoHint","img","gif","labelText","formData","FormData","Authorization","json","link","$1acd53d54391923e$var$upload","deletehash","scaleEl","angleEl","resetButton","onReset","makeUnfocusable","fitButton","onFit","leftRotateButton","onAngleChange","resetAngleButton","rightRotateButton","pIsVisible","pScale","colorDiv","toleranceSlider","modeSelect","growWrapper","growSelect","selectRow","contiguousToggle","paddingRight","getTolerance","getSample","getGrow","getContiguous","rectStrokeSvgRect","rectStrokeSvg","rectFilledSvgRect","rectFilledSvg","ellipseStrokeSvgEllipse","ellipseStrokeSvg","ellipseFilledSvgEllipse","ellipseFilledSvg","lineSvgLine","lineSvg","updatePreviews","strokeWidth","lineWidthSlider","fixedToggle","previewSize","previewPadding","snapToggle","shapeOptions","outwardsToggle","getShape","getLineWidth","getIsOutwards","getIsFixed","getIsSnap","refresh","triggerImport","exportType","onExportTypeChange","onFileSelect","onSaveImageToComputer","onNewImage","onShareImage","onUpload","onCopyToClipboard","filemenu","multiple","accept","exportTypeWrapper","exportTypeSelect","importWrapper","innerMask","importFakeButton","createImportButton","Select","saveNote","createSpacer","clearer","line","fileBrowserStorage","hasWebGl","filters","filterLibStatus","filterKey","filterArr","applyFilter","statusOverlay","klColorSlider","filterDialog","getKlMaxCanvasSize","currentColorRgb","getCurrentColor","secondaryColorRgb","getInput","finishedDialog","setCurrentLayer","getSelected","createDisabledButton","appName","addGroup","groupArr","groupA","groupB","filterKey1","hrEl","webglnote","isInit","onLeftRight","customAbout","preferredLanguageRow","languageSelect","languageHint","licenses","overflowY","p_canvas","p_func","p_rootDiv","oldHistoryState","layerElArr","updatefunc","largeThumbDiv","largeThumbTimeout","largeThumbInTimeout","largeThumbCanvas","largeThumbInDocument","selectedSpotIndex","div1","listdiv","row","clearBtn","suggestions","suggestionBtns","createLayerList","layerListEl","disableButtons","enableButtons","addnewBtn","duplicateBtn","mergeBtn","removeBtn","renameBtn","createLayerEntry","layercanvas","posY","innerLayer","container1","oldOpacity","container2","spot","thumbDimensions","thumb","thc","lname","ondblclick","opacityLabel","sliderValue","isLast","dragstart","freshSelection","lastpos","isSelected","activateLayer","newspot","posy","updateLayersVerticalPosition","posToSpot","newSpot","oldSpot","oldSpotIndex","newSpotIndex","firstChild","child","div2","clearboth","spacer","topCanvas","alphaCanvas","bottomCanvas","mergeDialog","createButtons","historyState","activeLayerSpotIndex","spotIndex","$f79db242723bfbd0$export$665d2c76b1eb8459","submitButton","onSubmit","helpButton","leftRightButton","$db1e37ac2bfb0651$export$68ae324f2f6c6252","gl1","lo","hi","wrapTexture","texture","loadContentsOf","texture1","Texture1","fromElement","initialize","UNSIGNED_BYTE","getExtension","testTexture","RGBA","FLOAT","drawTo","spareTexture","extraTexture","flippedShader","Shader1","isInitialized","use","getDefaultShader","drawRect","simpleShader","shader","uniforms","textureIn","textureOut","swapWith","node","contents","getPixelArray","readPixels","getSquareToQuad","x3","y3","dx1","dy1","dx2","dy2","dx3","dy3","det","getInverse","OESTextureFloatLinear","getSupportedExtensions","oldGetExtension","oldGetSupportedExtensions","framebuffer","createFramebuffer","byteTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","floatTexture","LINEAR","program","createProgram","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shaderSource","compileShader","attachShader","linkProgram","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STREAM_DRAW","enableVertexAttribArray","vertexAttribPointer","useProgram","viewport","drawArrays","POINTS","supportsOESTextureFloatLinear","WebGLRenderingContext","$OES_texture_float_linear$","extensions","brightnessContrast","hexagonalPixelate","hueSaturation","colorHalftone","triangleBlur","unsharpMask","perspective","matrixWarp","bulgePinch","tiltShift","dotScreen","edgeWork","lensBlur","zoomBlur","noise","denoise","curves","swirl","ink","vignette","vibrance","sepia","splineInterpolate","isNumber","compileSource","nameStr","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","floatPrecision","testPrecisionSupport","precisionType","format","getShaderPrecisionFormat","precision","Shader","vertexSource","fragmentSource","vertexAttribute","texCoordAttribute","HIGH_FLOAT","MEDIUM_FLOAT","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","getUniformLocation","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniformMatrix3fv","uniformMatrix4fv","uniform1f","textures","uniform1i","getParameter","VIEWPORT","vertexBuffer","STATIC_DRAW","texCoordBuffer","getAttribLocation","TRIANGLE_STRIP","defaultShader","Texture","videoWidth","videoHeight","initFromBytes","deleteTexture","unit","activeTexture","TEXTURE0","unuse","ensureFormat","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","getCanvas","fillUsingCanvas","toImage","pixels","other","warpShader","warp","randomShaderFunc","brightness","contrast","interpolator","red","green","blue","texSize","amount","strength","originalTexture","lensBlurPrePass","lensBlur0","lensBlur1","lensBlur2","power","delta0","delta1","endX","endY","blurRadius","gradientRadius","edgeWork1","edgeWork2","inverse","useTextureSpace","after","replaceRGBA","$f52ec2e654ff620a$var$fxCanvas","$f52ec2e654ff620a$export$8c4423af32b21158","isContextLost","$16ae9adf91625d4b$export$80884bc1ac80aa1d","selectedLayerIndex","tempCanvas","glCanvas","brightnessSlider","contrastSlider","previewInnerWrapper","$27ed29c04c30bebd$export$4630dcf80f8ceb88","previewFactor","leftChanged","rightChanged","topChanged","bottomChanged","lrWrapper","tbWrapper","leftInput","updateInput","rightInput","topInput","bottomInput","labelStyle","cropper","useRuleOfThirds","ruleOThirdsCheckbox","selectedRgbaObj","bgColorOverlay","updateBg","flexRow","centerWithin","offsetWrapper","$325297d47d50095b$export$2e9081b953703a77","canvas1","fit1","curves1","modeButtons","p0","areah","areaw","update2","curveArea","createPoint","lock","internalY","internalX","newX","newY","updateControl","outCurves","drawCurve","spline","getDiv","update1","$0d917f0c63683ae9$exports","$0165bc482a828d6a$export$8a83211c878a3f1f","doFlipCanvas","horizontalCheckbox","verticalCheckbox","fcOption","paddingBottom","borderTopLeftRadius","flOption","borderTopRightRadius","optionWrapper","previewLayer","horizontal","vertical","flipCanvas","$bee67b0afb8e7ec8$export$88005259b9a70e15","Saturation","hueSlider","saturationSlider","$5166a1dffdf589f0$export$6897c284b6f9f4dc","$03a3697c4bdfc508$export$358acb0cd681f612","displayW","displayH","displayPreviewFactor","pointerListenerArr","bb","bc","bd","ac","ad","nob","nobSize","updateAfter","beforeOption","afterOption","$cd6e692b835a1833$exports","$2b310d636401f340$export$4380c87abf28fdf","inputWrapper","constrainCheckbox","algorithmSelect","secondRowElement","previewW","previewH","canvasWrapper","$25f6a7f7d16420cb$export$bb628a54ab399bc9","WebkitTransform","MozTransform","OTransform","msTransform","btnPlus","btnMinus","$0597830ec9339884$export$83a0900d4b9a8022","fa","fb","blurSlider","gradientSlider","$4a11bd02b90342ee$export$51186ad6e864892a","tempBounds","onInputsChanged","leftWrapper","rightWrapper","rotWrapper","inputR","actionBtnCss","buttonRow","isSnapping","snappingCheckbox","checkboxWrapper","bottomRow","lastDrawnTransformStr","transformLayerCanvas","isPixelated","$8472a5c3c7ee98e8$export$5a82a801f025d40a","radiusSlider","$a410b3ad0888a563$export$a959f91352b242e2","strengthSlider","$ea4acfee4a8b82e8$export$be1ee5ea42904fdc","sourceId","sourceOptions","$a5bdfa66fb1ba8cd$var$embed","$a5bdfa66fb1ba8cd$var$importFilter","libObj","moduleObj","$ee768ecb0b0835b2$exports","$b7af2ed4a75d4700$export$96f6458b62e4c2c","pProject","pOptions","klMaxCanvasSize","embed","uiWidth","uiHeight","toolWidth","KlCanvas","mainTabRow","translateSmoothing","isFirstImage","currentBrush","currentBrushId","lastNonEraserBrushId","currentLayerCtx","sizeWatcher","BrushSettingService","brushesUI","lineSmoothing","LineSmoothing","lineSanitizer","LineSanitizer","drawEventChain","textToolSettings","KlCanvasWorkspace","isDragDone","toolspaceToolRow","canvasX","canvasY","fillUi","dialogCounter","textToolDialog","shapeTool","viewChangeObj","undoRedoCatchup","button1","updateMainTabVisibility","brushTabRow","button2","button3","button4","button5","button6","button7","button8","button9","button10","button11","button12","importFinishedLoading","importedImage","getResizedDimensions","importAsImage","resizedDimensions","importAsImagePsd","convertedPsdObj","cropObj1","cropCanvas","importAsLayer","showImportAsLayerDialog","activeLayerIndex","activeLayerContext","showImportImageDialog","handleFileSelect","showWarningPsdFlattened","hasUnsupportedFile","maxResolution","closeLoader","doShowLoader","loaderIsOpen","reader","readerResult","psd","readPsd","skipLayerImageData","skipThumbnail","skipCompositeImageData","convertedPsd","readAsArrayBuffer","loadImage","KlImageDropper","clipboardData","pasteEvent","getAsFile","retrieveImageFromClipboardAsBlob","imageBlob","URLObj","getAsString","pasteStr","crossOrigin","ui","StatusOverlay","toolspaceInner","overlayToolspace","toolspaceTopRow","toolspaceCollapser","ToolspaceCollapser","updateCollapse","updateUi","toolspaceScroller","OverlayToolspace","ToolspaceTopRow","onLogo","showNewImageDialog","fileTab","saveToComputer","shareImage","ToolspaceToolRow","KlColorSlider","p_color","doPick","brushDiv","toolspaceStabilizerRow","ToolspaceStabilizerRow","TabRow","brushId","HandUi","FillUi","textUi","TextUi","shapeUi","ShapeUi","ShapeTool","isDone","klLayerManager","LayerPreview","filterTab","FilterTab","UndoRedoCatchup","clctx","newImageDialog","shareCanvas","SaveToComputer","FileTab","imgurUpload","clipboardDialog","inputObj","settingsTab","SettingsTab","aboutEl","oldTabId","keysArr","$8732edc01443e694$exports","bottomBarWrapper","bottomBar","updateBottomBar","ToolspaceScroller","scrollY","getPNG","getPSD","$3ccac2760787e643$export$92433b641be3f7a","swapUiLeftRight","windowResizeWatcher","ResizeObserver","prevent","klApp","domIsLoaded","onDomLoaded","ProjectStore","loadingScreenEl","SaveReminder","onProjectLoaded","setLanguage"],"version":3,"file":"index.8b095a55.js.map"}